(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[   1274077,      26197]
NotebookOptionsPosition[   1266984,      25981]
NotebookOutlinePosition[   1267363,      25998]
CellTagsIndexPosition[   1267320,      25995]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["Temporal dynamics", "Title",
 CellChangeTimes->{{3.710695830661573*^9, 3.710695834692173*^9}}],

Cell[CellGroupData[{

Cell["Plotting parameters", "Section",
 CellChangeTimes->{{3.691239326947637*^9, 3.6912393301480017`*^9}, {
  3.691241596541066*^9, 3.6912415988157587`*^9}},
 ExpressionUUID -> "1aef70f7-fbd1-4a5c-8dfc-c2069fa1ba8e"],

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"SetDirectory", "[", 
     RowBox[{"NotebookDirectory", "[", "]"}], "]"}], ";"}], " ", 
   RowBox[{"(*", 
    RowBox[{
    "sets", " ", "current", " ", "directory", " ", "to", " ", "be", " ", 
     "location", " ", "of", " ", "this", " ", "file"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"plotdir", "=", "\"\<Plots/\>\""}], ";"}], 
   RowBox[{"(*", 
    RowBox[{"directory", " ", "to", " ", "save", " ", "figures", " ", "in"}], 
    "*)"}], "\[IndentingNewLine]"}]}]], "Input",
 CellChangeTimes->{{3.691199395468156*^9, 3.6911994238867617`*^9}, {
  3.6912393196489277`*^9, 3.6912393222466583`*^9}},
 ExpressionUUID -> "f8199f5c-5c26-4ba4-bb7d-cea320951ad9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Pad", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"50", ",", "10"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"50", ",", "10"}], "}"}]}], "}"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{"space", " ", "around", " ", "plot"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"letpos", "=", 
    RowBox[{"{", 
     RowBox[{".05", ",", ".93"}], "}"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"relative", " ", "location", " ", "of", " ", "letter"}], ",", " ", 
    RowBox[{"eg", " ", "A"}], ",", " ", 
    RowBox[{"in", " ", "figure"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"ylabpos", "=", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"-", "0.15"}], ",", "0.5"}], "}"}]}], ";"}], "  ", 
  RowBox[{"(*", 
   RowBox[{
   "relative", " ", "location", " ", "of", " ", "y", " ", "axis", " ", 
    "label", " ", "position"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"inches", "=", "72"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"lwd", "=", "0.006"}], ";"}], 
  RowBox[{"(*", 
   RowBox[{
   "line", " ", "thickness", " ", "as", " ", "fraction", " ", "of", " ", 
    "plot", " ", "width"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ticksize", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.01"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xsize", "=", 
   RowBox[{"5", "inches"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"aspectratio", "=", 
   RowBox[{"1", "/", 
    RowBox[{"Sqrt", "[", "2", "]"}]}]}], 
  ";"}], "\[IndentingNewLine]"}], "Input",
 CellChangeTimes->{{3.6912001126660013`*^9, 3.691200143575015*^9}, {
  3.69120039633344*^9, 3.691200396513929*^9}, {3.691200440636483*^9, 
  3.691200471978136*^9}, {3.6912041635699453`*^9, 3.6912041637236547`*^9}, {
  3.6912042066112623`*^9, 3.691204217939785*^9}, {3.6912051909799356`*^9, 
  3.691205191159609*^9}, {3.6912382749359922`*^9, 3.691238275042301*^9}, {
  3.691239265705887*^9, 3.691239310617393*^9}, {3.6912414893987627`*^9, 
  3.691241499429421*^9}, {3.691246413194191*^9, 3.691246425313057*^9}},
 ExpressionUUID -> "3604a913-62a9-473b-854d-948673dc1598"]
}, Closed]],

Cell[CellGroupData[{

Cell["Life-cycle", "Section",
 CellChangeTimes->{{3.681743786104041*^9, 3.6817437925740137`*^9}, {
   3.681744758252803*^9, 3.6817447640802717`*^9}, {3.6817907535849123`*^9, 
   3.681790755198732*^9}, 3.681790964811371*^9}],

Cell[CellGroupData[{

Cell["Haploid competition", "Subsection",
 CellChangeTimes->{{3.681790761563039*^9, 3.681790767400532*^9}, {
  3.695053398651717*^9, 3.695053400125853*^9}, {3.696695122110588*^9, 
  3.6966951231463127`*^9}}],

Cell["Frequency of haploids from each sex", "Text",
 CellChangeTimes->{{3.697151250749948*^9, 3.697151258628313*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["freqHap", "sex_"], ":=", 
  RowBox[{"ParallelSum", "[", 
   RowBox[{
    SubscriptBox["fHap", 
     RowBox[{"x", ",", "y", ",", "z", ",", "sex"}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"{", 
       RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      RowBox[{"{", 
       RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.697151183458856*^9, 3.697151199477862*^9}, 
   3.6971620991256037`*^9, {3.698414400107432*^9, 3.698414401468542*^9}}],

Cell["Mean haploid fitness of gametes from each sex", "Text",
 CellChangeTimes->{{3.696695130048037*^9, 3.696695161928997*^9}, {
  3.6966953911933403`*^9, 3.696695398865906*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["wbarHap", "sex_"], ":=", 
  RowBox[{
   SubscriptBox["wbarHap", "sex"], "=", 
   FractionBox[
    RowBox[{"ParallelSum", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["wHap", 
        RowBox[{"y", ",", "sex"}]], 
       SubscriptBox["fHap", 
        RowBox[{"x", ",", "y", ",", "z", ",", "sex"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}], 
    SubscriptBox["freqHap", "sex"]]}]}]], "Input",
 CellChangeTimes->{{3.68174069177772*^9, 3.681740709745438*^9}, {
  3.6817407470528183`*^9, 3.681740792567976*^9}, {3.681743989430183*^9, 
  3.681743993228486*^9}, {3.681744694112637*^9, 3.681744695061598*^9}, {
  3.681744770055842*^9, 3.681744781694951*^9}, {3.696695164212509*^9, 
  3.696695169314419*^9}, {3.69715114997863*^9, 3.697151179679657*^9}, {
  3.6971512189873543`*^9, 3.6971512227342453`*^9}, {3.697162090151134*^9, 
  3.697162092068632*^9}, {3.698414404908331*^9, 3.698414406277357*^9}}],

Cell["\<\
Frequencies of haploid genotypes from each sex following haploid competition, \
which occurs between gametes coming from the same sex\
\>", "Text",
 CellChangeTimes->{{3.696695176865569*^9, 3.696695199818366*^9}, {
  3.6966952399477863`*^9, 3.696695241475881*^9}, {3.696695404993683*^9, 
  3.6966954241384993`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fHapSel", 
   RowBox[{"x_", ",", "y_", ",", "z_", ",", "sex_"}]], ":=", 
  FractionBox[
   RowBox[{
    SubscriptBox["wHap", 
     RowBox[{"y", ",", "sex"}]], 
    SubscriptBox["fHap", 
     RowBox[{"x", ",", "y", ",", "z", ",", "sex"}]]}], 
   RowBox[{
    SubscriptBox["wbarHap", "sex"], 
    SubscriptBox["freqHap", "sex"]}]]}]], "Input",
 CellChangeTimes->{{3.68174069177772*^9, 3.681740709745438*^9}, {
  3.6817407470528183`*^9, 3.681740792567976*^9}, {3.681743989430183*^9, 
  3.681743993228486*^9}, {3.681744694112637*^9, 3.681744695061598*^9}, {
  3.681744770055842*^9, 3.681744781694951*^9}, {3.696695164212509*^9, 
  3.696695169314419*^9}, {3.69715122758352*^9, 3.6971512429961433`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Random mating", "Subsection",
 CellChangeTimes->{{3.6817907708613567`*^9, 3.681790772239373*^9}, {
  3.695053404145611*^9, 3.695053404843087*^9}}],

Cell["Gametes from the two sexes pair at random", "Text",
 CellChangeTimes->{{3.696695214602847*^9, 3.6966952286276083`*^9}, {
  3.696695432002734*^9, 3.6966954345306883`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fDip", 
   RowBox[{
   "xM_", ",", "yM_", ",", "zM_", ",", "xP_", ",", "yP_", ",", "zP_"}]], ":=", 
  RowBox[{
   SubscriptBox["fDip", 
    RowBox[{"xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP"}]], 
   "=", 
   RowBox[{
    SubscriptBox["fHapSel", 
     RowBox[{"xM", ",", "yM", ",", "zM", ",", "hom"}]], 
    SubscriptBox["fHapSel", 
     RowBox[{"xP", ",", "yP", ",", "zP", ",", "het"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.681740852705102*^9, 3.681740881236745*^9}, {
   3.681741102397697*^9, 3.681741112150375*^9}, 3.6817438071282473`*^9, 
   3.68174469800976*^9, {3.681744788822844*^9, 3.681744812868677*^9}, {
   3.698371781222054*^9, 3.69837178396603*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Sex determination", "Subsection",
 CellChangeTimes->{{3.68179077585012*^9, 3.681790778311782*^9}, {
  3.6950534072431593`*^9, 3.695053408004703*^9}}],

Cell["Determine the sex of newly formed diploids", "Text",
 CellChangeTimes->{{3.696695277141136*^9, 3.696695287573451*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fDipSex", 
   RowBox[{
   "xM_", ",", "yM_", ",", "zM_", ",", "xP_", ",", "yP_", ",", "zP_", ",", 
    "sex_"}]], ":=", 
  RowBox[{
   SubscriptBox["fDipSex", 
    RowBox[{
    "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
     "sex"}]], "=", 
   RowBox[{
    SubscriptBox["fDip", 
     RowBox[{"xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP"}]], 
    SubscriptBox["psex", 
     RowBox[{"zM", ",", "xP", ",", "zP", ",", "sex"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.681740916059374*^9, 3.681740941165064*^9}, {
   3.6817411271569843`*^9, 3.68174113488159*^9}, 3.681744699086836*^9, {
   3.681744820695732*^9, 3.681744847841905*^9}}],

Cell["where a diploid must become one heterogametic or homogametic", "Text",
 CellChangeTimes->{{3.681790782072919*^9, 3.681790792647656*^9}, {
  3.698371157392571*^9, 3.6983711604146013`*^9}, {3.6984142978219423`*^9, 
  3.6984143090759773`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumsex", "=", 
   RowBox[{
    SubscriptBox["psex", 
     RowBox[{"zM_", ",", "xP_", ",", "zP_", ",", "het"}]], "\[Rule]", 
    RowBox[{"1", "-", 
     SubscriptBox["psex", 
      RowBox[{"zM", ",", "xP", ",", "zP", ",", "hom"}]]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.681740963151202*^9, 3.681741006588331*^9}, {
  3.6817448642217417`*^9, 3.681744883117257*^9}, {3.698371163794825*^9, 
  3.6983711691439342`*^9}, {3.698371202106351*^9, 3.698371204593018*^9}}],

Cell["\<\
Rules for invasion of a dominant modifier into an XY (or ZW) system\
\>", "Text",
 CellChangeTimes->{{3.681790803628374*^9, 3.681790842176858*^9}, {
   3.695053524085052*^9, 3.6950535912772512`*^9}, 3.696695331640586*^9, {
   3.6966954462351923`*^9, 3.696695448475649*^9}, 3.698371253750304*^9, {
   3.698371401861559*^9, 3.698371404587001*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"invXY", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"M", ",", "YW", ",", "M", ",", "hom"}]], "\[Rule]", "0"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "always", " ", "heterogametic", " ", "sex", " ", "if", " ", "neo"}], 
       "-", 
       RowBox[{"SD", " ", "allele", " ", "wildtype", " ", 
        RowBox[{"(", "M", ")"}], " ", "and", " ", "have", " ", "Y", " ", "or",
         " ", "W", " ", 
        RowBox[{"(", "YW", ")"}], " ", "from", " ", "heterogametic", " ", 
        "parent"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"M", ",", "XZ", ",", "M", ",", "hom"}]], "\[Rule]", "1"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "always", " ", "homogametic", " ", "sex", " ", "if", " ", "neo"}], "-", 
       RowBox[{"SD", " ", "allele", " ", "wildtype", " ", 
        RowBox[{"(", "M", ")"}], " ", "and", " ", "have", " ", "X", " ", "or",
         " ", "Z", " ", "from", " ", 
        RowBox[{"(", "XZ", ")"}], " ", "heterogametic", " ", "parent"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"m", ",", "xP_", ",", "zP_", ",", "hom"}]], "\[Rule]", "k"}], 
     ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "ancestrally", " ", "homogametic", " ", "sex", " ", "with", " ", 
        "probability", " ", "k", " ", "if", " ", "mutation", " ", "at", " ", 
        "the", " ", "neo"}], "-", 
       RowBox[{"SD", " ", "locus", " ", 
        RowBox[{"(", "m", ")"}], " ", "from", " ", "homogametic", " ", 
        "parent"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"zM_", ",", "xP_", ",", "m", ",", "hom"}]], "\[Rule]", "k"}]}],
     " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "ancestrally", " ", "homogametic", " ", "sex", " ", "with", " ", 
       "probability", " ", "k", " ", "if", " ", "mutation", " ", "at", " ", 
       "the", " ", "neo"}], "-", 
      RowBox[{"SD", " ", "locus", " ", 
       RowBox[{"(", "m", ")"}], " ", "from", " ", "heterogametic", " ", 
       "parent"}]}], "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678749250078711*^9, 3.678749257734652*^9}, {
   3.678749341105864*^9, 3.678749495395021*^9}, {3.679945123194168*^9, 
   3.679945148394607*^9}, {3.6799451869399347`*^9, 3.679945240579802*^9}, {
   3.679945289781743*^9, 3.679945339491596*^9}, {3.6799453844002123`*^9, 
   3.679945402746641*^9}, {3.6799454634914007`*^9, 3.6799455567240467`*^9}, {
   3.6799484238045397`*^9, 3.679948455123131*^9}, {3.67994848956713*^9, 
   3.679948517654551*^9}, {3.679948569319213*^9, 3.679948570835786*^9}, {
   3.679951538898012*^9, 3.679951549755542*^9}, {3.68037305678191*^9, 
   3.680373067198072*^9}, {3.6803822046986856`*^9, 3.680382207715699*^9}, {
   3.680382278235017*^9, 3.68038254183022*^9}, {3.6803826726056223`*^9, 
   3.6803827011867247`*^9}, {3.681481533121539*^9, 3.681481811404159*^9}, {
   3.681482143533368*^9, 3.681482144703322*^9}, {3.681736556313373*^9, 
   3.681736594419837*^9}, {3.681736645992744*^9, 3.6817366988928537`*^9}, {
   3.681736750338529*^9, 3.681736811785675*^9}, {3.681736847176927*^9, 
   3.681736957382381*^9}, {3.6817438697025414`*^9, 3.681743921107368*^9}, 
   3.6817443638221292`*^9, {3.681744903243745*^9, 3.681744975780779*^9}, {
   3.681745009880579*^9, 3.681745061658045*^9}, {3.681790822233528*^9, 
   3.6817908224326878`*^9}, {3.695053621112494*^9, 3.6950536508891478`*^9}, {
   3.695053712275227*^9, 3.6950537228262157`*^9}, {3.6983711980465403`*^9, 
   3.698371396212751*^9}, {3.6984143592755938`*^9, 3.698414375355226*^9}, {
   3.698414451824972*^9, 3.6984144754680347`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Diploid selection", "Subsection",
 CellChangeTimes->{{3.6817908523566217`*^9, 3.681790854930419*^9}, {
  3.695053424001115*^9, 3.695053424708165*^9}}],

Cell["Frequencies of diploids from each sex", "Text",
 CellChangeTimes->{{3.6971512960507193`*^9, 3.6971513054322863`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["freqDip", "sex_"], ":=", 
  RowBox[{"ParallelSum", "[", 
   RowBox[{
    SubscriptBox["fDipSex", 
     RowBox[{
     "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
      "sex"}]], ",", 
    RowBox[{"{", 
     RowBox[{"xM", ",", 
      RowBox[{"{", 
       RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"yM", ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"zM", ",", 
      RowBox[{"{", 
       RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"xP", ",", 
      RowBox[{"{", 
       RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"yP", ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"zP", ",", 
      RowBox[{"{", 
       RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6971513262430763`*^9, 3.6971513267411213`*^9}, 
   3.69716210906399*^9, {3.698414419349148*^9, 3.698414425630577*^9}}],

Cell["Mean diploid fitness in each sex", "Text",
 CellChangeTimes->{{3.696695371490938*^9, 3.696695372672546*^9}, {
  3.696695458244852*^9, 3.6966954647319517`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["wbarDip", "sex_"], ":=", 
  RowBox[{
   SubscriptBox["wbarDip", "sex"], "=", 
   FractionBox[
    RowBox[{"ParallelSum", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["wDip", 
        RowBox[{"yM", ",", "yP", ",", "sex"}]], 
       SubscriptBox["fDipSex", 
        RowBox[{
        "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
         "sex"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"xM", ",", 
        RowBox[{"{", 
         RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"yM", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zM", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xP", ",", 
        RowBox[{"{", 
         RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"yP", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zP", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}], 
    SubscriptBox["freqDip", "sex"]]}]}]], "Input",
 CellChangeTimes->{
  3.6971497937936907`*^9, {3.697149946702374*^9, 3.697149972474596*^9}, 
   3.697150235543221*^9, {3.697150277256873*^9, 3.697150280344022*^9}, {
   3.697151330025823*^9, 3.6971513335051527`*^9}, 3.697162111414228*^9, {
   3.698414430678187*^9, 3.698414435742556*^9}}],

Cell["\<\
Frequencies of diploid genotypes in each sex following diploid selection, \
which occurs separately in each sex (even if diploid selection is not direct \
competition between members of the same sex but instead viability selection, \
selection still effectively occurs \[OpenCurlyQuote]separately in each sex\
\[CloseCurlyQuote] because the next generation is sired by 50% heterogametic \
sex and 50% homogametic sex)\
\>", "Text",
 CellChangeTimes->{{3.696695476428199*^9, 3.696695510501577*^9}, {
  3.696695589856222*^9, 3.6966955941123123`*^9}, {3.696696090011167*^9, 
  3.6966962979217*^9}, {3.698371451343636*^9, 3.698371460300375*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fDipSel", 
   RowBox[{
   "xM_", ",", "yM_", ",", "zM_", ",", "xP_", ",", "yP_", ",", "zP_", ",", 
    "sex_"}]], ":=", 
  RowBox[{
   SubscriptBox["fDipSel", 
    RowBox[{
    "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
     "sex"}]], "=", 
   FractionBox[
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"yM", ",", "yP", ",", "sex"}]], 
     SubscriptBox["fDipSex", 
      RowBox[{
      "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
       "sex"}]]}], 
    RowBox[{
     SubscriptBox["wbarDip", "sex"], 
     SubscriptBox["freqDip", "sex"]}]]}]}]], "Input",
 CellChangeTimes->{{3.697150004307781*^9, 3.697150018911365*^9}, 
   3.697150105743805*^9, {3.697150294137301*^9, 3.697150305677289*^9}, {
   3.697151338394719*^9, 3.6971513388456793`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Meiosis", "Subsection",
 CellChangeTimes->{{3.6817908603315487`*^9, 3.681790862035611*^9}, {
  3.695053427266148*^9, 3.695053427971775*^9}}],

Cell["Gamete genotypes produced by diploids", "Text",
 CellChangeTimes->{{3.696695621410144*^9, 3.696695643290491*^9}, {
  3.6966963219398127`*^9, 3.69669633174671*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fHapNext", 
   RowBox[{"x_", ",", "y_", ",", "z_", ",", "sex_"}]], ":=", 
  RowBox[{
   SubscriptBox["fHapNext", 
    RowBox[{"x", ",", "y", ",", "z", ",", "sex"}]], "=", 
   RowBox[{"ParallelSum", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["fDipSel", 
       RowBox[{
       "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
        "sex"}]], 
      SubscriptBox["pseg", 
       RowBox[{
       "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
        "sex", ",", "x", ",", "y", ",", "z"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"xM", ",", 
       RowBox[{"{", 
        RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yM", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zM", ",", 
       RowBox[{"{", 
        RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xP", ",", 
       RowBox[{"{", 
        RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yP", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zP", ",", 
       RowBox[{"{", 
        RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6817440705483007`*^9, 3.6817440908841143`*^9}, {
  3.681744703057055*^9, 3.6817447059212723`*^9}, {3.681745089264248*^9, 
  3.681745102327985*^9}, {3.698414503733334*^9, 3.698414513819972*^9}}],

Cell[CellGroupData[{

Cell["Segregation", "Subsubsection",
 CellChangeTimes->{{3.6951408332729673`*^9, 3.6951408457141037`*^9}, {
   3.695140930171077*^9, 3.695140941721265*^9}, 3.695146498004241*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pseg0", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"triple", " ", "homozygote"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["pseg", 
      RowBox[{
      "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y1_", ",", "z1_", ",", 
       "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", "1"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"single", " ", "heterozygotes"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z1_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x1_", ",", "a", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      SubscriptBox["\[Alpha]", "sex"]}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x1_", ",", "a", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["\[Alpha]", "sex"]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x1_", ",", "A", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      SubscriptBox["\[Alpha]", "sex"]}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x1_", ",", "A", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["\[Alpha]", "sex"]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg2", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"double", " ", "heterozygotes"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z1_", ",", 
        "sex_", ",", "x2_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z1_", ",", 
        "sex_", ",", "x2_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], " ", 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x1_", ",", "a", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x1_", ",", "a", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x1_", ",", "a", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], " ", 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x1_", ",", "a", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z1_", ",", 
        "sex_", ",", "x2_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], " ", 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z1_", ",", 
        "sex_", ",", "x2_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x1_", ",", "A", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x1_", ",", "A", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x1_", ",", "A", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], " ", 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x1_", ",", "A", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXnotAM", "+", "recAMnotAX"}], ")"}]}], ")"}], "/", 
       "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXnotAM", "+", "recAMnotAX"}], ")"}]}], ")"}], "/", 
       "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"recAXnotAM", "+", "recAMnotAX"}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"recAXnotAM", "+", "recAMnotAX"}], ")"}], "/", "2"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg3", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"triple", " ", "heterozygote"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", "recAXandAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], "recAXandAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", "recAXandAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], " ", "recAXandAM"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], " ", "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], " ", "recAXandAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], " ", "recAXandAM"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], " ", 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], " ", "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], " ", "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], " ", "recAXandAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], " ", "recAXandAM"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg4", "=", 
   RowBox[{
    SubscriptBox["pseg", 
     RowBox[{
     "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
      "sex_", ",", "x_", ",", "y_", ",", "z_"}]], "\[Rule]", "0"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.678743407603024*^9, 3.678743407992798*^9}, {
   3.678743451388444*^9, 3.67874370896734*^9}, {3.678743739187004*^9, 
   3.6787437964386272`*^9}, {3.678743835224123*^9, 3.678744092201377*^9}, {
   3.678744261724123*^9, 3.678744264472003*^9}, {3.678745612751544*^9, 
   3.678745641984303*^9}, {3.67874649434549*^9, 3.678746541426771*^9}, {
   3.678746588409*^9, 3.678746681937327*^9}, {3.678746723757894*^9, 
   3.678746726465787*^9}, {3.678747087955186*^9, 3.678747088849813*^9}, 
   3.6787471567075977`*^9, {3.678747281988718*^9, 3.678747345020574*^9}, {
   3.678747431984068*^9, 3.67874755142631*^9}, {3.678747706661974*^9, 
   3.678747816389114*^9}, {3.678747910520447*^9, 3.67874808520201*^9}, {
   3.678748117158371*^9, 3.678748124005247*^9}, 3.6787481598608437`*^9, {
   3.6787483065670223`*^9, 3.6787483117635727`*^9}, {3.67874836658313*^9, 
   3.678748403085204*^9}, {3.6787513544793262`*^9, 3.678751396800355*^9}, {
   3.67994277150476*^9, 3.679942799274077*^9}, {3.679942831090846*^9, 
   3.679942912055253*^9}, {3.679949107745778*^9, 3.679949120757681*^9}, {
   3.679949262229959*^9, 3.679949268375124*^9}, {3.679949476794919*^9, 
   3.679949523563891*^9}, {3.680374604093164*^9, 3.680374627372505*^9}, {
   3.681497799779855*^9, 3.6814978041546593`*^9}, {3.681497949200699*^9, 
   3.681497969730068*^9}, {3.6814980083479347`*^9, 3.68149802692618*^9}, 
   3.681498690728004*^9, {3.681503295313662*^9, 3.681503299933617*^9}, {
   3.681503352635356*^9, 3.681503380988648*^9}, {3.681503421408928*^9, 
   3.681503592682515*^9}, {3.681739639029612*^9, 3.681739667227919*^9}, {
   3.681739710186636*^9, 3.6817397505186863`*^9}, {3.68173979007161*^9, 
   3.6817400224068947`*^9}, {3.6817402086731462`*^9, 3.681740553815752*^9}, 
   3.6817441247473288`*^9, {3.681745118289254*^9, 3.681745246566457*^9}, 
   3.681790293719043*^9, {3.681790495616611*^9, 3.68179055084875*^9}, {
   3.681790594196591*^9, 3.681790651669318*^9}, {3.685446566599594*^9, 
   3.685446613301856*^9}, {3.6854466594783163`*^9, 3.685446674108594*^9}, {
   3.685446725576165*^9, 3.685446846752988*^9}, {3.685448456509159*^9, 
   3.6854484978796*^9}, {3.685854818012582*^9, 3.68585488767402*^9}, {
   3.685857317433228*^9, 3.6858574839951363`*^9}, {3.685857630736331*^9, 
   3.685857652981037*^9}, {3.685857739461396*^9, 3.6858577821286917`*^9}, {
   3.685857869620257*^9, 3.685857871015697*^9}, {3.685867321622304*^9, 
   3.685867404776165*^9}, {3.685867554585763*^9, 3.685867556709074*^9}, {
   3.685867675545533*^9, 3.6858677608809643`*^9}, 3.685867840790553*^9, {
   3.685868411911867*^9, 3.6858684353076897`*^9}, {3.685868522045967*^9, 
   3.6858685841072397`*^9}, {3.6858686149097958`*^9, 3.685868696329458*^9}, {
   3.685868734377339*^9, 3.68586879707349*^9}, {3.686831493887526*^9, 
   3.686831517514574*^9}, {3.6868315591139107`*^9, 3.686831680594562*^9}, {
   3.686831719657514*^9, 3.6868318159633617`*^9}, 3.6868319155060797`*^9, {
   3.686831995721257*^9, 3.686831996372467*^9}, {3.691332475471079*^9, 
   3.69133253011084*^9}, {3.691332681143373*^9, 3.6913326965546722`*^9}, {
   3.691332726779971*^9, 3.69133272835781*^9}, {3.691332828003528*^9, 
   3.691332845155514*^9}, {3.6913329825497303`*^9, 3.691333001347786*^9}, {
   3.691333050923387*^9, 3.69133306680932*^9}, {3.691333135450306*^9, 
   3.691333174120304*^9}, {3.691333226061233*^9, 3.691333312473215*^9}, {
   3.695144821209661*^9, 3.695144832183332*^9}, {3.6951465122709303`*^9, 
   3.695146539414205*^9}, {3.695146641378426*^9, 3.69514664220968*^9}, {
   3.695146769575981*^9, 3.695146779440208*^9}, {3.695146864513186*^9, 
   3.695146875460191*^9}, {3.6951469318251*^9, 3.6951470843329573`*^9}, {
   3.695147162154175*^9, 3.695147319523302*^9}, {3.6951477560497704`*^9, 
   3.695147759616248*^9}, {3.695147828169773*^9, 3.695147832089531*^9}, {
   3.695147889338893*^9, 3.6951480286289062`*^9}, {3.695148916900036*^9, 
   3.6951489272427692`*^9}, {3.695148968284731*^9, 3.6951490636376677`*^9}, {
   3.695152560803286*^9, 3.695152660419541*^9}, {3.695296193742441*^9, 
   3.695296241076809*^9}, {3.6953081683410807`*^9, 3.695308331991477*^9}, {
   3.695308365636876*^9, 3.6953083926643667`*^9}, {3.695308422850751*^9, 
   3.6953084620596123`*^9}, {3.6953192360198393`*^9, 3.695319261451314*^9}, {
   3.6954856302757807`*^9, 3.695485795085445*^9}, {3.69837160744366*^9, 
   3.698371680756713*^9}, {3.7106969893680687`*^9, 3.710696989755845*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Recombination probabilities for different arrangements of loci\
\>", "Subsubsection",
 CellChangeTimes->{{3.6951462034340267`*^9, 3.695146215368688*^9}, {
  3.695158518509029*^9, 3.69515852830969*^9}, {3.696696371132297*^9, 
  3.6966963733241158`*^9}}],

Cell["\<\
Let the probability of recombination (an odd number of cross-overs) between \
loci A and X be r, the probability of recombination between A and M be R, and \
the probability of recombination between X and M be \[Chi]. \
\>", "Text",
 CellChangeTimes->{{3.6951498188995733`*^9, 3.6951498768084497`*^9}, {
  3.695150045047242*^9, 3.695150115083332*^9}, {3.695408396146262*^9, 
  3.6954084332185497`*^9}}],

Cell["We can then write, in general,", "Text",
 CellChangeTimes->{{3.695408439003786*^9, 3.6954084684446087`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"recGen", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"recAXnotAM", "\[Rule]", 
      FractionBox[
       RowBox[{"r", "+", "\[Chi]", "-", "R"}], "2"]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"recAMnotAX", "\[Rule]", 
      FractionBox[
       RowBox[{"R", "+", "\[Chi]", "-", "r"}], "2"]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"recAXandAM", "\[Rule]", 
      FractionBox[
       RowBox[{"r", "+", "R", "-", "\[Chi]"}], "2"]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.695322414958308*^9, 3.6953225169844112`*^9}, {
  3.695324078272975*^9, 3.6953240785539303`*^9}, {3.69540340480464*^9, 
  3.695403444455276*^9}, {3.695403480136647*^9, 3.695403508563278*^9}, {
  3.6954084578240433`*^9, 3.695408462413484*^9}}],

Cell["\<\
and for specific orders of loci we can substitute in the value of \[Chi] \
(alternatively one could do the same for R or r)\
\>", "Text",
 CellChangeTimes->{{3.695408463908675*^9, 3.695408500798313*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Chi]XAM", "=", 
   RowBox[{"\[Chi]", "\[Rule]", 
    RowBox[{
     RowBox[{"R", 
      RowBox[{"(", 
       RowBox[{"1", "-", "r"}], ")"}]}], "+", 
     RowBox[{"r", 
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]XMA", "=", 
   RowBox[{"\[Chi]", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", "-", "R"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "R"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]AXM", "=", 
   RowBox[{"\[Chi]", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"R", "-", "r"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "r"}]}], ")"}]}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.7107019692134247`*^9, 3.710701984343026*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plots of temporal dynamics", "Section",
 CellChangeTimes->{{3.6776082499874887`*^9, 3.677608251052856*^9}, {
  3.686933010166299*^9, 3.686933027296619*^9}, {3.707150156438609*^9, 
  3.707150173350749*^9}, {3.708109516276267*^9, 3.708109519968438*^9}, {
  3.708109603166834*^9, 3.708109603303213*^9}, {3.708109696861288*^9, 
  3.708109704654052*^9}, {3.7106958930991364`*^9, 3.710695893810051*^9}},
 ExpressionUUID -> "e6dd2a47-fb16-4cef-928e-4230245e1c28"],

Cell[CellGroupData[{

Cell["\<\
Recursions (ancestral XY system)\
\>", "Subsection",
 CellChangeTimes->{{3.6776121236584253`*^9, 3.677612126514793*^9}, {
  3.7106970436645727`*^9, 3.710697048119747*^9}},
 ExpressionUUID -> "97b97ed7-e2ae-4a4e-9a2a-4a08c663a976"],

Cell[CellGroupData[{

Cell["Find equilibrium frequencies of genotypes in each sex", "Subsubsection",
 CellChangeTimes->{{3.686891147472908*^9, 3.686891155322919*^9}, {
  3.6868936504126987`*^9, 3.686893664043786*^9}},
 ExpressionUUID -> "c94ab544-f332-4277-8161-e2d1f0b30c5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"freqsub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "A", ",", "M", ",", "hom"}]], "\[Rule]", "XAf"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "a", ",", "M", ",", "hom"}]], "\[Rule]", "Xaf"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "A", ",", "m", ",", "hom"}]], "\[Rule]", "XAwf"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "a", ",", "m", ",", "hom"}]], "\[Rule]", "Xawf"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "A", ",", "M", ",", "hom"}]], "\[Rule]", "YAf"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "a", ",", "M", ",", "hom"}]], "\[Rule]", "Yaf"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "A", ",", "m", ",", "hom"}]], "\[Rule]", "YAwf"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "a", ",", "m", ",", "hom"}]], "\[Rule]", "Yawf"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "A", ",", "M", ",", "het"}]], "\[Rule]", "XAm"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "a", ",", "M", ",", "het"}]], "\[Rule]", "Xam"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "A", ",", "m", ",", "het"}]], "\[Rule]", "XAwm"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "a", ",", "m", ",", "het"}]], "\[Rule]", "Xawm"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]], "\[Rule]", "YAm"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "a", ",", "M", ",", "het"}]], "\[Rule]", "Yam"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "A", ",", "m", ",", "het"}]], "\[Rule]", "YAwm"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "a", ",", "m", ",", "het"}]], "\[Rule]", "Yawm"}]}],
     "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.686296931436901*^9, 3.6862971790382957`*^9}, {
  3.71069648718311*^9, 3.7106965786459312`*^9}},
 ExpressionUUID -> "baaac4a1-e56d-4db3-a93f-66a740355603"],

Cell[BoxData[
 RowBox[{
  RowBox[{"varsub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "A", ",", "hom"}]], "\[Rule]", "FAA"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "hom"}]], "\[Rule]", "FAa"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "hom"}]], "\[Rule]", "FAa"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "a", ",", "hom"}]], "\[Rule]", "Faa"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "A", ",", "het"}]], "\[Rule]", "MAA"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "het"}]], "\[Rule]", "MAa"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "het"}]], "\[Rule]", "MAa"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "a", ",", "het"}]], "\[Rule]", "Maa"}], ",", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "het"}]], "\[Rule]", "MA"}], ",", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "het"}]], "\[Rule]", "Ma"}], ",", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "hom"}]], "\[Rule]", "FA"}], ",", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "hom"}]], "\[Rule]", "Fa"}], ",", 
     RowBox[{
      SubscriptBox["\[Alpha]", "het"], "\[Rule]", "MdA"}], ",", 
     RowBox[{
      SubscriptBox["\[Alpha]", "hom"], "\[Rule]", "FdA"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.710696615052511*^9, 3.710696657844563*^9}, {
  3.710701135184952*^9, 3.710701136992737*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"differenceEqs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["fHapNext", 
                    RowBox[{"XZ", ",", "A", ",", "M", ",", "hom"}]], "-", 
                   SubscriptBox["fHap", 
                    RowBox[{"XZ", ",", "A", ",", "M", ",", "hom"}]]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["fHapNext", 
                    RowBox[{"XZ", ",", "a", ",", "M", ",", "hom"}]], "-", 
                   SubscriptBox["fHap", 
                    RowBox[{"XZ", ",", "a", ",", "M", ",", "hom"}]]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["fHapNext", 
                    RowBox[{"XZ", ",", "A", ",", "M", ",", "het"}]], "-", 
                   SubscriptBox["fHap", 
                    RowBox[{"XZ", ",", "A", ",", "M", ",", "het"}]]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["fHapNext", 
                    RowBox[{"XZ", ",", "a", ",", "M", ",", "het"}]], "-", 
                   SubscriptBox["fHap", 
                    RowBox[{"XZ", ",", "a", ",", "M", ",", "het"}]]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["fHapNext", 
                    RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]], "-", 
                   SubscriptBox["fHap", 
                    RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["fHapNext", 
                    RowBox[{"YW", ",", "a", ",", "M", ",", "het"}]], "-", 
                   SubscriptBox["fHap", 
                    RowBox[{"YW", ",", "a", ",", "M", ",", "het"}]]}]}], 
                 "\[IndentingNewLine]", "}"}], "/.", 
                RowBox[{
                 SubscriptBox["fHap", 
                  RowBox[{"x_", ",", "y_", ",", "m", ",", "sex_"}]], 
                 "\[Rule]", "0"}]}], "/.", "\[IndentingNewLine]", 
               RowBox[{
                SubscriptBox["fHap", 
                 RowBox[{"YW", ",", "y_", ",", "M", ",", "hom"}]], "\[Rule]", 
                "0"}]}], "/.", "sumsex"}], "/.", "invXY"}], "/.", "pseg0"}], "/.",
            "pseg1"}], "/.", "pseg2"}], "/.", "pseg3"}], "/.", "pseg4"}], "/.",
        "freqsub"}], "/.", "varsub"}], "/.", "recGen"}], "//", "Simplify"}]}],
   "*)"}]], "Input",
 CellChangeTimes->{{3.686890952394562*^9, 3.6868911231027613`*^9}, {
   3.686891242573564*^9, 3.6868912699443827`*^9}, {3.6868927872610483`*^9, 
   3.6868928065125437`*^9}, {3.686892862719038*^9, 3.6868928831831217`*^9}, {
   3.686892919245523*^9, 3.686892948744776*^9}, {3.686893018487218*^9, 
   3.686893019357958*^9}, 3.686894546444447*^9, {3.706983858035534*^9, 
   3.706983876510975*^9}, {3.710696313311133*^9, 3.7106963157916594`*^9}, {
   3.7106964140888767`*^9, 3.710696416570651*^9}, {3.710696593592601*^9, 
   3.710696594610865*^9}, {3.710696664751421*^9, 3.710696674524659*^9}, {
   3.7106967368406076`*^9, 3.710696795124694*^9}, {3.710696876155877*^9, 
   3.7106968769932013`*^9}, 3.710697021221922*^9},
 ExpressionUUID -> "b57f83a0-a58e-4207-a5ba-fa1fd988e5bc"],

Cell[BoxData[{
 RowBox[{"Clear", "[", "equil", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equil", "[", 
   RowBox[{
   "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", "Maa_", 
    ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", "MdA_", 
    ",", "FdA_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "XAf", ",", "Xaf", ",", "XAm", ",", "Xam", ",", "YAm", ",", "Yam"}], 
    "}"}], "/.", 
   RowBox[{"NSolve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"FA", " ", "XAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"FAa", " ", "Ma", " ", 
              RowBox[{"(", 
               RowBox[{"FdA", "-", "XAf"}], ")"}], " ", "Xam"}], "-", 
             RowBox[{"FAA", " ", "MA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "XAf"}], ")"}], " ", "XAm"}]}], 
            ")"}]}], "-", 
          RowBox[{"Fa", " ", "Xaf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Faa", " ", "Ma", " ", "XAf", " ", "Xam"}], "+", 
             RowBox[{"FAa", " ", "MA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "FdA"}], "+", "XAf"}], ")"}], " ", "XAm"}]}], 
            ")"}]}]}], 
         RowBox[{
          RowBox[{"Fa", " ", "Xaf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Faa", " ", "Ma", " ", "Xam"}], "+", 
             RowBox[{"FAa", " ", "MA", " ", "XAm"}]}], ")"}]}], "+", 
          RowBox[{"FA", " ", "XAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"FAa", " ", "Ma", " ", "Xam"}], "+", 
             RowBox[{"FAA", " ", "MA", " ", "XAm"}]}], ")"}]}]}]], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"FA", " ", "XAf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FAa", " ", "Ma", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "FdA", "+", "Xaf"}], ")"}], " ", 
               "Xam"}], "+", 
              RowBox[{"FAA", " ", "MA", " ", "Xaf", " ", "XAm"}]}], ")"}]}], 
           "+", 
           RowBox[{"Fa", " ", "Xaf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Faa", " ", "Ma", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "Xaf"}], ")"}], " ", "Xam"}], "+", 
              RowBox[{"FAa", " ", "MA", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "FdA", "+", "Xaf"}], ")"}], " ", 
               "XAm"}]}], ")"}]}]}], 
          RowBox[{
           RowBox[{"Fa", " ", "Xaf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Faa", " ", "Ma", " ", "Xam"}], "+", 
              RowBox[{"FAa", " ", "MA", " ", "XAm"}]}], ")"}]}], "+", 
           RowBox[{"FA", " ", "XAf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FAa", " ", "Ma", " ", "Xam"}], "+", 
              RowBox[{"FAA", " ", "MA", " ", "XAm"}]}], ")"}]}]}]]}], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"FA", " ", "XAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "Ma", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MdA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "r"}], ")"}]}], "+", "XAm"}], 
               ")"}], " ", "Yam"}], "+", 
             RowBox[{"MA", " ", "MAA", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "XAm"}]}], ")"}], " ", "YAm"}]}], ")"}]}], 
          "-", 
          RowBox[{"2", " ", "Fa", " ", "Xaf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ma", " ", "Maa", " ", "XAm", " ", "Yam"}], "+", 
             RowBox[{"MA", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "MdA"}], " ", "r"}], "+", "XAm"}], ")"}], " ", 
              "YAm"}]}], ")"}]}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Fa", " ", "Xaf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Ma", " ", "Maa", " ", "Yam"}], "+", 
               RowBox[{"MA", " ", "MAa", " ", "YAm"}]}], ")"}]}], "+", 
            RowBox[{"FA", " ", "XAf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Ma", " ", "MAa", " ", "Yam"}], "+", 
               RowBox[{"MA", " ", "MAA", " ", "YAm"}]}], ")"}]}]}], ")"}]}]], 
        ",", 
        FractionBox[
         RowBox[{
          RowBox[{"Fa", " ", "Xaf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ma", " ", "Maa", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "Xam"}]}], ")"}], " ", "Yam"}], "+", 
             RowBox[{"2", " ", "MA", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"MdA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "r"}], ")"}]}], "-", "r", "-", 
                "Xam"}], ")"}], " ", "YAm"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "FA", " ", "XAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ma", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", "r"}], "+", 
                "Xam"}], ")"}], " ", "Yam"}], "+", 
             RowBox[{"MA", " ", "MAA", " ", "Xam", " ", "YAm"}]}], ")"}]}]}], 
         
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Fa", " ", "Xaf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Ma", " ", "Maa", " ", "Yam"}], "+", 
               RowBox[{"MA", " ", "MAa", " ", "YAm"}]}], ")"}]}], "+", 
            RowBox[{"FA", " ", "XAf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Ma", " ", "MAa", " ", "Yam"}], "+", 
               RowBox[{"MA", " ", "MAA", " ", "YAm"}]}], ")"}]}]}], ")"}]}]], 
        ",", 
        FractionBox[
         RowBox[{
          RowBox[{"FA", " ", "XAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "Ma", " ", "MAa", " ", "Yam", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MdA", " ", "r"}], "-", "YAm"}], ")"}]}], "+", 
             RowBox[{"MA", " ", "MAA", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "YAm"}]}], ")"}], " ", "YAm"}]}], ")"}]}], 
          "-", 
          RowBox[{"2", " ", "Fa", " ", "Xaf", " ", "YAm", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ma", " ", "Maa", " ", "Yam"}], "+", 
             RowBox[{"MA", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"MdA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "r"}], ")"}]}], "+", "YAm"}], 
               ")"}]}]}], ")"}]}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Fa", " ", "Xaf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Ma", " ", "Maa", " ", "Yam"}], "+", 
               RowBox[{"MA", " ", "MAa", " ", "YAm"}]}], ")"}]}], "+", 
            RowBox[{"FA", " ", "XAf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Ma", " ", "MAa", " ", "Yam"}], "+", 
               RowBox[{"MA", " ", "MAA", " ", "YAm"}]}], ")"}]}]}], ")"}]}]], 
        ",", 
        FractionBox[
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "FA", " ", "XAf", " ", "Yam", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ma", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "MdA", "+", "r", "-", 
                RowBox[{"MdA", " ", "r"}], "+", "Yam"}], ")"}]}], "+", 
             RowBox[{"MA", " ", "MAA", " ", "YAm"}]}], ")"}]}], "+", 
          RowBox[{"Fa", " ", "Xaf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ma", " ", "Maa", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "Yam"}]}], ")"}], " ", "Yam"}], "-", 
             RowBox[{"2", " ", "MA", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", "r"}], "+", 
                "Yam"}], ")"}], " ", "YAm"}]}], ")"}]}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Fa", " ", "Xaf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Ma", " ", "Maa", " ", "Yam"}], "+", 
               RowBox[{"MA", " ", "MAa", " ", "YAm"}]}], ")"}]}], "+", 
            RowBox[{"FA", " ", "XAf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Ma", " ", "MAa", " ", "Yam"}], "+", 
               RowBox[{"MA", " ", "MAA", " ", "YAm"}]}], ")"}]}]}], 
           ")"}]}]]}], "}"}], "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
      "XAf", ",", "Xaf", ",", "XAm", ",", "Xam", ",", "YAm", ",", "Yam"}], 
      "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6862950169924383`*^9, 3.6862950458188057`*^9}, {
   3.686295079673667*^9, 3.686295131262672*^9}, {3.686295455219968*^9, 
   3.6862954648175373`*^9}, {3.6862955117929487`*^9, 3.686295552696577*^9}, {
   3.686295641016863*^9, 3.686295642725234*^9}, {3.6862957128663816`*^9, 
   3.68629571456251*^9}, 3.686844083433525*^9, {3.68684411594786*^9, 
   3.686844152267994*^9}, {3.686844187322403*^9, 3.68684423331584*^9}, 
   3.686844288671342*^9, {3.686844319862969*^9, 3.686844320197239*^9}, {
   3.6868444171274443`*^9, 3.686844490929109*^9}, {3.686891186626254*^9, 
   3.686891221843259*^9}, {3.686892969200143*^9, 3.686892980116673*^9}, {
   3.686893029902061*^9, 3.686893041582595*^9}, {3.710696831852804*^9, 
   3.710696833389701*^9}, 3.710696887196843*^9, 3.710697006737245*^9},
 ExpressionUUID -> "6ea503b7-4dcb-433d-93da-389f569c17af"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"equil", "[", 
  RowBox[{
  "1", ",", "1.12", ",", "1.2", ",", "1", ",", "1.12", ",", "1.2", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", 
   RowBox[{"1", "/", "2"}], ",", "0.6", ",", 
   RowBox[{"1", "/", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.706983998423141*^9, 3.7069840656312647`*^9}},
 ExpressionUUID -> "e9d24820-12b3-49e1-b0d6-0d9635ed0194"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.780321663490026`", "\[VeryThinSpace]", "+", 
      RowBox[{"3.0501610401416164`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.7803216634900261`"}], "-", 
      RowBox[{"3.0501610401416164`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.343622475122519`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.7827832851105841`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.8436224751225188`"}], "+", 
      RowBox[{"0.7827832851105841`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.343622475122519`", "\[VeryThinSpace]", "-", 
      RowBox[{"0.7827832851105841`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.8436224751225188`"}], "+", 
      RowBox[{"0.7827832851105841`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"1.780321663490026`", "\[VeryThinSpace]", "-", 
      RowBox[{"3.0501610401416164`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.7803216634900261`"}], "+", 
      RowBox[{"3.0501610401416164`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.343622475122519`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.7827832851105841`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.8436224751225188`"}], "-", 
      RowBox[{"0.7827832851105841`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"2.343622475122519`", "\[VeryThinSpace]", "+", 
      RowBox[{"0.7827832851105841`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "1.8436224751225188`"}], "-", 
      RowBox[{"0.7827832851105841`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "1.`", ",", "0.`", ",", "0.5000000000000001`", ",", "0.`", 
     ",", "0.5000000000000001`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.`", ",", "0.5`", ",", "0.`", ",", "0.5`", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.7922978494905388`", ",", "0.2077021505094612`", ",", 
     "0.4127550497549612`", ",", "0.08724495024503881`", ",", 
     "0.4127550497549612`", ",", "0.08724495024503881`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6868929937226973`*^9, {3.686893034126998*^9, 3.686893045703405*^9}, 
   3.686894556021652*^9, 3.6869119313101883`*^9, 3.687080692465213*^9, 
   3.691198012479269*^9, 3.6911980760414057`*^9, 3.6911981959095984`*^9, 
   3.691247541029271*^9, 3.691259696260449*^9, 3.692542589802388*^9, 
   3.693832198505225*^9, 3.693947785682946*^9, 3.693989455848831*^9, 
   3.694952975263164*^9, 3.706899419655237*^9, 3.706973357782777*^9, {
   3.706984001652143*^9, 3.7069840348629932`*^9}, 3.706984073466146*^9, 
   3.707150140214344*^9, 3.707150183261467*^9, 3.708109423939947*^9, 
   3.7081095262407417`*^9, 3.708109907281275*^9, 3.7081296588877773`*^9, 
   3.70817485063023*^9, 3.708195231219676*^9, 3.708454216696854*^9, 
   3.70868497446767*^9, 3.7088970888064423`*^9, 3.7095619968724203`*^9, 
   3.710687241434305*^9, 3.710693226383308*^9, 3.7106968999024973`*^9, 
   3.710697010913108*^9, 3.710699956786532*^9, {3.710701223025641*^9, 
   3.710701233712961*^9}},
 ExpressionUUID -> "7ff1c7c6-d9a0-48dd-be26-ff34a6b20a72"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cutoff", "=", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "10"}], ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Clear", "[", "sieve", "]"}], "\n", 
 RowBox[{
  RowBox[{"sieve", "[", 
   RowBox[{
   "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", "Maa_", 
    ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", "MdA_", 
    ",", "FdA_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "=", "1"}], ";", 
        RowBox[{"write", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"(", 
         RowBox[{"max", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"eq", "=", 
            RowBox[{"(", 
             RowBox[{"equil", "[", 
              RowBox[{
              "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
               "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", 
               ",", "MdA", ",", "FdA"}], "]"}], ")"}]}], "]"}]}], ")"}]}], 
       ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"test", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"eq", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"x_", "/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"cutoff", "\[LessEqual]", 
                   RowBox[{"Re", "[", "x", "]"}], "\[LessEqual]", 
                   RowBox[{"1", "-", "cutoff"}]}], ")"}], "&&", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"Im", "[", "x", "]"}], "]"}], "<", "cutoff"}]}], 
                ")"}]}]}], "]"}]}], "]"}], "\[Equal]", "6"}], ",", 
         RowBox[{"write", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"write", ",", 
            RowBox[{"eq", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Sort", "[", "write", "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.65688204118431*^9, 3.6568820438475103`*^9}, {
  3.674522830809342*^9, 3.6745229439641333`*^9}, {3.677608566387781*^9, 
  3.67760857405052*^9}, {3.677608723220433*^9, 3.677608735175232*^9}, {
  3.686844332339417*^9, 3.686844338188551*^9}, {3.686844570913814*^9, 
  3.68684462210107*^9}, {3.6868930744697323`*^9, 3.6868930747261887`*^9}},
 ExpressionUUID -> "34f52214-4b43-4f6c-8332-13825fb8fa53"],

Cell["For example,", "Text",
 CellChangeTimes->{{3.686295736534458*^9, 3.6862957378250103`*^9}},
 ExpressionUUID -> "652ffd82-6b58-4387-842b-6885983cbb95"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{"sieve", "[", 
   RowBox[{
   "1", ",", "1.1", ",", "1.15", ",", "1", ",", "1.1", ",", "1.15", ",", "1", 
    ",", "0.9", ",", "1", ",", "1", ",", 
    RowBox[{"1", "/", "2"}], ",", 
    RowBox[{"1", "/", "2"}], ",", 
    RowBox[{"1", "/", "2"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.674522890398834*^9, 3.674522890913561*^9}, {
   3.6745229508596*^9, 3.674522954443675*^9}, {3.677608578082793*^9, 
   3.6776086070180063`*^9}, {3.677608715882895*^9, 3.6776087178153543`*^9}, 
   3.686844607472435*^9},
 ExpressionUUID -> "f242b9f0-16f5-4a57-ae64-1046198b971b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.18181818181818155`", ",", "0.8181818181818185`", ",", 
   "0.09090909090909077`", ",", "0.4090909090909092`", ",", 
   "0.09090909090909077`", ",", "0.4090909090909092`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.68689308711373*^9, 3.6868945641321697`*^9, 3.686911940032209*^9, 
   3.691198021086475*^9, 3.691198084335445*^9, 3.691198204823038*^9, 
   3.691247549972425*^9, 3.691259705210442*^9, 3.6925426017603493`*^9, 
   3.6938321987744837`*^9, 3.693947785952327*^9, 3.693989456159554*^9, 
   3.6949529755393753`*^9, 3.706899426939754*^9, 3.706973365711327*^9, 
   3.7071501534377213`*^9, 3.707150191701098*^9, 3.7081094324229927`*^9, 
   3.7081095346874533`*^9, 3.708109915801635*^9, 3.7081296674938803`*^9, 
   3.708174857344349*^9, 3.708195238515541*^9, 3.7084542235459557`*^9, 
   3.708684996812255*^9, 3.708897095548905*^9, 3.709562004101606*^9, 
   3.7106872483170633`*^9, 3.710693233082045*^9, 3.710697034369994*^9, 
   3.7106999636179047`*^9, {3.71070123008361*^9, 3.710701240627626*^9}},
 ExpressionUUID -> "6e36fdb3-059c-4eab-8cdd-54dd6e5293b2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Next female X genotypes", "Subsubsection",
 CellChangeTimes->{{3.6776115327480087`*^9, 3.6776115358133593`*^9}, {
  3.6776116604232187`*^9, 3.677611665578927*^9}, {3.6868458653430653`*^9, 
  3.686845870890107*^9}},
 ExpressionUUID -> "b1efcc2e-32e2-4a97-aa51-84a5920dc359"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                SubscriptBox["fHapNext", 
                 RowBox[{"XZ", ",", "A", ",", "M", ",", "hom"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"XZ", ",", "a", ",", "M", ",", "hom"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"XZ", ",", "A", ",", "m", ",", "hom"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"XZ", ",", "a", ",", "m", ",", "hom"}]]}], 
               "\[IndentingNewLine]", "}"}], "/.", "sumsex"}], "/.", 
             "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.", "pseg2"}], "/.",
          "pseg3"}], "/.", "pseg4"}], "/.", "varsub"}], "/.", "freqsub"}], "/.",
      "recGen"}], "/.", "\[Chi]XAM"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6862966589469748`*^9, 3.686296717880542*^9}, {
   3.686296747934804*^9, 3.686296786862547*^9}, {3.68629684000347*^9, 
   3.68629684491601*^9}, {3.686297189457762*^9, 3.686297227327464*^9}, {
   3.68629728886543*^9, 3.686297327319368*^9}, {3.6862973714134617`*^9, 
   3.686297381496122*^9}, {3.6862975036457777`*^9, 3.686297503772242*^9}, 
   3.686297547660756*^9, {3.686297586181828*^9, 3.686297611312278*^9}, 
   3.6868446723055067`*^9, {3.686844950071352*^9, 3.6868449588806953`*^9}, {
   3.686845125824256*^9, 3.686845144838752*^9}, {3.6868452398882113`*^9, 
   3.6868452480798063`*^9}, {3.686845283984528*^9, 3.686845292873818*^9}, {
   3.6868496299968576`*^9, 3.686849631422812*^9}, {3.686849749836143*^9, 
   3.6868497522265663`*^9}, {3.686849852723694*^9, 3.686849854933138*^9}, {
   3.686894000670023*^9, 3.686894003052517*^9}, 3.686895838942341*^9, 
   3.6868958858970327`*^9, {3.686895933322261*^9, 3.686896085563065*^9}, {
   3.686915728069871*^9, 3.68691574001546*^9}, 3.691198228612029*^9, {
   3.710697089375575*^9, 3.710697092637268*^9}, {3.7106971317150307`*^9, 
   3.710697175239109*^9}, {3.7106972161550913`*^9, 3.710697223958158*^9}, 
   3.710697361911111*^9, {3.710701211563642*^9, 3.7107012159323177`*^9}, {
   3.710701310359723*^9, 3.710701313126431*^9}, {3.710701806253714*^9, 
   3.710701810943555*^9}, {3.710701944435808*^9, 3.710701949234041*^9}, {
   3.710701988559945*^9, 3.710701990614663*^9}, 3.710702052219101*^9},
 ExpressionUUID -> "975c828e-9489-4d5c-badc-39b0388c4dba"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nextXAf", ",", "nextXaf", ",", "nextXAwf", ",", "nextXawf"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.677615031991831*^9, 3.6776150485649843`*^9}},
 ExpressionUUID -> "4224043c-8281-40ef-ad32-f8770bd1695b"],

Cell["\<\
Make functions to get frequencies of each Xf genotype in generation t. This \
depends on what the frequencies of all other genotypes were at time t (inside \
the blocks).\
\>", "Text",
 CellChangeTimes->{{3.686296383816608*^9, 3.686296480375799*^9}, {
  3.6862965305972853`*^9, 3.686296546944943*^9}, {3.6862966145847816`*^9, 
  3.6862966217461567`*^9}},
 ExpressionUUID -> "d84fe68a-c70f-4338-ae68-cfdbba231850"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nextXAf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], 
   RowBox[{
    RowBox[{"nextXAf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "These", " ", "are", " ", "the", " ", "frequencies", " ", "of", " ", 
      "all", " ", "genotypes", " ", "at", " ", "the", " ", "previous", " ", 
      "timestep"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newXAf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "Fa", " ", "FAa", " ", "FdA", " ", "MA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}]}], " ", "XAm", " ", 
                 "Yaf"}], "+", 
                RowBox[{"k", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"r", " ", "Xawf", " ", "YAm"}], "-", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "XAwm", " ", 
                    "Yaf"}], "+", 
                    RowBox[{"r", " ", "Xawf", " ", "YAm"}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf", "-", 
                    RowBox[{"r", " ", "Yawf"}]}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"Xaf", " ", 
                 RowBox[{"(", 
                  RowBox[{"XAm", "+", 
                   RowBox[{"k", " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", 
                    RowBox[{"r", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], "+", 
             RowBox[{"FA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "FAa", " ", "FdA", " ", "Ma", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"r", " ", "Xam", " ", "YAf"}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"r", " ", "Xawm", " ", "YAf"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwf", " ", "Yam"}], "-", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"XAwf", " ", "Yam"}]}], ")"}]}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", 
                    RowBox[{"r", " ", "YAwf"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                   RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "-", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm", "-", 
                    RowBox[{"r", " ", "Yawm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{"FAA", " ", "MA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"XAm", " ", "YAf"}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "-", "R", "+", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwf", " ", "YAm"}]}], ")"}]}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf", "-", 
                    RowBox[{"r", " ", "YAwf"}], "-", 
                    RowBox[{"R", " ", "YAwf"}], "+", 
                    RowBox[{"2", " ", "r", " ", "R", " ", "YAwf"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "XAm"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm", "-", 
                    RowBox[{"r", " ", "YAwm"}], "-", 
                    RowBox[{"R", " ", "YAwm"}], "+", 
                    RowBox[{"2", " ", "r", " ", "R", " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newXAf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newXAf", ">", "1"}], ",", "1", ",", "newXAf"}], "]"}]}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextXaf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextXaf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newXaf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "FA", " ", "FAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "Ma", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}]}], " ", "Xam", " ", 
                 "YAf"}], "+", 
                RowBox[{"k", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"r", " ", "XAwf", " ", "Yam"}], "-", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "Xawm", " ", 
                    "YAf"}], "+", 
                    RowBox[{"r", " ", "XAwf", " ", "Yam"}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf", "-", 
                    RowBox[{"r", " ", "YAwf"}]}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"XAf", " ", 
                 RowBox[{"(", 
                  RowBox[{"Xam", "+", 
                   RowBox[{"k", " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", 
                    RowBox[{"r", " ", "Yawm"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], "+", 
             RowBox[{"Fa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Faa", " ", "Ma", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Xam", " ", "Yaf"}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "-", "R", "+", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawf", " ", "Yam"}]}], ")"}]}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf", "-", 
                    RowBox[{"r", " ", "Yawf"}], "-", 
                    RowBox[{"R", " ", "Yawf"}], "+", 
                    RowBox[{"2", " ", "r", " ", "R", " ", "Yawf"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Xam"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm", "-", 
                    RowBox[{"r", " ", "Yawm"}], "-", 
                    RowBox[{"R", " ", "Yawm"}], "+", 
                    RowBox[{"2", " ", "r", " ", "R", " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "-", 
                RowBox[{"2", " ", "FAa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "MA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"r", " ", "XAm", " ", "Yaf"}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"r", " ", "XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawf", " ", "YAm"}], "-", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawf", " ", "YAm"}]}], ")"}]}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", 
                    RowBox[{"r", " ", "Yawf"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                   RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "-", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm", "-", 
                    RowBox[{"r", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newXaf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newXaf", ">", "1"}], ",", "1", ",", "newXaf"}], "]"}]}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextXAwf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextXAwf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newXAwf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "Fa", " ", "FAa", " ", "FdA", " ", "MA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Xaf", " ", "XAwm"}], "+", 
                  RowBox[{"Xawf", " ", "XAwm"}], "+", 
                  RowBox[{"XAwm", " ", "Yaf"}], "-", 
                  RowBox[{"r", " ", "XAwm", " ", "Yaf"}], "+", 
                  RowBox[{"XAwm", " ", "Yawf"}], "-", 
                  RowBox[{"r", " ", "XAwm", " ", "Yawf"}], "+", 
                  RowBox[{"r", " ", "Xaf", " ", "YAwm"}], "+", 
                  RowBox[{"r", " ", "Xawf", " ", "YAwm"}], "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwm"}], " ", "Yaf"}], "+", 
                    RowBox[{"r", " ", "XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"r", " ", "Xawf", " ", "YAm"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf", "-", 
                    RowBox[{"r", " ", "Yawf"}]}], ")"}]}], "-", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", 
                    RowBox[{"r", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "FAa", " ", "FdA", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwf", " ", "Xawm"}], "+", 
                    RowBox[{"XAwf", " ", "Yam"}], "-", 
                    RowBox[{"r", " ", "XAwf", " ", "Yam"}], "+", 
                    RowBox[{"r", " ", "Xawm", " ", "YAwf"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", 
                    RowBox[{"r", " ", "YAwf"}]}], ")"}]}], "+", 
                    RowBox[{"XAwf", " ", "Yawm"}], "-", 
                    RowBox[{"r", " ", "XAwf", " ", "Yawm"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"r", " ", "Xawm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "Yam"}], "+", 
                    RowBox[{"r", " ", "XAwf", " ", "Yam"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm", "-", 
                    RowBox[{"r", " ", "Yawm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "XAwf", " ", "XAwm"}], "+", 
                    RowBox[{"XAwm", " ", "YAf"}], "-", 
                    RowBox[{"r", " ", "XAwm", " ", "YAf"}], "-", 
                    RowBox[{"R", " ", "XAwm", " ", "YAf"}], "+", 
                    RowBox[{
                    "2", " ", "r", " ", "R", " ", "XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwf", " ", "YAm"}], "-", 
                    RowBox[{"r", " ", "XAwf", " ", "YAm"}], "-", 
                    RowBox[{"R", " ", "XAwf", " ", "YAm"}], "+", 
                    RowBox[{
                    "2", " ", "r", " ", "R", " ", "XAwf", " ", "YAm"}], "+", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "+", "R", "-", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "YAwf"}]}], ")"}]}], "+", 
                    RowBox[{"XAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "+", "R", "-", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "YAwm"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newXAwf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newXAwf", ">", "1"}], ",", "1", ",", "newXAwf"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextXawf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextXawf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newXawf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "FA", " ", "FAa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "Ma", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"XAf", " ", "Xawm"}], "+", 
                  RowBox[{"XAwf", " ", "Xawm"}], "+", 
                  RowBox[{"Xawm", " ", "YAf"}], "-", 
                  RowBox[{"r", " ", "Xawm", " ", "YAf"}], "+", 
                  RowBox[{"Xawm", " ", "YAwf"}], "-", 
                  RowBox[{"r", " ", "Xawm", " ", "YAwf"}], "+", 
                  RowBox[{"r", " ", "XAf", " ", "Yawm"}], "+", 
                  RowBox[{"r", " ", "XAwf", " ", "Yawm"}], "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawm"}], " ", "YAf"}], "+", 
                    RowBox[{"r", " ", "Xawm", " ", "YAf"}], "+", 
                    RowBox[{"r", " ", "XAwf", " ", "Yam"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf", "-", 
                    RowBox[{"r", " ", "YAwf"}]}], ")"}]}], "-", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", 
                    RowBox[{"r", " ", "Yawm"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], "+", 
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Xawf", " ", "Xawm"}], "+", 
                    RowBox[{"Xawm", " ", "Yaf"}], "-", 
                    RowBox[{"r", " ", "Xawm", " ", "Yaf"}], "-", 
                    RowBox[{"R", " ", "Xawm", " ", "Yaf"}], "+", 
                    RowBox[{
                    "2", " ", "r", " ", "R", " ", "Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawf", " ", "Yam"}], "-", 
                    RowBox[{"r", " ", "Xawf", " ", "Yam"}], "-", 
                    RowBox[{"R", " ", "Xawf", " ", "Yam"}], "+", 
                    RowBox[{
                    "2", " ", "r", " ", "R", " ", "Xawf", " ", "Yam"}], "+", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "+", "R", "-", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "Yawf"}]}], ")"}]}], "+", 
                    RowBox[{"Xawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "+", "R", "-", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "Yawm"}]}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "FAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "XAwm"}], "-", 
                    RowBox[{"Xawf", " ", "YAm"}], "+", 
                    RowBox[{"r", " ", "Xawf", " ", "YAm"}], "-", 
                    RowBox[{"r", " ", "XAwm", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", 
                    RowBox[{"r", " ", "Yawf"}]}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "YAwm"}], "+", 
                    RowBox[{"r", " ", "Xawf", " ", "YAwm"}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"r", " ", "XAwm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "YAm"}], "+", 
                    RowBox[{"r", " ", "Xawf", " ", "YAm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm", "-", 
                    RowBox[{"r", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newXawf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newXawf", ">", "1"}], ",", "1", ",", "newXawf"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextXAf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "XAfinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextXaf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "Xafinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextXAwf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "XAwfinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextXawf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "Xawfinit"}]}], "Input",
 CellChangeTimes->{{3.677609169639257*^9, 3.677609254342773*^9}, {
   3.67760929940635*^9, 3.677609319747704*^9}, {3.677609415700798*^9, 
   3.677609588703081*^9}, {3.677609626847389*^9, 3.677609758420228*^9}, {
   3.6776097885539618`*^9, 3.677609937619573*^9}, {3.677610469673553*^9, 
   3.677610530805957*^9}, {3.677610564938963*^9, 3.677610911957862*^9}, {
   3.677610959883894*^9, 3.677611207705814*^9}, {3.677611280462638*^9, 
   3.677611329886663*^9}, {3.6776114444636097`*^9, 3.677611452511242*^9}, {
   3.6776115544456167`*^9, 3.677611643514182*^9}, {3.6776150177966127`*^9, 
   3.677615027913282*^9}, 3.6862974070147743`*^9, {3.68629744448654*^9, 
   3.686297498822525*^9}, 3.6862975298832207`*^9, {3.686297575514308*^9, 
   3.686297579276594*^9}, 3.6862976204287043`*^9, 3.686844713956946*^9, {
   3.6868447748667517`*^9, 3.686844932319375*^9}, 3.686844982985793*^9, {
   3.68684508571594*^9, 3.686845106699781*^9}, {3.6868451699832363`*^9, 
   3.686845232889612*^9}, 3.686845267633327*^9, {3.686848758280573*^9, 
   3.6868488870394497`*^9}, {3.686849390488199*^9, 3.6868494470450907`*^9}, {
   3.68684976368804*^9, 3.686849831755412*^9}, {3.6868503564975147`*^9, 
   3.6868504122801113`*^9}, {3.686850904991899*^9, 3.6868509294129477`*^9}, {
   3.686889931626089*^9, 3.686889969842772*^9}, 3.6868958323453827`*^9, 
   3.686895869396394*^9, 3.6868959254661903`*^9, {3.686895993025148*^9, 
   3.6868960754021263`*^9}, {3.710697293830946*^9, 3.710697354834697*^9}, {
   3.7107020096380787`*^9, 3.710702045606674*^9}},
 ExpressionUUID -> "13454556-350e-4ff5-8727-e408dcdc2fbb"]
}, Closed]],

Cell[CellGroupData[{

Cell["Next male X genotypes", "Subsubsection",
 CellChangeTimes->{{3.677611699435934*^9, 3.6776117022743673`*^9}, {
  3.686845872537171*^9, 3.686845873951038*^9}},
 ExpressionUUID -> "aa11a5bc-bd9b-49b6-9520-79363e92a8de"],

Cell["\<\
The recursions we are interested in here (X haplotypes in males) are\
\>", "Text",
 CellChangeTimes->{{3.686297253143334*^9, 3.686297265026367*^9}, {
  3.686297341879919*^9, 3.686297352941609*^9}, {3.6862977342965927`*^9, 
  3.6862977401114283`*^9}},
 ExpressionUUID -> "970df20c-2409-4cdd-8940-d16b62636f1e"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                SubscriptBox["fHapNext", 
                 RowBox[{"XZ", ",", "A", ",", "M", ",", "het"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"XZ", ",", "a", ",", "M", ",", "het"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"XZ", ",", "A", ",", "m", ",", "het"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"XZ", ",", "a", ",", "m", ",", "het"}]]}], 
               "\[IndentingNewLine]", "}"}], "/.", "sumsex"}], "/.", 
             "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.", "pseg2"}], "/.",
          "pseg3"}], "/.", "pseg4"}], "/.", "varsub"}], "/.", "freqsub"}], "/.",
      "recGen"}], "/.", "\[Chi]XAM"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6862966589469748`*^9, 3.686296717880542*^9}, {
   3.686296747934804*^9, 3.686296786862547*^9}, {3.68629684000347*^9, 
   3.68629684491601*^9}, {3.686297189457762*^9, 3.686297227327464*^9}, {
   3.68629728886543*^9, 3.686297327319368*^9}, {3.6862973714134617`*^9, 
   3.686297381496122*^9}, {3.6862975036457777`*^9, 3.686297503772242*^9}, 
   3.686297547660756*^9, {3.686297586181828*^9, 3.686297611312278*^9}, {
   3.686297744175549*^9, 3.686297756982986*^9}, {3.68684531228433*^9, 
   3.6868453130490427`*^9}, 3.686845392112172*^9, {3.686845428268004*^9, 
   3.6868454288630857`*^9}, {3.686845511286159*^9, 3.6868455115445967`*^9}, 
   3.686845601244685*^9, {3.686849638504395*^9, 3.686849640377268*^9}, {
   3.6868960964931793`*^9, 3.686896109073791*^9}, 3.6868961975773163`*^9, 
   3.686915803887485*^9, 3.691198242631563*^9, {3.7106973791694317`*^9, 
   3.710697412630425*^9}, 3.7106975192386637`*^9, 3.710702060619541*^9, 
   3.710702128839732*^9},
 ExpressionUUID -> "d53bd112-10d9-427f-9f0e-89383ceda009"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nextXAm", ",", "nextXam", ",", "nextXAwm", ",", "nextXawm"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.677615031991831*^9, 3.677615061676626*^9}},
 ExpressionUUID -> "3297efb8-2675-4971-87b7-8b505c848aa1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nextXAm", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"nextXAm", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newXAm", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "Fa", " ", "MA", " ", "MAa", " ", 
              "MdA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{"Xaf", "+", "Xawf", "-", 
                   RowBox[{"k", " ", "Xawf"}]}], ")"}], " ", "YAm"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "XAm", " ", 
                 RowBox[{"(", 
                  RowBox[{"Xawf", "+", "Yawf", "-", 
                   RowBox[{"r", " ", "Yawf"}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "R", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "XAwm", " ", 
                    "Yaf"}], "+", 
                   RowBox[{"r", " ", "Xawf", " ", "YAm"}], "-", 
                   RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", 
                    RowBox[{"r", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], "+", 
             RowBox[{"FA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "Ma", " ", "MAa", " ", "MdA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "r", " ", 
                    "Xawm", " ", "YAf"}], "+", 
                   RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"Yam", "+", "Yawm", "-", 
                    RowBox[{"k", " ", "Yawm"}]}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "r"}], " ", "Xawm", " ", "YAf"}], "+", 
                    RowBox[{"XAwf", " ", "Yam"}], "-", 
                    RowBox[{"r", " ", "XAwf", " ", "Yam"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", 
                    RowBox[{"r", " ", "YAwf"}]}], ")"}]}], "-", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm", "-", 
                    RowBox[{"r", " ", "Yawm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{"MA", " ", "MAA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "R"}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwf", " ", "YAm"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "R", "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
                    "YAwf"}]}], ")"}]}], "+", 
                   RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "r", "-", "R", "+", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "YAwm"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "Maa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yam"}], "-", 
                    RowBox[{"Yaf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yawf"}], "-", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yawm"}], "-", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "Yawm"}], "-", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAm"}], "-", 
                    RowBox[{"Yaf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yawf"}], "-", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAwm"}], "-", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "YAwm"}], "-", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yam"}], "-", 
                    RowBox[{"YAf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAwf"}], "-", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yawm"}], "-", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "Yawm"}], "-", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAm"}], "-", 
                    RowBox[{"YAf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAwf"}], "-", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAwm"}], "-", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "YAwm"}], "-", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newXAm", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newXAm", ">", "1"}], ",", "1", ",", "newXAm"}], "]"}]}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextXam", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextXam", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newXam", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "FA", " ", "Ma", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{"XAf", "+", "XAwf", "-", 
                   RowBox[{"k", " ", "XAwf"}]}], ")"}], " ", "Yam"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Xam", " ", 
                 RowBox[{"(", 
                  RowBox[{"XAwf", "+", "YAwf", "-", 
                   RowBox[{"r", " ", "YAwf"}]}], ")"}]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "R", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "Xawm", " ", 
                    "YAf"}], "+", 
                   RowBox[{"r", " ", "XAwf", " ", "Yam"}], "-", 
                   RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", 
                    RowBox[{"r", " ", "Yawm"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], "+", 
             RowBox[{"Fa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Ma", " ", "Maa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "R"}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawf", " ", "Yam"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "R", "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
                    "Yawf"}]}], ")"}]}], "+", 
                   RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "r", "-", "R", "+", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "Yawm"}]}], ")"}]}]}], ")"}]}], "-", 
                RowBox[{"2", " ", "MA", " ", "MAa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "r", " ", 
                    "XAwm", " ", "Yaf"}], "+", 
                   RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"YAm", "+", "YAwm", "-", 
                    RowBox[{"k", " ", "YAwm"}]}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "r"}], " ", "XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawf", " ", "YAm"}], "-", 
                    RowBox[{"r", " ", "Xawf", " ", "YAm"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", 
                    RowBox[{"r", " ", "Yawf"}]}], ")"}]}], "-", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm", "-", 
                    RowBox[{"r", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "Maa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yam"}], "-", 
                    RowBox[{"Yaf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yawf"}], "-", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yawm"}], "-", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "Yawm"}], "-", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAm"}], "-", 
                    RowBox[{"Yaf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yawf"}], "-", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAwm"}], "-", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "YAwm"}], "-", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yam"}], "-", 
                    RowBox[{"YAf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAwf"}], "-", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yawm"}], "-", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "Yawm"}], "-", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAm"}], "-", 
                    RowBox[{"YAf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAwf"}], "-", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAwm"}], "-", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "YAwm"}], "-", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newXam", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newXam", ">", "1"}], ",", "1", ",", "newXam"}], "]"}]}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextXAwm", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextXAwm", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newXAwm", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "Fa", " ", "MA", " ", "MAa", " ", "MdA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Xaf", " ", "XAwm"}], "+", 
                  RowBox[{"Xawf", " ", "XAwm"}], "+", 
                  RowBox[{"XAwm", " ", "Yaf"}], "-", 
                  RowBox[{"r", " ", "XAwm", " ", "Yaf"}], "+", 
                  RowBox[{"XAwm", " ", "Yawf"}], "-", 
                  RowBox[{"r", " ", "XAwm", " ", "Yawf"}], "+", 
                  RowBox[{"r", " ", "Xaf", " ", "YAwm"}], "+", 
                  RowBox[{"r", " ", "Xawf", " ", "YAwm"}], "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwm"}], " ", "Yaf"}], "+", 
                    RowBox[{"r", " ", "XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"r", " ", "Xawf", " ", "YAm"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf", "-", 
                    RowBox[{"r", " ", "Yawf"}]}], ")"}]}], "-", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", 
                    RowBox[{"r", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", "Ma", " ", "MAa", " ", "MdA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwf", " ", "Xawm"}], "+", 
                    RowBox[{"XAwf", " ", "Yam"}], "-", 
                    RowBox[{"r", " ", "XAwf", " ", "Yam"}], "+", 
                    RowBox[{"r", " ", "Xawm", " ", "YAwf"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", 
                    RowBox[{"r", " ", "YAwf"}]}], ")"}]}], "+", 
                    RowBox[{"XAwf", " ", "Yawm"}], "-", 
                    RowBox[{"r", " ", "XAwf", " ", "Yawm"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"r", " ", "Xawm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "Yam"}], "+", 
                    RowBox[{"r", " ", "XAwf", " ", "Yam"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm", "-", 
                    RowBox[{"r", " ", "Yawm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "XAwf", " ", "XAwm"}], "+", 
                    RowBox[{"XAwm", " ", "YAf"}], "-", 
                    RowBox[{"r", " ", "XAwm", " ", "YAf"}], "-", 
                    RowBox[{"R", " ", "XAwm", " ", "YAf"}], "+", 
                    RowBox[{
                    "2", " ", "r", " ", "R", " ", "XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwf", " ", "YAm"}], "-", 
                    RowBox[{"r", " ", "XAwf", " ", "YAm"}], "-", 
                    RowBox[{"R", " ", "XAwf", " ", "YAm"}], "+", 
                    RowBox[{
                    "2", " ", "r", " ", "R", " ", "XAwf", " ", "YAm"}], "+", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "+", "R", "-", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "YAwf"}]}], ")"}]}], "+", 
                    RowBox[{"XAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "+", "R", "-", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "YAwm"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "Maa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yam"}], "-", 
                    RowBox[{"Yaf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yawf"}], "-", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yawm"}], "-", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "Yawm"}], "-", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAm"}], "-", 
                    RowBox[{"Yaf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yawf"}], "-", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAwm"}], "-", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "YAwm"}], "-", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yam"}], "-", 
                    RowBox[{"YAf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAwf"}], "-", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yawm"}], "-", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "Yawm"}], "-", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAm"}], "-", 
                    RowBox[{"YAf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAwf"}], "-", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAwm"}], "-", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "YAwm"}], "-", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newXAwm", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newXAwm", ">", "1"}], ",", "1", ",", "newXAwm"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextXawm", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextXawm", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newXawm", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "FA", " ", "Ma", " ", "MAa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"XAf", " ", "Xawm"}], "+", 
                  RowBox[{"XAwf", " ", "Xawm"}], "+", 
                  RowBox[{"Xawm", " ", "YAf"}], "-", 
                  RowBox[{"r", " ", "Xawm", " ", "YAf"}], "+", 
                  RowBox[{"Xawm", " ", "YAwf"}], "-", 
                  RowBox[{"r", " ", "Xawm", " ", "YAwf"}], "+", 
                  RowBox[{"r", " ", "XAf", " ", "Yawm"}], "+", 
                  RowBox[{"r", " ", "XAwf", " ", "Yawm"}], "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawm"}], " ", "YAf"}], "+", 
                    RowBox[{"r", " ", "Xawm", " ", "YAf"}], "+", 
                    RowBox[{"r", " ", "XAwf", " ", "Yam"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf", "-", 
                    RowBox[{"r", " ", "YAwf"}]}], ")"}]}], "-", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", 
                    RowBox[{"r", " ", "Yawm"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], "+", 
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "Maa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Xawf", " ", "Xawm"}], "+", 
                    RowBox[{"Xawm", " ", "Yaf"}], "-", 
                    RowBox[{"r", " ", "Xawm", " ", "Yaf"}], "-", 
                    RowBox[{"R", " ", "Xawm", " ", "Yaf"}], "+", 
                    RowBox[{
                    "2", " ", "r", " ", "R", " ", "Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawf", " ", "Yam"}], "-", 
                    RowBox[{"r", " ", "Xawf", " ", "Yam"}], "-", 
                    RowBox[{"R", " ", "Xawf", " ", "Yam"}], "+", 
                    RowBox[{
                    "2", " ", "r", " ", "R", " ", "Xawf", " ", "Yam"}], "+", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "+", "R", "-", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "Yawf"}]}], ")"}]}], "+", 
                    RowBox[{"Xawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "+", "R", "-", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "Yawm"}]}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "MA", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "XAwm"}], "-", 
                    RowBox[{"Xawf", " ", "YAm"}], "+", 
                    RowBox[{"r", " ", "Xawf", " ", "YAm"}], "-", 
                    RowBox[{"r", " ", "XAwm", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", 
                    RowBox[{"r", " ", "Yawf"}]}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "YAwm"}], "+", 
                    RowBox[{"r", " ", "Xawf", " ", "YAwm"}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"r", " ", "XAwm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "YAm"}], "+", 
                    RowBox[{"r", " ", "Xawf", " ", "YAm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm", "-", 
                    RowBox[{"r", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "Maa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yam"}], "-", 
                    RowBox[{"Yaf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yawf"}], "-", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yawm"}], "-", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "Yawm"}], "-", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAm"}], "-", 
                    RowBox[{"Yaf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yawf"}], "-", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAwm"}], "-", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "YAwm"}], "-", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yam"}], "-", 
                    RowBox[{"YAf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAwf"}], "-", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yawm"}], "-", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "Yawm"}], "-", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAm"}], "-", 
                    RowBox[{"YAf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAwf"}], "-", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAwm"}], "-", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "YAwm"}], "-", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newXawm", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newXawm", ">", "1"}], ",", "1", ",", "newXawm"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextXAm", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "XAminit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextXam", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "Xaminit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextXAwm", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "XAwminit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextXawm", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "Xawminit"}]}], "Input",
 CellChangeTimes->{{3.677609169639257*^9, 3.677609254342773*^9}, {
   3.67760929940635*^9, 3.677609319747704*^9}, {3.677609415700798*^9, 
   3.677609588703081*^9}, {3.677609626847389*^9, 3.677609758420228*^9}, {
   3.6776097885539618`*^9, 3.677609937619573*^9}, {3.677610469673553*^9, 
   3.677610530805957*^9}, {3.677610564938963*^9, 3.677610911957862*^9}, {
   3.677610959883894*^9, 3.677611207705814*^9}, {3.677611280462638*^9, 
   3.677611329886663*^9}, {3.6776114444636097`*^9, 3.677611452511242*^9}, {
   3.6776115544456167`*^9, 3.677611643514182*^9}, {3.6776117178301897`*^9, 
   3.677611825662019*^9}, {3.677614998322591*^9, 3.677615007785575*^9}, 
   3.6862978193680067`*^9, 3.6862978687329273`*^9, {3.686297910649639*^9, 
   3.686297911513857*^9}, {3.686297959117159*^9, 3.686297959364684*^9}, {
   3.686845332389298*^9, 3.686845492088439*^9}, {3.686845524272678*^9, 
   3.6868455572790537`*^9}, 3.686845672998667*^9, {3.686848902211804*^9, 
   3.686848967338723*^9}, {3.686849121277967*^9, 3.686849152648147*^9}, {
   3.686849454474143*^9, 3.6868494666267138`*^9}, {3.68684986777382*^9, 
   3.686849878247407*^9}, {3.686850430230771*^9, 3.6868504443639174`*^9}, {
   3.6868509386788073`*^9, 3.686850960667181*^9}, {3.686889985176689*^9, 
   3.686890004884467*^9}, {3.686896139823988*^9, 3.686896189601235*^9}, {
   3.710697450436665*^9, 3.710697512379067*^9}, {3.7107020866031313`*^9, 
   3.71070212227746*^9}},
 ExpressionUUID -> "1cf02e13-bb41-4dc4-b637-bbb282abf9ec"]
}, Closed]],

Cell[CellGroupData[{

Cell["Next female Y genotypes", "Subsubsection",
 CellChangeTimes->{{3.6776118570805273`*^9, 3.677611860222869*^9}, {
  3.686845875377121*^9, 3.6868458770548*^9}},
 ExpressionUUID -> "66cabfe8-8600-44b9-96e3-522fa9e42b42"],

Cell["\<\
The recursions we are interested in here (Y haplotypes in females) are\
\>", "Text",
 CellChangeTimes->{{3.686297253143334*^9, 3.686297265026367*^9}, {
  3.686297341879919*^9, 3.686297352941609*^9}, {3.6862977342965927`*^9, 
  3.6862977401114283`*^9}, {3.686297987906145*^9, 3.686297990181469*^9}},
 ExpressionUUID -> "6230d43b-2839-4b74-ada5-0881e5f9babb"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "A", ",", "M", ",", "hom"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "a", ",", "M", ",", "hom"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "A", ",", "m", ",", "hom"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "a", ",", "m", ",", "hom"}]]}], 
               "\[IndentingNewLine]", "}"}], "/.", "sumsex"}], "/.", 
             "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.", "pseg2"}], "/.",
          "pseg3"}], "/.", "pseg4"}], "/.", "varsub"}], "/.", "freqsub"}], "/.",
      "recGen"}], "/.", "\[Chi]XAM"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6862966589469748`*^9, 3.686296717880542*^9}, {
   3.686296747934804*^9, 3.686296786862547*^9}, {3.68629684000347*^9, 
   3.68629684491601*^9}, {3.686297189457762*^9, 3.686297227327464*^9}, {
   3.68629728886543*^9, 3.686297327319368*^9}, {3.6862973714134617`*^9, 
   3.686297381496122*^9}, {3.6862975036457777`*^9, 3.686297503772242*^9}, 
   3.686297547660756*^9, {3.686297586181828*^9, 3.686297611312278*^9}, {
   3.686297744175549*^9, 3.686297756982986*^9}, {3.686297993210198*^9, 
   3.686298027725922*^9}, {3.686845583310204*^9, 3.6868455840592527`*^9}, {
   3.686845755988953*^9, 3.686845819954913*^9}, {3.686849514367605*^9, 
   3.6868495161868467`*^9}, {3.68684964739923*^9, 3.68684965185922*^9}, {
   3.6868962046293*^9, 3.686896215516781*^9}, 3.686896308517293*^9, 
   3.686915884748541*^9, 3.6911982522554607`*^9, {3.710697538375613*^9, 
   3.710697567542389*^9}, 3.7106976462346087`*^9, 3.710702136331135*^9, 
   3.710702224641086*^9},
 ExpressionUUID -> "9d713875-75a1-4c25-aa15-a560d37286b5"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nextYAf", ",", "nextYaf", ",", "nextYAwf", ",", "nextYawf"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.677615031991831*^9, 3.677615078451476*^9}},
 ExpressionUUID -> "c038277e-9a7b-4f03-afef-a1f6500f244b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nextYAf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"nextYAf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newYAf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"FA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "FAa", " ", "FdA", " ", "Ma", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"YAf", "+", 
                    RowBox[{"k", " ", "R", " ", "YAwf"}]}], ")"}]}], "-", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Xawm", " ", 
                    "YAf"}], "+", 
                    RowBox[{"r", " ", "R", " ", "XAwf", " ", "Yam"}], "+", 
                    RowBox[{"R", " ", "Yam", " ", "YAwf"}], "+", 
                    RowBox[{"r", " ", "XAf", " ", "Yawm"}], "-", 
                    RowBox[{"r", " ", "R", " ", "XAf", " ", "Yawm"}], "+", 
                    RowBox[{"YAf", " ", "Yawm"}], "-", 
                    RowBox[{"R", " ", "YAf", " ", "Yawm"}]}], ")"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{"FAA", " ", "MA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"YAf", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"r", "+", "R", "-", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "YAwf"}]}], ")"}]}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "R", "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", "XAwm", 
                    " ", "YAf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "r", "-", "R", "+", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", "XAwf", 
                    " ", "YAm"}], "+", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"r", " ", "XAf", " ", "YAwm"}], "+", 
                    RowBox[{"R", " ", "XAf", " ", "YAwm"}], "-", 
                    RowBox[{
                    "2", " ", "r", " ", "R", " ", "XAf", " ", "YAwm"}], "+", 
                    RowBox[{"YAf", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], "+", 
             RowBox[{"2", " ", "Fa", " ", "FAa", " ", "FdA", " ", "MA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"YAm", "-", 
                    RowBox[{"R", " ", "YAm"}]}], ")"}]}], "+", 
                   RowBox[{"YAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Yawf", "-", 
                    RowBox[{"R", " ", "Yawf"}]}], ")"}]}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xaf", "+", "Yaf"}], ")"}], " ", "YAwm"}]}], 
                  ")"}]}], "+", 
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Yaf", "-", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Yawf"}]}], 
                    ")"}]}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "YAm"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawf", " ", "YAm"}], "-", 
                    RowBox[{"Xaf", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newYAf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newYAf", ">", "1"}], ",", "1", ",", "newYAf"}], "]"}]}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextYaf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYaf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newYaf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "FA", " ", "FAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "Ma", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"k", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Yam", "-", 
                    RowBox[{"R", " ", "Yam"}]}], ")"}]}], "+", 
                   RowBox[{"Yam", " ", 
                    RowBox[{"(", 
                    RowBox[{"YAwf", "-", 
                    RowBox[{"R", " ", "YAwf"}]}], ")"}]}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAf", "+", "YAf"}], ")"}], " ", "Yawm"}]}], 
                  ")"}]}], "+", 
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"YAf", "-", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "YAwf"}]}], 
                    ")"}]}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "Yam"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"XAwf", " ", "Yam"}], "-", 
                    RowBox[{"XAf", " ", "Yawm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], "+", 
             RowBox[{"Fa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Faa", " ", "Ma", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Yaf", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"r", "+", "R", "-", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "Yawf"}]}], ")"}]}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "R", "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", "Xawm", 
                    " ", "Yaf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "r", "-", "R", "+", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", "Xawf", 
                    " ", "Yam"}], "+", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"r", " ", "Xaf", " ", "Yawm"}], "+", 
                    RowBox[{"R", " ", "Xaf", " ", "Yawm"}], "-", 
                    RowBox[{
                    "2", " ", "r", " ", "R", " ", "Xaf", " ", "Yawm"}], "+", 
                    RowBox[{"Yaf", " ", "Yawm"}]}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"2", " ", "FAa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "MA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Yaf", "+", 
                    RowBox[{"k", " ", "R", " ", "Yawf"}]}], ")"}]}], "-", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "XAwm", " ", 
                    "Yaf"}], "+", 
                    RowBox[{"r", " ", "R", " ", "Xawf", " ", "YAm"}], "+", 
                    RowBox[{"R", " ", "YAm", " ", "Yawf"}], "+", 
                    RowBox[{"r", " ", "Xaf", " ", "YAwm"}], "-", 
                    RowBox[{"r", " ", "R", " ", "Xaf", " ", "YAwm"}], "+", 
                    RowBox[{"Yaf", " ", "YAwm"}], "-", 
                    RowBox[{"R", " ", "Yaf", " ", "YAwm"}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newYaf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newYaf", ">", "1"}], ",", "1", ",", "newYaf"}], "]"}]}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextYAwf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYAwf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newYAwf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "Fa", " ", "FAa", " ", "FdA", " ", 
                "MA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"Xaf", "+", "Xawf", "+", "Yaf", "+", "Yawf"}], 
                    ")"}]}], " ", "YAwm"}], "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "YAm"}], "-", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Xaf", "+", "Yaf"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Yaf"}], "-", 
                    "Yawf"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Xaf", "+", "Xawf"}], ")"}], " ", "YAwm"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawf", " ", "YAm"}], "-", 
                    RowBox[{"XAm", " ", "Yawf"}], "-", 
                    RowBox[{"Xaf", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "FAa", " ", "FdA", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "YAwf"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", "Xawm", "+", "Yam", "+", "Yawm"}], 
                    ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "Xawm", " ", 
                    "YAf"}], "+", 
                    RowBox[{"r", " ", "XAwf", " ", "Yam"}], "+", 
                    RowBox[{"Xam", " ", "YAwf"}], "-", 
                    RowBox[{"r", " ", "Xam", " ", "YAwf"}], "+", 
                    RowBox[{"Yam", " ", "YAwf"}], "-", 
                    RowBox[{"r", " ", "XAf", " ", "Yawm"}], "-", 
                    RowBox[{"YAf", " ", "Yawm"}]}], ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", "Xawm"}], ")"}], " ", "YAwf"}], "-", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Yam", "+", "Yawm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "YAwf"}], "+", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"XAf", " ", "YAwm"}], "+", 
                    RowBox[{"XAwf", " ", "YAwm"}], "+", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"2", " ", "YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwf", " ", "YAm"}], "-", 
                    RowBox[{"XAm", " ", "YAwf"}], "-", 
                    RowBox[{"XAf", " ", "YAwm"}]}], ")"}]}], "-", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwf", " ", "YAm"}], "-", 
                    RowBox[{"XAm", " ", "YAwf"}], "-", 
                    RowBox[{"XAf", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newYAwf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newYAwf", ">", "1"}], ",", "1", ",", "newYAwf"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextYawf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYawf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newYawf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "FA", " ", "FAa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "Ma", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"XAf", "+", "XAwf", "+", "YAf", "+", "YAwf"}], 
                    ")"}]}], " ", "Yawm"}], "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "Yam"}], "-", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"XAf", "+", "YAf"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "YAf"}], "-", 
                    "YAwf"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"XAf", "+", "XAwf"}], ")"}], " ", "Yawm"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwf", " ", "Yam"}], "-", 
                    RowBox[{"Xam", " ", "YAwf"}], "-", 
                    RowBox[{"XAf", " ", "Yawm"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], "+", 
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "Yawf"}], "+", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"Xaf", " ", "Yawm"}], "+", 
                    RowBox[{"Xawf", " ", "Yawm"}], "+", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"2", " ", "Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawf", " ", "Yam"}], "-", 
                    RowBox[{"Xam", " ", "Yawf"}], "-", 
                    RowBox[{"Xaf", " ", "Yawm"}]}], ")"}]}], "-", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawf", " ", "Yam"}], "-", 
                    RowBox[{"Xam", " ", "Yawf"}], "-", 
                    RowBox[{"Xaf", " ", "Yawm"}]}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "FAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Yawf"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", "XAwm", "+", "YAm", "+", "YAwm"}], 
                    ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "XAwm", " ", 
                    "Yaf"}], "+", 
                    RowBox[{"r", " ", "Xawf", " ", "YAm"}], "+", 
                    RowBox[{"XAm", " ", "Yawf"}], "-", 
                    RowBox[{"r", " ", "XAm", " ", "Yawf"}], "+", 
                    RowBox[{"YAm", " ", "Yawf"}], "-", 
                    RowBox[{"r", " ", "Xaf", " ", "YAwm"}], "-", 
                    RowBox[{"Yaf", " ", "YAwm"}]}], ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", "XAwm"}], ")"}], " ", "Yawf"}], "-", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"YAm", "+", "YAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "Yaf"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xam", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAm", " ", "YAf"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAwm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newYawf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newYawf", ">", "1"}], ",", "1", ",", "newYawf"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextYAf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "YAfinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextYaf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "Yafinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextYAwf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "YAwfinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextYawf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "Yawfinit"}]}], "Input",
 CellChangeTimes->{{3.677609169639257*^9, 3.677609254342773*^9}, {
   3.67760929940635*^9, 3.677609319747704*^9}, {3.677609415700798*^9, 
   3.677609588703081*^9}, {3.677609626847389*^9, 3.677609758420228*^9}, {
   3.6776097885539618`*^9, 3.677609937619573*^9}, {3.677610469673553*^9, 
   3.677610530805957*^9}, {3.677610564938963*^9, 3.677610911957862*^9}, {
   3.677610959883894*^9, 3.677611207705814*^9}, {3.677611280462638*^9, 
   3.677611329886663*^9}, {3.6776114444636097`*^9, 3.677611452511242*^9}, {
   3.6776115544456167`*^9, 3.677611643514182*^9}, {3.677611880451057*^9, 
   3.6776119521557693`*^9}, {3.677614977297264*^9, 3.677614988912305*^9}, 
   3.686298060732992*^9, 3.686298095916047*^9, 3.686298163765136*^9, 
   3.686298199544956*^9, {3.6868456181106567`*^9, 3.686845654670354*^9}, {
   3.6868456876220922`*^9, 3.686845829286622*^9}, {3.686848977421198*^9, 
   3.68684898831782*^9}, {3.686849076915498*^9, 3.686849111066196*^9}, {
   3.68684947376639*^9, 3.6868494840870457`*^9}, {3.68684952888034*^9, 
   3.6868495849952393`*^9}, {3.686849888399626*^9, 3.686849894363731*^9}, {
   3.686850458198414*^9, 3.686850473410449*^9}, {3.686850571407963*^9, 
   3.6868506006261587`*^9}, {3.686850970209588*^9, 3.686850981188836*^9}, {
   3.686896247686873*^9, 3.6868962999078712`*^9}, {3.710697591045042*^9, 
   3.710697638946176*^9}, {3.710702191063511*^9, 3.7107022314242773`*^9}},
 ExpressionUUID -> "621c0723-5693-40be-a8b0-3892a383561d"]
}, Closed]],

Cell[CellGroupData[{

Cell["Next male Y genotypes", "Subsubsection",
 CellChangeTimes->{{3.677611980190652*^9, 3.67761198259653*^9}, {
  3.68684588801789*^9, 3.686845889767214*^9}},
 ExpressionUUID -> "4214dcc1-828a-4df6-8869-1ccac50eaef2"],

Cell["\<\
The recursions we are interested in here (Y haplotypes in males) are\
\>", "Text",
 CellChangeTimes->{{3.68629822127835*^9, 3.6862982457153683`*^9}},
 ExpressionUUID -> "68ae238e-1042-4029-aa6f-5ed66efeabc8"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "a", ",", "M", ",", "het"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "A", ",", "m", ",", "het"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "a", ",", "m", ",", "het"}]]}], 
               "\[IndentingNewLine]", "}"}], "/.", "sumsex"}], "/.", 
             "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.", "pseg2"}], "/.",
          "pseg3"}], "/.", "pseg4"}], "/.", "varsub"}], "/.", "freqsub"}], "/.",
      "recGen"}], "/.", "\[Chi]XAM"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.6862966589469748`*^9, 3.686296717880542*^9}, {
   3.686296747934804*^9, 3.686296786862547*^9}, {3.68629684000347*^9, 
   3.68629684491601*^9}, {3.686297189457762*^9, 3.686297227327464*^9}, {
   3.68629728886543*^9, 3.686297327319368*^9}, {3.6862973714134617`*^9, 
   3.686297381496122*^9}, {3.6862975036457777`*^9, 3.686297503772242*^9}, 
   3.686297547660756*^9, {3.686297586181828*^9, 3.686297611312278*^9}, {
   3.686297744175549*^9, 3.686297756982986*^9}, {3.686297993210198*^9, 
   3.686298027725922*^9}, {3.6862982481327467`*^9, 3.6862982593265257`*^9}, {
   3.686845844215847*^9, 3.686845844952545*^9}, {3.68684590657493*^9, 
   3.686845906706205*^9}, {3.686845962924066*^9, 3.68684596315875*^9}, {
   3.686846026759386*^9, 3.686846027018223*^9}, 3.686846060917894*^9, {
   3.686849658795946*^9, 3.686849660641582*^9}, {3.686896316081553*^9, 
   3.6868963250870867`*^9}, 3.6868964436673317`*^9, 3.686915998421071*^9, 
   3.69119825856627*^9, {3.710697660460335*^9, 3.7106976811264277`*^9}, 
   3.710697763396846*^9, 3.7107022427452517`*^9, 3.710702316600687*^9},
 ExpressionUUID -> "d53e1dfd-cc9e-4319-a47a-5f5c3bfcb41e"],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nextYAm", ",", "nextYam", ",", "nextYAwm", ",", "nextYawm"}], 
  "]"}]], "Input",
 ExpressionUUID -> "e67779da-7f3b-4489-a6f8-5dd30e4e9b7a"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nextYAm", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   RowBox[{
    RowBox[{"nextYAm", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newYAm", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"FA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "Ma", " ", "MAa", " ", "MdA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Xawm", " ", 
                    "YAf"}], "-", 
                   RowBox[{"YAf", " ", "Yam"}], "-", 
                   RowBox[{"R", " ", "Xam", " ", "YAwf"}], "+", 
                   RowBox[{"k", " ", "R", " ", "Xam", " ", "YAwf"}], "-", 
                   RowBox[{"R", " ", "Yam", " ", "YAwf"}], "+", 
                   RowBox[{"k", " ", "R", " ", "Yam", " ", "YAwf"}], "-", 
                   RowBox[{"YAf", " ", "Yawm"}], "+", 
                   RowBox[{"k", " ", "YAf", " ", "Yawm"}], "+", 
                   RowBox[{"R", " ", "YAf", " ", "Yawm"}], "-", 
                   RowBox[{"k", " ", "R", " ", "YAf", " ", "Yawm"}], "-", 
                   RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwf", " ", "Yam"}], "-", 
                    RowBox[{"Xam", " ", "YAwf"}]}], ")"}]}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"MA", " ", "MAA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "R", "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", "XAwm", 
                    " ", "YAf"}], "-", 
                   RowBox[{"XAwf", " ", "YAm"}], "+", 
                   RowBox[{"k", " ", "XAwf", " ", "YAm"}], "+", 
                   RowBox[{"r", " ", "XAwf", " ", "YAm"}], "-", 
                   RowBox[{"k", " ", "r", " ", "XAwf", " ", "YAm"}], "+", 
                   RowBox[{"R", " ", "XAwf", " ", "YAm"}], "-", 
                   RowBox[{"k", " ", "R", " ", "XAwf", " ", "YAm"}], "-", 
                   RowBox[{"2", " ", "r", " ", "R", " ", "XAwf", " ", "YAm"}],
                    "+", 
                   RowBox[{
                   "2", " ", "k", " ", "r", " ", "R", " ", "XAwf", " ", 
                    "YAm"}], "-", 
                   RowBox[{"2", " ", "YAf", " ", "YAm"}], "-", 
                   RowBox[{"r", " ", "XAm", " ", "YAwf"}], "+", 
                   RowBox[{"k", " ", "r", " ", "XAm", " ", "YAwf"}], "-", 
                   RowBox[{"R", " ", "XAm", " ", "YAwf"}], "+", 
                   RowBox[{"k", " ", "R", " ", "XAm", " ", "YAwf"}], "+", 
                   RowBox[{"2", " ", "r", " ", "R", " ", "XAm", " ", "YAwf"}],
                    "-", 
                   RowBox[{
                   "2", " ", "k", " ", "r", " ", "R", " ", "XAm", " ", 
                    "YAwf"}], "-", 
                   RowBox[{"YAm", " ", "YAwf"}], "+", 
                   RowBox[{"k", " ", "YAm", " ", "YAwf"}], "-", 
                   RowBox[{"YAf", " ", "YAwm"}], "+", 
                   RowBox[{"k", " ", "YAf", " ", "YAwm"}], "-", 
                   RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "-", "R", "+", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "YAwm"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"2", " ", "Fa", " ", "MA", " ", "MAa", " ", "MdA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "Xaf"}], " ", "YAm"}], "-", 
                RowBox[{"Xawf", " ", "YAm"}], "+", 
                RowBox[{"k", " ", "Xawf", " ", "YAm"}], "+", 
                RowBox[{"R", " ", "Xawf", " ", "YAm"}], "-", 
                RowBox[{"k", " ", "R", " ", "Xawf", " ", "YAm"}], "-", 
                RowBox[{"Yaf", " ", "YAm"}], "-", 
                RowBox[{"YAm", " ", "Yawf"}], "+", 
                RowBox[{"k", " ", "YAm", " ", "Yawf"}], "+", 
                RowBox[{"R", " ", "YAm", " ", "Yawf"}], "-", 
                RowBox[{"k", " ", "R", " ", "YAm", " ", "Yawf"}], "-", 
                RowBox[{"R", " ", "Xaf", " ", "YAwm"}], "+", 
                RowBox[{"k", " ", "R", " ", "Xaf", " ", "YAwm"}], "-", 
                RowBox[{"R", " ", "Yaf", " ", "YAwm"}], "+", 
                RowBox[{"k", " ", "R", " ", "Yaf", " ", "YAwm"}], "+", 
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Xaf", " ", "YAm"}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawf", " ", "YAm"}], "-", 
                    RowBox[{"XAm", " ", "Yawf"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawf", " ", "YAm"}], "-", 
                    RowBox[{"XAm", " ", "Yawf"}], "-", 
                    RowBox[{"Xaf", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "Maa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yam"}], "-", 
                    RowBox[{"Yaf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yawf"}], "-", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yawm"}], "-", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "Yawm"}], "-", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAm"}], "-", 
                    RowBox[{"Yaf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yawf"}], "-", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAwm"}], "-", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "YAwm"}], "-", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yam"}], "-", 
                    RowBox[{"YAf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAwf"}], "-", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yawm"}], "-", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "Yawm"}], "-", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAm"}], "-", 
                    RowBox[{"YAf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAwf"}], "-", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAwm"}], "-", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "YAwm"}], "-", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newYAm", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newYAm", ">", "1"}], ",", "1", ",", "newYAm"}], "]"}]}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextYam", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYam", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newYam", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "FA", " ", "Ma", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "XAf"}], " ", "Yam"}], "-", 
                RowBox[{"XAwf", " ", "Yam"}], "+", 
                RowBox[{"k", " ", "XAwf", " ", "Yam"}], "+", 
                RowBox[{"R", " ", "XAwf", " ", "Yam"}], "-", 
                RowBox[{"k", " ", "R", " ", "XAwf", " ", "Yam"}], "-", 
                RowBox[{"YAf", " ", "Yam"}], "-", 
                RowBox[{"Yam", " ", "YAwf"}], "+", 
                RowBox[{"k", " ", "Yam", " ", "YAwf"}], "+", 
                RowBox[{"R", " ", "Yam", " ", "YAwf"}], "-", 
                RowBox[{"k", " ", "R", " ", "Yam", " ", "YAwf"}], "-", 
                RowBox[{"R", " ", "XAf", " ", "Yawm"}], "+", 
                RowBox[{"k", " ", "R", " ", "XAf", " ", "Yawm"}], "-", 
                RowBox[{"R", " ", "YAf", " ", "Yawm"}], "+", 
                RowBox[{"k", " ", "R", " ", "YAf", " ", "Yawm"}], "+", 
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"XAf", " ", "Yam"}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwf", " ", "Yam"}], "-", 
                    RowBox[{"Xam", " ", "YAwf"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"XAwf", " ", "Yam"}], "-", 
                    RowBox[{"Xam", " ", "YAwf"}], "-", 
                    RowBox[{"XAf", " ", "Yawm"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], "+", 
             RowBox[{"Fa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Ma", " ", "Maa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "R", "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", "Xawm", 
                    " ", "Yaf"}], "-", 
                   RowBox[{"Xawf", " ", "Yam"}], "+", 
                   RowBox[{"k", " ", "Xawf", " ", "Yam"}], "+", 
                   RowBox[{"r", " ", "Xawf", " ", "Yam"}], "-", 
                   RowBox[{"k", " ", "r", " ", "Xawf", " ", "Yam"}], "+", 
                   RowBox[{"R", " ", "Xawf", " ", "Yam"}], "-", 
                   RowBox[{"k", " ", "R", " ", "Xawf", " ", "Yam"}], "-", 
                   RowBox[{"2", " ", "r", " ", "R", " ", "Xawf", " ", "Yam"}],
                    "+", 
                   RowBox[{
                   "2", " ", "k", " ", "r", " ", "R", " ", "Xawf", " ", 
                    "Yam"}], "-", 
                   RowBox[{"2", " ", "Yaf", " ", "Yam"}], "-", 
                   RowBox[{"r", " ", "Xam", " ", "Yawf"}], "+", 
                   RowBox[{"k", " ", "r", " ", "Xam", " ", "Yawf"}], "-", 
                   RowBox[{"R", " ", "Xam", " ", "Yawf"}], "+", 
                   RowBox[{"k", " ", "R", " ", "Xam", " ", "Yawf"}], "+", 
                   RowBox[{"2", " ", "r", " ", "R", " ", "Xam", " ", "Yawf"}],
                    "-", 
                   RowBox[{
                   "2", " ", "k", " ", "r", " ", "R", " ", "Xam", " ", 
                    "Yawf"}], "-", 
                   RowBox[{"Yam", " ", "Yawf"}], "+", 
                   RowBox[{"k", " ", "Yam", " ", "Yawf"}], "-", 
                   RowBox[{"Yaf", " ", "Yawm"}], "+", 
                   RowBox[{"k", " ", "Yaf", " ", "Yawm"}], "-", 
                   RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "-", "R", "+", 
                    RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
                    "Yawm"}]}], ")"}]}]}], ")"}]}], "-", 
                RowBox[{"2", " ", "MA", " ", "MAa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "XAwm", " ", 
                    "Yaf"}], "-", 
                   RowBox[{"Yaf", " ", "YAm"}], "-", 
                   RowBox[{"R", " ", "XAm", " ", "Yawf"}], "+", 
                   RowBox[{"k", " ", "R", " ", "XAm", " ", "Yawf"}], "-", 
                   RowBox[{"R", " ", "YAm", " ", "Yawf"}], "+", 
                   RowBox[{"k", " ", "R", " ", "YAm", " ", "Yawf"}], "-", 
                   RowBox[{"Yaf", " ", "YAwm"}], "+", 
                   RowBox[{"k", " ", "Yaf", " ", "YAwm"}], "+", 
                   RowBox[{"R", " ", "Yaf", " ", "YAwm"}], "-", 
                   RowBox[{"k", " ", "R", " ", "Yaf", " ", "YAwm"}], "-", 
                   RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawf", " ", "YAm"}], "-", 
                    RowBox[{"XAm", " ", "Yawf"}]}], ")"}]}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{"YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "Maa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yam"}], "-", 
                    RowBox[{"Yaf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yawf"}], "-", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yawm"}], "-", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "Yawm"}], "-", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAm"}], "-", 
                    RowBox[{"Yaf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yawf"}], "-", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAwm"}], "-", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "YAwm"}], "-", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yam"}], "-", 
                    RowBox[{"YAf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAwf"}], "-", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yawm"}], "-", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "Yawm"}], "-", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAm"}], "-", 
                    RowBox[{"YAf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAwf"}], "-", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAwm"}], "-", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "YAwm"}], "-", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newYam", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newYam", ">", "1"}], ",", "1", ",", "newYam"}], "]"}]}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextYAwm", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYAwm", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newYAwm", "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "2", " ", "Fa", " ", "MA", " ", "MAa", " ", "MdA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"Xaf", "+", "Xawf", "+", "Yaf", "+", "Yawf"}], 
                    ")"}]}], " ", "YAwm"}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "YAm"}], "-", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Xaf", "+", "Yaf"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}], "+", 
                   RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Yaf"}], "-", 
                    "Yawf"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Xaf", "+", "Xawf"}], ")"}], " ", "YAwm"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawf", " ", "YAm"}], "-", 
                    RowBox[{"XAm", " ", "Yawf"}], "-", 
                    RowBox[{"Xaf", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{"FA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", "Ma", " ", "MAa", " ", "MdA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "YAwf"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", "Xawm", "+", "Yam", "+", "Yawm"}], 
                    ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "Xawm", " ", 
                    "YAf"}], "+", 
                    RowBox[{"r", " ", "XAwf", " ", "Yam"}], "+", 
                    RowBox[{"Xam", " ", "YAwf"}], "-", 
                    RowBox[{"r", " ", "Xam", " ", "YAwf"}], "+", 
                    RowBox[{"Yam", " ", "YAwf"}], "-", 
                    RowBox[{"r", " ", "XAf", " ", "Yawm"}], "-", 
                    RowBox[{"YAf", " ", "Yawm"}]}], ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Xam", "+", "Xawm"}], ")"}], " ", "YAwf"}], "-", 
                    RowBox[{"XAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Yam", "+", "Yawm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                   RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAm"}], " ", "YAwf"}], "-", 
                    RowBox[{"XAwm", " ", "YAwf"}], "-", 
                    RowBox[{"YAm", " ", "YAwf"}], "-", 
                    RowBox[{"XAf", " ", "YAwm"}], "-", 
                    RowBox[{"XAwf", " ", "YAwm"}], "-", 
                    RowBox[{"YAf", " ", "YAwm"}], "-", 
                    RowBox[{"2", " ", "YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"XAwf", " ", "YAm"}], "-", 
                    RowBox[{"XAm", " ", "YAwf"}], "-", 
                    RowBox[{"XAf", " ", "YAwm"}]}], ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwm"}], " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "YAm"}], "+", 
                    RowBox[{"XAm", " ", "YAwf"}], "+", 
                    RowBox[{"XAf", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], ")"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "Maa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yam"}], "-", 
                    RowBox[{"Yaf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yawf"}], "-", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yawm"}], "-", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "Yawm"}], "-", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAm"}], "-", 
                    RowBox[{"Yaf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yawf"}], "-", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAwm"}], "-", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "YAwm"}], "-", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yam"}], "-", 
                    RowBox[{"YAf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAwf"}], "-", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yawm"}], "-", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "Yawm"}], "-", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAm"}], "-", 
                    RowBox[{"YAf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAwf"}], "-", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAwm"}], "-", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "YAwm"}], "-", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newYAwm", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newYAwm", ">", "1"}], ",", "1", ",", "newYAwm"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextYawm", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
     "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
     "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
     "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
     "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYawm", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
      "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
      "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
      "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
      "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"XAf", "=", 
         RowBox[{"nextXAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xaf", "=", 
         RowBox[{"nextXaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwf", "=", 
         RowBox[{"nextXAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawf", "=", 
         RowBox[{"nextXawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"XAm", "=", 
         RowBox[{"nextXAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xam", "=", 
         RowBox[{"nextXam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"XAwm", "=", 
         RowBox[{"nextXAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Xawm", "=", 
         RowBox[{"nextXawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAf", "=", 
         RowBox[{"nextYAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yaf", "=", 
         RowBox[{"nextYaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwf", "=", 
         RowBox[{"nextYAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawf", "=", 
         RowBox[{"nextYawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"YAm", "=", 
         RowBox[{"nextYAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yam", "=", 
         RowBox[{"nextYam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"YAwm", "=", 
         RowBox[{"nextYAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Yawm", "=", 
         RowBox[{"nextYawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", 
           ",", "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", 
           ",", "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", 
           ",", "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{"Next", ",", " ", 
        RowBox[{
        "the", " ", "recursion", " ", "equations", " ", "are", " ", "written",
          " ", "out"}], ",", " ", 
        RowBox[{
         RowBox[{
         "we", " ", "assume", " ", "here", " ", "that", " ", "\[Chi]"}], "=", 
         
         RowBox[{"R", "*", "r"}]}]}], " ", "*)"}], "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newYawm", "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "FA", " ", "Ma", " ", "MAa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"XAf", "+", "XAwf", "+", "YAf", "+", "YAwf"}], 
                    ")"}]}], " ", "Yawm"}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "Yam"}], "-", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"XAf", "+", "YAf"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}], "+", 
                   RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "YAf"}], "-", 
                    "YAwf"}], ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"XAf", "+", "XAwf"}], ")"}], " ", "Yawm"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"XAwf", " ", "Yam"}], "-", 
                    RowBox[{"Xam", " ", "YAwf"}], "-", 
                    RowBox[{"XAf", " ", "Yawm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{"Fa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xam"}], " ", "Yawf"}], "-", 
                    RowBox[{"Xawm", " ", "Yawf"}], "-", 
                    RowBox[{"Yam", " ", "Yawf"}], "-", 
                    RowBox[{"Xaf", " ", "Yawm"}], "-", 
                    RowBox[{"Xawf", " ", "Yawm"}], "-", 
                    RowBox[{"Yaf", " ", "Yawm"}], "-", 
                    RowBox[{"2", " ", "Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"Xawf", " ", "Yam"}], "-", 
                    RowBox[{"Xam", " ", "Yawf"}], "-", 
                    RowBox[{"Xaf", " ", "Yawm"}]}], ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawm"}], " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "Yam"}], "+", 
                    RowBox[{"Xam", " ", "Yawf"}], "+", 
                    RowBox[{"Xaf", " ", "Yawm"}]}], ")"}]}]}], ")"}]}], "-", 
                   RowBox[{"2", " ", "MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Yawf"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", "XAwm", "+", "YAm", "+", "YAwm"}], 
                    ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "XAwm", " ", 
                    "Yaf"}], "+", 
                    RowBox[{"r", " ", "Xawf", " ", "YAm"}], "+", 
                    RowBox[{"XAm", " ", "Yawf"}], "-", 
                    RowBox[{"r", " ", "XAm", " ", "Yawf"}], "+", 
                    RowBox[{"YAm", " ", "Yawf"}], "-", 
                    RowBox[{"r", " ", "Xaf", " ", "YAwm"}], "-", 
                    RowBox[{"Yaf", " ", "YAwm"}]}], ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"XAm", "+", "XAwm"}], ")"}], " ", "Yawf"}], "-", 
                    RowBox[{"Xawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"YAm", "+", "YAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "Maa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yam"}], "-", 
                    RowBox[{"Yaf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "Yawf"}], "-", 
                    RowBox[{"Yam", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "Yawm"}], "-", 
                    RowBox[{"Yaf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "Yawm"}], "-", 
                    RowBox[{"Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "Yawm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Xawf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "Yaf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yaf"}], "-", 
                    RowBox[{"Xawf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAm"}], "-", 
                    RowBox[{"Yaf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "Yawf"}], "-", 
                    RowBox[{"YAm", " ", "Yawf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "Yawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "-", 
                    RowBox[{"Xawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Xawf", " ", "YAwm"}], "-", 
                    RowBox[{"Yaf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yaf", " ", "YAwm"}], "-", 
                    RowBox[{"Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "Yawf", " ", "YAwm"}], "+", 
                    RowBox[{"Xaf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "Xawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Xawm"}], "-", 
                    RowBox[{"Xawm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "Yam"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yam"}], "-", 
                    RowBox[{"YAf", " ", "Yam"}], "-", 
                    RowBox[{"Xawm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Xawm", " ", "YAwf"}], "-", 
                    RowBox[{"Yam", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "Yam", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "Yawm"}], "-", 
                    RowBox[{"YAf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "Yawm"}], "-", 
                    RowBox[{"YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "Yawm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xawm"}], "-",
                     "Yam", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Yawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "XAwf"}], " ", "XAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "XAwm"}], "-", 
                    RowBox[{"XAwm", " ", "YAf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAf"}], "-", 
                    RowBox[{"XAwf", " ", "YAm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAm"}], "-", 
                    RowBox[{"YAf", " ", "YAm"}], "-", 
                    RowBox[{"XAwm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "XAwm", " ", "YAwf"}], "-", 
                    RowBox[{"YAm", " ", "YAwf"}], "+", 
                    RowBox[{"k", " ", "YAm", " ", "YAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "-", 
                    RowBox[{"XAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "XAwf", " ", "YAwm"}], "-", 
                    RowBox[{"YAf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAf", " ", "YAwm"}], "-", 
                    RowBox[{"YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"k", " ", "YAwf", " ", "YAwm"}], "+", 
                    RowBox[{"XAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAwm"}], "-",
                     "YAm", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "YAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newYawm", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newYawm", ">", "1"}], ",", "1", ",", "newYawm"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextYAm", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "YAminit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextYam", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "Yaminit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextYAwm", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "YAwminit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextYawm", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  "Yawminit"}]}], "Input",
 CellChangeTimes->CompressedData["
1:eJwdx00owwEAhvHRyoFWcjFGSallbb6Wyw7bsiyKUuRjopW1NAxrbW22ko9l
Wdtl1gqlbUmak2HKxFJmm2UphyVFW4y1i21pxv/d4enX0yCeG5gqJZFINCJ4
p+iwayRJ3l824IAPpJkD2PqVPYRpWeYUOvTWMIzUjUXh8kLoFVK8lgQ0Rtt/
oG/zmKMllARGumC+fEcIw67CIowJ82pYZs3YYCpE2YPGCc4+fHs0eWC1yHwC
dfw+P2Qq5Pfww+x9gnwWOw61ekYeKp/t5CVC8ppUCfurWtRw451qheGb+S0o
CwomdYQXo/pZaPAIdJDvlBSNBWNnVFWSJ86kfFBeqPFD4YspDKVJJqcWr/kU
QKW2Yh1un+cMUDXU7IaRwaOiXLMlA9306xx0VXrZNMISPrsTXrkuBSzCuOa2
GzK+ueNthOk8XQKVTfR6mzPJ2+1ZbYQJXe+wnXD6d0UE/wE8OOp2
  "],
 ExpressionUUID -> "3ff2630f-de24-453c-8a41-2827440422e0"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sex ratio at birth", "Subsubsection",
 CellChangeTimes->{{3.6869215593469954`*^9, 3.686921563475671*^9}},
 ExpressionUUID -> "ad761b3c-1e10-4855-8eba-e5dda4e4e893"],

Cell["the frequency of males", "Text",
 CellChangeTimes->{{3.710693605684939*^9, 3.710693608940333*^9}, {
  3.710697837451817*^9, 3.710697837601562*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ParallelSum", "[", 
          RowBox[{
           SubscriptBox["fDipSex", 
            RowBox[{
            "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
             "het"}]], ",", 
           RowBox[{"{", 
            RowBox[{"xM", ",", 
             RowBox[{"{", 
              RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"yM", ",", 
             RowBox[{"{", 
              RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zM", ",", 
             RowBox[{"{", 
              RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xP", ",", 
             RowBox[{"{", 
              RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"yP", ",", 
             RowBox[{"{", 
              RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zP", ",", 
             RowBox[{"{", 
              RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"ParallelSum", "[", 
          RowBox[{
           SubscriptBox["fDipSex", 
            RowBox[{
            "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
             "sex"}]], ",", 
           RowBox[{"{", 
            RowBox[{"xM", ",", 
             RowBox[{"{", 
              RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"yM", ",", 
             RowBox[{"{", 
              RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zM", ",", 
             RowBox[{"{", 
              RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xP", ",", 
             RowBox[{"{", 
              RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"yP", ",", 
             RowBox[{"{", 
              RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zP", ",", 
             RowBox[{"{", 
              RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"sex", ",", 
             RowBox[{"{", 
              RowBox[{"het", ",", "hom"}], "}"}]}], "}"}]}], "]"}], ")"}]}], "/.",
        "freqsub"}], "/.", "sumsex"}], "/.", "invXY"}], "/.", "varsub"}], "//",
    "Simplify"}], "*)"}]], "Input",
 CellChangeTimes->{{3.708109679877839*^9, 3.7081096859397078`*^9}, {
   3.71069449584134*^9, 3.710694497737994*^9}, {3.7106945447999563`*^9, 
   3.7106945645522547`*^9}, {3.71069466869072*^9, 3.710694671755224*^9}, {
   3.710694704064241*^9, 3.710694766228612*^9}, 3.7106949140433893`*^9, {
   3.71069778519057*^9, 3.710697841583333*^9}, 3.710699281242062*^9, {
   3.710702326391404*^9, 3.7107023419245234`*^9}},
 ExpressionUUID -> "f3daabac-0f9e-442a-8969-3d97f297e044"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "sexRatioAtBirth", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sexRatioAtBirth", "[", 
   RowBox[{
   "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",",
     "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "XAfinit_", ",", 
    "Xafinit_", ",", "XAwfinit_", ",", "Xawfinit_", ",", "XAminit_", ",", 
    "Xaminit_", ",", "XAwminit_", ",", "Xawminit_", ",", "YAfinit_", ",", 
    "Yafinit_", ",", "YAwfinit_", ",", "Yawfinit_", ",", "YAminit_", ",", 
    "Yaminit_", ",", "YAwminit_", ",", "Yawminit_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"sexRatioAtBirth", "[", 
    RowBox[{
    "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
     "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
     ",", "MdA", ",", "FdA", ",", "k", ",", "XAfinit", ",", "Xafinit", ",", 
     "XAwfinit", ",", "Xawfinit", ",", "XAminit", ",", "Xaminit", ",", 
     "XAwminit", ",", "Xawminit", ",", "YAfinit", ",", "Yafinit", ",", 
     "YAwfinit", ",", "Yawfinit", ",", "YAminit", ",", "Yaminit", ",", 
     "YAwminit", ",", "Yawminit"}], "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"XAf", "=", 
        RowBox[{"nextXAf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Xaf", "=", 
        RowBox[{"nextXaf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"XAwf", "=", 
        RowBox[{"nextXAwf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Xawf", "=", 
        RowBox[{"nextXawf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"XAm", "=", 
        RowBox[{"nextXAm", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Xam", "=", 
        RowBox[{"nextXam", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"XAwm", "=", 
        RowBox[{"nextXAwm", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Xawm", "=", 
        RowBox[{"nextXawm", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"YAf", "=", 
        RowBox[{"nextYAf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Yaf", "=", 
        RowBox[{"nextYaf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"YAwf", "=", 
        RowBox[{"nextYAwf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Yawf", "=", 
        RowBox[{"nextYawf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"YAm", "=", 
        RowBox[{"nextYAm", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Yam", "=", 
        RowBox[{"nextYam", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"YAwm", "=", 
        RowBox[{"nextYAwm", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Yawm", "=", 
        RowBox[{"nextYawm", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "XAfinit", ",", "Xafinit", ",", "XAwfinit", ",", "Xawfinit", ",", 
          "XAminit", ",", "Xaminit", ",", "XAwminit", ",", "Xawminit", ",", 
          "YAfinit", ",", "Yafinit", ",", "YAwfinit", ",", "Yawfinit", ",", 
          "YAminit", ",", "Yaminit", ",", "YAwminit", ",", "Yawminit"}], 
         "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ma", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Xawf", " ", "Xawm"}], "-", 
              RowBox[{"k", " ", "Xawf", " ", "Xawm"}], "+", 
              RowBox[{"Xawm", " ", "Yaf"}], "-", 
              RowBox[{"k", " ", "Xawm", " ", "Yaf"}], "+", 
              RowBox[{"Xawf", " ", "Yam"}], "-", 
              RowBox[{"k", " ", "Xawf", " ", "Yam"}], "+", 
              RowBox[{"Yaf", " ", "Yam"}], "+", 
              RowBox[{"Xawm", " ", "Yawf"}], "-", 
              RowBox[{"k", " ", "Xawm", " ", "Yawf"}], "+", 
              RowBox[{"Yam", " ", "Yawf"}], "-", 
              RowBox[{"k", " ", "Yam", " ", "Yawf"}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
               RowBox[{"(", 
                RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
              RowBox[{"Xawf", " ", "Yawm"}], "-", 
              RowBox[{"k", " ", "Xawf", " ", "Yawm"}], "+", 
              RowBox[{"Yaf", " ", "Yawm"}], "-", 
              RowBox[{"k", " ", "Yaf", " ", "Yawm"}], "+", 
              RowBox[{"Yawf", " ", "Yawm"}], "-", 
              RowBox[{"k", " ", "Yawf", " ", "Yawm"}], "+", 
              RowBox[{"Xaf", " ", 
               RowBox[{"(", 
                RowBox[{"Xawm", "-", 
                 RowBox[{"k", " ", "Xawm"}], "+", "Yam", "+", "Yawm", "-", 
                 RowBox[{"k", " ", "Yawm"}]}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"MA", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Xawf", " ", "XAwm"}], "-", 
              RowBox[{"k", " ", "Xawf", " ", "XAwm"}], "+", 
              RowBox[{"XAwm", " ", "Yaf"}], "-", 
              RowBox[{"k", " ", "XAwm", " ", "Yaf"}], "+", 
              RowBox[{"Xawf", " ", "YAm"}], "-", 
              RowBox[{"k", " ", "Xawf", " ", "YAm"}], "+", 
              RowBox[{"Yaf", " ", "YAm"}], "+", 
              RowBox[{"XAwm", " ", "Yawf"}], "-", 
              RowBox[{"k", " ", "XAwm", " ", "Yawf"}], "+", 
              RowBox[{"YAm", " ", "Yawf"}], "-", 
              RowBox[{"k", " ", "YAm", " ", "Yawf"}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
               RowBox[{"(", 
                RowBox[{"Xawf", "+", "Yawf"}], ")"}]}], "+", 
              RowBox[{"Xawf", " ", "YAwm"}], "-", 
              RowBox[{"k", " ", "Xawf", " ", "YAwm"}], "+", 
              RowBox[{"Yaf", " ", "YAwm"}], "-", 
              RowBox[{"k", " ", "Yaf", " ", "YAwm"}], "+", 
              RowBox[{"Yawf", " ", "YAwm"}], "-", 
              RowBox[{"k", " ", "Yawf", " ", "YAwm"}], "+", 
              RowBox[{"Xaf", " ", 
               RowBox[{"(", 
                RowBox[{"XAwm", "-", 
                 RowBox[{"k", " ", "XAwm"}], "+", "YAm", "+", "YAwm", "-", 
                 RowBox[{"k", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        "+", 
        RowBox[{"FA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ma", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"XAwf", " ", "Xawm"}], "-", 
              RowBox[{"k", " ", "XAwf", " ", "Xawm"}], "+", 
              RowBox[{"Xawm", " ", "YAf"}], "-", 
              RowBox[{"k", " ", "Xawm", " ", "YAf"}], "+", 
              RowBox[{"XAwf", " ", "Yam"}], "-", 
              RowBox[{"k", " ", "XAwf", " ", "Yam"}], "+", 
              RowBox[{"YAf", " ", "Yam"}], "+", 
              RowBox[{"Xawm", " ", "YAwf"}], "-", 
              RowBox[{"k", " ", "Xawm", " ", "YAwf"}], "+", 
              RowBox[{"Yam", " ", "YAwf"}], "-", 
              RowBox[{"k", " ", "Yam", " ", "YAwf"}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "Xam", " ", 
               RowBox[{"(", 
                RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
              RowBox[{"XAwf", " ", "Yawm"}], "-", 
              RowBox[{"k", " ", "XAwf", " ", "Yawm"}], "+", 
              RowBox[{"YAf", " ", "Yawm"}], "-", 
              RowBox[{"k", " ", "YAf", " ", "Yawm"}], "+", 
              RowBox[{"YAwf", " ", "Yawm"}], "-", 
              RowBox[{"k", " ", "YAwf", " ", "Yawm"}], "+", 
              RowBox[{"XAf", " ", 
               RowBox[{"(", 
                RowBox[{"Xawm", "-", 
                 RowBox[{"k", " ", "Xawm"}], "+", "Yam", "+", "Yawm", "-", 
                 RowBox[{"k", " ", "Yawm"}]}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"MA", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"XAwf", " ", "XAwm"}], "-", 
              RowBox[{"k", " ", "XAwf", " ", "XAwm"}], "+", 
              RowBox[{"XAwm", " ", "YAf"}], "-", 
              RowBox[{"k", " ", "XAwm", " ", "YAf"}], "+", 
              RowBox[{"XAwf", " ", "YAm"}], "-", 
              RowBox[{"k", " ", "XAwf", " ", "YAm"}], "+", 
              RowBox[{"YAf", " ", "YAm"}], "+", 
              RowBox[{"XAwm", " ", "YAwf"}], "-", 
              RowBox[{"k", " ", "XAwm", " ", "YAwf"}], "+", 
              RowBox[{"YAm", " ", "YAwf"}], "-", 
              RowBox[{"k", " ", "YAm", " ", "YAwf"}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "XAm", " ", 
               RowBox[{"(", 
                RowBox[{"XAwf", "+", "YAwf"}], ")"}]}], "+", 
              RowBox[{"XAwf", " ", "YAwm"}], "-", 
              RowBox[{"k", " ", "XAwf", " ", "YAwm"}], "+", 
              RowBox[{"YAf", " ", "YAwm"}], "-", 
              RowBox[{"k", " ", "YAf", " ", "YAwm"}], "+", 
              RowBox[{"YAwf", " ", "YAwm"}], "-", 
              RowBox[{"k", " ", "YAwf", " ", "YAwm"}], "+", 
              RowBox[{"XAf", " ", 
               RowBox[{"(", 
                RowBox[{"XAwm", "-", 
                 RowBox[{"k", " ", "XAwm"}], "+", "YAm", "+", "YAwm", "-", 
                 RowBox[{"k", " ", "YAwm"}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Fa", " ", 
           RowBox[{"(", 
            RowBox[{"Xaf", "+", "Xawf", "+", "Yaf", "+", "Yawf"}], ")"}]}], 
          "+", 
          RowBox[{"FA", " ", 
           RowBox[{"(", 
            RowBox[{"XAf", "+", "XAwf", "+", "YAf", "+", "YAwf"}], ")"}]}]}], 
         ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Ma", " ", 
           RowBox[{"(", 
            RowBox[{"Xam", "+", "Xawm", "+", "Yam", "+", "Yawm"}], ")"}]}], 
          "+", 
          RowBox[{"MA", " ", 
           RowBox[{"(", 
            RowBox[{"XAm", "+", "XAwm", "+", "YAm", "+", "YAwm"}], ")"}]}]}], 
         ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.677609169639257*^9, 3.677609254342773*^9}, {
   3.67760929940635*^9, 3.677609319747704*^9}, {3.677609415700798*^9, 
   3.677609588703081*^9}, {3.677609626847389*^9, 3.677609758420228*^9}, {
   3.6776097885539618`*^9, 3.677609937619573*^9}, {3.677610469673553*^9, 
   3.677610530805957*^9}, {3.677610564938963*^9, 3.677610911957862*^9}, {
   3.677610959883894*^9, 3.677611207705814*^9}, {3.677611280462638*^9, 
   3.677611329886663*^9}, {3.6776114444636097`*^9, 3.677611452511242*^9}, {
   3.6776115544456167`*^9, 3.677611643514182*^9}, {3.6776150177966127`*^9, 
   3.677615027913282*^9}, {3.677854288571733*^9, 3.677854339732052*^9}, 
   3.677854478718903*^9, 3.677854836410631*^9, {3.677854866656096*^9, 
   3.677854871949402*^9}, 3.677854940350132*^9, 3.67785507538221*^9, {
   3.6869216239344053`*^9, 3.6869217750384083`*^9}, {3.6869219638568897`*^9, 
   3.686922023370496*^9}, {3.686922457935526*^9, 3.686922479162925*^9}, 
   3.710694791694172*^9, 3.7106978581753073`*^9, 3.7107023463656178`*^9},
 ExpressionUUID -> "f820886b-f108-4c51-bf13-5c6c173769fb"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Recursions (ancestral ZW system)\
\>", "Subsection",
 CellChangeTimes->{{3.6776121236584253`*^9, 3.677612126514793*^9}, {
  3.7106970436645727`*^9, 3.710697048119747*^9}, {3.710698359171082*^9, 
  3.710698359401915*^9}},
 ExpressionUUID -> "97b97ed7-e2ae-4a4e-9a2a-4a08c663a976"],

Cell[CellGroupData[{

Cell["Find equilibrium frequencies of genotypes in each sex", "Subsubsection",
 CellChangeTimes->{{3.686891147472908*^9, 3.686891155322919*^9}, {
  3.6868936504126987`*^9, 3.686893664043786*^9}},
 ExpressionUUID -> "c94ab544-f332-4277-8161-e2d1f0b30c5e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"freqsubZW", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "A", ",", "M", ",", "hom"}]], "\[Rule]", "ZAm"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "a", ",", "M", ",", "hom"}]], "\[Rule]", "Zam"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "A", ",", "m", ",", "hom"}]], "\[Rule]", "ZAwm"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "a", ",", "m", ",", "hom"}]], "\[Rule]", "Zawm"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "A", ",", "M", ",", "hom"}]], "\[Rule]", "WAm"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "a", ",", "M", ",", "hom"}]], "\[Rule]", "Wam"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "A", ",", "m", ",", "hom"}]], "\[Rule]", "WAwm"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "a", ",", "m", ",", "hom"}]], "\[Rule]", "Wawm"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "A", ",", "M", ",", "het"}]], "\[Rule]", "ZAf"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "a", ",", "M", ",", "het"}]], "\[Rule]", "Zaf"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "A", ",", "m", ",", "het"}]], "\[Rule]", "ZAwf"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "a", ",", "m", ",", "het"}]], "\[Rule]", "Zawf"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]], "\[Rule]", "WAf"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "a", ",", "M", ",", "het"}]], "\[Rule]", "Waf"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "A", ",", "m", ",", "het"}]], "\[Rule]", "WAwf"}], 
     ",", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "a", ",", "m", ",", "het"}]], "\[Rule]", "Wawf"}]}],
     "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.686296931436901*^9, 3.6862971790382957`*^9}, {
  3.71069648718311*^9, 3.7106965786459312`*^9}, {3.710697887985385*^9, 
  3.7106979651597633`*^9}},
 ExpressionUUID -> "baaac4a1-e56d-4db3-a93f-66a740355603"],

Cell[BoxData[
 RowBox[{
  RowBox[{"varsubZW", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "A", ",", "hom"}]], "\[Rule]", "MAA"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "hom"}]], "\[Rule]", "MAa"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "hom"}]], "\[Rule]", "MAa"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "a", ",", "hom"}]], "\[Rule]", "Maa"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "A", ",", "het"}]], "\[Rule]", "FAA"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "het"}]], "\[Rule]", "FAa"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "het"}]], "\[Rule]", "FAa"}], ",", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "a", ",", "het"}]], "\[Rule]", "Faa"}], ",", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "het"}]], "\[Rule]", "FA"}], ",", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "het"}]], "\[Rule]", "Fa"}], ",", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "hom"}]], "\[Rule]", "MA"}], ",", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "hom"}]], "\[Rule]", "Ma"}], ",", 
     RowBox[{
      SubscriptBox["\[Alpha]", "het"], "\[Rule]", "FdA"}], ",", 
     RowBox[{
      SubscriptBox["\[Alpha]", "hom"], "\[Rule]", "MdA"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.710696615052511*^9, 3.710696657844563*^9}, {
  3.710697971567881*^9, 3.7106980090352077`*^9}, {3.710698040783744*^9, 
  3.7106980410061703`*^9}, {3.7107023834578743`*^9, 3.710702384937213*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"differenceEqs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", "\[IndentingNewLine]", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["fHapNext", 
                    RowBox[{"XZ", ",", "A", ",", "M", ",", "hom"}]], "-", 
                   SubscriptBox["fHap", 
                    RowBox[{"XZ", ",", "A", ",", "M", ",", "hom"}]]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["fHapNext", 
                    RowBox[{"XZ", ",", "a", ",", "M", ",", "hom"}]], "-", 
                   SubscriptBox["fHap", 
                    RowBox[{"XZ", ",", "a", ",", "M", ",", "hom"}]]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["fHapNext", 
                    RowBox[{"XZ", ",", "A", ",", "M", ",", "het"}]], "-", 
                   SubscriptBox["fHap", 
                    RowBox[{"XZ", ",", "A", ",", "M", ",", "het"}]]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["fHapNext", 
                    RowBox[{"XZ", ",", "a", ",", "M", ",", "het"}]], "-", 
                   SubscriptBox["fHap", 
                    RowBox[{"XZ", ",", "a", ",", "M", ",", "het"}]]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["fHapNext", 
                    RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]], "-", 
                   SubscriptBox["fHap", 
                    RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]]}], ",", 
                  "\[IndentingNewLine]", 
                  RowBox[{
                   SubscriptBox["fHapNext", 
                    RowBox[{"YW", ",", "a", ",", "M", ",", "het"}]], "-", 
                   SubscriptBox["fHap", 
                    RowBox[{"YW", ",", "a", ",", "M", ",", "het"}]]}]}], 
                 "\[IndentingNewLine]", "}"}], "/.", 
                RowBox[{
                 SubscriptBox["fHap", 
                  RowBox[{"x_", ",", "y_", ",", "m", ",", "sex_"}]], 
                 "\[Rule]", "0"}]}], "/.", "\[IndentingNewLine]", 
               RowBox[{
                SubscriptBox["fHap", 
                 RowBox[{"YW", ",", "y_", ",", "M", ",", "hom"}]], "\[Rule]", 
                "0"}]}], "/.", "sumsex"}], "/.", "invXY"}], "/.", "pseg0"}], "/.",
            "pseg1"}], "/.", "pseg2"}], "/.", "pseg3"}], "/.", "pseg4"}], "/.",
        "freqsubZW"}], "/.", "varsubZW"}], "/.", "recGen"}], "//", 
    "Simplify"}]}], "*)"}]], "Input",
 CellChangeTimes->{{3.686890952394562*^9, 3.6868911231027613`*^9}, {
   3.686891242573564*^9, 3.6868912699443827`*^9}, {3.6868927872610483`*^9, 
   3.6868928065125437`*^9}, {3.686892862719038*^9, 3.6868928831831217`*^9}, {
   3.686892919245523*^9, 3.686892948744776*^9}, {3.686893018487218*^9, 
   3.686893019357958*^9}, 3.686894546444447*^9, {3.706983858035534*^9, 
   3.706983876510975*^9}, {3.710696313311133*^9, 3.7106963157916594`*^9}, {
   3.7106964140888767`*^9, 3.710696416570651*^9}, {3.710696593592601*^9, 
   3.710696594610865*^9}, {3.710696664751421*^9, 3.710696674524659*^9}, {
   3.7106967368406076`*^9, 3.710696795124694*^9}, {3.710696876155877*^9, 
   3.7106968769932013`*^9}, 3.710697021221922*^9, {3.710698014557392*^9, 
   3.710698046997719*^9}, 3.710698227088357*^9},
 ExpressionUUID -> "b57f83a0-a58e-4207-a5ba-fa1fd988e5bc"],

Cell["Equilibria", "Text",
 CellChangeTimes->{{3.710698235528243*^9, 3.710698237398776*^9}}],

Cell[BoxData[{
 RowBox[{"Clear", "[", "equilZW", "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"equilZW", "[", 
   RowBox[{
   "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", "Maa_", 
    ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", "MdA_", 
    ",", "FdA_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
    "ZAm", ",", "Zam", ",", "ZAf", ",", "Zaf", ",", "WAf", ",", "Waf"}], 
    "}"}], "/.", 
   RowBox[{"NSolve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        FractionBox[
         RowBox[{
          RowBox[{"FA", " ", "ZAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ma", " ", "MAa", " ", "Zam", " ", 
              RowBox[{"(", 
               RowBox[{"MdA", "-", "ZAm"}], ")"}]}], "-", 
             RowBox[{"MA", " ", "MAA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "ZAm"}], ")"}], " ", "ZAm"}]}], 
            ")"}]}], "-", 
          RowBox[{"Fa", " ", "Zaf", " ", "ZAm", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ma", " ", "Maa", " ", "Zam"}], "+", 
             RowBox[{"MA", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "MdA"}], "+", "ZAm"}], ")"}]}]}], ")"}]}]}], 
         RowBox[{
          RowBox[{"Fa", " ", "Zaf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ma", " ", "Maa", " ", "Zam"}], "+", 
             RowBox[{"MA", " ", "MAa", " ", "ZAm"}]}], ")"}]}], "+", 
          RowBox[{"FA", " ", "ZAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Ma", " ", "MAa", " ", "Zam"}], "+", 
             RowBox[{"MA", " ", "MAA", " ", "ZAm"}]}], ")"}]}]}]], ",", 
        RowBox[{"-", 
         FractionBox[
          RowBox[{
           RowBox[{"FA", " ", "ZAf", " ", "Zam", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "MdA", "+", "Zam"}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAA", " ", "ZAm"}]}], ")"}]}], "+", 
           RowBox[{"Fa", " ", "Zaf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "Maa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "Zam"}], ")"}], " ", "Zam"}], "+", 
              RowBox[{"MA", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "MdA", "+", "Zam"}], ")"}], " ", 
               "ZAm"}]}], ")"}]}]}], 
          RowBox[{
           RowBox[{"Fa", " ", "Zaf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "Maa", " ", "Zam"}], "+", 
              RowBox[{"MA", " ", "MAa", " ", "ZAm"}]}], ")"}]}], "+", 
           RowBox[{"FA", " ", "ZAf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "MAa", " ", "Zam"}], "+", 
              RowBox[{"MA", " ", "MAA", " ", "ZAm"}]}], ")"}]}]}]]}], ",", 
        FractionBox[
         RowBox[{
          RowBox[{"FA", " ", "WAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "FAa", " ", "Ma", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"FdA", " ", "r"}], "-", "ZAf"}], ")"}], " ", "Zam"}], 
             "+", 
             RowBox[{"FAA", " ", "MA", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "ZAf"}]}], ")"}], " ", "ZAm"}]}], ")"}]}], 
          "-", 
          RowBox[{"2", " ", "Fa", " ", "Waf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Faa", " ", "Ma", " ", "ZAf", " ", "Zam"}], "+", 
             RowBox[{"FAa", " ", "MA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"FdA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "r"}], ")"}]}], "+", "ZAf"}], 
               ")"}], " ", "ZAm"}]}], ")"}]}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Fa", " ", "Waf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Faa", " ", "Ma", " ", "Zam"}], "+", 
               RowBox[{"FAa", " ", "MA", " ", "ZAm"}]}], ")"}]}], "+", 
            RowBox[{"FA", " ", "WAf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FAa", " ", "Ma", " ", "Zam"}], "+", 
               RowBox[{"FAA", " ", "MA", " ", "ZAm"}]}], ")"}]}]}], ")"}]}]], 
        ",", 
        FractionBox[
         RowBox[{
          RowBox[{"2", " ", "FA", " ", "WAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"FAa", " ", "Ma", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"FdA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "r"}], ")"}]}], "-", "r", "-", 
                "Zaf"}], ")"}], " ", "Zam"}], "-", 
             RowBox[{"FAA", " ", "MA", " ", "Zaf", " ", "ZAm"}]}], ")"}]}], 
          "+", 
          RowBox[{"Fa", " ", "Waf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Faa", " ", "Ma", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "Zaf"}]}], ")"}], " ", "Zam"}], "-", 
             RowBox[{"2", " ", "FAa", " ", "MA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "r"}], "+", 
                "Zaf"}], ")"}], " ", "ZAm"}]}], ")"}]}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Fa", " ", "Waf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Faa", " ", "Ma", " ", "Zam"}], "+", 
               RowBox[{"FAa", " ", "MA", " ", "ZAm"}]}], ")"}]}], "+", 
            RowBox[{"FA", " ", "WAf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FAa", " ", "Ma", " ", "Zam"}], "+", 
               RowBox[{"FAA", " ", "MA", " ", "ZAm"}]}], ")"}]}]}], ")"}]}]], 
        ",", 
        FractionBox[
         RowBox[{
          RowBox[{"FA", " ", "WAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "FAa", " ", "Ma", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"FdA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "r"}], ")"}]}], "+", "WAf"}], 
               ")"}], " ", "Zam"}], "+", 
             RowBox[{"FAA", " ", "MA", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "WAf"}]}], ")"}], " ", "ZAm"}]}], ")"}]}], 
          "-", 
          RowBox[{"2", " ", "Fa", " ", "Waf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Faa", " ", "Ma", " ", "WAf", " ", "Zam"}], "+", 
             RowBox[{"FAa", " ", "MA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "FdA"}], " ", "r"}], "+", "WAf"}], ")"}], " ", 
              "ZAm"}]}], ")"}]}]}], 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Fa", " ", "Waf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Faa", " ", "Ma", " ", "Zam"}], "+", 
               RowBox[{"FAa", " ", "MA", " ", "ZAm"}]}], ")"}]}], "+", 
            RowBox[{"FA", " ", "WAf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FAa", " ", "Ma", " ", "Zam"}], "+", 
               RowBox[{"FAA", " ", "MA", " ", "ZAm"}]}], ")"}]}]}], ")"}]}]], 
        ",", 
        FractionBox[
         RowBox[{
          RowBox[{"Fa", " ", "Waf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Faa", " ", "Ma", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"2", " ", "Waf"}]}], ")"}], " ", "Zam"}], "+", 
             RowBox[{"2", " ", "FAa", " ", "MA", " ", 
              RowBox[{"(", 
               RowBox[{"1", "+", 
                RowBox[{"FdA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "r"}], ")"}]}], "-", "r", "-", 
                "Waf"}], ")"}], " ", "ZAm"}]}], ")"}]}], "-", 
          RowBox[{"2", " ", "FA", " ", "WAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"FAa", " ", "Ma", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "r"}], "+", 
                "Waf"}], ")"}], " ", "Zam"}], "+", 
             RowBox[{"FAA", " ", "MA", " ", "Waf", " ", "ZAm"}]}], ")"}]}]}], 
         
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Fa", " ", "Waf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Faa", " ", "Ma", " ", "Zam"}], "+", 
               RowBox[{"FAa", " ", "MA", " ", "ZAm"}]}], ")"}]}], "+", 
            RowBox[{"FA", " ", "WAf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"FAa", " ", "Ma", " ", "Zam"}], "+", 
               RowBox[{"FAA", " ", "MA", " ", "ZAm"}]}], ")"}]}]}], 
           ")"}]}]]}], "}"}], "\[Equal]", 
      RowBox[{"{", 
       RowBox[{"0", ",", "0", ",", "0", ",", "0", ",", "0", ",", "0"}], 
       "}"}]}], ",", 
     RowBox[{"{", 
      RowBox[{
      "ZAm", ",", "Zam", ",", "ZAf", ",", "Zaf", ",", "WAf", ",", "Waf"}], 
      "}"}]}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6862950169924383`*^9, 3.6862950458188057`*^9}, {
   3.686295079673667*^9, 3.686295131262672*^9}, {3.686295455219968*^9, 
   3.6862954648175373`*^9}, {3.6862955117929487`*^9, 3.686295552696577*^9}, {
   3.686295641016863*^9, 3.686295642725234*^9}, {3.6862957128663816`*^9, 
   3.68629571456251*^9}, 3.686844083433525*^9, {3.68684411594786*^9, 
   3.686844152267994*^9}, {3.686844187322403*^9, 3.68684423331584*^9}, 
   3.686844288671342*^9, {3.686844319862969*^9, 3.686844320197239*^9}, {
   3.6868444171274443`*^9, 3.686844490929109*^9}, {3.686891186626254*^9, 
   3.686891221843259*^9}, {3.686892969200143*^9, 3.686892980116673*^9}, {
   3.686893029902061*^9, 3.686893041582595*^9}, {3.710696831852804*^9, 
   3.710696833389701*^9}, 3.710696887196843*^9, 3.710697006737245*^9, {
   3.710698097355267*^9, 3.71069813848295*^9}},
 ExpressionUUID -> "6ea503b7-4dcb-433d-93da-389f569c17af"],

Cell["for example", "Text",
 CellChangeTimes->{{3.710698241967146*^9, 3.710698244759314*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"equilZW", "[", 
  RowBox[{
  "1", ",", "1.12", ",", "1.2", ",", "1", ",", "1.12", ",", "1.2", ",", "1", 
   ",", "1", ",", "1", ",", "1", ",", 
   RowBox[{"1", "/", "2"}], ",", "0.6", ",", 
   RowBox[{"1", "/", "2"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.706983998423141*^9, 3.7069840656312647`*^9}, {
  3.7106981594735317`*^9, 3.710698159694808*^9}},
 ExpressionUUID -> "e9d24820-12b3-49e1-b0d6-0d9635ed0194"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"4.687244950245034`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.5655665702211612`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.687244950245035`"}], "-", 
      RowBox[{"1.5655665702211612`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.8901608317450103`", "\[VeryThinSpace]", "-", 
      RowBox[{"1.5250805200708095`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3901608317450102`"}], "+", 
      RowBox[{"1.5250805200708095`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.8901608317450103`", "\[VeryThinSpace]", "-", 
      RowBox[{"1.5250805200708095`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3901608317450102`"}], "+", 
      RowBox[{"1.5250805200708095`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"4.687244950245034`", "\[VeryThinSpace]", "-", 
      RowBox[{"1.5655665702211612`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "3.687244950245035`"}], "+", 
      RowBox[{"1.5655665702211612`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.8901608317450103`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.5250805200708095`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3901608317450102`"}], "-", 
      RowBox[{"1.5250805200708095`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{"0.8901608317450103`", "\[VeryThinSpace]", "+", 
      RowBox[{"1.5250805200708095`", " ", "\[ImaginaryI]"}]}], ",", 
     RowBox[{
      RowBox[{"-", "0.3901608317450102`"}], "-", 
      RowBox[{"1.5250805200708095`", " ", "\[ImaginaryI]"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.`", ",", "1.0000000000000049`", ",", "0.`", ",", "0.5000000000000016`",
      ",", "0.`", ",", "0.5000000000000016`"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "1.`", ",", "0.`", ",", "0.5`", ",", "0.`", ",", "0.5`", ",", "0.`"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
    "0.8255100995099253`", ",", "0.17448990049007473`", ",", 
     "0.3961489247452711`", ",", "0.10385107525472889`", ",", 
     "0.3961489247452711`", ",", "0.10385107525472889`"}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.6868929937226973`*^9, {3.686893034126998*^9, 3.686893045703405*^9}, 
   3.686894556021652*^9, 3.6869119313101883`*^9, 3.687080692465213*^9, 
   3.691198012479269*^9, 3.6911980760414057`*^9, 3.6911981959095984`*^9, 
   3.691247541029271*^9, 3.691259696260449*^9, 3.692542589802388*^9, 
   3.693832198505225*^9, 3.693947785682946*^9, 3.693989455848831*^9, 
   3.694952975263164*^9, 3.706899419655237*^9, 3.706973357782777*^9, {
   3.706984001652143*^9, 3.7069840348629932`*^9}, 3.706984073466146*^9, 
   3.707150140214344*^9, 3.707150183261467*^9, 3.708109423939947*^9, 
   3.7081095262407417`*^9, 3.708109907281275*^9, 3.7081296588877773`*^9, 
   3.70817485063023*^9, 3.708195231219676*^9, 3.708454216696854*^9, 
   3.70868497446767*^9, 3.7088970888064423`*^9, 3.7095619968724203`*^9, 
   3.710687241434305*^9, 3.710693226383308*^9, 3.7106968999024973`*^9, 
   3.710697010913108*^9, {3.710698144333622*^9, 3.710698162582163*^9}, 
   3.710699966082897*^9, 3.710702447483349*^9},
 ExpressionUUID -> "7ff1c7c6-d9a0-48dd-be26-ff34a6b20a72"]
}, Open  ]],

Cell["polymporhic equilibria", "Text",
 CellChangeTimes->{{3.710698253000614*^9, 3.7106982574249353`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"cutoff", "=", 
    RowBox[{"10", "^", 
     RowBox[{"(", 
      RowBox[{"-", "10"}], ")"}]}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{"Clear", "[", "sieveZW", "]"}], "\n", 
 RowBox[{
  RowBox[{"sieveZW", "[", 
   RowBox[{
   "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", "Maa_", 
    ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", "MdA_", 
    ",", "FdA_"}], "]"}], ":=", 
  RowBox[{"Block", "[", 
   RowBox[{
    RowBox[{"{", "}"}], ",", 
    RowBox[{
     RowBox[{"For", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"i", "=", "1"}], ";", 
        RowBox[{"write", "=", 
         RowBox[{"{", "}"}]}]}], ",", 
       RowBox[{"i", "\[LessEqual]", 
        RowBox[{"(", 
         RowBox[{"max", "=", 
          RowBox[{"Length", "[", 
           RowBox[{"eq", "=", 
            RowBox[{"(", 
             RowBox[{"equilZW", "[", 
              RowBox[{
              "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
               "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", 
               ",", "MdA", ",", "FdA"}], "]"}], ")"}]}], "]"}]}], ")"}]}], 
       ",", 
       RowBox[{"i", "++"}], ",", 
       RowBox[{"If", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"Length", "[", 
           RowBox[{"test", "=", 
            RowBox[{"Cases", "[", 
             RowBox[{
              RowBox[{"eq", "[", 
               RowBox[{"[", "i", "]"}], "]"}], ",", 
              RowBox[{"x_", "/;", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"cutoff", "\[LessEqual]", 
                   RowBox[{"Re", "[", "x", "]"}], "\[LessEqual]", 
                   RowBox[{"1", "-", "cutoff"}]}], ")"}], "&&", 
                 RowBox[{
                  RowBox[{"Abs", "[", 
                   RowBox[{"Im", "[", "x", "]"}], "]"}], "<", "cutoff"}]}], 
                ")"}]}]}], "]"}]}], "]"}], "\[Equal]", "6"}], ",", 
         RowBox[{"write", "=", 
          RowBox[{"Append", "[", 
           RowBox[{"write", ",", 
            RowBox[{"eq", "[", 
             RowBox[{"[", "i", "]"}], "]"}]}], "]"}]}]}], "]"}]}], "]"}], ";",
      "\[IndentingNewLine]", 
     RowBox[{"Sort", "[", "write", "]"}]}]}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.65688204118431*^9, 3.6568820438475103`*^9}, {
  3.674522830809342*^9, 3.6745229439641333`*^9}, {3.677608566387781*^9, 
  3.67760857405052*^9}, {3.677608723220433*^9, 3.677608735175232*^9}, {
  3.686844332339417*^9, 3.686844338188551*^9}, {3.686844570913814*^9, 
  3.68684462210107*^9}, {3.6868930744697323`*^9, 3.6868930747261887`*^9}, {
  3.7106981732727327`*^9, 3.710698178017473*^9}},
 ExpressionUUID -> "34f52214-4b43-4f6c-8332-13825fb8fa53"],

Cell["for example,", "Text",
 CellChangeTimes->{{3.686295736534458*^9, 3.6862957378250103`*^9}, {
  3.7106982599850073`*^9, 3.710698261361264*^9}},
 ExpressionUUID -> "652ffd82-6b58-4387-842b-6885983cbb95"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Flatten", "[", 
  RowBox[{"sieveZW", "[", 
   RowBox[{
   "1", ",", "1.12", ",", "1.2", ",", "1", ",", "1.12", ",", "1.2", ",", "1", 
    ",", "1", ",", "1", ",", "1", ",", 
    RowBox[{"1", "/", "2"}], ",", "0.6", ",", 
    RowBox[{"1", "/", "2"}]}], "]"}], "]"}]], "Input",
 CellChangeTimes->{{3.674522890398834*^9, 3.674522890913561*^9}, {
   3.6745229508596*^9, 3.674522954443675*^9}, {3.677608578082793*^9, 
   3.6776086070180063`*^9}, {3.677608715882895*^9, 3.6776087178153543`*^9}, 
   3.686844607472435*^9, {3.710698190212063*^9, 3.710698211954463*^9}},
 ExpressionUUID -> "f242b9f0-16f5-4a57-ae64-1046198b971b"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
  "0.8255100995099253`", ",", "0.17448990049007473`", ",", 
   "0.3961489247452711`", ",", "0.10385107525472889`", ",", 
   "0.3961489247452711`", ",", "0.10385107525472889`"}], "}"}]], "Output",
 CellChangeTimes->{
  3.68689308711373*^9, 3.6868945641321697`*^9, 3.686911940032209*^9, 
   3.691198021086475*^9, 3.691198084335445*^9, 3.691198204823038*^9, 
   3.691247549972425*^9, 3.691259705210442*^9, 3.6925426017603493`*^9, 
   3.6938321987744837`*^9, 3.693947785952327*^9, 3.693989456159554*^9, 
   3.6949529755393753`*^9, 3.706899426939754*^9, 3.706973365711327*^9, 
   3.7071501534377213`*^9, 3.707150191701098*^9, 3.7081094324229927`*^9, 
   3.7081095346874533`*^9, 3.708109915801635*^9, 3.7081296674938803`*^9, 
   3.708174857344349*^9, 3.708195238515541*^9, 3.7084542235459557`*^9, 
   3.708684996812255*^9, 3.708897095548905*^9, 3.709562004101606*^9, 
   3.7106872483170633`*^9, 3.710693233082045*^9, 3.710697034369994*^9, {
   3.710698195211101*^9, 3.710698224911559*^9}, 3.710699977815175*^9, 
   3.7107024594089327`*^9},
 ExpressionUUID -> "6e36fdb3-059c-4eab-8cdd-54dd6e5293b2"]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Next male Z genotypes", "Subsubsection",
 CellChangeTimes->{{3.6776115327480087`*^9, 3.6776115358133593`*^9}, {
  3.6776116604232187`*^9, 3.677611665578927*^9}, {3.6868458653430653`*^9, 
  3.686845870890107*^9}, {3.693943259403483*^9, 3.693943259738145*^9}, {
  3.69394376675406*^9, 3.69394376706756*^9}},
 ExpressionUUID -> "c74cd230-f21f-46ed-b3a6-2bce1ed9777e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{
               SubscriptBox["fHapNext", 
                RowBox[{"XZ", ",", "A", ",", "M", ",", "hom"}]], ",", 
               "\[IndentingNewLine]", 
               SubscriptBox["fHapNext", 
                RowBox[{"XZ", ",", "a", ",", "M", ",", "hom"}]], ",", 
               "\[IndentingNewLine]", 
               SubscriptBox["fHapNext", 
                RowBox[{"XZ", ",", "A", ",", "m", ",", "hom"}]], ",", 
               "\[IndentingNewLine]", 
               SubscriptBox["fHapNext", 
                RowBox[{"XZ", ",", "a", ",", "m", ",", "hom"}]]}], 
              "\[IndentingNewLine]", "}"}], "/.", "sumsex"}], "/.", "invXY"}],
            "/.", "pseg0"}], "/.", "pseg1"}], "/.", "pseg2"}], "/.", 
        "pseg3"}], "/.", "pseg4"}], "/.", "varsubZW"}], "/.", "freqsubZW"}], "/.",
     "recGen"}], "/.", "\[Chi]XAM"}], "]"}]], "Input",
 CellChangeTimes->{{3.710698593631475*^9, 3.7106986044620533`*^9}, 
   3.710698688388095*^9, 3.710702433826352*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "Ma", " ", "MAa", " ", "MdA", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "ZAf"}], " ", "Zam"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "Wam", " ", 
             RowBox[{"(", 
              RowBox[{"ZAf", "+", 
               RowBox[{"k", " ", "R", " ", "ZAwf"}]}], ")"}]}], "-", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Wawm", " ", 
                "ZAf"}], "+", 
               RowBox[{"r", " ", "R", " ", "WAwf", " ", "Zam"}], "+", 
               RowBox[{"R", " ", "Zam", " ", "ZAwf"}], "+", 
               RowBox[{"r", " ", "WAf", " ", "Zawm"}], "-", 
               RowBox[{"r", " ", "R", " ", "WAf", " ", "Zawm"}], "+", 
               RowBox[{"ZAf", " ", "Zawm"}], "-", 
               RowBox[{"R", " ", "ZAf", " ", "Zawm"}]}], ")"}]}]}], ")"}]}], 
         "+", 
         RowBox[{"MA", " ", "MAA", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "ZAf", " ", "ZAm"}], "+", 
            RowBox[{"WAm", " ", 
             RowBox[{"(", 
              RowBox[{"ZAf", "+", 
               RowBox[{"k", " ", 
                RowBox[{"(", 
                 RowBox[{"r", "+", "R", "-", 
                  RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", "ZAwf"}]}],
               ")"}]}], "+", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "R", "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", "WAwm", 
                " ", "ZAf"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "r", "-", "R", "+", 
                  RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", "WAwf", 
                " ", "ZAm"}], "+", 
               RowBox[{"ZAm", " ", "ZAwf"}], "+", 
               RowBox[{"r", " ", "WAf", " ", "ZAwm"}], "+", 
               RowBox[{"R", " ", "WAf", " ", "ZAwm"}], "-", 
               RowBox[{"2", " ", "r", " ", "R", " ", "WAf", " ", "ZAwm"}], 
               "+", 
               RowBox[{"ZAf", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
      "+", 
      RowBox[{"2", " ", "Fa", " ", "MA", " ", "MAa", " ", "MdA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Zaf", " ", "ZAm"}], "+", 
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Wawf", " ", 
             RowBox[{"(", 
              RowBox[{"ZAm", "-", 
               RowBox[{"R", " ", "ZAm"}]}], ")"}]}], "+", 
            RowBox[{"ZAm", " ", 
             RowBox[{"(", 
              RowBox[{"Zawf", "-", 
               RowBox[{"R", " ", "Zawf"}]}], ")"}]}], "+", 
            RowBox[{"R", " ", 
             RowBox[{"(", 
              RowBox[{"Waf", "+", "Zaf"}], ")"}], " ", "ZAwm"}]}], ")"}]}], 
         "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"WAm", " ", 
             RowBox[{"(", 
              RowBox[{"Zaf", "-", 
               RowBox[{"k", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Zawf"}]}], 
              ")"}]}], "+", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "Wawf"}], " ", "ZAm"}], "+", 
               RowBox[{"R", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"WAwm", " ", "Zaf"}], "+", 
                  RowBox[{"Wawf", " ", "ZAm"}], "-", 
                  RowBox[{"Waf", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Zaf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "Maa", " ", 
               RowBox[{"(", 
                RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "Maa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawf", " ", "Wawm"}], "+", 
                 RowBox[{"Wawm", " ", "Zaf"}], "+", 
                 RowBox[{"Wawf", " ", "Zam"}], "+", 
                 RowBox[{"Wawm", " ", "Zawf"}], "+", 
                 RowBox[{"Zam", " ", "Zawf"}], "+", 
                 RowBox[{"Wam", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                 RowBox[{"Wawf", " ", "Zawm"}], "+", 
                 RowBox[{"Zaf", " ", "Zawm"}], "+", 
                 RowBox[{"Zawf", " ", "Zawm"}], "+", 
                 RowBox[{"Waf", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawf", " ", "WAwm"}], "+", 
                 RowBox[{"WAwm", " ", "Zaf"}], "+", 
                 RowBox[{"Wawf", " ", "ZAm"}], "+", 
                 RowBox[{"WAwm", " ", "Zawf"}], "+", 
                 RowBox[{"ZAm", " ", "Zawf"}], "+", 
                 RowBox[{"WAm", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                 RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                 RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                 RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                 RowBox[{"Waf", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"FA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ZAf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAA", " ", 
               RowBox[{"(", 
                RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwf", " ", "Wawm"}], "+", 
                 RowBox[{"Wawm", " ", "ZAf"}], "+", 
                 RowBox[{"WAwf", " ", "Zam"}], "+", 
                 RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                 RowBox[{"Zam", " ", "ZAwf"}], "+", 
                 RowBox[{"Wam", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                 RowBox[{"WAwf", " ", "Zawm"}], "+", 
                 RowBox[{"ZAf", " ", "Zawm"}], "+", 
                 RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                 RowBox[{"WAf", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAA", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwf", " ", "WAwm"}], "+", 
                 RowBox[{"WAwm", " ", "ZAf"}], "+", 
                 RowBox[{"WAwf", " ", "ZAm"}], "+", 
                 RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                 RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                 RowBox[{"WAm", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                 RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                 RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                 RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                 RowBox[{"WAf", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "FA", " ", "Ma", " ", "MAa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"ZAf", " ", "Zam"}], "+", 
         RowBox[{"k", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"WAwf", " ", 
             RowBox[{"(", 
              RowBox[{"Zam", "-", 
               RowBox[{"R", " ", "Zam"}]}], ")"}]}], "+", 
            RowBox[{"Zam", " ", 
             RowBox[{"(", 
              RowBox[{"ZAwf", "-", 
               RowBox[{"R", " ", "ZAwf"}]}], ")"}]}], "+", 
            RowBox[{"R", " ", 
             RowBox[{"(", 
              RowBox[{"WAf", "+", "ZAf"}], ")"}], " ", "Zawm"}]}], ")"}]}], 
         "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Wam", " ", 
             RowBox[{"(", 
              RowBox[{"ZAf", "-", 
               RowBox[{"k", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "ZAwf"}]}], 
              ")"}]}], "+", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "WAwf"}], " ", "Zam"}], "+", 
               RowBox[{"R", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Wawm", " ", "ZAf"}], "+", 
                  RowBox[{"WAwf", " ", "Zam"}], "-", 
                  RowBox[{"WAf", " ", "Zawm"}]}], ")"}]}]}], ")"}]}]}], 
           ")"}]}]}], ")"}]}], "+", 
      RowBox[{"Fa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Ma", " ", "Maa", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "Zaf", " ", "Zam"}], "+", 
            RowBox[{"Wam", " ", 
             RowBox[{"(", 
              RowBox[{"Zaf", "+", 
               RowBox[{"k", " ", 
                RowBox[{"(", 
                 RowBox[{"r", "+", "R", "-", 
                  RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", "Zawf"}]}],
               ")"}]}], "+", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "R", "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", "Wawm", 
                " ", "Zaf"}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "r", "-", "R", "+", 
                  RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", "Wawf", 
                " ", "Zam"}], "+", 
               RowBox[{"Zam", " ", "Zawf"}], "+", 
               RowBox[{"r", " ", "Waf", " ", "Zawm"}], "+", 
               RowBox[{"R", " ", "Waf", " ", "Zawm"}], "-", 
               RowBox[{"2", " ", "r", " ", "R", " ", "Waf", " ", "Zawm"}], 
               "+", 
               RowBox[{"Zaf", " ", "Zawm"}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "MA", " ", "MAa", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "Zaf"}], " ", "ZAm"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "WAm", " ", 
             RowBox[{"(", 
              RowBox[{"Zaf", "+", 
               RowBox[{"k", " ", "R", " ", "Zawf"}]}], ")"}]}], "-", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "WAwm", " ", 
                "Zaf"}], "+", 
               RowBox[{"r", " ", "R", " ", "Wawf", " ", "ZAm"}], "+", 
               RowBox[{"R", " ", "ZAm", " ", "Zawf"}], "+", 
               RowBox[{"r", " ", "Waf", " ", "ZAwm"}], "-", 
               RowBox[{"r", " ", "R", " ", "Waf", " ", "ZAwm"}], "+", 
               RowBox[{"Zaf", " ", "ZAwm"}], "-", 
               RowBox[{"R", " ", "Zaf", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}],
         ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Zaf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "Maa", " ", 
               RowBox[{"(", 
                RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "Maa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawf", " ", "Wawm"}], "+", 
                 RowBox[{"Wawm", " ", "Zaf"}], "+", 
                 RowBox[{"Wawf", " ", "Zam"}], "+", 
                 RowBox[{"Wawm", " ", "Zawf"}], "+", 
                 RowBox[{"Zam", " ", "Zawf"}], "+", 
                 RowBox[{"Wam", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                 RowBox[{"Wawf", " ", "Zawm"}], "+", 
                 RowBox[{"Zaf", " ", "Zawm"}], "+", 
                 RowBox[{"Zawf", " ", "Zawm"}], "+", 
                 RowBox[{"Waf", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawf", " ", "WAwm"}], "+", 
                 RowBox[{"WAwm", " ", "Zaf"}], "+", 
                 RowBox[{"Wawf", " ", "ZAm"}], "+", 
                 RowBox[{"WAwm", " ", "Zawf"}], "+", 
                 RowBox[{"ZAm", " ", "Zawf"}], "+", 
                 RowBox[{"WAm", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                 RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                 RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                 RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                 RowBox[{"Waf", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"FA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ZAf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAA", " ", 
               RowBox[{"(", 
                RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwf", " ", "Wawm"}], "+", 
                 RowBox[{"Wawm", " ", "ZAf"}], "+", 
                 RowBox[{"WAwf", " ", "Zam"}], "+", 
                 RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                 RowBox[{"Zam", " ", "ZAwf"}], "+", 
                 RowBox[{"Wam", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                 RowBox[{"WAwf", " ", "Zawm"}], "+", 
                 RowBox[{"ZAf", " ", "Zawm"}], "+", 
                 RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                 RowBox[{"WAf", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAA", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwf", " ", "WAwm"}], "+", 
                 RowBox[{"WAwm", " ", "ZAf"}], "+", 
                 RowBox[{"WAwf", " ", "ZAm"}], "+", 
                 RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                 RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                 RowBox[{"WAm", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                 RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                 RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                 RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                 RowBox[{"WAf", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "Fa", " ", "MA", " ", "MAa", " ", "MdA", 
         " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"Waf", "+", "Wawf", "+", "Zaf", "+", "Zawf"}], ")"}]}], 
            " ", "ZAwm"}], "+", 
           RowBox[{"R", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "Wawf"}], " ", "ZAm"}], "-", 
              RowBox[{"ZAm", " ", "Zawf"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Waf", "+", "Zaf"}], ")"}], " ", "ZAwm"}]}], ")"}]}], 
           "+", 
           RowBox[{"r", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"WAwm", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Zaf"}], "-", 
                 "Zawf"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"Waf", "+", "Wawf"}], ")"}], " ", "ZAwm"}], "+", 
              RowBox[{"R", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawf", " ", "ZAm"}], "-", 
                 RowBox[{"WAm", " ", "Zawf"}], "-", 
                 RowBox[{"Waf", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"FA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "Ma", " ", "MAa", " ", "MdA", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "ZAwf"}], " ", 
               RowBox[{"(", 
                RowBox[{"Wam", "+", "Wawm", "+", "Zam", "+", "Zawm"}], 
                ")"}]}], "+", 
              RowBox[{"R", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "Wawm", " ", 
                  "ZAf"}], "+", 
                 RowBox[{"r", " ", "WAwf", " ", "Zam"}], "+", 
                 RowBox[{"Wam", " ", "ZAwf"}], "-", 
                 RowBox[{"r", " ", "Wam", " ", "ZAwf"}], "+", 
                 RowBox[{"Zam", " ", "ZAwf"}], "-", 
                 RowBox[{"r", " ", "WAf", " ", "Zawm"}], "-", 
                 RowBox[{"ZAf", " ", "Zawm"}]}], ")"}]}], "+", 
              RowBox[{"r", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"Wam", "+", "Wawm"}], ")"}], " ", "ZAwf"}], "-", 
                 RowBox[{"WAwf", " ", 
                  RowBox[{"(", 
                   RowBox[{"Zam", "+", "Zawm"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}], "+", 
           RowBox[{"MA", " ", "MAA", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"WAm", " ", "ZAwf"}], "+", 
              RowBox[{"WAwm", " ", "ZAwf"}], "+", 
              RowBox[{"ZAm", " ", "ZAwf"}], "+", 
              RowBox[{"WAf", " ", "ZAwm"}], "+", 
              RowBox[{"WAwf", " ", "ZAwm"}], "+", 
              RowBox[{"ZAf", " ", "ZAwm"}], "+", 
              RowBox[{"2", " ", "ZAwf", " ", "ZAwm"}], "+", 
              RowBox[{"R", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwm", " ", "ZAf"}], "+", 
                 RowBox[{"WAwf", " ", "ZAm"}], "-", 
                 RowBox[{"WAm", " ", "ZAwf"}], "-", 
                 RowBox[{"WAf", " ", "ZAwm"}]}], ")"}]}], "-", 
              RowBox[{"r", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"2", " ", "R"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwm", " ", "ZAf"}], "+", 
                 RowBox[{"WAwf", " ", "ZAm"}], "-", 
                 RowBox[{"WAm", " ", "ZAwf"}], "-", 
                 RowBox[{"WAf", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Zaf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "Maa", " ", 
               RowBox[{"(", 
                RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "Maa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawf", " ", "Wawm"}], "+", 
                 RowBox[{"Wawm", " ", "Zaf"}], "+", 
                 RowBox[{"Wawf", " ", "Zam"}], "+", 
                 RowBox[{"Wawm", " ", "Zawf"}], "+", 
                 RowBox[{"Zam", " ", "Zawf"}], "+", 
                 RowBox[{"Wam", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                 RowBox[{"Wawf", " ", "Zawm"}], "+", 
                 RowBox[{"Zaf", " ", "Zawm"}], "+", 
                 RowBox[{"Zawf", " ", "Zawm"}], "+", 
                 RowBox[{"Waf", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawf", " ", "WAwm"}], "+", 
                 RowBox[{"WAwm", " ", "Zaf"}], "+", 
                 RowBox[{"Wawf", " ", "ZAm"}], "+", 
                 RowBox[{"WAwm", " ", "Zawf"}], "+", 
                 RowBox[{"ZAm", " ", "Zawf"}], "+", 
                 RowBox[{"WAm", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                 RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                 RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                 RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                 RowBox[{"Waf", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"FA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ZAf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAA", " ", 
               RowBox[{"(", 
                RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwf", " ", "Wawm"}], "+", 
                 RowBox[{"Wawm", " ", "ZAf"}], "+", 
                 RowBox[{"WAwf", " ", "Zam"}], "+", 
                 RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                 RowBox[{"Zam", " ", "ZAwf"}], "+", 
                 RowBox[{"Wam", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                 RowBox[{"WAwf", " ", "Zawm"}], "+", 
                 RowBox[{"ZAf", " ", "Zawm"}], "+", 
                 RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                 RowBox[{"WAf", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAA", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwf", " ", "WAwm"}], "+", 
                 RowBox[{"WAwm", " ", "ZAf"}], "+", 
                 RowBox[{"WAwf", " ", "ZAm"}], "+", 
                 RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                 RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                 RowBox[{"WAm", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                 RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                 RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                 RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                 RowBox[{"WAf", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"k", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "FA", " ", "Ma", " ", "MAa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{"WAf", "+", "WAwf", "+", "ZAf", "+", "ZAwf"}], ")"}]}], 
            " ", "Zawm"}], "+", 
           RowBox[{"R", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "WAwf"}], " ", "Zam"}], "-", 
              RowBox[{"Zam", " ", "ZAwf"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"WAf", "+", "ZAf"}], ")"}], " ", "Zawm"}]}], ")"}]}], 
           "+", 
           RowBox[{"r", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Wawm", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "ZAf"}], "-", 
                 "ZAwf"}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"WAf", "+", "WAwf"}], ")"}], " ", "Zawm"}], "+", 
              RowBox[{"R", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwf", " ", "Zam"}], "-", 
                 RowBox[{"Wam", " ", "ZAwf"}], "-", 
                 RowBox[{"WAf", " ", "Zawm"}]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{"Fa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Ma", " ", "Maa", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Wam", " ", "Zawf"}], "+", 
              RowBox[{"Wawm", " ", "Zawf"}], "+", 
              RowBox[{"Zam", " ", "Zawf"}], "+", 
              RowBox[{"Waf", " ", "Zawm"}], "+", 
              RowBox[{"Wawf", " ", "Zawm"}], "+", 
              RowBox[{"Zaf", " ", "Zawm"}], "+", 
              RowBox[{"2", " ", "Zawf", " ", "Zawm"}], "+", 
              RowBox[{"R", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawm", " ", "Zaf"}], "+", 
                 RowBox[{"Wawf", " ", "Zam"}], "-", 
                 RowBox[{"Wam", " ", "Zawf"}], "-", 
                 RowBox[{"Waf", " ", "Zawm"}]}], ")"}]}], "-", 
              RowBox[{"r", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", 
                 RowBox[{"2", " ", "R"}]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawm", " ", "Zaf"}], "+", 
                 RowBox[{"Wawf", " ", "Zam"}], "-", 
                 RowBox[{"Wam", " ", "Zawf"}], "-", 
                 RowBox[{"Waf", " ", "Zawm"}]}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"2", " ", "MA", " ", "MAa", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "Zawf"}], " ", 
               RowBox[{"(", 
                RowBox[{"WAm", "+", "WAwm", "+", "ZAm", "+", "ZAwm"}], 
                ")"}]}], "+", 
              RowBox[{"R", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "WAwm", " ", 
                  "Zaf"}], "+", 
                 RowBox[{"r", " ", "Wawf", " ", "ZAm"}], "+", 
                 RowBox[{"WAm", " ", "Zawf"}], "-", 
                 RowBox[{"r", " ", "WAm", " ", "Zawf"}], "+", 
                 RowBox[{"ZAm", " ", "Zawf"}], "-", 
                 RowBox[{"r", " ", "Waf", " ", "ZAwm"}], "-", 
                 RowBox[{"Zaf", " ", "ZAwm"}]}], ")"}]}], "+", 
              RowBox[{"r", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"WAm", "+", "WAwm"}], ")"}], " ", "Zawf"}], "-", 
                 RowBox[{"Wawf", " ", 
                  RowBox[{"(", 
                   RowBox[{"ZAm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Zaf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "Maa", " ", 
               RowBox[{"(", 
                RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "Maa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawf", " ", "Wawm"}], "+", 
                 RowBox[{"Wawm", " ", "Zaf"}], "+", 
                 RowBox[{"Wawf", " ", "Zam"}], "+", 
                 RowBox[{"Wawm", " ", "Zawf"}], "+", 
                 RowBox[{"Zam", " ", "Zawf"}], "+", 
                 RowBox[{"Wam", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                 RowBox[{"Wawf", " ", "Zawm"}], "+", 
                 RowBox[{"Zaf", " ", "Zawm"}], "+", 
                 RowBox[{"Zawf", " ", "Zawm"}], "+", 
                 RowBox[{"Waf", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawf", " ", "WAwm"}], "+", 
                 RowBox[{"WAwm", " ", "Zaf"}], "+", 
                 RowBox[{"Wawf", " ", "ZAm"}], "+", 
                 RowBox[{"WAwm", " ", "Zawf"}], "+", 
                 RowBox[{"ZAm", " ", "Zawf"}], "+", 
                 RowBox[{"WAm", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                 RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                 RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                 RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                 RowBox[{"Waf", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"FA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ZAf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAA", " ", 
               RowBox[{"(", 
                RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", "MAa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwf", " ", "Wawm"}], "+", 
                 RowBox[{"Wawm", " ", "ZAf"}], "+", 
                 RowBox[{"WAwf", " ", "Zam"}], "+", 
                 RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                 RowBox[{"Zam", " ", "ZAwf"}], "+", 
                 RowBox[{"Wam", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                 RowBox[{"WAwf", " ", "Zawm"}], "+", 
                 RowBox[{"ZAf", " ", "Zawm"}], "+", 
                 RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                 RowBox[{"WAf", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"MA", " ", "MAA", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwf", " ", "WAwm"}], "+", 
                 RowBox[{"WAwm", " ", "ZAf"}], "+", 
                 RowBox[{"WAwf", " ", "ZAm"}], "+", 
                 RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                 RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                 RowBox[{"WAm", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                 RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                 RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                 RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                 RowBox[{"WAf", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.710702443044292*^9, 3.7107024716491003`*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nextZAm", ",", "nextZam", ",", "nextZAwm", ",", "nextZawm"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.677615031991831*^9, 3.6776150485649843`*^9}, {
  3.693942044596998*^9, 3.6939420481406393`*^9}, {3.693942116090954*^9, 
  3.693942117022464*^9}, {3.693942189469144*^9, 3.693942189876115*^9}, {
  3.693943333841372*^9, 3.693943338666765*^9}},
 ExpressionUUID -> "ffe26696-a6d3-4dec-84d3-bfec55fff514"],

Cell["\<\
Make functions to get frequencies of each Zm genotype in generation t. This \
depends on what the frequencies of all other genotypes were at time t (inside \
the blocks).\
\>", "Text",
 CellChangeTimes->{{3.686296383816608*^9, 3.686296480375799*^9}, {
   3.6862965305972853`*^9, 3.686296546944943*^9}, {3.6862966145847816`*^9, 
   3.6862966217461567`*^9}, {3.693942195786695*^9, 3.693942196211557*^9}, 
   3.7106987480706177`*^9},
 ExpressionUUID -> "ade99352-4ec9-4448-9ee1-c57c87ad40ff"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nextZAm", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], 
   RowBox[{
    RowBox[{"nextZAm", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "These", " ", "are", " ", "the", " ", "frequencies", " ", "of", " ", 
      "all", " ", "genotypes", " ", "at", " ", "the", " ", "previous", " ", 
      "timestep"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextZAm", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"FA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "Ma", " ", "MAa", " ", "MdA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "ZAf", " ", 
                    "Zam"}], "+", 
                   RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "ZAf"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"r", "-", "R"}], ")"}], " ", "R", " ", "ZAwf"}]}],
                     ")"}]}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "Wawm", " ", "ZAf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"r", " ", "WAf"}], "+", "ZAf"}], ")"}], " ", 
                    "Zawm"}], "+", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwf"}], " ", "Zam"}], "-", 
                    RowBox[{"2", " ", "Zam", " ", "ZAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"WAf", "+", 
                    RowBox[{"2", " ", "ZAf"}]}], ")"}], " ", "Zawm"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "WAwf", " ", 
                    "Zam"}], "-", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"WAf", "+", 
                    RowBox[{"r", " ", "WAf"}], "+", 
                    RowBox[{"3", " ", "ZAf"}]}], ")"}], " ", "Zawm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"MA", " ", "MAA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "ZAf", " ", 
                    "ZAm"}], "+", 
                   RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "ZAf"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "+", "R"}], ")"}], " ", "ZAwf"}]}], 
                    ")"}]}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "WAwm", " ", "ZAf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "WAwf", " ", "ZAm"}], "-", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "R", " ", "ZAm", " ", "ZAwf"}], "-", 
                    RowBox[{"r", " ", "WAf", " ", "ZAwm"}], "+", 
                    RowBox[{"R", " ", "WAf", " ", "ZAwm"}], "-", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "ZAf", " ", "ZAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
             RowBox[{"2", " ", "Fa", " ", "MA", " ", "MAa", " ", "MdA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"2", " ", "R"}]}], ")"}], " ", "Zaf", " ", "ZAm"}],
                 "+", 
                RowBox[{"k", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "ZAm"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwm"}], " ", "Zaf"}], "+", 
                    RowBox[{"2", " ", "Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", "Zawf"}], "+", 
                    RowBox[{"3", " ", "ZAm", " ", "Zawf"}], "-", 
                    RowBox[{"Zaf", " ", "ZAwm"}]}], ")"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"Wawf", " ", "ZAm"}], "-", 
                    RowBox[{"WAm", " ", "Zawf"}], "-", 
                    RowBox[{"2", " ", "ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"Waf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "Zaf", " ", "ZAwm"}]}], ")"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Zaf"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Zawf"}]}], 
                    ")"}]}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"Wawf", " ", "ZAm"}], "-", 
                    RowBox[{"Waf", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Zaf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ZAf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextZAm", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextZAm", ">", "1"}], ",", "1", ",", "nextZAm"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextZam", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextZam", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextZam", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "FA", " ", "Ma", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"2", " ", "R"}]}], ")"}], " ", "ZAf", " ", "Zam"}],
                 "+", 
                RowBox[{"k", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "Zam"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wawm"}], " ", "ZAf"}], "+", 
                    RowBox[{"2", " ", "WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", "ZAwf"}], "+", 
                    RowBox[{"3", " ", "Zam", " ", "ZAwf"}], "-", 
                    RowBox[{"ZAf", " ", "Zawm"}]}], ")"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"WAwf", " ", "Zam"}], "-", 
                    RowBox[{"Wam", " ", "ZAwf"}], "-", 
                    RowBox[{"2", " ", "Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"WAf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "ZAf", " ", "Zawm"}]}], ")"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "ZAf"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "ZAwf"}]}], 
                    ")"}]}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"WAwf", " ", "Zam"}], "-", 
                    RowBox[{"WAf", " ", "Zawm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], "+", 
             RowBox[{"Fa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Ma", " ", "Maa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Zaf", " ", 
                    "Zam"}], "+", 
                   RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Zaf"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "+", "R"}], ")"}], " ", "Zawf"}]}], 
                    ")"}]}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "Wawm", " ", "Zaf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "Wawf", " ", "Zam"}], "-", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "R", " ", "Zam", " ", "Zawf"}], "-", 
                    RowBox[{"r", " ", "Waf", " ", "Zawm"}], "+", 
                    RowBox[{"R", " ", "Waf", " ", "Zawm"}], "-", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "Zaf", " ", "Zawm"}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                RowBox[{"2", " ", "MA", " ", "MAa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Zaf", " ", 
                    "ZAm"}], "+", 
                   RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Zaf"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"r", "-", "R"}], ")"}], " ", "R", " ", "Zawf"}]}],
                     ")"}]}], "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "WAwm", " ", "Zaf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"r", " ", "Waf"}], "+", "Zaf"}], ")"}], " ", 
                    "ZAwm"}], "+", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wawf"}], " ", "ZAm"}], "-", 
                    RowBox[{"2", " ", "ZAm", " ", "Zawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Waf", "+", 
                    RowBox[{"2", " ", "Zaf"}]}], ")"}], " ", "ZAwm"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "Wawf", " ", 
                    "ZAm"}], "-", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Waf", "+", 
                    RowBox[{"r", " ", "Waf"}], "+", 
                    RowBox[{"3", " ", "Zaf"}]}], ")"}], " ", "ZAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Zaf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ZAf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextZam", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextZam", ">", "1"}], ",", "1", ",", "nextZam"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextZAwm", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextZAwm", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextZAwm", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "Fa", " ", "MA", " ", "MAa", " ", "MdA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"Waf", "+", "Wawf", "+", "Zaf", "+", "Zawf"}], 
                    ")"}]}], " ", "ZAwm"}], "+", 
                  RowBox[{
                   SuperscriptBox["R", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwm"}], " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "ZAm", " ", "Zawf"}], "-", 
                    RowBox[{"Waf", " ", "ZAwm"}], "-", 
                    RowBox[{"2", " ", "Zaf", " ", "ZAwm"}]}], ")"}]}], "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"WAm", " ", "Zawf"}], "-", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "Waf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "Wawf", " ", "ZAwm"}], "+", 
                    RowBox[{"3", " ", "Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "Zawf", " ", "ZAwm"}]}], ")"}]}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Zaf"}], "+", 
                    
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Zawf"}]}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Waf", "+", "Wawf"}], ")"}], " ", "ZAwm"}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "ZAm"}], "-", 
                    RowBox[{"WAm", " ", "Zawf"}], "+", 
                    RowBox[{"Waf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "Wawf", " ", "ZAwm"}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "Ma", " ", "MAa", " ", "MdA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ZAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "+", "Zam", "+", "Zawm"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wawm"}], " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "Zam", " ", "ZAwf"}], "-", 
                    RowBox[{"WAf", " ", "Zawm"}], "-", 
                    RowBox[{"2", " ", "ZAf", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"2", " ", "Wam", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"3", " ", "Zam", " ", "ZAwf"}], "-", 
                    RowBox[{"WAf", " ", "Zawm"}], "-", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "ZAwf", " ", "Zawm"}]}], ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm"}], ")"}]}], " ", "ZAwf"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Zam", "+", "Zawm"}], ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wawm", " ", 
                    RowBox[{"(", 
                    RowBox[{"ZAf", "+", 
                    RowBox[{"2", " ", "ZAwf"}]}], ")"}]}], "-", 
                    RowBox[{"WAf", " ", "Zawm"}], "-", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Zam", "+", 
                    RowBox[{"2", " ", "Zawm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAm"}], " ", "ZAwf"}], "-", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "-", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "-", 
                    RowBox[{"WAf", " ", "ZAwm"}], "-", 
                    RowBox[{"WAwf", " ", "ZAwm"}], "-", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "-", 
                    RowBox[{"2", " ", "ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwm"}], " ", "ZAf"}], "-", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAf", " ", "ZAwm"}]}], ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"4", " ", "ZAwf", " ", "ZAwm"}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Zaf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ZAf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextZAwm", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextZAwm", ">", "1"}], ",", "1", ",", "nextZAwm"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextZawm", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextZawm", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextZawm", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "FA", " ", "Ma", " ", "MAa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"WAf", "+", "WAwf", "+", "ZAf", "+", "ZAwf"}], 
                    ")"}]}], " ", "Zawm"}], "+", 
                  RowBox[{
                   SuperscriptBox["R", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wawm"}], " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "Zam", " ", "ZAwf"}], "-", 
                    RowBox[{"WAf", " ", "Zawm"}], "-", 
                    RowBox[{"2", " ", "ZAf", " ", "Zawm"}]}], ")"}]}], "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"Wam", " ", "ZAwf"}], "-", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "WAf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "WAwf", " ", "Zawm"}], "+", 
                    RowBox[{"3", " ", "ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "ZAwf", " ", "Zawm"}]}], ")"}]}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "ZAf"}], "+", 
                    
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "ZAwf"}]}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"WAf", "+", "WAwf"}], ")"}], " ", "Zawm"}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Zam"}], "-", 
                    RowBox[{"Wam", " ", "ZAwf"}], "+", 
                    RowBox[{"WAf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "WAwf", " ", "Zawm"}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "Maa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wam"}], " ", "Zawf"}], "-", 
                    RowBox[{"Wawm", " ", "Zawf"}], "-", 
                    RowBox[{"Zam", " ", "Zawf"}], "-", 
                    RowBox[{"Waf", " ", "Zawm"}], "-", 
                    RowBox[{"Wawf", " ", "Zawm"}], "-", 
                    RowBox[{"Zaf", " ", "Zawm"}], "-", 
                    RowBox[{"2", " ", "Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wawm"}], " ", "Zaf"}], "-", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", "Zawf"}], "+", 
                    RowBox[{"Waf", " ", "Zawm"}]}], ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Waf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"4", " ", "Zawf", " ", "Zawm"}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                  RowBox[{"2", " ", "MA", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Zawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "+", "ZAm", "+", "ZAwm"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwm"}], " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "ZAm", " ", "Zawf"}], "-", 
                    RowBox[{"Waf", " ", "ZAwm"}], "-", 
                    RowBox[{"2", " ", "Zaf", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"2", " ", "WAm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"3", " ", "ZAm", " ", "Zawf"}], "-", 
                    RowBox[{"Waf", " ", "ZAwm"}], "-", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "Zawf", " ", "ZAwm"}]}], ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm"}], ")"}]}], " ", "Zawf"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"ZAm", "+", "ZAwm"}], ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAwm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Zaf", "+", 
                    RowBox[{"2", " ", "Zawf"}]}], ")"}]}], "-", 
                    RowBox[{"Waf", " ", "ZAwm"}], "-", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"ZAm", "+", 
                    RowBox[{"2", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Zaf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ZAf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextZawm", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextZawm", ">", "1"}], ",", "1", ",", "nextZawm"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextZAm", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "ZAminit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextZam", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "Zaminit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextZAwm", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "ZAwminit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextZawm", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "Zawminit"}]}], "Input",
 CellChangeTimes->{{3.677609169639257*^9, 3.677609254342773*^9}, {
   3.67760929940635*^9, 3.677609319747704*^9}, {3.677609415700798*^9, 
   3.677609588703081*^9}, {3.677609626847389*^9, 3.677609758420228*^9}, {
   3.6776097885539618`*^9, 3.677609937619573*^9}, {3.677610469673553*^9, 
   3.677610530805957*^9}, {3.677610564938963*^9, 3.677610911957862*^9}, {
   3.677610959883894*^9, 3.677611207705814*^9}, {3.677611280462638*^9, 
   3.677611329886663*^9}, {3.6776114444636097`*^9, 3.677611452511242*^9}, {
   3.6776115544456167`*^9, 3.677611643514182*^9}, {3.6776150177966127`*^9, 
   3.677615027913282*^9}, 3.6862974070147743`*^9, {3.68629744448654*^9, 
   3.686297498822525*^9}, 3.6862975298832207`*^9, {3.686297575514308*^9, 
   3.686297579276594*^9}, 3.6862976204287043`*^9, 3.686844713956946*^9, {
   3.6868447748667517`*^9, 3.686844932319375*^9}, 3.686844982985793*^9, {
   3.68684508571594*^9, 3.686845106699781*^9}, {3.6868451699832363`*^9, 
   3.686845232889612*^9}, 3.686845267633327*^9, {3.686848758280573*^9, 
   3.6868488870394497`*^9}, {3.686849390488199*^9, 3.6868494470450907`*^9}, {
   3.68684976368804*^9, 3.686849831755412*^9}, {3.6868503564975147`*^9, 
   3.6868504122801113`*^9}, {3.686850904991899*^9, 3.6868509294129477`*^9}, {
   3.686889931626089*^9, 3.686889969842772*^9}, 3.6868958323453827`*^9, 
   3.686895869396394*^9, 3.6868959254661903`*^9, {3.686895993025148*^9, 
   3.6868960754021263`*^9}, {3.6939420820792103`*^9, 3.693942096945017*^9}, {
   3.693942212289627*^9, 3.6939422250277243`*^9}, {3.6939422855843697`*^9, 
   3.693942500933766*^9}, {3.693942602467702*^9, 3.693942804549776*^9}, {
   3.6939429862426033`*^9, 3.6939430732474327`*^9}, {3.693943127205608*^9, 
   3.693943202110318*^9}, {3.693943341745666*^9, 3.693943503121986*^9}, {
   3.6939448676762867`*^9, 3.693944896110075*^9}, {3.693945105847988*^9, 
   3.6939451190452213`*^9}, {3.69394533629489*^9, 3.6939453584580193`*^9}, {
   3.710698639855036*^9, 3.7106986806847687`*^9}},
 ExpressionUUID -> "7c4f2588-e35c-48a6-a886-b32400d6ad9b"]
}, Open  ]],

Cell[CellGroupData[{

Cell["Next female Z genotypes", "Subsubsection",
 CellChangeTimes->{{3.6776115327480087`*^9, 3.6776115358133593`*^9}, {
  3.6776116604232187`*^9, 3.677611665578927*^9}, {3.6868458653430653`*^9, 
  3.686845870890107*^9}, {3.69394376344971*^9, 3.69394376378592*^9}},
 ExpressionUUID -> "8ac8968d-7235-4315-92f0-9f5c51676b6c"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                SubscriptBox["fHapNext", 
                 RowBox[{"XZ", ",", "A", ",", "M", ",", "het"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"XZ", ",", "a", ",", "M", ",", "het"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"XZ", ",", "A", ",", "m", ",", "het"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"XZ", ",", "a", ",", "m", ",", "het"}]]}], 
               "\[IndentingNewLine]", "}"}], "/.", "sumsex"}], "/.", 
             "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.", "pseg2"}], "/.",
          "pseg3"}], "/.", "pseg4"}], "/.", "varsubZW"}], "/.", "freqsubZW"}],
      "/.", "recGen"}], "/.", "\[Chi]XAM"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.71069846919242*^9, 3.710698476485525*^9}, {
  3.710698559852253*^9, 3.710698570536005*^9}}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nextZAf", ",", "nextZaf", ",", "nextZAwf", ",", "nextZawf"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.677615031991831*^9, 3.6776150485649843`*^9}, {
  3.693942044596998*^9, 3.6939420481406393`*^9}, {3.693942116090954*^9, 
  3.693942117022464*^9}, {3.693942189469144*^9, 3.693942189876115*^9}},
 ExpressionUUID -> "95a5e275-2c90-4972-86f0-55ac11ec46e2"],

Cell["\<\
Make functions to get frequencies of each Zf genotype in generation t. This \
depends on what the frequencies of all other genotypes were at time t (inside \
the blocks).\
\>", "Text",
 CellChangeTimes->{{3.686296383816608*^9, 3.686296480375799*^9}, {
  3.6862965305972853`*^9, 3.686296546944943*^9}, {3.6862966145847816`*^9, 
  3.6862966217461567`*^9}, {3.693942195786695*^9, 3.693942196211557*^9}},
 ExpressionUUID -> "7fe46ce5-365d-4c62-bf51-ba9dfb72d661"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nextZAf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], 
   RowBox[{
    RowBox[{"nextZAf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "These", " ", "are", " ", "the", " ", "frequencies", " ", "of", " ", 
      "all", " ", "genotypes", " ", "at", " ", "the", " ", "previous", " ", 
      "timestep"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newZAf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "Fa", " ", "FAa", " ", "FdA", " ", 
              "MA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Waf", " ", "ZAm"}], "-", 
                RowBox[{"r", " ", "Waf", " ", "ZAm"}], "+", 
                RowBox[{"Wawf", " ", "ZAm"}], "-", 
                RowBox[{"k", " ", "Wawf", " ", "ZAm"}], "-", 
                RowBox[{"r", " ", "Wawf", " ", "ZAm"}], "+", 
                RowBox[{"k", " ", "r", " ", "Wawf", " ", "ZAm"}], "+", 
                RowBox[{"r", " ", "WAm", " ", "Zawf"}], "-", 
                RowBox[{"k", " ", "r", " ", "WAm", " ", "Zawf"}], "+", 
                RowBox[{"ZAm", " ", "Zawf"}], "-", 
                RowBox[{"k", " ", "ZAm", " ", "Zawf"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                 SuperscriptBox["R", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"WAwm", " ", "Zaf"}], "-", 
                   RowBox[{"Wawf", " ", "ZAm"}], "-", 
                   RowBox[{"WAm", " ", "Zawf"}], "-", 
                   RowBox[{"2", " ", "ZAm", " ", "Zawf"}], "+", 
                   RowBox[{"Waf", " ", "ZAwm"}], "+", 
                   RowBox[{"2", " ", "Zaf", " ", "ZAwm"}]}], ")"}]}], "+", 
                RowBox[{"R", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "WAwm", " ", 
                    "Zaf"}], "+", 
                   RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "ZAm"}], "-", 
                    
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "r", " ", 
                    "ZAwm"}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "Wawf", " ", 
                    "ZAm"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "r"}], ")"}], " ", "WAm", " ", "Zawf"}],
                     "-", 
                    RowBox[{"3", " ", "ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], "+", 
             RowBox[{"FA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "FAa", " ", "FdA", " ", "Ma", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "Wawm", " ", "ZAf"}], "+", 
                   RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Zam"}], "-", 
                    RowBox[{"Wam", " ", "ZAwf"}]}], ")"}]}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Zam"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k", "+", "R", "-", 
                    RowBox[{"k", " ", "R"}]}], ")"}], " ", "Zawm"}]}], 
                    ")"}]}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "ZAf"}], " ", "Zawm"}], "+", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "Zam", " ", "ZAwf"}], "-", 
                    RowBox[{"WAf", " ", "Zawm"}], "-", 
                    RowBox[{"2", " ", "ZAf", " ", "Zawm"}]}], ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwf"}], " ", "Zam"}], "-", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"WAf", " ", "Zawm"}], "+", 
                    RowBox[{"3", " ", "ZAf", " ", "Zawm"}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                RowBox[{"FAA", " ", "MA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "WAwm", " ", "ZAf"}], "+", 
                   RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "ZAm"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"r", "-", "R"}], ")"}], " ", "ZAwm"}]}], ")"}]}], 
                   "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "WAwf", " ", "ZAm"}], "-", 
                    RowBox[{"r", " ", "WAm", " ", "ZAwf"}], "+", 
                    RowBox[{"R", " ", "WAm", " ", "ZAwf"}], "-", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "R", " ", "ZAm", " ", "ZAwf"}], "-", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "ZAf", " ", "ZAwm"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newZAf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newZAf", ">", "1"}], ",", "1", ",", "newZAf"}], "]"}]}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextZaf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextZaf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newZaf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "FA", " ", "FAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "Ma", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"WAf", " ", "Zam"}], "-", 
                RowBox[{"r", " ", "WAf", " ", "Zam"}], "+", 
                RowBox[{"WAwf", " ", "Zam"}], "-", 
                RowBox[{"k", " ", "WAwf", " ", "Zam"}], "-", 
                RowBox[{"r", " ", "WAwf", " ", "Zam"}], "+", 
                RowBox[{"k", " ", "r", " ", "WAwf", " ", "Zam"}], "+", 
                RowBox[{"r", " ", "Wam", " ", "ZAwf"}], "-", 
                RowBox[{"k", " ", "r", " ", "Wam", " ", "ZAwf"}], "+", 
                RowBox[{"Zam", " ", "ZAwf"}], "-", 
                RowBox[{"k", " ", "Zam", " ", "ZAwf"}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                 SuperscriptBox["R", "2"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Wawm", " ", "ZAf"}], "-", 
                   RowBox[{"WAwf", " ", "Zam"}], "-", 
                   RowBox[{"Wam", " ", "ZAwf"}], "-", 
                   RowBox[{"2", " ", "Zam", " ", "ZAwf"}], "+", 
                   RowBox[{"WAf", " ", "Zawm"}], "+", 
                   RowBox[{"2", " ", "ZAf", " ", "Zawm"}]}], ")"}]}], "+", 
                RowBox[{"R", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "Wawm", " ", 
                    "ZAf"}], "+", 
                   RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "Zam"}], "-", 
                    
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "r", " ", 
                    "Zawm"}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "WAwf", " ", 
                    "Zam"}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "r"}], ")"}], " ", "Wam", " ", "ZAwf"}],
                     "-", 
                    RowBox[{"3", " ", "Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}], "+", 
             RowBox[{"Fa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Faa", " ", "Ma", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "Wawm", " ", "Zaf"}], "+", 
                   RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Zam"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"r", "-", "R"}], ")"}], " ", "Zawm"}]}], ")"}]}], 
                   "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "Wawf", " ", "Zam"}], "-", 
                    RowBox[{"r", " ", "Wam", " ", "Zawf"}], "+", 
                    RowBox[{"R", " ", "Wam", " ", "Zawf"}], "-", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "R", " ", "Zam", " ", "Zawf"}], "-", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "Zaf", " ", "Zawm"}]}], 
                    ")"}]}]}], ")"}]}], "-", 
                RowBox[{"2", " ", "FAa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "MA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "WAwm", " ", "Zaf"}], "+", 
                   RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "ZAm"}], "-", 
                    RowBox[{"WAm", " ", "Zawf"}]}], ")"}]}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "ZAm"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k", "+", "R", "-", 
                    RowBox[{"k", " ", "R"}]}], ")"}], " ", "ZAwm"}]}], 
                    ")"}]}]}], ")"}]}], "-", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Zaf"}], " ", "ZAwm"}], "+", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "ZAm", " ", "Zawf"}], "-", 
                    RowBox[{"Waf", " ", "ZAwm"}], "-", 
                    RowBox[{"2", " ", "Zaf", " ", "ZAwm"}]}], ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wawf"}], " ", "ZAm"}], "-", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"Waf", " ", "ZAwm"}], "+", 
                    RowBox[{"3", " ", "Zaf", " ", "ZAwm"}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newZaf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newZaf", ">", "1"}], ",", "1", ",", "newZaf"}], "]"}]}], 
         "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextZAwf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextZAwf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"newZAwf", "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "2", " ", "Fa", " ", "FAa", " ", "FdA", " ", "MA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"Waf", "+", "Wawf", "+", "Zaf", "+", "Zawf"}], 
                    ")"}]}], " ", "ZAwm"}], "+", 
                   RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwm"}], " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "ZAm", " ", "Zawf"}], "-", 
                    RowBox[{"Waf", " ", "ZAwm"}], "-", 
                    RowBox[{"2", " ", "Zaf", " ", "ZAwm"}]}], ")"}]}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"WAm", " ", "Zawf"}], "-", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "Waf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "Wawf", " ", "ZAwm"}], "+", 
                    RowBox[{"3", " ", "Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "Zawf", " ", "ZAwm"}]}], ")"}]}], "+", 
                   RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Zaf"}], "+", 
                    
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Zawf"}]}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"Waf", "+", "Wawf"}], ")"}], " ", "ZAwm"}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "ZAm"}], "-", 
                    RowBox[{"WAm", " ", "Zawf"}], "+", 
                    RowBox[{"Waf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "Wawf", " ", "ZAwm"}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                RowBox[{"FA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "2"}], " ", "FAa", " ", "FdA", " ", "Ma", 
                    " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"ZAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "+", "Zam", "+", "Zawm"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wawm"}], " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "Zam", " ", "ZAwf"}], "-", 
                    RowBox[{"WAf", " ", "Zawm"}], "-", 
                    RowBox[{"2", " ", "ZAf", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"2", " ", "Wam", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"3", " ", "Zam", " ", "ZAwf"}], "-", 
                    RowBox[{"WAf", " ", "Zawm"}], "-", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "ZAwf", " ", "Zawm"}]}], ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm"}], ")"}]}], " ", "ZAwf"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Zam", "+", "Zawm"}], ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wawm", " ", 
                    RowBox[{"(", 
                    RowBox[{"ZAf", "+", 
                    RowBox[{"2", " ", "ZAwf"}]}], ")"}]}], "-", 
                    RowBox[{"WAf", " ", "Zawm"}], "-", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Zam", "+", 
                    RowBox[{"2", " ", "Zawm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"FAA", " ", "MA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAm"}], " ", "ZAwf"}], "-", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "-", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "-", 
                    RowBox[{"WAf", " ", "ZAwm"}], "-", 
                    RowBox[{"WAwf", " ", "ZAwm"}], "-", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "-", 
                    RowBox[{"2", " ", "ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwm"}], " ", "ZAf"}], "-", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAf", " ", "ZAwm"}]}], ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"4", " ", "ZAwf", " ", "ZAwm"}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"newZAwf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"newZAwf", ">", "1"}], ",", "1", ",", "newZAwf"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextZawf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextZawf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextZawf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "FA", " ", "FAa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "Ma", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"WAf", "+", "WAwf", "+", "ZAf", "+", "ZAwf"}], 
                    ")"}]}], " ", "Zawm"}], "+", 
                  RowBox[{
                   SuperscriptBox["R", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wawm"}], " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "Zam", " ", "ZAwf"}], "-", 
                    RowBox[{"WAf", " ", "Zawm"}], "-", 
                    RowBox[{"2", " ", "ZAf", " ", "Zawm"}]}], ")"}]}], "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"Wam", " ", "ZAwf"}], "-", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "WAf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "WAwf", " ", "Zawm"}], "+", 
                    RowBox[{"3", " ", "ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "ZAwf", " ", "Zawm"}]}], ")"}]}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "ZAf"}], "+", 
                    
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "ZAwf"}]}], 
                    ")"}]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"WAf", "+", "WAwf"}], ")"}], " ", "Zawm"}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Zam"}], "-", 
                    RowBox[{"Wam", " ", "ZAwf"}], "+", 
                    RowBox[{"WAf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "WAwf", " ", "Zawm"}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wam", " ", "Zawf"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Waf", " ", "Zawm"}], "+", 
                    RowBox[{"Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}], "-", 
                    RowBox[{"Wam", " ", "Zawf"}], "-", 
                    RowBox[{"Waf", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Waf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"4", " ", "Zawf", " ", "Zawm"}]}], ")"}]}]}], 
                    ")"}]}], "-", 
                  RowBox[{"2", " ", "FAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Zawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "+", "ZAm", "+", "ZAwm"}], 
                    ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwm"}], " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "ZAm", " ", "Zawf"}], "-", 
                    RowBox[{"Waf", " ", "ZAwm"}], "-", 
                    RowBox[{"2", " ", "Zaf", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"2", " ", "WAm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"3", " ", "ZAm", " ", "Zawf"}], "-", 
                    RowBox[{"Waf", " ", "ZAwm"}], "-", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "Zawf", " ", "ZAwm"}]}], ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm"}], ")"}]}], " ", "Zawf"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"ZAm", "+", "ZAwm"}], ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAwm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Zaf", "+", 
                    RowBox[{"2", " ", "Zawf"}]}], ")"}]}], "-", 
                    RowBox[{"Waf", " ", "ZAwm"}], "-", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"ZAm", "+", 
                    RowBox[{"2", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextZawf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextZawf", ">", "1"}], ",", "1", ",", "nextZawf"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextZAf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "ZAfinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextZaf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "Zafinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextZAwf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "ZAwfinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextZawf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "Zawfinit"}]}], "Input",
 CellChangeTimes->{{3.677609169639257*^9, 3.677609254342773*^9}, {
   3.67760929940635*^9, 3.677609319747704*^9}, {3.677609415700798*^9, 
   3.677609588703081*^9}, {3.677609626847389*^9, 3.677609758420228*^9}, {
   3.6776097885539618`*^9, 3.677609937619573*^9}, {3.677610469673553*^9, 
   3.677610530805957*^9}, {3.677610564938963*^9, 3.677610911957862*^9}, {
   3.677610959883894*^9, 3.677611207705814*^9}, {3.677611280462638*^9, 
   3.677611329886663*^9}, {3.6776114444636097`*^9, 3.677611452511242*^9}, {
   3.6776115544456167`*^9, 3.677611643514182*^9}, {3.6776150177966127`*^9, 
   3.677615027913282*^9}, 3.6862974070147743`*^9, {3.68629744448654*^9, 
   3.686297498822525*^9}, 3.6862975298832207`*^9, {3.686297575514308*^9, 
   3.686297579276594*^9}, 3.6862976204287043`*^9, 3.686844713956946*^9, {
   3.6868447748667517`*^9, 3.686844932319375*^9}, 3.686844982985793*^9, {
   3.68684508571594*^9, 3.686845106699781*^9}, {3.6868451699832363`*^9, 
   3.686845232889612*^9}, 3.686845267633327*^9, {3.686848758280573*^9, 
   3.6868488870394497`*^9}, {3.686849390488199*^9, 3.6868494470450907`*^9}, {
   3.68684976368804*^9, 3.686849831755412*^9}, {3.6868503564975147`*^9, 
   3.6868504122801113`*^9}, {3.686850904991899*^9, 3.6868509294129477`*^9}, {
   3.686889931626089*^9, 3.686889969842772*^9}, 3.6868958323453827`*^9, 
   3.686895869396394*^9, 3.6868959254661903`*^9, {3.686895993025148*^9, 
   3.6868960754021263`*^9}, {3.6939420820792103`*^9, 3.693942096945017*^9}, {
   3.693942212289627*^9, 3.6939422250277243`*^9}, {3.6939422855843697`*^9, 
   3.693942500933766*^9}, {3.693942602467702*^9, 3.693942804549776*^9}, {
   3.6939429862426033`*^9, 3.6939430732474327`*^9}, {3.693943127205608*^9, 
   3.693943202110318*^9}, {3.693944971182473*^9, 3.693945000191677*^9}, {
   3.693945082750503*^9, 3.6939450946461477`*^9}, {3.693945260287942*^9, 
   3.69394532781031*^9}, {3.710698511239492*^9, 3.710698551809711*^9}},
 ExpressionUUID -> "9945f2bc-7278-4d49-8bd7-0ae3a35b4088"]
}, Closed]],

Cell[CellGroupData[{

Cell["Next male W genotypes", "Subsubsection",
 CellChangeTimes->{{3.6776115327480087`*^9, 3.6776115358133593`*^9}, {
  3.6776116604232187`*^9, 3.677611665578927*^9}, {3.6868458653430653`*^9, 
  3.686845870890107*^9}, {3.693943259403483*^9, 3.693943259738145*^9}, {
  3.693943771385968*^9, 3.693943771737815*^9}},
 ExpressionUUID -> "4b105ad2-5b47-4fa7-8015-9b540d0d29a4"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "A", ",", "M", ",", "hom"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "a", ",", "M", ",", "hom"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "A", ",", "m", ",", "hom"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "a", ",", "m", ",", "hom"}]]}], 
               "\[IndentingNewLine]", "}"}], "/.", "sumsex"}], "/.", 
             "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.", "pseg2"}], "/.",
          "pseg3"}], "/.", "pseg4"}], "/.", "varsubZW"}], "/.", "freqsubZW"}],
      "/.", "recGen"}], "/.", "\[Chi]XAM"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.710698720782009*^9, 3.7106987252720957`*^9}, 
   3.7106988636510887`*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nextWAm", ",", "nextWam", ",", "nextWAwm", ",", "nextWawm"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.677615031991831*^9, 3.6776150485649843`*^9}, {
  3.693942044596998*^9, 3.6939420481406393`*^9}, {3.693942116090954*^9, 
  3.693942117022464*^9}, {3.693942189469144*^9, 3.693942189876115*^9}, {
  3.693943333841372*^9, 3.693943338666765*^9}, {3.693944335522482*^9, 
  3.693944348620964*^9}, {3.6939453980853443`*^9, 3.693945416584711*^9}},
 ExpressionUUID -> "b2d7ac84-b0c2-4571-9b32-b0e40d958c24"],

Cell["\<\
Make functions to get frequencies of each Wm genotype in generation t. This \
depends on what the frequencies of all other genotypes were at time t (inside \
the blocks).\
\>", "Text",
 CellChangeTimes->{{3.686296383816608*^9, 3.686296480375799*^9}, {
  3.6862965305972853`*^9, 3.686296546944943*^9}, {3.6862966145847816`*^9, 
  3.6862966217461567`*^9}, {3.693942195786695*^9, 3.693942196211557*^9}, {
  3.710698737206791*^9, 3.710698739397628*^9}},
 ExpressionUUID -> "722214df-0324-4c57-9a80-7c508c0bf2e9"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nextWAm", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], 
   RowBox[{
    RowBox[{"nextWAm", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "These", " ", "are", " ", "the", " ", "frequencies", " ", "of", " ", 
      "all", " ", "genotypes", " ", "at", " ", "the", " ", "previous", " ", 
      "timestep"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextWAm", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "Fa", " ", "MA", " ", "MAa", " ", 
              "MdA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"2", " ", "R"}]}], ")"}], " ", "WAm", " ", "Zaf"}],
                 "+", 
                RowBox[{"k", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"r", " ", "Wawf", " ", "ZAm"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Wawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "Zawf"}]}], ")"}]}], "-", 
                   RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwm"}], "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"r", " ", "WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"Wawf", " ", "ZAm"}], "-", 
                    RowBox[{"r", " ", "Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm", "-", 
                    RowBox[{"r", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], "+", 
             RowBox[{"FA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                   "2", " ", "Ma", " ", "MAa", " ", "MdA", " ", "r", " ", 
                    "Wam"}], "+", 
                   RowBox[{"MA", " ", "MAA", " ", "WAm"}]}], ")"}], " ", 
                 "ZAf"}], "+", 
                RowBox[{"k", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", "Ma", " ", "MAa", " ", "MdA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "r"}], " ", "Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm", "-", 
                    RowBox[{"r", " ", "Zawm"}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wawm"}], " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwf"}], "+", "ZAwf"}], ")"}]}], "-", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawm"}], "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"r", " ", "Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"r", " ", "WAwf", " ", "Zam"}], "-", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf", "-", 
                    RowBox[{"r", " ", "ZAwf"}]}], ")"}]}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "Wawm"}], "+", 
                    RowBox[{"2", " ", "Zawm"}], "-", 
                    RowBox[{"r", " ", "Zawm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                   RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"r", "-", "R"}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "ZAm"}]}], ")"}]}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "WAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "ZAwf"}]}], ")"}]}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "WAwm"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "ZAwm"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
            ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Zaf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ZAf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextWAm", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextWAm", ">", "1"}], ",", "1", ",", "nextWAm"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextWam", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextWam", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextWam", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "FA", " ", "Ma", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"2", " ", "R"}]}], ")"}], " ", "Wam", " ", "ZAf"}],
                 "+", 
                RowBox[{"k", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"r", " ", "WAwf", " ", "Zam"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "WAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "ZAwf"}]}], ")"}]}], "-", 
                   RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawm"}], "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"r", " ", "Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"WAwf", " ", "Zam"}], "-", 
                    RowBox[{"r", " ", "WAwf", " ", "Zam"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm", "-", 
                    RowBox[{"r", " ", "Zawm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], "+", 
             RowBox[{"Fa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Ma", " ", "Maa", " ", "Wam"}], "-", 
                   RowBox[{"2", " ", "MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", "r", " ", 
                    "WAm"}]}], ")"}], " ", "Zaf"}], "+", 
                RowBox[{"k", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"r", "-", "R"}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}]}], ")"}]}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Wawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "Zawf"}]}], ")"}]}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Wawm"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "Zawm"}]}], ")"}]}]}], ")"}]}], "-", 
                   RowBox[{"2", " ", "MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "r"}], " ", "WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm", "-", 
                    RowBox[{"r", " ", "ZAwm"}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwm"}], " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawf"}], "+", "Zawf"}], ")"}]}], "-", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwm"}], "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"r", " ", "WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"r", " ", "Wawf", " ", "ZAm"}], "-", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf", "-", 
                    RowBox[{"r", " ", "Zawf"}]}], ")"}]}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "WAwm"}], "+", 
                    RowBox[{"2", " ", "ZAwm"}], "-", 
                    RowBox[{"r", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Zaf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ZAf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextWam", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextWam", ">", "1"}], ",", "1", ",", "nextWam"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextWAwm", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextWAwm", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextWAwm", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"2", " ", "Fa", " ", "MA", " ", "MAa", " ", "MdA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "Wawf"}], " ", "WAwm"}], "-", 
                  RowBox[{"WAwm", " ", "Zaf"}], "+", 
                  RowBox[{"r", " ", "WAwm", " ", "Zaf"}], "-", 
                  RowBox[{"WAwm", " ", "Zawf"}], "+", 
                  RowBox[{"r", " ", "WAwm", " ", "Zawf"}], "-", 
                  RowBox[{"r", " ", "Wawf", " ", "ZAwm"}], "-", 
                  RowBox[{"Waf", " ", 
                   RowBox[{"(", 
                    RowBox[{"WAwm", "+", 
                    RowBox[{"r", " ", "ZAwm"}]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["R", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwm"}], " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawf"}], "+", "Zawf"}], ")"}]}], "-", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwm"}], "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}], "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawf", " ", "WAwm"}], "+", 
                    RowBox[{"2", " ", "WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"r", " ", "WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"r", " ", "Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"2", " ", "WAwm", " ", "Zawf"}], "-", 
                    RowBox[{"2", " ", "r", " ", "WAwm", " ", "Zawf"}], "-", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", 
                    RowBox[{"r", " ", "Zawf"}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", "r", " ", "Wawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "WAwm"}], "+", "ZAwm", "+", 
                    RowBox[{"r", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", "Ma", " ", "MAa", " ", "MdA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Wawm"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "-", 
                    RowBox[{"r", " ", "WAwf", " ", "Zam"}], "+", 
                    RowBox[{"r", " ", "Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "WAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "+", "R"}], ")"}], " ", "ZAwf"}]}], 
                    ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "Zawm"}], "-", 
                    RowBox[{"r", " ", "WAwf", " ", "Zawm"}], "-", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawm"}], "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", 
                    RowBox[{"(", 
                    RowBox[{"ZAf", "-", 
                    RowBox[{"r", " ", "ZAf"}], "-", 
                    RowBox[{"2", " ", "r", " ", "ZAwf"}]}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "Wawm"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "Zam"}], "+", 
                    
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "Zawm"}]}], 
                    ")"}]}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", 
                    RowBox[{"r", " ", "Zawm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                  RowBox[{"MA", " ", "MAA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "WAwf", " ", "WAwm"}], "+", 
                    RowBox[{"4", " ", "R", " ", "WAwf", " ", "WAwm"}], "-", 
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"r", " ", "WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"R", " ", "WAwm", " ", "ZAf"}], "-", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"r", " ", "WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"R", " ", "WAwf", " ", "ZAm"}], "-", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "R", " ", "WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "WAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "+", "R"}], ")"}], " ", "ZAwf"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "WAwm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "WAwm"}], "-", 
                    RowBox[{"r", " ", "ZAwm"}], "+", 
                    RowBox[{"R", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Zaf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ZAf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextWAwm", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextWAwm", ">", "1"}], ",", "1", ",", "nextWAwm"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextWawm", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextWawm", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextWawm", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", "FA", " ", "Ma", " ", "MAa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "WAwf"}], " ", "Wawm"}], "-", 
                  RowBox[{"Wawm", " ", "ZAf"}], "+", 
                  RowBox[{"r", " ", "Wawm", " ", "ZAf"}], "-", 
                  RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                  RowBox[{"r", " ", "Wawm", " ", "ZAwf"}], "-", 
                  RowBox[{"r", " ", "WAwf", " ", "Zawm"}], "-", 
                  RowBox[{"WAf", " ", 
                   RowBox[{"(", 
                    RowBox[{"Wawm", "+", 
                    RowBox[{"r", " ", "Zawm"}]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["R", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wawm"}], " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwf"}], "+", "ZAwf"}], ")"}]}], "-", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawm"}], "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}], "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwf", " ", "Wawm"}], "+", 
                    RowBox[{"2", " ", "Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"r", " ", "Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"r", " ", "WAwf", " ", "Zam"}], "+", 
                    RowBox[{"2", " ", "Wawm", " ", "ZAwf"}], "-", 
                    RowBox[{"2", " ", "r", " ", "Wawm", " ", "ZAwf"}], "-", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", 
                    RowBox[{"r", " ", "ZAwf"}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", "r", " ", "WAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "Wawm"}], "+", "Zawm", "+", 
                    RowBox[{"r", " ", "Zawm"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], "+", 
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Ma", " ", "Maa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "Wawf", " ", "Wawm"}], "+", 
                    RowBox[{"4", " ", "R", " ", "Wawf", " ", "Wawm"}], "-", 
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"r", " ", "Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"R", " ", "Wawm", " ", "Zaf"}], "-", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"r", " ", "Wawf", " ", "Zam"}], "+", 
                    RowBox[{"R", " ", "Wawf", " ", "Zam"}], "-", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "R", " ", "Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Wawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "+", "R"}], ")"}], " ", "Zawf"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Wawm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "Wawm"}], "-", 
                    RowBox[{"r", " ", "Zawm"}], "+", 
                    RowBox[{"R", " ", "Zawm"}]}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "MA", " ", "MAa", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "MdA"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "WAwm"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "-", 
                    RowBox[{"r", " ", "Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"r", " ", "WAwm", " ", "Zawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Wawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "+", "R"}], ")"}], " ", "Zawf"}]}], 
                    ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "ZAwm"}], "-", 
                    RowBox[{"r", " ", "Wawf", " ", "ZAwm"}], "-", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwm"}], "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Zaf", "-", 
                    RowBox[{"r", " ", "Zaf"}], "-", 
                    RowBox[{"2", " ", "r", " ", "Zawf"}]}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "WAwm"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "ZAm"}], "+", 
                    
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "ZAwm"}]}], 
                    ")"}]}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", 
                    RowBox[{"r", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Zaf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "Maa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"ZAf", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Ma", " ", "MAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Wawm"}], "+", 
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"MA", " ", "MAA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "WAwm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], "}"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextWawm", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextWawm", ">", "1"}], ",", "1", ",", "nextWawm"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextWAm", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "WAminit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextWam", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "Waminit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextWAwm", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "WAwminit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextWawm", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "Wawminit"}]}], "Input",
 CellChangeTimes->{{3.677609169639257*^9, 3.677609254342773*^9}, {
   3.67760929940635*^9, 3.677609319747704*^9}, {3.677609415700798*^9, 
   3.677609588703081*^9}, {3.677609626847389*^9, 3.677609758420228*^9}, {
   3.6776097885539618`*^9, 3.677609937619573*^9}, {3.677610469673553*^9, 
   3.677610530805957*^9}, {3.677610564938963*^9, 3.677610911957862*^9}, {
   3.677610959883894*^9, 3.677611207705814*^9}, {3.677611280462638*^9, 
   3.677611329886663*^9}, {3.6776114444636097`*^9, 3.677611452511242*^9}, {
   3.6776115544456167`*^9, 3.677611643514182*^9}, {3.6776150177966127`*^9, 
   3.677615027913282*^9}, 3.6862974070147743`*^9, {3.68629744448654*^9, 
   3.686297498822525*^9}, 3.6862975298832207`*^9, {3.686297575514308*^9, 
   3.686297579276594*^9}, 3.6862976204287043`*^9, 3.686844713956946*^9, {
   3.6868447748667517`*^9, 3.686844932319375*^9}, 3.686844982985793*^9, {
   3.68684508571594*^9, 3.686845106699781*^9}, {3.6868451699832363`*^9, 
   3.686845232889612*^9}, 3.686845267633327*^9, {3.686848758280573*^9, 
   3.6868488870394497`*^9}, {3.686849390488199*^9, 3.6868494470450907`*^9}, {
   3.68684976368804*^9, 3.686849831755412*^9}, {3.6868503564975147`*^9, 
   3.6868504122801113`*^9}, {3.686850904991899*^9, 3.6868509294129477`*^9}, {
   3.686889931626089*^9, 3.686889969842772*^9}, 3.6868958323453827`*^9, 
   3.686895869396394*^9, 3.6868959254661903`*^9, {3.686895993025148*^9, 
   3.6868960754021263`*^9}, {3.6939420820792103`*^9, 3.693942096945017*^9}, {
   3.693942212289627*^9, 3.6939422250277243`*^9}, {3.6939422855843697`*^9, 
   3.693942500933766*^9}, {3.693942602467702*^9, 3.693942804549776*^9}, {
   3.6939429862426033`*^9, 3.6939430732474327`*^9}, {3.693943127205608*^9, 
   3.693943202110318*^9}, {3.693943341745666*^9, 3.693943503121986*^9}, {
   3.693944402216106*^9, 3.6939444716639853`*^9}, {3.693944547591316*^9, 
   3.693944606517273*^9}, {3.693945146543942*^9, 3.693945156500709*^9}, {
   3.693945386895547*^9, 3.693945392726842*^9}, {3.71069877819724*^9, 
   3.7106988213224287`*^9}},
 ExpressionUUID -> "93ef1e00-1b2f-4434-a97a-0e93f9e58531"]
}, Closed]],

Cell[CellGroupData[{

Cell["Next female W genotypes", "Subsubsection",
 CellChangeTimes->{{3.6776115327480087`*^9, 3.6776115358133593`*^9}, {
  3.6776116604232187`*^9, 3.677611665578927*^9}, {3.6868458653430653`*^9, 
  3.686845870890107*^9}, {3.693943769170108*^9, 3.693943769474371*^9}},
 ExpressionUUID -> "a681b1f7-3535-4a78-b0e9-d7906b4981d0"],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "a", ",", "M", ",", "het"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "A", ",", "m", ",", "het"}]], ",", 
                "\[IndentingNewLine]", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "a", ",", "m", ",", "het"}]]}], 
               "\[IndentingNewLine]", "}"}], "/.", "sumsex"}], "/.", 
             "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.", "pseg2"}], "/.",
          "pseg3"}], "/.", "pseg4"}], "/.", "varsubZW"}], "/.", "freqsubZW"}],
      "/.", "recGen"}], "/.", "\[Chi]XAM"}], "]"}], "*)"}]], "Input",
 CellChangeTimes->{{3.710698882134109*^9, 3.71069888926012*^9}, 
   3.710698998807304*^9}],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"nextWAf", ",", "nextWaf", ",", "nextWAwf", ",", "nextWawf"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.677615031991831*^9, 3.6776150485649843`*^9}, {
  3.693942044596998*^9, 3.6939420481406393`*^9}, {3.693942116090954*^9, 
  3.693942117022464*^9}, {3.693942189469144*^9, 3.693942189876115*^9}, {
  3.6939438615377617`*^9, 3.693943868345953*^9}},
 ExpressionUUID -> "b1ab761a-32bc-4a61-ae32-c2254f705fb0"],

Cell["\<\
Make functions to get frequencies of each Wf genotype in generation t. This \
depends on what the frequencies of all other genotypes were at time t (inside \
the blocks).\
\>", "Text",
 CellChangeTimes->{{3.686296383816608*^9, 3.686296480375799*^9}, {
  3.6862965305972853`*^9, 3.686296546944943*^9}, {3.6862966145847816`*^9, 
  3.6862966217461567`*^9}, {3.693942195786695*^9, 3.693942196211557*^9}, {
  3.71069889681247*^9, 3.7106988978441563`*^9}},
 ExpressionUUID -> "5ddfd617-875e-4d6e-be86-37dd8ac8f51c"],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"nextWAf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], 
   RowBox[{
    RowBox[{"nextWAf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"(*", " ", 
     RowBox[{
     "These", " ", "are", " ", "the", " ", "frequencies", " ", "of", " ", 
      "all", " ", "genotypes", " ", "at", " ", "the", " ", "previous", " ", 
      "timestep"}], " ", "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextWAf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "Fa", " ", "FAa", " ", "FdA", " ", 
              "MA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "-", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"R", " ", "WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "-", 
                    RowBox[{"R", " ", "Wawf", " ", "ZAm"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Wawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "Zawf"}]}], ")"}]}]}], ")"}]}], "+", 
                RowBox[{"Waf", " ", 
                 RowBox[{"(", 
                  RowBox[{"WAm", "-", 
                   RowBox[{"2", " ", "R", " ", "WAm"}], "+", 
                   RowBox[{"r", " ", "ZAm"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwm"}], "+", "ZAwm"}], ")"}]}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "-", 
                    RowBox[{"2", " ", "r", " ", "ZAm"}], "+", "ZAwm", "-", 
                    RowBox[{"k", " ", "ZAwm"}], "-", 
                    RowBox[{"r", " ", "ZAwm"}], "+", 
                    RowBox[{"k", " ", "r", " ", "ZAwm"}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], "+", 
             RowBox[{"FA", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"2", " ", "FAa", " ", "FdA", " ", "Ma", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "r"}], " ", "Wawm", " ", "ZAf"}], "+", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wawm"}], " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwf"}], "+", "ZAwf"}], ")"}]}]}], 
                    ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "r"}], ")"}], " ", "Wawm", " ", "ZAf"}],
                     "-", 
                    RowBox[{"r", " ", "WAwf", " ", "Zam"}], "-", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf", "-", 
                    RowBox[{"r", " ", "ZAwf"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                   RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Wam"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"3", " ", "R"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["R", "2"]}]}], ")"}], " ", "Wawm"}], "-", 
                    "Zam", "+", 
                    RowBox[{"r", " ", "Zam"}], "+", 
                    RowBox[{"2", " ", "R", " ", "Zam"}], "-", 
                    RowBox[{"2", " ", "r", " ", "R", " ", "Zam"}], "-", 
                    "Zawm", "+", 
                    RowBox[{"k", " ", "Zawm"}], "+", 
                    RowBox[{"r", " ", "Zawm"}], "-", 
                    RowBox[{"k", " ", "r", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "Zawm"}], "-", 
                    RowBox[{"2", " ", "k", " ", "R", " ", "Zawm"}], "-", 
                    RowBox[{"r", " ", "R", " ", "Zawm"}], "+", 
                    RowBox[{"k", " ", "r", " ", "R", " ", "Zawm"}], "-", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", "Zawm"}], "+", 
                    RowBox[{"k", " ", 
                    SuperscriptBox["R", "2"], " ", "Zawm"}]}], ")"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{"FAA", " ", "MA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"r", "-", "R"}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "ZAm"}]}], ")"}]}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "WAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "ZAwf"}]}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"4", " ", "R"}]}], ")"}], " ", "WAm"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k", "+", 
                    RowBox[{"2", " ", "R"}], "-", 
                    RowBox[{"2", " ", "k", " ", "R"}]}], ")"}], " ", "WAwm"}],
                     "-", "ZAm", "+", 
                    RowBox[{"2", " ", "R", " ", "ZAm"}], "-", "ZAwm", "+", 
                    RowBox[{"k", " ", "ZAwm"}], "+", 
                    RowBox[{"r", " ", "ZAwm"}], "-", 
                    RowBox[{"k", " ", "r", " ", "ZAwm"}], "+", 
                    RowBox[{"R", " ", "ZAwm"}], "-", 
                    RowBox[{"k", " ", "R", " ", "ZAwm"}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextWAf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextWAf", ">", "1"}], ",", "1", ",", "nextWAf"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextWaf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextWaf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextWaf", "=", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "FA", " ", "FAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "Ma", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"r", "-", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"R", " ", "Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "-", 
                    RowBox[{"R", " ", "WAwf", " ", "Zam"}]}], ")"}]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "WAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "ZAwf"}]}], ")"}]}]}], ")"}]}], "-", 
                RowBox[{"WAf", " ", 
                 RowBox[{"(", 
                  RowBox[{"Wam", "-", 
                   RowBox[{"2", " ", "R", " ", "Wam"}], "+", 
                   RowBox[{"r", " ", "Zam"}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawm"}], "+", "Zawm"}], ")"}]}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "-", 
                    RowBox[{"2", " ", "r", " ", "Zam"}], "+", "Zawm", "-", 
                    RowBox[{"k", " ", "Zawm"}], "-", 
                    RowBox[{"r", " ", "Zawm"}], "+", 
                    RowBox[{"k", " ", "r", " ", "Zawm"}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], "+", 
             RowBox[{"Fa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"Faa", " ", "Ma", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{"r", "-", "R"}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "Zam"}]}], ")"}]}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Wawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
                    "Zawf"}]}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"4", " ", "R"}]}], ")"}], " ", "Wam"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k", "+", 
                    RowBox[{"2", " ", "R"}], "-", 
                    RowBox[{"2", " ", "k", " ", "R"}]}], ")"}], " ", "Wawm"}],
                     "-", "Zam", "+", 
                    RowBox[{"2", " ", "R", " ", "Zam"}], "-", "Zawm", "+", 
                    RowBox[{"k", " ", "Zawm"}], "+", 
                    RowBox[{"r", " ", "Zawm"}], "-", 
                    RowBox[{"k", " ", "r", " ", "Zawm"}], "+", 
                    RowBox[{"R", " ", "Zawm"}], "-", 
                    RowBox[{"k", " ", "R", " ", "Zawm"}]}], ")"}]}]}], 
                  ")"}]}], "-", 
                RowBox[{"2", " ", "FAa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "MA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}]}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "r"}], " ", "WAwm", " ", "Zaf"}], "+", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwm"}], " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawf"}], "+", "Zawf"}], ")"}]}]}], 
                    ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "+", "r"}], ")"}], " ", "WAwm", " ", "Zaf"}],
                     "-", 
                    RowBox[{"r", " ", "Wawf", " ", "ZAm"}], "-", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf", "-", 
                    RowBox[{"r", " ", "Zawf"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                   RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "WAm"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"3", " ", "R"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["R", "2"]}]}], ")"}], " ", "WAwm"}], "-", 
                    "ZAm", "+", 
                    RowBox[{"r", " ", "ZAm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "ZAm"}], "-", 
                    RowBox[{"2", " ", "r", " ", "R", " ", "ZAm"}], "-", 
                    "ZAwm", "+", 
                    RowBox[{"k", " ", "ZAwm"}], "+", 
                    RowBox[{"r", " ", "ZAwm"}], "-", 
                    RowBox[{"k", " ", "r", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "ZAwm"}], "-", 
                    RowBox[{"2", " ", "k", " ", "R", " ", "ZAwm"}], "-", 
                    RowBox[{"r", " ", "R", " ", "ZAwm"}], "+", 
                    RowBox[{"k", " ", "r", " ", "R", " ", "ZAwm"}], "-", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", "ZAwm"}], "+", 
                    RowBox[{"k", " ", 
                    SuperscriptBox["R", "2"], " ", "ZAwm"}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextWaf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextWaf", ">", "1"}], ",", "1", ",", "nextWaf"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextWAwf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextWAwf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextWAwf", "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                "2", " ", "Fa", " ", "FAa", " ", "FdA", " ", "MA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "Wawf"}], " ", "WAwm"}], "-", 
                   RowBox[{"WAwm", " ", "Zaf"}], "+", 
                   RowBox[{"r", " ", "WAwm", " ", "Zaf"}], "-", 
                   RowBox[{"WAwm", " ", "Zawf"}], "+", 
                   RowBox[{"r", " ", "WAwm", " ", "Zawf"}], "-", 
                   RowBox[{"r", " ", "Wawf", " ", "ZAwm"}], "-", 
                   RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", 
                    RowBox[{"r", " ", "ZAwm"}]}], ")"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "WAwm"}], " ", "Zaf"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawf"}], "+", "Zawf"}], ")"}]}], "-", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwm"}], "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawf", " ", "WAwm"}], "+", 
                    RowBox[{"2", " ", "WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"r", " ", "WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"r", " ", "Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"2", " ", "WAwm", " ", "Zawf"}], "-", 
                    RowBox[{"2", " ", "r", " ", "WAwm", " ", "Zawf"}], "-", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", 
                    RowBox[{"r", " ", "Zawf"}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", "r", " ", "Wawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "WAwm"}], "+", "ZAwm", "+", 
                    RowBox[{"r", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{"FA", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "2"}], " ", "FAa", " ", "FdA", " ", "Ma", 
                    " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwf", " ", "Wawm"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "-", 
                    RowBox[{"r", " ", "WAwf", " ", "Zam"}], "+", 
                    RowBox[{"r", " ", "Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "WAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "+", "R"}], ")"}], " ", "ZAwf"}]}], 
                    ")"}]}], "+", 
                    RowBox[{"WAwf", " ", "Zawm"}], "-", 
                    RowBox[{"r", " ", "WAwf", " ", "Zawm"}], "-", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawm"}], "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", 
                    RowBox[{"(", 
                    RowBox[{"ZAf", "-", 
                    RowBox[{"r", " ", "ZAf"}], "-", 
                    RowBox[{"2", " ", "r", " ", "ZAwf"}]}], ")"}]}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "Wawm"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "Zam"}], "+", 
                    
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "Zawm"}]}], 
                    ")"}]}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", 
                    RowBox[{"r", " ", "Zawm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}], "+", 
                   RowBox[{"FAA", " ", "MA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "WAwf", " ", "WAwm"}], "+", 
                    RowBox[{"4", " ", "R", " ", "WAwf", " ", "WAwm"}], "-", 
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"r", " ", "WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"R", " ", "WAwm", " ", "ZAf"}], "-", 
                    RowBox[{"WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"r", " ", "WAwf", " ", "ZAm"}], "+", 
                    RowBox[{"R", " ", "WAwf", " ", "ZAm"}], "-", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"2", " ", "R", " ", "WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "WAwf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "+", "R"}], ")"}], " ", "ZAwf"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "WAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "WAwm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "WAwm"}], "-", 
                    RowBox[{"r", " ", "ZAwm"}], "+", 
                    RowBox[{"R", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}]}], ")"}]}], ")"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextWAwf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextWAwf", ">", "1"}], ",", "1", ",", "nextWAwf"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"nextWawf", "[", 
    RowBox[{
    "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", 
     ",", "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", 
     ",", "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
     "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
     "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
     "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
     "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", " ", 
    RowBox[{
    "These", " ", "functions", " ", "are", " ", "then", " ", "repeated", " ", 
     "so", " ", "that", " ", "their", " ", "values", " ", "are", " ", 
     "saved"}], " ", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextWawf", "[", 
     RowBox[{
     "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
      "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
      ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
      "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
      "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
      "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
      "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
    RowBox[{"Block", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"ZAf", "=", 
         RowBox[{"nextZAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zaf", "=", 
         RowBox[{"nextZaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwf", "=", 
         RowBox[{"nextZAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawf", "=", 
         RowBox[{"nextZawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"ZAm", "=", 
         RowBox[{"nextZAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zam", "=", 
         RowBox[{"nextZam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"ZAwm", "=", 
         RowBox[{"nextZAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Zawm", "=", 
         RowBox[{"nextZawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAf", "=", 
         RowBox[{"nextWAf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Waf", "=", 
         RowBox[{"nextWaf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwf", "=", 
         RowBox[{"nextWAwf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawf", "=", 
         RowBox[{"nextWawf", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
        RowBox[{"WAm", "=", 
         RowBox[{"nextWAm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wam", "=", 
         RowBox[{"nextWam", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"WAwm", "=", 
         RowBox[{"nextWAwm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}], ",", "\[IndentingNewLine]", 
        RowBox[{"Wawm", "=", 
         RowBox[{"nextWawm", "[", 
          RowBox[{
           RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
           "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", 
           ",", "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", 
           ",", "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", 
           ",", "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", 
           ",", "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", 
           ",", "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}],
           "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", 
      RowBox[{"(*", " ", 
       RowBox[{
       "We", " ", "use", " ", "another", " ", "Block", " ", "function", " ", 
        "in", " ", "combination", " ", "with", " ", "an", " ", "If", " ", 
        "statement", " ", "to", " ", "prevent", " ", "frequencies", " ", 
        "from", " ", "exceeding", " ", "0", " ", "or", " ", "1"}], " ", 
       "*)"}], "\[IndentingNewLine]", 
      RowBox[{"Block", "[", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"nextWawf", "=", 
          RowBox[{
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "2"}], " ", "FA", " ", "FAa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "Ma", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", "WAwf"}], " ", "Wawm"}], "-", 
                   RowBox[{"Wawm", " ", "ZAf"}], "+", 
                   RowBox[{"r", " ", "Wawm", " ", "ZAf"}], "-", 
                   RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                   RowBox[{"r", " ", "Wawm", " ", "ZAwf"}], "-", 
                   RowBox[{"r", " ", "WAwf", " ", "Zawm"}], "-", 
                   RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", 
                    RowBox[{"r", " ", "Zawm"}]}], ")"}]}], "+", 
                   RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "Wawm"}], " ", "ZAf"}], "+", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwf"}], "+", "ZAwf"}], ")"}]}], "-", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "Wawm"}], "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwf", " ", "Wawm"}], "+", 
                    RowBox[{"2", " ", "Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"r", " ", "Wawm", " ", "ZAf"}], "-", 
                    RowBox[{"WAwf", " ", "Zam"}], "+", 
                    RowBox[{"r", " ", "WAwf", " ", "Zam"}], "+", 
                    RowBox[{"2", " ", "Wawm", " ", "ZAwf"}], "-", 
                    RowBox[{"2", " ", "r", " ", "Wawm", " ", "ZAwf"}], "-", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", 
                    RowBox[{"r", " ", "ZAwf"}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", "r", " ", "WAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"3", " ", "Wawm"}], "+", "Zawm", "+", 
                    RowBox[{"r", " ", "Zawm"}]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}], "+", 
                RowBox[{"Fa", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"Faa", " ", "Ma", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "Wawf", " ", "Wawm"}], "+", 
                    RowBox[{"4", " ", "R", " ", "Wawf", " ", "Wawm"}], "-", 
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"r", " ", "Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"R", " ", "Wawm", " ", "Zaf"}], "-", 
                    RowBox[{"Wawf", " ", "Zam"}], "+", 
                    RowBox[{"r", " ", "Wawf", " ", "Zam"}], "+", 
                    RowBox[{"R", " ", "Wawf", " ", "Zam"}], "-", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"2", " ", "R", " ", "Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Wawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "+", "R"}], ")"}], " ", "Zawf"}]}], 
                    ")"}]}], "-", 
                    RowBox[{"Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "Wawf", " ", "Zawm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "Wawm"}], "+", 
                    RowBox[{"2", " ", "R", " ", "Wawm"}], "-", 
                    RowBox[{"r", " ", "Zawm"}], "+", 
                    RowBox[{"R", " ", "Zawm"}]}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"2", " ", "FAa", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "FdA"}], ")"}], " ", "MA", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawf", " ", "WAwm"}], "+", 
                    RowBox[{"Wawf", " ", "ZAm"}], "-", 
                    RowBox[{"r", " ", "Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"r", " ", "WAwm", " ", "Zawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", "Wawf"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "r"}], "+", "R"}], ")"}], " ", "Zawf"}]}], 
                    ")"}]}], "+", 
                    RowBox[{"Wawf", " ", "ZAwm"}], "-", 
                    RowBox[{"r", " ", "Wawf", " ", "ZAwm"}], "-", 
                    RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "-", 
                    RowBox[{"Wawf", " ", "ZAm"}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", "WAwm"}], "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Zaf", "-", 
                    RowBox[{"r", " ", "Zaf"}], "-", 
                    RowBox[{"2", " ", "r", " ", "Zawf"}]}], ")"}]}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", "WAwm"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "r"}], ")"}], " ", "ZAm"}], "+", 
                    
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "ZAwm"}]}], 
                    ")"}]}], "+", 
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", 
                    RowBox[{"r", " ", "ZAwm"}]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "R"}]}], ")"}], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"Fa", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"Faa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "Zaf"}], "+", 
                    RowBox[{"Wawm", " ", "Zawf"}], "+", 
                    RowBox[{"Zam", " ", "Zawf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "Zawm"}], "+", 
                    RowBox[{"Zawf", " ", "Zawm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAa", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Waf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "Zaf"}], "+", 
                    RowBox[{"WAwm", " ", "Zawf"}], "+", 
                    RowBox[{"ZAm", " ", "Zawf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                    RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                    RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                    RowBox[{"Wawf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"FA", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"FAa", " ", "Ma", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wam", "+", "Wawm", "-", 
                    RowBox[{"k", " ", "Wawm"}], "+", "Zam", "+", "Zawm", "-", 
                    
                    RowBox[{"k", " ", "Zawm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"Wawm", " ", "ZAf"}], "+", 
                    RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                    RowBox[{"Zam", " ", "ZAwf"}], "+", 
                    RowBox[{"Wam", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "Zawm"}], "+", 
                    RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"FAA", " ", "MA", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAm", "+", "WAwm", "-", 
                    RowBox[{"k", " ", "WAwm"}], "+", "ZAm", "+", "ZAwm", "-", 
                    
                    RowBox[{"k", " ", "ZAwm"}]}], ")"}]}], "-", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"WAwm", " ", "ZAf"}], "+", 
                    RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                    RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                    RowBox[{"WAm", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                    RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                    RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                    RowBox[{"WAwf", " ", 
                    RowBox[{"(", 
                    RowBox[{"WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}]}], ")"}]}]}], 
         "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"If", "[", 
         RowBox[{
          RowBox[{"nextWawf", "<", "0"}], ",", "0", ",", 
          RowBox[{"If", "[", 
           RowBox[{
            RowBox[{"nextWawf", ">", "1"}], ",", "1", ",", "nextWawf"}], 
           "]"}]}], "]"}]}], "]"}]}], "\[IndentingNewLine]", "]"}]}]}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextWAf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "WAfinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextWaf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "Wafinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextWAwf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "WAwfinit"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"nextWawf", "[", 
   RowBox[{
   "0", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",", 
    "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  "Wawfinit"}]}], "Input",
 CellChangeTimes->{{3.677609169639257*^9, 3.677609254342773*^9}, {
   3.67760929940635*^9, 3.677609319747704*^9}, {3.677609415700798*^9, 
   3.677609588703081*^9}, {3.677609626847389*^9, 3.677609758420228*^9}, {
   3.6776097885539618`*^9, 3.677609937619573*^9}, {3.677610469673553*^9, 
   3.677610530805957*^9}, {3.677610564938963*^9, 3.677610911957862*^9}, {
   3.677610959883894*^9, 3.677611207705814*^9}, {3.677611280462638*^9, 
   3.677611329886663*^9}, {3.6776114444636097`*^9, 3.677611452511242*^9}, {
   3.6776115544456167`*^9, 3.677611643514182*^9}, {3.6776150177966127`*^9, 
   3.677615027913282*^9}, 3.6862974070147743`*^9, {3.68629744448654*^9, 
   3.686297498822525*^9}, 3.6862975298832207`*^9, {3.686297575514308*^9, 
   3.686297579276594*^9}, 3.6862976204287043`*^9, 3.686844713956946*^9, {
   3.6868447748667517`*^9, 3.686844932319375*^9}, 3.686844982985793*^9, {
   3.68684508571594*^9, 3.686845106699781*^9}, {3.6868451699832363`*^9, 
   3.686845232889612*^9}, 3.686845267633327*^9, {3.686848758280573*^9, 
   3.6868488870394497`*^9}, {3.686849390488199*^9, 3.6868494470450907`*^9}, {
   3.68684976368804*^9, 3.686849831755412*^9}, {3.6868503564975147`*^9, 
   3.6868504122801113`*^9}, {3.686850904991899*^9, 3.6868509294129477`*^9}, {
   3.686889931626089*^9, 3.686889969842772*^9}, 3.6868958323453827`*^9, 
   3.686895869396394*^9, 3.6868959254661903`*^9, {3.686895993025148*^9, 
   3.6868960754021263`*^9}, {3.6939420820792103`*^9, 3.693942096945017*^9}, {
   3.693942212289627*^9, 3.6939422250277243`*^9}, {3.6939422855843697`*^9, 
   3.693942500933766*^9}, {3.693942602467702*^9, 3.693942804549776*^9}, {
   3.6939429862426033`*^9, 3.6939430732474327`*^9}, {3.693943127205608*^9, 
   3.693943202110318*^9}, {3.693943874620751*^9, 3.69394409152744*^9}, {
   3.693944124016296*^9, 3.693944152663671*^9}, {3.6939446955078*^9, 
   3.6939447081481943`*^9}, {3.693944738557625*^9, 3.693944750224546*^9}, {
   3.693945127873674*^9, 3.6939451380088577`*^9}, {3.693945367558322*^9, 
   3.6939453743732357`*^9}, {3.710698955080945*^9, 3.7106989925268784`*^9}},
 ExpressionUUID -> "1ea8d64d-9097-4954-a81c-6377dc93c353"]
}, Closed]],

Cell[CellGroupData[{

Cell["Sex ratio at birth", "Subsubsection",
 CellChangeTimes->{{3.6869215593469954`*^9, 3.686921563475671*^9}},
 ExpressionUUID -> "ad761b3c-1e10-4855-8eba-e5dda4e4e893"],

Cell["the frequency of males", "Text",
 CellChangeTimes->{{3.710693605684939*^9, 3.710693608940333*^9}, {
  3.710697837451817*^9, 3.710697837601562*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"ParallelSum", "[", 
          RowBox[{
           SubscriptBox["fDipSex", 
            RowBox[{
            "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
             "hom"}]], ",", 
           RowBox[{"{", 
            RowBox[{"xM", ",", 
             RowBox[{"{", 
              RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"yM", ",", 
             RowBox[{"{", 
              RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zM", ",", 
             RowBox[{"{", 
              RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xP", ",", 
             RowBox[{"{", 
              RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"yP", ",", 
             RowBox[{"{", 
              RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zP", ",", 
             RowBox[{"{", 
              RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"ParallelSum", "[", 
          RowBox[{
           SubscriptBox["fDipSex", 
            RowBox[{
            "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
             "sex"}]], ",", 
           RowBox[{"{", 
            RowBox[{"xM", ",", 
             RowBox[{"{", 
              RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"yM", ",", 
             RowBox[{"{", 
              RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zM", ",", 
             RowBox[{"{", 
              RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"xP", ",", 
             RowBox[{"{", 
              RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"yP", ",", 
             RowBox[{"{", 
              RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"zP", ",", 
             RowBox[{"{", 
              RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"sex", ",", 
             RowBox[{"{", 
              RowBox[{"het", ",", "hom"}], "}"}]}], "}"}]}], "]"}], ")"}]}], "/.",
        "freqsubZW"}], "/.", "sumsex"}], "/.", "invXY"}], "/.", "varsubZW"}], 
   "//", "Simplify"}], "*)"}]], "Input",
 CellChangeTimes->{{3.708109679877839*^9, 3.7081096859397078`*^9}, {
   3.71069449584134*^9, 3.710694497737994*^9}, {3.7106945447999563`*^9, 
   3.7106945645522547`*^9}, {3.71069466869072*^9, 3.710694671755224*^9}, {
   3.710694704064241*^9, 3.710694766228612*^9}, 3.7106949140433893`*^9, {
   3.71069778519057*^9, 3.710697841583333*^9}, {3.7106990108916893`*^9, 
   3.710699019574795*^9}, 3.7106990634430637`*^9},
 ExpressionUUID -> "f3daabac-0f9e-442a-8969-3d97f297e044"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"Clear", "[", "sexRatioAtBirthZW", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"sexRatioAtBirthZW", "[", 
   RowBox[{
   "t_", ",", "FAA_", ",", "FAa_", ",", "Faa_", ",", "MAA_", ",", "MAa_", ",",
     "Maa_", ",", "MA_", ",", "Ma_", ",", "FA_", ",", "Fa_", ",", "r_", ",", 
    "R_", ",", "MdA_", ",", "FdA_", ",", "k_", ",", "ZAfinit_", ",", 
    "Zafinit_", ",", "ZAwfinit_", ",", "Zawfinit_", ",", "ZAminit_", ",", 
    "Zaminit_", ",", "ZAwminit_", ",", "Zawminit_", ",", "WAfinit_", ",", 
    "Wafinit_", ",", "WAwfinit_", ",", "Wawfinit_", ",", "WAminit_", ",", 
    "Waminit_", ",", "WAwminit_", ",", "Wawminit_"}], "]"}], ":=", 
  RowBox[{
   RowBox[{"sexRatioAtBirthZW", "[", 
    RowBox[{
    "t", ",", "FAA", ",", "FAa", ",", "Faa", ",", "MAA", ",", "MAa", ",", 
     "Maa", ",", "MA", ",", "Ma", ",", "FA", ",", "Fa", ",", "r", ",", "R", 
     ",", "MdA", ",", "FdA", ",", "k", ",", "ZAfinit", ",", "Zafinit", ",", 
     "ZAwfinit", ",", "Zawfinit", ",", "ZAminit", ",", "Zaminit", ",", 
     "ZAwminit", ",", "Zawminit", ",", "WAfinit", ",", "Wafinit", ",", 
     "WAwfinit", ",", "Wawfinit", ",", "WAminit", ",", "Waminit", ",", 
     "WAwminit", ",", "Wawminit"}], "]"}], "=", "\[IndentingNewLine]", 
   RowBox[{"Block", "[", 
    RowBox[{
     RowBox[{"{", 
      RowBox[{
       RowBox[{"ZAf", "=", 
        RowBox[{"nextZAf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Zaf", "=", 
        RowBox[{"nextZaf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ZAwf", "=", 
        RowBox[{"nextZAwf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Zawf", "=", 
        RowBox[{"nextZawf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"ZAm", "=", 
        RowBox[{"nextZAm", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Zam", "=", 
        RowBox[{"nextZam", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"ZAwm", "=", 
        RowBox[{"nextZAwm", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Zawm", "=", 
        RowBox[{"nextZawm", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"WAf", "=", 
        RowBox[{"nextWAf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Waf", "=", 
        RowBox[{"nextWaf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"WAwf", "=", 
        RowBox[{"nextWAwf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Wawf", "=", 
        RowBox[{"nextWawf", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
       RowBox[{"WAm", "=", 
        RowBox[{"nextWAm", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Wam", "=", 
        RowBox[{"nextWam", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"WAwm", "=", 
        RowBox[{"nextWAwm", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"Wawm", "=", 
        RowBox[{"nextWawm", "[", 
         RowBox[{
          RowBox[{"t", "-", "1"}], ",", "FAA", ",", "FAa", ",", "Faa", ",", 
          "MAA", ",", "MAa", ",", "Maa", ",", "MA", ",", "Ma", ",", "FA", ",",
           "Fa", ",", "r", ",", "R", ",", "MdA", ",", "FdA", ",", "k", ",", 
          "ZAfinit", ",", "Zafinit", ",", "ZAwfinit", ",", "Zawfinit", ",", 
          "ZAminit", ",", "Zaminit", ",", "ZAwminit", ",", "Zawminit", ",", 
          "WAfinit", ",", "Wafinit", ",", "WAwfinit", ",", "Wawfinit", ",", 
          "WAminit", ",", "Waminit", ",", "WAwminit", ",", "Wawminit"}], 
         "]"}]}]}], "}"}], ",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Fa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Zaf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", 
               RowBox[{"(", 
                RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
              RowBox[{"MA", " ", 
               RowBox[{"(", 
                RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawf", " ", "Wawm"}], "+", 
                 RowBox[{"Wawm", " ", "Zaf"}], "+", 
                 RowBox[{"Wawf", " ", "Zam"}], "+", 
                 RowBox[{"Wawm", " ", "Zawf"}], "+", 
                 RowBox[{"Zam", " ", "Zawf"}], "+", 
                 RowBox[{"Wam", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                 RowBox[{"Wawf", " ", "Zawm"}], "+", 
                 RowBox[{"Zaf", " ", "Zawm"}], "+", 
                 RowBox[{"Zawf", " ", "Zawm"}], "+", 
                 RowBox[{"Waf", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"MA", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"Wawf", " ", "WAwm"}], "+", 
                 RowBox[{"WAwm", " ", "Zaf"}], "+", 
                 RowBox[{"Wawf", " ", "ZAm"}], "+", 
                 RowBox[{"WAwm", " ", "Zawf"}], "+", 
                 RowBox[{"ZAm", " ", "Zawf"}], "+", 
                 RowBox[{"WAm", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawf", "+", "Zawf"}], ")"}]}], "+", 
                 RowBox[{"Wawf", " ", "ZAwm"}], "+", 
                 RowBox[{"Zaf", " ", "ZAwm"}], "+", 
                 RowBox[{"Zawf", " ", "ZAwm"}], "+", 
                 RowBox[{"Waf", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"FA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"ZAf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", 
               RowBox[{"(", 
                RowBox[{"Wam", "+", "Zam"}], ")"}]}], "+", 
              RowBox[{"MA", " ", 
               RowBox[{"(", 
                RowBox[{"WAm", "+", "ZAm"}], ")"}]}]}], ")"}]}], "+", 
           RowBox[{"k", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"Ma", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwf", " ", "Wawm"}], "+", 
                 RowBox[{"Wawm", " ", "ZAf"}], "+", 
                 RowBox[{"WAwf", " ", "Zam"}], "+", 
                 RowBox[{"Wawm", " ", "ZAwf"}], "+", 
                 RowBox[{"Zam", " ", "ZAwf"}], "+", 
                 RowBox[{"Wam", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                 RowBox[{"WAwf", " ", "Zawm"}], "+", 
                 RowBox[{"ZAf", " ", "Zawm"}], "+", 
                 RowBox[{"ZAwf", " ", "Zawm"}], "+", 
                 RowBox[{"WAf", " ", 
                  RowBox[{"(", 
                   RowBox[{"Wawm", "+", "Zawm"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{"MA", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"WAwf", " ", "WAwm"}], "+", 
                 RowBox[{"WAwm", " ", "ZAf"}], "+", 
                 RowBox[{"WAwf", " ", "ZAm"}], "+", 
                 RowBox[{"WAwm", " ", "ZAwf"}], "+", 
                 RowBox[{"ZAm", " ", "ZAwf"}], "+", 
                 RowBox[{"WAm", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwf", "+", "ZAwf"}], ")"}]}], "+", 
                 RowBox[{"WAwf", " ", "ZAwm"}], "+", 
                 RowBox[{"ZAf", " ", "ZAwm"}], "+", 
                 RowBox[{"ZAwf", " ", "ZAwm"}], "+", 
                 RowBox[{"WAf", " ", 
                  RowBox[{"(", 
                   RowBox[{"WAwm", "+", "ZAwm"}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Fa", " ", 
           RowBox[{"(", 
            RowBox[{"Waf", "+", "Wawf", "+", "Zaf", "+", "Zawf"}], ")"}]}], 
          "+", 
          RowBox[{"FA", " ", 
           RowBox[{"(", 
            RowBox[{"WAf", "+", "WAwf", "+", "ZAf", "+", "ZAwf"}], ")"}]}]}], 
         ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Ma", " ", 
           RowBox[{"(", 
            RowBox[{"Wam", "+", "Wawm", "+", "Zam", "+", "Zawm"}], ")"}]}], 
          "+", 
          RowBox[{"MA", " ", 
           RowBox[{"(", 
            RowBox[{"WAm", "+", "WAwm", "+", "ZAm", "+", "ZAwm"}], ")"}]}]}], 
         ")"}]}], ")"}]}]}], "\[IndentingNewLine]", "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.677609169639257*^9, 3.677609254342773*^9}, {
   3.67760929940635*^9, 3.677609319747704*^9}, {3.677609415700798*^9, 
   3.677609588703081*^9}, {3.677609626847389*^9, 3.677609758420228*^9}, {
   3.6776097885539618`*^9, 3.677609937619573*^9}, {3.677610469673553*^9, 
   3.677610530805957*^9}, {3.677610564938963*^9, 3.677610911957862*^9}, {
   3.677610959883894*^9, 3.677611207705814*^9}, {3.677611280462638*^9, 
   3.677611329886663*^9}, {3.6776114444636097`*^9, 3.677611452511242*^9}, {
   3.6776115544456167`*^9, 3.677611643514182*^9}, {3.6776150177966127`*^9, 
   3.677615027913282*^9}, {3.677854288571733*^9, 3.677854339732052*^9}, 
   3.677854478718903*^9, 3.677854836410631*^9, {3.677854866656096*^9, 
   3.677854871949402*^9}, 3.677854940350132*^9, 3.67785507538221*^9, {
   3.6869216239344053`*^9, 3.6869217750384083`*^9}, {3.6869219638568897`*^9, 
   3.686922023370496*^9}, {3.686922457935526*^9, 3.686922479162925*^9}, 
   3.693945066408155*^9, {3.6939451808439817`*^9, 3.6939452128101463`*^9}, {
   3.693945433286146*^9, 3.693945435810976*^9}, {3.693945580652691*^9, 
   3.693945592232407*^9}, 3.693945864891953*^9, {3.693948311095052*^9, 
   3.693948316024228*^9}, 3.694069090079691*^9, {3.710694878334611*^9, 
   3.710694896952828*^9}, {3.710695515114966*^9, 3.710695530441573*^9}, 
   3.710695590615864*^9, 3.7106990571414413`*^9},
 ExpressionUUID -> "0108f1c1-e5d4-48e9-a751-b164b7a36a4a"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Parameters", "Subsection",
 CellChangeTimes->{{3.710699133332282*^9, 3.710699135138659*^9}}],

Cell[CellGroupData[{

Cell["First set of parameters", "Subsubsection",
 CellChangeTimes->{{3.693989539935873*^9, 3.693989543391453*^9}, 
   3.694070249209021*^9},
 ExpressionUUID -> "57079b2d-a9ee-4a4e-9e71-1b8c2c72d9e8"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"First", " ", "set", " ", "of", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tmax", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tinterval", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tplotinterval", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"plot", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"inches", "=", "72"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lwd", "=", "0.006"}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "line", " ", "thickness", " ", "as", " ", "fraction", " ", "of", " ", 
      "plot", " ", "width"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"ticksize", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.01"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xplotmin", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xplotmax", "=", "tmax"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yplotmin", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yplotmax", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xsize", "=", 
     RowBox[{"5", "inches"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aspectratio", "=", 
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"fitness", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trysAf", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryhAf", "=", "0.7"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryhAm", "=", "0.7"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trysAm", "=", "0.2"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryt", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryFAA", "=", 
     RowBox[{"1", "+", "trysAf"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryFAa", "=", 
     RowBox[{"1", "+", 
      RowBox[{"tryhAf", " ", "trysAf"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryFaa", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryMAA", "=", 
     RowBox[{"1", "+", "trysAm"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryMAa", "=", 
     RowBox[{"1", "+", 
      RowBox[{"tryhAm", " ", "trysAm"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryMaa", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryMA", "=", 
     RowBox[{"1", "+", "tryt"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryMa", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryFA", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryFa", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryMdA", "=", "0.4"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryFdA", "=", "0.5"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"tryr", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryk", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"get", " ", "equilibrium", " ", "using", " ", "sieve"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tempeq", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"sieve", "[", 
       RowBox[{
       "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", "tryMAA", ",", "tryMAa", 
        ",", "tryMaa", ",", "tryMA", ",", "tryMa", ",", "tryFA", ",", "tryFa",
         ",", "tryr", ",", "tryMdA", ",", "tryFdA"}], "]"}], "]"}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialpXAf", "=", 
     RowBox[{"tempeq", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialpXaf", "=", 
     RowBox[{"tempeq", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialpXAm", "=", 
     RowBox[{"tempeq", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialpXam", "=", 
     RowBox[{"tempeq", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialYAf", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialYaf", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialpYAm", "=", 
     RowBox[{"tempeq", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialpYam", "=", 
     RowBox[{"tempeq", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "mutant", " ", "will", " ", "be", " ", "introduced", " ", 
      "at", " ", "this", " ", "frequency"}], ",", " ", 
     RowBox[{
     "in", " ", "linkage", " ", "equilibrium", " ", "with", " ", "the", " ", 
      "resident"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pM", "=", "0.0001"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMXAf", "=", 
     RowBox[{"pM", " ", "initialpXAf"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMXaf", "=", 
     RowBox[{"pM", " ", "initialpXaf"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMXAm", "=", 
     RowBox[{"pM", " ", "initialpXAm"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMXam", "=", 
     RowBox[{"pM", " ", "initialpXam"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMYAf", "=", 
     RowBox[{"pM", " ", "initialYAf"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMYaf", "=", 
     RowBox[{"pM", " ", "initialYaf"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMYAm", "=", 
     RowBox[{"pM", " ", "initialpYAm"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMYam", "=", 
     RowBox[{"pM", " ", "initialpYam"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.693989516398155*^9, 3.693989553174964*^9}, {
  3.6939896768135347`*^9, 3.6939897241013947`*^9}, {3.6940702387147627`*^9, 
  3.694070249211259*^9}, {3.694070482974772*^9, 3.694070500076527*^9}, {
  3.694070537899955*^9, 3.694070538315805*^9}, {3.6940774433246*^9, 
  3.694077443436825*^9}, {3.706987039021079*^9, 3.7069870439101677`*^9}, {
  3.7069871431229687`*^9, 3.7069871478814774`*^9}, {3.710688457240141*^9, 
  3.710688458360074*^9}, {3.710693334116959*^9, 3.710693335195764*^9}, {
  3.710700018796658*^9, 3.7107000415457373`*^9}},
 ExpressionUUID -> "65b097d2-e7ac-466f-9250-6cc2a175079b"]
}, Closed]],

Cell[CellGroupData[{

Cell["Third set of parameters", "Subsubsection",
 CellChangeTimes->{{3.693989539935873*^9, 3.693989543391453*^9}, {
   3.694012714043355*^9, 3.694012714601129*^9}, 3.694070249217154*^9},
 ExpressionUUID -> "34759ee3-3919-4f2e-aa53-9580a63f307e"],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"Third", " ", "set", " ", "of", " ", "parameters"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"tmax3", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tinterval3", "=", "10"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tplotinterval3", "=", "500"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"plot", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"inches", "=", "72"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"lwd", "=", "0.006"}], ";", 
    RowBox[{"(*", 
     RowBox[{
     "line", " ", "thickness", " ", "as", " ", "fraction", " ", "of", " ", 
      "plot", " ", "width"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"ticksize", "=", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.01"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xplotmin", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xplotmax3", "=", "tmax3"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yplotmin", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"yplotmax", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"xsize", "=", 
     RowBox[{"5", "inches"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"aspectratio", "=", 
     RowBox[{"1", "/", 
      RowBox[{"Sqrt", "[", "2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"fitness", " ", "parameters"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trysAf3", "=", "trysAf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryhAf3", "=", "tryhAf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryhAm3", "=", "tryhAm"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trysAm3", "=", "trysAm"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryt3", "=", "tryt"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryFAA3", "=", 
     RowBox[{"1", "+", "trysAf3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryFAa3", "=", 
     RowBox[{"1", "+", 
      RowBox[{"tryhAf3", " ", "trysAf3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryFaa3", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryMAA3", "=", 
     RowBox[{"1", "+", "trysAm3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryMAa3", "=", 
     RowBox[{"1", "+", 
      RowBox[{"tryhAm3", " ", "trysAm3"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryMaa3", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryMA3", "=", 
     RowBox[{"1", "+", "tryt3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryMa3", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryFA3", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryFa3", "=", "1"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryMdA3", "=", "tryMdA"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryFdA3", "=", "tryFdA"}], ";"}], "\n", 
   RowBox[{
    RowBox[{"tryk3", "=", "tryk"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"tryr3", "=", "0.05"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"get", " ", "equilibrium", " ", "using", " ", "sieve"}], "*)"}], 
   "\n", 
   RowBox[{
    RowBox[{"tempeq", "=", 
     RowBox[{"Flatten", "[", 
      RowBox[{"sieveZW", "[", 
       RowBox[{
       "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", "tryMAA3", ",", 
        "tryMAa3", ",", "tryMaa3", ",", "tryMA3", ",", "tryMa3", ",", 
        "tryFA3", ",", "tryFa3", ",", "tryr3", ",", "tryMdA3", ",", 
        "tryFdA3"}], "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialpZAm3", "=", 
     RowBox[{"tempeq", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialpZam3", "=", 
     RowBox[{"tempeq", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialpZAf3", "=", 
     RowBox[{"tempeq", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialpZaf3", "=", 
     RowBox[{"tempeq", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialWAf3", "=", 
     RowBox[{"tempeq", "[", 
      RowBox[{"[", "5", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialWaf3", "=", 
     RowBox[{"tempeq", "[", 
      RowBox[{"[", "6", "]"}], "]"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialpWAm3", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"initialpWam3", "=", "0"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{
     RowBox[{
     "The", " ", "mutant", " ", "will", " ", "be", " ", "introduced", " ", 
      "at", " ", "this", " ", "frequency"}], ",", " ", 
     RowBox[{
     "in", " ", "linkage", " ", "equilibrium", " ", "with", " ", "the", " ", 
      "resident"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"pM", "=", "0.0001"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMZAf3", "=", 
     RowBox[{"pM", " ", "initialpZAf3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMZaf3", "=", 
     RowBox[{"pM", " ", "initialpZaf3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMZAm3", "=", 
     RowBox[{"pM", " ", "initialpZAm3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMZam3", "=", 
     RowBox[{"pM", " ", "initialpZam3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMWAf3", "=", 
     RowBox[{"pM", " ", "initialWAf3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMWaf3", "=", 
     RowBox[{"pM", " ", "initialWaf3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMWAm3", "=", 
     RowBox[{"pM", " ", "initialpWAm3"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"trypMWam3", "=", 
     RowBox[{"pM", " ", "initialpWam3"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.693990120971794*^9, 3.693990270625169*^9}, {
   3.6939904997495728`*^9, 3.6939904998286*^9}, {3.694012758911709*^9, 
   3.694012784836938*^9}, {3.694012839660297*^9, 3.694012901515312*^9}, {
   3.6940129607405233`*^9, 3.69401303072832*^9}, {3.694013093385021*^9, 
   3.69401309765685*^9}, {3.6940133887244797`*^9, 3.694013416311984*^9}, {
   3.694014023509159*^9, 3.694014024354813*^9}, {3.6940143637959423`*^9, 
   3.6940143638668833`*^9}, {3.6940148533064947`*^9, 3.694014853376845*^9}, {
   3.694015393488385*^9, 3.694015394639257*^9}, 3.69407024921828*^9, {
   3.6940705234208612`*^9, 3.6940705290200853`*^9}, {3.69407747125242*^9, 
   3.6940774713482656`*^9}, 3.708454449042018*^9, {3.7084544961739683`*^9, 
   3.7084544962766*^9}, {3.708454555999209*^9, 3.7084545583211823`*^9}, {
   3.708454588794182*^9, 3.7084545891190147`*^9}, {3.708455019065442*^9, 
   3.7084550267366133`*^9}, {3.7106884873566732`*^9, 
   3.7106884881386967`*^9}, {3.710693631781057*^9, 3.710693644684698*^9}, {
   3.710693795604134*^9, 3.710693812789648*^9}, {3.710693849537179*^9, 
   3.7106938845624037`*^9}, {3.7106939151992073`*^9, 3.710693916845799*^9}, {
   3.710694261863336*^9, 3.710694269880089*^9}, {3.7106991614338093`*^9, 
   3.710699161686778*^9}, {3.710700061735578*^9, 3.7107000707561197`*^9}},
 ExpressionUUID -> "b4b94f95-304d-45be-b5d7-2429b65d0441"]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Plots", "Subsection",
 CellChangeTimes->{{3.710699965161065*^9, 3.710699966847969*^9}}],

Cell[CellGroupData[{

Cell["\<\
Turnover and sex ratio with various recombination rates\
\>", "Subsubsection",
 CellChangeTimes->{{3.694007158797365*^9, 3.694007162667025*^9}, {
   3.694015638808889*^9, 3.694015639291779*^9}, 3.694070249222465*^9, {
   3.7068976639633207`*^9, 3.7068976645127687`*^9}, {3.7081099177262506`*^9, 
   3.7081099179485703`*^9}, {3.7081099635463552`*^9, 3.708109964436701*^9}, {
   3.7081298066696043`*^9, 3.7081298274480543`*^9}, {3.708176466604995*^9, 
   3.70817646846882*^9}, {3.708179978152433*^9, 3.708179995753502*^9}, {
   3.710699242901424*^9, 3.710699243420923*^9}},
 ExpressionUUID -> "39fbaf7f-37a8-4e2c-87ff-1dfa63532eb1"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"tryRs", "=", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0.05", ",", "0.25", ",", "0.45"}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmax", "=", "1000"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tmax3", "=", "tmax"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"tplotinterval", "=", "200"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"tplotinterval3", "=", "tplotinterval"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yplotmax", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yplotmin", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot1", "=", 
   RowBox[{"Legended", "[", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{
        RowBox[{"tryR", "=", 
         RowBox[{"tryRs", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "W", " ", "frequency", " ", "in", " ", "haploids", " ", "from", " ", 
          "females"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "\[IndentingNewLine]", 
              RowBox[{"Total", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"nextYAwf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nextYawf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nextXAwf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nextXawf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "tmax", ",", "tinterval"}], "}"}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tryR", "=", 
         RowBox[{"tryRs", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "W", " ", "frequency", " ", "in", " ", "haploids", " ", "from", " ", 
          "females"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "\[IndentingNewLine]", 
              RowBox[{"Total", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"nextYAwf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nextYawf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nextXAwf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nextXawf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "tmax", ",", "tinterval"}], "}"}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Directive", "[", 
             RowBox[{"Red", ",", 
              RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
              RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tryR", "=", 
         RowBox[{"tryRs", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "W", " ", "frequency", " ", "in", " ", "haploids", " ", "from", " ", 
          "females"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "\[IndentingNewLine]", 
              RowBox[{"Total", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"nextYAwf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nextYawf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nextXAwf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nextXawf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "tmax", ",", "tinterval"}], "}"}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Directive", "[", 
             RowBox[{"Blue", ",", 
              RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
              RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"tryR", "=", 
         RowBox[{"tryRs", "[", 
          RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
        RowBox[{"(*", 
         RowBox[{
         "W", " ", "frequency", " ", "in", " ", "haploids", " ", "from", " ", 
          "females"}], "*)"}], "\[IndentingNewLine]", 
        RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"t", ",", "\[IndentingNewLine]", 
              RowBox[{"Total", "[", 
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"nextYAwf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nextYawf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nextXAwf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}], ",", 
                 "\[IndentingNewLine]", 
                 RowBox[{"nextXawf", "[", 
                  RowBox[{
                  "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                   "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                   "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", 
                   "tryR", ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                   "trypMXAf", ",", "trypMXaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                   "trypMXAm", ",", "trypMXam", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                   "trypMYAf", ",", "trypMYaf", ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                   "trypMYAm", ",", "trypMYam"}], "]"}]}], 
                "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"t", ",", "0", ",", "tmax", ",", "tinterval"}], "}"}]}], 
           "]"}], ",", "\[IndentingNewLine]", 
          RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotRange", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
          RowBox[{"PlotStyle", "\[Rule]", 
           RowBox[{"{", 
            RowBox[{"Directive", "[", 
             RowBox[{
              RowBox[{"Darker", "[", "Green", "]"}], ",", 
              RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
              RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}], "}"}]}]}], 
         "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
       "\[IndentingNewLine]", 
       RowBox[{"Plot", "[", 
        RowBox[{"0.5", ",", 
         RowBox[{"{", 
          RowBox[{"x", ",", "0", ",", "10000"}], "}"}], ",", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", "Dashed", "}"}]}]}], "]"}], ",", "\[IndentingNewLine]",
        "\[IndentingNewLine]", 
       RowBox[{"Frame", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
       ",", "\[IndentingNewLine]", 
       RowBox[{"ImageSize", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"xsize", ",", 
          RowBox[{"xsize", " ", "aspectratio"}]}], " ", "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"AspectRatio", "\[Rule]", "aspectratio"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"FrameTicks", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"x", ",", "x", ",", "ticksize"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{
             "x", ",", "xplotmin", ",", "xplotmax", ",", "tplotinterval"}], 
             "}"}]}], "]"}], ",", 
          RowBox[{"Table", "[", 
           RowBox[{
            RowBox[{"{", 
             RowBox[{"y", ",", "y", ",", "ticksize"}], "}"}], ",", 
            RowBox[{"{", 
             RowBox[{"y", ",", "yplotmin", ",", "yplotmax", ",", "0.5"}], 
             "}"}]}], "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameTicksStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
            RowBox[{"Directive", "[", 
             RowBox[{"FontColor", "\[Rule]", "White"}], "]"}], ",", 
            RowBox[{"Directive", "[", 
             RowBox[{"Black", ",", 
              RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}]}], "}"}]}], 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Thickness", "[", "lwd", "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"Black", ",", 
            RowBox[{"Thickness", "[", "lwd", "]"}]}], "}"}], ",", "None", ",",
           "None"}], "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"FrameLabel", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"BaseStyle", "\[Rule]", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
          RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], ",", 
       "\[IndentingNewLine]", 
       RowBox[{"ImagePadding", "\[Rule]", "Pad"}], ",", "\[IndentingNewLine]", 
       RowBox[{"Epilog", "\[Rule]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<A\>\"", ",", "14", ",", "Bold"}], "]"}], ",", 
            RowBox[{"Scaled", "@", "letpos"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Rotate", "[", 
           RowBox[{
            RowBox[{"Text", "[", 
             RowBox[{
              RowBox[{"Style", "[", 
               RowBox[{"\"\<neo-W frequency in females\>\"", ",", "14"}], 
               "]"}], ",", 
              RowBox[{"Scaled", "@", "ylabpos"}]}], "]"}], ",", 
            RowBox[{"90", " ", "Degree"}]}], "]"}]}], "\[IndentingNewLine]", 
         "}"}]}], ",", "\[IndentingNewLine]", 
       RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], 
      "\[IndentingNewLine]", "]"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Placed", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LineLegend", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Red", ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
             RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Blue", ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
             RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Darker", "[", "Green", "]"}], ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
             RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<\!\(\*
StyleBox[\"R\",
FontSlant->\"Italic\"]\)=0\>\"", ",", "14"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<\!\(\*
StyleBox[\"R\",
FontSlant->\"Italic\"]\)=1/20\>\"", ",", "14"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<\!\(\*
StyleBox[\"R\",
FontSlant->\"Italic\"]\)=1/4\>\"", ",", "14"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<\!\(\*
StyleBox[\"R\",
FontSlant->\"Italic\"]\)=1/2\>\"", ",", "14"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LegendLayout", "\[Rule]", "\"\<Column\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Spacings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "0.1"}], "}"}]}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.8", ",", "0.75"}], "}"}]}], "\[IndentingNewLine]", "]"}]}],
     "\[IndentingNewLine]", "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.693990320055317*^9, 3.693990461873455*^9}, {
   3.693990547796727*^9, 3.6939905641321573`*^9}, {3.694007169416566*^9, 
   3.694007270681221*^9}, {3.694013922366458*^9, 3.694013925767144*^9}, {
   3.694014308235403*^9, 3.6940143760870447`*^9}, {3.694014548684801*^9, 
   3.694014554620558*^9}, {3.694014986767647*^9, 3.694015134189968*^9}, {
   3.694015555636918*^9, 3.694015584096736*^9}, {3.6940156469758053`*^9, 
   3.694015651904364*^9}, {3.69401606525834*^9, 3.694016070467067*^9}, {
   3.6940162785206127`*^9, 3.694016298997849*^9}, {3.694016335874995*^9, 
   3.6940163580835743`*^9}, 3.694070249222589*^9, {3.706909838812358*^9, 
   3.7069098974254637`*^9}, {3.7069099911199493`*^9, 3.706909991720399*^9}, {
   3.708129749580936*^9, 3.708129783161046*^9}, {3.708129840764908*^9, 
   3.708129849565523*^9}, {3.708129954233303*^9, 3.7081300261066847`*^9}, {
   3.708130187924245*^9, 3.7081302011267242`*^9}, 3.7081321350003633`*^9, {
   3.708132169175509*^9, 3.7081322619261847`*^9}, {3.708132650281427*^9, 
   3.708132652454523*^9}, {3.7081326975332327`*^9, 3.708132969516369*^9}, {
   3.708133006618072*^9, 3.708133041813191*^9}, {3.7081338561844883`*^9, 
   3.708133898229669*^9}, {3.70813393458564*^9, 3.70813396926287*^9}, {
   3.708134040082569*^9, 3.708134054483204*^9}, {3.708134481605999*^9, 
   3.708134496218933*^9}, {3.708134628315194*^9, 3.7081346396269703`*^9}, {
   3.708134781933589*^9, 3.7081347846925573`*^9}, {3.7081348804403048`*^9, 
   3.708134885562983*^9}, {3.708135058601272*^9, 3.708135058756916*^9}, {
   3.708135150626709*^9, 3.708135165910235*^9}, {3.7081760241950417`*^9, 
   3.708176028730339*^9}, {3.708684991163886*^9, 3.708684991758891*^9}, {
   3.7088971036931467`*^9, 3.708897108536542*^9}, {3.7095711206495743`*^9, 
   3.709571127485073*^9}, {3.7095711675760593`*^9, 3.709571181687777*^9}, {
   3.70957123669024*^9, 3.709571253104682*^9}, {3.710699681919916*^9, 
   3.710699723284318*^9}, {3.710699872758624*^9, 3.7106998758783484`*^9}, {
   3.710700091620585*^9, 3.71070009583738*^9}},
 ExpressionUUID -> "efe86c1b-ef7c-4aa5-b26c-b96f125f5a3b"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"yplotmax", "=", "1"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yplotmin", "=", "0"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plot2", "=", 
    RowBox[{"(*", 
     RowBox[{"Legended", "["}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tryR3", "=", 
        RowBox[{"tryRs", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "W", " ", "frequency", " ", "in", " ", "haploids", " ", "from", " ", 
         "females"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[IndentingNewLine]", 
             RowBox[{"Total", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"nextWAwm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"nextWawm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"nextZAwm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"nextZawm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}]}], 
               "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "tmax3", ",", "tinterval3"}], "}"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tryR3", "=", 
        RowBox[{"tryRs", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "W", " ", "frequency", " ", "in", " ", "haploids", " ", "from", " ", 
         "females"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[IndentingNewLine]", 
             RowBox[{"Total", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"nextWAwm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"nextWawm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"nextZAwm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"nextZawm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}]}], 
               "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "tmax3", ",", "tinterval3"}], "}"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Directive", "[", 
            RowBox[{"Red", ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tryR3", "=", 
        RowBox[{"tryRs", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "W", " ", "frequency", " ", "in", " ", "haploids", " ", "from", " ", 
         "females"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[IndentingNewLine]", 
             RowBox[{"Total", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"nextWAwm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"nextWawm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"nextZAwm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"nextZawm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}]}], 
               "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "tmax3", ",", "tinterval3"}], "}"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Directive", "[", 
            RowBox[{"Blue", ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tryR3", "=", 
        RowBox[{"tryRs", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{
        "W", " ", "frequency", " ", "in", " ", "haploids", " ", "from", " ", 
         "females"}], "*)"}], "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[IndentingNewLine]", 
             RowBox[{"Total", "[", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"nextWAwm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"nextWawm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"nextZAwm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}], ",", 
                "\[IndentingNewLine]", 
                RowBox[{"nextZawm", "[", 
                 RowBox[{
                 "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                  "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                  ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                  ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                  ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                  "trypMZAf3", ",", "trypMZaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                  "trypMZAm3", ",", "trypMZam3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                  "trypMWAf3", ",", "trypMWaf3", ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                  "trypMWAm3", ",", "trypMWam3"}], "]"}]}], 
               "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "0", ",", "tmax3", ",", "tinterval3"}], "}"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0", ",", "1"}], "}"}]}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Darker", "[", "Green", "]"}], ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}], "}"}]}]}], 
        "\[IndentingNewLine]", "]"}]}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{"0.5", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "10000"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", "Dashed", "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"xsize", ",", 
         RowBox[{"xsize", " ", "aspectratio"}]}], " ", "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"AspectRatio", "\[Rule]", "aspectratio"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "x", ",", "ticksize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "x", ",", "xplotmin", ",", "tmax3", ",", "tplotinterval3"}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"y", ",", "y", ",", "ticksize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", "yplotmin", ",", "yplotmax", ",", "0.5"}], 
            "}"}]}], "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameTicksStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"FontColor", "\[Rule]", "White"}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"FontColor", "\[Rule]", "White"}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}]}], "}"}]}], 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "lwd", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "lwd", "]"}]}], "}"}], ",", "None", ",", 
         "None"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<\>\"", ",", "\"\<\>\""}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImagePadding", "\[Rule]", "Pad"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Epilog", "\[Rule]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<B\>\"", ",", "14", ",", "Bold"}], "]"}], ",", 
           RowBox[{"Scaled", "@", "letpos"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Rotate", "[", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<neo-Y frequency in males\>\"", ",", "14"}], "]"}], 
             ",", 
             RowBox[{"Scaled", "@", 
              RowBox[{"{", 
               RowBox[{
                RowBox[{"-", "0.075"}], ",", "0.5"}], "}"}]}]}], "]"}], ",", 
           RowBox[{"90", " ", "Degree"}]}], "]"}]}], "\[IndentingNewLine]", 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Placed", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LineLegend", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Red", ",", 
            RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
            RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Blue", ",", 
            RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
            RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<neo-Y\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)in haploids from females\>\"", ",", "14"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<W\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)in haploids from females\>\"", ",", "14"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<W\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)in haploids from males\>\"", ",", "14"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"LegendLayout", "\[Rule]", "\"\<Column\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Spacings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", "0.1"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0.65", ",", "0.185"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
    "\[IndentingNewLine]", "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.693990320055317*^9, 3.693990461873455*^9}, {
   3.693990547796727*^9, 3.6939905641321573`*^9}, {3.694007169416566*^9, 
   3.694007270681221*^9}, {3.694013922366458*^9, 3.694013925767144*^9}, {
   3.694014308235403*^9, 3.6940143760870447`*^9}, {3.694014548684801*^9, 
   3.694014554620558*^9}, {3.694014986767647*^9, 3.694015134189968*^9}, {
   3.694015555636918*^9, 3.694015584096736*^9}, {3.6940156469758053`*^9, 
   3.694015651904364*^9}, {3.69401606525834*^9, 3.694016070467067*^9}, {
   3.6940162785206127`*^9, 3.694016298997849*^9}, {3.694016335874995*^9, 
   3.6940163580835743`*^9}, 3.694070249222589*^9, {3.706909838812358*^9, 
   3.7069098974254637`*^9}, {3.7069099911199493`*^9, 3.706909991720399*^9}, {
   3.708129749580936*^9, 3.708129783161046*^9}, {3.708129840764908*^9, 
   3.708129849565523*^9}, {3.708129954233303*^9, 3.7081300261066847`*^9}, {
   3.708130187924245*^9, 3.7081302011267242`*^9}, 3.7081321350003633`*^9, {
   3.708132169175509*^9, 3.7081322619261847`*^9}, {3.708132650281427*^9, 
   3.708132652454523*^9}, {3.7081326975332327`*^9, 3.708132969516369*^9}, {
   3.708133006618072*^9, 3.708133041813191*^9}, {3.7081338561844883`*^9, 
   3.708133898229669*^9}, {3.70813393458564*^9, 3.70813396926287*^9}, {
   3.708134040082569*^9, 3.708134076890037*^9}, {3.708134301714559*^9, 
   3.708134317288117*^9}, {3.708134867726437*^9, 3.708134874602919*^9}, {
   3.708454307492846*^9, 3.7084543151907167`*^9}, {3.708454644599962*^9, 
   3.708454645380259*^9}, {3.709571270583397*^9, 3.709571277458338*^9}, {
   3.709571309996876*^9, 3.709571343964286*^9}},
 ExpressionUUID -> "f09ab3c7-8b6c-4cff-b377-89a04e960416"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"yplotmax", "=", "0.61"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yplotmin", "=", "0.39"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"plot3", "=", 
   RowBox[{"(*", 
    RowBox[{"Legended", "["}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      RowBox[{"tryR", "=", 
       RowBox[{"tryRs", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"sex", " ", "ratio", " ", "at", " ", "birth"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[IndentingNewLine]", 
            RowBox[{"Total", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"sexRatioAtBirth", "[", 
               RowBox[{
               "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", "tryR",
                 ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                "trypMXAf", ",", "trypMXaf", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                "trypMXAm", ",", "trypMXam", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                "trypMYAf", ",", "trypMYaf", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                "trypMYAm", ",", "trypMYam"}], "]"}], "\[IndentingNewLine]", 
              "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "1", ",", "tmax", ",", "tinterval"}], "}"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"yplotmin", ",", "yplotmax"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"Thickness", "[", "lwd", "]"}], ",", "Dashed"}], "]"}], 
          "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tryR", "=", 
       RowBox[{"tryRs", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"sex", " ", "ratio", " ", "at", " ", "birth"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[IndentingNewLine]", 
            RowBox[{"Total", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"sexRatioAtBirth", "[", 
               RowBox[{
               "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", "tryR",
                 ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                "trypMXAf", ",", "trypMXaf", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                "trypMXAm", ",", "trypMXam", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                "trypMYAf", ",", "trypMYaf", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                "trypMYAm", ",", "trypMYam"}], "]"}], "\[IndentingNewLine]", 
              "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "1", ",", "tmax", ",", "tinterval"}], "}"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"yplotmin", ",", "yplotmax"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"Red", ",", 
            RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
            RowBox[{"Thickness", "[", "lwd", "]"}], ",", "Dashed"}], "]"}], 
          "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tryR", "=", 
       RowBox[{"tryRs", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"sex", " ", "ratio", " ", "at", " ", "birth"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[IndentingNewLine]", 
            RowBox[{"Total", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"sexRatioAtBirth", "[", 
               RowBox[{
               "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", "tryR",
                 ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                "trypMXAf", ",", "trypMXaf", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                "trypMXAm", ",", "trypMXam", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                "trypMYAf", ",", "trypMYaf", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                "trypMYAm", ",", "trypMYam"}], "]"}], "\[IndentingNewLine]", 
              "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "1", ",", "tmax", ",", "tinterval"}], "}"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"yplotmin", ",", "yplotmax"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{"Blue", ",", 
            RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
            RowBox[{"Thickness", "[", "lwd", "]"}], ",", "Dashed"}], "]"}], 
          "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"tryR", "=", 
       RowBox[{"tryRs", "[", 
        RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"sex", " ", "ratio", " ", "at", " ", "birth"}], "*)"}], 
      "\[IndentingNewLine]", 
      RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"t", ",", "\[IndentingNewLine]", 
            RowBox[{"Total", "[", 
             RowBox[{"{", "\[IndentingNewLine]", 
              RowBox[{"sexRatioAtBirth", "[", 
               RowBox[{
               "t", ",", "tryFAA", ",", "tryFAa", ",", "tryFaa", ",", 
                "tryMAA", ",", "tryMAa", ",", "tryMaa", ",", "tryMA", ",", 
                "tryMa", ",", "tryFA", ",", "tryFa", ",", "tryr", ",", "tryR",
                 ",", "tryMdA", ",", "tryFdA", ",", "tryk", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXAf"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXaf"}], ",", 
                "trypMXAf", ",", "trypMXaf", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXAm"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpXam"}], ",", 
                "trypMXAm", ",", "trypMXam", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialYAf"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialYaf"}], ",", 
                "trypMYAf", ",", "trypMYaf", ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpYAm"}], ",", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{"1", "-", "pM"}], ")"}], "initialpYam"}], ",", 
                "trypMYAm", ",", "trypMYam"}], "]"}], "\[IndentingNewLine]", 
              "}"}], "]"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"t", ",", "1", ",", "tmax", ",", "tinterval"}], "}"}]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
        RowBox[{"PlotRange", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"yplotmin", ",", "yplotmax"}], "}"}]}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"Directive", "[", 
           RowBox[{
            RowBox[{"Darker", "[", "Green", "]"}], ",", 
            RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
            RowBox[{"Thickness", "[", "lwd", "]"}], ",", "Dashed"}], "]"}], 
          "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
     "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Plot", "[", 
      RowBox[{"0.5", ",", 
       RowBox[{"{", 
        RowBox[{"x", ",", "0", ",", "10000"}], "}"}], ",", 
       RowBox[{"PlotStyle", "\[Rule]", 
        RowBox[{"{", "Dashed", "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
     "\[IndentingNewLine]", 
     RowBox[{"Frame", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{"ImageSize", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"xsize", ",", 
        RowBox[{"xsize", " ", "aspectratio"}]}], " ", "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"AspectRatio", "\[Rule]", "aspectratio"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameTicks", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"x", ",", "x", ",", "ticksize"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{
           "x", ",", "xplotmin", ",", "xplotmax", ",", "tplotinterval"}], 
           "}"}]}], "]"}], ",", 
        RowBox[{"Table", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{"y", ",", "y", ",", "ticksize"}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"Round", "[", 
             RowBox[{"yplotmin", ",", "0.1"}], "]"}], ",", 
            RowBox[{"Round", "[", 
             RowBox[{"yplotmax", ",", "0.1"}], "]"}], ",", "0.1"}], "}"}]}], 
         "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameTicksStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}], ",", 
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}]}], "}"}]}], 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"{", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "lwd", "]"}]}], "}"}], ",", 
        RowBox[{"{", 
         RowBox[{"Black", ",", 
          RowBox[{"Thickness", "[", "lwd", "]"}]}], "}"}], ",", "None", ",", 
        "None"}], "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FrameLabel", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{"\"\<Generation\>\"", ",", "\"\<\>\""}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"BaseStyle", "\[Rule]", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
        RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"ImagePadding", "\[Rule]", "Pad"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Epilog", "\[Rule]", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"Text", "[", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<C\>\"", ",", "14", ",", "Bold"}], "]"}], ",", 
          RowBox[{"Scaled", "@", "letpos"}]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Rotate", "[", 
         RowBox[{
          RowBox[{"Text", "[", 
           RowBox[{
            RowBox[{"Style", "[", 
             RowBox[{"\"\<Zygotic sex ratio (fraction male)\>\"", ",", "14"}],
              "]"}], ",", 
            RowBox[{"Scaled", "@", "ylabpos"}]}], "]"}], ",", 
          RowBox[{"90", " ", "Degree"}]}], "]"}]}], "\[IndentingNewLine]", 
       "}"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], 
    "\[IndentingNewLine]", "]"}]}], 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{",", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{"Placed", "[", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"LineLegend", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Red", ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
             RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Directive", "[", 
            RowBox[{"Blue", ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
             RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Darker", "[", "Green", "]"}], ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
             RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"{", "\[IndentingNewLine]", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<\!\(\*
StyleBox[\"R\",
FontSlant->\"Italic\"]\)=0\>\"", ",", "14"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<\!\(\*
StyleBox[\"R\",
FontSlant->\"Italic\"]\)=1/20\>\"", ",", "14"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<\!\(\*
StyleBox[\"R\",
FontSlant->\"Italic\"]\)=1/4\>\"", ",", "14"}], "]"}], ",", 
           "\[IndentingNewLine]", 
           RowBox[{"Style", "[", 
            RowBox[{"\"\<\!\(\*
StyleBox[\"R\",
FontSlant->\"Italic\"]\)=1/2\>\"", ",", "14"}], "]"}]}], 
          "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
         RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"LegendLayout", "\[Rule]", "\"\<Column\>\""}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Spacings", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"0.5", ",", "0.1"}], "}"}]}]}], "\[IndentingNewLine]", 
        "]"}], ",", "\[IndentingNewLine]", 
       RowBox[{"{", 
        RowBox[{"0.75", ",", "0.75"}], "}"}]}], "\[IndentingNewLine]", 
      "]"}]}], "\[IndentingNewLine]", "]"}], "*)"}], ";"}]}], "Input",
 CellChangeTimes->{{3.693990320055317*^9, 3.693990461873455*^9}, {
   3.693990547796727*^9, 3.6939905641321573`*^9}, {3.694007169416566*^9, 
   3.694007270681221*^9}, {3.694013922366458*^9, 3.694013925767144*^9}, {
   3.694014308235403*^9, 3.6940143760870447`*^9}, {3.694014548684801*^9, 
   3.694014554620558*^9}, {3.694014986767647*^9, 3.694015134189968*^9}, {
   3.694015555636918*^9, 3.694015584096736*^9}, {3.6940156469758053`*^9, 
   3.694015651904364*^9}, {3.69401606525834*^9, 3.694016070467067*^9}, {
   3.6940162785206127`*^9, 3.694016298997849*^9}, {3.694016335874995*^9, 
   3.6940163580835743`*^9}, 3.694070249222589*^9, {3.706909838812358*^9, 
   3.7069098974254637`*^9}, {3.7069099911199493`*^9, 3.706909991720399*^9}, {
   3.708129749580936*^9, 3.708129783161046*^9}, {3.708129840764908*^9, 
   3.708129849565523*^9}, {3.708129954233303*^9, 3.7081300261066847`*^9}, {
   3.708130187924245*^9, 3.7081302011267242`*^9}, 3.7081321350003633`*^9, {
   3.708132169175509*^9, 3.7081322619261847`*^9}, {3.708132650281427*^9, 
   3.708132652454523*^9}, {3.7081326975332327`*^9, 3.708132969516369*^9}, {
   3.708133006618072*^9, 3.708133041813191*^9}, {3.7081338561844883`*^9, 
   3.708133898229669*^9}, {3.70813393458564*^9, 3.70813396926287*^9}, {
   3.708134040082569*^9, 3.708134092800867*^9}, {3.708134262540126*^9, 
   3.708134270275729*^9}, {3.708134464390174*^9, 3.708134465836553*^9}, {
   3.708134842094481*^9, 3.708134852278347*^9}, {3.708134942428081*^9, 
   3.708134942530451*^9}, {3.708134993909293*^9, 3.708135020085206*^9}, 
   3.7081353099881887`*^9, {3.708175900714806*^9, 3.708175925229958*^9}, {
   3.708175955319604*^9, 3.70817596035915*^9}, {3.7084542354607363`*^9, 
   3.708454236344782*^9}, {3.71069499453906*^9, 3.710695027340313*^9}, {
   3.71069925534306*^9, 3.710699260441821*^9}},
 ExpressionUUID -> "30d86e60-ce12-4635-b978-d531e1040414"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"yplotmax", "=", "0.61"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yplotmin", "=", "0.39"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"plot4", "=", 
    RowBox[{"(*", 
     RowBox[{"Legended", "["}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{"Show", "[", "\[IndentingNewLine]", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       RowBox[{"tryR3", "=", 
        RowBox[{"tryRs", "[", 
         RowBox[{"[", "1", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"sex", " ", "ratio", " ", "at", " ", "birth"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[IndentingNewLine]", 
             RowBox[{"Total", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{"sexRatioAtBirthZW", "[", 
                RowBox[{
                "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                 "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                 ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                 ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                 ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                 "trypMZAf3", ",", "trypMZaf3", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                 "trypMZAm3", ",", "trypMZam3", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                 "trypMWAf3", ",", "trypMWaf3", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                 "trypMWAm3", ",", "trypMWam3"}], "]"}], 
               "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "1", ",", "tmax3", ",", "tinterval3"}], "}"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"yplotmin", ",", "yplotmax"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}], ",", "Dashed"}], "]"}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tryR3", "=", 
        RowBox[{"tryRs", "[", 
         RowBox[{"[", "2", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"sex", " ", "ratio", " ", "at", " ", "birth"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[IndentingNewLine]", 
             RowBox[{"Total", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{"sexRatioAtBirthZW", "[", 
                RowBox[{
                "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                 "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                 ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                 ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                 ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                 "trypMZAf3", ",", "trypMZaf3", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                 "trypMZAm3", ",", "trypMZam3", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                 "trypMWAf3", ",", "trypMWaf3", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                 "trypMWAm3", ",", "trypMWam3"}], "]"}], 
               "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "1", ",", "tmax3", ",", "tinterval3"}], "}"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"yplotmin", ",", "yplotmax"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Directive", "[", 
            RowBox[{"Red", ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}], ",", "Dashed"}], "]"}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tryR3", "=", 
        RowBox[{"tryRs", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"sex", " ", "ratio", " ", "at", " ", "birth"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[IndentingNewLine]", 
             RowBox[{"Total", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{"sexRatioAtBirthZW", "[", 
                RowBox[{
                "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                 "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                 ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                 ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                 ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                 "trypMZAf3", ",", "trypMZaf3", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                 "trypMZAm3", ",", "trypMZam3", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                 "trypMWAf3", ",", "trypMWaf3", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                 "trypMWAm3", ",", "trypMWam3"}], "]"}], 
               "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "1", ",", "tmax3", ",", "tinterval3"}], "}"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"yplotmin", ",", "yplotmax"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Directive", "[", 
            RowBox[{"Blue", ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}], ",", "Dashed"}], "]"}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"tryR3", "=", 
        RowBox[{"tryRs", "[", 
         RowBox[{"[", "4", "]"}], "]"}]}], ";", "\[IndentingNewLine]", 
       RowBox[{"(*", 
        RowBox[{"sex", " ", "ratio", " ", "at", " ", "birth"}], "*)"}], 
       "\[IndentingNewLine]", 
       RowBox[{"ListPlot", "[", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"t", ",", "\[IndentingNewLine]", 
             RowBox[{"Total", "[", 
              RowBox[{"{", "\[IndentingNewLine]", 
               RowBox[{"sexRatioAtBirthZW", "[", 
                RowBox[{
                "t", ",", "tryFAA3", ",", "tryFAa3", ",", "tryFaa3", ",", 
                 "tryMAA3", ",", "tryMAa3", ",", "tryMaa3", ",", "tryMA3", 
                 ",", "tryMa3", ",", "tryFA3", ",", "tryFa3", ",", "tryr3", 
                 ",", "tryR3", ",", "tryMdA3", ",", "tryFdA3", ",", "tryk3", 
                 ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZAf3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZaf3"}], ",", 
                 "trypMZAf3", ",", "trypMZaf3", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZAm3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpZam3"}], ",", 
                 "trypMZAm3", ",", "trypMZam3", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialWAf3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialWaf3"}], ",", 
                 "trypMWAf3", ",", "trypMWaf3", ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpWAm3"}], ",", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{"1", "-", "pM"}], ")"}], "initialpWam3"}], ",", 
                 "trypMWAm3", ",", "trypMWam3"}], "]"}], 
               "\[IndentingNewLine]", "}"}], "]"}]}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"t", ",", "1", ",", "tmax3", ",", "tinterval3"}], "}"}]}],
           "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"Joined", "\[Rule]", "True"}], ",", "\[IndentingNewLine]", 
         RowBox[{"PlotRange", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"yplotmin", ",", "yplotmax"}], "}"}]}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"PlotStyle", "\[Rule]", 
          RowBox[{"{", 
           RowBox[{"Directive", "[", 
            RowBox[{
             RowBox[{"Darker", "[", "Green", "]"}], ",", 
             RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}], ",", "Dashed"}], "]"}], 
           "}"}]}]}], "\[IndentingNewLine]", "]"}]}], ",", 
      "\[IndentingNewLine]", "\[IndentingNewLine]", 
      RowBox[{"Plot", "[", 
       RowBox[{"0.5", ",", 
        RowBox[{"{", 
         RowBox[{"x", ",", "0", ",", "10000"}], "}"}], ",", 
        RowBox[{"PlotStyle", "\[Rule]", 
         RowBox[{"{", "Dashed", "}"}]}]}], "]"}], ",", "\[IndentingNewLine]", 
      "\[IndentingNewLine]", 
      RowBox[{"Frame", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"True", ",", "True", ",", "False", ",", "False"}], "}"}]}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{"ImageSize", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"xsize", ",", 
         RowBox[{"xsize", " ", "aspectratio"}]}], " ", "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"AspectRatio", "\[Rule]", "aspectratio"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"PlotRangePadding", "\[Rule]", "0"}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"FrameTicks", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"x", ",", "x", ",", "ticksize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{
            "x", ",", "xplotmin", ",", "tmax3", ",", "tplotinterval3"}], 
            "}"}]}], "]"}], ",", 
         RowBox[{"Table", "[", 
          RowBox[{
           RowBox[{"{", 
            RowBox[{"y", ",", "y", ",", "ticksize"}], "}"}], ",", 
           RowBox[{"{", 
            RowBox[{"y", ",", 
             RowBox[{"Round", "[", 
              RowBox[{"yplotmin", ",", "0.1"}], "]"}], ",", 
             RowBox[{"Round", "[", 
              RowBox[{"yplotmax", ",", "0.1"}], "]"}], ",", "0.1"}], "}"}]}], 
          "]"}]}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameTicksStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"FontColor", "\[Rule]", "White"}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}], ",", 
           RowBox[{"Directive", "[", 
            RowBox[{"Black", ",", 
             RowBox[{"Thickness", "[", "lwd", "]"}]}], "]"}]}], "}"}]}], 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "lwd", "]"}]}], "}"}], ",", 
         RowBox[{"{", 
          RowBox[{"Black", ",", 
           RowBox[{"Thickness", "[", "lwd", "]"}]}], "}"}], ",", "None", ",", 
         "None"}], "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"FrameLabel", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{"\"\<Generation\>\"", ",", "\"\<\>\""}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"BaseStyle", "\[Rule]", 
       RowBox[{"{", 
        RowBox[{
         RowBox[{"FontFamily", "\[Rule]", "\"\<Helvetica\>\""}], ",", 
         RowBox[{"FontSize", "\[Rule]", "14"}]}], "}"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{"ImagePadding", "\[Rule]", "Pad"}], ",", "\[IndentingNewLine]", 
      
      RowBox[{"Epilog", "\[Rule]", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"Text", "[", 
          RowBox[{
           RowBox[{"Style", "[", 
            RowBox[{"\"\<D\>\"", ",", "14", ",", "Bold"}], "]"}], ",", 
           RowBox[{"Scaled", "@", "letpos"}]}], "]"}], ",", 
         "\[IndentingNewLine]", 
         RowBox[{"Rotate", "[", 
          RowBox[{
           RowBox[{"Text", "[", 
            RowBox[{
             RowBox[{"Style", "[", 
              RowBox[{"\"\<\>\"", ",", "14"}], "]"}], ",", 
             RowBox[{"Scaled", "@", "ylabpos"}]}], "]"}], ",", 
           RowBox[{"90", " ", "Degree"}]}], "]"}]}], "\[IndentingNewLine]", 
        "}"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{"PlotRangeClipping", "\[Rule]", "False"}]}], 
     "\[IndentingNewLine]", "]"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"Placed", "[", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"LineLegend", "[", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Directive", "[", 
           RowBox[{"Black", ",", 
            RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Red", ",", 
            RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
            RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}], ",", 
          "\[IndentingNewLine]", 
          RowBox[{"Directive", "[", 
           RowBox[{"Blue", ",", 
            RowBox[{"Opacity", "[", "0.75", "]"}], ",", 
            RowBox[{"Thickness", "[", "0.2", "]"}]}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"{", "\[IndentingNewLine]", 
         RowBox[{
          RowBox[{"Style", "[", 
           RowBox[{"\"\<neo-Y\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)in haploids from females\>\"", ",", "14"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<W\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)in haploids from females\>\"", ",", "14"}], "]"}], 
          ",", "\[IndentingNewLine]", 
          RowBox[{"Style", "[", 
           RowBox[{"\"\<W\!\(\*
StyleBox[\" \",
FontSlant->\"Italic\"]\)in haploids from males\>\"", ",", "14"}], "]"}]}], 
         "\[IndentingNewLine]", "}"}], ",", "\[IndentingNewLine]", 
        RowBox[{"LegendFunction", "\[Rule]", "\"\<Frame\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"LegendLayout", "\[Rule]", "\"\<Column\>\""}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"Spacings", "\[Rule]", 
         RowBox[{"{", 
          RowBox[{"0.5", ",", "0.1"}], "}"}]}]}], "\[IndentingNewLine]", 
       "]"}], ",", "\[IndentingNewLine]", 
      RowBox[{"{", 
       RowBox[{"0.65", ",", "0.185"}], "}"}]}], "\[IndentingNewLine]", "]"}], 
    "\[IndentingNewLine]", "]"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.693990320055317*^9, 3.693990461873455*^9}, {
   3.693990547796727*^9, 3.6939905641321573`*^9}, {3.694007169416566*^9, 
   3.694007270681221*^9}, {3.694013922366458*^9, 3.694013925767144*^9}, {
   3.694014308235403*^9, 3.6940143760870447`*^9}, {3.694014548684801*^9, 
   3.694014554620558*^9}, {3.694014986767647*^9, 3.694015134189968*^9}, {
   3.694015555636918*^9, 3.694015584096736*^9}, {3.6940156469758053`*^9, 
   3.694015651904364*^9}, {3.69401606525834*^9, 3.694016070467067*^9}, {
   3.6940162785206127`*^9, 3.694016298997849*^9}, {3.694016335874995*^9, 
   3.6940163580835743`*^9}, 3.694070249222589*^9, {3.706909838812358*^9, 
   3.7069098974254637`*^9}, {3.7069099911199493`*^9, 3.706909991720399*^9}, {
   3.708129749580936*^9, 3.708129783161046*^9}, {3.708129840764908*^9, 
   3.708129849565523*^9}, {3.708129954233303*^9, 3.7081300261066847`*^9}, {
   3.708130187924245*^9, 3.7081302011267242`*^9}, 3.7081321350003633`*^9, {
   3.708132169175509*^9, 3.7081322619261847`*^9}, {3.708132650281427*^9, 
   3.708132652454523*^9}, {3.7081326975332327`*^9, 3.708132969516369*^9}, {
   3.708133006618072*^9, 3.708133041813191*^9}, {3.7081338561844883`*^9, 
   3.708133898229669*^9}, {3.70813393458564*^9, 3.70813396926287*^9}, {
   3.708134040082569*^9, 3.708134101223053*^9}, 3.708134145461051*^9, {
   3.708134201628942*^9, 3.708134245643237*^9}, {3.708134575130454*^9, 
   3.708134585020857*^9}, {3.708134857746319*^9, 3.708134858797127*^9}, {
   3.70813497346012*^9, 3.708135016669989*^9}, {3.7081352629377728`*^9, 
   3.7081353006211443`*^9}, {3.708454326755204*^9, 3.7084543323823957`*^9}, {
   3.708454631777277*^9, 3.708454632645689*^9}, {3.710695010205482*^9, 
   3.710695016745462*^9}},
 ExpressionUUID -> "ea8bb666-4ddb-418e-b79a-565c11fa1688"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"GraphicsGrid", "[", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"plot1", ",", "plot2"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"plot3", ",", "plot4"}], "}"}]}], "}"}], ",", 
    "\[IndentingNewLine]", 
    RowBox[{"Spacings", "\[Rule]", 
     RowBox[{"-", "40"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"Epilog", "\[Rule]", 
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{"(*", 
       RowBox[{"Text", "[", 
        RowBox[{
         RowBox[{"Style", "[", 
          RowBox[{"\"\<\!\(\*
StyleBox[\"r\",
FontSlant->\"Italic\"]\)=0.5, \!\(\*
StyleBox[\"R\",
FontSlant->\"Italic\"]\)=0.05\>\"", ",", "20"}], "]"}], ",", 
         RowBox[{"Scaled", "@", 
          RowBox[{"{", 
           RowBox[{"0.25", ",", "1.45"}], "}"}]}]}], "]"}], "*)"}], 
      "\[IndentingNewLine]", "}"}]}], ",", "\[IndentingNewLine]", 
    RowBox[{"ImageSize", "\[Rule]", "700"}]}], "\[IndentingNewLine]", "]"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Export", "[", 
   RowBox[{
    RowBox[{"plotdir", "<>", "\"\<Combination_Turnover_Ratio.pdf\>\""}], ",", 
    "%"}], "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.7081341066939983`*^9, 3.708134108003768*^9}, {
   3.708685420360036*^9, 3.708685422074099*^9}, 3.708897232065652*^9},
 ExpressionUUID -> "29c6a10a-650a-409b-ba46-584d651c46dc"],

Cell[BoxData[
 GraphicsBox[{{}, {{InsetBox[
      FormBox[
       TagBox[
        FormBox[
         GraphicsBox[{{{{}, 
             {GrayLevel[0], Thickness[0.006], LineBox[CompressedData["
1:eJxF0H9Qk3UcB/Cx/CNAGl3+oVwk3hGmnrouTziv7E2CRJ66ZXKAFsPGREFY
5PhhIGMw9gNYSEIKB7e68I6QwDPPHy16TCdBEaBdUyYw8EQDQgLRsbGRxff7
fZ6755573ef7+b7v/aw6kPl+ilAgEKQ8e//70mf9tpfHRzYHvb2oUJwNq8oN
8g0n3oT8j288+PNQLPFWRI65nIpXZcRRyD+vWhNwUUUci4yoCydypRXEu5CS
XBDmnfh60WophOuvCXf/fIHMP0B3S9JfA6XXyTwOU9bINIl/D5knQC3ybekc
vEXm+5BRdenEZl8bmX8Ea2jcyentdxYNGcTBqeH+I/3kfDIcDcNeH9HdRXMH
IHv90hLuEbFADuNOuXJT7QDZT8HoXMI9YfAg2VcgXtZo2aEh5g5C9bAzLaaP
WHAIAZkRiVtEQ2T/MCTfr+xaCmJ1Giynvor+TkHMpWN/V6E8QUssyIA9qOe9
a/V0PxPLmnoq3zpHrcTstG/X7xyxQ4mOmYPZUd30/k/wg+5MNGzEIVlo2+Jd
iByieVkwv/aST+t9YtmnqA/zn7CN0fyjqDIuF3kmic1HcX0i+FfpNM1XoTqx
8c2FxzRfBcU64Z6wpzQ/G+M6R/awk+bnoFmx9U60i+bnYM1MZ4HcTfNzUf9N
hGjHPM3PQ8XuYf0SD83PQ8cfqe2nqXEM7bXpv7zopfnHoNWb92VRqz9D8cT5
FzjqkHxw2iNVXmouH37LLIPiBZpfgFuq8bgEasFx7N3YPppHbT6OK7N9K05S
oxA7z2ZsaKJ2FKIu+UzoFTZXw5VY2NVBXamGvdNivcnOq6Gu+LHOTi0uQtM/
vRdHqNVFKNLvUj6k7i3C9pBWv7+pQzRIa73dPkWt1GCFxHp5hprTwM/YuPIJ
dWAx6uxfBjhZ32LkJPnVzVG3FSM93tbvYv1LsDp07V03taQESVnhzfPsf5TA
XdAn9VBPlaBWMmRjhhZvXLZs87L+Wtg1ulpmhxaj1R86mMWlODVrWr7A+pei
Yc4azdxbip+aVx9mDtHhxs0jOmalDs8/cDcwczr0TD46xxyoR4lIfJVZpock
V9XN3KbHb2v32pgFBsiXxgwxSwxYVdN8n9lsQERq7xjzlAE1zplJZhgRZ3h3
mrnSiOfKnjxmdhjxre6Vp8ziMjhb+p18/zKsE8HF9y/DQEOSm+9fjtuCmHm+
fzm4DT4evn85pJ4a3oEVaNGJvHz/CmRrlbzbnrmynbfABOl+D2+JCZX3Ni7w
/U24WhbPe8qE6nfyeONzxFZ/8b//BZL0WTo=
               "]]}, {}}, {{}, 
             {RGBColor[1, 0, 0], Thickness[0.006], Opacity[0.75], 
              LineBox[CompressedData["
1:eJw10AlQlGUYB/CVYywDgiYHQtJFIS2BQI5qUPibQkOTtVxNgAMbyI2wXHLI
sSzX7rIsSwQDWc5GYA5GMhRMgeLiMAgZGyiX4MoqASZkSyJghGTD+3wz33zz
m+d95v/+P+vwJL9IPQ6HE/ns/f9Lj/0Rq/l7bpaem7LBgrbRxe8DN2YXJAR2
OukivJg9IKuJfsWpL5D5KBpDx9sOXIhi9sGSsjDGvSmD+UOIUrxe5WWKNy30
RX1ZpSzrYi2bByB6bSxi9PK3bP4xqse9Jq6Zt7F5EFy1aV9eHFCxeQhcIpYW
qnqusXko0qJk06d46k2DD/XyfNjT+SF2/lP0KrsyJm2HN60Kx6r9u3a7FkbY
/gnw9lpVHAgaY/uRmAk7tvOmaJztR2FObWu1PesW24+G3M9aLn1vgu3HomEs
yLlymRlx2PZN4nFf2STbj4fGWD87wfg220/AxpjIJjmXmZOIt9NfCts3xYwk
dOQ90fS7aJgF2H69344rZNYK0Oa+cqT+KrMwGUMTN41K1pm5KdhxK9dE7XSH
5aWg2HWu3Z/PzE+Fns28228SZk4aFIaSOs33zMo0SM0dywwHmZEOkYWZTeef
zNp0SG6HL4Y/N8XyT8H0h+rYAC4zNwM5KueFSVdmVQZ4Oquogz7M/Ezsd//r
u5ZgZk4WOvZZKBPimJVZ8KscsjybyYxsRA5PXjlZzKzNRnLtQuOGgvJP44zV
8QepZyg/B4djhQ5zDZSfg0BzH/3UZsrPRdaOLd4ObZSfh/D1zwT2lyg/D90z
HlOiq5Sfj/afgo09+yg/H97vJ/4iGKC5EPfWe2JsbzArhDAx4M/GjNJ5IRYv
mZh5TzA7FqBL43+uV0P3L4BldkPSIy3zYAGSVjNDhqepjwjn4muqBLPMAhHu
2txXqO9TPxFGDF3tlx4wmxZC0bPYOrtAfQvxRlXMfNND5pZCSJ2j93vpqH8R
fn/zbOjPi8y8InRJR81eeET/owgFX+zMObTErCtCa/+2Uv/H1L8Y4SV7Rj9a
pv7FmGytGXBZof7F6A1ArcEq9S+B3hYr+26ysAS1MoeAhCfUvwTNNx43bf2H
+pfi+p2485+TBaWYTv9a+fIa9S9FtNqkT0w2FeOkh9DtbzJfjEOX+//w/Zf6
ixHj5dx3nsyRgJ9woX6FzJPgq6keN8916i9B9Uyho5Csk0A/l2PXSYYU67jb
riMrpOhSt/paP6X+Uiwb7Uo+RnYsgzJsa346WVgGrrhoso48WAavZrWmg8yV
obP/xZFxskCGT8S7n18iq2SwOOHZabRB/cvx6491r+0h88uR9vpD4VvklnIc
NDJY8yFz5Ogv290dTObJEb/39FosWSkH57BUnUHWyWF5JTGkiIwKDFa9o6p4
5v8AcaEkIQ==
               "]]}, {}}, {{}, 
             {RGBColor[0, 0, 1], Thickness[0.006], Opacity[0.75], 
              LineBox[CompressedData["
1:eJw1zwlME2YYBuCOY+AOgwyZImwV0OkIoAsglglvReUwQnHIwFFWGZeclfta
LTelUBlhsAHj3iCiWQUEqaIdGO2cww4UOaQqGpFLAc+Bc3Ppx5/8+fPk/d98
+dYHxuwP1mAwGMFv7v/v8rF0Np4etzNyUsscFSiZmBDZkG3wocOzflWSE9kR
39/+bP6Svit5FzxlFvcNQ/eT3XCq0vL4gXX+ZA/8oXc3bnd0sNpCLzw96f6L
7z4+5d5g5lgphjuSKffB4K6esPL6TMr90PF0e9CJcTHlX+GMzpPSmrpSygMg
Z88d8nq/Wm3wcFlk8cgm6mf6fwgK0T/KB7KTassD4S7dc/ujZ23UD4KmPOG8
7UAX9YPxSVd0c+NqOfVDcGCpSnTDq5f6oaieiTc9k3iJ+ocxlA/H8MO/Uz8c
Kxd2xvkbX6V+BI4nfS3dWNhH/UgEHHlV0stVUj8a7n0TB418/6J+DEa0Wqaj
7fvJfKwIc1vxrsaA2nf48DSSbprtJAuPwFSw1rzd/7razFgwrrH9axbI8lg0
sSu/K0+7oTYvDvpyqZD1N5kRDy8f59QHkYNq18bDjqsYuHiTjASgzGa4n3WT
5ieg9J7h7skysjARjtm+YT0zZGYS5M9nbP79fIjmJ6HpY2OuRT6Zlwxdxco2
eR+ZkYKtYtvZzauGaX4KzifHzl70JCMVca/XN9wvIN9JxROBV2V/D1mYhjK2
xEP5gsxMx6JWlf2aT0dofjq2J073qvzIvG/RUHVa74s8MkOATdmG1TWt5FoB
TIZcR6ZGyTgKyWuL6i81R2n+UdS0JpdrbyZDiLus8MZV+8jFQqh+NTMri1n+
L4R2b6tdSzF5Swby5x01Q6VkYQaa3zk1PtZHVmYgxfVhiekMmZkJ7+TggD26
t9TmZyLwnjX8zMjyTNi5/KgZvoOslwWFZhQv14fMywKn/S2Ds9FkaRbGHpe8
+CCXzMiGzl6WQVUVmZMNTkh/O7eVXJsNWbxWYuBl8lw2wlSd3m2jZORgztrg
rO9jcnEOAqydCg9qjNH+OWjJWbKSG5C35KJZ4VJevJEszEVXx1rP/m1kZS7C
dT0EYlcyMw9ZLuPzv/mS+XnwKRSbpoWR5XnwviJjnUsi6+WjPNTEuCCXzMvH
e5ZNQZOlZGk+Hm7YGqeqJzNEcDvXGRElJXNEaGCzHSq6ybUi+BskVIZdIc+J
kHF6avWtQTIKIONu03k5Ti4ugGThQt2FR8v7F0Dc6D1nu7i8vxjJzyuGuNoq
2l+MxXh3E5YeWSmG1ZIT708jMrMQ7YwIc6MNZH4hmtb8cM3Umix/k6evOzFp
T9YrQqBDwBR/J5lXBNE3nHrZXrK0CBacnusKbzJDgu63myJ/4pI5EhRGscEK
IddKYP1yh35dNHlOgqvOspKBRDKOofuVA29AoHL6D+pWBkI=
               
               "]]}, {}}, {{}, 
             {RGBColor[0, 
               NCache[
                Rational[2, 3], 0.6666666666666666], 0], Thickness[0.006], 
              Opacity[0.75], LineBox[CompressedData["
1:eJw1zwsw2wccB/CUjQ7bWZllruvSsr6Yx6Hsqnx7FNFOwzyupIR6jFaoeoQW
IUHEK449tFtlPVVpPaKlhrLsVlbXtaJoqwzrOawMY2qnd7rt8pO7/+U+9/1/
/9/77YxI8IvSYjAYUf89//9v/j5x2z73/ICpq0bmsNLevyrotSPbQ93bpiUa
dia7YOz1VT0T7SNkd9i1x0a/uORDZsOoq7eM7xlI9sE3YS+fbLPjaSz0xZXM
ZsWrvBjK/VEt/apPV/8s5YF4GK6/plMtoPwEQpynBXatOZSHoCTcYWyXbyHl
oWg1/83NcrlcY/Cg99fA6rY9VfR+OLqLOE7d3O81VkVgQffpWx6ia9SPRLaX
+8Rr0ybqR0HBDwp+U7eF+tEYPhBx7I5+O/VjMLHIjpiO7qZ+LG6dWl6tXPiJ
+nFY4vY7l317l/qnsaOSI2nc9wv1z2BjPdrJSdpHfT76PU+o7NvvUz8BJcks
m+jbD8iJaKjujOSK+zWeTMTohNu4qEJN3z8LedLhuhjfAY1ZSVCy0410Nsiq
JDAZKWmnLj3SmHcO8/NblT4Wg7SfjAblUF1oE1meDCMHb7/VvUO0n4Ia/44Z
9yryZAoWqw+OB2wZpv1UMI8fUhhEkFlpqDPmrFndIavSkJE87vmF4WPaFyB4
f/HIZ2FkRjo849c3whVkeToW3B7MmyySkQED83TjAZsntJ+B0c6ND//gk4Xn
cd24TNagILMuoO1el2Pk72TVBQzZtnKOmjyl/UzczF+UXPQiM7IgDDz+WCQg
y7MwmvmOtX0tGdkomRraPTRAnszG7MdBKZJXm7kQOobMuCSzEY1lQjD/9OAo
2eRJIU5a2Pac5JNtcjDb4KddWU4W5sD/2A9mcbfI6hx8+T4raHWQzMoFa1yX
yV4hJ+aC26YITHv3Gd2XCzOz7mqZFdlQhI2VdpcabzJPBI/8XVxVFFkpgmnj
eeZyNpkhxlSqa82RKjJHDO/vXAN6m8lyMbrf/rk9q4+8JMYb9rUKwSQZeeBb
dwZ0vSTL8mCuuhwQYDBK9+choMu6xWsn2SYfHTPq9csOZGE+/v7164NhbLI6
H3yDAlMZl8wqQGrBwrBjAjmxABa9W324OWRVATh6L/S1K8iGEqhNBz1ta8g8
Capb1xbmWshKCbb82Fvn2ENmFGL5hmqUOUzmFMLTZaa5YoosL4Q8Ub29foW8
VIh4btRIlNYY3S/F0RX/c3cNyTIpVssOe93fQZ6UIv5akzTTkmxTBMGhTvfx
T8nCIiRbVgUveZDVReh+OFt8+3Myqxh+5s8y7HjkxGJw9lrWxJ4hq4rxT6PO
6RAB2bAE4kc339MXk3klqK23V2eUkZUl+GDkXkP9RTKjFMtaXtevXCVzSrFH
mnQjVEmWlyLlo925zzvIS6Vw08ues+7ZvL8M+2qny736x1z/BVVlBIo=
               
               "]]}, {}}, {{}, {}, 
             {Hue[0.67, 0.6, 0.6], Dashing[{Small, Small}], 
              LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQvUzf5sH1/Vr2DGDwwP5Z5+cZup0RDjD+I+5vb7Q7
M+D8iaUpfmETK+H8N+FmfNb/muB8vlfXls4R6YTzOwX0bgqv74fzdfxOJce+
mQTn29+7scLaeRqcf2mF6bGmrplwPr+a1MHEmXPg/Iq3Nzu9X82H849uFpiR
1rgQYX9f9PXbrIvh/FzeKbVhq5fA+YppE4TmmiyD818nV/G9vLcczv9a112W
2bgSzg8pTji7lX01nH+SR7mbff0aOH9y/UpzVat1cH7xdFlvj2fr4XyvtJin
/kc3wPktb7vnJHZuhPM93Y3Yv8VugvN39lplFqhsRtiXFMbI+hzBT+F66SOz
awucv3Le3X7J+q1wfiWrZ9vMkG1w/stfxzcZq22H85nvrri2+SWCv3Iiw7pt
e3fA+T+NdtXMb96J0J/U3rjIdRfC/tTTlhoSu+H8zpDCl5PvIPiWYn0+TRv3
wPlTjvAsD6vYC+f3M843d7XeB+eLCq6o3sa3H8535RXeznsFwWfI+3Xpc8gB
OH+dTOnTt3sR/I0HF3y+JX8Qzv91vj2aswvBn3FFfr/WWwS/bcFB20i/Q3D+
rqtyYie3I/jOjLqvtKUOw/nLWvd9FA1E8Dm4An7+b0fwAUB+A9k=
               "]]}}}, 
           InsetBox[
            
            TemplateBox[{
             StyleBox[
              "\"\\!\\(\\*\\nStyleBox[\\\"R\\\",\\nFontSlant->\\\"Italic\\\"]\
\\)=0\"", StripOnInput -> False, FontSize -> 14],StyleBox[
              "\"\\!\\(\\*\\nStyleBox[\\\"R\\\",\\nFontSlant->\\\"Italic\\\"]\
\\)=1/20\"", StripOnInput -> False, FontSize -> 14],StyleBox[
              "\"\\!\\(\\*\\nStyleBox[\\\"R\\\",\\nFontSlant->\\\"Italic\\\"]\
\\)=1/4\"", StripOnInput -> False, FontSize -> 14],StyleBox[
              "\"\\!\\(\\*\\nStyleBox[\\\"R\\\",\\nFontSlant->\\\"Italic\\\"]\
\\)=1/2\"", StripOnInput -> False, FontSize -> 14]},
             "LineLegend",
             DisplayFunction->(FrameBox[
               StyleBox[
                StyleBox[
                 PaneBox[
                  TagBox[
                   GridBox[{{
                    TagBox[
                    GridBox[{{
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[{
                    Opacity[0.3], 
                    GrayLevel[0]}], 
                    GrayLevel[0], 
                    Thickness[0.2]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[{
                    Opacity[0.3], 
                    GrayLevel[0]}], 
                    GrayLevel[0], 
                    Thickness[0.2]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> 1, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #}, {
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[{
                    Opacity[0.3], 
                    GrayLevel[0]}], 
                    RGBColor[1, 0, 0], 
                    Opacity[0.75], 
                    Thickness[0.2]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[{
                    Opacity[0.3], 
                    GrayLevel[0]}], 
                    RGBColor[1, 0, 0], 
                    Opacity[0.75], 
                    Thickness[0.2]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> 1, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #2}, {
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[{
                    Opacity[0.3], 
                    GrayLevel[0]}], 
                    RGBColor[0, 0, 1], 
                    Opacity[0.75], 
                    Thickness[0.2]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[{
                    Opacity[0.3], 
                    GrayLevel[0]}], 
                    RGBColor[0, 0, 1], 
                    Opacity[0.75], 
                    Thickness[0.2]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> 1, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #3}, {
                    GraphicsBox[{{
                    Directive[
                    EdgeForm[{
                    Opacity[0.3], 
                    GrayLevel[0]}], 
                    RGBColor[0, 
                    NCache[
                    Rational[2, 3], 0.6666666666666666], 0], 
                    Opacity[0.75], 
                    Thickness[0.2]], {
                    LineBox[{{0, 10}, {20, 10}}]}}, {
                    Directive[
                    EdgeForm[{
                    Opacity[0.3], 
                    GrayLevel[0]}], 
                    RGBColor[0, 
                    NCache[
                    Rational[2, 3], 0.6666666666666666], 0], 
                    Opacity[0.75], 
                    Thickness[0.2]], {}}}, AspectRatio -> Full, 
                    ImageSize -> {20, 10}, PlotRangePadding -> None, 
                    ImagePadding -> 1, 
                    BaselinePosition -> (Scaled[0.1] -> Baseline)], #4}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {Center, Left}, "Rows" -> {{Baseline}}}, 
                    AutoDelete -> False, 
                    GridBoxDividers -> {
                    "Columns" -> {{False}}, "Rows" -> {{False}}}, 
                    GridBoxItemSize -> {
                    "Columns" -> {{All}}, "Rows" -> {{All}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0.1}}}], "Grid"]}}, 
                    GridBoxAlignment -> {
                    "Columns" -> {{Left}}, "Rows" -> {{Top}}}, AutoDelete -> 
                    False, GridBoxItemSize -> {
                    "Columns" -> {{Automatic}}, "Rows" -> {{Automatic}}}, 
                    GridBoxSpacings -> {
                    "Columns" -> {{0.5}}, "Rows" -> {{0}}}], "Grid"], 
                  Alignment -> Left, AppearanceElements -> None, 
                  ImageSizeAction -> "ResizeToFit"], LineIndent -> 0, 
                 StripOnInput -> False], {FontFamily -> "Times"}, 
                StripOnInput -> False], Background -> Automatic, 
               RoundingRadius -> 5, ContentPadding -> True, 
               FrameMargins -> {{5, 5}, {5, 5}}, FrameStyle -> 
               Thickness[0.01], StripOnInput -> False]& ),
             Editable->True,
             InterpretationFunction:>(RowBox[{"LineLegend", "[", 
                RowBox[{
                  RowBox[{"{", 
                    RowBox[{
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"GrayLevel", "[", "0", "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.2`", "]"}]}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"1", ",", "0", ",", "0"}], "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.75`", "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.2`", "]"}]}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", "0", ",", "1"}], "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.75`", "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.2`", "]"}]}], "]"}], ",", 
                    RowBox[{"Directive", "[", 
                    RowBox[{
                    RowBox[{"RGBColor", "[", 
                    RowBox[{"0", ",", 
                    FractionBox["2", "3"], ",", "0"}], "]"}], ",", 
                    RowBox[{"Opacity", "[", "0.75`", "]"}], ",", 
                    RowBox[{"Thickness", "[", "0.2`", "]"}]}], "]"}]}], "}"}],
                   ",", 
                  RowBox[{"{", 
                    RowBox[{#, ",", #2, ",", #3, ",", #4}], "}"}], ",", 
                  RowBox[{"LegendFunction", "\[Rule]", "\"Frame\""}], ",", 
                  RowBox[{"LegendLayout", "\[Rule]", "\"Column\""}], ",", 
                  RowBox[{"Spacings", "\[Rule]", 
                    RowBox[{"{", 
                    RowBox[{"0.5`", ",", "0.1`"}], "}"}]}]}], "]"}]& )], 
            Scaled[{0.8, 0.75}], ImageScaled[{0.5, 0.5}],
            BaseStyle->{FontSize -> Larger},
            FormatType->StandardForm]},
          AspectRatio->NCache[2^Rational[-1, 2], 0.7071067811865475],
          Axes->True,
          AxesLabel->{None, None},
          AxesOrigin->{0, 0},
          BaseStyle->{FontFamily -> "Helvetica", FontSize -> 14},
          Epilog->{
            InsetBox[
             FormBox[
              StyleBox["\"A\"", 14, Bold, StripOnInput -> False], 
              TraditionalForm], 
             Scaled[{0.05, 0.93}]], 
            GeometricTransformationBox[
             InsetBox[
              FormBox[
               StyleBox[
               "\"neo-W frequency in females\"", 14, StripOnInput -> False], 
               TraditionalForm], 
              Scaled[{-0.15, 0.5}]], {{{0, -1}, {1, 0}}, Center}]},
          Frame->{True, True, False, False},
          FrameLabel->{
            FormBox["\"\"", TraditionalForm], 
            FormBox["\"\"", TraditionalForm]},
          FrameStyle->{{
             GrayLevel[0], 
             Thickness[0.006]}, {
             GrayLevel[0], 
             Thickness[0.006]}, None, None},
          FrameTicks->{{{0, 
              FormBox["0", TraditionalForm], {0, 0.01}}, {200, 
              FormBox["200", TraditionalForm], {0, 0.01}}, {400, 
              FormBox["400", TraditionalForm], {0, 0.01}}, {600, 
              FormBox["600", TraditionalForm], {0, 0.01}}, {800, 
              FormBox["800", TraditionalForm], {0, 0.01}}, {1000, 
              FormBox["1000", TraditionalForm], {0, 0.01}}}, {{0., 
              FormBox["0.`", TraditionalForm], {0, 0.01}}, {0.5, 
              FormBox["0.5`", TraditionalForm], {0, 0.01}}, {1., 
              FormBox["1.`", TraditionalForm], {0, 0.01}}}},
          FrameTicksStyle->{{
             Directive[
              GrayLevel[0], 
              Thickness[0.006]], 
             Directive[
              GrayLevel[0], 
              Thickness[0.006]]}, {
             Directive[FontColor -> GrayLevel[1]], 
             Directive[
              GrayLevel[0], 
              Thickness[0.006]]}},
          ImagePadding->{{50, 10}, {50, 10}},
          
          ImageSize->
           NCache[{360, 180 2^Rational[1, 2]}, {360, 254.55844122715712`}],
          Method->{},
          PlotRange->{{0, 1000.}, {0, 1}},
          PlotRangeClipping->False,
          PlotRangePadding->0],
         TraditionalForm],
        InterpretTemplate[Legended[
          Graphics[{{{}, {
              Hue[0.67, 0.6, 0.6], 
              Directive[
               GrayLevel[0], 
               Thickness[0.006]], 
              Line[CompressedData["
1:eJxF0H9Qk3UcB/Cx/CNAGl3+oVwk3hGmnrouTziv7E2CRJ66ZXKAFsPGREFY
5PhhIGMw9gNYSEIKB7e68I6QwDPPHy16TCdBEaBdUyYw8EQDQgLRsbGRxff7
fZ6755573ef7+b7v/aw6kPl+ilAgEKQ8e//70mf9tpfHRzYHvb2oUJwNq8oN
8g0n3oT8j288+PNQLPFWRI65nIpXZcRRyD+vWhNwUUUci4yoCydypRXEu5CS
XBDmnfh60WophOuvCXf/fIHMP0B3S9JfA6XXyTwOU9bINIl/D5knQC3ybekc
vEXm+5BRdenEZl8bmX8Ea2jcyentdxYNGcTBqeH+I/3kfDIcDcNeH9HdRXMH
IHv90hLuEbFADuNOuXJT7QDZT8HoXMI9YfAg2VcgXtZo2aEh5g5C9bAzLaaP
WHAIAZkRiVtEQ2T/MCTfr+xaCmJ1Giynvor+TkHMpWN/V6E8QUssyIA9qOe9
a/V0PxPLmnoq3zpHrcTstG/X7xyxQ4mOmYPZUd30/k/wg+5MNGzEIVlo2+Jd
iByieVkwv/aST+t9YtmnqA/zn7CN0fyjqDIuF3kmic1HcX0i+FfpNM1XoTqx
8c2FxzRfBcU64Z6wpzQ/G+M6R/awk+bnoFmx9U60i+bnYM1MZ4HcTfNzUf9N
hGjHPM3PQ8XuYf0SD83PQ8cfqe2nqXEM7bXpv7zopfnHoNWb92VRqz9D8cT5
FzjqkHxw2iNVXmouH37LLIPiBZpfgFuq8bgEasFx7N3YPppHbT6OK7N9K05S
oxA7z2ZsaKJ2FKIu+UzoFTZXw5VY2NVBXamGvdNivcnOq6Gu+LHOTi0uQtM/
vRdHqNVFKNLvUj6k7i3C9pBWv7+pQzRIa73dPkWt1GCFxHp5hprTwM/YuPIJ
dWAx6uxfBjhZ32LkJPnVzVG3FSM93tbvYv1LsDp07V03taQESVnhzfPsf5TA
XdAn9VBPlaBWMmRjhhZvXLZs87L+Wtg1ulpmhxaj1R86mMWlODVrWr7A+pei
Yc4azdxbip+aVx9mDtHhxs0jOmalDs8/cDcwczr0TD46xxyoR4lIfJVZpock
V9XN3KbHb2v32pgFBsiXxgwxSwxYVdN8n9lsQERq7xjzlAE1zplJZhgRZ3h3
mrnSiOfKnjxmdhjxre6Vp8ziMjhb+p18/zKsE8HF9y/DQEOSm+9fjtuCmHm+
fzm4DT4evn85pJ4a3oEVaNGJvHz/CmRrlbzbnrmynbfABOl+D2+JCZX3Ni7w
/U24WhbPe8qE6nfyeONzxFZ/8b//BZL0WTo=
               "]]}, {}}, {{}, {
              Hue[0.67, 0.6, 0.6], 
              Directive[
               RGBColor[1, 0, 0], 
               Opacity[0.75], 
               Thickness[0.006]], 
              Line[CompressedData["
1:eJw10AlQlGUYB/CVYywDgiYHQtJFIS2BQI5qUPibQkOTtVxNgAMbyI2wXHLI
sSzX7rIsSwQDWc5GYA5GMhRMgeLiMAgZGyiX4MoqASZkSyJghGTD+3wz33zz
m+d95v/+P+vwJL9IPQ6HE/ns/f9Lj/0Rq/l7bpaem7LBgrbRxe8DN2YXJAR2
OukivJg9IKuJfsWpL5D5KBpDx9sOXIhi9sGSsjDGvSmD+UOIUrxe5WWKNy30
RX1ZpSzrYi2bByB6bSxi9PK3bP4xqse9Jq6Zt7F5EFy1aV9eHFCxeQhcIpYW
qnqusXko0qJk06d46k2DD/XyfNjT+SF2/lP0KrsyJm2HN60Kx6r9u3a7FkbY
/gnw9lpVHAgaY/uRmAk7tvOmaJztR2FObWu1PesW24+G3M9aLn1vgu3HomEs
yLlymRlx2PZN4nFf2STbj4fGWD87wfg220/AxpjIJjmXmZOIt9NfCts3xYwk
dOQ90fS7aJgF2H69344rZNYK0Oa+cqT+KrMwGUMTN41K1pm5KdhxK9dE7XSH
5aWg2HWu3Z/PzE+Fns28228SZk4aFIaSOs33zMo0SM0dywwHmZEOkYWZTeef
zNp0SG6HL4Y/N8XyT8H0h+rYAC4zNwM5KueFSVdmVQZ4Oquogz7M/Ezsd//r
u5ZgZk4WOvZZKBPimJVZ8KscsjybyYxsRA5PXjlZzKzNRnLtQuOGgvJP44zV
8QepZyg/B4djhQ5zDZSfg0BzH/3UZsrPRdaOLd4ObZSfh/D1zwT2lyg/D90z
HlOiq5Sfj/afgo09+yg/H97vJ/4iGKC5EPfWe2JsbzArhDAx4M/GjNJ5IRYv
mZh5TzA7FqBL43+uV0P3L4BldkPSIy3zYAGSVjNDhqepjwjn4muqBLPMAhHu
2txXqO9TPxFGDF3tlx4wmxZC0bPYOrtAfQvxRlXMfNND5pZCSJ2j93vpqH8R
fn/zbOjPi8y8InRJR81eeET/owgFX+zMObTErCtCa/+2Uv/H1L8Y4SV7Rj9a
pv7FmGytGXBZof7F6A1ArcEq9S+B3hYr+26ysAS1MoeAhCfUvwTNNx43bf2H
+pfi+p2485+TBaWYTv9a+fIa9S9FtNqkT0w2FeOkh9DtbzJfjEOX+//w/Zf6
ixHj5dx3nsyRgJ9woX6FzJPgq6keN8916i9B9Uyho5Csk0A/l2PXSYYU67jb
riMrpOhSt/paP6X+Uiwb7Uo+RnYsgzJsa346WVgGrrhoso48WAavZrWmg8yV
obP/xZFxskCGT8S7n18iq2SwOOHZabRB/cvx6491r+0h88uR9vpD4VvklnIc
NDJY8yFz5Ogv290dTObJEb/39FosWSkH57BUnUHWyWF5JTGkiIwKDFa9o6p4
5v8AcaEkIQ==
               "]]}, {}}, {{}, {
              Hue[0.67, 0.6, 0.6], 
              Directive[
               RGBColor[0, 0, 1], 
               Opacity[0.75], 
               Thickness[0.006]], 
              Line[CompressedData["
1:eJw1zwlME2YYBuCOY+AOgwyZImwV0OkIoAsglglvReUwQnHIwFFWGZeclfta
LTelUBlhsAHj3iCiWQUEqaIdGO2cww4UOaQqGpFLAc+Bc3Ppx5/8+fPk/d98
+dYHxuwP1mAwGMFv7v/v8rF0Np4etzNyUsscFSiZmBDZkG3wocOzflWSE9kR
39/+bP6Svit5FzxlFvcNQ/eT3XCq0vL4gXX+ZA/8oXc3bnd0sNpCLzw96f6L
7z4+5d5g5lgphjuSKffB4K6esPL6TMr90PF0e9CJcTHlX+GMzpPSmrpSygMg
Z88d8nq/Wm3wcFlk8cgm6mf6fwgK0T/KB7KTassD4S7dc/ujZ23UD4KmPOG8
7UAX9YPxSVd0c+NqOfVDcGCpSnTDq5f6oaieiTc9k3iJ+ocxlA/H8MO/Uz8c
Kxd2xvkbX6V+BI4nfS3dWNhH/UgEHHlV0stVUj8a7n0TB418/6J+DEa0Wqaj
7fvJfKwIc1vxrsaA2nf48DSSbprtJAuPwFSw1rzd/7razFgwrrH9axbI8lg0
sSu/K0+7oTYvDvpyqZD1N5kRDy8f59QHkYNq18bDjqsYuHiTjASgzGa4n3WT
5ieg9J7h7skysjARjtm+YT0zZGYS5M9nbP79fIjmJ6HpY2OuRT6Zlwxdxco2
eR+ZkYKtYtvZzauGaX4KzifHzl70JCMVca/XN9wvIN9JxROBV2V/D1mYhjK2
xEP5gsxMx6JWlf2aT0dofjq2J073qvzIvG/RUHVa74s8MkOATdmG1TWt5FoB
TIZcR6ZGyTgKyWuL6i81R2n+UdS0JpdrbyZDiLus8MZV+8jFQqh+NTMri1n+
L4R2b6tdSzF5Swby5x01Q6VkYQaa3zk1PtZHVmYgxfVhiekMmZkJ7+TggD26
t9TmZyLwnjX8zMjyTNi5/KgZvoOslwWFZhQv14fMywKn/S2Ds9FkaRbGHpe8
+CCXzMiGzl6WQVUVmZMNTkh/O7eVXJsNWbxWYuBl8lw2wlSd3m2jZORgztrg
rO9jcnEOAqydCg9qjNH+OWjJWbKSG5C35KJZ4VJevJEszEVXx1rP/m1kZS7C
dT0EYlcyMw9ZLuPzv/mS+XnwKRSbpoWR5XnwviJjnUsi6+WjPNTEuCCXzMvH
e5ZNQZOlZGk+Hm7YGqeqJzNEcDvXGRElJXNEaGCzHSq6ybUi+BskVIZdIc+J
kHF6avWtQTIKIONu03k5Ti4ugGThQt2FR8v7F0Dc6D1nu7i8vxjJzyuGuNoq
2l+MxXh3E5YeWSmG1ZIT708jMrMQ7YwIc6MNZH4hmtb8cM3Umix/k6evOzFp
T9YrQqBDwBR/J5lXBNE3nHrZXrK0CBacnusKbzJDgu63myJ/4pI5EhRGscEK
IddKYP1yh35dNHlOgqvOspKBRDKOofuVA29AoHL6D+pWBkI=
               
               "]]}, {}}, {{}, {
              Hue[0.67, 0.6, 0.6], 
              Directive[
               RGBColor[0, 
                Rational[2, 3], 0], 
               Opacity[0.75], 
               Thickness[0.006]], 
              Line[CompressedData["
1:eJw1zwsw2wccB/CUjQ7bWZllruvSsr6Yx6Hsqnx7FNFOwzyupIR6jFaoeoQW
IUHEK449tFtlPVVpPaKlhrLsVlbXtaJoqwzrOawMY2qnd7rt8pO7/+U+9/1/
/9/77YxI8IvSYjAYUf89//9v/j5x2z73/ICpq0bmsNLevyrotSPbQ93bpiUa
dia7YOz1VT0T7SNkd9i1x0a/uORDZsOoq7eM7xlI9sE3YS+fbLPjaSz0xZXM
ZsWrvBjK/VEt/apPV/8s5YF4GK6/plMtoPwEQpynBXatOZSHoCTcYWyXbyHl
oWg1/83NcrlcY/Cg99fA6rY9VfR+OLqLOE7d3O81VkVgQffpWx6ia9SPRLaX
+8Rr0ybqR0HBDwp+U7eF+tEYPhBx7I5+O/VjMLHIjpiO7qZ+LG6dWl6tXPiJ
+nFY4vY7l317l/qnsaOSI2nc9wv1z2BjPdrJSdpHfT76PU+o7NvvUz8BJcks
m+jbD8iJaKjujOSK+zWeTMTohNu4qEJN3z8LedLhuhjfAY1ZSVCy0410Nsiq
JDAZKWmnLj3SmHcO8/NblT4Wg7SfjAblUF1oE1meDCMHb7/VvUO0n4Ia/44Z
9yryZAoWqw+OB2wZpv1UMI8fUhhEkFlpqDPmrFndIavSkJE87vmF4WPaFyB4
f/HIZ2FkRjo849c3whVkeToW3B7MmyySkQED83TjAZsntJ+B0c6ND//gk4Xn
cd24TNagILMuoO1el2Pk72TVBQzZtnKOmjyl/UzczF+UXPQiM7IgDDz+WCQg
y7MwmvmOtX0tGdkomRraPTRAnszG7MdBKZJXm7kQOobMuCSzEY1lQjD/9OAo
2eRJIU5a2Pac5JNtcjDb4KddWU4W5sD/2A9mcbfI6hx8+T4raHWQzMoFa1yX
yV4hJ+aC26YITHv3Gd2XCzOz7mqZFdlQhI2VdpcabzJPBI/8XVxVFFkpgmnj
eeZyNpkhxlSqa82RKjJHDO/vXAN6m8lyMbrf/rk9q4+8JMYb9rUKwSQZeeBb
dwZ0vSTL8mCuuhwQYDBK9+choMu6xWsn2SYfHTPq9csOZGE+/v7164NhbLI6
H3yDAlMZl8wqQGrBwrBjAjmxABa9W324OWRVATh6L/S1K8iGEqhNBz1ta8g8
Capb1xbmWshKCbb82Fvn2ENmFGL5hmqUOUzmFMLTZaa5YoosL4Q8Ub29foW8
VIh4btRIlNYY3S/F0RX/c3cNyTIpVssOe93fQZ6UIv5akzTTkmxTBMGhTvfx
T8nCIiRbVgUveZDVReh+OFt8+3Myqxh+5s8y7HjkxGJw9lrWxJ4hq4rxT6PO
6RAB2bAE4kc339MXk3klqK23V2eUkZUl+GDkXkP9RTKjFMtaXtevXCVzSrFH
mnQjVEmWlyLlo925zzvIS6Vw08ues+7ZvL8M+2qny736x1z/BVVlBIo=
               
               "]]}, {}}, {{{}, {}, {
               Hue[0.67, 0.6, 0.6], 
               Dashing[{Small, Small}], 
               Line[CompressedData["
1:eJxTTMoPSmViYGAwAWIQvUzf5sH1/Vr2DGDwwP5Z5+cZup0RDjD+I+5vb7Q7
M+D8iaUpfmETK+H8N+FmfNb/muB8vlfXls4R6YTzOwX0bgqv74fzdfxOJce+
mQTn29+7scLaeRqcf2mF6bGmrplwPr+a1MHEmXPg/Iq3Nzu9X82H849uFpiR
1rgQYX9f9PXbrIvh/FzeKbVhq5fA+YppE4TmmiyD818nV/G9vLcczv9a112W
2bgSzg8pTji7lX01nH+SR7mbff0aOH9y/UpzVat1cH7xdFlvj2fr4XyvtJin
/kc3wPktb7vnJHZuhPM93Y3Yv8VugvN39lplFqhsRtiXFMbI+hzBT+F66SOz
awucv3Le3X7J+q1wfiWrZ9vMkG1w/stfxzcZq22H85nvrri2+SWCv3Iiw7pt
e3fA+T+NdtXMb96J0J/U3rjIdRfC/tTTlhoSu+H8zpDCl5PvIPiWYn0+TRv3
wPlTjvAsD6vYC+f3M843d7XeB+eLCq6o3sa3H8535RXeznsFwWfI+3Xpc8gB
OH+dTOnTt3sR/I0HF3y+JX8Qzv91vj2aswvBn3FFfr/WWwS/bcFB20i/Q3D+
rqtyYie3I/jOjLqvtKUOw/nLWvd9FA1E8Dm4An7+b0fwAUB+A9k=
                
                "]]}}}}, {
           Frame -> {True, True, False, False}, 
            ImageSize -> {360, 180 2^Rational[1, 2]}, AspectRatio -> 
            2^Rational[-1, 2], PlotRangePadding -> 0, 
            FrameTicks -> {{{0, 0, {0, 0.01}}, {200, 200, {0, 0.01}}, {
               400, 400, {0, 0.01}}, {600, 600, {0, 0.01}}, {
               800, 800, {0, 0.01}}, {1000, 1000, {0, 0.01}}}, {{
               0., 0., {0, 0.01}}, {0.5, 0.5, {0, 0.01}}, {
               1., 1., {0, 0.01}}}}, FrameTicksStyle -> {{
               Directive[
                GrayLevel[0], 
                Thickness[0.006]], 
               Directive[
                GrayLevel[0], 
                Thickness[0.006]]}, {
               Directive[FontColor -> GrayLevel[1]], 
               Directive[
                GrayLevel[0], 
                Thickness[0.006]]}}, FrameStyle -> {{
               GrayLevel[0], 
               Thickness[0.006]}, {
               GrayLevel[0], 
               Thickness[0.006]}, None, None}, FrameLabel -> {"", ""}, 
            BaseStyle -> {FontFamily -> "Helvetica", FontSize -> 14}, 
            ImagePadding -> {{50, 10}, {50, 10}}, Epilog -> {
              Text[
               Style["A", 14, Bold], 
               Scaled[{0.05, 0.93}]], 
              Rotate[
               Text[
                Style["neo-W frequency in females", 14], 
                Scaled[{-0.15, 0.5}]], 90 Degree]}, PlotRangeClipping -> 
            False, AxesLabel -> {None, None}, AspectRatio -> GoldenRatio^(-1),
             Axes -> True, AxesOrigin -> {0, 0}, Method -> {}, 
            PlotRange -> {{0, 1000.}, {0, 1}}, PlotRangeClipping -> True, 
            PlotRangePadding -> {{20., 20.}, {0., 0.}}}], 
          Placed[
           Unevaluated[
            LineLegend[{
              Directive[
               GrayLevel[0], 
               Thickness[0.2]], 
              Directive[
               RGBColor[1, 0, 0], 
               Opacity[0.75], 
               Thickness[0.2]], 
              Directive[
               RGBColor[0, 0, 1], 
               Opacity[0.75], 
               Thickness[0.2]], 
              Directive[
               RGBColor[0, 
                Rational[2, 3], 0], 
               Opacity[0.75], 
               Thickness[0.2]]}, {
              Style[
              "\!\(\*\nStyleBox[\"R\",\nFontSlant->\"Italic\"]\)=0", 14], 
              Style[
              "\!\(\*\nStyleBox[\"R\",\nFontSlant->\"Italic\"]\)=1/20", 14], 
              Style[
              "\!\(\*\nStyleBox[\"R\",\nFontSlant->\"Italic\"]\)=1/4", 14], 
              Style[
              "\!\(\*\nStyleBox[\"R\",\nFontSlant->\"Italic\"]\)=1/2", 14]}, 
             LegendFunction -> "Frame", LegendLayout -> "Column", 
             Spacings -> {0.5, 0.1}]], {0.8, 0.75}, Identity]]& ],
        AutoDelete->True,
        Editable->True,
        SelectWithContents->False,
        Selectable->True],
       TraditionalForm], 
      NCache[{160, Rational[1, 2] (40 - 180 2^Rational[1, 2])}, {
       160, -107.27922061357856`}], {Center, Center}, 
      NCache[{360, 180 2^Rational[1, 2]}, {360, 254.55844122715712`}]], 
     InsetBox[
      GraphicsBox[{{{}, 
         {GrayLevel[0], Thickness[0.006], LineBox[CompressedData["
1:eJw1zQtIU3EYxuHNDBK0UjFJlnPLLlM3CJdJNH1hmTVIRxeiC6WjLdbSmpiR
Ez3OeZnZukBUxGjaRJwSUWFBrobkFMLAbmCLtWZlMLdoSGSKZPj/DhwODx/v
+Yk0Z/dpY3g8Xu7i+/9Lj1QpCAXz0gqXJIfq/V1N2FvKvBOdPUrkpZiYSzCQ
cCs/4U438wF0jdjXfX0+zHwYSfde2b5H3zEfh1rJqZ9JfEvmyiH/UP7A6faz
+0nMn8htia0PsLsOsdWnVo4qvrC7Huu3HbTuHmLmDJj2CD7eEAbZvRKqCoU+
UcOMc+jKbvzkv8bMGVEz+u1l22NmTxX6//LXTo3Rvhoil37SFaD9eUw94iae
RmhfA9kat1M3S/sLUDUVHuvmT7L9RRQc8qqFK5hRi4h/JH5vAjNnwtY/UbEl
kdlTB7N0/jY/hfb1WJg5oviVSvsGTAjrB6vSyBxq3ZECu4A5wEFw1THZmE7/
b0RfkN8gzWDOMCPV1famV0Q9M4oKxnULYuayJiSX/Mjckkl9C7JKbw7t2sDs
sEDsq1il3Ej9Zsy+XpYj2UT9ZsiqeA/nyFwLQp1nxgc3U78VQ8VGXaWE+q04
Lbofl5RF/TbsUfQLesk8K4Sc6a08m/pWmOu27xggox3XLauLZDnUb4dRO+ex
k7lLiB59YlgupX4HesIz01qypwPDkRjfC3LZZfw2xLmTZdS3IVAciteQHTak
7/+c30fGFXjDY86fi/4H+1H9Mw==
           "]]}, {}}, {{}, 
         {RGBColor[1, 0, 0], Thickness[0.006], Opacity[0.75], 
          LineBox[CompressedData["
1:eJw1zWtIk1EcBvC35Vx5WYLQh1qwQV/8IMNLui+5BxXKtIWmKyV1WWZ2s6SS
lbrXubl5ySliJDNc0kQzhNTCsnJByyhCmXhJUzfJC4kVxUKkO/ufFw4vP57z
nEeWV5SWL+A4Lurf+f9nX3iCZHUhZofSp2ikdG68iShMIici0r63yW/2HFkF
t1ShC/NayOlIOSNyrJl6yJmIeqLUtG5+Sc5B3Pb24Y2eUZ/541j3Wh8Eqccp
P4mszN/moGNTlJ+C65X2WUjRNOWFWG5JrlV/naH8LCSbspfiQ2cpv4DWfSPL
sV4yLmLA1Rd6onOO7l+C5qM95JFi3mdHMSJ2zb0t6CFzlxHYtjLYJXJT/woe
BusGFuRk/iqG0u1lpalkRwkkTYLU/vNkTgtPe39vhZH1ryE57U5pZwvrX8eB
YbPFeY/1S1Gs3b145DHrl6Njj1U+7GR9HRp3PneeHmXmYdg/nVX5nuzmkTOz
PpnqYe9X4OjIVKNwhSzVI0GQIXy9xvb08MT7KZ5+I2sq0STrc/35wfYNeJff
Jry/QbYZMG5VxU/8YvtG5JZ9HmvgPLRvRFeSOHtVQOarUHL7i/K7H1lqgkxc
6e3zJztMCD+YqI7dQtaY0fuzfNK4lcxVQ6AVDHUEkG3V4M2LKlsgGTV44ez+
VBLE9mvQfcgdExnM9mthmhdFjzFL6/Bh4W5Gjpjt1+FmwUrzBLPmBqbnG6ri
trH9evgP5uXeYrbVQ2VpDlhihgXRh/XysBCP8i/wJgVN
           "]]}, {}}, {{}, 
         {RGBColor[0, 0, 1], Thickness[0.006], Opacity[0.75], 
          LineBox[CompressedData["
1:eJw1zW1I01EYBfB/WQShBUJLxdp0ltFSSlOKIA8uhi5cb9NeBJti2gxTs5pW
5rK95JzTghZFkZEOliGJ0pYu2vyQy2SiNJu15rashGn5Qb+0lIo9Xrhcfpx7
OHFFFUfPrGQYJvXf/f8unyR+bMCfHpMR0m5Y7Mcf182AfADbExY2rsnJI4sg
88wdLOaVk8WI5Li768wN5JMQZbbqnQt6cgEO7RIkTemMIcsL4a8UnPIlmykv
RopybH7JN0B5CURsq3SG945yKfSq181DOQ7Kz0HX4WdlJY9Sfh5R48+D7cNj
IaMSS8MnnO5NH+h/FeYc4T2eNGfI1gsYHkhl18ePU/8iRvgKW/UsGZdgrK0Q
vXz0kfqXEbHYs1e6x0V9Ge4L2SllNjJTC6H0rK573wT1r2Aqd+2v20ay/Cr2
s0Z7v4Z/ov41dN1JO80tJTPXoZO9T1e/IqMeG6p6I9av/kyWw57//VuLkOyV
I1bM7bZoyPIb2BK/NbjjLZnTgA7JZETRItnagJ9x/fNDO90hS26iLxgwDErI
jAL8CYe2s5ncpoBLcFf1xkSGEjaTtpU/SfYqkZOdHVO56gvtq8Brd3FkiWSO
GjZDfpQyi2xV48fDe122UrLkFobG58sPK8lMI8wr7IIjT8htjfhd2BTm6ydD
gxe5ls5oJ9mrgV+V54qcXd5vAst97I8vzEP7WmyeTnj6IJps1aJ6W59BlEyW
NGOkrLxgXSaZ0SExwTs4LSa36VCf2fssUEJGC2q6PCZujSfjLxcxCIo=
           
           "]]}, {}}, {{}, 
         {RGBColor[0, 
           NCache[
            Rational[2, 3], 0.6666666666666666], 0], Thickness[0.006], 
          Opacity[0.75], LineBox[CompressedData["
1:eJw1zXtI01EcBfAfYypW2hBCCHOzh7jC+Yr+KMSzMhBdiiMoe8hMHZpozpzh
XO7nnM6pmy4DhWgpQZKykhpJUrGUZDrI+ZjpnDEChRKk1KQMe7GvFy6XD+ce
TtS1G9JCDsMwSf/u/3fnxJ6JWPl0Yn+KX8chz7+dNaJKJqdC2z9kERzNJmci
3su0HFrKJ5+Hih/+mDtZRc5BmlK0FdtmIOciV6xdTDx7z282DwfN43tslj7K
C9DVcdW1PvaCcjlS+kOHZz12youxmhRk6wsepbwEi6KX1cKb45SXIZsb/I3H
e+83yjEQH2jjal30X4G1sSbp6NCk3/YK+M5N6h+9naJ+JdT7nqT/7JmmvhLK
Lpv0d/4M9aswqwiUvAtxU/8WBhYqLrofkplqiCcMJ7uFs9RX4fvCr05XD5mt
weaBu2ZN6Afqq9E+/CDgkoLM1GLGXboy5CRDg3DzluRN5ByZxZ0jl49llZB9
LGxPR6YTnpHZOnBSjf27N8gCLbzLjujihHna02Lp9Cn58HWyrB6R4tWZ2m4y
o8Mul577Y4rcrUN9tGSzhuOh/Qa4I8xrmXFkXwMCYhxB1hwy24jy7ZBUZx1Z
oEdHXu/gXC/ZrscFR03GHydZ1oSP6qjKglUyY0DZqziHcO8C7RtwRcjXlIrI
aMbXsC/edAnZ14z2+6NGTxGZbcE637qRqCMLWiFtmi8rspDtreCOh5qMg2SZ
EYXTvIznE2TGBFWnPuHz8s6+CTHWtMbk7Z39NkQf9hS9DvOm/AWpeQOy
           
           "]]}, {}}, {{}, {}, 
         {Hue[0.67, 0.6, 0.6], Dashing[{Small, Small}], 
          LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQvUzf5sH1/Vr2DGDwwP5Z5+cZup0RDjD+I+5vb7Q7
M+D8iaUpfmETK+H8N+FmfNb/muB8vlfXls4R6YTzOwX0bgqv74fzdfxOJce+
mQTn29+7scLaeRqcf2mF6bGmrplwPr+a1MHEmXPg/Iq3Nzu9X82H849uFpiR
1rgQYX9f9PXbrIvh/FzeKbVhq5fA+YppE4TmmiyD818nV/G9vLcczv9a112W
2bgSzg8pTji7lX01nH+SR7mbff0aOH9y/UpzVat1cH7xdFlvj2fr4XyvtJin
/kc3wPktb7vnJHZuhPM93Y3Yv8VugvN39lplFqhsRtiXFMbI+hzBT+F66SOz
awucv3Le3X7J+q1wfiWrZ9vMkG1w/stfxzcZq22H85nvrri2+SWCv3Iiw7pt
e3fA+T+NdtXMb96J0J/U3rjIdRfC/tTTlhoSu+H8zpDCl5PvIPiWYn0+TRv3
wPlTjvAsD6vYC+f3M843d7XeB+eLCq6o3sa3H8535RXeznsFwWfI+3Xpc8gB
OH+dTOnTt3sR/I0HF3y+JX8Qzv91vj2aswvBn3FFfr/WWwS/bcFB20i/Q3D+
rqtyYie3I/jOjLqvtKUOw/nLWvd9FA1E8Dm4An7+b0fwAUB+A9k=
           "]]}}},
       AspectRatio->NCache[2^Rational[-1, 2], 0.7071067811865475],
       Axes->True,
       AxesLabel->{None, None},
       AxesOrigin->{0, 0},
       BaseStyle->{FontFamily -> "Helvetica", FontSize -> 14},
       Epilog->{
         InsetBox[
          FormBox[
           StyleBox["\"B\"", 14, Bold, StripOnInput -> False], 
           TraditionalForm], 
          Scaled[{0.05, 0.93}]], 
         GeometricTransformationBox[
          InsetBox[
           FormBox[
            StyleBox[
            "\"neo-Y frequency in males\"", 14, StripOnInput -> False], 
            TraditionalForm], 
           Scaled[{-0.075, 0.5}]], {{{0, -1}, {1, 0}}, Center}]},
       Frame->{True, True, False, False},
       FrameLabel->{
         FormBox["\"\"", TraditionalForm], 
         FormBox["\"\"", TraditionalForm]},
       FrameStyle->{{
          GrayLevel[0], 
          Thickness[0.006]}, {
          GrayLevel[0], 
          Thickness[0.006]}, None, None},
       FrameTicks->{{{0, 
           FormBox["0", TraditionalForm], {0, 0.01}}, {200, 
           FormBox["200", TraditionalForm], {0, 0.01}}, {400, 
           FormBox["400", TraditionalForm], {0, 0.01}}, {600, 
           FormBox["600", TraditionalForm], {0, 0.01}}, {800, 
           FormBox["800", TraditionalForm], {0, 0.01}}, {1000, 
           FormBox["1000", TraditionalForm], {0, 0.01}}}, {{0., 
           FormBox["0.`", TraditionalForm], {0, 0.01}}, {0.5, 
           FormBox["0.5`", TraditionalForm], {0, 0.01}}, {1., 
           FormBox["1.`", TraditionalForm], {0, 0.01}}}},
       FrameTicksStyle->{{
          Directive[FontColor -> GrayLevel[1]], 
          Directive[
           GrayLevel[0], 
           Thickness[0.006]]}, {
          Directive[FontColor -> GrayLevel[1]], 
          Directive[
           GrayLevel[0], 
           Thickness[0.006]]}},
       ImagePadding->{{50, 10}, {50, 10}},
       ImageSize->
        NCache[{360, 180 2^Rational[1, 2]}, {360, 254.55844122715712`}],
       Method->{},
       PlotRange->{{0, 1000.}, {0, 1}},
       PlotRangeClipping->False,
       PlotRangePadding->0], 
      NCache[{480, Rational[1, 2] (40 - 180 2^Rational[1, 2])}, {
       480, -107.27922061357856`}], ImageScaled[{0.5, 0.5}], 
      NCache[{360, 180 2^Rational[1, 2]}, {360, 254.55844122715712`}]]}, {
     InsetBox[
      GraphicsBox[{{{}, 
         {GrayLevel[0], Thickness[0.006], Dashing[{Small, Small}], 
          LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAmIQDQEf7KebrQ/4JvDQHsI3dVjTESl2DsZvcHH4sl5q
yxQuGN/PIZGZ/9maBw8gfIcQh6jbAW8mhsL4kQ48dluPXrlyH8qPczCTdV8r
tBLKX5DooJV7OenCJihfIcXhVtX3azOPweTTHJ4FO8pm3oDJZzr8+rjtxcqn
MPlsh5ZS4SdH38Hk8xyeVdirXvgC5QcUOEyzuZh98AeUP6HQQePLC86A31D+
hSKHNUsd1n//A+ULlDhcCDmxmfMfTH+pwwIm70+7YPwJZQ6TjjHO0/0P01/u
YOLJeqkcxheodNCLDLqxHMYPqHKYUWT87hiMP6HaYYv5fN7bcP01Dh4ZTSIv
4PrrHFh4Gps/wPXXO3Qsc/75Fcb3aHDYd9ak6SeM/6LB4cM28TO/YfyORoeG
2Cz3vzC+RpPDmnMMtv9g/BNNDocmM96B8zOaHTyqPjv9h/E5Whw4hGa1wvkr
WhwyJA9ugPM9Wh0kMjaegfNftDrYyJy4B+d3tDmwWda9gvM12h32BQt/gvNP
tDvUifz5BudndDi4HdT8hbC/04FlgsUfhP2dDrcW9/5F2N/lcKU86x/C/i4H
tsKfCH5Ht4MOU9h/hP09Djs+TETwT/Q4qOzbgeBn9DoU3b2I4HP0OUQoPkLw
V/Q5WK18A+YDAJrVMNM=
           "]]}, {}}, {{}, 
         {RGBColor[1, 0, 0], Thickness[0.006], Opacity[0.75], 
          Dashing[{Small, Small}], LineBox[CompressedData["
1:eJw9zV9Ik1EcxvGX9UZeSEwLLQw19GKMGJS1m4I9DKmRMkYUpEl/ZuYyWimr
YX90Lc13a4lIZBbGoF2oXUxpGt4oDqShCMOLGivSIeGimiPZ5nRahud3DhwO
Hw4P34PGW2fqZIIgHNm6/9/tE9f0qL2GpDyi2fYxqGe02WIOs60cNfrxHP1u
sh51kV+vfDJmnMVb2XFrPLTAXIXQ5CnxZgv5IrzDFsmiZHZfQd+iKXFYZC6+
Cs/S7FLB8jz7vwbfamxoLMpcfB1ax0TZAtl9A6MVRdKhn/Rvxt6Yf0OIMRtu
Q8x989kfZ+5qxHTk4Z4TK8zBJgg7TepLCWa5BU7rRFSVov0dyM/3jrxfpf1d
fNLXelNp2lsRbuh1i+u0b8a45sOFRbLhHpzVScfrDO3vozo8MFS2QfsHCFdW
VA6T5S3oHjj6Z98m7VvhKTnXZCbrbBjsz0/6yFEbIEkFy2TpEUIf3dlFf5kV
dsyVZrpPkgN2CLuMinqy6TF0o12inZzVBnu9T/GS3N+GzemoaZCsa0deQ75l
jBxth3Z/c3iKLD2BfzaRG+T9Dqicz1tDvN8B5Vxp4zzvSziQV678zvsOfPV8
ifzgfQcKA6qp37zvRKDHlY7zvhOX3430rfD+U6iFHTMJ3nchmFf1IsX7LoRr
4vI07z+D2bimW+P9TtizlKfXeb8T3yZLCjNb/ges4yB0
           "]]}, {}}, {{}, 
         {RGBColor[0, 0, 1], Thickness[0.006], Opacity[0.75], 
          Dashing[{Small, Small}], LineBox[CompressedData["
1:eJw1zWtIU2Ecx/GzlbkmzW1liAPbQkPSkY6cUYY/0Ni6MEf0xixFW7HlsjVc
WUfayTZ3SSUKSl9YJpEnky6j3iazqCWJMyqGLdIGOXsRQyS6UGTs/B94ePjw
48ujaT65/6iYYRjd8v3/pk+q6rr+gfm7fK4q7XIwjVFmj0IwV4M25vFAF+2c
CRWu9QMRmWAcwNjG2axpKbkOzc+cBpWY3IDgfE6TIzWb9mATjstC1benBast
GA0FNPZh2o8hd6F1y9oO2m1g82qUhjraW/CFtbG/QXsrRPdEqqelgs0OqA2y
yleFgi+fglHakl+SLzjqxPDrK0uhXMHyNpiKZ+JD66h3gf95qN+voP40dNqP
Oaps6s/AH97r2byG+rPYrlPy17KoP4eDbGbhbin1LLgTJUrdauo74DSxM7sk
1J/He64swWZS78aLP7/uTq4SbOSQ0LzR6slJDqYffb5HGYL9FxBvmL9VSS7q
hDESyni3UnCkE+rx4iftZOtFxI+0yzeRJR7wMUv4wwrBvAelOxWjfWSjF1/l
SNSTk16Ee8w3C8j+Lrgm9BWLYvrfB37DUt5zcsSHO2Vbp/rJVj9G/k4sOMmS
APa552S1ZD4AfWzkm5ZsDMK+zVudTU4G8XaHI7ooov8v4fPDl40xclE3LLby
8TFypBvsjalJnmztwaeh+sNXyZJe+M33a91kvhcFqQKffdn/ALTN8Ik=
           
           "]]}, {}}, {{}, 
         {RGBColor[0, 
           NCache[
            Rational[2, 3], 0.6666666666666666], 0], Thickness[0.006], 
          Opacity[0.75], Dashing[{Small, Small}], LineBox[CompressedData["
1:eJw1zXtIk2EYxuEl7qBNt5XMaJGrLEdFQmS1HO6WTZkEIUsLMXTFirmROnFZ
W+VmO+ncGKUUaehEQUgoIwkKgpWmqOWiiBhB8wAZyBIE/4sO7H0+ePm4uPnx
7LnUpL+cxuFwjv57//+pb119//iTyk3xojrlIpS/7wvUSJidWtjmRMWztDvP
QJDgxodFzKjC46fabF0WuQYDtUO5LgG5Dq8/Tn1Q/kmkPHgRpQODQW+SWW5E
/6uWRvln2q/gmKTIfXec9gbsMtTHSoK0W1DMezgyeZX2RvCqp5fHq5krm2Gy
LIS1WuawFSvevMXoCeZYC4yn0wuGjzCLW7HueHfvSwH1NjQdXFFF9lJ/DWuF
emtgN/VtEI6lHy6TUX8Dc5pb+gc7qLcjGT1wvV5KvQPNz6R5zhzqb+LlyVrZ
j23U38bz32Mar4T6dsynRX7pxcw6J2R9kU2tiHnVCaNPseVcNrPfBVV+WOTK
YlZ0oCfQnv9GyDzTAWHMypeSTXcgNMdz7VuZBW5UtSYPrWUyj7qx9O1Fm5ms
8yBTs9++kUH3PRCvO5Iest8L10RGVE5W+GCbKee9FdB9H05NxjYsZJMfObJY
fCdZ0Im6adu+BT7d70TJo7MVfrKuC9wew9cy8moXpgweM5/sD+DCz96ReR7d
78Z25ZCylzzTjXJN6LuBbApiomL5fCFZEIKqNdbAIY+GMFuqX/rETaj/AqIv
8K0=
           "]]}, {}}, {{}, {}, 
         {Hue[0.67, 0.6, 0.6], Dashing[{Small, Small}], 
          LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQvUzf5sH1/Vr2DGDwwP5Z5+cZup0RDjD+I+5vb7Q7
M+D8iaUpfmETK+H8N+FmfNb/muB8vlfXls4R6YTzOwX0bgqv74fzdfxOJce+
mQTn29+7scLaeRqcf2mF6bGmrplwPr+a1MHEmXPg/Iq3Nzu9X82H849uFpiR
1rgQYX9f9PXbrIvh/FzeKbVhq5fA+YppE4TmmiyD818nV/G9vLcczv9a112W
2bgSzg8pTji7lX01nH+SR7mbff0aOH9y/UpzVat1cH7xdFlvj2fr4XyvtJin
/kc3wPktb7vnJHZuhPM93Y3Yv8VugvN39lplFqhsRtiXFMbI+hzBT+F66SOz
awucv3Le3X7J+q1wfiWrZ9vMkG1w/stfxzcZq22H85nvrri2+SWCv3Iiw7pt
e3fA+T+NdtXMb96J0J/U3rjIdRfC/tTTlhoSu+H8zpDCl5PvIPiWYn0+TRv3
wPlTjvAsD6vYC+f3M843d7XeB+eLCq6o3sa3H8535RXeznsFwWfI+3Xpc8gB
OH+dTOnTt3sR/I0HF3y+JX8Qzv91vj2aswvBn3FFfr/WWwS/bcFB20i/Q3D+
rqtyYie3I/jOjLqvtKUOw/nLWvd9FA1E8Dm4An7+b0fwAUB+A9k=
           "]]}}},
       AspectRatio->NCache[2^Rational[-1, 2], 0.7071067811865475],
       Axes->True,
       AxesLabel->{None, None},
       AxesOrigin->{0, 0.39},
       BaseStyle->{FontFamily -> "Helvetica", FontSize -> 14},
       Epilog->{
         InsetBox[
          FormBox[
           StyleBox["\"C\"", 14, Bold, StripOnInput -> False], 
           TraditionalForm], 
          Scaled[{0.05, 0.93}]], 
         GeometricTransformationBox[
          InsetBox[
           FormBox[
            StyleBox[
            "\"Zygotic sex ratio (fraction male)\"", 14, StripOnInput -> 
             False], TraditionalForm], 
           Scaled[{-0.15, 0.5}]], {{{0, -1}, {1, 0}}, Center}]},
       Frame->{True, True, False, False},
       FrameLabel->{
         FormBox["\"Generation\"", TraditionalForm], 
         FormBox["\"\"", TraditionalForm]},
       FrameStyle->{{
          GrayLevel[0], 
          Thickness[0.006]}, {
          GrayLevel[0], 
          Thickness[0.006]}, None, None},
       FrameTicks->{{{0, 
           FormBox["0", TraditionalForm], {0, 0.01}}, {200, 
           FormBox["200", TraditionalForm], {0, 0.01}}, {400, 
           FormBox["400", TraditionalForm], {0, 0.01}}, {600, 
           FormBox["600", TraditionalForm], {0, 0.01}}, {800, 
           FormBox["800", TraditionalForm], {0, 0.01}}, {1000, 
           FormBox["1000", TraditionalForm], {0, 0.01}}, {1200, 
           FormBox["1200", TraditionalForm], {0, 0.01}}, {1400, 
           FormBox["1400", TraditionalForm], {0, 0.01}}, {1600, 
           FormBox["1600", TraditionalForm], {0, 0.01}}, {1800, 
           FormBox["1800", TraditionalForm], {0, 0.01}}, {2000, 
           FormBox["2000", TraditionalForm], {0, 0.01}}}, {{0.4, 
           FormBox["0.4`", TraditionalForm], {0, 0.01}}, {0.5, 
           FormBox["0.5`", TraditionalForm], {0, 0.01}}, {
          0.6000000000000001, 
           FormBox["0.6000000000000001`", TraditionalForm], {0, 0.01}}}},
       FrameTicksStyle->{{
          Directive[
           GrayLevel[0], 
           Thickness[0.006]], 
          Directive[
           GrayLevel[0], 
           Thickness[0.006]]}, {
          Directive[
           GrayLevel[0], 
           Thickness[0.006]], 
          Directive[
           GrayLevel[0], 
           Thickness[0.006]]}},
       ImagePadding->{{50, 10}, {50, 10}},
       ImageSize->
        NCache[{360, 180 2^Rational[1, 2]}, {360, 254.55844122715712`}],
       Method->{},
       PlotRange->{{0, 981.}, {0.39, 0.61}},
       PlotRangeClipping->False,
       PlotRangePadding->0], 
      NCache[{160, Rational[1, 2] (120 - 540 2^Rational[1, 2])}, {
       160, -321.8376618407357}], ImageScaled[{0.5, 0.5}], 
      NCache[{360, 180 2^Rational[1, 2]}, {360, 254.55844122715712`}]], 
     InsetBox[
      GraphicsBox[{{{}, 
         {GrayLevel[0], Thickness[0.006], Dashing[{Small, Small}], 
          LineBox[CompressedData["
1:eJw1zW1Ik2EYhuEpZXMtXRuFpJSjdFZrlCWRUl4wa0YpJvtTZOlwsZE4Z+pa
as2pbTNbsw8CQbKwmGhqFNGwHIPCwSBWGo4Q52ZFNMJcG/4pyPC5X3h4Obi5
OMUqXbk6kcPh5K68///V71dhkkTz4gNnvnDVeRjwVY4WJDCbimBubkhe4JJL
oTsWfzR2kBlKSCfPJmX5yaeh3zsDoy7EfA4tb/TTGj9zfxU8y73FHlF41ZnV
OCI/Gf2qYO6/AO9r+aYKPd21kI9o0+pu0/0iZi3eW/5hutcivn7oVcjDXFaH
It4937uPzA49bKrwfvU8s78e5rHPoaYIs6ABJuNUui1G+0YYan66kv/QvgmP
408OlyQusL0BUxOJD++uYxYYse/Q+NJGPnPZFQR8yi+RVGZHMwyjqQ6IaN+C
cOxEm2Qz7a8i+kB2/Hka7a8hElwcjG5hLjah733N5aUM5u8mzBUGjrq2Mlvb
4I9NBk9lMueY4RHLn3nEzF4zWn+4+CnbmTXtyE9wVxfsYOZ2QHjmk6Eki9nZ
AWNGe70im/qdWBxO4kkl1O9EdrC25y/Zeh0zQjVvIof6FnxbM5Cr20l9C2aL
AnbhLupb8dZivDRI5towksnj5+2mvg22O4Kql+TiLswd4FfIpNTvglJ3399H
tt5Az/lg49o91O9G6zbHbzXZ243yp6VBN1lzE+mV026RjPp2aJfHU1Rkpx1O
xYb8oRX/Ax0TAKE=
           "]]}, {}}, {{}, 
         {RGBColor[1, 0, 0], Thickness[0.006], Opacity[0.75], 
          Dashing[{Small, Small}], LineBox[CompressedData["
1:eJw9zV1IU3EcxvGjhc2X2qQUkhjtJk+cdmOM6kL3RMlsjJISNdBEbbJKe3WZ
TXSbL5trW0LWvCldhi9Q0EiUMMiE0Xa1BRZdhGsVcSp0zsZEg8jY+Z0Dfw4f
fjx8FQ1XTuvTGYYp2nz//6lvRZ1RaJh6x3xWp6xCvPbWaJBsPg6Fs1r6YAv5
JLh6bWBMKhgVeHsqfqLyCPks8r3L6yYb+Ryy3vjrsv2CR+rh+pbmc0YF7z2P
Gk1i7vEy3Zuwj7eMMUm6X8Ch/dHRtQ26X8Kxl4PFvr90v4z5BpVqPC2acvlV
SOQtk7u2Ch64hhJ9QaIgQ3D4OlaDssbQNsGyVgRb760hk/ZGzCU1ElMW7W/C
Ft9w9WXTvg25Rs/7izm0b0fV5DCv3E772/iBWHiBPGBCLRcONO6gfQcece11
i2RZJ9qerN/XSGnfhY83ppNecpkZktjsRIzMm2HhXnUVyQTbLfAoqzKbyawV
HwrZoYfkgBV5LX90AbKhG0ORTvkSWdKDu7rnkZxcwRM9UGmPlrLksl44quU/
1WS+F5WLJWcqyPY+TH39tKonszYc5pWckRywId/nK7eSDXYo1OxTF1nSD628
uMMj9vuxFPqdHBb7DnzZGdGOi30H3Ae5kWdi/w5W9lh3vxD7TjSnhxZmxL4T
pbrvv2bFvguDfJ7xtdh3w9fk7Z4X+24k/AdY/6b/AZhm++g=
           "]]}, {}}, {{}, 
         {RGBColor[0, 0, 1], Thickness[0.006], Opacity[0.75], 
          Dashing[{Small, Small}], LineBox[CompressedData["
1:eJw90V1I01EYx/EtLFazWORoSpBdlGvLZeVempQ/I2iDsLEsUkQwZvwjyxZt
pfaytulemwu9qVBXQW2olCGBF21pVIOlbcXMC6tFFNNelJwRdVGG/6cDh8OH
h+85F2fd4QZ93SIOh7N1fv87F9ZM6ZICZiDBSZUuWA77dVNAS7bsBt/25Hfk
v8shkX9+P8tljQrcnq5dnskiV2Jij9D8nE+uQZ/H9fSaiHWgFvGux35sZJ1v
QD+3c61UQfMj2DUr4HtLaH4UOelfkY/kwDFsEIXiWjXNT2Df2LBhh4q17iQU
LxPrtXSf34jBvO8z/mLW8VOIeXq3r97GWnAa7rJvy5JbqDdBMPbmxVAR9Wbk
JrpuJDdTfwZXZFOjS8mCRixecf71IRn1TRi5N1kWLqS+GZLOUL2CHD8HvUhp
CG+i/gL2zmke7SfrLsL2M+nISFlrLMj8GM/rJqctsHeE8/Vk5yXcUrc2ZZPF
VsirYsoRCeuoFSvXCH3tZMaGnce/JmrIPDu666uNMnLQjgN1zdNcsqYF78If
UuP0X+kW9Adi6ftkZyuU5b0P2shiB/qkB7MayFEHBs3VHToy44TK9KyomMxz
wWT9E8olB12YUn1KcsgaNxqlwrZJMb3vhreqZOAV2enBzS/tBRGy2IvUkHG0
hxz14q1+wn+VzFzG8Jy60knm+WAozM45Sw768HDVnbvMvP8CQcH80Q==
           
           "]]}, {}}, {{}, 
         {RGBColor[0, 
           NCache[
            Rational[2, 3], 0.6666666666666666], 0], Thickness[0.006], 
          Opacity[0.75], Dashing[{Small, Small}], LineBox[CompressedData["
1:eJw90ntIk1EYBvD5mWvmZUbmtBZOHSbyRTgcEQV7iLAYtYaNYEZBaTHt4hYt
aZq7OHW6pXb5qxgMVjEsyKitEUIjsH1SNvfHkIIgKnSFREVG2aAMz+uBw+HH
w8N7OJyK4+2NJziRSKRa2v/P5fVVI95sepQUvdMsW41DMsGrIjt249ZWq926
Yh2iFfmN0ixmGBBrS700cWQjduxfdGlzyEfx/GB9dXINc+AYNJ0t3tPrmBUt
cOojyjk55SfxwuwXq6sob0Wo3N6aVFJ+Cpx3W/e+lfwswk/qeJ+CWW/GK11B
wr+JecSCjQsR+acNzNPnIBfcMU8pc9F5KEqGZ20l1LdC2SBrChdT/wIiGVuc
p/tOd+AaH82aWUv9i3CkA467RdS3YbvxvjYopX4nxjWxx9FC6nchXmapmyug
fjcqLd/+1JL1drT9rcx15jPvdaA0rzA1m8ecdmAsxWmbyB4nyuJTo6/pfWtc
mOduO5vJgguLY+NXf+Yym3pQ/PFe8gpZ4oblQY6xnhxyQxW83vxWQvN7Mcln
GnzkdC/0SkM7yJ4+HNly8/Dv1TS/H+WJqRsRstAP2R3nZAfZ5MGbvs/DO8mS
AZil6sAqcmgABy5VhxNimj+IhV8/Rvzk9CD4Kl3mDNnjRXa0ZwLkGh8+PJx5
up4s+GALvX82T//RdBl7vkhHJ8iSIVhreUOAHBrC913Zwa4l/wMJTfEp
           
           "]]}, {}}, {{}, {}, 
         {Hue[0.67, 0.6, 0.6], Dashing[{Small, Small}], 
          LineBox[CompressedData["
1:eJxTTMoPSmViYGAwAWIQvUzf5sH1/Vr2DGDwwP5Z5+cZup0RDjD+I+5vb7Q7
M+D8iaUpfmETK+H8N+FmfNb/muB8vlfXls4R6YTzOwX0bgqv74fzdfxOJce+
mQTn29+7scLaeRqcf2mF6bGmrplwPr+a1MHEmXPg/Iq3Nzu9X82H849uFpiR
1rgQYX9f9PXbrIvh/FzeKbVhq5fA+YppE4TmmiyD818nV/G9vLcczv9a112W
2bgSzg8pTji7lX01nH+SR7mbff0aOH9y/UpzVat1cH7xdFlvj2fr4XyvtJin
/kc3wPktb7vnJHZuhPM93Y3Yv8VugvN39lplFqhsRtiXFMbI+hzBT+F66SOz
awucv3Le3X7J+q1wfiWrZ9vMkG1w/stfxzcZq22H85nvrri2+SWCv3Iiw7pt
e3fA+T+NdtXMb96J0J/U3rjIdRfC/tTTlhoSu+H8zpDCl5PvIPiWYn0+TRv3
wPlTjvAsD6vYC+f3M843d7XeB+eLCq6o3sa3H8535RXeznsFwWfI+3Xpc8gB
OH+dTOnTt3sR/I0HF3y+JX8Qzv91vj2aswvBn3FFfr/WWwS/bcFB20i/Q3D+
rqtyYie3I/jOjLqvtKUOw/nLWvd9FA1E8Dm4An7+b0fwAUB+A9k=
           "]]}}},
       AspectRatio->NCache[2^Rational[-1, 2], 0.7071067811865475],
       Axes->True,
       AxesLabel->{None, None},
       AxesOrigin->{0, 0.39},
       BaseStyle->{FontFamily -> "Helvetica", FontSize -> 14},
       Epilog->{
         InsetBox[
          FormBox[
           StyleBox["\"D\"", 14, Bold, StripOnInput -> False], 
           TraditionalForm], 
          Scaled[{0.05, 0.93}]], 
         GeometricTransformationBox[
          InsetBox[
           FormBox[
            StyleBox["\"\"", 14, StripOnInput -> False], TraditionalForm], 
           Scaled[{-0.15, 0.5}]], {{{0, -1}, {1, 0}}, Center}]},
       Frame->{True, True, False, False},
       FrameLabel->{
         FormBox["\"Generation\"", TraditionalForm], 
         FormBox["\"\"", TraditionalForm]},
       FrameStyle->{{
          GrayLevel[0], 
          Thickness[0.006]}, {
          GrayLevel[0], 
          Thickness[0.006]}, None, None},
       FrameTicks->{{{0, 
           FormBox["0", TraditionalForm], {0, 0.01}}, {200, 
           FormBox["200", TraditionalForm], {0, 0.01}}, {400, 
           FormBox["400", TraditionalForm], {0, 0.01}}, {600, 
           FormBox["600", TraditionalForm], {0, 0.01}}, {800, 
           FormBox["800", TraditionalForm], {0, 0.01}}, {1000, 
           FormBox["1000", TraditionalForm], {0, 0.01}}}, {{0.4, 
           FormBox["0.4`", TraditionalForm], {0, 0.01}}, {0.5, 
           FormBox["0.5`", TraditionalForm], {0, 0.01}}, {
          0.6000000000000001, 
           FormBox["0.6000000000000001`", TraditionalForm], {0, 0.01}}}},
       FrameTicksStyle->{{
          Directive[FontColor -> GrayLevel[1]], 
          Directive[
           GrayLevel[0], 
           Thickness[0.006]]}, {
          Directive[
           GrayLevel[0], 
           Thickness[0.006]], 
          Directive[
           GrayLevel[0], 
           Thickness[0.006]]}},
       ImagePadding->{{50, 10}, {50, 10}},
       ImageSize->
        NCache[{360, 180 2^Rational[1, 2]}, {360, 254.55844122715712`}],
       Method->{},
       PlotRange->{{0, 981.}, {0.39, 0.61}},
       PlotRangeClipping->False,
       PlotRangePadding->0], 
      NCache[{480, Rational[1, 2] (120 - 540 2^Rational[1, 2])}, {
       480, -321.8376618407357}], ImageScaled[{0.5, 0.5}], 
      NCache[{360, 180 2^Rational[1, 2]}, {360, 254.55844122715712`}]]}}, {}},
  
  ContentSelectable->True,
  Epilog->{},
  ImageSize->700,
  PlotRangePadding->{6, 5}]], "Output",
 CellChangeTimes->{
  3.694953558237286*^9, 3.70690994660074*^9, 3.706909995077015*^9, 
   3.706973515449692*^9, 3.70715037080338*^9, 3.708132351747039*^9, {
   3.7081327042028103`*^9, 3.708132746732424*^9}, {3.708132777609682*^9, 
   3.7081328157712297`*^9}, {3.708132942994953*^9, 3.708132969931809*^9}, {
   3.708133030126363*^9, 3.708133042396922*^9}, {3.708133863083106*^9, 
   3.708133868291748*^9}, {3.708133948486723*^9, 3.708133970064211*^9}, 
   3.7081341174734707`*^9, {3.708134181818246*^9, 3.70813427477697*^9}, 
   3.708134326402175*^9, 3.708134517321362*^9, 3.708134589140747*^9, {
   3.708134633630024*^9, 3.708134643851256*^9}, 3.708134794100601*^9, 
   3.708134888230279*^9, {3.708134947968442*^9, 3.7081350258821373`*^9}, 
   3.7081350637587852`*^9, 3.708135183241974*^9, {3.708135285797*^9, 
   3.708135313965125*^9}, 3.7081759013564043`*^9, 3.708176040206888*^9, 
   3.7084543737866096`*^9, 3.708454533588326*^9, 3.7084545724551086`*^9, {
   3.708454622090561*^9, 3.708454649463277*^9}, {3.708685401296652*^9, 
   3.708685422926898*^9}, 3.708685468065504*^9, {3.70889722398228*^9, 
   3.708897232540797*^9}, 3.709562175264777*^9, 3.709562237408505*^9, 
   3.709571098469236*^9, 3.7095711467329206`*^9, 3.7095711973328037`*^9, 
   3.709571285127379*^9, {3.7095713176896667`*^9, 3.7095713487731237`*^9}, 
   3.710688540715963*^9, 3.710693726072757*^9, 3.7106941623933487`*^9, 
   3.710694963792905*^9, 3.710694998542272*^9, 3.710695032126519*^9, 
   3.710699318720676*^9, 3.71069970315266*^9, 3.710699742716146*^9, 
   3.7106998836624928`*^9, 3.710700142533288*^9, 3.710702396828559*^9},
 ExpressionUUID -> "3c889f32-166d-4634-bc22-a457f92516af"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
Evaluator->"Local2",
WindowSize->{1280, 752},
WindowMargins->{{1280, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 100, 1, 92, "Title"],
Cell[CellGroupData[{
Cell[704, 27, 216, 3, 80, "Section"],
Cell[923, 32, 760, 18, 80, "Input"],
Cell[1686, 52, 2276, 62, 182, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[3999, 119, 223, 3, 50, "Section"],
Cell[CellGroupData[{
Cell[4247, 126, 207, 3, 44, "Subsection"],
Cell[4457, 131, 117, 1, 30, "Text"],
Cell[4577, 134, 698, 20, 36, "Input"],
Cell[5278, 156, 178, 2, 30, "Text"],
Cell[5459, 160, 1285, 32, 57, "Input"],
Cell[6747, 194, 325, 6, 30, "Text"],
Cell[7075, 202, 737, 17, 55, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[7849, 224, 152, 2, 36, "Subsection"],
Cell[8004, 228, 176, 2, 30, "Text"],
Cell[8183, 232, 720, 17, 34, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[8940, 254, 155, 2, 36, "Subsection"],
Cell[9098, 258, 124, 1, 30, "Text"],
Cell[9225, 261, 707, 18, 34, "Input"],
Cell[9935, 281, 246, 3, 30, "Text"],
Cell[10184, 286, 504, 12, 34, "Input"],
Cell[10691, 300, 355, 6, 30, "Text"],
Cell[11049, 308, 3821, 76, 140, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[14907, 389, 156, 2, 36, "Subsection"],
Cell[15066, 393, 123, 1, 30, "Text"],
Cell[15192, 396, 1107, 34, 36, "Input"],
Cell[16302, 432, 165, 2, 30, "Text"],
Cell[16470, 436, 1522, 44, 80, "Input"],
Cell[17995, 482, 651, 10, 68, "Text"],
Cell[18649, 494, 840, 24, 55, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[19526, 523, 146, 2, 36, "Subsection"],
Cell[19675, 527, 169, 2, 30, "Text"],
Cell[19847, 531, 1547, 44, 77, "Input"],
Cell[CellGroupData[{
Cell[21419, 579, 178, 2, 35, "Subsubsection"],
Cell[21600, 583, 28228, 698, 1609, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[49865, 1286, 262, 5, 29, "Subsubsection"],
Cell[50130, 1293, 412, 7, 50, "Text"],
Cell[50545, 1302, 114, 1, 30, "Text"],
Cell[50662, 1305, 831, 20, 178, "Input"],
Cell[51496, 1327, 213, 4, 31, "Text"],
Cell[51712, 1333, 887, 29, 63, "Input"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52660, 1369, 462, 6, 80, "Section"],
Cell[CellGroupData[{
Cell[53147, 1379, 240, 5, 44, "Subsection"],
Cell[CellGroupData[{
Cell[53412, 1388, 254, 3, 35, "Subsubsection"],
Cell[53669, 1393, 2481, 71, 137, "Input"],
Cell[56153, 1466, 1737, 47, 97, "Input"],
Cell[57893, 1515, 3606, 75, 200, "Input"],
Cell[61502, 1592, 10853, 273, 336, "Input"],
Cell[CellGroupData[{
Cell[72380, 1869, 385, 8, 28, "Input"],
Cell[72768, 1879, 3253, 66, 63, "Output"]
}, Open  ]],
Cell[76036, 1948, 2735, 69, 131, "Input"],
Cell[78774, 2019, 155, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[78954, 2025, 621, 13, 28, "Input"],
Cell[79578, 2040, 1105, 18, 28, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[80732, 2064, 279, 4, 29, "Subsubsection"],
Cell[81014, 2070, 2715, 51, 137, "Input"],
Cell[83732, 2123, 257, 5, 28, "Input"],
Cell[83992, 2130, 423, 8, 30, "Text"],
Cell[84418, 2140, 97846, 1886, 4245, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[182301, 4031, 222, 3, 29, "Subsubsection"],
Cell[182526, 4036, 319, 6, 30, "Text"],
Cell[182848, 4044, 2223, 45, 137, "Input"],
Cell[185074, 4091, 255, 5, 28, "Input"],
Cell[185332, 4098, 112324, 2165, 4636, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[297693, 6268, 222, 3, 29, "Subsubsection"],
Cell[297918, 6273, 367, 6, 30, "Text"],
Cell[298288, 6281, 2216, 45, 137, "Input"],
Cell[300507, 6328, 255, 5, 28, "Input"],
Cell[300765, 6335, 97794, 1900, 4262, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[398596, 8240, 218, 3, 29, "Subsubsection"],
Cell[398817, 8245, 218, 4, 30, "Text"],
Cell[399038, 8251, 2339, 46, 137, "Input"],
Cell[401380, 8299, 189, 4, 28, "Input"],
Cell[401572, 8305, 114827, 2212, 4653, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[516436, 10522, 170, 2, 29, "Subsubsection"],
Cell[516609, 10526, 153, 2, 30, "Text"],
Cell[516765, 10530, 3118, 82, 74, "Input"],
Cell[519886, 10614, 20236, 376, 947, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[540171, 10996, 289, 6, 44, "Subsection"],
Cell[CellGroupData[{
Cell[540485, 11006, 254, 3, 35, "Subsubsection"],
Cell[540742, 11011, 2534, 72, 137, "Input"],
Cell[543279, 11085, 1840, 48, 97, "Input"],
Cell[545122, 11135, 3684, 76, 200, "Input"],
Cell[548809, 11213, 92, 1, 30, "Text"],
Cell[548904, 11216, 10948, 275, 336, "Input"],
Cell[559855, 11493, 93, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[559973, 11498, 438, 9, 28, "Input"],
Cell[560414, 11509, 3294, 66, 70, "Output"]
}, Open  ]],
Cell[563723, 11578, 106, 1, 30, "Text"],
Cell[563832, 11581, 2792, 70, 131, "Input"],
Cell[566627, 11653, 206, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[566858, 11660, 644, 12, 28, "Input"],
Cell[567505, 11674, 1132, 19, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[568686, 11699, 370, 5, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[569081, 11708, 1254, 31, 137, "Input"],
Cell[570338, 11741, 35476, 878, 709, "Output"]
}, Open  ]],
Cell[605829, 12622, 452, 8, 28, "Input"],
Cell[606284, 12632, 499, 9, 30, "Text"],
Cell[606786, 12643, 107408, 2086, 4664, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[714231, 14734, 323, 4, 35, "Subsubsection"],
Cell[714557, 14740, 1306, 32, 137, "Input"],
Cell[715866, 14774, 403, 7, 28, "Input"],
Cell[716272, 14783, 469, 8, 30, "Text"],
Cell[716744, 14793, 110408, 2163, 4585, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[827189, 16961, 372, 5, 29, "Subsubsection"],
Cell[827564, 16968, 1288, 32, 137, "Input"],
Cell[828855, 17002, 549, 9, 28, "Input"],
Cell[829407, 17013, 518, 9, 30, "Text"],
Cell[829928, 17024, 106283, 2064, 4622, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[936248, 19093, 325, 4, 29, "Subsubsection"],
Cell[936576, 19099, 1283, 32, 137, "Input"],
Cell[937862, 19133, 454, 8, 28, "Input"],
Cell[938319, 19143, 519, 9, 30, "Text"],
Cell[938841, 19154, 111663, 2192, 4577, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1050541, 21351, 170, 2, 29, "Subsubsection"],
Cell[1050714, 21355, 153, 2, 30, "Text"],
Cell[1050870, 21359, 3124, 82, 74, "Input"],
Cell[1053997, 21443, 18596, 349, 896, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1072642, 21798, 98, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[1072765, 21803, 199, 3, 35, "Subsubsection"],
Cell[1072967, 21808, 6812, 173, 998, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[1079816, 21986, 245, 3, 29, "Subsubsection"],
Cell[1080064, 21991, 7647, 183, 998, "Input"]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[1087760, 22180, 93, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[1087878, 22185, 640, 10, 35, "Subsubsection"],
Cell[1088521, 22197, 43115, 901, 2392, "Input"],
Cell[1131639, 23100, 42011, 892, 2528, "Input"],
Cell[1173653, 23994, 20918, 465, 1780, "Input"],
Cell[1194574, 24461, 20896, 459, 1797, "Input"],
Cell[CellGroupData[{
Cell[1215495, 24924, 1396, 37, 165, "Input"],
Cell[1216894, 24963, 50026, 1011, 498, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
