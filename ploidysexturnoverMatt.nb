(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    297520,       8177]
NotebookOptionsPosition[    281257,       7661]
NotebookOutlinePosition[    281667,       7679]
CellTagsIndexPosition[    281624,       7676]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Sperm/pollen competition drives sex chromosome turnover \
\>", "Title",
 CellChangeTimes->{{3.6756461584547977`*^9, 3.675646190672323*^9}, {
   3.675691343813216*^9, 3.675691344643425*^9}, {3.675718324413807*^9, 
   3.6757183349582043`*^9}, {3.675719587684537*^9, 3.675719616196001*^9}, 
   3.6759056672964783`*^9, 3.676676533093017*^9, 3.677430541400485*^9}],

Cell["Michael Scott & Matthew Osmond", "Subtitle",
 CellChangeTimes->{{3.6756909919076443`*^9, 3.675690999875959*^9}}],

Cell["\<\
Inspired by van Doorn & Kirkpatrick 2007 (Nature 449:909), but with \
sperm/pollen competition as well, which we are hoping removes the need for \
sexually antagonistic selection to drive sex chromosome turnover and XY -> ZW \
transitions.\t\
\>", "Text",
 CellChangeTimes->{{3.675719638233714*^9, 3.675719730889935*^9}, {
  3.676719364202313*^9, 3.676719366377921*^9}, {3.6767206112063913`*^9, 
  3.6767206140162153`*^9}, {3.677350016434373*^9, 3.67735002317059*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["XY invasion", "Title",
 CellChangeTimes->{{3.677358394688487*^9, 3.67735839655757*^9}}],

Cell[CellGroupData[{

Cell["Recursions", "Section",
 CellChangeTimes->{{3.6756910197792797`*^9, 3.675691024113359*^9}, {
   3.67569412935745*^9, 3.6756941314240303`*^9}, {3.675707349839982*^9, 
   3.675707351884247*^9}, {3.675709974013658*^9, 3.675709982915987*^9}, {
   3.6757923469668207`*^9, 3.675792350124728*^9}, 3.676676690696854*^9}],

Cell["\<\
We consider three loci: 1) a diallelic autosomal locus, 2) an original \
diallelic sex-determining locus, and 3) a novel diallelic sex-determining \
locus. We assume that most gametes have the null/wild-type allele at the \
novel sex-determining locus, but a few have a new mutation y at this locus, \
which is masculinizing and is dominant over the original diallelic \
sex-determining locus (making that locus superfluous). 

Definitions:

Let XAf be the frequency of haploid genotypes in eggs with allele A at the \
diallelic autosomal locus and the null allele at the novel sex-determining \
locus (these necessarily have the X allele at the original sex-determining \
locus).
Let XAm be the frequency of haploid genotypes in gametes/pollen from males \
with allele A at the diallelic autosomal locus, the X allele at the original \
diallelic sex-determining locus, and the null allele at the novel \
sex-determining locus. 
Let YA be the frequency of haploid genotypes in gametes/pollen from males \
with allele A at the diallelic autosomal locus, the Y allele at the original \
diallelic sex-determining locus, and the null allele at the novel \
sex-determining locus. 

Let XAyf be the frequency of of haploid genotypes in eggs with allele A at \
the diallelic autosomal locus and the mutant y allele at the novel diallelic \
sex-determining locus (this can only happen if the mutation arises during the \
haploid stage, otherwise the y mutation would have made the diploid parent \
male).
Let XAym be the frequency of of haploid genotypes in gametes/pollen from \
males with allele A at the diallelic autosomal locus, the X allele at the \
original sex-determining locus, and the mutant y allele at the novel \
diallelic sex-determining locus.
Let YAy be the frequency of of haploid genotypes in gametes/pollen from males \
with allele A at the diallelic autosomal locus, the Y allele at the original \
sex-determining locus, and the mutant y allele at the novel diallelic \
sex-determining locus.

Exhanging A for a (e.g., Xaf) gives the frequency of haploid genotypes in \
gametes from that sex with the same alleles at the sex-determing loci and \
allele a at the autosomal locus. \
\>", "Text",
 CellChangeTimes->{{3.675646210075425*^9, 3.6756462139879293`*^9}, {
   3.675692881948024*^9, 3.675692905462323*^9}, {3.675702634397826*^9, 
   3.6757026600570383`*^9}, {3.675710000498989*^9, 3.675710437600037*^9}, {
   3.6757106247367887`*^9, 3.675710626158669*^9}, {3.675792380024247*^9, 
   3.6757924424434967`*^9}, {3.6766767101519136`*^9, 3.676676821916243*^9}, {
   3.676676854671156*^9, 3.676676936090798*^9}, {3.676676969927855*^9, 
   3.6766771026976233`*^9}, {3.6766771405687523`*^9, 3.676677267000321*^9}, {
   3.6766773144445467`*^9, 3.676677512953319*^9}, {3.676677557552327*^9, 
   3.676677565011045*^9}, {3.676677607075321*^9, 3.676677629948578*^9}, {
   3.676677676927281*^9, 3.6766777279544153`*^9}, 3.6766803851556997`*^9, {
   3.676718228269043*^9, 3.67671857645955*^9}, {3.6767186285743513`*^9, 
   3.676718650021899*^9}, {3.676718688595542*^9, 3.67671875039115*^9}, {
   3.676718828725091*^9, 3.6767189461231413`*^9}, {3.676718984364105*^9, 
   3.6767190359341183`*^9}}],

Cell[CellGroupData[{

Cell["Haploid selection", "Subsection",
 CellChangeTimes->{{3.676680390552682*^9, 3.676680393224043*^9}}],

Cell["\<\
We start with haploid selection, which occurs in sperm/pollen only. We assume \
male sperm/pollen compete for eggs, and that the allele at the autosomal \
locus determines their competitive ability (with relative fitnesses wA and \
wa). After selection on male gametes/pollen the frequencies of gametes in \
each sex are\
\>", "Text",
 CellChangeTimes->{{3.675646210075425*^9, 3.6756462139879293`*^9}, {
  3.675692881948024*^9, 3.675692905462323*^9}, {3.675702634397826*^9, 
  3.6757026600570383`*^9}, {3.675710000498989*^9, 3.675710437600037*^9}, {
  3.6757106247367887`*^9, 3.675710626158669*^9}, {3.675792380024247*^9, 
  3.6757924424434967`*^9}, {3.6766767101519136`*^9, 3.676676821916243*^9}, {
  3.676676854671156*^9, 3.676676936090798*^9}, {3.676676969927855*^9, 
  3.6766771026976233`*^9}, {3.6766771405687523`*^9, 3.676677267000321*^9}, {
  3.6766773144445467`*^9, 3.676677512953319*^9}, {3.676677557552327*^9, 
  3.676677565011045*^9}, {3.676677607075321*^9, 3.676677629948578*^9}, {
  3.676677676927281*^9, 3.6766777279544153`*^9}, {3.6766803851556997`*^9, 
  3.676680387344873*^9}, {3.676718778719702*^9, 3.676718805041526*^9}, {
  3.6767190397373533`*^9, 3.676719075005002*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"non", "-", 
    RowBox[{"mutant", " ", "eggs"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"XAfs", "=", "XAf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xafs", "=", "Xaf"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mutant", " ", "eggs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyfs", "=", "XAyf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xayfs", "=", "Xayf"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mean", " ", "fitness", " ", "of", " ", "male", " ", "gametes"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wbarHap", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"wA", " ", "XAm"}], "+", 
        RowBox[{"wa", " ", "Xam"}], "+", 
        RowBox[{"wA", " ", "XAym"}], "+", 
        RowBox[{"wa", " ", "Xaym"}]}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"wA", " ", "YA"}], "+", 
        RowBox[{"wa", " ", "Ya"}], "+", 
        RowBox[{"wA", " ", "YAy"}], "+", 
        RowBox[{"wa", " ", "Yay"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "male", " ", "gametes"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAms", "=", 
     RowBox[{"wA", " ", 
      RowBox[{"XAm", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xams", "=", 
     RowBox[{"wa", " ", 
      RowBox[{"Xam", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAs", "=", " ", 
     RowBox[{"wA", " ", 
      RowBox[{"YA", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yas", "=", " ", 
     RowBox[{"wa", " ", 
      RowBox[{"Ya", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mutant", " ", "male", " ", "gametes"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyms", "=", 
     RowBox[{"wA", " ", 
      RowBox[{"XAym", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xayms", "=", 
     RowBox[{"wa", " ", 
      RowBox[{"Xaym", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAys", "=", " ", 
     RowBox[{"wA", " ", 
      RowBox[{"YAy", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yays", "=", " ", 
     RowBox[{"wa", " ", 
      RowBox[{"Yay", "/", "wbarHap"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675887851245193*^9, 3.675887867834023*^9}, {
  3.676677282192428*^9, 3.6766773057008953`*^9}, {3.676677524747307*^9, 
  3.676677542756909*^9}, {3.676677580215856*^9, 3.676677603744999*^9}, {
  3.676677734415629*^9, 3.676677763178328*^9}, {3.6766778776357307`*^9, 
  3.676677877865404*^9}, {3.676682591464239*^9, 3.67668260166063*^9}}],

Cell["\<\
Check that frequencies sum to one in each sex after haploid selection:\
\>", "Text",
 CellChangeTimes->{{3.675691241028049*^9, 3.675691262904736*^9}, {
   3.675691499842326*^9, 3.675691508954028*^9}, {3.6757021446730413`*^9, 
   3.6757021466313477`*^9}, 3.67570266834774*^9, {3.675710454342794*^9, 
   3.675710458811872*^9}, {3.675711308941972*^9, 3.6757113347037287`*^9}, {
   3.676677885608522*^9, 3.6766778886629477`*^9}, {3.6766794933148947`*^9, 
   3.6766794941177*^9}, {3.676718813892243*^9, 3.676718822513054*^9}, {
   3.676719082993588*^9, 3.676719084080762*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{
    "XAms", "+", "Xams", "+", "YAs", "+", "Yas", "+", "XAyms", "+", "Xayms", 
     "+", "YAys", "+", "Yays"}]}], "//", "Factor"}], " ", 
  RowBox[{"(*", 
   RowBox[{"male", " ", "gametes"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{"XAfs", "+", "Xafs", "+", "XAyfs", "+", "Xayfs"}]}], "/.", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "XAf", "-", "Xayf", "-", "XAyf"}]}]}], "//", "Factor", 
  " ", 
  RowBox[{"(*", "eggs", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6757273549842978`*^9, 3.675727390607794*^9}, {
  3.6757276397063427`*^9, 3.6757276468903522`*^9}, {3.675792572534343*^9, 
  3.675792597101988*^9}, {3.676677804145811*^9, 3.676677826030532*^9}, {
  3.676677900791519*^9, 3.67667797831069*^9}, {3.676678537684183*^9, 
  3.676678542015664*^9}, {3.6767181309369173`*^9, 3.676718177588006*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, {
   3.675792579770925*^9, 3.675792597332528*^9}, 3.6758682510725803`*^9, 
   3.675884051627248*^9, 3.67588787251865*^9, 3.675894802110652*^9, 
   3.676652893924481*^9, {3.6766777919311743`*^9, 3.676677818579338*^9}, {
   3.6766779043654737`*^9, 3.676677939916746*^9}, 3.676678542469659*^9, 
   3.676718143248888*^9, 3.6767181780486*^9, 3.6767307837164783`*^9, 
   3.676747303149987*^9, 3.677430326838159*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, {
   3.675792579770925*^9, 3.675792597332528*^9}, 3.6758682510725803`*^9, 
   3.675884051627248*^9, 3.67588787251865*^9, 3.675894802110652*^9, 
   3.676652893924481*^9, {3.6766777919311743`*^9, 3.676677818579338*^9}, {
   3.6766779043654737`*^9, 3.676677939916746*^9}, 3.676678542469659*^9, 
   3.676718143248888*^9, 3.6767181780486*^9, 3.6767307837164783`*^9, 
   3.676747303149987*^9, 3.677430326839196*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Random mating", "Subsection",
 CellChangeTimes->{{3.676680401113572*^9, 3.676680402700843*^9}, {
  3.676680492557345*^9, 3.676680499967092*^9}}],

Cell["\<\
After random mating, the frequencies of the diploid genotypes are\
\>", "Text",
 CellChangeTimes->{{3.675646094888542*^9, 3.675646099390658*^9}, {
  3.675646217785323*^9, 3.675646250704771*^9}, {3.67570268816877*^9, 
  3.6757027045136023`*^9}, {3.676678026615859*^9, 3.676678026799192*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "females", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"XAXA", "=", 
     RowBox[{"XAfs", " ", "XAms"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAXa", "=", 
     RowBox[{
      RowBox[{"XAfs", " ", "Xams"}], "+", 
      RowBox[{"Xafs", " ", "XAms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaXa", "=", 
     RowBox[{"Xafs", " ", "Xams"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYA", "=", 
     RowBox[{"XAfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYa", "=", 
     RowBox[{"XAfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYA", "=", 
     RowBox[{"Xafs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYa", "=", 
     RowBox[{"Xafs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"X", "-", 
     RowBox[{"Xy", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyXA", "=", 
     RowBox[{
      RowBox[{"XAyfs", " ", "XAms"}], "+", 
      RowBox[{"XAfs", " ", "XAyms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyXa", "=", 
     RowBox[{
      RowBox[{"XAyfs", " ", "Xams"}], "+", 
      RowBox[{"Xafs", " ", "XAyms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAXay", "=", 
     RowBox[{
      RowBox[{"XAfs", " ", "Xayms"}], "+", 
      RowBox[{"Xayfs", " ", "XAms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XayXa", "=", 
     RowBox[{
      RowBox[{"Xayfs", " ", "Xams"}], "+", 
      RowBox[{"Xafs", " ", "Xayms"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"X", "-", 
     RowBox[{"Yy", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyYA", "=", 
     RowBox[{"XAyfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyYa", "=", 
     RowBox[{"XAyfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XayYA", "=", 
     RowBox[{"Xayfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XayYa", "=", 
     RowBox[{"Xayfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xy", "-", 
     RowBox[{"Y", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYAy", "=", 
     RowBox[{"XAfs", " ", "YAys"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYay", "=", 
     RowBox[{"XAfs", " ", "Yays"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYAy", "=", 
     RowBox[{"Xafs", " ", "YAys"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYay", "=", 
     RowBox[{"Xafs", " ", "Yays"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xy", "-", 
     RowBox[{"Xy", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyXAy", "=", 
     RowBox[{"XAyfs", " ", "XAyms"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyXay", "=", 
     RowBox[{
      RowBox[{"XAyfs", " ", "Xayms"}], "+", 
      RowBox[{"Xayfs", " ", "XAyms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XayXay", "=", 
     RowBox[{"Xayfs", " ", "Xayms"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xy", "-", 
     RowBox[{"Yy", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyYAy", "=", 
     RowBox[{"XAyfs", " ", "YAys"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyYay", "=", 
     RowBox[{"XAyfs", " ", "Yays"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XayYAy", "=", 
     RowBox[{"Xayfs", " ", "YAys"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XayYay", "=", 
     RowBox[{"Xayfs", " ", "Yays"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675646256909181*^9, 3.675646272815617*^9}, {
   3.675646370257011*^9, 3.67564637079287*^9}, {3.675646404699778*^9, 
   3.675646517567526*^9}, {3.675646573911735*^9, 3.675646591557143*^9}, {
   3.675646627619878*^9, 3.67564663177063*^9}, {3.675646667841331*^9, 
   3.675646747122738*^9}, {3.675691396390801*^9, 3.675691472391663*^9}, {
   3.675691536695323*^9, 3.675691538414453*^9}, {3.675691639085917*^9, 
   3.675691650195237*^9}, {3.675691682513646*^9, 3.675691696533524*^9}, {
   3.675691755294464*^9, 3.6756917629827957`*^9}, {3.675691824386702*^9, 
   3.675691852603437*^9}, {3.675692700413486*^9, 3.675692712195026*^9}, {
   3.67569296671769*^9, 3.675692967464675*^9}, {3.6756930389284983`*^9, 
   3.675693095368285*^9}, {3.675693137308187*^9, 3.675693184356132*^9}, {
   3.675693221908244*^9, 3.6756932234970217`*^9}, {3.675693268122773*^9, 
   3.675693270392726*^9}, {3.675693410576119*^9, 3.675693460007984*^9}, {
   3.675693492300033*^9, 3.675693533360964*^9}, 3.675693600152028*^9, {
   3.675702177145516*^9, 3.675702196152766*^9}, {3.6757023129704742`*^9, 
   3.675702317051364*^9}, {3.675792623150811*^9, 3.675792640133086*^9}, {
   3.675792682078307*^9, 3.675792755658676*^9}, {3.676678000228277*^9, 
   3.676678010863949*^9}, {3.6766780462191133`*^9, 3.676678234810701*^9}, 
   3.676678754031591*^9, {3.6766789631458273`*^9, 3.6766789866065598`*^9}}],

Cell["Check that they sum to one", "Text",
 CellChangeTimes->{{3.6766799013673363`*^9, 3.676679909235434*^9}, {
  3.676718082064983*^9, 3.6767180822254133`*^9}, {3.676718201654763*^9, 
  3.676718215366107*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "XAXA", "+", "XAXa", "+", "XaXa", "+", "XAYA", "+", "XAyXA", "+", "XAyXa", 
    "+", "XAXay", "+", "XayXa", "+", "XAyYA", "+", "XAyYa", "+", "XayYA", "+",
     "XayYa", "+", "XAYAy", "+", "XAYay", "+", "XaYAy", "+", "XaYay", "+", 
    "XAYa", "+", "XaYA", "+", "XaYa", "+", "XAyYAy", "+", "XAyYay", "+", 
    "XayYAy", "+", "XayYay", "+", "XAyXAy", "+", "XAyXay", "+", "XayXay"}], "/.", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "XAf", "-", "Xayf", "-", "XAyf"}]}]}], "//", 
  "Factor"}]], "Input",
 CellChangeTimes->{{3.676679556131309*^9, 3.676679588784375*^9}, {
   3.676679723115108*^9, 3.676679727031032*^9}, 3.6767181898012867`*^9}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.676679551603032*^9, 3.676679589135474*^9}, 
   3.676679727855962*^9, 3.676718190447926*^9, 3.6767307837675533`*^9, 
   3.676747303246192*^9, 3.67743032690273*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diploid selection", "Subsection",
 CellChangeTimes->{{3.676680414738653*^9, 3.676680417091516*^9}}],

Cell["\<\
We next model selection in diploids, which can differ among the sexes. Let \
FAA, FAa, and Faa be the relative fitnesses of females homozygous for allele \
A, heterozygous, or homozygous for allele a at the autosomal locus. Similarly \
we use MAA, MAa, and Maa in males. Then after diploid selection the \
frequencies of the diploid genotypes in each sex are\
\>", "Text",
 CellChangeTimes->{{3.6756467552456417`*^9, 3.67564676342205*^9}, {
  3.675702725992881*^9, 3.67570275267984*^9}, {3.6766799909212923`*^9, 
  3.676680143326602*^9}, {3.6767190998603992`*^9, 3.676719104009471*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"wbarF", "=", 
    RowBox[{
     RowBox[{"FAA", " ", "XAXA"}], "+", 
     RowBox[{"FAa", " ", "XAXa"}], "+", 
     RowBox[{"Faa", " ", "XaXa"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"mean", " ", "female", " ", "fitness"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "females", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXAs", "=", 
   RowBox[{"FAA", " ", 
    RowBox[{"XAXA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXas", "=", 
   RowBox[{"FAa", " ", 
    RowBox[{"XAXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaXas", "=", 
    RowBox[{"Faa", " ", 
     RowBox[{"XaXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"mean", " ", "male", " ", "fitness"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wbarM", "=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MAA", " ", "XAyXA"}], "+", 
     RowBox[{"MAa", 
      RowBox[{"(", 
       RowBox[{"XAyXa", "+", "XAXay"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XayXa"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAyXAy"}], "+", 
     RowBox[{"MAa", " ", "XAyXay"}], "+", 
     RowBox[{"Maa", " ", "XayXay"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAYA"}], "+", 
     RowBox[{"MAa", " ", 
      RowBox[{"(", 
       RowBox[{"XAYa", "+", "XaYA"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XaYa"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAyYA"}], "+", 
     RowBox[{"MAa", 
      RowBox[{"(", 
       RowBox[{"XAyYa", "+", "XayYA"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XayYa"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAYAy"}], "+", 
     RowBox[{"MAa", 
      RowBox[{"(", 
       RowBox[{"XAYay", "+", "XaYAy"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XaYay"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAyYAy"}], "+", 
     RowBox[{"MAa", 
      RowBox[{"(", 
       RowBox[{"XAyYay", "+", "XayYAy"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XayYay"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"non", "-", 
    RowBox[{"mutant", " ", "males"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XaYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaYas", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XaYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"X", "-", 
    RowBox[{"Xy", " ", "males"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyXA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAyXa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXays", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAXay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XayXas", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XayXa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"X", "-", 
    RowBox[{"Yy", " ", "males"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYAys", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAYAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYays", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAYay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYAys", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XaYAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaYays", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XaYay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Xy", "-", 
    RowBox[{"Y", " ", "males"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAyYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayYAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XayYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XayYas", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XayYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Xy", "-", 
    RowBox[{"Xy", " ", "males"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXAys", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyXAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXays", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAyXay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XayXays", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XayXay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Xy", "-", 
    RowBox[{"Yy", " ", "males"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYAys", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyYAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYays", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAyYay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayYAys", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XayYAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayYays", "=", 
   RowBox[{"Maa", " ", 
    RowBox[{"XayYay", "/", "wbarM"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646788099258*^9, 3.675646827315172*^9}, {
   3.675646906255657*^9, 3.6756471746197577`*^9}, {3.6756477305962267`*^9, 
   3.675647791098443*^9}, {3.675693609968581*^9, 3.6756936401475143`*^9}, {
   3.675702773030509*^9, 3.675702825109133*^9}, {3.6757958668524837`*^9, 
   3.675796079670739*^9}, {3.675796179417987*^9, 3.675796260462306*^9}, {
   3.675796480404418*^9, 3.675796481420582*^9}, {3.675796553441423*^9, 
   3.67579667834494*^9}, {3.6757967212634993`*^9, 3.67579673565335*^9}, {
   3.675796766370957*^9, 3.675796913595641*^9}, {3.675796952452533*^9, 
   3.675796955994008*^9}, {3.6757970625420837`*^9, 3.675797062966584*^9}, {
   3.675797156973634*^9, 3.675797157898295*^9}, {3.675797509731503*^9, 
   3.6757975122266283`*^9}, 3.6757987828785143`*^9, {3.675798997687969*^9, 
   3.675798999203364*^9}, {3.67668015749852*^9, 3.676680334093931*^9}}],

Cell["\<\
Check that frequencies of diploid genotypes in each sex sum to one after \
diploid selection:\
\>", "Text",
 CellChangeTimes->{{3.67569367511821*^9, 3.6756936990142593`*^9}, {
  3.675702840764554*^9, 3.675702847452877*^9}, {3.676680426109908*^9, 
  3.6766804300707493`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "females", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "==", 
     RowBox[{"XAXAs", "+", "XAXas", "+", "XaXas"}]}], "//", "Factor"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "males", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"1", "\[Equal]", 
     RowBox[{"(", 
      RowBox[{
      "XAyXAs", "+", "XAyXas", "+", "XAXays", "+", "XayXas", "+", 
       "\[IndentingNewLine]", "XAyXAys", "+", "XAyXays", "+", "XayXays", "+", 
       "\[IndentingNewLine]", "XAYAs", "+", "XAYas", "+", "XaYAs", "+", 
       "XaYas", "+", "\[IndentingNewLine]", "XAyYAs", "+", "XAyYas", "+", 
       "XayYAs", "+", "XayYas", "+", "\[IndentingNewLine]", "XAYAys", "+", 
       "XAYays", "+", "XaYAys", "+", "XaYays", "+", "\[IndentingNewLine]", 
       "XAyYAys", "+", "XAyYays", "+", "XayYAys", "+", "XayYays"}], ")"}]}], "//",
     "Factor"}]}]}]], "Input",
 CellChangeTimes->{{3.67569371292774*^9, 3.675693719435033*^9}, {
  3.675702830827154*^9, 3.675702835546769*^9}, {3.67570296812504*^9, 
  3.675702969573578*^9}, {3.675797014550261*^9, 3.675797032376533*^9}, {
  3.6757970695377398`*^9, 3.675797081268633*^9}, {3.6757973986437397`*^9, 
  3.6757974173271914`*^9}, {3.676680438445856*^9, 3.676680452334581*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9, 3.675727555437428*^9, 
   3.6757852556150913`*^9, 3.6757854222905197`*^9, 3.675797082754839*^9, 
   3.6757971609091988`*^9, {3.675797400992137*^9, 3.675797417649136*^9}, 
   3.675799061857813*^9, 3.675868267413929*^9, 3.675884064066042*^9, 
   3.6758879080912523`*^9, 3.675894820235918*^9, 3.6766528942324266`*^9, {
   3.6766804342274303`*^9, 3.676680453309816*^9}, 3.676730783818005*^9, 
   3.676747303361754*^9, 3.677430326952301*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9, 3.675727555437428*^9, 
   3.6757852556150913`*^9, 3.6757854222905197`*^9, 3.675797082754839*^9, 
   3.6757971609091988`*^9, {3.675797400992137*^9, 3.675797417649136*^9}, 
   3.675799061857813*^9, 3.675868267413929*^9, 3.675884064066042*^9, 
   3.6758879080912523`*^9, 3.675894820235918*^9, 3.6766528942324266`*^9, {
   3.6766804342274303`*^9, 3.676680453309816*^9}, 3.676730783818005*^9, 
   3.676747303361754*^9, 3.6774303270209208`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Meiosis", "Subsection",
 CellChangeTimes->{{3.676680482410777*^9, 3.676680483790394*^9}}],

Cell["\<\
Finally, meiosis occurs. We have three recombination rates to consider (we \
assume no interference):

r: the recombination rate between the autosomal locus and and the original \
sex-determining locus
R: the recombination rate between the novel sex-determining locus and the \
autosomal locus
\[Chi]: the recombination rate between the novel sex-determingin locus and \
the original sex-determing locus

We also assume that males produce \[Alpha]% of their gametes with the Y \
allele (original sex chromosome drive if \[Alpha]\[NotEqual]1/2).
The frequencies of haploid genotypes in gametes from each at the start of the \
next generation are then\
\>", "Text",
 CellChangeTimes->{{3.675647183205927*^9, 3.675647193439426*^9}, {
  3.675702857268779*^9, 3.6757029057817707`*^9}, {3.6766805501436253`*^9, 
  3.676680733528471*^9}, {3.676681004266163*^9, 3.67668101976959*^9}, {
  3.676681152971641*^9, 3.6766811584306507`*^9}, {3.676681458381565*^9, 
  3.676681458835539*^9}, {3.676719131041935*^9, 3.676719231166504*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "eggs", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"XAfprime", "=", 
     RowBox[{"XAXAs", "+", 
      RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xafprime", "=", 
     RowBox[{"XaXas", "+", 
      RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "X", " ", "from", " ", "males"}]}], "*)"}], "\n", 
   
   RowBox[{
    RowBox[{"XAmprime", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"XAYAs", "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYas", 
            RowBox[{"(", 
             RowBox[{"1", "-", "r"}], ")"}]}], "+", 
           RowBox[{"XaYAs", " ", 
            RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYAys", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
           RowBox[{"XAyYAs", " ", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYays", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
           
           RowBox[{"XayYAs", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XaYAys", 
            RowBox[{"(", "\[Chi]", ")"}]}], "+", 
           RowBox[{"XAyYas", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAyXAs", "/", "2"}], "+", 
        RowBox[{"XAyXas", " ", 
         RowBox[{"R", "/", "2"}]}], "+", 
        RowBox[{"XAXays", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ")"}]}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"Xamprime", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"XaYas", "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYas", 
            RowBox[{"(", "r", ")"}]}], "+", 
           RowBox[{"XaYAs", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XaYays", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
           RowBox[{"XayYas", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYays", 
            RowBox[{"(", "\[Chi]", ")"}]}], "+", 
           RowBox[{"XayYAs", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XaYAys", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
           
           RowBox[{"XAyYas", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XayXas", "/", "2"}], " ", "+", 
        RowBox[{"XAyXas", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
        RowBox[{"XAXays", " ", 
         RowBox[{
          RowBox[{"(", "R", ")"}], "/", "2"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "Y", " ", "from", " ", "males"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAprime", " ", "=", 
     RowBox[{"\[Alpha]", 
      RowBox[{"(", 
       RowBox[{"XAYAs", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYas", 
           RowBox[{"(", "r", ")"}]}], "+", 
          RowBox[{"XaYAs", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYAys", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}], "+", 
          RowBox[{"XAyYAs", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYays", " ", 
           RowBox[{"(", 
            RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XayYAs", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
          RowBox[{"XaYAys", 
           RowBox[{"(", 
            RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XAyYas", 
           RowBox[{"(", "\[Chi]", ")"}]}]}], ")"}]}], ")"}]}]}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{"Yaprime", "=", 
     RowBox[{"\[Alpha]", 
      RowBox[{"(", 
       RowBox[{"XaYas", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYas", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}], "+", 
          RowBox[{"XaYAs", " ", 
           RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XaYays", " ", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}], "+", 
          RowBox[{"XayYas", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYays", 
           RowBox[{"(", 
            RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XayYAs", 
           RowBox[{"(", "\[Chi]", ")"}]}], "+", 
          RowBox[{"XaYAys", 
           RowBox[{"(", 
            RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XAyYas", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}]}], 
         ")"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xy", " ", "from", " ", "males"}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XAymprime", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"XAyYAys", "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAyYays", 
            RowBox[{"(", 
             RowBox[{"1", "-", "r"}], ")"}]}], "+", 
           RowBox[{"XayYAys", 
            RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYAys", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}], "+", 
           RowBox[{"XAyYAs", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYays", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XayYAs", 
            RowBox[{"(", "\[Chi]", ")"}]}], "+", 
           RowBox[{"XaYAys", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XAyYas", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}]}], 
          ")"}]}], ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAyXAs", "/", "2"}], "+", 
        RowBox[{"XAyXas", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
        RowBox[{"XAXays", " ", 
         RowBox[{
          RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", "XAyXAys", "+", 
        RowBox[{"XAyXays", "/", "2"}]}], ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Xaymprime", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"XayYays", "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAyYays", 
            RowBox[{"(", "r", ")"}]}], "+", 
           RowBox[{"XayYAys", 
            RowBox[{"(", 
             RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XaYays", " ", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}], "+", 
           RowBox[{"XayYas", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYays", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XayYAs", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
           
           RowBox[{"XaYAys", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XAyYas", " ", 
            RowBox[{"(", "\[Chi]", ")"}]}]}], ")"}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XayXas", "/", "2"}], " ", "+", 
        RowBox[{"XAyXas", " ", 
         RowBox[{
          RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", 
        RowBox[{"XAXays", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", "XayXays", "+", 
        
        RowBox[{"XAyXays", "/", "2"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Yy", " ", "from", " ", "males"}], "*)"}], "\n", 
   RowBox[{
    RowBox[{"YAyprime", " ", "=", 
     RowBox[{"\[Alpha]", 
      RowBox[{"(", 
       RowBox[{"XAyYAys", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAyYays", 
           RowBox[{"(", "r", ")"}]}], "+", 
          RowBox[{"XayYAys", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYAys", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
          RowBox[{"XAyYAs", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYays", " ", 
           RowBox[{"(", "\[Chi]", ")"}]}], "+", 
          RowBox[{"XayYAs", 
           RowBox[{"(", 
            RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XaYAys", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
          RowBox[{"XAyYas", " ", 
           RowBox[{"(", 
            RowBox[{"r", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"Yayprime", " ", "=", 
     RowBox[{"\[Alpha]", 
      RowBox[{"(", 
       RowBox[{"XayYays", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAyYays", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}], "+", 
          RowBox[{"XayYAys", 
           RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XaYays", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
          RowBox[{"XayYas", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYays", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
          RowBox[{"XayYAs", 
           RowBox[{"(", 
            RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XaYAys", 
           RowBox[{"(", "\[Chi]", ")"}]}], "+", 
          RowBox[{"XAyYas", 
           RowBox[{"(", 
            RowBox[{"R", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675799680833715*^9, 3.6757996941412067`*^9}, {
  3.676680531228826*^9, 3.676680535586874*^9}, {3.676680749579172*^9, 
  3.676680842544508*^9}}],

Cell["Check", "Text",
 CellChangeTimes->{{3.67668087010927*^9, 3.676680870535335*^9}, {
  3.676682191599547*^9, 3.676682193563279*^9}, {3.676682633503108*^9, 
  3.676682739077134*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAfprime", "+", "Xafprime"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{
   "XAmprime", "+", "Xamprime", "+", "XAymprime", "+", "Xaymprime", "+", 
    "YAprime", "+", "Yaprime", "+", "YAyprime", "+", "Yayprime"}]}], "//", 
  "Factor"}]}], "Input",
 CellChangeTimes->{{3.676680865590528*^9, 3.6766808676400948`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6757998422199907`*^9, 3.6758682703443737`*^9, 3.675884066601346*^9, 
   3.67588414320271*^9, 3.675887913157668*^9, 3.6758948233446608`*^9, 
   3.676652894392449*^9, 3.676680539830617*^9, {3.6766808544919558`*^9, 
   3.676680867990182*^9}, 3.6767307839290257`*^9, 3.676747303494995*^9, 
   3.677430327131768*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6757998422199907`*^9, 3.6758682703443737`*^9, 3.675884066601346*^9, 
   3.67588414320271*^9, 3.675887913157668*^9, 3.6758948233446608`*^9, 
   3.676652894392449*^9, 3.676680539830617*^9, {3.6766808544919558`*^9, 
   3.676680867990182*^9}, 3.6767307839290257`*^9, 3.676747303494995*^9, 
   3.677430327518462*^9}]
}, Open  ]],

Cell["\<\
Notice that we don\[CloseCurlyQuote]t have recursions for XAyf or Xayf \
because y is a dominant male determining gene, and hence all diploids with y \
are males.\
\>", "Text",
 CellChangeTimes->{{3.676720347512924*^9, 3.676720393041522*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Resident equilibrium (weak linkage)\
\>", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9, {3.675889497088314*^9, 3.675889497307007*^9}, {
   3.675897573374775*^9, 3.675897575830624*^9}, {3.675897716718397*^9, 
   3.6758977222283363`*^9}, 3.676682250170936*^9, 3.676682959070333*^9, {
   3.6767193867939043`*^9, 3.676719388460558*^9}, {3.677430341228395*^9, 
   3.6774303686203403`*^9}, {3.6774304031805677`*^9, 3.677430403812908*^9}, {
   3.6774307727226257`*^9, 3.677430773657724*^9}}],

Cell["\<\
We first assume that the neoY is absent \
\>", "Text",
 CellChangeTimes->{{3.675897612080282*^9, 3.675897623453624*^9}, {
  3.676719440380638*^9, 3.676719440800579*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subequil", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", "pXf"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xaf", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"1", "-", "pXf"}], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAm", "\[Rule]", 
      RowBox[{"pXm", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xam", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pXm"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YA", "\[Rule]", 
      RowBox[{"pY", "*", "\[Alpha]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Ya", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pY"}], ")"}], "*", "\[Alpha]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"XAyf", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xayf", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAym", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xaym", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"YAy", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Yay", "\[Rule]", "0"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675897631284259*^9, 3.675897659212982*^9}}],

Cell["\<\
where pXf is the frequency of A in non-mutant eggs, pXm is the frequency of A \
in gametes from males with an X allele, and pY is the frequency of A in \
gametes from males with a Y allele.\
\>", "Text",
 CellChangeTimes->{{3.676719569815831*^9, 3.676719650518496*^9}}],

Cell["\<\
We now wish to solve for the equilibrium frequencies of the haploid genotypes \
in gametes of each sex. Equilibrium is achieved when the following three \
equations are zero\
\>", "Text",
 CellChangeTimes->{{3.675694155902801*^9, 3.675694193760104*^9}, {
   3.6756944337868023`*^9, 3.6756944351881227`*^9}, {3.6757029847267847`*^9, 
   3.67570303405547*^9}, {3.675710696458521*^9, 3.675710706286772*^9}, 
   3.6758975924118633`*^9, {3.676719416278571*^9, 3.676719460360141*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqs", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"XAfprime", "-", "XAf"}], ",", "\[IndentingNewLine]", 
      RowBox[{"XAmprime", "-", "XAm"}], ",", "\[IndentingNewLine]", 
      RowBox[{"YAprime", "-", "YA"}]}], "\[IndentingNewLine]", "}"}], "/.", 
    "subequil"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675647987041369*^9, 3.67564802904979*^9}, {
   3.675650509895372*^9, 3.675650527299842*^9}, {3.6756941716513157`*^9, 
   3.6756941738671913`*^9}, {3.675694338488646*^9, 3.675694340978696*^9}, {
   3.675694394143187*^9, 3.6756944261522427`*^9}, 3.6756944751724463`*^9, 
   3.675702984727247*^9, {3.675703036868017*^9, 3.675703037688758*^9}, 
   3.67578824463701*^9, 3.675897781726954*^9}],

Cell["\<\
To simplify the analysis we assume weak selection in both haploids \
(sperm/pollen) and diploids\
\>", "Text",
 CellChangeTimes->{{3.675694205010009*^9, 3.675694211923259*^9}, 
   3.67570298472752*^9, {3.6757030454432507`*^9, 3.6757030568360033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weaksel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAm", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAm", " ", "sAm", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Maa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAf", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAf", " ", "sAf", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Faa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"wA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"t", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"wa", "\[Rule]", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67564806523287*^9, 3.675648221558539*^9}, {
   3.675694367971285*^9, 3.6756943845803022`*^9}, 3.6757029847280283`*^9}],

Cell["We can write the frequencies as Taylor series", "Text",
 CellChangeTimes->{{3.675707045047565*^9, 3.6757070543930063`*^9}, {
  3.675707367038864*^9, 3.675707370179316*^9}, {3.675711803871513*^9, 
  3.6757118112225847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frequenciessub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pXf", "\[Rule]", 
      RowBox[{"pXf0", "+", 
       RowBox[{"pXf1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pXm", "\[Rule]", 
      RowBox[{"pXm0", "+", 
       RowBox[{"pXm1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pY", "\[Rule]", 
      RowBox[{"pY0", "+", 
       RowBox[{"pY1", " ", "\[Epsilon]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675648297857716*^9, 3.6756483630660057`*^9}, 
   3.675648454638584*^9, 3.675702984736863*^9, {3.67589080409908*^9, 
   3.675890831274033*^9}}],

Cell["\<\
Without selection the recursions for the change in the frequencies are\
\>", "Text",
 CellChangeTimes->{{3.6757032054455214`*^9, 3.6757032697493563`*^9}, {
  3.6757098202812138`*^9, 3.675709824765788*^9}, {3.6757117765596933`*^9, 
  3.6757117850524673`*^9}, {3.675711818872109*^9, 3.6757118199810133`*^9}, {
  3.676719491260041*^9, 3.676719499308044*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs0", "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", "frequenciessub"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.675703197099375*^9, 3.675703198353765*^9}, {
   3.675703326603519*^9, 3.675703332003808*^9}, {3.67570336997014*^9, 
   3.675703373531238*^9}, {3.675707060003501*^9, 3.675707071963544*^9}, {
   3.675707629815399*^9, 3.675707668691402*^9}, {3.6757098279293118`*^9, 
   3.6757098635569563`*^9}, {3.675785533464711*^9, 3.675785543888385*^9}, {
   3.675788240589053*^9, 3.675788247183043*^9}, {3.67588972373911*^9, 
   3.675889783320355*^9}, {3.675890096427137*^9, 3.675890101281641*^9}, {
   3.6758901865547256`*^9, 3.6758902265295887`*^9}, {3.675890260937232*^9, 
   3.675890325465114*^9}, {3.6758908417717113`*^9, 3.675890848577783*^9}, 
   3.675897777999179*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf0"}], "+", "pXm0"}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", "pXm0"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pXf0", "-", 
       RowBox[{"pXf0", " ", "r"}], "+", 
       RowBox[{"pY0", " ", "r"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}]}], "+", 
    RowBox[{"pXm0", " ", "\[Alpha]"}]}], ",", 
   RowBox[{
    RowBox[{"pXf0", " ", "r", " ", "\[Alpha]"}], "-", 
    RowBox[{"pY0", " ", "r", " ", "\[Alpha]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675890101919662*^9, 3.675890196227337*^9, 3.675890226890559*^9, 
   3.67589032606896*^9, {3.675890843995223*^9, 3.675890848999341*^9}, 
   3.675897682731414*^9, 3.675897786473518*^9, 3.676652896277562*^9, 
   3.676719503589243*^9, 3.676730785004094*^9, 3.676747313168695*^9, 
   3.677430327671308*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675709831409095*^9, 3.6757098343025913`*^9}, {
  3.675710744701475*^9, 3.675710745621426*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"differenceEqs0", "\[Equal]", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"pXf0", ",", "pXm0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675709931730151*^9, 3.675709948227565*^9}, 
   3.675889715650866*^9, {3.6758903329476337`*^9, 3.675890333531021*^9}, {
   3.675890856683935*^9, 3.6758908599323187`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"pXf0", "\[Rule]", "pY0"}], ",", 
    RowBox[{"pXm0", "\[Rule]", "pY0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6757098363525476`*^9, {3.6757099323567266`*^9, 3.675709948639193*^9}, 
   3.675727587389184*^9, 3.675785430130021*^9, 3.67578825590738*^9, 
   3.675889716378837*^9, 3.6758897866812677`*^9, {3.67589020611733*^9, 
   3.675890228462432*^9}, 3.675890334827342*^9, {3.675890851304111*^9, 
   3.675890860292238*^9}, 3.675897787493493*^9, 3.676652896317733*^9, 
   3.676719506219842*^9, 3.676730785030355*^9, 3.676747313194071*^9, 
   3.6774303277025967`*^9}]
}, Open  ]],

Cell["\<\
So, with no selection, the equilibrium frequency of A in each gamete/pollen \
type is equal (and we call this pA).\
\>", "Text",
 CellChangeTimes->{{3.675703427939505*^9, 3.6757035626138153`*^9}, {
   3.675706719194449*^9, 3.675706765062245*^9}, 3.67570996472328*^9, {
   3.6757107664993973`*^9, 3.675710849444377*^9}}],

Cell["\<\
Now, looking at only the first order selection terms, the recursions for the \
change in frequency of A in each gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.67570356712366*^9, 3.675703572187316*^9}, {
  3.67570609431063*^9, 3.675706097287983*^9}, {3.6757069069525433`*^9, 
  3.6757069072532797`*^9}, {3.67571091918222*^9, 3.6757109367564697`*^9}, {
  3.675711772412171*^9, 3.67571177325072*^9}, {3.675716463608975*^9, 
  3.67571647265489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
      ",", "\[Epsilon]", ",", "Factor"}], "]"}], "/.", 
    RowBox[{"pY0", "\[Rule]", "pA"}]}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757068495866413`*^9, 3.6757068907711554`*^9}, {
   3.6757069302403297`*^9, 3.675706982461239*^9}, {3.675707087605297*^9, 
   3.6757071228419533`*^9}, {3.67570718969317*^9, 3.675707319107386*^9}, {
   3.675707511314725*^9, 3.675707512612761*^9}, {3.675710885258552*^9, 
   3.675710885357044*^9}, {3.675711221036006*^9, 3.675711227798399*^9}, {
   3.675788237526182*^9, 3.6757882495037823`*^9}, {3.67588983758741*^9, 
   3.675889846791771*^9}, {3.675890066524867*^9, 3.67589008440499*^9}, {
   3.675890872602395*^9, 3.6758908784129057`*^9}, 3.675891388889962*^9, 
   3.675897774490415*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf1"}], "+", "pXm1", "+", 
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}]}], ")"}], " ", "\[Epsilon]"}], 
   ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf1"}], "+", "pXm1", "+", 
      RowBox[{"pXf1", " ", "r"}], "-", 
      RowBox[{"pY1", " ", "r"}], "-", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
      RowBox[{"pA", " ", "r", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", "\[Epsilon]"}], ",", 
   
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pXf1", " ", "r"}], "-", 
      RowBox[{"pY1", " ", "r"}], "+", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}], "-", 
      RowBox[{"pA", " ", "r", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], ")"}], " ", 
    "\[Alpha]", " ", "\[Epsilon]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675706852317442*^9, 3.675706918829287*^9}, {
   3.675706950931774*^9, 3.675706982932413*^9}, {3.6757070910767508`*^9, 
   3.675707123327277*^9}, {3.6757071925330353`*^9, 3.675707319486848*^9}, 
   3.675707513296742*^9, 3.67570768217498*^9, {3.675710857628578*^9, 
   3.675710885875184*^9}, {3.675711222477412*^9, 3.67571122814371*^9}, 
   3.67572758892033*^9, 3.675785431200643*^9, 3.6757882566822844`*^9, {
   3.6758898385316772`*^9, 3.675889853071372*^9}, 3.67589008578434*^9, 
   3.675890878782188*^9, 3.6758913896085997`*^9, 3.675897788776071*^9, 
   3.676652896382719*^9, 3.676719670536849*^9, 3.676730785076564*^9, 
   3.676747313246613*^9, 3.677430327752997*^9}]
}, Open  ]],

Cell["\<\
Instead of solving for the first order genotype frequencies we will instead \
solve for the difference in the frequency of A in the different gamete/pollen \
types.\
\>", "Text",
 CellChangeTimes->{{3.6757135825548286`*^9, 3.675713633862471*^9}, 
   3.6757138892769423`*^9, {3.675716482887339*^9, 3.6757164842940083`*^9}}],

Cell["\<\
The difference in the frequency of A with X in females and X in males is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.6757138909855633`*^9, 3.675713959445539*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfXm", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"pXf1", "\[Rule]", 
       RowBox[{"dpAXfXm", "+", "pXm1"}]}]}], ",", "dpAXfXm"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.67571264493021*^9, 3.675712689537509*^9}, {
   3.675712721625124*^9, 3.675712730987232*^9}, {3.6757136496293707`*^9, 
   3.6757136649001226`*^9}, {3.675716490314892*^9, 3.675716491532194*^9}, 
   3.675889959407155*^9, {3.6758909343383083`*^9, 3.675890951849391*^9}, {
   3.675891012447013*^9, 3.675891012934494*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfXm", "\[Rule]", 
   RowBox[{
    RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
    RowBox[{"6", " ", "hAf", " ", 
     SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
    RowBox[{"4", " ", "hAf", " ", 
     SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
    RowBox[{"pA", " ", "t"}], "-", 
    RowBox[{
     SuperscriptBox["pA", "2"], " ", "t"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675712649738289*^9, 3.675712661484269*^9}, 
   3.675712732353135*^9, 3.6757136656167507`*^9, 3.675716491898244*^9, 
   3.6757275909002647`*^9, 3.675785432660453*^9, 3.675788258653908*^9, {
   3.675889953796268*^9, 3.6758899597968283`*^9}, 3.675890959353971*^9, 
   3.6758910146488943`*^9, 3.6758913912775593`*^9, 3.676652896517932*^9, 
   3.676719687009862*^9, 3.67673078510373*^9, 3.676747313278569*^9, 
   3.677430327785718*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in males and Y is (at equilibrium \
to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713966791181*^9, 3.6757139830606413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXmY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"differenceEqs1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
        RowBox[{"pXf1", "\[Rule]", 
         RowBox[{"dpAXfXm", "+", "pXm1"}]}]}], "/.", "eqdpAXfXm"}], "/.", 
      RowBox[{"pXm1", "\[Rule]", 
       RowBox[{"dpAXmY", "+", "pY1"}]}]}], ",", "dpAXmY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.67589099313556*^9, 3.675891022927155*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXmY", "\[Rule]", 
   RowBox[{
    FractionBox["1", "r"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "r", " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "-", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6758910240913486`*^9, 3.6758913925003138`*^9, 
  3.676652896673917*^9, 3.676719700328567*^9, 3.6767307851363363`*^9, 
  3.6767473133453503`*^9, 3.677430327820009*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in females and Y is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713993050933*^9, 3.6757140012817707`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"pXf1", "\[Rule]", 
       RowBox[{"dpAXfY", "+", "pY1"}]}]}], ",", "dpAXfY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675891330267333*^9, 3.6758913402113733`*^9}, {
  3.675891370233397*^9, 3.675891383976934*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfY", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "hAm"}], " ", "pA", " ", "sAm"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{"3", " ", "hAm", " ", 
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"2", " ", "hAm", " ", 
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"pA", " ", "t"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "t"}], "+", 
     RowBox[{"pA", " ", "r", " ", "t"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], "r"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6758913358696117`*^9, 3.6758913405764227`*^9}, {
   3.675891373164547*^9, 3.675891393552059*^9}, 3.676652896714778*^9, 
   3.6767197055938177`*^9, 3.676730785170478*^9, 3.676747313408824*^9, 
   3.6774303279034367`*^9}]
}, Open  ]],

Cell["\<\
So then, to first order, the equilibrium frequencies of A in gametes of each \
type are\
\>", "Text",
 CellChangeTimes->{{3.6757175107821083`*^9, 3.675717533841239*^9}, {
  3.676719710630457*^9, 3.676719742495908*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpXf", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pXf0", "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXmY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXmY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675716895475359*^9, 3.675716900512623*^9}, {
  3.675717278127964*^9, 3.675717294591033*^9}, {3.675717351754582*^9, 
  3.675717366375647*^9}, {3.675717543006982*^9, 3.675717544667244*^9}, {
  3.6757178596731443`*^9, 3.675717863093356*^9}, {3.675891412682151*^9, 
  3.6758914137821283`*^9}, {3.675891837469037*^9, 3.6758918377885427`*^9}, {
  3.6758919471830606`*^9, 3.67589194867479*^9}, {3.675892368331646*^9, 
  3.675892370571282*^9}, {3.6759005334571*^9, 3.675900555296269*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
         RowBox[{"hAm", " ", "sAm"}], "-", 
         RowBox[{"pA", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "sAf"}], "+", "sAm", "-", 
            RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]", "-", 
            RowBox[{"pA", " ", "\[Epsilon]"}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.6757169011353207`*^9, 3.6757173669613256`*^9, 3.6757175450525827`*^9, 
   3.675717864205447*^9, 3.675727594742791*^9, 3.675785436211323*^9, 
   3.675788261479598*^9, 3.675891416424108*^9, 3.6758918774492893`*^9, 
   3.675891958442032*^9, 3.675892370898428*^9, 3.6758935648073273`*^9, {
   3.6759005418256493`*^9, 3.675900555878397*^9}, 3.6766528968029757`*^9, 
   3.676719745172724*^9, 3.676730785214003*^9, 3.676747313495171*^9, 
   3.677430327956324*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpXm", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pXm0", "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXfY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675891861515366*^9, 3.675891862891082*^9}, 
   3.675891954716195*^9, {3.675900536393208*^9, 3.6759005575923357`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pA"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.675891430280157*^9, 3.675891875421072*^9, 3.6758919608167343`*^9, 
   3.675892371780211*^9, 3.675893565662033*^9, {3.675900542474494*^9, 
   3.6759005587820673`*^9}, 3.67665289685354*^9, 3.676719746679064*^9, 
   3.6767307852581263`*^9, 3.676747313545011*^9, 3.677430328003676*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpY", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pY0", "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfY"}], "/.", 
    "eqdpAXfXm"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675717392424321*^9, 3.675717393210609*^9}, {
   3.675717465498665*^9, 3.675717499551214*^9}, {3.67571755307234*^9, 
   3.675717554018692*^9}, {3.6757178713638563`*^9, 3.675717873545209*^9}, {
   3.6758918717163763`*^9, 3.6758918726910467`*^9}, 3.675891956101635*^9, {
   3.675893391454796*^9, 3.675893392916779*^9}, {3.675900539553142*^9, 
   3.675900562666452*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.67571750048251*^9, 3.675717554350906*^9, 3.675717874008835*^9, 
   3.675727596078721*^9, 3.6757854378569937`*^9, 3.675788264699403*^9, 
   3.675891496222584*^9, 3.675891873049327*^9, 3.6758919565695257`*^9, 
   3.6758923723983088`*^9, 3.675893566346439*^9, {3.675900543007511*^9, 
   3.675900562976172*^9}, 3.6766528969178534`*^9, 3.6767197481332684`*^9, 
   3.676730785284531*^9, 3.676747313594681*^9, 3.677430328042471*^9}]
}, Open  ]],

Cell["The recursion for pA is given by", "Text",
 CellChangeTimes->{{3.675894756303364*^9, 3.675894761327495*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "XAfprime"}], "+", 
                  RowBox[{"XAmprime", "/", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Alpha]"}], ")"}]}], "+", 
                  RowBox[{"YAprime", "/", "\[Alpha]"}]}], ")"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "XAf"}], "+", 
                  RowBox[{"XAm", "/", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Alpha]"}], ")"}]}], "+", 
                  RowBox[{"YA", "/", "\[Alpha]"}]}], ")"}]}], "/.", 
               "weaksel"}], "/.", "subequil"}], "/.", 
             RowBox[{"pXf", "\[Rule]", "eqpXf"}]}], "/.", 
            RowBox[{"pXm", "\[Rule]", "eqpXm"}]}], "/.", 
           RowBox[{"pY", "\[Rule]", "eqpY"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
       "/", "4"}], ",", "\[Epsilon]", ",", "Simplify"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.676747262708866*^9, 3.676747274076159*^9}, {
  3.676747330606949*^9, 3.6767473331433496`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"hAf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
     RowBox[{"hAm", " ", "sAm"}], "-", 
     RowBox[{"pA", " ", 
      RowBox[{"(", 
       RowBox[{"sAf", "+", "sAm", "-", 
        RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], ")"}]}],
   "}"}]], "Output",
 CellChangeTimes->{3.6767472773426*^9, 3.67674731384459*^9, 
  3.677430328172258*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675894741095875*^9, 3.6758947449904137`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"equilpA", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"dpA", "\[Equal]", "0"}], ",", "pA"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6758947492346077`*^9, 3.675894750434639*^9}, {
  3.676723396822939*^9, 3.676723406826749*^9}, {3.6767473560551643`*^9, 
  3.6767473563988113`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"hAf", " ", "sAf"}], "+", 
       RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
      RowBox[{
       RowBox[{"-", "sAf"}], "+", 
       RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
       RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6758947512753477`*^9, 3.676652897209752*^9, 
  3.676719778646106*^9, 3.676723407402912*^9, 3.676730785446089*^9, 
  3.676747279137188*^9, 3.676747313942739*^9, 3.6767473573817453`*^9, 
  3.677430328195327*^9}]
}, Open  ]],

Cell["\<\
Notice that when t=0 we have equation \[OpenCurlyDoubleQuote]avgpASubs\
\[CloseCurlyDoubleQuote] in van Doorn & Kirkpatrick 2007 (SOM page 6). \
Sperm/pollen selection acts to increase the frequency of A (if selected for, \
t>0).\
\>", "Text",
 CellChangeTimes->{{3.675718177833785*^9, 3.6757182794849873`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Internal stability (weak linkage)\
\>", "Section",
 CellChangeTimes->{{3.675728118153309*^9, 3.6757281301025343`*^9}, {
   3.675898152172256*^9, 3.675898162531384*^9}, {3.676682354127939*^9, 
   3.676682359443681*^9}, {3.677430416430501*^9, 3.677430416814169*^9}, 
   3.677430777539423*^9}],

Cell["\<\
Here we use linear stability analysis to examine when the resident \
equilibrium (i.e., no mutants) derived above is stable.\
\>", "Text",
 CellChangeTimes->{{3.676720746264163*^9, 3.676720791609645*^9}}],

Cell["\<\
The Jacobian for the residents is\
\>", "Text",
 CellChangeTimes->{{3.676720780698885*^9, 3.676720799664399*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"matIntFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "XAf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "Xaf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "XAm"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "Xam"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "YA"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "Ya"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], "/.", "subequil"}], "//", 
    "Factor"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6757908602069187`*^9, 3.675790921689528*^9}, {
  3.676720802034553*^9, 3.676720813444828*^9}, {3.676720992038534*^9, 
  3.676720993999393*^9}, {3.676726517411701*^9, 3.6767265193317842`*^9}}],

Cell["\<\
From this we can derive the characteristic polynomial\
\>", "Text",
 CellChangeTimes->{{3.67672101846877*^9, 3.676721031016712*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyIntFull", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matIntFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "6", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675790963788534*^9, 3.6757909758461533`*^9}}],

Cell["\<\
Instead of examining when the non-trivial equilibrium (A not fixed or lost) \
is stable we will look for when the trivial equilibria (loss or fixation of \
A) are unstable.\
\>", "Text",
 CellChangeTimes->{{3.676721042012188*^9, 3.676721126032257*^9}}],

Cell["\<\
When A is fixed the characteristic polynomial with no selection gives \
eigenvalues\
\>", "Text",
 CellChangeTimes->{{3.676721132511098*^9, 3.6767211423017263`*^9}, {
  3.676721178371427*^9, 3.676721218756505*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"charpolyInt1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"charpolyIntFull", "/.", 
      RowBox[{"pXm", "\[Rule]", "1"}]}], "/.", 
     RowBox[{"pXf", "\[Rule]", "1"}]}], "/.", 
    RowBox[{"pY", "\[Rule]", "1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyInt1", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.676721152602626*^9, 3.6767211696108313`*^9}, {
  3.676721653986638*^9, 3.676721654917102*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}], "-", 
       SqrtBox[
        RowBox[{"9", "-", 
         RowBox[{"20", " ", "r"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}], "+", 
       SqrtBox[
        RowBox[{"9", "-", 
         RowBox[{"20", " ", "r"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.676721170257844*^9, 3.676721655215622*^9, 
  3.676730789272407*^9, 3.677430333671691*^9}]
}, Open  ]],

Cell["\<\
and \[Lambda]=1 is the leading eigenvalue.\
\>", "Text",
 CellChangeTimes->{{3.676721226033328*^9, 3.676721241288987*^9}}],

Cell["\<\
With weak selection first order term in the eigenvalues is\
\>", "Text",
 CellChangeTimes->{{3.676721201810499*^9, 3.6767212071148663`*^9}, {
  3.676721245455948*^9, 3.6767212760370197`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"charpolyInt1", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Lambda]", "\[Rule]", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Delta]\[Lambda]1fix", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}], "//",
    "Flatten"}]}]}], "Input",
 CellChangeTimes->{{3.6757905419305773`*^9, 3.67579059667633*^9}, {
  3.6757909951816072`*^9, 3.6757909952509527`*^9}, {3.676721441707623*^9, 
  3.6767214458346786`*^9}, {3.676721535301393*^9, 3.676721554454569*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "sAf"}], "+", 
      RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
      RowBox[{"hAm", " ", "sAm"}], "-", "t"}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.676721554821319*^9, 3.676730789299614*^9, 
  3.6774303337063103`*^9}]
}, Open  ]],

Cell["\<\
And so the fixation of A is unstable when this expression is positive.\
\>", "Text",
 CellChangeTimes->{{3.676721308204175*^9, 3.676721335598743*^9}}],

Cell["\<\
When A is lost the characteristic polynomial with no selection gives \
eigenvalues\
\>", "Text",
 CellChangeTimes->{{3.6767213474719133`*^9, 3.676721350576425*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"charpolyInt0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"charpolyIntFull", "/.", 
      RowBox[{"pXm", "\[Rule]", "0"}]}], "/.", 
     RowBox[{"pXf", "\[Rule]", "0"}]}], "/.", 
    RowBox[{"pY", "\[Rule]", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyInt0", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.675789475257841*^9, 3.675789495224863*^9}, {
   3.675790419784018*^9, 3.675790436109337*^9}, {3.675790707473653*^9, 
   3.6757907121912107`*^9}, 3.675790981141562*^9, {3.675791011580246*^9, 
   3.6757910160572977`*^9}, {3.676721363672165*^9, 3.676721374617257*^9}, {
   3.676721452992544*^9, 3.676721455943983*^9}, {3.676721499845089*^9, 
   3.676721500929879*^9}, 3.676721543612586*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}], "-", 
       SqrtBox[
        RowBox[{"9", "-", 
         RowBox[{"20", " ", "r"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}], "+", 
       SqrtBox[
        RowBox[{"9", "-", 
         RowBox[{"20", " ", "r"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6767213765070133`*^9, 3.676721456161497*^9, 
  3.676721501263238*^9, 3.676721544164434*^9, 3.676730789335022*^9, 
  3.677430333743013*^9}]
}, Open  ]],

Cell["\<\
With weak selection first order term in the eigenvalues is\
\>", "Text",
 CellChangeTimes->{3.676721390427958*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"charpolyInt0", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Lambda]", "\[Rule]", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Delta]\[Lambda]1loss", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}], "//",
    "Flatten"}]}]}], "Input",
 CellChangeTimes->{{3.6757905419305773`*^9, 3.67579059667633*^9}, {
   3.6757909951816072`*^9, 3.6757909952509527`*^9}, {3.675791030843678*^9, 
   3.6757910309227667`*^9}, {3.67672149489704*^9, 3.676721496462256*^9}, 
   3.676721546110467*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAf", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.675799455916547*^9, 3.6767214970605583`*^9, 
  3.6767215468807373`*^9, 3.67673078936864*^9, 3.677430333766693*^9}]
}, Open  ]],

Cell["\<\
And so the loss of A is unstable when this expression is positive.\
\>", "Text",
 CellChangeTimes->{{3.6767213979123573`*^9, 3.6767214015330763`*^9}}],

Cell["\<\
Combining the two results, the protected polymorphism (non-trivial \
equilibrium) requires that \
\>", "Text",
 CellChangeTimes->{{3.67579927992915*^9, 3.675799368289077*^9}, {
  3.676721410316127*^9, 3.676721427192442*^9}, {3.676721618600268*^9, 
  3.6767216187542257`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"0", "<", 
     RowBox[{"(", 
      RowBox[{"\[Delta]\[Lambda]1", "/.", "\[Delta]\[Lambda]1fix"}], ")"}]}], 
    "&&", 
    RowBox[{"0", "<", 
     RowBox[{"(", 
      RowBox[{"\[Delta]\[Lambda]1", "/.", "\[Delta]\[Lambda]1loss"}], 
      ")"}]}]}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.676721461333272*^9, 3.676721523574643*^9}, {
  3.676721568750682*^9, 3.67672161283843*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sAm", "<", "0"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", "<", "0"}], "&&", 
        RowBox[{"hAf", "<", 
         FractionBox[
          RowBox[{"sAf", "+", "sAm", "-", 
           RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
          RowBox[{"2", " ", "sAf"}]]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
          RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAf"}], "+", 
          RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
          RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", "\[Equal]", "0"}], "&&", 
        RowBox[{"hAm", "<", 
         FractionBox["1", "2"]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "hAm"}], " ", "sAm"}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAm"}], "+", 
          RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", ">", "0"}], "&&", 
        RowBox[{"hAf", ">", 
         FractionBox[
          RowBox[{"sAf", "+", "sAm", "-", 
           RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
          RowBox[{"2", " ", "sAf"}]]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
          RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAf"}], "+", 
          RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
          RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], ")"}], "||", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sAm", "\[Equal]", "0"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", "<", "0"}], "&&", 
        RowBox[{"hAf", "<", 
         FractionBox["1", "2"]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "hAf"}], " ", "sAf"}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAf"}], "+", 
          RowBox[{"hAf", " ", "sAf"}]}]}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", ">", "0"}], "&&", 
        RowBox[{"hAf", ">", 
         FractionBox["1", "2"]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "hAf"}], " ", "sAf"}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAf"}], "+", 
          RowBox[{"hAf", " ", "sAf"}]}]}]}], ")"}]}], ")"}]}], ")"}], "||", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sAm", ">", "0"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", "<", "0"}], "&&", 
        RowBox[{"hAf", "<", 
         FractionBox[
          RowBox[{"sAf", "+", "sAm", "-", 
           RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
          RowBox[{"2", " ", "sAf"}]]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
          RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAf"}], "+", 
          RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
          RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", "\[Equal]", "0"}], "&&", 
        RowBox[{"hAm", ">", 
         FractionBox["1", "2"]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "hAm"}], " ", "sAm"}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAm"}], "+", 
          RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", ">", "0"}], "&&", 
        RowBox[{"hAf", ">", 
         FractionBox[
          RowBox[{"sAf", "+", "sAm", "-", 
           RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
          RowBox[{"2", " ", "sAf"}]]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
          RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAf"}], "+", 
          RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
          RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.676721475856057*^9, 3.676721524066456*^9}, {
   3.676721557470851*^9, 3.6767216066382093`*^9}, 3.676730789436737*^9, 
   3.6774303338376017`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
External stability (weak linkage)\
\>", "Section",
 CellChangeTimes->{{3.675898184242074*^9, 3.675898192657653*^9}, {
   3.6766823621496687`*^9, 3.676682365402493*^9}, {3.676682824936212*^9, 
   3.676682839700041*^9}, 3.676721662499631*^9, {3.676726557160334*^9, 
   3.676726564889889*^9}, 3.677430339266128*^9, {3.677430417573669*^9, 
   3.6774304179742393`*^9}, 3.677430779660555*^9}],

Cell["\<\
Here we are interested in the ability of a rare y mutant to invade the \
non-mutant resident population at equilibrium.\
\>", "Text",
 CellChangeTimes->{{3.676720412976615*^9, 3.676720459024542*^9}, {
  3.676720582555089*^9, 3.676720586782763*^9}, {3.676721687580276*^9, 
  3.676721687767557*^9}, {3.6767265489351683`*^9, 3.676726549465045*^9}}],

Cell["\<\
Remember that we don\[CloseCurlyQuote]t have recursions for XAyf or Xayf \
because y is a dominant male determining gene. However, we allowed these \
genotypes to create zygotes so we can include them in the stability matrix \
(with frequencies of 0 at the start of the next generation). The Jacobian for \
the mutants is\
\>", "Text",
 CellChangeTimes->{{3.6758991929846497`*^9, 3.67589926406907*^9}, {
  3.67589934114139*^9, 3.6758993427645893`*^9}, {3.675900036907325*^9, 
  3.6759000483741083`*^9}, {3.676720403037026*^9, 3.676720404249701*^9}, {
  3.6767205532682467`*^9, 3.676720568189563*^9}, {3.676720627629078*^9, 
  3.676720646673503*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"matExtFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "XAyf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Xayf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "XAym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Xaym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "YAym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Yaym"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], "/.", "subequil"}], "//", 
    "Factor"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675899271627995*^9, 3.675899299216916*^9}, 
   3.676720301639617*^9, {3.676726501276018*^9, 3.676726501481125*^9}}],

Cell[TextData[{
 "It seems that Yy-bearing males have no effect on the invasion as they would \
have been males anyway (",
 StyleBox["because last two columns all zeros?",
  FontColor->RGBColor[1, 0, 0]],
 "). The inclusion of Xiyf is also irrelevant as mutations arising in gametes \
from females are in males in the next generation (",
 StyleBox["how do you see this?",
  FontColor->RGBColor[1, 0, 0]],
 "). "
}], "Text",
 CellChangeTimes->{{3.6759000512139807`*^9, 3.6759001148215*^9}, {
   3.676721768468625*^9, 3.67672179243963*^9}, 3.6767218319050303`*^9, {
   3.676721869719993*^9, 3.67672187700138*^9}, {3.676721932344289*^9, 
   3.676721977677863*^9}}],

Cell["\<\
The Jacobian gives the characteristic polynomial\
\>", "Text",
 CellChangeTimes->{{3.676720657206951*^9, 3.676720663725732*^9}, {
  3.676721991017548*^9, 3.676722004811944*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyExt", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matExtFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "6", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6758993091981916`*^9, 3.6758993092948217`*^9}}],

Cell[CellGroupData[{

Cell["\<\
Weak linkage (r and R of order ~1)\
\>", "Subsection",
 CellChangeTimes->{{3.676724285728964*^9, 3.676724301261125*^9}}],

Cell["\<\
Solving for the eigenvalues gives\
\>", "Text",
 CellChangeTimes->{{3.676720669392806*^9, 3.676720678062379*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyExt", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{
  3.676654631019518*^9, {3.676721706720666*^9, 3.67672170778559*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    FractionBox["1", 
     RowBox[{"2", " ", "\[Alpha]"}]]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    FractionBox[
     RowBox[{"1", "-", "R"}], 
     RowBox[{"2", " ", "\[Alpha]"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675899316283032*^9, 3.675899557775223*^9, 3.676652904283071*^9, 
   3.676654502189295*^9, 3.676654631667169*^9, {3.676721708102419*^9, 
   3.676721712902296*^9}, 3.6767260465648527`*^9, 3.676730790136454*^9, 
   3.67674740047393*^9, 3.677430334547112*^9}]
}, Open  ]],

Cell[TextData[{
 "The zero order effect is on sex ratio. If the initial population has a sex \
ratio bias (e.g., produces an excess of X-bearing pollen/sperm, \
\[Alpha]<1/2), then a male determiner will invade. ",
 StyleBox["I think an initial sex ratio bias selecting for neo sex \
determiners was discussed by Jim Bull???",
  FontColor->RGBColor[1, 0, 0]]
}], "Text",
 CellChangeTimes->{{3.675900116372485*^9, 3.675900177340706*^9}, {
  3.6759014924820547`*^9, 3.675901555528656*^9}, {3.67672201887532*^9, 
  3.676722093758645*^9}, {3.6767221334617567`*^9, 3.676722138572813*^9}}],

Cell["\<\
Here we will assume that any deviations from \[Alpha]=1/2 are on the same \
order as haploid and diploid selection \[Epsilon]. Then the eigenvalues with \
no selection are\
\>", "Text",
 CellChangeTimes->{{3.675900116372485*^9, 3.675900177340706*^9}, {
  3.6759014924820547`*^9, 3.675901555528656*^9}, {3.67672201887532*^9, 
  3.676722093758645*^9}, {3.6767221334617567`*^9, 3.676722139407465*^9}, {
  3.676722686699463*^9, 3.676722690534766*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
       RowBox[{"\[Alpha]", "\[Rule]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "+", 
         RowBox[{"\[Delta]\[Alpha]", "*", "\[Epsilon]"}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.675900185889442*^9, 3.6759001924647408`*^9}, 
   3.676654723178556*^9, {3.67672209602109*^9, 3.676722098180562*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{"1", "-", "R"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6759001928050547`*^9, 3.676652906122548*^9, 
  3.676654504790288*^9, 3.676654723729147*^9, 3.676722098630795*^9, 
  3.6767260486639442`*^9, 3.67673079016654*^9, 3.676747400525277*^9, 
  3.677430334588798*^9}]
}, Open  ]],

Cell["\<\
On this order the leading eigenvalue is \[Lambda]=1.\
\>", "Text",
 CellChangeTimes->{{3.676722106551478*^9, 3.6767221217139177`*^9}}],

Cell["\<\
On the first order the eiganvalue is\
\>", "Text",
 CellChangeTimes->{{3.676722149076614*^9, 3.676722183499652*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
             RowBox[{"\[Alpha]", "\[Rule]", 
              RowBox[{
               RowBox[{"1", "/", "2"}], "+", 
               RowBox[{"\[Delta]\[Alpha]", "*", "\[Epsilon]"}]}]}]}], "/.", 
            RowBox[{"\[Lambda]", "\[Rule]", 
             RowBox[{"1", "+", 
              RowBox[{"\[Delta]\[Lambda]", "*", "\[Epsilon]"}]}]}]}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], "/.", 
         RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", 
        RowBox[{"pXf1", "\[Rule]", 
         RowBox[{"dpAXfY", "+", "pY1"}]}]}], "/.", "eqdpAXfY"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.675900203768065*^9, 3.67590021603231*^9}, {
   3.675900300123855*^9, 3.675900338446018*^9}, 3.675900430018834*^9, {
   3.676722303506366*^9, 3.6767223232575293`*^9}, 3.676723478586155*^9, 
   3.676723712223565*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "2"}], " ", "\[Delta]\[Alpha]"}]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.6759002164032507`*^9, {3.67590030988757*^9, 3.6759003389772167`*^9}, 
   3.67590043032834*^9, 3.676652908009078*^9, 3.676654509365768*^9, 
   3.676654726722083*^9, {3.676722308652341*^9, 3.676722323820225*^9}, 
   3.676723478870928*^9, 3.676723712609481*^9, 3.67672605077512*^9, 
   3.676730790215494*^9, 3.6767474005748587`*^9, 3.677430334641314*^9}]
}, Open  ]],

Cell["\<\
And sex ratio selection again dominates (if there is an excess of X-bearing \
pollen/sperm then \[Alpha]<1/2 and \[Delta]\[Alpha]<0 and the male determiner \
invades).\
\>", "Text",
 CellChangeTimes->{{3.6767221879025803`*^9, 3.676722259967391*^9}, {
  3.676722761870081*^9, 3.67672276392988*^9}, {3.67672280106721*^9, 
  3.676722817384637*^9}}],

Cell[TextData[{
 "If we instead assume that the X/Y skew in male gametes is on the order of \
",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["\[Epsilon]", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 ", then this first order term disappears"
}], "Text",
 CellChangeTimes->{{3.6759003604720993`*^9, 3.675900376671677*^9}, {
  3.676722824466544*^9, 3.676722877881908*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
             RowBox[{"\[Alpha]", "\[Rule]", 
              RowBox[{
               RowBox[{"1", "/", "2"}], "+", 
               RowBox[{"\[Delta]\[Alpha]", "*", 
                RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
            RowBox[{"\[Lambda]", "\[Rule]", 
             RowBox[{"1", "+", 
              RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], "/.", 
         RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", 
        RowBox[{"pXf1", "\[Rule]", 
         RowBox[{"dpAXfY", "+", "pY1"}]}]}], "/.", "eqdpAXfY"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.675900392103478*^9, 3.6759004267641687`*^9}, 
   3.676723474903242*^9, 3.676723708244681*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", "0"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.675900397670813*^9, 3.6759004270810823`*^9}, 
   3.6766529096964083`*^9, 3.676654511199524*^9, 3.676654730259613*^9, 
   3.6767228797526197`*^9, 3.676723475170465*^9, 3.6767237089612923`*^9, 
   3.676726053115584*^9, 3.676730790247993*^9, 3.676747400602759*^9, 
   3.677430334704723*^9}]
}, Open  ]],

Cell["\<\
And going to the second order we have\
\>", "Text",
 CellChangeTimes->{{3.676722885049066*^9, 3.6767228925395184`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
             RowBox[{"\[Alpha]", "\[Rule]", 
              RowBox[{
               RowBox[{"1", "/", "2"}], "+", 
               RowBox[{"\[Delta]\[Alpha]", "*", 
                RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
            RowBox[{"\[Lambda]", "\[Rule]", 
             RowBox[{"1", "+", 
              RowBox[{"\[Delta]\[Lambda]2", "*", 
               RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], "/.", 
         RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", 
        RowBox[{"pXf1", "\[Rule]", 
         RowBox[{"dpAXfY", "+", "pY1"}]}]}], "/.", "eqdpAXfY"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol\[Delta]\[Lambda]2", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"\[Delta]\[Lambda]2", "/.", "%"}], ",", "\[Delta]\[Alpha]", ",", 
    "Simplify"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.675900404967301*^9, 3.6759004329872217`*^9}, {
   3.6767229089989653`*^9, 3.676722998182646*^9}, {3.6767234645692587`*^9, 
   3.6767234698851843`*^9}, 3.6767236810636597`*^9, {3.676723812561139*^9, 
   3.676723837997972*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
      RowBox[{"(", 
       RowBox[{"r", "-", "R"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pA", " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{"sAm", "-", 
            RowBox[{"2", " ", "pA", " ", "sAm"}]}], ")"}]}], "+", "t"}], 
        ")"}], "2"]}], 
     RowBox[{"r", " ", "R"}]]}], "-", 
   RowBox[{"2", " ", "\[Delta]\[Alpha]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6759004188756123`*^9, 3.6759004427625017`*^9}, 
   3.6766529106446733`*^9, 3.6766545120184917`*^9, 3.676654731520351*^9, {
   3.676722906104093*^9, 3.676722910989242*^9}, 3.676722955373844*^9, {
   3.6767229900719013`*^9, 3.676722998521778*^9}, 3.676723470669956*^9, 
   3.676723682596013*^9, {3.6767238129134817`*^9, 3.6767238383799667`*^9}, 
   3.676726054846225*^9, 3.676730790472865*^9, 3.67674740078727*^9, 
   3.6774303348817043`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Free recombination between the autosomal and novel sex-determining loci\
\>", "Subsubsection",
 CellChangeTimes->{{3.676726441652481*^9, 3.6767264526924953`*^9}}],

Cell["\<\
With free recombination between the autosomal locus and the novel \
sex-determining locus (i.e., the autosomal locus is on the original sex \
chromosome and a novel sex chromosome invades) this is\
\>", "Text",
 CellChangeTimes->{{3.676723035359066*^9, 3.6767230737486343`*^9}, {
  3.676723112293648*^9, 3.6767231429878607`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol\[Delta]\[Lambda]2AonOld", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"sol\[Delta]\[Lambda]2", "/.", 
     RowBox[{"equilpA", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.676654782258457*^9, 3.676654880438425*^9}, {
   3.676723076508273*^9, 3.676723091272738*^9}, {3.6767233248055267`*^9, 
   3.676723345251574*^9}, 3.676723496153174*^9, {3.676723576039339*^9, 
   3.676723605705933*^9}, {3.67672365183431*^9, 3.676723661481447*^9}, 
   3.6767239828317757`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "r"}]}], ")"}], " ", 
     SuperscriptBox["sAf", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "hAf"}], ")"}], " ", "sAf"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "hAm"}], ")"}], " ", "sAm"}], "-", "t"}], 
      ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hAf", " ", "sAf"}], "+", 
       RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"hAm", " ", "sAm"}], "+", "t", "-", 
        RowBox[{"hAf", " ", 
         RowBox[{"(", 
          RowBox[{"sAm", "+", 
           RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}], "2"]}], 
    RowBox[{"r", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"sAf", "-", 
        RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
        RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}], "4"]}]], "-", 
   RowBox[{"2", " ", "\[Delta]\[Alpha]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.676654828655718*^9, 3.676654850680685*^9}, 
   3.6766548809083223`*^9, {3.676723078141181*^9, 3.676723091627124*^9}, 
   3.6767233459240017`*^9, 3.676723415486251*^9, 3.67672349645476*^9, {
   3.676723599791974*^9, 3.676723606362235*^9}, 3.676723653676278*^9, 
   3.676723983301012*^9, 3.676730790564519*^9, 3.676747400886498*^9, 
   3.6774303349818497`*^9}]
}, Open  ]],

Cell["\<\
We now check that thies reduces to van Doorn and \
Kirkpatrick\[CloseCurlyQuote]s result (with t and \[Delta]\[Alpha] now added \
in)\
\>", "Text",
 CellChangeTimes->{{3.676724012851976*^9, 3.6767240586035213`*^9}, {
  3.676726473681219*^9, 3.676726475931938*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", "0", "}"}], "==", 
         RowBox[{"sol\[Delta]\[Lambda]2AonOld", "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", " ", "LA"}], " ", "VA", " ", "SA"}], "-", 
            RowBox[{"2", "\[Delta]\[Alpha]"}]}], ")"}]}]}], "/.", 
        RowBox[{"LA", "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "r"}]}], ")"}], "/", "r"}]}]}], "/.", 
       RowBox[{"VA", "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "pA"}], ")"}], "pA"}]}]}], "/.", 
      RowBox[{"SA", "\[Rule]", 
       RowBox[{"\[Sigma]Am", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Sigma]Am", "-", "\[Sigma]Af"}], ")"}], "/", "2"}]}]}]}], 
     "/.", 
     RowBox[{"\[Sigma]Am", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pA", "+", 
          RowBox[{"hAm", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAm"}], "-", 
       RowBox[{"pA", " ", "hAm", " ", "sAm"}], "+", "t"}]}]}], "/.", 
    RowBox[{"\[Sigma]Af", "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pA", "+", 
         RowBox[{"hAf", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAf"}], "-", 
      RowBox[{"pA", " ", "hAf", " ", "sAf"}]}]}]}], "/.", 
   RowBox[{"pA", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"hAf", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
     RowBox[{
      RowBox[{"-", "sAf"}], "+", 
      RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
      RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.676654952422246*^9, 3.676655132574526*^9}, 
   3.676723992936453*^9, {3.676724060816902*^9, 3.676724117382635*^9}, {
   3.676730857252459*^9, 3.6767308579554377`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.676655037350493*^9, 3.6766550772344112`*^9}, {
   3.676655115558099*^9, 3.6766551332815866`*^9}, 3.67672387995251*^9, {
   3.6767239906284*^9, 3.6767239935524893`*^9}, {3.676724063136498*^9, 
   3.6767241178554277`*^9}, 3.676730790632848*^9, 3.676747400925766*^9, 
   3.677430335038931*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Free recombination between the autosomal and original sex-determining loci\
\>", "Subsubsection",
 CellChangeTimes->{{3.676726458875577*^9, 3.6767264673341208`*^9}}],

Cell["\<\
And with free recombination between the autosomal locus and the original \
sex-determining locus (i.e., the y mutation makes the chromosome with the \
autosomal locus a novel sex chromosome) this is\
\>", "Text",
 CellChangeTimes->{{3.676723108206479*^9, 3.67672311042155*^9}, {
  3.676723147237796*^9, 3.6767232508090353`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol\[Delta]\[Lambda]2AonNew", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"sol\[Delta]\[Lambda]2", "/.", 
     RowBox[{"equilpA", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
    RowBox[{"r", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6766548654946547`*^9, 3.676654876086323*^9}, {
   3.676723254155108*^9, 3.676723264876534*^9}, {3.676723626328287*^9, 
   3.676723646802739*^9}, 3.67672387516989*^9, {3.676723924824037*^9, 
   3.6767239753997707`*^9}, {3.6767241068826*^9, 3.6767241101698427`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "R"}]}], ")"}], " ", 
      SuperscriptBox["sAf", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "hAf"}], ")"}], " ", "sAf"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "hAm"}], ")"}], " ", "sAm"}], "-", "t"}], 
       ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"hAf", " ", "sAf"}], "+", 
        RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hAm", " ", "sAm"}], "+", "t", "-", 
         RowBox[{"hAf", " ", 
          RowBox[{"(", 
           RowBox[{"sAm", "+", 
            RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}], "2"]}], 
     RowBox[{"R", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"sAf", "-", 
         RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}], "4"]}]]}], "-", 
   RowBox[{"2", " ", "\[Delta]\[Alpha]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.676654868777504*^9, 3.676654876523601*^9}, {
   3.676723255431065*^9, 3.676723265232049*^9}, 3.676723498672326*^9, {
   3.6767236267651863`*^9, 3.676723647241419*^9}, 3.6767238756656103`*^9, {
   3.67672393049902*^9, 3.676723942450224*^9}, {3.676723972978263*^9, 
   3.67672397579666*^9}, {3.676724108140151*^9, 3.676724110473568*^9}, 
   3.67673079071239*^9, 3.676747401002975*^9, 3.677430335123322*^9}]
}, Open  ]],

Cell["\<\
We now check that thies reduces to van Doorn and \
Kirkpatrick\[CloseCurlyQuote]s result (with t and \[Delta]\[Alpha] now added \
in)\
\>", "Text",
 CellChangeTimes->{3.676726480616769*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"{", "0", "}"}], "==", 
         RowBox[{"sol\[Delta]\[Lambda]2AonNew", "-", 
          RowBox[{"(", " ", 
           RowBox[{
            RowBox[{"LA", " ", "VA", " ", "SA"}], "-", 
            RowBox[{"2", "\[Delta]\[Alpha]"}]}], ")"}]}]}], "/.", 
        RowBox[{"LA", "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "R"}]}], ")"}], "/", "R"}]}]}], "/.", 
       RowBox[{"VA", "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "pA"}], ")"}], "pA"}]}]}], "/.", 
      RowBox[{"SA", "\[Rule]", 
       RowBox[{"\[Sigma]Am", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Sigma]Am", "-", "\[Sigma]Af"}], ")"}], "/", "2"}]}]}]}], 
     "/.", 
     RowBox[{"\[Sigma]Am", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pA", "+", 
          RowBox[{"hAm", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAm"}], "-", 
       RowBox[{"pA", " ", "hAm", " ", "sAm"}], "+", "t"}]}]}], "/.", 
    RowBox[{"\[Sigma]Af", "\[Rule]", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pA", "+", 
         RowBox[{"hAf", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAf"}], "-", 
      RowBox[{"pA", " ", "hAf", " ", "sAf"}]}]}]}], "/.", 
   RowBox[{"pA", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"hAf", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
     RowBox[{
      RowBox[{"-", "sAf"}], "+", 
      RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
      RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6766551610819893`*^9, 3.6766551697246304`*^9}, 
   3.676655218882216*^9, {3.676724128847682*^9, 3.6767241557106657`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.676655164158601*^9, 3.676655170247074*^9}, {
   3.676655215615883*^9, 3.676655219221342*^9}, {3.676724143156053*^9, 
   3.6767241560743837`*^9}, 3.6767307907484703`*^9, 3.676747401037683*^9, 
   3.677430335163701*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tight linkage", "Subsection",
 CellChangeTimes->{{3.676724314298437*^9, 3.6767243616277246`*^9}}],

Cell["\<\
The above implicitly assumed that r and R were of order 1. Here we see how \
assuming linkage of order \[Epsilon] affects the results.\
\>", "Text",
 CellChangeTimes->{{3.676724344388238*^9, 3.676724380110772*^9}}],

Cell[CellGroupData[{

Cell["\<\
Tight linkage between autosomal and original sex-determining loci\
\>", "Subsubsection",
 CellChangeTimes->{{3.6767248863867493`*^9, 3.67672490941903*^9}}],

Cell["\<\
First, let recombination between the autosomal and original sex-determining \
loci be the same order as selection\
\>", "Text",
 CellChangeTimes->{{3.676724381640739*^9, 3.676724414833284*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weakr", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"r", "\[Rule]", 
      RowBox[{"r", "*", "\[Epsilon]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6767250591748943`*^9, 3.676725059965764*^9}}],

Cell["\<\
To zero order the eigenvalues are\
\>", "Text",
 CellChangeTimes->{{3.676724558402609*^9, 3.676724568003216*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Alpha]", "\[Rule]", 
         RowBox[{
          RowBox[{"1", "/", "2"}], "+", 
          RowBox[{"\[Delta]\[Alpha]", "*", 
           SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", "weakr"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.6767244823949614`*^9, 3.676724513709134*^9}, {
  3.676732793774232*^9, 3.676732802453367*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    FractionBox["1", "2"]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6767244833339243`*^9, 3.6767245142018147`*^9}, 
   3.676725061518611*^9, 3.6767260008785048`*^9, 3.676726064848021*^9, 
   3.676730790815566*^9, {3.676732787987349*^9, 3.6767328040787487`*^9}, 
   3.676747401124319*^9, 3.677430335213666*^9}]
}, Open  ]],

Cell["\<\
and on this order the leading eigenvalue is 1.\
\>", "Text",
 CellChangeTimes->{{3.6767245714084063`*^9, 3.6767246027807198`*^9}}],

Cell["\<\
On the first order the eigenvalue is\
\>", "Text",
 CellChangeTimes->{{3.676724607511999*^9, 3.676724616751094*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
              RowBox[{"\[Alpha]", "\[Rule]", 
               RowBox[{
                RowBox[{"1", "/", "2"}], "+", 
                RowBox[{"\[Delta]\[Alpha]", "*", 
                 SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", 
             RowBox[{"\[Lambda]", "\[Rule]", 
              RowBox[{"1", "+", 
               RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], "/.", 
            "frequenciessub"}], "/.", "sol0"}], "/.", 
          RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", 
         RowBox[{"pXf1", "\[Rule]", 
          RowBox[{"dpAXfY", "+", "pY1"}]}]}], "/.", "eqdpAXfY"}], "/.", 
       "weakr"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol\[Delta]\[Lambda]1AonOldTight", "=", 
  RowBox[{
   RowBox[{"\[Delta]\[Lambda]1", "/.", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.676724519439756*^9, 3.676724549258483*^9}, {
  3.676724623973028*^9, 3.67672462595586*^9}, {3.676724681060487*^9, 
  3.676724744057993*^9}, {3.676724774151531*^9, 3.67672478548872*^9}, {
  3.6767250516801987`*^9, 3.676725056117838*^9}, {3.676730939922304*^9, 
  3.676730955515584*^9}, {3.67673295574433*^9, 3.6767329569811287`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "r"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "hAm"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", "sAm"}]}], 
      ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pA", " ", "sAm"}], "+", 
        RowBox[{"hAm", " ", 
         RowBox[{"(", 
          RowBox[{"sAm", "-", 
           RowBox[{"2", " ", "pA", " ", "sAm"}]}], ")"}]}], "+", "t"}], ")"}],
       "2"]}], 
    SuperscriptBox["r", "2"]]}], "}"}]], "Output",
 CellChangeTimes->{{3.676724507201425*^9, 3.6767245499257*^9}, 
   3.676724626681284*^9, {3.676724719829958*^9, 3.6767247444467707`*^9}, {
   3.6767247752820663`*^9, 3.6767247858487453`*^9}, {3.676725056734373*^9, 
   3.676725063128633*^9}, 3.676726067980661*^9, 3.6767307910149918`*^9, {
   3.676730948439028*^9, 3.676730957269607*^9}, 3.676747401394497*^9, 
   3.677430335412507*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
            RowBox[{"\[Alpha]", "\[Rule]", 
             RowBox[{"1", "/", "2"}]}]}], "/.", 
           RowBox[{"\[Lambda]", "\[Rule]", 
            RowBox[{"1", "+", 
             RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], "/.", 
          RowBox[{"pXf", "\[Rule]", "eqpXf"}]}], "/.", 
         RowBox[{"pXm", "\[Rule]", "eqpXm"}]}], "/.", 
        RowBox[{"pY", "\[Rule]", "eqpY"}]}], "/.", "weakr"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol\[Delta]\[Lambda]1AonOldTight", "=", 
  RowBox[{
   RowBox[{"\[Delta]\[Lambda]1", "/.", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.676732838889495*^9, 3.67673285608918*^9}, 
   3.67673296533591*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["r", "2"]], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pA"}], "+", 
       RowBox[{"hAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}]}]}], ")"}], " ", "sAf", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["hAm", "2"], " ", "pA", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"3", " ", "pA"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["pA", "2"]}]}], ")"}], " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["pA", "3"], " ", "sAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "-", 
             RowBox[{"4", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", "sAm"}], 
         ")"}]}], "-", 
       RowBox[{"hAm", " ", "sAm", " ", 
        RowBox[{"(", 
         RowBox[{"r", "-", 
          RowBox[{"2", " ", "pA", " ", "r"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "hAf", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "+", "sAm", 
             "-", 
             RowBox[{"4", " ", "pA", " ", 
              RowBox[{"(", 
               RowBox[{"sAf", "+", "sAm"}], ")"}]}], "-", 
             RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"r", " ", "t"}], "-", 
       RowBox[{"pA", " ", "sAm", " ", 
        RowBox[{"(", 
         RowBox[{"r", "+", 
          RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "t"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["pA", "2"], " ", "sAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             RowBox[{"6", " ", "hAf"}]}], ")"}], " ", "sAf"}], "-", "sAm", 
          "+", "t"}], ")"}]}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.676732839518756*^9, 3.6767328598249693`*^9}, 
   3.676732967262107*^9, 3.676747402403387*^9, 3.67743033641949*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"test", "=", 
  RowBox[{
   RowBox[{"sol\[Delta]\[Lambda]1AonOldTight", "/.", 
    RowBox[{"equilpA", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "//", "Factor"}]}]], "Input",
 CellChangeTimes->{{3.6767319409204493`*^9, 3.6767319495030403`*^9}, {
  3.676733047922665*^9, 3.67673306198088*^9}, {3.6767333270100393`*^9, 
  3.676733328257435*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"2", " ", 
      SuperscriptBox["sAf", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "sAf"}], "+", 
        RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
        RowBox[{"hAm", " ", "sAm"}], "-", "t"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"hAf", " ", "sAf"}], "+", 
        RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hAf", " ", "sAm"}], "-", 
         RowBox[{"hAm", " ", "sAm"}], "-", "t", "+", 
         RowBox[{"2", " ", "hAf", " ", "t"}]}], ")"}], "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"r", " ", 
         SuperscriptBox["sAf", "2"]}], "-", 
        RowBox[{"4", " ", "hAf", " ", "r", " ", 
         SuperscriptBox["sAf", "2"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["hAf", "2"], " ", "r", " ", 
         SuperscriptBox["sAf", "2"]}], "+", 
        RowBox[{"2", " ", "r", " ", "sAf", " ", "sAm"}], "-", 
        RowBox[{"4", " ", "hAf", " ", "r", " ", "sAf", " ", "sAm"}], "-", 
        RowBox[{"4", " ", "hAm", " ", "r", " ", "sAf", " ", "sAm"}], "+", 
        RowBox[{
        "8", " ", "hAf", " ", "hAm", " ", "r", " ", "sAf", " ", "sAm"}], "+", 
        
        RowBox[{"hAf", " ", 
         SuperscriptBox["sAf", "2"], " ", "sAm"}], "-", 
        RowBox[{
         SuperscriptBox["hAf", "2"], " ", 
         SuperscriptBox["sAf", "2"], " ", "sAm"}], "-", 
        RowBox[{"2", " ", "hAf", " ", "hAm", " ", 
         SuperscriptBox["sAf", "2"], " ", "sAm"}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["hAf", "2"], " ", "hAm", " ", 
         SuperscriptBox["sAf", "2"], " ", "sAm"}], "+", 
        RowBox[{"r", " ", 
         SuperscriptBox["sAm", "2"]}], "-", 
        RowBox[{"4", " ", "hAm", " ", "r", " ", 
         SuperscriptBox["sAm", "2"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["hAm", "2"], " ", "r", " ", 
         SuperscriptBox["sAm", "2"]}], "+", 
        RowBox[{"hAf", " ", "sAf", " ", 
         SuperscriptBox["sAm", "2"]}], "+", 
        RowBox[{"hAm", " ", "sAf", " ", 
         SuperscriptBox["sAm", "2"]}], "-", 
        RowBox[{"4", " ", "hAf", " ", "hAm", " ", "sAf", " ", 
         SuperscriptBox["sAm", "2"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["hAm", "2"], " ", "sAf", " ", 
         SuperscriptBox["sAm", "2"]}], "+", 
        RowBox[{"4", " ", "hAf", " ", 
         SuperscriptBox["hAm", "2"], " ", "sAf", " ", 
         SuperscriptBox["sAm", "2"]}], "+", 
        RowBox[{"hAm", " ", 
         SuperscriptBox["sAm", "3"]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["hAm", "2"], " ", 
         SuperscriptBox["sAm", "3"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["hAm", "3"], " ", 
         SuperscriptBox["sAm", "3"]}], "+", 
        RowBox[{"sAf", " ", "sAm", " ", "t"}], "-", 
        RowBox[{"2", " ", "hAm", " ", "sAf", " ", "sAm", " ", "t"}], "+", 
        RowBox[{
         SuperscriptBox["sAm", "2"], " ", "t"}], "-", 
        RowBox[{"2", " ", "hAm", " ", 
         SuperscriptBox["sAm", "2"], " ", "t"}], "+", 
        RowBox[{"sAm", " ", 
         SuperscriptBox["t", "2"]}], "-", 
        RowBox[{"2", " ", "hAm", " ", "sAm", " ", 
         SuperscriptBox["t", "2"]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox["r", "2"], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "sAf"}], "+", 
         RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}], "6"]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6767319315708923`*^9, 3.676731949816581*^9}, {
   3.676733027898518*^9, 3.676733062285009*^9}, 3.676733328657701*^9, 
   3.6767474025363827`*^9, 3.677430336504467*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol\[Delta]\[Lambda]2AonOld", "/.", 
  RowBox[{"t", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.676732319122678*^9, 3.676732321209937*^9}, {
  3.6767324121038847`*^9, 3.676732448492332*^9}, {3.6767330661487637`*^9, 
  3.6767330721545887`*^9}, {3.676733182785914*^9, 3.6767331836488333`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "r"}]}], ")"}], " ", 
     SuperscriptBox["sAf", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "hAf"}], ")"}], " ", "sAf"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "hAm"}], ")"}], " ", "sAm"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hAf", " ", "sAf"}], "+", 
       RowBox[{"hAm", " ", "sAm"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "hAf"}], " ", "sAm"}], "+", 
        RowBox[{"hAm", " ", "sAm"}]}], ")"}], "2"]}], 
    RowBox[{"r", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"sAf", "-", 
        RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
        RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}], "4"]}]], "-", 
   RowBox[{"2", " ", "\[Delta]\[Alpha]"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.676732321597921*^9, {3.676732413437067*^9, 3.67673245104521*^9}, {
   3.676733068408084*^9, 3.6767330725380993`*^9}, 3.6767331841138487`*^9, 
   3.676747402575626*^9, 3.677430336541306*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kirk", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "VA"}], " ", "SA", " ", "LA"}], "/.", 
                    RowBox[{"VA", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    FractionBox["3", "4"], "pAX", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pAX"}], ")"}]}], "+", 
                    RowBox[{
                    FractionBox["1", "4"], "pAY", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pAY"}], ")"}]}]}]}]}], "/.", 
                    RowBox[{"SA", "\[Rule]", 
                    RowBox[{"4", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox["\[Sigma]AY", "2"], "\[Sigma]AX"}], 
                    RowBox[{"\[Sigma]AX", "-", "\[Sigma]AY"}]]}]}]}], "/.", 
                   RowBox[{"LA", "\[Rule]", 
                    FractionBox[
                    RowBox[{"1", "-", 
                    RowBox[{"2", "r"}]}], "r"]}]}], "/.", 
                  RowBox[{"\[Sigma]AX", "\[Rule]", 
                   RowBox[{
                    RowBox[{
                    FractionBox["2", "3"], 
                    RowBox[{"(", 
                    RowBox[{"pAX", "+", 
                    RowBox[{"hAf", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", "pAX"}]}], ")"}]}]}], ")"}], "\[Epsilon]", 
                    " ", "sAf"}], "+", 
                    RowBox[{
                    FractionBox["1", "3"], 
                    RowBox[{"(", 
                    RowBox[{"pAY", "+", 
                    RowBox[{"hAm", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", "pAY"}]}], ")"}]}]}], ")"}], "\[Epsilon]", 
                    " ", "sAm"}]}]}]}], "/.", 
                 RowBox[{"\[Sigma]AY", "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"pAX", "+", 
                    RowBox[{"hAm", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", "pAX"}]}], ")"}]}]}], ")"}], "\[Epsilon]", 
                   " ", "sAm"}]}]}], "/.", 
                RowBox[{"pAX", "\[Rule]", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"2", "XAf"}], "+", 
                   RowBox[{"XAm", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], "3"]}]}], "/.", 
               RowBox[{"pAY", "\[Rule]", 
                RowBox[{"YA", "/", "\[Alpha]"}]}]}], "/.", "subequil"}], "/.",
              "frequenciessub"}], "/.", "sol0"}], "/.", 
           RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", 
          RowBox[{"pXf1", "\[Rule]", 
           RowBox[{"dpAXfY", "+", "pY1"}]}]}], "/.", "eqdpAXfY"}], "/.", 
        RowBox[{"equilpA", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
       RowBox[{"\[Alpha]", "\[Rule]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "+", 
         RowBox[{"\[Delta]\[Alpha]", "*", 
          SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
   "Factor"}]}]], "Input",
 CellChangeTimes->{{3.676731133337426*^9, 3.676731371943714*^9}, {
  3.676731525264682*^9, 3.676731527663677*^9}, {3.6767316472063828`*^9, 
  3.676731710268386*^9}, {3.676731742749237*^9, 3.676731771263085*^9}, {
  3.676731804345645*^9, 3.676731890315055*^9}, {3.6767319844979563`*^9, 
  3.6767319879301023`*^9}, {3.676732058519732*^9, 3.676732059935276*^9}, {
  3.6767321225388803`*^9, 3.676732136031856*^9}, {3.676732211433106*^9, 
  3.676732216703061*^9}, {3.676732350631719*^9, 3.676732381995278*^9}, {
  3.676732454661425*^9, 3.6767324566948547`*^9}, {3.6767331001433277`*^9, 
  3.6767331308412027`*^9}, {3.676733169641725*^9, 3.67673317037971*^9}, {
  3.6767333224142017`*^9, 3.676733323546414*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  InterpretationBox[
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "r"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hAf", " ", "sAf"}], "-", 
         RowBox[{"hAm", " ", "sAf"}]}], ")"}], "2"], " ", 
      SuperscriptBox["sAm", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"hAf", " ", "sAf"}], "+", 
        RowBox[{"hAm", " ", "sAm"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "sAf"}], "+", 
        RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
        RowBox[{"hAm", " ", "sAm"}]}], ")"}], " ", 
      SuperscriptBox["\[Epsilon]", "2"]}], 
     RowBox[{"r", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "sAf"}], "+", 
         RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}], "4"]}]], "+", 
    InterpretationBox[
     SuperscriptBox[
      RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
     SeriesData[$CellContext`\[Epsilon], 0, {}, 2, 3, 1],
     Editable->False]}],
   SeriesData[$CellContext`\[Epsilon], 
    0, {$CellContext`r^(-1) (-1 + 
      2 $CellContext`r) ($CellContext`hAf $CellContext`sAf - $CellContext`hAm \
$CellContext`sAf)^2 $CellContext`sAm^2 ($CellContext`hAf $CellContext`sAf + \
$CellContext`hAm $CellContext`sAm) (-$CellContext`sAf + $CellContext`hAf \
$CellContext`sAf - $CellContext`sAm + $CellContext`hAm $CellContext`sAm) \
(-$CellContext`sAf + 2 $CellContext`hAf $CellContext`sAf - $CellContext`sAm + 
       2 $CellContext`hAm $CellContext`sAm)^(-4)}, 2, 3, 1],
   Editable->False], "}"}]], "Output",
 CellChangeTimes->{
  3.6767311403044653`*^9, 3.676731231060092*^9, 3.676731372458807*^9, {
   3.676731682573903*^9, 3.676731710796564*^9}, {3.676731743990773*^9, 
   3.676731771866705*^9}, {3.6767318061776133`*^9, 3.6767318907000504`*^9}, {
   3.676731985300459*^9, 3.676731988157764*^9}, 3.6767320604049253`*^9, {
   3.676732128023511*^9, 3.676732139306919*^9}, {3.676732213267605*^9, 
   3.676732216904001*^9}, {3.676732352898157*^9, 3.676732382241337*^9}, 
   3.676732457808185*^9, {3.676733104506151*^9, 3.6767331310442*^9}, 
   3.6767331707833977`*^9, 3.6767333246046057`*^9, 3.676747404590232*^9, 
   3.6774303385389023`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"test", "/", 
     RowBox[{"Normal", "[", "kirk", "]"}]}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.676733330985578*^9, 3.676733376248108*^9}, {
  3.6767334344557323`*^9, 3.6767334453270817`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sAf", "-", 
           RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
           RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "sAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "hAf"}], ")"}], " ", "sAf"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "hAm"}], ")"}], " ", "sAm"}]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"hAf", " ", "sAf"}], "+", 
          RowBox[{"hAm", " ", "sAm"}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"r", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "r"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "sAm"}]}], ")"}], 
      "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.676733334105858*^9, 3.6767333765259457`*^9}, 
   3.676733445750627*^9, 3.676747405043742*^9, 3.677430338889632*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Tight linkage between autosomal and novel sex-determining loci\
\>", "Subsubsection",
 CellChangeTimes->{{3.6767248863867493`*^9, 3.676724922813457*^9}}],

Cell["\<\
Next, let recombination between the autosomal and novel sex-determining loci \
be the same order as selection\
\>", "Text",
 CellChangeTimes->{{3.676724381640739*^9, 3.676724414833284*^9}, {
  3.676724932832449*^9, 3.676724937436001*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weakR", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R", "\[Rule]", 
      RowBox[{"R", " ", "\[Epsilon]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"r", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676724941091825*^9, 3.676724950804394*^9}}],

Cell["\<\
To zero order the eigenvalues are\
\>", "Text",
 CellChangeTimes->{{3.676724558402609*^9, 3.676724568003216*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Alpha]", "\[Rule]", 
         RowBox[{
          RowBox[{"1", "/", "2"}], "+", 
          RowBox[{"\[Delta]\[Alpha]", "*", 
           SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", "weakR"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.6767244823949614`*^9, 3.676724513709134*^9}, 
   3.676724953838231*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6767244833339243`*^9, 3.6767245142018147`*^9}, 
   3.6767249543972197`*^9, 3.676725079835832*^9, 3.676726080299958*^9, 
   3.676730791066903*^9, 3.676747405100821*^9, 3.6774303389378157`*^9}]
}, Open  ]],

Cell["\<\
and on this order the leading eigenvalue is 1.\
\>", "Text",
 CellChangeTimes->{{3.6767245714084063`*^9, 3.6767246027807198`*^9}}],

Cell["\<\
On the first order the eigenvalue is\
\>", "Text",
 CellChangeTimes->{{3.676724607511999*^9, 3.676724616751094*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", 
            RowBox[{"\[Delta]\[Alpha]", "*", 
             SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", 
         RowBox[{"\[Lambda]", "\[Rule]", 
          RowBox[{"1", "+", 
           RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], "/.", 
        "frequenciessub"}], "/.", "sol0"}], "/.", 
      RowBox[{"pY0", "\[Rule]", "pA"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.67672526317986*^9, 3.676725280126062*^9}, {
  3.6767259418752747`*^9, 3.6767259744703207`*^9}, {3.676726015615571*^9, 
  3.6767260188780403`*^9}, {3.676726097628949*^9, 3.6767262165611467`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.676725267477192*^9, 3.6767252804579887`*^9}, {
   3.676725952528433*^9, 3.676725974979321*^9}, {3.676726008313591*^9, 
   3.676726019635515*^9}, {3.676726083749288*^9, 3.676726182852048*^9}, 
   3.6767262175038233`*^9, 3.6767307911006517`*^9, 3.676747405144644*^9, 
   3.67743033897466*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
             RowBox[{"\[Alpha]", "\[Rule]", 
              RowBox[{
               RowBox[{"1", "/", "2"}], "+", 
               RowBox[{"\[Delta]\[Alpha]", "*", 
                SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", 
            RowBox[{"\[Lambda]", "\[Rule]", 
             RowBox[{"1", "+", 
              RowBox[{"\[Delta]\[Lambda]2", "*", 
               SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], "/.", 
         RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", 
        RowBox[{"pXf1", "\[Rule]", 
         RowBox[{"dpAXfY", "+", "pY1"}]}]}], "/.", "eqdpAXfY"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]\[Lambda]2", "/.", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]2"}], "]"}]}], "//",
    "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol\[Delta]\[Lambda]2AonNewTight", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"%", "/.", "weakR"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.676724519439756*^9, 3.676724549258483*^9}, {
   3.676724623973028*^9, 3.67672462595586*^9}, {3.676724681060487*^9, 
   3.676724744057993*^9}, {3.676724774151531*^9, 3.67672478548872*^9}, {
   3.676724960553857*^9, 3.6767250041206627`*^9}, {3.676725084667059*^9, 
   3.67672510448884*^9}, 3.676725166554488*^9, {3.676726224819807*^9, 
   3.676726339259191*^9}, {3.67672637656812*^9, 3.676726377242518*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  InterpretationBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pA", " ", "sAm"}], "+", 
          RowBox[{"hAm", " ", 
           RowBox[{"(", 
            RowBox[{"sAm", "-", 
             RowBox[{"2", " ", "pA", " ", "sAm"}]}], ")"}]}], "+", "t"}], 
         ")"}], "2"]}], 
      RowBox[{"R", " ", "\[Epsilon]"}]]}], "+", 
    InterpretationBox[
     SuperscriptBox[
      RowBox[{"O", "[", "\[Epsilon]", "]"}], "0"],
     SeriesData[$CellContext`\[Epsilon], 0, {}, -1, 0, 1],
     Editable->False]}],
   SeriesData[$CellContext`\[Epsilon], 
    0, {-(-1 + $CellContext`pA) $CellContext`pA $CellContext`R^(-1) \
($CellContext`pA $CellContext`sAm + $CellContext`hAm ($CellContext`sAm - 
         2 $CellContext`pA $CellContext`sAm) + $CellContext`t)^2}, -1, 0, 1],
   Editable->False], "}"}]], "Output",
 CellChangeTimes->{{3.676724507201425*^9, 3.6767245499257*^9}, 
   3.676724626681284*^9, {3.676724719829958*^9, 3.6767247444467707`*^9}, {
   3.6767247752820663`*^9, 3.6767247858487453`*^9}, {3.6767249611311703`*^9, 
   3.6767250052091722`*^9}, {3.676725090561853*^9, 3.676725104951371*^9}, {
   3.6767251618537397`*^9, 3.676725166887063*^9}, {3.676726219569068*^9, 
   3.676726260604478*^9}, {3.6767263055730133`*^9, 3.676726339557445*^9}, 
   3.6767263778071957`*^9, 3.6767307911993933`*^9, 3.676747405256954*^9, 
   3.67743033907758*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Resident equilibrium (tight linkage)\
\>", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9, {3.675889497088314*^9, 3.675889497307007*^9}, {
   3.675897573374775*^9, 3.675897575830624*^9}, {3.675897716718397*^9, 
   3.6758977222283363`*^9}, 3.676682250170936*^9, 3.676682959070333*^9, {
   3.6767193867939043`*^9, 3.676719388460558*^9}, {3.676733552054386*^9, 
   3.676733555844715*^9}, {3.677430373756175*^9, 3.67743037658815*^9}, {
   3.677430444272822*^9, 3.677430445565317*^9}, 3.6774307818185787`*^9}],

Cell["\<\
We now re-do much of the above analyses, assuming recombination rates on the \
same order as selection, which we continue to assume is weak.\
\>", "Text",
 CellChangeTimes->{{3.676741325309101*^9, 3.676741354789353*^9}, {
  3.6774305643124313`*^9, 3.677430579391304*^9}}],

Cell[CellGroupData[{

Cell["\<\
Tight linkage between automsomal and original sex-determining loci\
\>", "Subsection",
 CellChangeTimes->{{3.676741361413642*^9, 3.6767414025760193`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["subequil"], "Input",
 CellChangeTimes->{{3.6774412869641857`*^9, 3.677441288149064*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"XAf", "\[Rule]", "pXf"}], ",", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "pXf"}]}], ",", 
   RowBox[{"XAm", "\[Rule]", 
    RowBox[{"pXm", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", 
   RowBox[{"Xam", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXm"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", 
   RowBox[{"YA", "\[Rule]", 
    RowBox[{"pY", " ", "\[Alpha]"}]}], ",", 
   RowBox[{"Ya", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pY"}], ")"}], " ", "\[Alpha]"}]}], ",", 
   RowBox[{"XAyf", "\[Rule]", "0"}], ",", 
   RowBox[{"Xayf", "\[Rule]", "0"}], ",", 
   RowBox[{"XAym", "\[Rule]", "0"}], ",", 
   RowBox[{"Xaym", "\[Rule]", "0"}], ",", 
   RowBox[{"YAy", "\[Rule]", "0"}], ",", 
   RowBox[{"Yay", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.677441288465468*^9}]
}, Open  ]],

Cell["\<\
Here we assume tight linkage between the automsomal and original \
sex-determining loci, with recombination rate r on the same order as selection\
\>", "Text",
 CellChangeTimes->{{3.676741385719063*^9, 3.6767414003519173`*^9}, {
  3.676741493540558*^9, 3.676741503925438*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weakr", "=", 
   RowBox[{"r", "\[Rule]", 
    RowBox[{"r", " ", "\[Epsilon]"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676741421479125*^9, 3.676741436652302*^9}, 
   3.676744764731474*^9}],

Cell["\<\
With no selection (or recombination) the frequency of A on female and male Xs \
is the same\
\>", "Text",
 CellChangeTimes->{{3.676744771161686*^9, 3.6767448653262033`*^9}, {
  3.676749416207307*^9, 3.676749451823717*^9}, {3.677431323713461*^9, 
  3.6774313247937*^9}, {3.677431413691101*^9, 3.677431441946992*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0tight", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"{", 
              RowBox[{
               RowBox[{"XAfprime", "-", "XAf"}], ",", 
               RowBox[{"XAmprime", "-", "XAm"}], ",", 
               RowBox[{"YAprime", "-", "YA"}]}], "}"}], "/.", "subequil"}], "/.",
             "frequenciessub"}], "/.", "weaksel"}], "/.", "weakr"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], 
      "\[Equal]", "0"}], ",", 
     RowBox[{"{", "pXf0", "}"}]}], "]"}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.677431382468553*^9, 3.677431406948914*^9}, {
   3.67743144910924*^9, 3.677431452317206*^9}, {3.6774315403589783`*^9, 
   3.677431598632801*^9}, 3.677441267570211*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"pXf0", "\[Rule]", "pXm0"}], "}"}]], "Output",
 CellChangeTimes->{{3.677431380568008*^9, 3.6774314072532673`*^9}, 
   3.6774314530921097`*^9, {3.6774315412146597`*^9, 3.677431570047556*^9}, 
   3.677431604392241*^9, 3.677441268389676*^9}]
}, Open  ]],

Cell["\<\
and the frequency of A on the Y is arbitrary\
\>", "Text",
 CellChangeTimes->{{3.677431619422371*^9, 3.6774316610382767`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Normal", "[", 
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"YAprime", "-", "YA"}], "/.", "subequil"}], "/.", 
       "frequenciessub"}], "/.", "weaksel"}], "/.", "weakr"}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.677431641743498*^9, 3.6774316742482767`*^9}, 
   3.677441274730258*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6774316420601177`*^9, 3.677431674651075*^9}, 
   3.677441275284546*^9}]
}, Open  ]],

Cell["\<\
Using this result, to the first order in \[Epsilon] we have a difference in \
the frequency of A on Xs in females and males of\
\>", "Text",
 CellChangeTimes->{{3.677431463877123*^9, 3.677431482931528*^9}, {
  3.6774319575876083`*^9, 3.6774319877309113`*^9}, {3.677439416083151*^9, 
  3.677439434427936*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol1tight", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"0", "==", 
         RowBox[{"Normal", "[", 
          RowBox[{"Series", "[", 
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"{", 
                 RowBox[{"XAfprime", "-", "XAf"}], "}"}], "/.", "subequil"}], 
               "/.", "frequenciessub"}], "/.", "weaksel"}], "/.", "weakr"}], 
            ",", 
            RowBox[{"{", 
             RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
          "]"}]}], "/.", "sol0tight"}], "/.", 
       RowBox[{"pXf1", "\[Rule]", 
        RowBox[{"dpAXfXm", "+", "pXm1"}]}]}], ",", 
      RowBox[{"{", "dpAXfXm", "}"}]}], "]"}], "//", "Factor"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.677431739866724*^9, 3.677431790740663*^9}, 
   3.677431829531271*^9, {3.677431915868635*^9, 3.6774319377168417`*^9}, 
   3.677431968884844*^9, {3.677432123889217*^9, 3.677432124879928*^9}, {
   3.6774397918050547`*^9, 3.677439801119402*^9}, 3.677441255025775*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfXm", "\[Rule]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pXm0"}], ")"}], " ", "pXm0", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "hAf", " ", "sAf"}], "-", 
      RowBox[{"2", " ", "pXm0", " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", "pXm0", " ", "sAf"}], "-", "t"}], 
     ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.677431792037546*^9, 3.677431829920705*^9, {3.677431918025079*^9, 
   3.67743193804685*^9}, 3.677431969182604*^9, 3.677432125173872*^9, {
   3.6774397969744787`*^9, 3.6774398014565973`*^9}, {3.6774412557406473`*^9, 
   3.6774412778521223`*^9}}]
}, Open  ]],

Cell["\<\
Meanwhile, the change in the difference in the frequency of A in Xs and Ys \
is, to zeroth order, \
\>", "Text",
 CellChangeTimes->{{3.677439611875284*^9, 3.6774396641414633`*^9}, {
  3.6774405481302967`*^9, 3.677440573931745*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"{", 
           RowBox[{
            RowBox[{"2", "XAfprime"}], "+", "XAmprime", "-", 
            RowBox[{"3", "YAprime"}], "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "XAf"}], "+", "XAm", "-", 
              RowBox[{"3", "YA"}]}], ")"}]}], "}"}], "/.", "subequil"}], "/.",
          "frequenciessub"}], "/.", "weaksel"}], "/.", "weakr"}], "/.", 
      RowBox[{"\[Alpha]", "\[Rule]", 
       RowBox[{"1", "/", "2"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "/.",
   "sol0tight"}]], "Input",
 CellChangeTimes->{{3.6774395499858103`*^9, 3.677439630524308*^9}, {
  3.6774396978897247`*^9, 3.677439702929255*^9}}],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{{3.677439587217551*^9, 3.677439630821899*^9}, 
   3.67743970340166*^9}]
}, Open  ]],

Cell["\<\
And to first order the change is\
\>", "Text",
 CellChangeTimes->{{3.677439674295287*^9, 3.677439678740425*^9}, {
  3.67744057884361*^9, 3.677440580366022*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{"{", 
                RowBox[{
                 RowBox[{"2", "XAfprime"}], "+", "XAmprime", "-", 
                 RowBox[{"3", "YAprime"}], "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "XAf"}], "+", "XAm", "-", 
                   RowBox[{"3", "YA"}]}], ")"}]}], "}"}], "/.", "subequil"}], 
              "/.", "frequenciessub"}], "/.", "weaksel"}], "/.", "weakr"}], "/.", 
           RowBox[{"\[Alpha]", "\[Rule]", 
            RowBox[{"1", "/", "2"}]}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
       "/.", "sol0tight"}], "/.", 
      RowBox[{"pXf1", "\[Rule]", 
       RowBox[{"dpAXfXm", "+", "pXm1"}]}]}], "/.", "sol1tight"}], "/.", 
    RowBox[{"pXm0", "\[Rule]", "pAX"}]}], "/.", 
   RowBox[{"pY0", "\[Rule]", "pAY"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.677439685888545*^9, 3.677439732444976*^9}, {
   3.677439808733341*^9, 3.677439813639928*^9}, {3.677439851673053*^9, 
   3.677439852094605*^9}, {3.6774400009669228`*^9, 3.677440011980958*^9}, 
   3.677440051391677*^9, {3.6774403734780903`*^9, 3.677440374073647*^9}, {
   3.6774409134938993`*^9, 3.677440928748067*^9}, 3.677440971159281*^9, {
   3.677441233985991*^9, 3.677441237825292*^9}, 3.6774415250145206`*^9, {
   3.6774415878334627`*^9, 3.6774415922468157`*^9}, 3.6774418717344646`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "2"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "hAf"}]}], ")"}], " ", 
      SuperscriptBox["pAX", "3"], " ", "sAf"}], "-", 
     RowBox[{
      SuperscriptBox["pAX", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"6", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"hAm", "+", "pAY", "-", 
           RowBox[{"2", " ", "hAm", " ", "pAY"}]}], ")"}], " ", "sAm"}], "+", 
        "t"}], ")"}]}], "+", 
     RowBox[{"pAX", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "r"}], "+", 
        RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", 
        RowBox[{"pAY", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"3", " ", "pAY"}]}], ")"}], " ", "sAm"}], "+", 
        RowBox[{"hAm", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"4", " ", "pAY"}], "-", 
           RowBox[{"6", " ", 
            SuperscriptBox["pAY", "2"]}]}], ")"}], " ", "sAm"}], "+", "t"}], 
       ")"}]}], "+", 
     RowBox[{"pAY", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "r"}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pAY"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}]}]}], 
    ")"}], " ", "\[Epsilon]"}], "}"}]], "Output",
 CellChangeTimes->{{3.6774396864075813`*^9, 3.677439733199443*^9}, 
   3.677439814937387*^9, 3.6774398526486464`*^9, {3.677440002088509*^9, 
   3.677440012876795*^9}, 3.677440051751975*^9, 3.677440374526774*^9, {
   3.677440915201412*^9, 3.677440930431212*^9}, 3.677440971680018*^9, {
   3.677441234668284*^9, 3.67744123830057*^9}, 3.677441525842635*^9, 
   3.67744159516107*^9}]
}, Open  ]],

Cell[TextData[StyleBox["(something funny going on with \[Alpha])",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.6774418694725237`*^9, 3.677441884213848*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXY", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"Normal", "[", 
         RowBox[{"Series", "[", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"{", 
                  RowBox[{
                   RowBox[{"2", "XAfprime"}], "+", "XAmprime", "-", 
                   RowBox[{"3", "YAprime"}], "-", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "XAf"}], "+", "XAm", "-", 
                    RowBox[{"3", "YA"}]}], ")"}]}], "}"}], "/.", "subequil"}],
                 "/.", "frequenciessub"}], "/.", "weaksel"}], "/.", "weakr"}],
              "/.", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Alpha]"}], ")"}], "\[Rule]", "1"}]}], "/.", 
            RowBox[{"\[Alpha]", "\[Rule]", "1"}]}], ",", 
           RowBox[{"{", 
            RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}],
         "/.", "sol0tight"}], "/.", 
       RowBox[{"pXf1", "\[Rule]", 
        RowBox[{"dpAXfXm", "+", "pXm1"}]}]}], "/.", "sol1tight"}], "/.", 
     RowBox[{"pXm0", "\[Rule]", "pAX"}]}], "/.", 
    RowBox[{"pY0", "\[Rule]", "pAY"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.677441856686144*^9, 3.67744187344561*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "hAf"}]}], ")"}], " ", 
      SuperscriptBox["pAX", "3"], " ", "sAf"}], "-", 
     RowBox[{
      SuperscriptBox["pAX", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"6", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"hAm", "+", "pAY", "-", 
           RowBox[{"2", " ", "hAm", " ", "pAY"}]}], ")"}], " ", "sAm"}], "+", 
        "t"}], ")"}]}], "+", 
     RowBox[{"pAX", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "4"}], " ", "r"}], "+", 
        RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", 
        RowBox[{"pAY", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", 
           RowBox[{"3", " ", "pAY"}]}], ")"}], " ", "sAm"}], "+", 
        RowBox[{"hAm", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"4", " ", "pAY"}], "-", 
           RowBox[{"6", " ", 
            SuperscriptBox["pAY", "2"]}]}], ")"}], " ", "sAm"}], "+", "t"}], 
       ")"}]}], "+", 
     RowBox[{"pAY", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"4", " ", "r"}], "+", 
        RowBox[{"3", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pAY"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}]}]}], 
    ")"}], " ", "\[Epsilon]"}], "}"}]], "Output",
 CellChangeTimes->{{3.6774418576258802`*^9, 3.677441874830985*^9}}]
}, Open  ]],

Cell["\<\
The solution of van Doorn and Kirkpatrick is\
\>", "Text",
 CellChangeTimes->{{3.677441533900422*^9, 3.6774415455883617`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kirk", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "4"}], " ", 
      RowBox[{"(", 
       RowBox[{"pAX", "-", "pAY"}], ")"}], " ", "r"}], "+", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pAX"}], ")"}], " ", "pAX", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "pAX"}], "+", 
        RowBox[{"hAf", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "pAX"}]}], ")"}]}]}], ")"}], " ", "sAf"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "pAX"}], 
         RowBox[{"(", 
          RowBox[{"2", "+", "pAX", "-", 
           RowBox[{"3", "pAY"}]}], ")"}], "pAY"}], "+", 
        RowBox[{"hAm", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"3", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "pAY"}], ")"}], " ", "pAY"}], "+", 
           RowBox[{
            SuperscriptBox["pAX", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", "pAY"}]}], ")"}]}], "+", 
           RowBox[{"pAX", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"4", "pAY"}], "-", 
              RowBox[{"6", 
               SuperscriptBox["pAY", "2"]}]}], ")"}]}]}], ")"}]}]}], ")"}], 
      " ", "sAm"}]}], ")"}], " ", "\[Epsilon]"}]}]], "Input",
 CellChangeTimes->{{3.677441005193535*^9, 3.677441023200206*^9}, {
   3.677441059665205*^9, 3.677441161547482*^9}, 3.677441512854146*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], " ", 
     RowBox[{"(", 
      RowBox[{"pAX", "-", "pAY"}], ")"}], " ", "r"}], "+", 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pAX"}], ")"}], " ", "pAX", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pAX"}], "+", 
       RowBox[{"hAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pAX"}]}], ")"}]}]}], ")"}], " ", "sAf"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "pAX"}], " ", 
        RowBox[{"(", 
         RowBox[{"2", "+", "pAX", "-", 
          RowBox[{"3", " ", "pAY"}]}], ")"}], " ", "pAY"}], "+", 
       RowBox[{"hAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "pAY"}], ")"}], " ", "pAY"}], "+", 
          RowBox[{
           SuperscriptBox["pAX", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "pAY"}]}], ")"}]}], "+", 
          RowBox[{"pAX", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"4", " ", "pAY"}], "-", 
             RowBox[{"6", " ", 
              SuperscriptBox["pAY", "2"]}]}], ")"}]}]}], ")"}]}]}], ")"}], 
     " ", "sAm"}]}], ")"}], " ", "\[Epsilon]"}]], "Output",
 CellChangeTimes->{3.677441162152639*^9, 3.677441513885169*^9}]
}, Open  ]],

Cell["\<\
And when t=0 our solution reduces to theirs \
\>", "Text",
 CellChangeTimes->{{3.6774415481086884`*^9, 3.677441558149066*^9}, {
   3.6774416041278677`*^9, 3.677441615743677*^9}, 3.6774418682054453`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eqdpAXY", "-", "kirk"}], "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6774411661654243`*^9, 3.67744120264751*^9}, {
   3.677441529333357*^9, 3.677441530245072*^9}, 3.677441599761503*^9, 
   3.677441876773253*^9}],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{{3.677441170650144*^9, 3.67744120317248*^9}, {
   3.677441515916484*^9, 3.6774415307616577`*^9}, 3.677441600542799*^9, 
   3.677441877080502*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eqdpAXY", "-", "kirk"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.677445122638315*^9, 3.677445125886615*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"pAX", "-", 
     SuperscriptBox["pAX", "2"], "+", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pAY"}], ")"}], " ", "pAY"}]}], ")"}], " ", 
   "t", " ", "\[Epsilon]"}], "}"}]], "Output",
 CellChangeTimes->{{3.6774451229533787`*^9, 3.6774451263856287`*^9}}]
}, Open  ]],

Cell["Define the following terms", "Text",
 CellChangeTimes->{{3.6774425983789787`*^9, 3.677442602697296*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"simplesubs", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Sigma]AX", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "/", "3"}], 
        RowBox[{"(", 
         RowBox[{"pAX", "+", 
          RowBox[{"hAf", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", "pAX"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
        "sAf"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pAY", "+", 
          RowBox[{"hAm", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", "pAY"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
        RowBox[{"sAm", "/", "3"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]AY", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pAX", "+", 
         RowBox[{"hAm", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "pAX"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
       "sAm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"VAX", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pAX"}], ")"}], "pAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"VAY", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pAY"}], ")"}], "pAY"}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.677440236806868*^9, 3.6774403462378693`*^9}, {
  3.6774404456967373`*^9, 3.6774404615214167`*^9}, {3.677442472574293*^9, 
  3.677442487559032*^9}}],

Cell["\<\
The we can write the change in difference of the frequency of A between X and \
Y with t=0 like\
\>", "Text",
 CellChangeTimes->{{3.677442605305544*^9, 3.677442621842284*^9}, {
  3.677444250856833*^9, 3.677444270887713*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXYsimp", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], 
     RowBox[{"(", 
      RowBox[{"pAX", "-", "pAY"}], ")"}], "r"}], "+", 
    RowBox[{"3", "VAX", " ", "\[Sigma]AX"}], "-", 
    RowBox[{"3", "VAY", " ", "\[Sigma]AY"}]}], "/.", 
   RowBox[{"r", "\[Rule]", 
    RowBox[{"r", " ", "\[Epsilon]"}]}]}]}]], "Input",
 CellChangeTimes->{{3.677440089922914*^9, 3.6774401030567904`*^9}, {
   3.677440177371737*^9, 3.6774402333039837`*^9}, {3.677440352891761*^9, 
   3.677440434668108*^9}, {3.6774404686719522`*^9, 3.677440473239903*^9}, {
   3.67744050673175*^9, 3.67744050827335*^9}, {3.677442753208263*^9, 
   3.6774427650789557`*^9}, 3.677444000152717*^9, {3.677444299620317*^9, 
   3.677444301281856*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", "4"}], " ", 
   RowBox[{"(", 
    RowBox[{"pAX", "-", "pAY"}], ")"}], " ", "r", " ", "\[Epsilon]"}], "+", 
  RowBox[{"3", " ", "VAX", " ", "\[Sigma]AX"}], "-", 
  RowBox[{"3", " ", "VAY", " ", "\[Sigma]AY"}]}]], "Output",
 CellChangeTimes->{{3.677440354415744*^9, 3.67744036156474*^9}, {
   3.677440397468156*^9, 3.677440474229486*^9}, 3.677440508839012*^9, 
   3.67744217313019*^9, 3.6774424972204733`*^9, {3.677442624416648*^9, 
   3.6774426386800117`*^9}, {3.677442753596684*^9, 3.677442765492867*^9}, 
   3.67744400103904*^9, 3.67744430368626*^9}]
}, Open  ]],

Cell["And check that this is right", "Text",
 CellChangeTimes->{{3.677442626586212*^9, 3.6774426324345903`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eqdpAXYsimp", "-", "eqdpAXY"}], "/.", "simplesubs"}], "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.677440378406557*^9, 3.677440417926054*^9}, 
   3.6774405029397907`*^9, 3.677442181386463*^9, 3.67744263581238*^9, {
   3.6774427690179358`*^9, 3.6774427693069897`*^9}, {3.677442807556828*^9, 
   3.677442828236238*^9}, {3.677443942476513*^9, 3.6774439508220053`*^9}, 
   3.677443999240967*^9, {3.6774443052157793`*^9, 3.677444307789077*^9}}],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{{3.677440379142228*^9, 3.677440386060093*^9}, 
   3.67744050360668*^9, 3.677442182861951*^9, 3.6774424991580763`*^9, 
   3.677442637097036*^9, 3.677442770108409*^9, {3.677442810756572*^9, 
   3.677442828556815*^9}, {3.6774439431892967`*^9, 3.6774439515543833`*^9}, 
   3.677444004989415*^9, 3.6774443082679443`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eqdpAXYsimp", "-", "eqdpAXY"}], "/.", "simplesubs"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{3.6774451485594788`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "pAX"}], "+", 
     SuperscriptBox["pAX", "2"], "-", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pAY"}], ")"}], " ", "pAY"}]}], ")"}], " ", 
   "t", " ", "\[Epsilon]"}], "}"}]], "Output",
 CellChangeTimes->{3.677445149078133*^9}]
}, Open  ]],

Cell["\<\
So at equilibrium the difference is\
\>", "Text",
 CellChangeTimes->{{3.677444366764018*^9, 3.677444371227539*^9}, {
  3.677444406950869*^9, 3.6774444094696608`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"solpXYhat", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"0", "==", "eqdpAXYsimp"}], "/.", 
     RowBox[{
      RowBox[{"pAX", "-", "pAY"}], "\[Rule]", "dpAXYhat"}]}], ",", 
    "dpAXYhat"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.677444334310225*^9, 3.677444388894959*^9}, {
  3.67744443825561*^9, 3.6774444415595837`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"dpAXYhat", "\[Rule]", 
    FractionBox[
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"VAX", " ", "\[Sigma]AX"}], "-", 
        RowBox[{"VAY", " ", "\[Sigma]AY"}]}], ")"}]}], 
     RowBox[{"4", " ", "r", " ", "\[Epsilon]"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.67744434764122*^9, 3.677444389395555*^9, 
  3.677444442547694*^9}]
}, Open  ]],

Cell["Check", "Text",
 CellChangeTimes->{{3.6774444164140377`*^9, 3.677444417069944*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Series", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"eqdpAXYsimp", "/.", 
        RowBox[{"pAY", "\[Rule]", 
         RowBox[{"pAX", "-", "dpAXYhat"}]}]}], "/.", "solpXYhat"}], "/.", 
      "simplesubs"}], "/.", 
     RowBox[{"t", "\[Rule]", "0"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.677441998089621*^9, 3.6774421386009893`*^9}, {
   3.6774422247339354`*^9, 3.677442302049163*^9}, {3.677442899336335*^9, 
   3.677442955372856*^9}, {3.677444045177655*^9, 3.677444122155261*^9}, {
   3.677444188600914*^9, 3.67744419467865*^9}, 3.677444314197526*^9, 
   3.677444357772574*^9, {3.677444424951333*^9, 3.6774444476661043`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  InterpretationBox[
   SuperscriptBox[
    RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
   SeriesData[$CellContext`\[Epsilon], 0, {}, 2, 2, 1],
   Editable->False], "}"}]], "Output",
 CellChangeTimes->{{3.677442039217256*^9, 3.677442074176465*^9}, {
   3.677442109019339*^9, 3.677442135874013*^9}, 3.6774421676626883`*^9, {
   3.6774422307456636`*^9, 3.677442302508541*^9}, {3.6774424808178587`*^9, 
   3.677442489883127*^9}, {3.677442906276326*^9, 3.6774429726444387`*^9}, {
   3.6774440480941267`*^9, 3.677444050943737*^9}, {3.677444111887896*^9, 
   3.677444123225643*^9}, 3.6774443148328857`*^9, 3.67744435827171*^9, {
   3.6774444274682302`*^9, 3.67744444832874*^9}}]
}, Open  ]],

Cell["\<\
Now, the change in the frequency of A in the whole population is, to first \
order,\
\>", "Text",
 CellChangeTimes->{{3.677441629569414*^9, 3.677441683874423*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Series", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{"{", 
                   RowBox[{
                    RowBox[{"2", "XAfprime"}], "+", "XAmprime", "+", 
                    "YAprime", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "XAf"}], "+", "XAm", "+", "YA"}], ")"}]}], 
                   "}"}], "/.", "subequil"}], "/.", "frequenciessub"}], "/.", 
                "weaksel"}], "/.", "weakr"}], "/.", 
              RowBox[{"\[Alpha]", "\[Rule]", 
               RowBox[{"1", "/", "2"}]}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
           "]"}], "/", "4"}], "/.", "sol0tight"}], "/.", "sol0tight"}], "/.", 
       
       RowBox[{"pXf1", "\[Rule]", 
        RowBox[{"dpAXfXm", "+", "pXm1"}]}]}], "/.", "sol1tight"}], "/.", 
     RowBox[{"pXm0", "\[Rule]", "pAX"}]}], "/.", 
    RowBox[{"pY0", "\[Rule]", "pAY"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6774416591005096`*^9, 3.677441710811499*^9}, {
  3.6774417708488503`*^9, 3.677441773784933*^9}, {3.677441909054555*^9, 
  3.6774419114423313`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "8"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["pAX", "3"], " ", "sAf"}], "+", 
     RowBox[{"2", " ", "hAf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pAX"}], ")"}], " ", "pAX", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "pAX"}]}], ")"}], " ", "sAf"}], "+", 
     RowBox[{
      SuperscriptBox["pAX", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "sAf"}], "-", 
        RowBox[{"pAY", " ", "sAm"}], "+", 
        RowBox[{"hAm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "pAY"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
       ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pAY"}], ")"}], " ", "pAY", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}], "+", 
     RowBox[{"pAX", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "pAY"}], ")"}]}], " ", "pAY", " ", 
         "sAm"}], "+", 
        RowBox[{"hAm", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "pAY"}], ")"}], " ", "pAY"}]}], ")"}], 
         " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.677441677403491*^9, 3.6774417113614197`*^9}, {
   3.6774417713892736`*^9, 3.6774417740590982`*^9}, 3.677441916511703*^9}]
}, Open  ]],

Cell[TextData[StyleBox["(something funny going on with \[Alpha])",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.6774418694725237`*^9, 3.677441884213848*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Normal", "[", 
           RowBox[{"Series", "[", 
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{"{", 
                    RowBox[{
                    RowBox[{"2", "XAfprime"}], "+", "XAmprime", "+", 
                    "YAprime", "-", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", "XAf"}], "+", "XAm", "+", "YA"}], ")"}]}], 
                    "}"}], "/.", "subequil"}], "/.", "frequenciessub"}], "/.",
                  "weaksel"}], "/.", "weakr"}], "/.", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{"1", "-", "\[Alpha]"}], ")"}], "\[Rule]", "1"}]}], "/.", 
              RowBox[{"\[Alpha]", "\[Rule]", "1"}]}], ",", 
             RowBox[{"{", 
              RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], 
           "]"}], "/", "4"}], "/.", "sol0tight"}], "/.", "sol0tight"}], "/.", 
       
       RowBox[{"pXf1", "\[Rule]", 
        RowBox[{"dpAXfXm", "+", "pXm1"}]}]}], "/.", "sol1tight"}], "/.", 
     RowBox[{"pXm0", "\[Rule]", "pAX"}]}], "/.", 
    RowBox[{"pY0", "\[Rule]", "pAY"}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.677441792250453*^9, 3.6774418109784193`*^9}, {
  3.677441918336042*^9, 3.6774419195265636`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "2"}], " ", 
      SuperscriptBox["pAX", "3"], " ", "sAf"}], "+", 
     RowBox[{"2", " ", "hAf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pAX"}], ")"}], " ", "pAX", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "pAX"}]}], ")"}], " ", "sAf"}], "+", 
     RowBox[{
      SuperscriptBox["pAX", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "sAf"}], "-", 
        RowBox[{"pAY", " ", "sAm"}], "+", 
        RowBox[{"hAm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "pAY"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
       ")"}]}], "-", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pAY"}], ")"}], " ", "pAY", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}], "+", 
     RowBox[{"pAX", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "pAY"}], ")"}]}], " ", "pAY", " ", 
         "sAm"}], "+", 
        RowBox[{"hAm", " ", 
         RowBox[{"(", 
          RowBox[{"1", "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "pAY"}], ")"}], " ", "pAY"}]}], ")"}], 
         " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.677441811973844*^9, 3.6774419222678757`*^9, 
  3.677444534460977*^9}]
}, Open  ]],

Cell["\<\
And when t=0 this reduces to van Doorn and Kirkpatrick\[CloseCurlyQuote]s\
\>", "Text",
 CellChangeTimes->{{3.677441739517432*^9, 3.6774417668550577`*^9}, {
  3.677441936062294*^9, 3.677441936213005*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"eqdpA", "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.677441712720688*^9, 3.677441723541045*^9}, 
   3.677441760334454*^9, {3.677441924997954*^9, 3.6774419300700817`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox["1", "4"], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pAX"}], ")"}], " ", "pAX", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "pAX"}], "+", 
        RowBox[{"hAf", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "pAX"}]}], ")"}]}]}], ")"}], " ", "sAf"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "pAX"}], " ", "pAY", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "2"}], "+", "pAX", "+", "pAY"}], ")"}]}], "+", 
        RowBox[{"hAm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pAX", "+", "pAY"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "pAY"}], "+", 
           RowBox[{"pAX", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "pAY"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
      "sAm"}]}], ")"}], " ", "\[Epsilon]"}], "}"}]], "Output",
 CellChangeTimes->{{3.6774417173931627`*^9, 3.677441724019643*^9}, 
   3.677441760614122*^9, 3.677441931131617*^9, 3.677442716867261*^9, 
   3.67744453759449*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"3", "VAX", " ", "\[Sigma]AX"}], "+", 
  RowBox[{"VAY", " ", "\[Sigma]AY"}]}]], "Input",
 CellChangeTimes->{{3.6774445534849463`*^9, 3.6774445606606216`*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
External stability (tight linkage)\
\>", "Section",
 CellChangeTimes->{{3.675898184242074*^9, 3.675898192657653*^9}, {
   3.6766823621496687`*^9, 3.676682365402493*^9}, {3.676682824936212*^9, 
   3.676682839700041*^9}, 3.676721662499631*^9, {3.676726557160334*^9, 
   3.676726564889889*^9}, 3.677430339266128*^9, {3.677430417573669*^9, 
   3.6774304179742393`*^9}, {3.677430766860592*^9, 3.677430783818014*^9}}],

Cell["\<\
Here we are interested in the ability of a rare y mutant to invade the \
non-mutant resident population at equilibrium.\
\>", "Text",
 CellChangeTimes->{{3.676720412976615*^9, 3.676720459024542*^9}, {
  3.676720582555089*^9, 3.676720586782763*^9}, {3.676721687580276*^9, 
  3.676721687767557*^9}, {3.6767265489351683`*^9, 3.676726549465045*^9}}],

Cell["\<\
Remember that we don\[CloseCurlyQuote]t have recursions for XAyf or Xayf \
because y is a dominant male determining gene. However, we allowed these \
genotypes to create zygotes so we can include them in the stability matrix \
(with frequencies of 0 at the start of the next generation). The Jacobian for \
the mutants is\
\>", "Text",
 CellChangeTimes->{{3.6758991929846497`*^9, 3.67589926406907*^9}, {
  3.67589934114139*^9, 3.6758993427645893`*^9}, {3.675900036907325*^9, 
  3.6759000483741083`*^9}, {3.676720403037026*^9, 3.676720404249701*^9}, {
  3.6767205532682467`*^9, 3.676720568189563*^9}, {3.676720627629078*^9, 
  3.676720646673503*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"matExtFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "XAyf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Xayf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "XAym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Xaym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "YAym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Yaym"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], "/.", "subequil"}], "//", 
    "Factor"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675899271627995*^9, 3.675899299216916*^9}, 
   3.676720301639617*^9, {3.676726501276018*^9, 3.676726501481125*^9}}],

Cell[TextData[{
 "It seems that Yy-bearing males have no effect on the invasion as they would \
have been males anyway (",
 StyleBox["because last two columns all zeros?",
  FontColor->RGBColor[1, 0, 0]],
 "). The inclusion of Xiyf is also irrelevant as mutations arising in gametes \
from females are in males in the next generation (",
 StyleBox["how do you see this?",
  FontColor->RGBColor[1, 0, 0]],
 "). "
}], "Text",
 CellChangeTimes->{{3.6759000512139807`*^9, 3.6759001148215*^9}, {
   3.676721768468625*^9, 3.67672179243963*^9}, 3.6767218319050303`*^9, {
   3.676721869719993*^9, 3.67672187700138*^9}, {3.676721932344289*^9, 
   3.676721977677863*^9}}],

Cell["The Jacobian gives the characteristic polynomial", "Text",
 CellChangeTimes->{{3.676720657206951*^9, 3.676720663725732*^9}, {
  3.676721991017548*^9, 3.676722004811944*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyExt", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matExtFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "6", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6758993091981916`*^9, 3.6758993092948217`*^9}}],

Cell["\<\
The above implicitly assumed that r and R were of order 1. Here we see how \
assuming linkage of order \[Epsilon] affects the results.\
\>", "Text",
 CellChangeTimes->{{3.676724344388238*^9, 3.676724380110772*^9}}],

Cell[CellGroupData[{

Cell["\<\
Tight linkage between autosomal and original sex-determining loci\
\>", "Subsubsection",
 CellChangeTimes->{{3.6767248863867493`*^9, 3.67672490941903*^9}}],

Cell["\<\
First, let recombination between the autosomal and original sex-determining \
loci be the same order as selection\
\>", "Text",
 CellChangeTimes->{{3.676724381640739*^9, 3.676724414833284*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weakr", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"r", "\[Rule]", 
      RowBox[{"r", "*", "\[Epsilon]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6767250591748943`*^9, 3.676725059965764*^9}}],

Cell["To zero order the eigenvalues are", "Text",
 CellChangeTimes->{{3.676724558402609*^9, 3.676724568003216*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Alpha]", "\[Rule]", 
         RowBox[{
          RowBox[{"1", "/", "2"}], "+", 
          RowBox[{"\[Delta]\[Alpha]", "*", 
           SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", "weakr"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.6767244823949614`*^9, 3.676724513709134*^9}, {
  3.676732793774232*^9, 3.676732802453367*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    FractionBox["1", "2"]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6767244833339243`*^9, 3.6767245142018147`*^9}, 
   3.676725061518611*^9, 3.6767260008785048`*^9, 3.676726064848021*^9, 
   3.676730790815566*^9, {3.676732787987349*^9, 3.6767328040787487`*^9}, 
   3.676747401124319*^9, 3.677430335213666*^9, 3.6774310149373703`*^9}]
}, Open  ]],

Cell["and on this order the leading eigenvalue is 1.", "Text",
 CellChangeTimes->{{3.6767245714084063`*^9, 3.6767246027807198`*^9}}],

Cell["On the first order the eigenvalue is", "Text",
 CellChangeTimes->{{3.676724607511999*^9, 3.676724616751094*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
              RowBox[{"\[Alpha]", "\[Rule]", 
               RowBox[{
                RowBox[{"1", "/", "2"}], "+", 
                RowBox[{"\[Delta]\[Alpha]", "*", 
                 SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", 
             RowBox[{"\[Lambda]", "\[Rule]", 
              RowBox[{"1", "+", 
               RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], "/.", 
            "frequenciessub"}], "/.", "sol0"}], "/.", 
          RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", 
         RowBox[{"pXf1", "\[Rule]", 
          RowBox[{"dpAXfY", "+", "pY1"}]}]}], "/.", "eqdpAXfY"}], "/.", 
       "weakr"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol\[Delta]\[Lambda]1AonOldTight", "=", 
  RowBox[{
   RowBox[{"\[Delta]\[Lambda]1", "/.", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.676724519439756*^9, 3.676724549258483*^9}, {
  3.676724623973028*^9, 3.67672462595586*^9}, {3.676724681060487*^9, 
  3.676724744057993*^9}, {3.676724774151531*^9, 3.67672478548872*^9}, {
  3.6767250516801987`*^9, 3.676725056117838*^9}, {3.676730939922304*^9, 
  3.676730955515584*^9}, {3.67673295574433*^9, 3.6767329569811287`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "r"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "hAm"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", "sAm"}]}], 
      ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"pA", " ", "sAm"}], "+", 
        RowBox[{"hAm", " ", 
         RowBox[{"(", 
          RowBox[{"sAm", "-", 
           RowBox[{"2", " ", "pA", " ", "sAm"}]}], ")"}]}], "+", "t"}], ")"}],
       "2"]}], 
    SuperscriptBox["r", "2"]]}], "}"}]], "Output",
 CellChangeTimes->{{3.676724507201425*^9, 3.6767245499257*^9}, 
   3.676724626681284*^9, {3.676724719829958*^9, 3.6767247444467707`*^9}, {
   3.6767247752820663`*^9, 3.6767247858487453`*^9}, {3.676725056734373*^9, 
   3.676725063128633*^9}, 3.676726067980661*^9, 3.6767307910149918`*^9, {
   3.676730948439028*^9, 3.676730957269607*^9}, 3.676747401394497*^9, 
   3.677430335412507*^9, 3.677431015989326*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", 
            RowBox[{"\[Delta]\[Alpha]", "*", 
             SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", 
         RowBox[{"\[Lambda]", "\[Rule]", 
          RowBox[{"1", "+", 
           RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], "/.", 
        "frequenciessub"}], "/.", "weakr"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol\[Delta]\[Lambda]1AonOldTight", "=", 
  RowBox[{
   RowBox[{"\[Delta]\[Lambda]1", "/.", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}]}], "//",
    "Simplify"}]}]}], "Input",
 CellChangeTimes->{3.677431125675961*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{"pXf0", "-", "pY0"}], ")"}]}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "pXf0"}], " ", "sAm"}], "+", 
     RowBox[{"hAm", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "pXf0"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
    ")"}]}], "}"}]], "Output",
 CellChangeTimes->{3.677431126713822*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kirk", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{
                  RowBox[{
                   RowBox[{
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "VA"}], " ", "SA", " ", "LA"}], "/.", 
                    RowBox[{"VA", "\[Rule]", 
                    RowBox[{
                    RowBox[{
                    FractionBox["3", "4"], "pAX", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pAX"}], ")"}]}], "+", 
                    RowBox[{
                    FractionBox["1", "4"], "pAY", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "pAY"}], ")"}]}]}]}]}], "/.", 
                    RowBox[{"SA", "\[Rule]", 
                    RowBox[{"4", 
                    FractionBox[
                    RowBox[{
                    SuperscriptBox["\[Sigma]AY", "2"], "\[Sigma]AX"}], 
                    RowBox[{"\[Sigma]AX", "-", "\[Sigma]AY"}]]}]}]}], "/.", 
                   RowBox[{"LA", "\[Rule]", 
                    FractionBox[
                    RowBox[{"1", "-", 
                    RowBox[{"2", "r"}]}], "r"]}]}], "/.", 
                  RowBox[{"\[Sigma]AX", "\[Rule]", 
                   RowBox[{
                    RowBox[{
                    FractionBox["2", "3"], 
                    RowBox[{"(", 
                    RowBox[{"pAX", "+", 
                    RowBox[{"hAf", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", "pAX"}]}], ")"}]}]}], ")"}], "\[Epsilon]", 
                    " ", "sAf"}], "+", 
                    RowBox[{
                    FractionBox["1", "3"], 
                    RowBox[{"(", 
                    RowBox[{"pAY", "+", 
                    RowBox[{"hAm", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", "pAY"}]}], ")"}]}]}], ")"}], "\[Epsilon]", 
                    " ", "sAm"}]}]}]}], "/.", 
                 RowBox[{"\[Sigma]AY", "\[Rule]", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{"pAX", "+", 
                    RowBox[{"hAm", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", "pAX"}]}], ")"}]}]}], ")"}], "\[Epsilon]", 
                   " ", "sAm"}]}]}], "/.", 
                RowBox[{"pAX", "\[Rule]", 
                 FractionBox[
                  RowBox[{
                   RowBox[{"2", "XAf"}], "+", 
                   RowBox[{"XAm", "/", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], "3"]}]}], "/.", 
               RowBox[{"pAY", "\[Rule]", 
                RowBox[{"YA", "/", "\[Alpha]"}]}]}], "/.", "subequil"}], "/.",
              "frequenciessub"}], "/.", "sol0"}], "/.", 
           RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", 
          RowBox[{"pXf1", "\[Rule]", 
           RowBox[{"dpAXfY", "+", "pY1"}]}]}], "/.", "eqdpAXfY"}], "/.", 
        RowBox[{"equilpA", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
       RowBox[{"\[Alpha]", "\[Rule]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "+", 
         RowBox[{"\[Delta]\[Alpha]", "*", 
          SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
   "Factor"}]}]], "Input",
 CellChangeTimes->{{3.676731133337426*^9, 3.676731371943714*^9}, {
  3.676731525264682*^9, 3.676731527663677*^9}, {3.6767316472063828`*^9, 
  3.676731710268386*^9}, {3.676731742749237*^9, 3.676731771263085*^9}, {
  3.676731804345645*^9, 3.676731890315055*^9}, {3.6767319844979563`*^9, 
  3.6767319879301023`*^9}, {3.676732058519732*^9, 3.676732059935276*^9}, {
  3.6767321225388803`*^9, 3.676732136031856*^9}, {3.676732211433106*^9, 
  3.676732216703061*^9}, {3.676732350631719*^9, 3.676732381995278*^9}, {
  3.676732454661425*^9, 3.6767324566948547`*^9}, {3.6767331001433277`*^9, 
  3.6767331308412027`*^9}, {3.676733169641725*^9, 3.67673317037971*^9}, {
  3.6767333224142017`*^9, 3.676733323546414*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  InterpretationBox[
   RowBox[{
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "r"}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hAf", " ", "sAf"}], "-", 
         RowBox[{"hAm", " ", "sAf"}]}], ")"}], "2"], " ", 
      SuperscriptBox["sAm", "2"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"hAf", " ", "sAf"}], "+", 
        RowBox[{"hAm", " ", "sAm"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "sAf"}], "+", 
        RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
        RowBox[{"hAm", " ", "sAm"}]}], ")"}], " ", 
      SuperscriptBox["\[Epsilon]", "2"]}], 
     RowBox[{"r", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "sAf"}], "+", 
         RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}], "4"]}]], "+", 
    InterpretationBox[
     SuperscriptBox[
      RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
     SeriesData[$CellContext`\[Epsilon], 0, {}, 2, 3, 1],
     Editable->False]}],
   SeriesData[$CellContext`\[Epsilon], 
    0, {$CellContext`r^(-1) (-1 + 
      2 $CellContext`r) ($CellContext`hAf $CellContext`sAf - $CellContext`hAm \
$CellContext`sAf)^2 $CellContext`sAm^2 ($CellContext`hAf $CellContext`sAf + \
$CellContext`hAm $CellContext`sAm) (-$CellContext`sAf + $CellContext`hAf \
$CellContext`sAf - $CellContext`sAm + $CellContext`hAm $CellContext`sAm) \
(-$CellContext`sAf + 2 $CellContext`hAf $CellContext`sAf - $CellContext`sAm + 
       2 $CellContext`hAm $CellContext`sAm)^(-4)}, 2, 3, 1],
   Editable->False], "}"}]], "Output",
 CellChangeTimes->{
  3.6767311403044653`*^9, 3.676731231060092*^9, 3.676731372458807*^9, {
   3.676731682573903*^9, 3.676731710796564*^9}, {3.676731743990773*^9, 
   3.676731771866705*^9}, {3.6767318061776133`*^9, 3.6767318907000504`*^9}, {
   3.676731985300459*^9, 3.676731988157764*^9}, 3.6767320604049253`*^9, {
   3.676732128023511*^9, 3.676732139306919*^9}, {3.676732213267605*^9, 
   3.676732216904001*^9}, {3.676732352898157*^9, 3.676732382241337*^9}, 
   3.676732457808185*^9, {3.676733104506151*^9, 3.6767331310442*^9}, 
   3.6767331707833977`*^9, 3.6767333246046057`*^9, 3.676747404590232*^9, 
   3.6774303385389023`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"test", "/", 
     RowBox[{"Normal", "[", "kirk", "]"}]}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.676733330985578*^9, 3.676733376248108*^9}, {
  3.6767334344557323`*^9, 3.6767334453270817`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"r", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"sAf", "-", 
           RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
           RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}], "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "sAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "hAf"}], ")"}], " ", "sAf"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "hAm"}], ")"}], " ", "sAm"}]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"hAf", " ", "sAf"}], "+", 
          RowBox[{"hAm", " ", "sAm"}]}], ")"}]}]}], ")"}]}], 
    RowBox[{"r", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "r"}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "sAm"}]}], ")"}], 
      "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.676733334105858*^9, 3.6767333765259457`*^9}, 
   3.676733445750627*^9, 3.676747405043742*^9, 3.677430338889632*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Tight linkage between autosomal and novel sex-determining loci\
\>", "Subsubsection",
 CellChangeTimes->{{3.6767248863867493`*^9, 3.676724922813457*^9}}],

Cell["\<\
Next, let recombination between the autosomal and novel sex-determining loci \
be the same order as selection\
\>", "Text",
 CellChangeTimes->{{3.676724381640739*^9, 3.676724414833284*^9}, {
  3.676724932832449*^9, 3.676724937436001*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weakR", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R", "\[Rule]", 
      RowBox[{"R", " ", "\[Epsilon]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"r", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676724941091825*^9, 3.676724950804394*^9}}],

Cell["To zero order the eigenvalues are", "Text",
 CellChangeTimes->{{3.676724558402609*^9, 3.676724568003216*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Alpha]", "\[Rule]", 
         RowBox[{
          RowBox[{"1", "/", "2"}], "+", 
          RowBox[{"\[Delta]\[Alpha]", "*", 
           SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", "weakR"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.6767244823949614`*^9, 3.676724513709134*^9}, 
   3.676724953838231*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6767244833339243`*^9, 3.6767245142018147`*^9}, 
   3.6767249543972197`*^9, 3.676725079835832*^9, 3.676726080299958*^9, 
   3.676730791066903*^9, 3.676747405100821*^9, 3.6774303389378157`*^9}]
}, Open  ]],

Cell["and on this order the leading eigenvalue is 1.", "Text",
 CellChangeTimes->{{3.6767245714084063`*^9, 3.6767246027807198`*^9}}],

Cell["On the first order the eigenvalue is", "Text",
 CellChangeTimes->{{3.676724607511999*^9, 3.676724616751094*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", 
            RowBox[{"\[Delta]\[Alpha]", "*", 
             SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", 
         RowBox[{"\[Lambda]", "\[Rule]", 
          RowBox[{"1", "+", 
           RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], "/.", 
        "frequenciessub"}], "/.", "sol0"}], "/.", 
      RowBox[{"pY0", "\[Rule]", "pA"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.67672526317986*^9, 3.676725280126062*^9}, {
  3.6767259418752747`*^9, 3.6767259744703207`*^9}, {3.676726015615571*^9, 
  3.6767260188780403`*^9}, {3.676726097628949*^9, 3.6767262165611467`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", "0"}], "}"}]], "Output",
 CellChangeTimes->{{3.676725267477192*^9, 3.6767252804579887`*^9}, {
   3.676725952528433*^9, 3.676725974979321*^9}, {3.676726008313591*^9, 
   3.676726019635515*^9}, {3.676726083749288*^9, 3.676726182852048*^9}, 
   3.6767262175038233`*^9, 3.6767307911006517`*^9, 3.676747405144644*^9, 
   3.67743033897466*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
             RowBox[{"\[Alpha]", "\[Rule]", 
              RowBox[{
               RowBox[{"1", "/", "2"}], "+", 
               RowBox[{"\[Delta]\[Alpha]", "*", 
                SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", 
            RowBox[{"\[Lambda]", "\[Rule]", 
             RowBox[{"1", "+", 
              RowBox[{"\[Delta]\[Lambda]2", "*", 
               SuperscriptBox["\[Epsilon]", "2"]}]}]}]}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], "/.", 
         RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", 
        RowBox[{"pXf1", "\[Rule]", 
         RowBox[{"dpAXfY", "+", "pY1"}]}]}], "/.", "eqdpAXfY"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]\[Lambda]2", "/.", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]2"}], "]"}]}], "//",
    "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol\[Delta]\[Lambda]2AonNewTight", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{"%", "/.", "weakR"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", 
       RowBox[{"-", "1"}]}], "}"}]}], "]"}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.676724519439756*^9, 3.676724549258483*^9}, {
   3.676724623973028*^9, 3.67672462595586*^9}, {3.676724681060487*^9, 
   3.676724744057993*^9}, {3.676724774151531*^9, 3.67672478548872*^9}, {
   3.676724960553857*^9, 3.6767250041206627`*^9}, {3.676725084667059*^9, 
   3.67672510448884*^9}, 3.676725166554488*^9, {3.676726224819807*^9, 
   3.676726339259191*^9}, {3.67672637656812*^9, 3.676726377242518*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  InterpretationBox[
   RowBox[{
    RowBox[{"-", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pA", " ", "sAm"}], "+", 
          RowBox[{"hAm", " ", 
           RowBox[{"(", 
            RowBox[{"sAm", "-", 
             RowBox[{"2", " ", "pA", " ", "sAm"}]}], ")"}]}], "+", "t"}], 
         ")"}], "2"]}], 
      RowBox[{"R", " ", "\[Epsilon]"}]]}], "+", 
    InterpretationBox[
     SuperscriptBox[
      RowBox[{"O", "[", "\[Epsilon]", "]"}], "0"],
     SeriesData[$CellContext`\[Epsilon], 0, {}, -1, 0, 1],
     Editable->False]}],
   SeriesData[$CellContext`\[Epsilon], 
    0, {-(-1 + $CellContext`pA) $CellContext`pA $CellContext`R^(-1) \
($CellContext`pA $CellContext`sAm + $CellContext`hAm ($CellContext`sAm - 
         2 $CellContext`pA $CellContext`sAm) + $CellContext`t)^2}, -1, 0, 1],
   Editable->False], "}"}]], "Output",
 CellChangeTimes->{{3.676724507201425*^9, 3.6767245499257*^9}, 
   3.676724626681284*^9, {3.676724719829958*^9, 3.6767247444467707`*^9}, {
   3.6767247752820663`*^9, 3.6767247858487453`*^9}, {3.6767249611311703`*^9, 
   3.6767250052091722`*^9}, {3.676725090561853*^9, 3.676725104951371*^9}, {
   3.6767251618537397`*^9, 3.676725166887063*^9}, {3.676726219569068*^9, 
   3.676726260604478*^9}, {3.6767263055730133`*^9, 3.676726339557445*^9}, 
   3.6767263778071957`*^9, 3.6767307911993933`*^9, 3.676747405256954*^9, 
   3.67743033907758*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["ZW invasion", "Title",
 CellChangeTimes->{{3.6773584010554647`*^9, 3.677358404404995*^9}}],

Cell[CellGroupData[{

Cell["Recursions", "Section",
 CellChangeTimes->{{3.6756910197792797`*^9, 3.675691024113359*^9}, {
   3.67569412935745*^9, 3.6756941314240303`*^9}, {3.675707349839982*^9, 
   3.675707351884247*^9}, {3.675709974013658*^9, 3.675709982915987*^9}, {
   3.6757923469668207`*^9, 3.675792350124728*^9}, 3.676676690696854*^9, {
   3.677350035605269*^9, 3.67735004069977*^9}, 3.677358409575016*^9}],

Cell["\<\
We consider three loci: 1) a diallelic autosomal locus, 2) an original \
diallelic sex-determining locus, and 3) a novel diallelic sex-determining \
locus. We assume that most gametes have the null/wild-type allele at the \
novel sex-determining locus, but a few have a new mutation y at this locus, \
which is masculinizing and is dominant over the original diallelic \
sex-determining locus (making that locus superfluous). 

Definitions:

Let XAf be the frequency of haploid genotypes in eggs with allele A at the \
diallelic autosomal locus and the null allele at the novel sex-determining \
locus (these necessarily have the X allele at the original sex-determining \
locus).
Let XAm be the frequency of haploid genotypes in gametes/pollen from males \
with allele A at the diallelic autosomal locus, the X allele at the original \
diallelic sex-determining locus, and the null allele at the novel \
sex-determining locus. 
Let YA be the frequency of haploid genotypes in gametes/pollen from males \
with allele A at the diallelic autosomal locus, the Y allele at the original \
diallelic sex-determining locus, and the null allele at the novel \
sex-determining locus. 

Let XAyf be the frequency of of haploid genotypes in eggs with allele A at \
the diallelic autosomal locus and the mutant y allele at the novel diallelic \
sex-determining locus (this can only happen if the mutation arises during the \
haploid stage, otherwise the y mutation would have made the diploid parent \
male).
Let XAym be the frequency of of haploid genotypes in gametes/pollen from \
males with allele A at the diallelic autosomal locus, the X allele at the \
original sex-determining locus, and the mutant y allele at the novel \
diallelic sex-determining locus.
Let YAy be the frequency of of haploid genotypes in gametes/pollen from males \
with allele A at the diallelic autosomal locus, the Y allele at the original \
sex-determining locus, and the mutant y allele at the novel diallelic \
sex-determining locus.

Exhanging A for a (e.g., Xaf) gives the frequency of haploid genotypes in \
gametes from that sex with the same alleles at the sex-determing loci and \
allele a at the autosomal locus. \
\>", "Text",
 CellChangeTimes->{{3.675646210075425*^9, 3.6756462139879293`*^9}, {
   3.675692881948024*^9, 3.675692905462323*^9}, {3.675702634397826*^9, 
   3.6757026600570383`*^9}, {3.675710000498989*^9, 3.675710437600037*^9}, {
   3.6757106247367887`*^9, 3.675710626158669*^9}, {3.675792380024247*^9, 
   3.6757924424434967`*^9}, {3.6766767101519136`*^9, 3.676676821916243*^9}, {
   3.676676854671156*^9, 3.676676936090798*^9}, {3.676676969927855*^9, 
   3.6766771026976233`*^9}, {3.6766771405687523`*^9, 3.676677267000321*^9}, {
   3.6766773144445467`*^9, 3.676677512953319*^9}, {3.676677557552327*^9, 
   3.676677565011045*^9}, {3.676677607075321*^9, 3.676677629948578*^9}, {
   3.676677676927281*^9, 3.6766777279544153`*^9}, 3.6766803851556997`*^9, {
   3.676718228269043*^9, 3.67671857645955*^9}, {3.6767186285743513`*^9, 
   3.676718650021899*^9}, {3.676718688595542*^9, 3.67671875039115*^9}, {
   3.676718828725091*^9, 3.6767189461231413`*^9}, {3.676718984364105*^9, 
   3.6767190359341183`*^9}}],

Cell[CellGroupData[{

Cell["Haploid selection", "Subsection",
 CellChangeTimes->{{3.676680390552682*^9, 3.676680393224043*^9}}],

Cell["\<\
We start with haploid selection, which occurs in sperm/pollen only. We assume \
male sperm/pollen compete for eggs, and that the allele at the autosomal \
locus determines their competitive ability (with relative fitnesses wA and \
wa). After selection on male gametes/pollen the frequencies of gametes in \
each sex are\
\>", "Text",
 CellChangeTimes->{{3.675646210075425*^9, 3.6756462139879293`*^9}, {
  3.675692881948024*^9, 3.675692905462323*^9}, {3.675702634397826*^9, 
  3.6757026600570383`*^9}, {3.675710000498989*^9, 3.675710437600037*^9}, {
  3.6757106247367887`*^9, 3.675710626158669*^9}, {3.675792380024247*^9, 
  3.6757924424434967`*^9}, {3.6766767101519136`*^9, 3.676676821916243*^9}, {
  3.676676854671156*^9, 3.676676936090798*^9}, {3.676676969927855*^9, 
  3.6766771026976233`*^9}, {3.6766771405687523`*^9, 3.676677267000321*^9}, {
  3.6766773144445467`*^9, 3.676677512953319*^9}, {3.676677557552327*^9, 
  3.676677565011045*^9}, {3.676677607075321*^9, 3.676677629948578*^9}, {
  3.676677676927281*^9, 3.6766777279544153`*^9}, {3.6766803851556997`*^9, 
  3.676680387344873*^9}, {3.676718778719702*^9, 3.676718805041526*^9}, {
  3.6767190397373533`*^9, 3.676719075005002*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"non", "-", 
    RowBox[{"mutant", " ", "eggs"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"XAfs", "=", "XAf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xafs", "=", "Xaf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAfs", "=", "YAf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yafs", "=", "Yaf"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mutant", " ", "eggs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwfs", "=", "XAwf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xawfs", "=", "Xawf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAwfs", "=", "YAwf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yawfs", "=", "Yawf"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mean", " ", "fitness", " ", "of", " ", "male", " ", "gametes"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wbarHap", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"wA", " ", "XAm"}], "+", 
        RowBox[{"wa", " ", "Xam"}], "+", 
        RowBox[{"wA", " ", "XAwm"}], "+", 
        RowBox[{"wa", " ", "Xawm"}]}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"wA", " ", "YAm"}], "+", 
        RowBox[{"wa", " ", "Yam"}], "+", 
        RowBox[{"wA", " ", "YAwm"}], "+", 
        RowBox[{"wa", " ", "Yawm"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "male", " ", "gametes"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAms", "=", 
     RowBox[{"wA", " ", 
      RowBox[{"XAm", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xams", "=", 
     RowBox[{"wa", " ", 
      RowBox[{"Xam", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAms", "=", " ", 
     RowBox[{"wA", " ", 
      RowBox[{"YAm", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yams", "=", " ", 
     RowBox[{"wa", " ", 
      RowBox[{"Yam", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mutant", " ", "male", " ", "gametes"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwms", "=", 
     RowBox[{"wA", " ", 
      RowBox[{"XAwm", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xawms", "=", 
     RowBox[{"wa", " ", 
      RowBox[{"Xawm", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAwms", "=", " ", 
     RowBox[{"wA", " ", 
      RowBox[{"YAwm", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yawms", "=", " ", 
     RowBox[{"wa", " ", 
      RowBox[{"Yawm", "/", "wbarHap"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675887851245193*^9, 3.675887867834023*^9}, {
  3.676677282192428*^9, 3.6766773057008953`*^9}, {3.676677524747307*^9, 
  3.676677542756909*^9}, {3.676677580215856*^9, 3.676677603744999*^9}, {
  3.676677734415629*^9, 3.676677763178328*^9}, {3.6766778776357307`*^9, 
  3.676677877865404*^9}, {3.676682591464239*^9, 3.67668260166063*^9}, {
  3.6773500606735477`*^9, 3.677350123171657*^9}, {3.677355257334691*^9, 
  3.677355296629312*^9}, {3.6773554239368267`*^9, 3.6773554527034492`*^9}, {
  3.677355492352109*^9, 3.677355517767782*^9}}],

Cell["\<\
Check that frequencies sum to one in each sex after haploid selection:\
\>", "Text",
 CellChangeTimes->{{3.675691241028049*^9, 3.675691262904736*^9}, {
   3.675691499842326*^9, 3.675691508954028*^9}, {3.6757021446730413`*^9, 
   3.6757021466313477`*^9}, 3.67570266834774*^9, {3.675710454342794*^9, 
   3.675710458811872*^9}, {3.675711308941972*^9, 3.6757113347037287`*^9}, {
   3.676677885608522*^9, 3.6766778886629477`*^9}, {3.6766794933148947`*^9, 
   3.6766794941177*^9}, {3.676718813892243*^9, 3.676718822513054*^9}, {
   3.676719082993588*^9, 3.676719084080762*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{
    "XAms", "+", "Xams", "+", "YAms", "+", "Yams", "+", "XAwms", "+", "Xawms",
      "+", "YAwms", "+", "Yawms"}]}], "//", "Factor"}], " ", 
  RowBox[{"(*", 
   RowBox[{"male", " ", "gametes"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{
    "XAfs", "+", "Xafs", "+", "XAwfs", "+", "Xawfs", "+", "YAfs", "+", "Yafs",
      "+", "YAwfs", "+", "Yawfs"}]}], "/.", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{
    "1", "-", "XAf", "-", "Xawf", "-", "XAwf", "-", "YAf", "-", "Yaf", "-", 
     "Yawf", "-", "YAwf"}]}]}], "//", "Factor", " ", 
  RowBox[{"(*", "eggs", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6757273549842978`*^9, 3.675727390607794*^9}, {
  3.6757276397063427`*^9, 3.6757276468903522`*^9}, {3.675792572534343*^9, 
  3.675792597101988*^9}, {3.676677804145811*^9, 3.676677826030532*^9}, {
  3.676677900791519*^9, 3.67667797831069*^9}, {3.676678537684183*^9, 
  3.676678542015664*^9}, {3.6767181309369173`*^9, 3.676718177588006*^9}, {
  3.677350126505292*^9, 3.677350150283494*^9}, {3.6773553518299723`*^9, 
  3.677355387456687*^9}, {3.677355471013707*^9, 3.677355472108779*^9}, {
  3.677355541534996*^9, 3.677355542975457*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, {
   3.675792579770925*^9, 3.675792597332528*^9}, 3.6758682510725803`*^9, 
   3.675884051627248*^9, 3.67588787251865*^9, 3.675894802110652*^9, 
   3.676652893924481*^9, {3.6766777919311743`*^9, 3.676677818579338*^9}, {
   3.6766779043654737`*^9, 3.676677939916746*^9}, 3.676678542469659*^9, 
   3.676718143248888*^9, 3.6767181780486*^9, 3.6767307837164783`*^9, 
   3.676747303149987*^9, 3.677350150768147*^9, 3.677355342848761*^9, 
   3.677355388467477*^9, {3.67735547297444*^9, 3.677355497450495*^9}, {
   3.677355546467103*^9, 3.6773555682275133`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, {
   3.675792579770925*^9, 3.675792597332528*^9}, 3.6758682510725803`*^9, 
   3.675884051627248*^9, 3.67588787251865*^9, 3.675894802110652*^9, 
   3.676652893924481*^9, {3.6766777919311743`*^9, 3.676677818579338*^9}, {
   3.6766779043654737`*^9, 3.676677939916746*^9}, 3.676678542469659*^9, 
   3.676718143248888*^9, 3.6767181780486*^9, 3.6767307837164783`*^9, 
   3.676747303149987*^9, 3.677350150768147*^9, 3.677355342848761*^9, 
   3.677355388467477*^9, {3.67735547297444*^9, 3.677355497450495*^9}, {
   3.677355546467103*^9, 3.677355568228874*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Random mating", "Subsection",
 CellChangeTimes->{{3.676680401113572*^9, 3.676680402700843*^9}, {
  3.676680492557345*^9, 3.676680499967092*^9}}],

Cell["\<\
After random mating, the frequencies of the diploid genotypes are\
\>", "Text",
 CellChangeTimes->{{3.675646094888542*^9, 3.675646099390658*^9}, {
  3.675646217785323*^9, 3.675646250704771*^9}, {3.67570268816877*^9, 
  3.6757027045136023`*^9}, {3.676678026615859*^9, 3.676678026799192*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"X", "-", 
    RowBox[{"Y", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"XAYA", "=", 
     RowBox[{
      RowBox[{"XAfs", " ", "YAms"}], "+", 
      RowBox[{"YAfs", " ", "XAms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYa", "=", 
     RowBox[{
      RowBox[{"XAfs", " ", "Yams"}], "+", 
      RowBox[{"Yafs", " ", "XAms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYA", "=", 
     RowBox[{
      RowBox[{"Xafs", " ", "YAms"}], "+", 
      RowBox[{"YAfs", " ", "Xams"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYa", "=", 
     RowBox[{
      RowBox[{"Xafs", " ", "Yams"}], "+", 
      RowBox[{"Yafs", " ", "Xams"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y", "-", 
     RowBox[{"Y", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAYA", "=", 
     RowBox[{"YAfs", " ", "YAms"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAYa", "=", 
     RowBox[{
      RowBox[{"YAfs", " ", "Yams"}], "+", 
      RowBox[{"Yafs", " ", "YAms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YaYa", "=", 
     RowBox[{"Yafs", " ", "Yams"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAXA", "=", 
     RowBox[{"XAfs", " ", "XAms"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAXa", "=", 
     RowBox[{
      RowBox[{"XAfs", " ", "Xams"}], "+", 
      RowBox[{"Xafs", " ", "XAms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaXa", "=", 
     RowBox[{"Xafs", " ", "Xams"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"X", "-", 
     RowBox[{"Xw", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwXA", "=", 
     RowBox[{
      RowBox[{"XAwfs", " ", "XAms"}], "+", 
      RowBox[{"XAfs", " ", "XAwms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwXa", "=", 
     RowBox[{
      RowBox[{"XAwfs", " ", "Xams"}], "+", 
      RowBox[{"Xafs", " ", "XAwms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAXaw", "=", 
     RowBox[{
      RowBox[{"XAfs", " ", "Xawms"}], "+", 
      RowBox[{"Xawfs", " ", "XAms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XawXa", "=", 
     RowBox[{
      RowBox[{"Xawfs", " ", "Xams"}], "+", 
      RowBox[{"Xafs", " ", "Xawms"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xw", "-", 
     RowBox[{"Xw", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwXAw", "=", 
     RowBox[{"XAwfs", " ", "XAwms"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwXaw", "=", 
     RowBox[{
      RowBox[{"XAwfs", " ", "Xawms"}], "+", 
      RowBox[{"Xawfs", " ", "XAwms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XawXaw", "=", 
     RowBox[{"Xawfs", " ", "Xawms"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"X", "-", 
     RowBox[{"Yw", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwYA", "=", 
     RowBox[{
      RowBox[{"XAwfs", " ", "YAms"}], "+", 
      RowBox[{"YAfs", " ", "XAwms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwYa", "=", 
     RowBox[{
      RowBox[{"XAwfs", " ", "Yams"}], "+", 
      RowBox[{"Yafs", " ", "XAwms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XawYA", "=", 
     RowBox[{
      RowBox[{"Xawfs", " ", "YAms"}], "+", 
      RowBox[{"YAfs", " ", "Xawms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XawYa", "=", 
     RowBox[{
      RowBox[{"Xawfs", " ", "Yams"}], "+", 
      RowBox[{"Yafs", " ", "Xawms"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xw", "-", 
     RowBox[{"Y", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYAw", "=", 
     RowBox[{
      RowBox[{"XAfs", " ", "YAwms"}], "+", 
      RowBox[{"YAwfs", " ", "XAms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYaw", "=", 
     RowBox[{
      RowBox[{"XAfs", " ", "Yawms"}], "+", 
      RowBox[{"Yawfs", " ", "XAms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYAw", "=", 
     RowBox[{
      RowBox[{"Xafs", " ", "YAwms"}], "+", 
      RowBox[{"YAwfs", " ", "Xams"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYaw", "=", 
     RowBox[{
      RowBox[{"Xafs", " ", "Yawms"}], "+", 
      RowBox[{"Yawfs", " ", "Xams"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xw", "-", 
     RowBox[{"Yw", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwYAw", "=", 
     RowBox[{
      RowBox[{"XAwfs", " ", "YAwms"}], "+", 
      RowBox[{"YAwfs", " ", "XAwms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XAwYaw", "=", 
     RowBox[{
      RowBox[{"XAwfs", " ", "Yawms"}], "+", 
      RowBox[{"Yawfs", " ", "XAwms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XawYAw", "=", 
     RowBox[{
      RowBox[{"Xawfs", " ", "YAwms"}], "+", 
      RowBox[{"YAwfs", " ", "Xawms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XawYaw", "=", 
     RowBox[{
      RowBox[{"Xawfs", " ", "Yawms"}], "+", 
      RowBox[{"Yawfs", " ", "Xawms"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Yw", "-", 
     RowBox[{"Y", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAwYA", "=", 
     RowBox[{
      RowBox[{"YAwfs", " ", "YAms"}], "+", 
      RowBox[{"YAfs", " ", "YAwms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAwYa", "=", 
     RowBox[{
      RowBox[{"YAwfs", " ", "Yams"}], "+", 
      RowBox[{"Yafs", " ", "YAwms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YawYA", "=", 
     RowBox[{
      RowBox[{"Yawfs", " ", "YAms"}], "+", 
      RowBox[{"YAfs", " ", "Yawms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YawYa", "=", 
     RowBox[{
      RowBox[{"Yawfs", " ", "Yams"}], "+", 
      RowBox[{"Yafs", " ", "Yawms"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Yw", "-", 
     RowBox[{"Yw", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAwYAw", "=", 
     RowBox[{"YAwfs", " ", "YAwms"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAwYaw", "=", 
     RowBox[{
      RowBox[{"YAwfs", " ", "Yawms"}], "+", 
      RowBox[{"Yawfs", " ", "YAwms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YawYaw", "=", 
     RowBox[{"Yawfs", " ", "Yawms"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675646256909181*^9, 3.675646272815617*^9}, {
   3.675646370257011*^9, 3.67564637079287*^9}, {3.675646404699778*^9, 
   3.675646517567526*^9}, {3.675646573911735*^9, 3.675646591557143*^9}, {
   3.675646627619878*^9, 3.67564663177063*^9}, {3.675646667841331*^9, 
   3.675646747122738*^9}, {3.675691396390801*^9, 3.675691472391663*^9}, {
   3.675691536695323*^9, 3.675691538414453*^9}, {3.675691639085917*^9, 
   3.675691650195237*^9}, {3.675691682513646*^9, 3.675691696533524*^9}, {
   3.675691755294464*^9, 3.6756917629827957`*^9}, {3.675691824386702*^9, 
   3.675691852603437*^9}, {3.675692700413486*^9, 3.675692712195026*^9}, {
   3.67569296671769*^9, 3.675692967464675*^9}, {3.6756930389284983`*^9, 
   3.675693095368285*^9}, {3.675693137308187*^9, 3.675693184356132*^9}, {
   3.675693221908244*^9, 3.6756932234970217`*^9}, {3.675693268122773*^9, 
   3.675693270392726*^9}, {3.675693410576119*^9, 3.675693460007984*^9}, {
   3.675693492300033*^9, 3.675693533360964*^9}, 3.675693600152028*^9, {
   3.675702177145516*^9, 3.675702196152766*^9}, {3.6757023129704742`*^9, 
   3.675702317051364*^9}, {3.675792623150811*^9, 3.675792640133086*^9}, {
   3.675792682078307*^9, 3.675792755658676*^9}, {3.676678000228277*^9, 
   3.676678010863949*^9}, {3.6766780462191133`*^9, 3.676678234810701*^9}, 
   3.676678754031591*^9, {3.6766789631458273`*^9, 3.6766789866065598`*^9}, {
   3.6773501706938*^9, 3.677350364151083*^9}, {3.6773554003020287`*^9, 
   3.677355411423438*^9}, {3.677355555521697*^9, 3.6773556751155987`*^9}, 
   3.677355718800969*^9, {3.67735575116963*^9, 3.677356038432816*^9}, {
   3.677356069249213*^9, 3.677356231234989*^9}, {3.677356275573696*^9, 
   3.6773563630366507`*^9}, {3.677356569358673*^9, 3.677356580776696*^9}, {
   3.6773566473523827`*^9, 3.6773566482388144`*^9}, {3.6773569221392736`*^9, 
   3.677356990418913*^9}, 3.677357110694276*^9, {3.677357168972973*^9, 
   3.677357178988896*^9}, {3.6773572464786158`*^9, 3.677357256973176*^9}}],

Cell["Check that they sum to one", "Text",
 CellChangeTimes->{{3.6766799013673363`*^9, 3.676679909235434*^9}, {
  3.676718082064983*^9, 3.6767180822254133`*^9}, {3.676718201654763*^9, 
  3.676718215366107*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "XAXA", "+", "XAXa", "+", "XaXa", "+", "XAYA", "+", "XAwXA", "+", "XAwXa", 
    "+", "XAXaw", "+", "XawXa", "+", "XAwYA", "+", "XAwYa", "+", "XawYA", "+",
     "XawYa", "+", "XAYAw", "+", "XAYaw", "+", "XaYAw", "+", "XaYaw", "+", 
    "XAYa", "+", "XaYA", "+", "XaYa", "+", "XAwYAw", "+", "XAwYaw", "+", 
    "XawYAw", "+", "XawYaw", "+", "XAwXAw", "+", "XAwXaw", "+", "XawXaw", "+",
     "YAwYA", "+", "YAwYa", "+", "YawYA", "+", "YawYa", "+", "YAwYAw", "+", 
    "YAwYaw", "+", "YawYaw", "+", "YAYA", "+", "YAYa", "+", "YaYa"}], "/.", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{
    "1", "-", "XAf", "-", "Xawf", "-", "XAwf", "-", "YAf", "-", "Yaf", "-", 
     "Yawf", "-", "YAwf"}]}]}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.676679556131309*^9, 3.676679588784375*^9}, {
   3.676679723115108*^9, 3.676679727031032*^9}, 3.6767181898012867`*^9, {
   3.677350372631279*^9, 3.677350422113624*^9}, {3.677356392190242*^9, 
   3.6773564445582333`*^9}, {3.677357012394704*^9, 3.677357017073349*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.676679551603032*^9, 3.676679589135474*^9}, 
   3.676679727855962*^9, 3.676718190447926*^9, 3.6767307837675533`*^9, 
   3.676747303246192*^9, 3.677350423143016*^9, 3.6773564454457083`*^9, 
   3.6773570187465067`*^9, 3.6773571154990463`*^9, {3.6773571727633133`*^9, 
   3.677357180943598*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diploid selection", "Subsection",
 CellChangeTimes->{{3.676680414738653*^9, 3.676680417091516*^9}}],

Cell["\<\
We next model selection in diploids, which can differ among the sexes. Let \
FAA, FAa, and Faa be the relative fitnesses of females homozygous for allele \
A, heterozygous, or homozygous for allele a at the autosomal locus. Similarly \
we use MAA, MAa, and Maa in males. Then after diploid selection the \
frequencies of the diploid genotypes in each sex are\
\>", "Text",
 CellChangeTimes->{{3.6756467552456417`*^9, 3.67564676342205*^9}, {
  3.675702725992881*^9, 3.67570275267984*^9}, {3.6766799909212923`*^9, 
  3.676680143326602*^9}, {3.6767190998603992`*^9, 3.676719104009471*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"mean", " ", "male", " ", "fitness"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"wbarM", "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MAA", " ", "XAYA"}], "+", 
      RowBox[{"MAa", " ", 
       RowBox[{"(", 
        RowBox[{"XAYa", "+", "XaYA"}], ")"}]}], "+", 
      RowBox[{"Maa", " ", "XaYa"}], "+", "\[IndentingNewLine]", 
      RowBox[{"MAA", " ", "YAYA"}], "+", 
      RowBox[{"MAa", " ", "YAYa"}], "+", 
      RowBox[{"Maa", " ", "YaYa"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYAs", "=", 
     RowBox[{"MAA", " ", 
      RowBox[{"XAYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYas", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XAYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYAs", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XaYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYas", "=", 
     RowBox[{"Maa", " ", 
      RowBox[{"XaYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAYAs", "=", 
     RowBox[{"MAA", " ", 
      RowBox[{"YAYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAYas", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"YAYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YaYas", "=", 
     RowBox[{"Maa", " ", 
      RowBox[{"YaYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mean", " ", "female", " ", "fitness"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wbarF", "=", 
     RowBox[{
      RowBox[{"FAA", " ", "XAXA"}], "+", 
      RowBox[{"FAa", " ", "XAXa"}], "+", 
      RowBox[{"Faa", " ", "XaXa"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "XAwXA"}], "+", 
      RowBox[{"FAa", 
       RowBox[{"(", 
        RowBox[{"XAwXa", "+", "XAXaw"}], ")"}]}], "+", 
      RowBox[{"Faa", " ", "XawXa"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "XAwXAw"}], "+", 
      RowBox[{"FAa", " ", "XAwXaw"}], "+", 
      RowBox[{"Faa", " ", "XawXaw"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "XAwYA"}], "+", 
      RowBox[{"FAa", 
       RowBox[{"(", 
        RowBox[{"XAwYa", "+", "XawYA"}], ")"}]}], "+", 
      RowBox[{"Faa", " ", "XawYa"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "XAYAw"}], "+", 
      RowBox[{"FAa", 
       RowBox[{"(", 
        RowBox[{"XAYaw", "+", "XaYAw"}], ")"}]}], "+", 
      RowBox[{"Faa", " ", "XaYaw"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "XAwYAw"}], "+", 
      RowBox[{"FAa", 
       RowBox[{"(", 
        RowBox[{"XAwYaw", "+", "XawYAw"}], ")"}]}], "+", 
      RowBox[{"Faa", " ", "XawYaw"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "YAwYA"}], "+", 
      RowBox[{"FAa", 
       RowBox[{"(", 
        RowBox[{"YAwYa", "+", "YawYA"}], ")"}]}], "+", 
      RowBox[{"Faa", " ", "YawYa"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "YAwYAw"}], "+", 
      RowBox[{"FAa", " ", "YAwYaw"}], "+", 
      RowBox[{"Faa", " ", "YawYaw"}]}]}], ";"}], " ", "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "females", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAXAs", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAXA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAXas", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaXas", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XaXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"X", "-", 
     RowBox[{"Xw", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwXAs", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAwXA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwXas", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAwXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAXaws", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAXaw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XawXas", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XawXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"X", "-", 
     RowBox[{"Yw", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYAws", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAYAw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYaws", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAYaw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYAws", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XaYAw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYaws", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XaYaw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xw", "-", 
     RowBox[{"Y", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwYAs", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAwYA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwYas", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAwYa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XawYAs", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XawYA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XawYas", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XawYa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xw", "-", 
     RowBox[{"Xw", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwXAws", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAwXAw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwXaws", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAwXaw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XawXaws", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XawXaw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xw", "-", 
     RowBox[{"Yw", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwYAws", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAwYAw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwYaws", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAwYaw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XawYAws", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XawYAw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XawYaws", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XawYaw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Yw", "-", 
     RowBox[{"Y", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAwYAs", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"YAwYA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAwYas", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"YAwYa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YawYAs", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"YawYA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YawYas", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"YawYa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Yw", "-", 
     RowBox[{"Yw", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAwYAws", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"YAwYAw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAwYaws", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"YAwYaw", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YawYaws", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"YawYaw", "/", "wbarF"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675646788099258*^9, 3.675646827315172*^9}, {
   3.675646906255657*^9, 3.6756471746197577`*^9}, {3.6756477305962267`*^9, 
   3.675647791098443*^9}, {3.675693609968581*^9, 3.6756936401475143`*^9}, {
   3.675702773030509*^9, 3.675702825109133*^9}, {3.6757958668524837`*^9, 
   3.675796079670739*^9}, {3.675796179417987*^9, 3.675796260462306*^9}, {
   3.675796480404418*^9, 3.675796481420582*^9}, {3.675796553441423*^9, 
   3.67579667834494*^9}, {3.6757967212634993`*^9, 3.67579673565335*^9}, {
   3.675796766370957*^9, 3.675796913595641*^9}, {3.675796952452533*^9, 
   3.675796955994008*^9}, {3.6757970625420837`*^9, 3.675797062966584*^9}, {
   3.675797156973634*^9, 3.675797157898295*^9}, {3.675797509731503*^9, 
   3.6757975122266283`*^9}, 3.6757987828785143`*^9, {3.675798997687969*^9, 
   3.675798999203364*^9}, {3.67668015749852*^9, 3.676680334093931*^9}, {
   3.677350482152772*^9, 3.677350828592389*^9}, {3.677357205327866*^9, 
   3.677357207661775*^9}, {3.677357311911889*^9, 3.677357463801149*^9}, {
   3.67735749619882*^9, 3.677357579598115*^9}}],

Cell["\<\
Check that frequencies of diploid genotypes in each sex sum to one after \
diploid selection:\
\>", "Text",
 CellChangeTimes->{{3.67569367511821*^9, 3.6756936990142593`*^9}, {
  3.675702840764554*^9, 3.675702847452877*^9}, {3.676680426109908*^9, 
  3.6766804300707493`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "females", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "==", 
     RowBox[{
     "XAXAs", "+", "XAXas", "+", "XaXas", "+", "\[IndentingNewLine]", 
      "XAwXAs", "+", "XAwXas", "+", "XAXaws", "+", "XawXas", "+", 
      "\[IndentingNewLine]", "XAwXAws", "+", "XAwXaws", "+", "XawXaws", "+", 
      "\[IndentingNewLine]", "XAwYAs", "+", "XAwYas", "+", "XawYAs", "+", 
      "XawYas", "+", "\[IndentingNewLine]", "XAYAws", "+", "XAYaws", "+", 
      "XaYAws", "+", "XaYaws", "+", "\[IndentingNewLine]", "XAwYAws", "+", 
      "XAwYaws", "+", "XawYAws", "+", "XawYaws", "+", "\[IndentingNewLine]", 
      "YAwYAs", "+", "YAwYas", "+", "YawYAs", "+", "YawYas", "+", "YAwYAws", 
      "+", "YAwYaws", "+", "YawYaws"}]}], "//", "Factor"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "males", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"1", "\[Equal]", 
     RowBox[{"(", "\[IndentingNewLine]", 
      RowBox[{
      "XAYAs", "+", "XAYas", "+", "XaYAs", "+", "XaYas", "+", "YAYAs", "+", 
       "YAYas", "+", "YaYas"}], ")"}]}], "//", "Factor"}]}]}]], "Input",
 CellChangeTimes->{{3.67569371292774*^9, 3.675693719435033*^9}, {
  3.675702830827154*^9, 3.675702835546769*^9}, {3.67570296812504*^9, 
  3.675702969573578*^9}, {3.675797014550261*^9, 3.675797032376533*^9}, {
  3.6757970695377398`*^9, 3.675797081268633*^9}, {3.6757973986437397`*^9, 
  3.6757974173271914`*^9}, {3.676680438445856*^9, 3.676680452334581*^9}, {
  3.677350860659713*^9, 3.677350914509626*^9}, {3.677357604583274*^9, 
  3.677357642930777*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9, 3.675727555437428*^9, 
   3.6757852556150913`*^9, 3.6757854222905197`*^9, 3.675797082754839*^9, 
   3.6757971609091988`*^9, {3.675797400992137*^9, 3.675797417649136*^9}, 
   3.675799061857813*^9, 3.675868267413929*^9, 3.675884064066042*^9, 
   3.6758879080912523`*^9, 3.675894820235918*^9, 3.6766528942324266`*^9, {
   3.6766804342274303`*^9, 3.676680453309816*^9}, 3.676730783818005*^9, 
   3.676747303361754*^9, 3.677350919847402*^9, 3.677357582027869*^9, {
   3.677357614432403*^9, 3.677357643478169*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9, 3.675727555437428*^9, 
   3.6757852556150913`*^9, 3.6757854222905197`*^9, 3.675797082754839*^9, 
   3.6757971609091988`*^9, {3.675797400992137*^9, 3.675797417649136*^9}, 
   3.675799061857813*^9, 3.675868267413929*^9, 3.675884064066042*^9, 
   3.6758879080912523`*^9, 3.675894820235918*^9, 3.6766528942324266`*^9, {
   3.6766804342274303`*^9, 3.676680453309816*^9}, 3.676730783818005*^9, 
   3.676747303361754*^9, 3.677350919847402*^9, 3.677357582027869*^9, {
   3.677357614432403*^9, 3.677357643511628*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Meiosis", "Subsection",
 CellChangeTimes->{{3.676680482410777*^9, 3.676680483790394*^9}}],

Cell["\<\
Finally, meiosis occurs. We have three recombination rates to consider (we \
assume no interference):

r: the recombination rate between the autosomal locus and and the original \
sex-determining locus
R: the recombination rate between the novel sex-determining locus and the \
autosomal locus
\[Chi]: the recombination rate between the novel sex-determingin locus and \
the original sex-determing locus

We also assume that males produce \[Alpha]% of their gametes with the Y \
allele (original sex chromosome drive if \[Alpha]\[NotEqual]1/2).
The frequencies of haploid genotypes in gametes from each at the start of the \
next generation are then\
\>", "Text",
 CellChangeTimes->{{3.675647183205927*^9, 3.675647193439426*^9}, {
  3.675702857268779*^9, 3.6757029057817707`*^9}, {3.6766805501436253`*^9, 
  3.676680733528471*^9}, {3.676681004266163*^9, 3.67668101976959*^9}, {
  3.676681152971641*^9, 3.6766811584306507`*^9}, {3.676681458381565*^9, 
  3.676681458835539*^9}, {3.676719131041935*^9, 3.676719231166504*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"male", " ", "haploids"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"XAmprime", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"XAYAs", "+", 
        RowBox[{"XAYas", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}], "+", 
        RowBox[{"r", " ", "XaYAs"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xamprime", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"XaYas", "+", 
        RowBox[{"XaYAs", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}], "+", 
        RowBox[{"r", " ", "XAYas"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAprime", "=", 
     RowBox[{
      RowBox[{"\[Alpha]", 
       RowBox[{"(", 
        RowBox[{"XAYAs", "+", 
         RowBox[{"XaYAs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}], "+", 
         RowBox[{"XAYas", " ", "r"}]}], ")"}]}], "+", "YAYAs", "+", 
      RowBox[{"YAYas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yaprime", "=", 
     RowBox[{
      RowBox[{"\[Alpha]", 
       RowBox[{"(", 
        RowBox[{"XaYas", "+", 
         RowBox[{"XAYas", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}], "+", 
         RowBox[{"XaYAs", " ", "r"}]}], ")"}]}], "+", "YaYas", "+", 
      RowBox[{"YAYas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "eggs", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAfprime", "=", 
     RowBox[{"XAXAs", "+", 
      RowBox[{"XAXas", "/", "2"}], "+", "\[IndentingNewLine]", 
      RowBox[{"XAwXAs", "/", "2"}], " ", "+", 
      RowBox[{"XAwXas", " ", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", 
      RowBox[{"XAXaws", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYAws", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
           RowBox[{"XAwYAs", " ", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYaws", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
           
           RowBox[{"XawYAs", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XaYAws", 
            RowBox[{"(", "\[Chi]", ")"}]}], "+", 
           RowBox[{"XAwYas", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xafprime", "=", 
     RowBox[{"XaXas", "+", 
      RowBox[{"XAXas", "/", "2"}], "+", "\[IndentingNewLine]", 
      RowBox[{"XawXas", "/", "2"}], " ", "+", 
      RowBox[{"XAwXas", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
      RowBox[{"XAXaws", " ", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XaYaws", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
           RowBox[{"XawYas", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYaws", 
            RowBox[{"(", "\[Chi]", ")"}]}], "+", 
           RowBox[{"XawYAs", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XaYAws", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
           
           RowBox[{"XAwYas", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
    ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAwfprime", "=", 
     RowBox[{"XAwXAws", "+", 
      RowBox[{"XAwXaws", "/", "2"}], "+", "\[IndentingNewLine]", 
      RowBox[{"XAwXAs", "/", "2"}], " ", "+", 
      RowBox[{"XAwXas", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
      RowBox[{"XAXaws", " ", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYAws", 
            RowBox[{"(", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}], ")"}]}], "+", 
           RowBox[{"XAwYAs", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYaws", " ", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XawYAs", 
            RowBox[{"(", "\[Chi]", ")"}]}], "+", 
           RowBox[{"XaYAws", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XAwYas", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}]}], 
          ")"}], "+", "\[IndentingNewLine]", "XAwYAws", "+", 
         RowBox[{"XAwYaws", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}], "+", 
         RowBox[{"XawYAws", " ", "r"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xawfprime", "=", 
     RowBox[{"XawXaws", "+", 
      RowBox[{"XAwXaws", "/", "2"}], "+", "\[IndentingNewLine]", 
      RowBox[{"XawXas", "/", "2"}], " ", "+", 
      RowBox[{"XAwXas", " ", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", 
      RowBox[{"XAXaws", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XaYaws", 
            RowBox[{"(", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}], ")"}]}], "+", 
           RowBox[{"XawYas", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYaws", " ", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XawYAs", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
           
           RowBox[{"XaYAws", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XAwYas", 
            RowBox[{"(", "\[Chi]", ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", "XawYaws", "+", 
         RowBox[{"XawYAws", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}], "+", 
         RowBox[{"XAwYaws", " ", "r"}]}], ")"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAfprime", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", "\[Alpha]", ")"}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYAws", 
            RowBox[{"(", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}], ")"}]}], "+", 
           RowBox[{"XAwYAs", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYaws", " ", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XawYAs", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
           
           RowBox[{"XaYAws", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XAwYas", 
            RowBox[{"(", "\[Chi]", ")"}]}]}], ")"}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"YAwYAs", "/", "2"}], "+", 
      RowBox[{"YAwYas", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", 
      RowBox[{"YawYAs", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yafprime", "=", 
     RowBox[{
      RowBox[{"\[Alpha]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XaYaws", 
            RowBox[{"(", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}], ")"}]}], "+", 
           RowBox[{"XawYas", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYaws", " ", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XawYAs", 
            RowBox[{"(", "\[Chi]", ")"}]}], "+", 
           RowBox[{"XaYAws", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XAwYas", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}]}], 
          ")"}]}], ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"YawYas", "/", "2"}], "+", 
      RowBox[{"YAwYas", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
      RowBox[{"YawYAs", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAwfprime", "=", 
     RowBox[{
      RowBox[{"\[Alpha]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYAws", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
           RowBox[{"XAwYAs", " ", 
            RowBox[{"(", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYaws", " ", 
            RowBox[{"(", "\[Chi]", ")"}]}], "+", 
           RowBox[{"XawYAs", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XaYAws", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
           
           RowBox[{"XAwYas", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", "XAwYAws", "+", 
         RowBox[{"XAwYaws", 
          RowBox[{"(", "r", ")"}]}], "+", 
         RowBox[{"XawYAws", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"YAwYAs", "/", "2"}], "+", 
      RowBox[{"YAwYas", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
      RowBox[{"YawYAs", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", "\[IndentingNewLine]", 
      "YAwYAws", "+", 
      RowBox[{"YAwYaws", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yawfprime", "=", 
     RowBox[{
      RowBox[{"\[Alpha]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XaYaws", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
           RowBox[{"XawYas", " ", 
            RowBox[{"(", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYaws", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
           
           RowBox[{"XawYAs", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XaYAws", 
            RowBox[{"(", "\[Chi]", ")"}]}], "+", 
           RowBox[{"XAwYas", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", "XawYaws", "+", 
         RowBox[{"XawYAws", 
          RowBox[{"(", "r", ")"}]}], "+", 
         RowBox[{"XAwYaws", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"YawYas", "/", "2"}], "+", 
      RowBox[{"YAwYas", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", 
      RowBox[{"YawYAs", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
      "\[IndentingNewLine]", "YawYaws", "+", 
      RowBox[{"YAwYaws", "/", "2"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675799680833715*^9, 3.6757996941412067`*^9}, {
   3.676680531228826*^9, 3.676680535586874*^9}, {3.676680749579172*^9, 
   3.676680842544508*^9}, {3.6773509953743277`*^9, 3.6773512684307127`*^9}, {
   3.677351334891004*^9, 3.677351342076663*^9}, {3.67735138752621*^9, 
   3.677351388607243*^9}, {3.677351477494976*^9, 3.677351505119398*^9}, {
   3.677351569763452*^9, 3.677351580187675*^9}, {3.6773517274200153`*^9, 
   3.67735172756365*^9}, {3.677351794071334*^9, 3.6773517942232656`*^9}, {
   3.677351896792802*^9, 3.677351896924975*^9}, {3.677351938054267*^9, 
   3.677351938575276*^9}, {3.677351973457924*^9, 3.6773519735282917`*^9}, {
   3.6773520142001534`*^9, 3.677352086710203*^9}, {3.677352126139724*^9, 
   3.677352212176467*^9}, {3.677352259166895*^9, 3.6773522862201347`*^9}, {
   3.677352316246559*^9, 3.677352341231503*^9}, {3.67735242024436*^9, 
   3.67735243694001*^9}, {3.677352481178084*^9, 3.677352501656518*^9}, {
   3.677352543163254*^9, 3.677352545628161*^9}, {3.677352588596156*^9, 
   3.677352758173691*^9}, {3.677353115652616*^9, 3.677353115755066*^9}, {
   3.677353207736287*^9, 3.677353240025938*^9}, {3.677353319023913*^9, 
   3.677353319335919*^9}, {3.677353370788659*^9, 3.67735345868818*^9}, {
   3.67735381761693*^9, 3.67735382057579*^9}, 3.67735385338941*^9, {
   3.6773539454997168`*^9, 3.677353993983878*^9}, {3.677354092004225*^9, 
   3.677354112258733*^9}, 3.6773541614630547`*^9, {3.6773542069054823`*^9, 
   3.6773542070507507`*^9}, {3.6773542479343863`*^9, 3.6773542640510693`*^9}, 
   3.677354314984579*^9, {3.677354477235942*^9, 3.677354628353221*^9}, {
   3.677354685704872*^9, 3.6773548593457403`*^9}, {3.6773576830289383`*^9, 
   3.677357713803296*^9}, {3.6773577672759943`*^9, 3.677357800099463*^9}, {
   3.677357897982018*^9, 3.6773580729896193`*^9}, {3.67735811957545*^9, 
   3.6773582173705273`*^9}}],

Cell["Check", "Text",
 CellChangeTimes->{{3.67668087010927*^9, 3.676680870535335*^9}, {
  3.676682191599547*^9, 3.676682193563279*^9}, {3.676682633503108*^9, 
  3.676682739077134*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{
   "XAfprime", "+", "Xafprime", "+", "XAwfprime", "+", "Xawfprime", "+", 
    "YAfprime", "+", "Yafprime", "+", "YAwfprime", "+", "Yawfprime"}]}], "//",
   "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAmprime", "+", "Xamprime", "+", "YAprime", "+", "Yaprime"}]}], "//",
   "Factor"}]}], "Input",
 CellChangeTimes->{{3.676680865590528*^9, 3.6766808676400948`*^9}, {
  3.677352762674642*^9, 3.677352784452465*^9}, {3.677354919642563*^9, 
  3.677354941385273*^9}, {3.6773580883164577`*^9, 3.677358088605237*^9}, {
  3.677358229398281*^9, 3.677358229718194*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6757998422199907`*^9, 3.6758682703443737`*^9, 3.675884066601346*^9, 
   3.67588414320271*^9, 3.675887913157668*^9, 3.6758948233446608`*^9, 
   3.676652894392449*^9, 3.676680539830617*^9, {3.6766808544919558`*^9, 
   3.676680867990182*^9}, 3.6767307839290257`*^9, 3.676747303494995*^9, 
   3.6773527868409977`*^9, 3.67735311903022*^9, 3.677353466698821*^9, 
   3.677354864847083*^9, 3.677354941676852*^9, 3.677354979331151*^9, {
   3.67735807854344*^9, 3.677358089195695*^9}, {3.677358223919837*^9, 
   3.677358230501459*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6757998422199907`*^9, 3.6758682703443737`*^9, 3.675884066601346*^9, 
   3.67588414320271*^9, 3.675887913157668*^9, 3.6758948233446608`*^9, 
   3.676652894392449*^9, 3.676680539830617*^9, {3.6766808544919558`*^9, 
   3.676680867990182*^9}, 3.6767307839290257`*^9, 3.676747303494995*^9, 
   3.6773527868409977`*^9, 3.67735311903022*^9, 3.677353466698821*^9, 
   3.677354864847083*^9, 3.677354941676852*^9, 3.677354979331151*^9, {
   3.67735807854344*^9, 3.677358089195695*^9}, {3.677358223919837*^9, 
   3.677358230529956*^9}}]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["future", "Title",
 CellChangeTimes->{{3.6774452379306593`*^9, 3.6774452384645357`*^9}}],

Cell["\<\
clean up tight linkage (including doing with A on neoY)\
\>", "Text",
 CellChangeTimes->{{3.677445274105857*^9, 3.6774453109875107`*^9}}],

Cell["\<\
give yy low fitness (and plot full spread, not just invasion. does it fix?)\
\>", "Text",
 CellChangeTimes->{{3.6774452422089357`*^9, 3.677445250720893*^9}, {
  3.677445327252328*^9, 3.677445344188929*^9}}],

Cell["\<\
make sure ZW to XY doesn\[CloseCurlyQuote]t occur in three locus model (put \
pollen comp in eggs not pollen in old model. call X a Z)\
\>", "Text",
 CellChangeTimes->{{3.677445261713191*^9, 3.677445271802081*^9}, {
  3.677445364773768*^9, 3.677445398471486*^9}}],

Cell["\<\
rewrite sigmas as marginal fitnesses\
\>", "Text",
 CellChangeTimes->{{3.677445433857983*^9, 3.677445442505226*^9}}]
}, Open  ]]
},
Evaluator->"Local2",
WindowSize->{1280, 980},
WindowMargins->{{1281, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 369, 6, 183, "Title"],
Cell[951, 30, 118, 1, 62, "Subtitle"],
Cell[1072, 33, 478, 8, 61, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1587, 46, 93, 1, 114, "Title"],
Cell[CellGroupData[{
Cell[1705, 51, 318, 4, 100, "Section"],
Cell[2026, 57, 3208, 54, 560, "Text"],
Cell[CellGroupData[{
Cell[5259, 115, 105, 1, 54, "Subsection"],
Cell[5367, 118, 1201, 18, 85, "Text"],
Cell[6571, 138, 3001, 81, 477, "Input"],
Cell[9575, 221, 581, 9, 37, "Text"],
Cell[CellGroupData[{
Cell[10181, 234, 934, 21, 57, "Input"],
Cell[11118, 257, 653, 9, 35, "Output"],
Cell[11774, 268, 653, 9, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[12476, 283, 150, 2, 54, "Subsection"],
Cell[12629, 287, 300, 5, 37, "Text"],
Cell[12932, 294, 5505, 137, 834, "Input"],
Cell[18440, 433, 210, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[18675, 440, 699, 13, 78, "Input"],
Cell[19377, 455, 213, 3, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[19639, 464, 105, 1, 54, "Subsection"],
Cell[19747, 467, 596, 9, 85, "Text"],
Cell[20346, 478, 6990, 193, 1065, "Input"],
Cell[27339, 673, 284, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[27648, 683, 1281, 25, 204, "Input"],
Cell[28932, 710, 607, 9, 35, "Output"],
Cell[29542, 721, 609, 9, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[30200, 736, 95, 1, 54, "Subsection"],
Cell[30298, 739, 1032, 20, 204, "Text"],
Cell[31333, 761, 14432, 421, 834, "Input"],
Cell[45768, 1184, 184, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[45977, 1191, 422, 11, 57, "Input"],
Cell[46402, 1204, 367, 6, 35, "Output"],
Cell[46772, 1212, 367, 6, 35, "Output"]
}, Open  ]],
Cell[47154, 1221, 252, 5, 37, "Text"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[47455, 1232, 554, 9, 62, "Section"],
Cell[48012, 1243, 179, 4, 37, "Text"],
Cell[48194, 1249, 1426, 33, 309, "Input"],
Cell[49623, 1284, 279, 5, 61, "Text"],
Cell[49905, 1291, 488, 8, 61, "Text"],
Cell[50396, 1301, 785, 15, 120, "Input"],
Cell[51184, 1318, 261, 5, 37, "Text"],
Cell[51448, 1325, 1167, 27, 225, "Input"],
Cell[52618, 1354, 229, 3, 37, "Text"],
Cell[52850, 1359, 710, 17, 120, "Input"],
Cell[53563, 1378, 365, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[53953, 1388, 1006, 20, 35, "Input"],
Cell[54962, 1410, 952, 26, 56, "Output"]
}, Open  ]],
Cell[55929, 1439, 159, 2, 37, "Text"],
Cell[CellGroupData[{
Cell[56113, 1445, 402, 9, 35, "Input"],
Cell[56518, 1456, 646, 13, 36, "Output"]
}, Open  ]],
Cell[57179, 1472, 329, 6, 37, "Text"],
Cell[57511, 1480, 467, 8, 37, "Text"],
Cell[CellGroupData[{
Cell[58003, 1492, 1181, 25, 57, "Input"],
Cell[59187, 1519, 2980, 73, 120, "Output"]
}, Open  ]],
Cell[62182, 1595, 332, 6, 61, "Text"],
Cell[62517, 1603, 211, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[62753, 1611, 703, 16, 35, "Input"],
Cell[63459, 1629, 1025, 22, 42, "Output"]
}, Open  ]],
Cell[64499, 1654, 200, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[64724, 1662, 573, 16, 35, "Input"],
Cell[65300, 1680, 1676, 39, 92, "Output"]
}, Open  ]],
Cell[66991, 1722, 202, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[67218, 1730, 477, 13, 35, "Input"],
Cell[67698, 1745, 965, 25, 59, "Output"]
}, Open  ]],
Cell[68678, 1773, 228, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[68931, 1782, 880, 18, 36, "Input"],
Cell[69814, 1802, 1479, 39, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[71330, 1846, 517, 13, 36, "Input"],
Cell[71850, 1861, 1432, 38, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73319, 1904, 764, 17, 36, "Input"],
Cell[74086, 1923, 1550, 39, 61, "Output"]
}, Open  ]],
Cell[75651, 1965, 114, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[75790, 1970, 1557, 39, 120, "Input"],
Cell[77350, 2011, 663, 21, 56, "Output"]
}, Open  ]],
Cell[78028, 2035, 110, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[78163, 2040, 316, 7, 35, "Input"],
Cell[78482, 2049, 765, 20, 57, "Output"]
}, Open  ]],
Cell[79262, 2072, 321, 6, 61, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[79620, 2083, 300, 6, 62, "Section"],
Cell[79923, 2091, 214, 4, 37, "Text"],
Cell[80140, 2097, 123, 3, 37, "Text"],
Cell[80266, 2102, 2108, 53, 183, "Input"],
Cell[82377, 2157, 142, 3, 37, "Text"],
Cell[82522, 2162, 298, 8, 36, "Input"],
Cell[82823, 2172, 262, 5, 61, "Text"],
Cell[83088, 2179, 224, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[83337, 2188, 838, 24, 78, "Input"],
Cell[84178, 2214, 1030, 30, 58, "Output"]
}, Open  ]],
Cell[85223, 2247, 132, 3, 37, "Text"],
Cell[85358, 2252, 201, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[85584, 2260, 952, 24, 57, "Input"],
Cell[86539, 2286, 403, 11, 56, "Output"]
}, Open  ]],
Cell[86957, 2300, 160, 3, 37, "Text"],
Cell[87120, 2305, 174, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[87319, 2313, 1131, 28, 78, "Input"],
Cell[88453, 2343, 1079, 31, 58, "Output"]
}, Open  ]],
Cell[89547, 2377, 124, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[89696, 2384, 980, 25, 57, "Input"],
Cell[90679, 2411, 402, 10, 56, "Output"]
}, Open  ]],
Cell[91096, 2424, 160, 3, 37, "Text"],
Cell[91259, 2429, 285, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[91569, 2439, 470, 13, 35, "Input"],
Cell[92042, 2454, 4442, 132, 327, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[96533, 2592, 396, 7, 62, "Section"],
Cell[96932, 2601, 355, 6, 37, "Text"],
Cell[97290, 2609, 659, 11, 85, "Text"],
Cell[97952, 2622, 1980, 52, 183, "Input"],
Cell[99935, 2676, 661, 14, 61, "Text"],
Cell[100599, 2692, 187, 4, 37, "Text"],
Cell[100789, 2698, 296, 8, 36, "Input"],
Cell[CellGroupData[{
Cell[101110, 2710, 130, 3, 54, "Subsection"],
Cell[101243, 2715, 123, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[101391, 2722, 538, 16, 57, "Input"],
Cell[101932, 2740, 759, 18, 57, "Output"]
}, Open  ]],
Cell[102706, 2761, 583, 10, 61, "Text"],
Cell[103292, 2773, 457, 8, 61, "Text"],
Cell[CellGroupData[{
Cell[103774, 2785, 770, 21, 57, "Input"],
Cell[104547, 2808, 596, 13, 35, "Output"]
}, Open  ]],
Cell[105158, 2824, 144, 3, 37, "Text"],
Cell[105305, 2829, 126, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[105456, 2836, 1353, 35, 99, "Input"],
Cell[106812, 2873, 558, 12, 35, "Output"]
}, Open  ]],
Cell[107385, 2888, 355, 7, 37, "Text"],
Cell[107743, 2897, 385, 10, 39, "Text"],
Cell[CellGroupData[{
Cell[108153, 2911, 1271, 34, 99, "Input"],
Cell[109427, 2947, 430, 8, 35, "Output"]
}, Open  ]],
Cell[109872, 2958, 129, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[110026, 2965, 1667, 43, 120, "Input"],
Cell[111696, 3010, 1105, 28, 59, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[112838, 3043, 172, 3, 43, "Subsubsection"],
Cell[113013, 3048, 339, 6, 61, "Text"],
Cell[CellGroupData[{
Cell[113377, 3058, 611, 13, 36, "Input"],
Cell[113991, 3073, 1602, 45, 63, "Output"]
}, Open  ]],
Cell[115608, 3121, 274, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[115907, 3131, 2057, 61, 103, "Input"],
Cell[117967, 3194, 344, 5, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[118360, 3205, 175, 3, 43, "Subsubsection"],
Cell[118538, 3210, 338, 6, 61, "Text"],
Cell[CellGroupData[{
Cell[118901, 3220, 585, 12, 36, "Input"],
Cell[119489, 3234, 1703, 46, 63, "Output"]
}, Open  ]],
Cell[121207, 3283, 199, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[121431, 3292, 1982, 59, 103, "Input"],
Cell[123416, 3353, 271, 4, 35, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[123748, 3364, 103, 1, 54, "Subsection"],
Cell[123854, 3367, 224, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[124103, 3375, 165, 3, 43, "Subsubsection"],
Cell[124271, 3380, 203, 4, 37, "Text"],
Cell[124477, 3386, 338, 9, 57, "Input"],
Cell[124818, 3397, 123, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[124966, 3404, 802, 23, 63, "Input"],
Cell[125771, 3429, 628, 13, 56, "Output"]
}, Open  ]],
Cell[126414, 3445, 140, 3, 37, "Text"],
Cell[126557, 3450, 126, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[126708, 3457, 1707, 42, 139, "Input"],
Cell[128418, 3501, 1233, 35, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[129688, 3541, 1187, 32, 78, "Input"],
Cell[130878, 3575, 2544, 73, 118, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[133459, 3653, 368, 8, 36, "Input"],
Cell[133830, 3663, 3927, 96, 146, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[137794, 3764, 323, 5, 35, "Input"],
Cell[138120, 3771, 1330, 40, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[139487, 3816, 4447, 105, 253, "Input"],
Cell[143937, 3923, 2399, 56, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[146373, 3984, 366, 9, 36, "Input"],
Cell[146742, 3995, 1698, 53, 66, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[148489, 4054, 163, 3, 43, "Subsubsection"],
Cell[148655, 4059, 248, 5, 37, "Text"],
Cell[148906, 4066, 336, 9, 57, "Input"],
Cell[149245, 4077, 123, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[149393, 4084, 779, 23, 63, "Input"],
Cell[150175, 4109, 555, 11, 35, "Output"]
}, Open  ]],
Cell[150745, 4123, 140, 3, 37, "Text"],
Cell[150888, 4128, 126, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[151039, 4135, 1180, 31, 84, "Input"],
Cell[152222, 4168, 409, 7, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[152668, 4180, 2018, 50, 138, "Input"],
Cell[154689, 4232, 1582, 37, 60, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[156344, 4277, 572, 9, 62, "Section"],
Cell[156919, 4288, 281, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[157225, 4297, 164, 3, 54, "Subsection"],
Cell[CellGroupData[{
Cell[157414, 4304, 102, 1, 35, "Input"],
Cell[157519, 4307, 976, 28, 57, "Output"]
}, Open  ]],
Cell[158510, 4338, 286, 5, 37, "Text"],
Cell[158799, 4345, 227, 6, 35, "Input"],
Cell[159029, 4353, 325, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[159379, 4363, 972, 25, 99, "Input"],
Cell[160354, 4390, 277, 5, 36, "Output"]
}, Open  ]],
Cell[160646, 4398, 136, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[160807, 4405, 467, 14, 35, "Input"],
Cell[161277, 4421, 122, 2, 35, "Output"]
}, Open  ]],
Cell[161414, 4426, 318, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[161757, 4436, 1165, 30, 78, "Input"],
Cell[162925, 4468, 703, 18, 36, "Output"]
}, Open  ]],
Cell[163643, 4489, 241, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[163909, 4498, 898, 25, 57, "Input"],
Cell[164810, 4525, 141, 3, 35, "Output"]
}, Open  ]],
Cell[164966, 4531, 170, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[165161, 4539, 1695, 39, 78, "Input"],
Cell[166859, 4580, 2128, 61, 92, "Output"]
}, Open  ]],
Cell[169002, 4644, 175, 2, 37, "Text"],
Cell[CellGroupData[{
Cell[169202, 4650, 1449, 38, 99, "Input"],
Cell[170654, 4690, 1784, 55, 70, "Output"]
}, Open  ]],
Cell[172453, 4748, 136, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[172614, 4755, 1667, 50, 89, "Input"],
Cell[174284, 4807, 1562, 48, 68, "Output"]
}, Open  ]],
Cell[175861, 4858, 212, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[176098, 4866, 313, 7, 36, "Input"],
Cell[176414, 4875, 215, 4, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[176666, 4884, 159, 3, 36, "Input"],
Cell[176828, 4889, 375, 11, 42, "Output"]
}, Open  ]],
Cell[177218, 4903, 110, 1, 37, "Text"],
Cell[177331, 4906, 1544, 45, 141, "Input"],
Cell[178878, 4953, 234, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[179137, 4962, 756, 17, 35, "Input"],
Cell[179896, 4981, 602, 12, 36, "Output"]
}, Open  ]],
Cell[180513, 4996, 112, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[180650, 5001, 549, 10, 36, "Input"],
Cell[181202, 5013, 385, 6, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[181624, 5024, 177, 5, 36, "Input"],
Cell[181804, 5031, 368, 12, 42, "Output"]
}, Open  ]],
Cell[182187, 5046, 176, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[182388, 5054, 374, 10, 35, "Input"],
Cell[182765, 5066, 427, 12, 57, "Output"]
}, Open  ]],
Cell[183207, 5081, 89, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[183321, 5086, 800, 19, 36, "Input"],
Cell[184124, 5107, 702, 13, 42, "Output"]
}, Open  ]],
Cell[184841, 5123, 173, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[185039, 5131, 1493, 39, 99, "Input"],
Cell[186535, 5172, 1789, 55, 93, "Output"]
}, Open  ]],
Cell[188339, 5230, 175, 2, 37, "Text"],
Cell[CellGroupData[{
Cell[188539, 5236, 1574, 41, 99, "Input"],
Cell[190116, 5279, 1736, 55, 92, "Output"]
}, Open  ]],
Cell[191867, 5337, 214, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[192106, 5345, 259, 5, 36, "Input"],
Cell[192368, 5352, 1362, 41, 92, "Output"]
}, Open  ]],
Cell[193745, 5396, 192, 4, 35, "Input"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[193986, 5406, 421, 7, 100, "Section"],
Cell[194410, 5415, 355, 6, 37, "Text"],
Cell[194768, 5423, 659, 11, 85, "Text"],
Cell[195430, 5436, 1980, 52, 183, "Input"],
Cell[197413, 5490, 661, 14, 61, "Text"],
Cell[198077, 5506, 179, 2, 37, "Text"],
Cell[198259, 5510, 296, 8, 36, "Input"],
Cell[198558, 5520, 224, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[198807, 5528, 165, 3, 43, "Subsubsection"],
Cell[198975, 5533, 203, 4, 37, "Text"],
Cell[199181, 5539, 338, 9, 57, "Input"],
Cell[199522, 5550, 115, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[199662, 5555, 802, 23, 63, "Input"],
Cell[200467, 5580, 652, 13, 56, "Output"]
}, Open  ]],
Cell[201134, 5596, 132, 1, 37, "Text"],
Cell[201269, 5599, 118, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[201412, 5604, 1707, 42, 139, "Input"],
Cell[203122, 5648, 1255, 35, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[204414, 5688, 1085, 30, 63, "Input"],
Cell[205502, 5720, 458, 16, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[205997, 5741, 4447, 105, 253, "Input"],
Cell[210447, 5848, 2399, 56, 63, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212883, 5909, 366, 9, 36, "Input"],
Cell[213252, 5920, 1698, 53, 66, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[214999, 5979, 163, 3, 43, "Subsubsection"],
Cell[215165, 5984, 248, 5, 37, "Text"],
Cell[215416, 5991, 336, 9, 57, "Input"],
Cell[215755, 6002, 115, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[215895, 6007, 779, 23, 63, "Input"],
Cell[216677, 6032, 555, 11, 35, "Output"]
}, Open  ]],
Cell[217247, 6046, 132, 1, 37, "Text"],
Cell[217382, 6049, 118, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[217525, 6054, 1180, 31, 84, "Input"],
Cell[218708, 6087, 409, 7, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[219154, 6099, 2018, 50, 138, "Input"],
Cell[221175, 6151, 1582, 37, 60, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[222830, 6196, 96, 1, 114, "Title"],
Cell[CellGroupData[{
Cell[222951, 6201, 389, 5, 100, "Section"],
Cell[223343, 6208, 3208, 54, 700, "Text"],
Cell[CellGroupData[{
Cell[226576, 6266, 105, 1, 67, "Subsection"],
Cell[226684, 6269, 1201, 18, 106, "Text"],
Cell[227888, 6289, 3524, 92, 701, "Input"],
Cell[231415, 6383, 581, 9, 46, "Text"],
Cell[CellGroupData[{
Cell[232021, 6396, 1256, 27, 97, "Input"],
Cell[233280, 6425, 798, 11, 43, "Output"],
Cell[234081, 6438, 796, 11, 43, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[234926, 6455, 150, 2, 67, "Subsection"],
Cell[235079, 6459, 300, 5, 46, "Text"],
Cell[235382, 6466, 9057, 236, 1462, "Input"],
Cell[244442, 6704, 210, 3, 46, "Text"],
Cell[CellGroupData[{
Cell[244677, 6711, 1055, 18, 123, "Input"],
Cell[245735, 6731, 342, 5, 43, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[246126, 6742, 105, 1, 67, "Subsection"],
Cell[246234, 6745, 596, 9, 106, "Text"],
Cell[246833, 6756, 9616, 251, 1830, "Input"],
Cell[256452, 7009, 284, 6, 46, "Text"],
Cell[CellGroupData[{
Cell[256761, 7019, 1592, 30, 307, "Input"],
Cell[258356, 7051, 679, 10, 43, "Output"],
Cell[259038, 7063, 679, 10, 43, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[259766, 7079, 95, 1, 67, "Subsection"],
Cell[259864, 7082, 1032, 20, 255, "Text"],
Cell[260899, 7104, 17369, 477, 1121, "Input"],
Cell[278271, 7583, 184, 3, 46, "Text"],
Cell[CellGroupData[{
Cell[278480, 7590, 653, 14, 71, "Input"],
Cell[279136, 7606, 581, 9, 43, "Output"],
Cell[279720, 7617, 581, 9, 43, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[280374, 7634, 93, 1, 114, "Title"],
Cell[280470, 7637, 147, 3, 37, "Text"],
Cell[280620, 7642, 216, 4, 37, "Text"],
Cell[280839, 7648, 273, 5, 37, "Text"],
Cell[281115, 7655, 126, 3, 37, "Text"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
