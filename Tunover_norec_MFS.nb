(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 8.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    282117,       7710]
NotebookOptionsPosition[    272079,       7389]
NotebookOutlinePosition[    272434,       7405]
CellTagsIndexPosition[    272391,       7402]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["(Mike Version) equilibria where r=0 and invasion where R=0. ", "Title",
 CellChangeTimes->{{3.696776945534555*^9, 3.6967769485730343`*^9}, {
  3.696779280904242*^9, 3.6967792922885637`*^9}}],

Cell[CellGroupData[{

Cell["Recursions (written as in appendix, generic loci order)", "Section",
 CellChangeTimes->{{3.6756910197792797`*^9, 3.675691024113359*^9}, {
   3.67569412935745*^9, 3.6756941314240303`*^9}, {3.675707349839982*^9, 
   3.675707351884247*^9}, {3.675709974013658*^9, 3.675709982915987*^9}, {
   3.6757923469668207`*^9, 3.675792350124728*^9}, 3.676676690696854*^9, {
   3.677350035605269*^9, 3.67735004069977*^9}, 3.677358409575016*^9, {
   3.678845319012044*^9, 3.678845320057397*^9}, 3.692607135315508*^9, {
   3.6926071764577847`*^9, 3.692607187122102*^9}, {3.693550212113646*^9, 
   3.693550235766447*^9}, {3.693554320708564*^9, 3.6935543247324944`*^9}, 
   3.693559930483079*^9}],

Cell[CellGroupData[{

Cell["Haploid selection", "Subsection",
 CellChangeTimes->{{3.676680390552682*^9, 3.676680393224043*^9}}],

Cell["\<\
We start with haploid selection, which occurs in sperm/pollen only. We assume \
male sperm/pollen compete for eggs, and that the allele at the autosomal \
locus determines their competitive ability (with relative fitnesses wA and \
wa). After selection on male gametes/pollen the frequencies of gametes in \
each sex are\
\>", "Text",
 CellChangeTimes->{{3.675646210075425*^9, 3.6756462139879293`*^9}, {
  3.675692881948024*^9, 3.675692905462323*^9}, {3.675702634397826*^9, 
  3.6757026600570383`*^9}, {3.675710000498989*^9, 3.675710437600037*^9}, {
  3.6757106247367887`*^9, 3.675710626158669*^9}, {3.675792380024247*^9, 
  3.6757924424434967`*^9}, {3.6766767101519136`*^9, 3.676676821916243*^9}, {
  3.676676854671156*^9, 3.676676936090798*^9}, {3.676676969927855*^9, 
  3.6766771026976233`*^9}, {3.6766771405687523`*^9, 3.676677267000321*^9}, {
  3.6766773144445467`*^9, 3.676677512953319*^9}, {3.676677557552327*^9, 
  3.676677565011045*^9}, {3.676677607075321*^9, 3.676677629948578*^9}, {
  3.676677676927281*^9, 3.6766777279544153`*^9}, {3.6766803851556997`*^9, 
  3.676680387344873*^9}, {3.676718778719702*^9, 3.676718805041526*^9}, {
  3.6767190397373533`*^9, 3.676719075005002*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"mean", " ", "fitness", " ", "of", " ", "female", " ", "gametes"}],
    "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"wbarHapFemale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"wAf", " ", "XAMf"}], "+", 
        RowBox[{"waf", " ", "XaMf"}], "+", 
        RowBox[{"wAf", " ", "XAmf"}], "+", 
        RowBox[{"waf", " ", "Xamf"}]}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"wAf", " ", "YAMf"}], "+", 
        RowBox[{"waf", " ", "YaMf"}], "+", 
        RowBox[{"wAf", " ", "YAmf"}], "+", 
        RowBox[{"waf", " ", "Yamf"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "eggs"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMfs", "=", 
     RowBox[{"wAf", " ", 
      RowBox[{"XAMf", "/", "wbarHapFemale"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMfs", "=", 
     RowBox[{"waf", " ", 
      RowBox[{"XaMf", "/", "wbarHapFemale"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAMfs", "=", 
     RowBox[{"wAf", " ", 
      RowBox[{"YAMf", "/", "wbarHapFemale"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YaMfs", "=", 
     RowBox[{"waf", " ", 
      RowBox[{"YaMf", "/", "wbarHapFemale"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mutant", " ", "eggs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmfs", "=", 
     RowBox[{"wAf", " ", 
      RowBox[{"XAmf", "/", "wbarHapFemale"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xamfs", "=", 
     RowBox[{"waf", " ", 
      RowBox[{"Xamf", "/", "wbarHapFemale"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmfs", "=", 
     RowBox[{"wAf", " ", 
      RowBox[{"YAmf", "/", "wbarHapFemale"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yamfs", "=", 
     RowBox[{"waf", " ", 
      RowBox[{"Yamf", "/", "wbarHapFemale"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mean", " ", "fitness", " ", "of", " ", "male", " ", "gametes"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wbarHapMale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"wAm", " ", "XAMm"}], "+", 
        RowBox[{"wam", " ", "XaMm"}], "+", 
        RowBox[{"wAm", " ", "XAmm"}], "+", 
        RowBox[{"wam", " ", "Xamm"}]}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"wAm", " ", "YAMm"}], "+", 
        RowBox[{"wam", " ", "YaMm"}], "+", 
        RowBox[{"wAm", " ", "YAmm"}], "+", 
        RowBox[{"wam", " ", "Yamm"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "male", " ", "gametes"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMms", "=", 
     RowBox[{"wAm", " ", 
      RowBox[{"XAMm", "/", "wbarHapMale"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XaMms", "=", 
     RowBox[{"wam", " ", 
      RowBox[{"XaMm", "/", "wbarHapMale"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"YAMms", "=", " ", 
     RowBox[{"wAm", " ", 
      RowBox[{"YAMm", "/", "wbarHapMale"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"YaMms", "=", " ", 
     RowBox[{"wam", " ", 
      RowBox[{"YaMm", "/", "wbarHapMale"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mutant", " ", "male", " ", "gametes"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmms", "=", 
     RowBox[{"wAm", " ", 
      RowBox[{"XAmm", "/", "wbarHapMale"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Xamms", "=", 
     RowBox[{"wam", " ", 
      RowBox[{"Xamm", "/", "wbarHapMale"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"YAmms", "=", " ", 
     RowBox[{"wAm", " ", 
      RowBox[{"YAmm", "/", "wbarHapMale"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"Yamms", "=", " ", 
     RowBox[{"wam", " ", 
      RowBox[{"Yamm", "/", "wbarHapMale"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675887851245193*^9, 3.675887867834023*^9}, {
  3.676677282192428*^9, 3.6766773057008953`*^9}, {3.676677524747307*^9, 
  3.676677542756909*^9}, {3.676677580215856*^9, 3.676677603744999*^9}, {
  3.676677734415629*^9, 3.676677763178328*^9}, {3.6766778776357307`*^9, 
  3.676677877865404*^9}, {3.676682591464239*^9, 3.67668260166063*^9}, {
  3.6773500606735477`*^9, 3.677350123171657*^9}, {3.677355257334691*^9, 
  3.677355296629312*^9}, {3.6773554239368267`*^9, 3.6773554527034492`*^9}, {
  3.677355492352109*^9, 3.677355517767782*^9}, {3.678642619660035*^9, 
  3.678642623154952*^9}, {3.6926071163235397`*^9, 3.6926071425481377`*^9}, {
  3.69260720024391*^9, 3.6926074073917637`*^9}, {3.693574914336934*^9, 
  3.6935749518323307`*^9}}],

Cell["\<\
Check that frequencies sum to one in each sex after haploid selection:\
\>", "Text",
 CellChangeTimes->{{3.675691241028049*^9, 3.675691262904736*^9}, {
   3.675691499842326*^9, 3.675691508954028*^9}, {3.6757021446730413`*^9, 
   3.6757021466313477`*^9}, 3.67570266834774*^9, {3.675710454342794*^9, 
   3.675710458811872*^9}, {3.675711308941972*^9, 3.6757113347037287`*^9}, {
   3.676677885608522*^9, 3.6766778886629477`*^9}, {3.6766794933148947`*^9, 
   3.6766794941177*^9}, {3.676718813892243*^9, 3.676718822513054*^9}, {
   3.676719082993588*^9, 3.676719084080762*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{
    "XAMms", "+", "XaMms", "+", "YAMms", "+", "YaMms", "+", "XAmms", "+", 
     "Xamms", "+", "YAmms", "+", "Yamms"}]}], "//", "Factor"}], " ", 
  RowBox[{"(*", 
   RowBox[{"male", " ", "gametes"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{
   "XAMfs", "+", "XaMfs", "+", "XAmfs", "+", "Xamfs", "+", "YAMfs", "+", 
    "YaMfs", "+", "YAmfs", "+", "Yamfs"}]}], "//", "Factor", " ", 
  RowBox[{"(*", "eggs", "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6757273549842978`*^9, 3.675727390607794*^9}, {
  3.6757276397063427`*^9, 3.6757276468903522`*^9}, {3.675792572534343*^9, 
  3.675792597101988*^9}, {3.676677804145811*^9, 3.676677826030532*^9}, {
  3.676677900791519*^9, 3.67667797831069*^9}, {3.676678537684183*^9, 
  3.676678542015664*^9}, {3.6767181309369173`*^9, 3.676718177588006*^9}, {
  3.677350126505292*^9, 3.677350150283494*^9}, {3.6773553518299723`*^9, 
  3.677355387456687*^9}, {3.677355471013707*^9, 3.677355472108779*^9}, {
  3.677355541534996*^9, 3.677355542975457*^9}, {3.69260741724226*^9, 
  3.692607474759425*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, {
   3.675792579770925*^9, 3.675792597332528*^9}, 3.6758682510725803`*^9, 
   3.675884051627248*^9, 3.67588787251865*^9, 3.675894802110652*^9, 
   3.676652893924481*^9, {3.6766777919311743`*^9, 3.676677818579338*^9}, {
   3.6766779043654737`*^9, 3.676677939916746*^9}, 3.676678542469659*^9, 
   3.676718143248888*^9, 3.6767181780486*^9, 3.6767307837164783`*^9, 
   3.676747303149987*^9, 3.677350150768147*^9, 3.677355342848761*^9, 
   3.677355388467477*^9, {3.67735547297444*^9, 3.677355497450495*^9}, {
   3.677355546467103*^9, 3.6773555682275133`*^9}, 3.677426219410788*^9, 
   3.677426529389955*^9, 3.677594772995286*^9, 3.677872448191378*^9, 
   3.677875703002388*^9, 3.6779381420772877`*^9, 3.6779577346097593`*^9, 
   3.678208859261462*^9, 3.6785428903292437`*^9, 3.678546796002295*^9, 
   3.678653987884425*^9, 3.678793240520035*^9, 3.67883999201215*^9, 
   3.692607254918138*^9, 3.6926072910070963`*^9, {3.692607446380959*^9, 
   3.692607475628792*^9}, 3.6932315591368847`*^9, 3.693550498161333*^9, 
   3.693565826892425*^9, 3.693574255316889*^9, 3.69357495594132*^9, 
   3.693575035375576*^9, 3.6936330351289177`*^9, 3.6948921887180443`*^9, 
   3.694953690283082*^9, 3.694976020552416*^9, 3.696742357586543*^9, 
   3.696743686542223*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, {
   3.675792579770925*^9, 3.675792597332528*^9}, 3.6758682510725803`*^9, 
   3.675884051627248*^9, 3.67588787251865*^9, 3.675894802110652*^9, 
   3.676652893924481*^9, {3.6766777919311743`*^9, 3.676677818579338*^9}, {
   3.6766779043654737`*^9, 3.676677939916746*^9}, 3.676678542469659*^9, 
   3.676718143248888*^9, 3.6767181780486*^9, 3.6767307837164783`*^9, 
   3.676747303149987*^9, 3.677350150768147*^9, 3.677355342848761*^9, 
   3.677355388467477*^9, {3.67735547297444*^9, 3.677355497450495*^9}, {
   3.677355546467103*^9, 3.6773555682275133`*^9}, 3.677426219410788*^9, 
   3.677426529389955*^9, 3.677594772995286*^9, 3.677872448191378*^9, 
   3.677875703002388*^9, 3.6779381420772877`*^9, 3.6779577346097593`*^9, 
   3.678208859261462*^9, 3.6785428903292437`*^9, 3.678546796002295*^9, 
   3.678653987884425*^9, 3.678793240520035*^9, 3.67883999201215*^9, 
   3.692607254918138*^9, 3.6926072910070963`*^9, {3.692607446380959*^9, 
   3.692607475628792*^9}, 3.6932315591368847`*^9, 3.693550498161333*^9, 
   3.693565826892425*^9, 3.693574255316889*^9, 3.69357495594132*^9, 
   3.693575035375576*^9, 3.6936330351289177`*^9, 3.6948921887180443`*^9, 
   3.694953690283082*^9, 3.694976020552416*^9, 3.696742357586543*^9, 
   3.6967436865476294`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Random mating", "Subsection",
 CellChangeTimes->{{3.676680401113572*^9, 3.676680402700843*^9}, {
  3.676680492557345*^9, 3.676680499967092*^9}}],

Cell["\<\
After random mating, the frequencies of the diploid genotypes are\
\>", "Text",
 CellChangeTimes->{{3.675646094888542*^9, 3.675646099390658*^9}, {
  3.675646217785323*^9, 3.675646250704771*^9}, {3.67570268816877*^9, 
  3.6757027045136023`*^9}, {3.676678026615859*^9, 3.676678026799192*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"MM", " ", "Homozygotes"}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"XM", "-", 
    RowBox[{"XM", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"XAMXAMfemale", "=", 
     RowBox[{"kXX", " ", 
      RowBox[{"(", 
       RowBox[{"XAMfs", " ", "XAMms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMXaMfemale", "=", 
     RowBox[{"kXX", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAMfs", " ", "XaMms"}], "+", 
        RowBox[{"XaMfs", " ", "XAMms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMXaMfemale", "=", 
     RowBox[{"kXX", 
      RowBox[{"(", 
       RowBox[{"XaMfs", " ", "XaMms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"XM", "-", 
     RowBox[{"XM", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMXAMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kXX"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"XAMfs", " ", "XAMms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMXaMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kXX"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAMfs", " ", "XaMms"}], "+", 
        RowBox[{"XaMfs", " ", "XAMms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMXaMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kXX"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"XaMfs", " ", "XaMms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"XM", "-", 
     RowBox[{"YM", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYAMfemale", "=", 
     RowBox[{"kXY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAMfs", " ", "YAMms"}], "+", 
        RowBox[{"YAMfs", " ", "XAMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYaMfemale", "=", 
     RowBox[{"kXY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAMfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "XAMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMYAMfemale", "=", 
     RowBox[{"kXY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaMfs", " ", "YAMms"}], "+", 
        RowBox[{"YAMfs", " ", "XaMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMYaMfemale", "=", 
     RowBox[{"kXY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaMfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "XaMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"XM", "-", 
     RowBox[{"YM", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYAMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kXY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAMfs", " ", "YAMms"}], "+", 
        RowBox[{"YAMfs", " ", "XAMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYaMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kXY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAMfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "XAMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMYAMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kXY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaMfs", " ", "YAMms"}], "+", 
        RowBox[{"YAMfs", " ", "XaMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMYaMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kXY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaMfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "XaMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"YM", "-", 
     RowBox[{"YM", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAMYAMfemale", "=", 
     RowBox[{"kYY", 
      RowBox[{"(", 
       RowBox[{"YAMfs", " ", "YAMms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAMYaMfemale", "=", 
     RowBox[{"kYY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YAMfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "YAMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YaMYaMfemale", "=", 
     RowBox[{"kYY", 
      RowBox[{"(", 
       RowBox[{"YaMfs", " ", "YaMms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"YM", "-", 
     RowBox[{"YM", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAMYAMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kYY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"YAMfs", " ", "YAMms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAMYaMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kYY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YAMfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "YAMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YaMYaMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kYY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"YaMfs", " ", "YaMms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Mm", " ", "heterozygotes"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"XM", "-", 
     RowBox[{"Xm", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXAMfemale", "=", 
     RowBox[{"kMmXX", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "XAMms"}], "+", 
        RowBox[{"XAMfs", " ", "XAmms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXaMfemale", "=", 
     RowBox[{"kMmXX", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "XaMms"}], "+", 
        RowBox[{"XaMfs", " ", "XAmms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMXamfemale", "=", 
     RowBox[{"kMmXX", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAMfs", " ", "Xamms"}], "+", 
        RowBox[{"Xamfs", " ", "XAMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamXaMfemale", "=", 
     RowBox[{"kMmXX", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Xamfs", " ", "XaMms"}], "+", 
        RowBox[{"XaMfs", " ", "Xamms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"XM", "-", 
     RowBox[{"Xm", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXAMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmXX"}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "XAMms"}], "+", 
        RowBox[{"XAMfs", " ", "XAmms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXaMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmXX"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "XaMms"}], "+", 
        RowBox[{"XaMfs", " ", "XAmms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMXammale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmXX"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAMfs", " ", "Xamms"}], "+", 
        RowBox[{"Xamfs", " ", "XAMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamXaMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmXX"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Xamfs", " ", "XaMms"}], "+", 
        RowBox[{"XaMfs", " ", "Xamms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xm", "-", 
     RowBox[{"YM", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYAMfemale", "=", 
     RowBox[{"kMmXY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "YAMms"}], "+", 
        RowBox[{"YAMfs", " ", "XAmms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYaMfemale", "=", 
     RowBox[{"kMmXY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "XAmms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamYAMfemale", "=", 
     RowBox[{"kMmXY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Xamfs", " ", "YAMms"}], "+", 
        RowBox[{"YAMfs", " ", "Xamms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamYaMfemale", "=", 
     RowBox[{"kMmXY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Xamfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "Xamms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xm", "-", 
     RowBox[{"YM", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYAMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmXY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "YAMms"}], "+", 
        RowBox[{"YAMfs", " ", "XAmms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYaMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmXY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "XAmms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamYAMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmXY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Xamfs", " ", "YAMms"}], "+", 
        RowBox[{"YAMfs", " ", "Xamms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamYaMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmXY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Xamfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "Xamms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"XM", "-", 
     RowBox[{"Ym", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYAmfemale", "=", 
     RowBox[{"kMmXY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAMfs", " ", "YAmms"}], "+", 
        RowBox[{"YAmfs", " ", "XAMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYamfemale", "=", 
     RowBox[{"kMmXY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAMfs", " ", "Yamms"}], "+", 
        RowBox[{"Yamfs", " ", "XAMms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMYAmfemale", "=", 
     RowBox[{"kMmXY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaMfs", " ", "YAmms"}], "+", 
        RowBox[{"YAmfs", " ", "XaMms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMYamfemale", "=", 
     RowBox[{"kMmXY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaMfs", " ", "Yamms"}], "+", 
        RowBox[{"Yamfs", " ", "XaMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"XM", "-", 
     RowBox[{"Ym", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYAmmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmXY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAMfs", " ", "YAmms"}], "+", 
        RowBox[{"YAmfs", " ", "XAMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYammale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmXY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAMfs", " ", "Yamms"}], "+", 
        RowBox[{"Yamfs", " ", "XAMms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMYAmmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmXY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaMfs", " ", "YAmms"}], "+", 
        RowBox[{"YAmfs", " ", "XaMms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMYammale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmXY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaMfs", " ", "Yamms"}], "+", 
        RowBox[{"Yamfs", " ", "XaMms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Ym", "-", 
     RowBox[{"YM", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYAMfemale", "=", 
     RowBox[{"kMmYY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YAmfs", " ", "YAMms"}], "+", 
        RowBox[{"YAMfs", " ", "YAmms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYaMfemale", "=", 
     RowBox[{"kMmYY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YAmfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "YAmms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YamYAMfemale", "=", 
     RowBox[{"kMmYY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Yamfs", " ", "YAMms"}], "+", 
        RowBox[{"YAMfs", " ", "Yamms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YamYaMfemale", "=", 
     RowBox[{"kMmYY", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Yamfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "Yamms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Ym", "-", 
     RowBox[{"YM", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYAMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmYY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YAmfs", " ", "YAMms"}], "+", 
        RowBox[{"YAMfs", " ", "YAmms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYaMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmYY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YAmfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "YAmms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YamYAMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmYY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Yamfs", " ", "YAMms"}], "+", 
        RowBox[{"YAMfs", " ", "Yamms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YamYaMmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kMmYY"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Yamfs", " ", "YaMms"}], "+", 
        RowBox[{"YaMfs", " ", "Yamms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mm", " ", "heterozygotes"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xm", "-", 
     RowBox[{"Xm", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXAmfemale", "=", 
     RowBox[{"kmm", 
      RowBox[{"(", 
       RowBox[{"XAmfs", " ", "XAmms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXamfemale", "=", 
     RowBox[{"kmm", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "Xamms"}], "+", 
        RowBox[{"Xamfs", " ", "XAmms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamXamfemale", "=", 
     RowBox[{"kmm", 
      RowBox[{"(", 
       RowBox[{"Xamfs", " ", "Xamms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xm", "-", 
     RowBox[{"Xm", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXAmmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kmm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"XAmfs", " ", "XAmms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXammale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kmm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "Xamms"}], "+", 
        RowBox[{"Xamfs", " ", "XAmms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamXammale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kmm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"Xamfs", " ", "Xamms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xm", "-", 
     RowBox[{"Ym", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYAmfemale", "=", 
     RowBox[{"kmm", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "YAmms"}], "+", 
        RowBox[{"YAmfs", " ", "XAmms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYamfemale", "=", 
     RowBox[{"kmm", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "Yamms"}], "+", 
        RowBox[{"Yamfs", " ", "XAmms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamYAmfemale", "=", 
     RowBox[{"kmm", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Xamfs", " ", "YAmms"}], "+", 
        RowBox[{"YAmfs", " ", "Xamms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamYamfemale", "=", 
     RowBox[{"kmm", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Xamfs", " ", "Yamms"}], "+", 
        RowBox[{"Yamfs", " ", "Xamms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xm", "-", 
     RowBox[{"Ym", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYAmmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kmm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "YAmms"}], "+", 
        RowBox[{"YAmfs", " ", "XAmms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYammale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kmm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAmfs", " ", "Yamms"}], "+", 
        RowBox[{"Yamfs", " ", "XAmms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamYAmmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kmm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Xamfs", " ", "YAmms"}], "+", 
        RowBox[{"YAmfs", " ", "Xamms"}]}], " ", ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamYammale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kmm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Xamfs", " ", "Yamms"}], "+", 
        RowBox[{"Yamfs", " ", "Xamms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Ym", "-", 
     RowBox[{"Ym", " ", "females"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYAmfemale", "=", 
     RowBox[{"kmm", 
      RowBox[{"(", 
       RowBox[{"YAmfs", " ", "YAmms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYamfemale", "=", 
     RowBox[{"kmm", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YAmfs", " ", "Yamms"}], "+", 
        RowBox[{"Yamfs", " ", "YAmms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YamYamfemale", "=", 
     RowBox[{"kmm", 
      RowBox[{"(", 
       RowBox[{"Yamfs", " ", "Yamms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Ym", "-", 
     RowBox[{"Ym", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYAmmale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kmm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"YAmfs", " ", "YAmms"}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYammale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kmm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"YAmfs", " ", "Yamms"}], "+", 
        RowBox[{"Yamfs", " ", "YAmms"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YamYammale", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "kmm"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"Yamfs", " ", "Yamms"}], ")"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675646256909181*^9, 3.675646272815617*^9}, {
   3.675646370257011*^9, 3.67564637079287*^9}, {3.675646404699778*^9, 
   3.675646517567526*^9}, {3.675646573911735*^9, 3.675646591557143*^9}, {
   3.675646627619878*^9, 3.67564663177063*^9}, {3.675646667841331*^9, 
   3.675646747122738*^9}, {3.675691396390801*^9, 3.675691472391663*^9}, {
   3.675691536695323*^9, 3.675691538414453*^9}, {3.675691639085917*^9, 
   3.675691650195237*^9}, {3.675691682513646*^9, 3.675691696533524*^9}, {
   3.675691755294464*^9, 3.6756917629827957`*^9}, {3.675691824386702*^9, 
   3.675691852603437*^9}, {3.675692700413486*^9, 3.675692712195026*^9}, {
   3.67569296671769*^9, 3.675692967464675*^9}, {3.6756930389284983`*^9, 
   3.675693095368285*^9}, {3.675693137308187*^9, 3.675693184356132*^9}, {
   3.675693221908244*^9, 3.6756932234970217`*^9}, {3.675693268122773*^9, 
   3.675693270392726*^9}, {3.675693410576119*^9, 3.675693460007984*^9}, {
   3.675693492300033*^9, 3.675693533360964*^9}, 3.675693600152028*^9, {
   3.675702177145516*^9, 3.675702196152766*^9}, {3.6757023129704742`*^9, 
   3.675702317051364*^9}, {3.675792623150811*^9, 3.675792640133086*^9}, {
   3.675792682078307*^9, 3.675792755658676*^9}, {3.676678000228277*^9, 
   3.676678010863949*^9}, {3.6766780462191133`*^9, 3.676678234810701*^9}, 
   3.676678754031591*^9, {3.6766789631458273`*^9, 3.6766789866065598`*^9}, {
   3.6773501706938*^9, 3.677350364151083*^9}, {3.6773554003020287`*^9, 
   3.677355411423438*^9}, {3.677355555521697*^9, 3.6773556751155987`*^9}, 
   3.677355718800969*^9, {3.67735575116963*^9, 3.677356038432816*^9}, {
   3.677356069249213*^9, 3.677356231234989*^9}, {3.677356275573696*^9, 
   3.6773563630366507`*^9}, {3.677356569358673*^9, 3.677356580776696*^9}, {
   3.6773566473523827`*^9, 3.6773566482388144`*^9}, {3.6773569221392736`*^9, 
   3.677356990418913*^9}, 3.677357110694276*^9, {3.677357168972973*^9, 
   3.677357178988896*^9}, {3.6773572464786158`*^9, 3.677357256973176*^9}, {
   3.692607482918594*^9, 3.692607562022428*^9}, {3.692607677844507*^9, 
   3.692607684925638*^9}, {3.692607759761586*^9, 3.6926077850809317`*^9}, {
   3.692607998613825*^9, 3.6926080004600487`*^9}, {3.692608070452877*^9, 
   3.692608147633994*^9}, {3.692608481077488*^9, 3.692608642425398*^9}, {
   3.692608677460805*^9, 3.69260873674555*^9}, {3.6932296102697573`*^9, 
   3.69322968247619*^9}, {3.693229718613497*^9, 3.693229720555057*^9}, {
   3.6932297511799517`*^9, 3.693229751928891*^9}, {3.6932298389055443`*^9, 
   3.693229854105813*^9}, {3.6932301198254623`*^9, 3.693230351656516*^9}, 
   3.693230443086404*^9, {3.693230844018053*^9, 3.69323092471837*^9}, {
   3.693231006361135*^9, 3.693231157787734*^9}, {3.693231200385848*^9, 
   3.693231265848288*^9}, {3.693231335040118*^9, 3.693231354057026*^9}, {
   3.693231392694023*^9, 3.693231544775403*^9}, {3.693551693042326*^9, 
   3.693551931317341*^9}, {3.693554751753791*^9, 3.6935548758258*^9}}],

Cell["Check that they sum to one", "Text",
 CellChangeTimes->{{3.6766799013673363`*^9, 3.676679909235434*^9}, {
  3.676718082064983*^9, 3.6767180822254133`*^9}, {3.676718201654763*^9, 
  3.676718215366107*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{
   "XAMXAMfemale", "+", "XAMXaMfemale", "+", "XaMXaMfemale", "+", 
    "\[IndentingNewLine]", "XAMXAMmale", "+", "XAMXaMmale", "+", "XaMXaMmale",
     "+", "\[IndentingNewLine]", "XAMYAMmale", "+", "XAMYaMmale", "+", 
    "XaMYAMmale", "+", "XaMYaMmale", "+", "\[IndentingNewLine]", 
    "XAMYAMfemale", "+", "XAMYaMfemale", "+", "XaMYAMfemale", "+", 
    "XaMYaMfemale", "+", "\[IndentingNewLine]", "YAMYAMmale", "+", 
    "YAMYaMmale", "+", "YaMYaMmale", "+", "\[IndentingNewLine]", 
    "YAMYAMfemale", "+", "YAMYaMfemale", "+", "YaMYaMfemale", "+", 
    "\[IndentingNewLine]", "XAmXAMfemale", "+", "XAmXaMfemale", "+", 
    "XAMXamfemale", "+", "XamXaMfemale", "+", "\[IndentingNewLine]", 
    "XAmXAMmale", "+", "XAmXaMmale", "+", "XAMXammale", "+", "XamXaMmale", 
    "+", "\[IndentingNewLine]", "XAmYAMfemale", "+", "XAmYaMfemale", "+", 
    "XamYAMfemale", "+", "XamYaMfemale", "+", "\[IndentingNewLine]", 
    "XAmYAMmale", "+", "XAmYaMmale", "+", "XamYAMmale", "+", "XamYaMmale", 
    "+", "\[IndentingNewLine]", "XAMYAmfemale", "+", "XAMYamfemale", "+", 
    "XaMYAmfemale", "+", "XaMYamfemale", "+", "\[IndentingNewLine]", 
    "XAMYAmmale", "+", "XAMYammale", "+", "XaMYAmmale", "+", "XaMYammale", 
    "+", "\[IndentingNewLine]", "YAmYAMfemale", "+", "YAmYaMfemale", "+", 
    "YamYAMfemale", "+", "YamYaMfemale", "+", "\[IndentingNewLine]", 
    "YAmYAMmale", "+", "YAmYaMmale", "+", "YamYAMmale", "+", "YamYaMmale", 
    "+", "\[IndentingNewLine]", "XAmXAmfemale", "+", "XAmXamfemale", "+", 
    "XamXamfemale", "+", "\[IndentingNewLine]", "XAmXAmmale", "+", 
    "XAmXammale", "+", "XamXammale", "+", "\[IndentingNewLine]", 
    "XAmYAmfemale", "+", "XAmYamfemale", "+", "XamYAmfemale", "+", 
    "XamYamfemale", "+", "\[IndentingNewLine]", "XAmYAmmale", "+", 
    "XAmYammale", "+", "XamYAmmale", "+", "XamYammale", "+", 
    "\[IndentingNewLine]", "YAmYAmfemale", "+", "YAmYamfemale", "+", 
    "YamYamfemale", "+", "\[IndentingNewLine]", "YAmYAmmale", "+", 
    "YAmYammale", "+", "YamYammale"}]}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.693231615849169*^9, 3.693231864929265*^9}, {
  3.693232035257275*^9, 3.693232118965827*^9}, {3.693551943982243*^9, 
  3.693551973943201*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6932317684020853`*^9, {3.693231849530023*^9, 3.693231865417522*^9}, 
   3.693232048676394*^9, 3.6932321195813427`*^9, 3.693550498613508*^9, 
   3.6935519358551083`*^9, 3.693551975013875*^9, 3.693554808694509*^9, 
   3.693554893614181*^9, 3.693565828580989*^9, 3.693574256568654*^9, 
   3.69357496216392*^9, 3.693575035633862*^9, 3.693633040117939*^9, 
   3.69489219095968*^9, 3.69495369305893*^9, 3.694976022790276*^9, 
   3.696742360290105*^9, 3.696743686793749*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Diploid selection", "Subsection",
 CellChangeTimes->{{3.676680414738653*^9, 3.676680417091516*^9}}],

Cell["\<\
We next model selection in diploids, which can differ among the sexes. Let \
FAA, FAa, and Faa be the relative fitnesses of females homozygous for allele \
A, heterozygous, or homozygous for allele a at the autosomal locus. Similarly \
we use MAA, MAa, and Maa in males. Frequencies after selection in diploid are \
indicated by appending an s to the name. \
\>", "Text",
 CellChangeTimes->{{3.6756467552456417`*^9, 3.67564676342205*^9}, {
  3.675702725992881*^9, 3.67570275267984*^9}, {3.6766799909212923`*^9, 
  3.676680143326602*^9}, {3.6767190998603992`*^9, 3.676719104009471*^9}, {
  3.693233376957206*^9, 3.6932333834651117`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"mean", " ", "male", " ", "fitness"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"wbarM", "=", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"MAA", " ", "XAMXAMmale"}], "+", 
      RowBox[{"MAa", " ", "XAMXaMmale"}], "+", 
      RowBox[{"Maa", " ", "XaMXaMmale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"MAA", " ", "XAMYAMmale"}], "+", 
      RowBox[{"MAa", " ", 
       RowBox[{"(", 
        RowBox[{"XAMYaMmale", "+", "XaMYAMmale"}], ")"}]}], "+", 
      RowBox[{"Maa", " ", "XaMYaMmale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"MAA", " ", "YAMYAMmale"}], "+", 
      RowBox[{"MAa", " ", "YAMYaMmale"}], "+", 
      RowBox[{"Maa", " ", "YaMYaMmale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"MAA", " ", "XAmXAMmale"}], "+", 
      RowBox[{"MAa", " ", 
       RowBox[{"(", 
        RowBox[{"XAmXaMmale", "+", "XAMXammale"}], ")"}]}], "+", 
      RowBox[{"Maa", " ", "XamXaMmale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"MAA", " ", "XAmYAMmale"}], "+", 
      RowBox[{"MAa", " ", 
       RowBox[{"(", 
        RowBox[{"XAmYaMmale", "+", "XamYAMmale"}], ")"}]}], "+", 
      RowBox[{"Maa", " ", "XamYaMmale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"MAA", " ", "XAMYAmmale"}], "+", 
      RowBox[{"MAa", 
       RowBox[{"(", 
        RowBox[{"XAMYammale", "+", "XaMYAmmale"}], ")"}]}], "+", 
      RowBox[{"Maa", " ", "XaMYammale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"MAA", " ", "YAmYAMmale"}], "+", 
      RowBox[{"MAa", " ", 
       RowBox[{"(", 
        RowBox[{"YAmYaMmale", "+", "YamYAMmale"}], ")"}]}], "+", 
      RowBox[{"Maa", " ", "YamYaMmale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"MAA", " ", "XAmXAmmale"}], "+", 
      RowBox[{"MAa", " ", "XAmXammale"}], "+", 
      RowBox[{"Maa", " ", "XamXammale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"MAA", " ", "XAmYAmmale"}], "+", 
      RowBox[{"MAa", " ", 
       RowBox[{"(", 
        RowBox[{"XAmYammale", "+", "XamYAmmale"}], ")"}]}], "+", 
      RowBox[{"Maa", " ", "XamYammale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"MAA", " ", "YAmYAmmale"}], "+", 
      RowBox[{"MAa", " ", "YAmYammale"}], "+", 
      RowBox[{"Maa", " ", "YamYammale"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMXAMmales", "=", 
     RowBox[{"MAA", " ", 
      RowBox[{"XAMXAMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XAMXaMmales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XAMXaMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XaMXaMmales", "=", 
     RowBox[{"Maa", " ", 
      RowBox[{"XaMXaMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYAMmales", "=", 
     RowBox[{"MAA", " ", 
      RowBox[{"XAMYAMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XAMYaMmales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XAMYaMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XaMYAMmales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XaMYAMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XaMYaMmales", "=", 
     RowBox[{"Maa", " ", 
      RowBox[{"XaMYaMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAMYAMmales", "=", 
     RowBox[{"MAA", " ", 
      RowBox[{"YAMYAMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"YAMYaMmales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"YAMYaMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"YaMYaMmales", "=", 
     RowBox[{"Maa", " ", 
      RowBox[{"YaMYaMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXAMmales", "=", 
     RowBox[{"MAA", " ", 
      RowBox[{"XAmXAMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XAmXaMmales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XAmXaMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XAMXammales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XAMXammale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XamXaMmales", "=", 
     RowBox[{"Maa", " ", 
      RowBox[{"XamXaMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYAMmales", "=", 
     RowBox[{"MAA", " ", 
      RowBox[{"XAmYAMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XAmYaMmales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XAmYaMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XamYAMmales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XamYAMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XamYaMmales", "=", 
     RowBox[{"Maa", " ", 
      RowBox[{"XamYaMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYAmmales", "=", 
     RowBox[{"MAA", " ", 
      RowBox[{"XAMYAmmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XAMYammales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XAMYammale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XaMYAmmales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XaMYAmmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XaMYammales", "=", 
     RowBox[{"Maa", " ", 
      RowBox[{"XaMYammale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYAMmales", "=", 
     RowBox[{"MAA", " ", 
      RowBox[{"YAmYAMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"YAmYaMmales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"YAmYaMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"YamYAMmales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"YamYAMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"YamYaMmales", "=", 
     RowBox[{"Maa", " ", 
      RowBox[{"YamYaMmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXAmmales", "=", 
     RowBox[{"MAA", " ", 
      RowBox[{"XAmXAmmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XAmXammales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XAmXammale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XamXammales", "=", 
     RowBox[{"Maa", " ", 
      RowBox[{"XamXammale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYAmmales", "=", 
     RowBox[{"MAA", " ", 
      RowBox[{"XAmYAmmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XAmYammales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XAmYammale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XamYAmmales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"XamYAmmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XamYammales", "=", 
     RowBox[{"Maa", " ", 
      RowBox[{"XamYammale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYAmmales", "=", 
     RowBox[{"MAA", " ", 
      RowBox[{"YAmYAmmale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"YAmYammales", "=", 
     RowBox[{"MAa", " ", 
      RowBox[{"YAmYammale", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"YamYammales", "=", 
     RowBox[{"Maa", " ", 
      RowBox[{"YamYammale", "/", "wbarM"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675646788099258*^9, 3.675646827315172*^9}, {
   3.675646906255657*^9, 3.6756471746197577`*^9}, {3.6756477305962267`*^9, 
   3.675647791098443*^9}, {3.675693609968581*^9, 3.6756936401475143`*^9}, {
   3.675702773030509*^9, 3.675702825109133*^9}, {3.6757958668524837`*^9, 
   3.675796079670739*^9}, {3.675796179417987*^9, 3.675796260462306*^9}, {
   3.675796480404418*^9, 3.675796481420582*^9}, {3.675796553441423*^9, 
   3.67579667834494*^9}, {3.6757967212634993`*^9, 3.67579673565335*^9}, {
   3.675796766370957*^9, 3.675796913595641*^9}, {3.675796952452533*^9, 
   3.675796955994008*^9}, {3.6757970625420837`*^9, 3.675797062966584*^9}, {
   3.675797156973634*^9, 3.675797157898295*^9}, {3.675797509731503*^9, 
   3.6757975122266283`*^9}, 3.6757987828785143`*^9, {3.675798997687969*^9, 
   3.675798999203364*^9}, {3.67668015749852*^9, 3.676680334093931*^9}, {
   3.677350482152772*^9, 3.677350828592389*^9}, {3.677357205327866*^9, 
   3.677357207661775*^9}, {3.677357311911889*^9, 3.677357463801149*^9}, {
   3.67735749619882*^9, 3.677357579598115*^9}, {3.693232202076263*^9, 
   3.693232212574875*^9}, {3.693232268509738*^9, 3.693232297348093*^9}, {
   3.69323246681604*^9, 3.6932325041348553`*^9}, {3.69323254850172*^9, 
   3.693232640999236*^9}, {3.693232845909175*^9, 3.6932330063898907`*^9}, {
   3.6932330576516943`*^9, 3.6932332753086443`*^9}, {3.693553557673321*^9, 
   3.6935535814322844`*^9}, {3.693553634606389*^9, 3.693553689562615*^9}}],

Cell["Frequency of males after diplod selection should sum to 1", "Text",
 CellChangeTimes->{{3.6932333474170847`*^9, 3.693233359512849*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "\[Equal]", 
   RowBox[{
   "XAMXAMmales", "+", "XAMXaMmales", "+", "XaMXaMmales", "+", 
    "\[IndentingNewLine]", "XAMYAMmales", "+", "XAMYaMmales", "+", 
    "XaMYAMmales", "+", "XaMYaMmales", "+", "\[IndentingNewLine]", 
    "YAMYAMmales", "+", "YAMYaMmales", "+", "YaMYaMmales", "+", 
    "\[IndentingNewLine]", "XAmXAMmales", "+", "XAmXaMmales", "+", 
    "XAMXammales", "+", "XamXaMmales", "+", "\[IndentingNewLine]", 
    "XAmYAMmales", "+", "XAmYaMmales", "+", "XamYAMmales", "+", "XamYaMmales",
     "+", "\[IndentingNewLine]", "XAMYAmmales", "+", "XAMYammales", "+", 
    "XaMYAmmales", "+", "XaMYammales", "+", "\[IndentingNewLine]", 
    "YAmYAMmales", "+", "YAmYaMmales", "+", "YamYAMmales", "+", "YamYaMmales",
     "+", "\[IndentingNewLine]", "XAmXAmmales", "+", "XAmXammales", "+", 
    "XamXammales", "+", "\[IndentingNewLine]", "XAmYAmmales", "+", 
    "XAmYammales", "+", "XamYAmmales", "+", "XamYammales", "+", 
    "\[IndentingNewLine]", "YAmYAmmales", "+", "YAmYammales", "+", 
    "YamYammales"}]}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.69323329726197*^9, 3.693233344611611*^9}, {
  3.693553698291501*^9, 3.693553729917019*^9}, {3.693553787227764*^9, 
  3.6935538125551043`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.693233323118504*^9, 3.6932333337187967`*^9}, 
   3.693550499348648*^9, 3.693553866971203*^9, 3.6935550262367973`*^9, 
   3.693565829242177*^9, 3.6935742572968473`*^9, 3.693574963036375*^9, 
   3.693575036211216*^9, 3.693633043023019*^9, 3.6948921916801577`*^9, 
   3.694953693955349*^9, 3.694976023506319*^9, 3.6967423619310207`*^9, 
   3.6967436873834267`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"mean", " ", "female", " ", "fitness"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"wbarF", "=", 
     RowBox[{
      RowBox[{"FAA", " ", "XAMXAMfemale"}], "+", 
      RowBox[{"FAa", " ", "XAMXaMfemale"}], "+", 
      RowBox[{"Faa", " ", "XaMXaMfemale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "XAMYAMfemale"}], "+", 
      RowBox[{"FAa", " ", 
       RowBox[{"(", 
        RowBox[{"XAMYaMfemale", "+", "XaMYAMfemale"}], ")"}]}], "+", 
      RowBox[{"Faa", " ", "XaMYaMfemale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "YAMYAMfemale"}], "+", 
      RowBox[{"FAa", " ", "YAMYaMfemale"}], "+", 
      RowBox[{"Faa", " ", "YaMYaMfemale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "XAmXAMfemale"}], "+", 
      RowBox[{"FAa", " ", "XAmXaMfemale"}], "+", 
      RowBox[{"FAa", " ", "XAMXamfemale"}], "+", 
      RowBox[{"Faa", " ", "XamXaMfemale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "XAmYAMfemale"}], "+", 
      RowBox[{"FAa", " ", "XAmYaMfemale"}], "+", 
      RowBox[{"FAa", " ", "XamYAMfemale"}], "+", 
      RowBox[{"Faa", " ", "XamYaMfemale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "XAMYAmfemale"}], "+", 
      RowBox[{"FAa", " ", "XAMYamfemale"}], "+", 
      RowBox[{"FAa", " ", "XaMYAmfemale"}], "+", 
      RowBox[{"Faa", " ", "XaMYamfemale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "YAmYAMfemale"}], "+", 
      RowBox[{"FAa", " ", "YAmYaMfemale"}], "+", 
      RowBox[{"FAa", " ", "YamYAMfemale"}], "+", 
      RowBox[{"Faa", " ", "YamYaMfemale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "XAmXAmfemale"}], "+", 
      RowBox[{"FAa", " ", "XAmXamfemale"}], "+", 
      RowBox[{"Faa", " ", "XamXamfemale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "XAmYAmfemale"}], "+", 
      RowBox[{"FAa", " ", "XAmYamfemale"}], "+", 
      RowBox[{"FAa", " ", "XamYAmfemale"}], "+", 
      RowBox[{"Faa", " ", "XamYamfemale"}], "+", "\[IndentingNewLine]", 
      RowBox[{"FAA", " ", "YAmYAmfemale"}], "+", 
      RowBox[{"FAa", " ", "YAmYamfemale"}], "+", 
      RowBox[{"Faa", " ", "YamYamfemale"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMXAMfemales", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAMXAMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMXaMfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAMXaMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMXaMfemales", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XaMXaMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYAMfemales", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAMYAMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYaMfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAMYaMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMYAMfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XaMYAMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMYaMfemales", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XaMYaMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAMYAMfemales", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"YAMYAMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAMYaMfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"YAMYaMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YaMYaMfemales", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"YaMYaMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXAMfemales", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAmXAMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXaMfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAmXaMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMXamfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAMXamfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamXaMfemales", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XamXaMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYAMfemales", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAmYAMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYaMfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAmYaMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamYAMfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XamYAMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamYaMfemales", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XamYaMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYAmfemales", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAMYAmfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAMYamfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAMYamfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMYAmfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XaMYAmfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaMYamfemales", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XaMYamfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYAMfemales", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"YAmYAMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYaMfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"YAmYaMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YamYAMfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"YamYAMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YamYaMfemales", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"YamYaMfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXAmfemales", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAmXAmfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmXamfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAmXamfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamXamfemales", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XamXamfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYAmfemales", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"XAmYAmfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmYamfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XAmYamfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamYAmfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"XamYAmfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XamYamfemales", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"XamYamfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYAmfemales", "=", 
     RowBox[{"FAA", " ", 
      RowBox[{"YAmYAmfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAmYamfemales", "=", 
     RowBox[{"FAa", " ", 
      RowBox[{"YAmYamfemale", "/", "wbarF"}]}]}], ";"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YamYamfemales", "=", 
     RowBox[{"Faa", " ", 
      RowBox[{"YamYamfemale", "/", "wbarF"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{
  3.693233391133959*^9, {3.693233428523902*^9, 3.693233589851301*^9}, {
   3.693233636261447*^9, 3.693233821385127*^9}, {3.693553756323934*^9, 
   3.693553773765794*^9}, {3.693553816885316*^9, 3.693553837589363*^9}, {
   3.693553960587409*^9, 3.693553993653867*^9}}],

Cell["Frequency of females after diplod selection should sum to 1", "Text",
 CellChangeTimes->{{3.693233875038472*^9, 3.693233877381901*^9}, {
  3.6935539666618547`*^9, 3.693553995291113*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{
   "XAMXAMfemales", "+", "XAMXaMfemales", "+", "XaMXaMfemales", "+", 
    "\[IndentingNewLine]", "XAMYAMfemales", "+", "XAMYaMfemales", "+", 
    "XaMYAMfemales", "+", "XaMYaMfemales", "+", "\[IndentingNewLine]", 
    "YAMYAMfemales", "+", "YAMYaMfemales", "+", "YaMYaMfemales", "+", 
    "\[IndentingNewLine]", "XAmXAMfemales", "+", "XAmXaMfemales", "+", 
    "XAMXamfemales", "+", "XamXaMfemales", "+", "\[IndentingNewLine]", 
    "XAmYAMfemales", "+", "XAmYaMfemales", "+", "XamYAMfemales", "+", 
    "XamYaMfemales", "+", "\[IndentingNewLine]", "XAMYAmfemales", "+", 
    "XAMYamfemales", "+", "XaMYAmfemales", "+", "XaMYamfemales", "+", 
    "\[IndentingNewLine]", "YAmYAMfemales", "+", "YAmYaMfemales", "+", 
    "YamYAMfemales", "+", "YamYaMfemales", "+", "\[IndentingNewLine]", 
    "XAmXAmfemales", "+", "XAmXamfemales", "+", "XamXamfemales", "+", 
    "\[IndentingNewLine]", "XAmYAmfemales", "+", "XAmYamfemales", "+", 
    "XamYAmfemales", "+", "XamYamfemales", "+", "\[IndentingNewLine]", 
    "YAmYAmfemales", "+", "YAmYamfemales", "+", "YamYamfemales"}]}], "//", 
  "Factor"}]], "Input",
 CellChangeTimes->{{3.693233406577669*^9, 3.693233420737273*^9}, {
  3.6932338328646803`*^9, 3.693233858880991*^9}, {3.693553852442827*^9, 
  3.693553864056563*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.693233856866249*^9, 3.693233859452322*^9}, 
   3.6935504995861073`*^9, 3.693553871471888*^9, {3.693553973477713*^9, 
   3.693553996369739*^9}, 3.693555026822012*^9, 3.693565829857457*^9, 
   3.693574262281351*^9, 3.693574963859747*^9, 3.693575036753759*^9, 
   3.693633043911112*^9, 3.694892192307988*^9, 3.6949536947876863`*^9, 
   3.6949760241303997`*^9, 3.6967423629121943`*^9, 3.6967436879387617`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Meiosis", "Subsection",
 CellChangeTimes->{{3.6932340315333157`*^9, 3.693234039130885*^9}, {
  3.693549911189954*^9, 3.693549911590152*^9}}],

Cell["\<\
Translate into new notation:

first two letters refer to SDR locus genotype, then numbers ij giving A and M \
locus genotype where 
1-AM
2-aM
3-Am
4-am
then m or f indicating male or female
then s to indicate that these are frequencies after selection
e.g., xy41ms is a male with genotype X-a-m Y-A-M. 
Where i and j are interchangable (in YY and XX individuals) the lowest number \
is given first. \
\>", "Text",
 CellChangeTimes->{{3.693549676252092*^9, 3.6935498426544437`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xx11ms", "=", "XAMXAMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx12ms", "=", "XAMXaMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xx22ms", "=", "XaMXaMmales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx13ms", "=", "XAmXAMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx23ms", "=", "XAmXaMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx14ms", "=", "XAMXammales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xx24ms", "=", "XamXaMmales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx33ms", "=", "XAmXAmmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx34ms", "=", "XAmXammales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xx44ms", "=", "XamXammales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy11ms", "=", "XAMYAMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy12ms", "=", "XAMYaMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy21ms", "=", "XaMYAMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xy22ms", "=", "XaMYaMmales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy31ms", "=", "XAmYAMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy32ms", "=", "XAmYaMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy41ms", "=", "XamYAMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xy42ms", "=", "XamYaMmales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy13ms", "=", "XAMYAmmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy14ms", "=", "XAMYammales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy23ms", "=", "XaMYAmmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xy24ms", "=", "XaMYammales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy33ms", "=", "XAmYAmmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy34ms", "=", "XAmYammales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy43ms", "=", "XamYAmmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xy44ms", "=", "XamYammales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy11ms", "=", "YAMYAMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy12ms", "=", "YAMYaMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yy22ms", "=", "YaMYaMmales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy13ms", "=", "YAmYAMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy23ms", "=", "YAmYaMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy14ms", "=", "YamYAMmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yy24ms", "=", "YamYaMmales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy33ms", "=", "YAmYAmmales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy34ms", "=", "YAmYammales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy44ms", "=", "YamYammales"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6935462665151367`*^9, 3.693546527048169*^9}, {
  3.693546578207542*^9, 3.6935465965268087`*^9}, {3.693554030057485*^9, 
  3.6935540909999533`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"xx11fs", "=", "XAMXAMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx12fs", "=", "XAMXaMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xx22fs", "=", "XaMXaMfemales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx13fs", "=", "XAmXAMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx23fs", "=", "XAmXaMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx14fs", "=", "XAMXamfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xx24fs", "=", "XamXaMfemales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx33fs", "=", "XAmXAmfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xx34fs", "=", "XAmXamfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xx44fs", "=", "XamXamfemales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy11fs", "=", "XAMYAMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy12fs", "=", "XAMYaMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy21fs", "=", "XaMYAMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xy22fs", "=", "XaMYaMfemales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy31fs", "=", "XAmYAMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy32fs", "=", "XAmYaMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy41fs", "=", "XamYAMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xy42fs", "=", "XamYaMfemales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy13fs", "=", "XAMYAmfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy14fs", "=", "XAMYamfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy23fs", "=", "XaMYAmfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xy24fs", "=", "XaMYamfemales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy33fs", "=", "XAmYAmfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy34fs", "=", "XAmYamfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"xy43fs", "=", "XamYAmfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"xy44fs", "=", "XamYamfemales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy11fs", "=", "YAMYAMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy12fs", "=", "YAMYaMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yy22fs", "=", "YaMYaMfemales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy13fs", "=", "YAmYAMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy23fs", "=", "YAmYaMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy14fs", "=", "YamYAMfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"yy24fs", "=", "YamYaMfemales"}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy33fs", "=", "YAmYAmfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy34fs", "=", "YAmYamfemales"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yy44fs", "=", "YamYamfemales"}], ";"}]}], "Input",
 CellChangeTimes->{{3.69354708715689*^9, 3.693547177019068*^9}, {
   3.6935477065760717`*^9, 3.693547711735938*^9}, {3.69354888761584*^9, 
   3.6935489716086903`*^9}, {3.6935490095348988`*^9, 3.693549010116597*^9}, {
   3.6935491509681473`*^9, 3.6935491931821547`*^9}, {3.6935492516091423`*^9, 
   3.693549251729101*^9}, {3.693549302725135*^9, 3.693549352349843*^9}, 
   3.6935496525570507`*^9, {3.693554105576215*^9, 3.693554139483643*^9}}],

Cell["First, we consider female gametes ", "Text",
 CellChangeTimes->{{3.693549918982011*^9, 3.693549935045683*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"X", " ", "bearing", " ", "ovules"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nextXAMf", "=", 
     RowBox[{"xx11fs", "+", 
      RowBox[{"xx13fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xx12fs", "+", 
         RowBox[{"xx14fs", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rf"}], ")"}]}], "+", 
         RowBox[{"xx23fs", "*", "Rf"}]}], ")"}], "\[Alpha]f"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy11fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy12fs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rMMf"}], ")"}]}], "+", 
         RowBox[{"xy21fs", " ", 
          RowBox[{"(", "rMMf", ")"}]}]}], ")"}], "\[Alpha]f"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy13fs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]f"}], ")"}]}], "+", 
         RowBox[{"xy31fs", " ", 
          RowBox[{"(", "\[Chi]f", ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy14fs", " ", "*", "\[Alpha]f"}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14fs", " ", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rf", "+", "rMmf", "+", "\[Chi]f"}], ")"}]}], ")"}]}], 
         "+", " ", "\[IndentingNewLine]", 
         RowBox[{"xy41fs", 
          RowBox[{"(", 
           RowBox[{"rMmf", "+", "\[Chi]f", "-", "Rf"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy23fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "rMmf", "-", "\[Chi]f"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy32fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "\[Chi]f", "-", "rMmf"}], ")"}]}]}], ")"}], 
       RowBox[{"\[Alpha]f", "/", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextXaMf", "=", 
     RowBox[{"xx22fs", "+", 
      RowBox[{"xx24fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xx12fs", "+", 
         RowBox[{"xx23fs", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rf"}], ")"}]}], "+", 
         RowBox[{"xx14fs", "*", "Rf"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{"xy22fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy12fs", 
          RowBox[{"(", "rMMf", ")"}]}], "+", 
         RowBox[{"xy21fs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rMMf"}], ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy24fs", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]f"}], ")"}]}], "+", 
         RowBox[{"xy42fs", " ", 
          RowBox[{"(", "\[Chi]f", ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy23fs", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "rMmf", "-", "\[Chi]f"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy41fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "\[Chi]f", "-", "rMmf"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy23fs", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rf", "+", "rMmf", "+", "\[Chi]f"}], ")"}]}], ")"}]}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"xy32fs", " ", 
          RowBox[{"(", 
           RowBox[{"rMmf", "+", "\[Chi]f", "-", "Rf"}], ")"}]}]}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]f"}], ")"}], "/", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextXAmf", "=", 
     RowBox[{"xx33fs", "+", 
      RowBox[{"xx13fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xx23fs", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rf"}], ")"}]}], "+", 
         RowBox[{"Rf", "*", "xx14fs"}], "+", "xx34fs"}], ")"}], "\[Alpha]f"}],
       "+", "\[IndentingNewLine]", 
      RowBox[{"xy33fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy34fs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rmmf"}], ")"}]}], "+", 
         RowBox[{"xy43fs", 
          RowBox[{"(", "rmmf", ")"}]}]}], ")"}], "\[Alpha]f"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy13fs", 
          RowBox[{"(", "\[Chi]f", ")"}]}], "+", 
         RowBox[{"xy31fs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]f"}], ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy32fs", " ", "*", "\[Alpha]f"}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "\[Chi]f", "-", "rMmf"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy41fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "rMmf", "-", "\[Chi]f"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy23fs", 
          RowBox[{"(", 
           RowBox[{"rMmf", "+", "\[Chi]f", "-", "Rf"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy32fs", " ", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rf", "+", "rMmf", "+", "\[Chi]f"}], ")"}]}], ")"}]}]}], 
        ")"}], 
       RowBox[{"\[Alpha]f", "/", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextXamf", "=", 
     RowBox[{"xx44fs", "+", 
      RowBox[{"xx24fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xx14fs", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rf"}], ")"}]}], "+", 
         RowBox[{"xx23fs", "*", "Rf"}], "+", "xx34fs"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{"xy44fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy34fs", 
          RowBox[{"(", "rmmf", ")"}]}], "+", 
         RowBox[{"xy43fs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rmmf"}], ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy24fs", 
          RowBox[{"(", "\[Chi]f", ")"}]}], "+", 
         RowBox[{"xy42fs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]f"}], ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy41fs", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14fs", 
          RowBox[{"(", 
           RowBox[{"rMmf", "+", "\[Chi]f", "-", "Rf"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy41fs", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rf", "+", "rMmf", "+", "\[Chi]f"}], ")"}]}], ")"}]}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"xy23fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "\[Chi]f", "-", "rMmf"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy32fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "rMmf", "-", "\[Chi]f"}], ")"}]}]}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]f"}], ")"}], "/", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y", " ", "bearing", " ", "ovules"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYAMf", "=", 
     RowBox[{"yy11fs", "+", 
      RowBox[{"yy13fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"yy12fs", "+", 
         RowBox[{"yy14fs", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rf"}], ")"}]}], "+", 
         RowBox[{"yy23fs", "*", "Rf"}]}], ")"}], "\[Alpha]f"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy11fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy12fs", 
          RowBox[{"(", "rMMf", ")"}]}], "+", 
         RowBox[{"xy21fs", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rMMf"}], ")"}]}]}], ")"}], 
       RowBox[{"(", "\[Alpha]f", ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy13fs", 
          RowBox[{"(", "\[Chi]f", ")"}]}], "+", 
         RowBox[{"xy31fs", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]f"}], ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy41fs", "*", "\[Alpha]f"}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14fs", " ", 
          RowBox[{"(", 
           RowBox[{"rMmf", "+", "\[Chi]f", "-", "Rf"}], ")"}]}], "+", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"xy41fs", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rf", "+", "rMmf", "+", "\[Chi]f"}], ")"}]}], ")"}]}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"xy23fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "\[Chi]f", "-", "rMmf"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy32fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "rMmf", "-", "\[Chi]f"}], ")"}]}]}], ")"}], 
       RowBox[{"\[Alpha]f", "/", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYaMf", " ", "=", 
     RowBox[{"yy22fs", "+", 
      RowBox[{"yy24fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"yy12fs", "+", 
         RowBox[{"yy23fs", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rf"}], ")"}]}], "+", 
         RowBox[{"yy14fs", "*", "Rf"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{"xy22fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy12fs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rMMf"}], ")"}]}], "+", 
         RowBox[{"xy21fs", 
          RowBox[{"(", "rMMf", ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy24fs", " ", 
          RowBox[{"(", "\[Chi]f", ")"}]}], "+", 
         RowBox[{"xy42fs", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]f"}], ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy32fs", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "\[Chi]f", "-", "rMmf"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy41fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "rMmf", "-", "\[Chi]f"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy23fs", 
          RowBox[{"(", 
           RowBox[{"rMmf", "+", "\[Chi]f", "-", "Rf"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy32fs", " ", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rf", "+", "rMmf", "+", "\[Chi]f"}], ")"}]}], ")"}]}]}], 
        ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]f"}], ")"}], "/", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYAmf", " ", "=", 
     RowBox[{"yy33fs", "+", 
      RowBox[{"yy13fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yy23fs", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rf"}], ")"}]}], "+", 
         RowBox[{"Rf", "*", "yy14fs"}], "+", "yy34fs"}], ")"}], "\[Alpha]f"}],
       "+", "\[IndentingNewLine]", 
      RowBox[{"xy33fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy34fs", 
          RowBox[{"(", "rmmf", ")"}]}], "+", 
         RowBox[{"xy43fs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rmmf"}], ")"}]}]}], ")"}], 
       RowBox[{"(", "\[Alpha]f", ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy13fs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]f"}], ")"}]}], "+", 
         RowBox[{"xy31fs", 
          RowBox[{"(", "\[Chi]f", ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy23fs", "*", "\[Alpha]f"}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "rMmf", "-", "\[Chi]f"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy41fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "\[Chi]f", "-", "rMmf"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy23fs", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rf", "+", "rMmf", "+", "\[Chi]f"}], ")"}]}], ")"}]}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"xy32fs", " ", 
          RowBox[{"(", 
           RowBox[{"rMmf", "+", "\[Chi]f", "-", "Rf"}], ")"}]}]}], ")"}], 
       RowBox[{"\[Alpha]f", "/", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYamf", "=", 
     RowBox[{"yy44fs", "+", 
      RowBox[{"yy24fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yy14fs", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rf"}], ")"}]}], "+", 
         RowBox[{"yy23fs", "*", "Rf"}], "+", "yy34fs"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{"xy44fs", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy34fs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rmmf"}], ")"}]}], "+", 
         RowBox[{"xy43fs", 
          RowBox[{"(", "rmmf", ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy24fs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]f"}], ")"}]}], "+", 
         RowBox[{"xy42fs", 
          RowBox[{"(", "\[Chi]f", ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy14fs", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14fs", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rf", "+", "rMmf", "+", "\[Chi]f"}], ")"}]}], ")"}]}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"xy41fs", 
          RowBox[{"(", 
           RowBox[{"rMmf", "+", "\[Chi]f", "-", "Rf"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy23fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "rMmf", "-", "\[Chi]f"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy32fs", 
          RowBox[{"(", 
           RowBox[{"Rf", "+", "\[Chi]f", "-", "rMmf"}], ")"}]}]}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]f"}], ")"}], "/", "2"}]}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.693309915501526*^9, 3.6933099325077677`*^9}, {
   3.693309994483501*^9, 3.693310111226685*^9}, 3.693310458051482*^9, {
   3.693310504984441*^9, 3.693310571845592*^9}, {3.693310708322699*^9, 
   3.693310965833001*^9}, {3.693311068691226*^9, 3.693311076707844*^9}, {
   3.693311116392437*^9, 3.693311174992943*^9}, {3.693311224910478*^9, 
   3.693311386325416*^9}, {3.693311492371409*^9, 3.693311517729001*^9}, 
   3.693311563059478*^9, {3.693311747119026*^9, 3.6933120753696938`*^9}, {
   3.693312142532003*^9, 3.693312148484177*^9}, {3.693312186677787*^9, 
   3.69331257884744*^9}, {3.693312610467888*^9, 3.693312654396325*^9}, {
   3.693312761967066*^9, 3.6933128469525948`*^9}, {3.693312884107136*^9, 
   3.693312884458653*^9}, {3.693312918963231*^9, 3.693312925162354*^9}, 
   3.693313010915413*^9, {3.6935503161706543`*^9, 3.693550364876738*^9}, {
   3.693550516443318*^9, 3.693550523953898*^9}, {3.693554135658864*^9, 
   3.693554167167574*^9}, 3.69355421954396*^9, {3.693560016281282*^9, 
   3.693560026912613*^9}, {3.6935600600585003`*^9, 3.693560082508367*^9}, {
   3.693560114198065*^9, 3.693560230607451*^9}, {3.69356030620798*^9, 
   3.693560306295227*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{
  "nextXAMf", "+", "nextXaMf", "+", "nextXAmf", "+", "nextXamf", "+", 
   "nextYAMf", "+", "nextYaMf", "+", "nextYAmf", "+", "nextYamf"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.693549017206688*^9, 3.693549019137959*^9}, {
  3.693549104241928*^9, 3.693549105081459*^9}, {3.693549660654559*^9, 
  3.6935496613339853`*^9}, {3.693550370497325*^9, 3.6935503967347603`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.693549023915489*^9, 3.69354906973875*^9, 3.693549115183797*^9, 
   3.693549374432523*^9, 3.693549470639276*^9, {3.693549659022702*^9, 
   3.6935496627192717`*^9}, 3.693549953545395*^9, {3.693550506410406*^9, 
   3.693550527360511*^9}, 3.693554175697732*^9, 3.6935542255456247`*^9, 
   3.693554280797245*^9, 3.693555035967455*^9, 3.693560087472206*^9, 
   3.6935602409764442`*^9, 3.69356031629776*^9, 3.693565833215888*^9, 
   3.6935742726174183`*^9, 3.693574976024*^9, 3.693575043180599*^9, 
   3.693633056298645*^9, 3.694892199745048*^9, 3.6949537043199577`*^9, 
   3.694976031748374*^9, 3.6967423754536753`*^9, 3.696743694332473*^9}]
}, Open  ]],

Cell["We can consider male gametes similarly", "Text",
 CellChangeTimes->{{3.693544220315609*^9, 3.693544232641922*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"X", " ", "bearing", " ", "pollen"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"nextXAMm", "=", 
     RowBox[{"xx11ms", "+", 
      RowBox[{"xx13ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xx12ms", "+", 
         RowBox[{"xx14ms", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rm"}], ")"}]}], "+", 
         RowBox[{"xx23ms", "*", "Rm"}]}], ")"}], "\[Alpha]m"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy11ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy12ms", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rMMm"}], ")"}]}], "+", 
         RowBox[{"xy21ms", " ", 
          RowBox[{"(", "rMMm", ")"}]}]}], ")"}], "\[Alpha]m"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy13ms", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]m"}], ")"}]}], "+", 
         RowBox[{"xy31ms", " ", 
          RowBox[{"(", "\[Chi]m", ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy14ms", " ", "*", "\[Alpha]m"}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14ms", " ", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rm", "+", "rMmm", "+", "\[Chi]m"}], ")"}]}], ")"}]}], 
         "+", " ", "\[IndentingNewLine]", 
         RowBox[{"xy41ms", 
          RowBox[{"(", 
           RowBox[{"rMmm", "+", "\[Chi]m", "-", "Rm"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy23ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "rMmm", "-", "\[Chi]m"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy32ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "\[Chi]m", "-", "rMmm"}], ")"}]}]}], ")"}], 
       RowBox[{"\[Alpha]m", "/", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextXaMm", " ", "=", 
     RowBox[{"xx22ms", "+", 
      RowBox[{"xx24ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"xx12ms", "+", 
         RowBox[{"xx23ms", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rm"}], ")"}]}], "+", 
         RowBox[{"xx14ms", "*", "Rm"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{"xy22ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy12ms", 
          RowBox[{"(", "rMMm", ")"}]}], "+", 
         RowBox[{"xy21ms", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rMMm"}], ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy24ms", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]m"}], ")"}]}], "+", 
         RowBox[{"xy42ms", " ", 
          RowBox[{"(", "\[Chi]m", ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy23ms", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "rMmm", "-", "\[Chi]m"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy41ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "\[Chi]m", "-", "rMmm"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy23ms", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rm", "+", "rMmm", "+", "\[Chi]m"}], ")"}]}], ")"}]}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"xy32ms", " ", 
          RowBox[{"(", 
           RowBox[{"rMmm", "+", "\[Chi]m", "-", "Rm"}], ")"}]}]}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]m"}], ")"}], "/", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextXAmm", " ", "=", 
     RowBox[{"xx33ms", "+", 
      RowBox[{"xx13ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xx23ms", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rm"}], ")"}]}], "+", 
         RowBox[{"Rm", "*", "xx14ms"}], "+", "xx34ms"}], ")"}], "\[Alpha]m"}],
       "+", "\[IndentingNewLine]", 
      RowBox[{"xy33ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy34ms", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rmmm"}], ")"}]}], "+", 
         RowBox[{"xy43ms", 
          RowBox[{"(", "rmmm", ")"}]}]}], ")"}], "\[Alpha]m"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy13ms", 
          RowBox[{"(", "\[Chi]m", ")"}]}], "+", 
         RowBox[{"xy31ms", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]m"}], ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy32ms", " ", "*", "\[Alpha]m"}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "\[Chi]m", "-", "rMmm"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy41ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "rMmm", "-", "\[Chi]m"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy23ms", 
          RowBox[{"(", 
           RowBox[{"rMmm", "+", "\[Chi]m", "-", "Rm"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy32ms", " ", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rm", "+", "rMmm", "+", "\[Chi]m"}], ")"}]}], ")"}]}]}], 
        ")"}], 
       RowBox[{"\[Alpha]m", "/", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextXamm", "=", 
     RowBox[{"xx44ms", "+", 
      RowBox[{"xx24ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xx14ms", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rm"}], ")"}]}], "+", 
         RowBox[{"xx23ms", "*", "Rm"}], "+", "xx34ms"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{"xy44ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy34ms", 
          RowBox[{"(", "rmmm", ")"}]}], "+", 
         RowBox[{"xy43ms", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rmmm"}], ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy24ms", 
          RowBox[{"(", "\[Chi]m", ")"}]}], "+", 
         RowBox[{"xy42ms", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]m"}], ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy41ms", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14ms", 
          RowBox[{"(", 
           RowBox[{"rMmm", "+", "\[Chi]m", "-", "Rm"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy41ms", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rm", "+", "rMmm", "+", "\[Chi]m"}], ")"}]}], ")"}]}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"xy23ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "\[Chi]m", "-", "rMmm"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy32ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "rMmm", "-", "\[Chi]m"}], ")"}]}]}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]m"}], ")"}], "/", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Y", " ", "bearing", " ", "pollen"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYAMm", "=", 
     RowBox[{"yy11ms", "+", 
      RowBox[{"yy13ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"yy12ms", "+", 
         RowBox[{"yy14ms", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rm"}], ")"}]}], "+", 
         RowBox[{"yy23ms", "*", "Rm"}]}], ")"}], "\[Alpha]m"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy11ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy12ms", 
          RowBox[{"(", "rMMm", ")"}]}], "+", 
         RowBox[{"xy21ms", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rMMm"}], ")"}]}]}], ")"}], 
       RowBox[{"(", "\[Alpha]m", ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy13ms", 
          RowBox[{"(", "\[Chi]m", ")"}]}], "+", 
         RowBox[{"xy31ms", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]m"}], ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy41ms", "*", "\[Alpha]m"}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14ms", " ", 
          RowBox[{"(", 
           RowBox[{"rMmm", "+", "\[Chi]m", "-", "Rm"}], ")"}]}], "+", 
         "\[IndentingNewLine]", " ", 
         RowBox[{"xy41ms", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rm", "+", "rMmm", "+", "\[Chi]m"}], ")"}]}], ")"}]}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"xy23ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "\[Chi]m", "-", "rMmm"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy32ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "rMmm", "-", "\[Chi]m"}], ")"}]}]}], ")"}], 
       RowBox[{"\[Alpha]m", "/", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYaMm", " ", "=", 
     RowBox[{"yy22ms", "+", 
      RowBox[{"yy24ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"yy12ms", "+", 
         RowBox[{"yy23ms", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rm"}], ")"}]}], "+", 
         RowBox[{"yy14ms", "*", "Rm"}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{"xy22ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy12ms", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rMMm"}], ")"}]}], "+", 
         RowBox[{"xy21ms", 
          RowBox[{"(", "rMMm", ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy24ms", " ", 
          RowBox[{"(", "\[Chi]m", ")"}]}], "+", 
         RowBox[{"xy42ms", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]m"}], ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy32ms", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "\[Chi]m", "-", "rMmm"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy41ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "rMmm", "-", "\[Chi]m"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy23ms", 
          RowBox[{"(", 
           RowBox[{"rMmm", "+", "\[Chi]m", "-", "Rm"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy32ms", " ", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rm", "+", "rMmm", "+", "\[Chi]m"}], ")"}]}], ")"}]}]}], 
        ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]m"}], ")"}], "/", "2"}]}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYAmm", "=", 
     RowBox[{"yy33ms", "+", 
      RowBox[{"yy13ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yy23ms", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rm"}], ")"}]}], "+", 
         RowBox[{"Rm", "*", "yy14ms"}], "+", "yy34ms"}], ")"}], "\[Alpha]m"}],
       "+", "\[IndentingNewLine]", 
      RowBox[{"xy33ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy34ms", 
          RowBox[{"(", "rmmm", ")"}]}], "+", 
         RowBox[{"xy43ms", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rmmm"}], ")"}]}]}], ")"}], 
       RowBox[{"(", "\[Alpha]m", ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy13ms", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]m"}], ")"}]}], "+", 
         RowBox[{"xy31ms", 
          RowBox[{"(", "\[Chi]m", ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy23ms", "*", "\[Alpha]m"}], "+", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "rMmm", "-", "\[Chi]m"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy41ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "\[Chi]m", "-", "rMmm"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy23ms", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rm", "+", "rMmm", "+", "\[Chi]m"}], ")"}]}], ")"}]}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"xy32ms", " ", 
          RowBox[{"(", 
           RowBox[{"rMmm", "+", "\[Chi]m", "-", "Rm"}], ")"}]}]}], ")"}], 
       RowBox[{"\[Alpha]m", "/", "2"}]}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"nextYamm", "=", 
     RowBox[{"yy44ms", "+", 
      RowBox[{"yy24ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"yy14ms", "*", 
          RowBox[{"(", 
           RowBox[{"1", "-", "Rm"}], ")"}]}], "+", 
         RowBox[{"yy23ms", "*", "Rm"}], "+", "yy34ms"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{"xy44ms", "/", "2"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy34ms", 
          RowBox[{"(", 
           RowBox[{"1", "-", "rmmm"}], ")"}]}], "+", 
         RowBox[{"xy43ms", 
          RowBox[{"(", "rmmm", ")"}]}]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy24ms", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Chi]m"}], ")"}]}], "+", 
         RowBox[{"xy42ms", 
          RowBox[{"(", "\[Chi]m", ")"}]}]}], ")"}], "/", "2"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"xy14ms", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], "+", "\[IndentingNewLine]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xy14ms", 
          RowBox[{"(", 
           RowBox[{"-", 
            RowBox[{"(", 
             RowBox[{"Rm", "+", "rMmm", "+", "\[Chi]m"}], ")"}]}], ")"}]}], 
         "+", "\[IndentingNewLine]", 
         RowBox[{"xy41ms", 
          RowBox[{"(", 
           RowBox[{"rMmm", "+", "\[Chi]m", "-", "Rm"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy23ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "rMmm", "-", "\[Chi]m"}], ")"}]}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"xy32ms", 
          RowBox[{"(", 
           RowBox[{"Rm", "+", "\[Chi]m", "-", "rMmm"}], ")"}]}]}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]m"}], ")"}], "/", "2"}]}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.693309915501526*^9, 3.6933099325077677`*^9}, {
   3.693309994483501*^9, 3.693310111226685*^9}, 3.693310458051482*^9, {
   3.693310504984441*^9, 3.693310571845592*^9}, {3.693310708322699*^9, 
   3.693310965833001*^9}, {3.693311068691226*^9, 3.693311076707844*^9}, {
   3.693311116392437*^9, 3.693311174992943*^9}, {3.693311224910478*^9, 
   3.693311386325416*^9}, {3.693311492371409*^9, 3.693311517729001*^9}, 
   3.693311563059478*^9, {3.693311747119026*^9, 3.6933120753696938`*^9}, {
   3.693312142532003*^9, 3.693312148484177*^9}, {3.693312186677787*^9, 
   3.69331257884744*^9}, {3.693312610467888*^9, 3.693312654396325*^9}, {
   3.693312761967066*^9, 3.6933128469525948`*^9}, {3.693312884107136*^9, 
   3.693312884458653*^9}, {3.693312918963231*^9, 3.693312925162354*^9}, 
   3.693313010915413*^9, {3.6935442167971992`*^9, 3.693544825708024*^9}, {
   3.6935452106055193`*^9, 3.693545223204241*^9}, {3.69354525530927*^9, 
   3.693545268926076*^9}, {3.693545327726218*^9, 3.693545350520911*^9}, {
   3.693545453241535*^9, 3.693545454792568*^9}, {3.693550402708359*^9, 
   3.693550453171851*^9}, {3.693554228857955*^9, 3.6935542406252203`*^9}, {
   3.6935603219341516`*^9, 3.6935604022444057`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{
  "nextXAMm", "+", "nextXaMm", "+", "nextXAmm", "+", "nextXamm", "+", 
   "nextYAMm", "+", "nextYaMm", "+", "nextYAmm", "+", "nextYamm"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.693546553616716*^9, 3.693546554909905*^9}, {
  3.693550456814139*^9, 3.693550484284959*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.6935465579514227`*^9, 3.69354661148549*^9, 
  3.693549958512995*^9, 3.6935505112828407`*^9, 3.6935542487947483`*^9, 
  3.693554286241476*^9, 3.6935550427641773`*^9, 3.6935604126447077`*^9, 
  3.693565836725946*^9, 3.693574281070726*^9, 3.6935749880741787`*^9, 
  3.693575049785119*^9, 3.693633068657209*^9, 3.694892207175983*^9, 
  3.694953713275013*^9, 3.694976039143887*^9, 3.696742388084182*^9, 
  3.696743701035972*^9}]
}, Open  ]],

Cell["\<\
Generally want to at least assume that recombination is not affected by M or \
sex\
\>", "Text",
 CellChangeTimes->{{3.693576509939515*^9, 3.6935765257483883`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SUBSR", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Rm", "\[Rule]", "R"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Rf", "\[Rule]", "R"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rMMm", "\[Rule]", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rMmm", "\[Rule]", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rmmm", "\[Rule]", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rMMf", "\[Rule]", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rMmf", "\[Rule]", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rmmf", "\[Rule]", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]m", "\[Rule]", "\[Chi]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]f", "\[Rule]", "\[Chi]"}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.693576482311194*^9, 3.693576503857477*^9}}],

Cell["Often also want to assume the following about k:", "Text",
 CellChangeTimes->{{3.693576529436275*^9, 3.693576542060069*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"SUBS", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"Rm", "\[Rule]", "R"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Rf", "\[Rule]", "R"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rMMm", "\[Rule]", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rMmm", "\[Rule]", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rmmm", "\[Rule]", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rMMf", "\[Rule]", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rMmf", "\[Rule]", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{"rmmf", "\[Rule]", "r"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]m", "\[Rule]", "\[Chi]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Chi]f", "\[Rule]", "\[Chi]"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kXX", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kXY", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kYY", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kMmXX", "\[Rule]", "k"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kMmXY", "\[Rule]", "k"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kMmYY", "\[Rule]", "k"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kmm", "\[Rule]", "k"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kmm", "\[Rule]", "k"}], ",", "\[IndentingNewLine]", 
     RowBox[{"kmm", "\[Rule]", "k"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.693565362409412*^9, 3.693565523507833*^9}, 
   3.693574407062133*^9, {3.693576609329269*^9, 3.69357661956073*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Resident equilibria (r=0)", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9, {3.675889497088314*^9, 3.675889497307007*^9}, {
   3.675897573374775*^9, 3.675897575830624*^9}, {3.675897716718397*^9, 
   3.6758977222283363`*^9}, 3.676682250170936*^9, 3.676682959070333*^9, {
   3.6767193867939043`*^9, 3.676719388460558*^9}, {3.6785484984643793`*^9, 
   3.678548500198676*^9}, {3.6788453373450623`*^9, 3.6788453383130693`*^9}, {
   3.693574268945793*^9, 3.693574270688842*^9}, {3.696698132496373*^9, 
   3.6966981330152407`*^9}, {3.696777835924974*^9, 3.696777836363907*^9}}],

Cell["We first assume that the neoY is absent ", "Text",
 CellChangeTimes->{{3.675897612080282*^9, 3.675897623453624*^9}, {
  3.676719440380638*^9, 3.676719440800579*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subequil", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAMf", "\[Rule]", "pXf"}], ",", "\[IndentingNewLine]", 
     RowBox[{"XaMf", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"1", "-", "pXf"}], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YAMf", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"YaMf", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAMm", "\[Rule]", 
      RowBox[{"pXm", 
       RowBox[{"(", 
        RowBox[{"1", "-", "freqYm"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"XaMm", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pXm"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "freqYm"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YAMm", "\[Rule]", 
      RowBox[{"pYm", "*", "freqYm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YaMm", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pYm"}], ")"}], "*", "freqYm"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"XAmf", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xamf", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAmm", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xamm", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"YAmm", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Yamm", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"YAmf", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Yamf", "\[Rule]", "0"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675897631284259*^9, 3.675897659212982*^9}, {
  3.677426392548254*^9, 3.677426471423079*^9}, {3.693574311009759*^9, 
  3.693574356040964*^9}, {3.6935762212992687`*^9, 3.6935762242966833`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"wbarHapMale", "/.", "subequil"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.696743698732032*^9, 3.6967437056690283`*^9}, {
  3.696743803331464*^9, 3.6967438670827293`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "freqYm", " ", 
       RowBox[{"(", 
        RowBox[{"pAvem", "-", "pXm"}], ")"}]}], "+", "pXm"}], ")"}]}], " ", 
   "wam"}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "freqYm", " ", 
      RowBox[{"(", 
       RowBox[{"pAvem", "-", "pXm"}], ")"}]}], "+", "pXm"}], ")"}], " ", 
   "wAm"}]}]], "Output",
 CellChangeTimes->{{3.696743701924008*^9, 3.696743705989884*^9}, {
  3.696743845453786*^9, 3.696743858260672*^9}}]
}, Open  ]],

Cell["\<\
where pXf is the frequency of A in non-mutant eggs, pXm is the frequency of A \
in gametes from males with an X allele, and pY is the frequency of A in \
gametes from males with a Y allele.\
\>", "Text",
 CellChangeTimes->{{3.676719569815831*^9, 3.676719650518496*^9}}],

Cell["\<\
We now wish to solve for the equilibrium frequencies of the haploid genotypes \
in gametes of each sex. Equilibrium is achieved when the following three \
equations are zero\
\>", "Text",
 CellChangeTimes->{{3.675694155902801*^9, 3.675694193760104*^9}, {
   3.6756944337868023`*^9, 3.6756944351881227`*^9}, {3.6757029847267847`*^9, 
   3.67570303405547*^9}, {3.675710696458521*^9, 3.675710706286772*^9}, 
   3.6758975924118633`*^9, {3.676719416278571*^9, 3.676719460360141*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"nextXAMf", "-", "XAMf"}], ",", "\[IndentingNewLine]", 
       RowBox[{"nextXAMm", "-", "XAMm"}], ",", "\[IndentingNewLine]", 
       RowBox[{"nextYAMm", "-", "YAMm"}], ",", "\[IndentingNewLine]", 
       RowBox[{"nextYAMm", "+", "nextYaMm", "-", 
        RowBox[{"(", 
         RowBox[{"YAMm", "+", "YaMm"}], ")"}]}]}], "\[IndentingNewLine]", 
      "}"}], "/.", "SUBS"}], "/.", "subequil"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675647987041369*^9, 3.67564802904979*^9}, {
   3.675650509895372*^9, 3.675650527299842*^9}, {3.6756941716513157`*^9, 
   3.6756941738671913`*^9}, {3.675694338488646*^9, 3.675694340978696*^9}, {
   3.675694394143187*^9, 3.6756944261522427`*^9}, 3.6756944751724463`*^9, 
   3.675702984727247*^9, {3.675703036868017*^9, 3.675703037688758*^9}, 
   3.67578824463701*^9, 3.675897781726954*^9, {3.6774265364359407`*^9, 
   3.677426537058071*^9}, {3.693574362004157*^9, 3.6935743915634527`*^9}, {
   3.693575169683814*^9, 3.693575181564322*^9}}],

Cell["Here we look at the case where r=0 and find the equilibria", "Text",
 CellChangeTimes->{{3.696777004229587*^9, 3.696777019949113*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqsr0", "=", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"differenceEqs", "/.", 
     RowBox[{"r", "\[Rule]", "0"}]}], ")"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.696742409303525*^9, 3.69674245732235*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Faa", " ", "pXf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pXf", "+", "pXm", "-", 
         RowBox[{"pXf", " ", "pXm"}]}], ")"}], " ", "waf", " ", "wam"}], "-", 
      
      RowBox[{"FAA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", "pXf", " ", "pXm", " ",
        "wAf", " ", "wAm"}], "+", 
      RowBox[{"FAa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pXm"}], " ", "waf", " ", "wAm"}], "+", 
         RowBox[{"pXf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "pXm"}], ")"}], " ", "wAf", " ", 
             "wam"}], "+", 
            RowBox[{"pXm", " ", "waf", " ", "wAm"}]}], ")"}]}]}], ")"}], " ", 
       
       RowBox[{"(", 
        RowBox[{"pXf", "-", "\[Alpha]f"}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Faa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pXm"}], ")"}], " ", "waf", " ", "wam"}], 
      "+", 
      RowBox[{"FAA", " ", "pXf", " ", "pXm", " ", "wAf", " ", "wAm"}], "+", 
      RowBox[{"FAa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pXm", " ", "waf", " ", "wAm"}], "-", 
         RowBox[{"pXf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "pXm"}], ")"}], " ", "wAf", " ", 
             "wam"}], "+", 
            RowBox[{"pXm", " ", "waf", " ", "wAm"}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "freqYm"}], ")"}], " ", "Maa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", "pXm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "waf", " ", "wam"}], 
      "+", 
      RowBox[{"MAA", " ", "pXf", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "freqYm"}], ")"}], " ", "pXm"}]}], ")"}],
        " ", "pYm", " ", "wAf", " ", "wAm"}], "-", 
      RowBox[{"2", " ", "MAa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "freqYm"}], ")"}]}], " ", "pXm", " ", 
          "pYm", " ", "waf", " ", "wAm"}], "+", 
         RowBox[{"pXf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "freqYm"}], ")"}], " ", "pXm", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "wAf", " ", 
                "wam"}], "+", 
               RowBox[{"pYm", " ", "waf", " ", "wAm"}]}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "wAf", " ", 
             "wam", " ", "\[Alpha]m"}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Maa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "waf", " ", "wam"}], 
        "+", 
        RowBox[{"MAA", " ", "pXf", " ", "pYm", " ", "wAf", " ", "wAm"}], "+", 
        
        RowBox[{"MAa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pYm", " ", "waf", " ", "wAm"}], "-", 
           RowBox[{"pXf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "wAf", " ", 
               "wam"}], "+", 
              RowBox[{"pYm", " ", "waf", " ", "wAm"}]}], ")"}]}]}], ")"}]}]}],
        ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"pYm", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "freqYm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "waf", " ", 
            "wam"}], "+", 
           RowBox[{"MAA", " ", "pXf", " ", "pYm", " ", "wAf", " ", "wAm"}], 
           "+", 
           RowBox[{"MAa", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"pYm", " ", "waf", " ", "wAm"}], "-", 
              RowBox[{"pXf", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "wAf", " ", 
                  "wam"}], "+", 
                 RowBox[{"pYm", " ", "waf", " ", "wAm"}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], "+", 
        RowBox[{"wAm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MAA", " ", "pXf", " ", "wAf"}], "-", 
           RowBox[{"2", " ", "MAa", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", "waf", " ", 
            "\[Alpha]m"}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Maa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "waf", " ", "wam"}], 
        "+", 
        RowBox[{"MAA", " ", "pXf", " ", "pYm", " ", "wAf", " ", "wAm"}], "+", 
        
        RowBox[{"MAa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pYm", " ", "waf", " ", "wAm"}], "-", 
           RowBox[{"pXf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "wAf", " ", 
               "wam"}], "+", 
              RowBox[{"pYm", " ", "waf", " ", "wAm"}]}], ")"}]}]}], ")"}]}]}],
        ")"}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "freqYm"}]}], ")"}]}], " ", "Maa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "waf", " ", "wam"}], 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "freqYm"}]}], ")"}], " ", "MAA", " ", "pXf", " ", 
       "pYm", " ", "wAf", " ", "wAm"}], "+", 
      RowBox[{"2", " ", "MAa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pYm", " ", "waf", " ", "wAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "freqYm"}], "+", "\[Alpha]m"}], ")"}]}], "+", 
         RowBox[{"pXf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"pYm", " ", "waf", " ", "wAm", " ", 
             RowBox[{"(", 
              RowBox[{"freqYm", "-", "\[Alpha]m"}], ")"}]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "wAf", " ", 
             "wam", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "freqYm", "+", "\[Alpha]m"}], 
              ")"}]}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Maa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "waf", " ", "wam"}], 
        "+", 
        RowBox[{"MAA", " ", "pXf", " ", "pYm", " ", "wAf", " ", "wAm"}], "+", 
        
        RowBox[{"MAa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pYm", " ", "waf", " ", "wAm"}], "-", 
           RowBox[{"pXf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "wAf", " ", 
               "wam"}], "+", 
              RowBox[{"pYm", " ", "waf", " ", "wAm"}]}], ")"}]}]}], ")"}]}]}],
        ")"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.696742410648115*^9, 3.696742457839953*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"freqYmsol", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqsr0", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", "freqYm", "}"}]}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pYmsol", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"differenceEqsr0", "[", 
          RowBox[{"[", "3", "]"}], "]"}], "/.", "freqYmsol"}], ")"}], 
       "\[Equal]", "0"}], ",", 
      RowBox[{"{", "pYm", "}"}]}], "]"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.696742438942616*^9, 3.696742537910048*^9}, {
  3.696751792860021*^9, 3.696751793091411*^9}, {3.696777031790414*^9, 
  3.6967770320947113`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"freqYm", "\[Rule]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Maa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "waf", " ", "wam"}], 
      "+", 
      RowBox[{"MAA", " ", "pXf", " ", "pYm", " ", "wAf", " ", "wAm"}], "+", 
      RowBox[{"2", " ", "MAa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"pYm", " ", "waf", " ", "wAm", " ", "\[Alpha]m"}], "+", 
         RowBox[{"pXf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "wAf", " ", 
             "wam", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "-", 
            RowBox[{"pYm", " ", "waf", " ", "wAm", " ", "\[Alpha]m"}]}], 
           ")"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Maa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "waf", " ", "wam"}], 
        "+", 
        RowBox[{"MAA", " ", "pXf", " ", "pYm", " ", "wAf", " ", "wAm"}], "+", 
        
        RowBox[{"MAa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"pYm", " ", "waf", " ", "wAm"}], "-", 
           RowBox[{"pXf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "pYm"}], ")"}], " ", "wAf", " ", 
               "wam"}], "+", 
              RowBox[{"pYm", " ", "waf", " ", "wAm"}]}], ")"}]}]}], ")"}]}]}],
        ")"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6967424466673927`*^9, 3.696742471520557*^9}, {
   3.69674250709068*^9, 3.696742538414941*^9}, 3.696742608089417*^9, 
   3.696742679145556*^9, 3.6967517936571827`*^9, 3.696763838680459*^9, 
   3.696777036364051*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"pYm", "\[Rule]", "0"}], ",", 
   RowBox[{"pYm", "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6967424466673927`*^9, 3.696742471520557*^9}, {
   3.69674250709068*^9, 3.696742538414941*^9}, 3.696742608089417*^9, 
   3.696742679145556*^9, 3.6967517936571827`*^9, 3.696763838680459*^9, 
   3.696777036367136*^9}]
}, Open  ]],

Cell["\<\
Thus, the Y allele is either fixed or absent. We first solve for pYm=1. \
\>", "Text",
 CellChangeTimes->{{3.69677703978051*^9, 3.6967770628434963`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pXmsol", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"differenceEqsr0", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "/.", "freqYmsol"}], "/.", 
         RowBox[{"pYmsol", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}], ")"}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", "pXm", "}"}]}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pXfsol", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"differenceEqsr0", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "freqYmsol"}], "/.", 
          RowBox[{"pYmsol", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], "/.", "pXmsol"}], ")"}], 
       "\[Equal]", "0"}], ",", 
      RowBox[{"{", "pXf", "}"}]}], "]"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6967426819919024`*^9, 3.696742716042186*^9}, {
  3.69674857763764*^9, 3.6967485800046062`*^9}, {3.69675194720293*^9, 
  3.696751947611627*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"pXm", "\[Rule]", 
   FractionBox[
    RowBox[{"MAA", " ", "pXf", " ", "wAf"}], 
    RowBox[{
     RowBox[{"MAA", " ", "pXf", " ", "wAf"}], "+", 
     RowBox[{"2", " ", "MAa", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", "waf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}]]}], "}"}]], "Output",\

 CellChangeTimes->{{3.696742704015224*^9, 3.6967427163315887`*^9}, {
   3.696748565234741*^9, 3.696748580196515*^9}, 3.696751795116078*^9, {
   3.6967519414210873`*^9, 3.696751948099905*^9}, 3.696763840394766*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"pXf", "\[Rule]", "0"}], ",", 
   RowBox[{"pXf", "\[Rule]", "1"}], ",", 
   RowBox[{"pXf", "\[Rule]", 
    FractionBox[
     RowBox[{"waf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MAA", " ", "wAm"}], "-", 
           RowBox[{"2", " ", "MAa", " ", "wam", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"wAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "FAA"}], " ", "MAA", " ", "wAf", " ", "wAm"}], "+", 
         RowBox[{"FAa", " ", "waf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MAA", " ", "wAm"}], "-", 
            RowBox[{"2", " ", "MAa", " ", "wam", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]}], 
        ")"}]}], "+", 
      RowBox[{"2", " ", "Faa", " ", "MAa", " ", 
       SuperscriptBox["waf", "2"], " ", "wam", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.696742704015224*^9, 3.6967427163315887`*^9}, {
   3.696748565234741*^9, 3.696748580196515*^9}, 3.696751795116078*^9, {
   3.6967519414210873`*^9, 3.696751948099905*^9}, 3.6967638404399652`*^9}]
}, Open  ]],

Cell["\<\
There are therefore 2 equilibria that maintain multiple alleles when pYm=1, \
one where there is a polymorphism on the X (solpoly1) and one where the X is \
fixed for the a allele (pXm=pXf=0, solfixed1). \
\>", "Text",
 CellChangeTimes->{{3.6967770995870457`*^9, 3.69677715424114*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"freqYm", ",", "pYm", ",", "pXm", ",", "pXf"}], "}"}], "/.", 
        "freqYmsol"}], "/.", 
       RowBox[{"pYmsol", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "/.", "pXmsol"}], "/.", 
     RowBox[{"pXfsol", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"solpoly1", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"freqYm", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"pYm", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{"pXm", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", 
    RowBox[{"pXf", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"freqYm", ",", "pYm", ",", "pXm", ",", "pXf"}], "}"}], "/.", 
        "freqYmsol"}], "/.", 
       RowBox[{"pYmsol", "[", 
        RowBox[{"[", "2", "]"}], "]"}]}], "/.", "pXmsol"}], "/.", 
     RowBox[{"pXfsol", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"solfixed1", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"freqYm", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"pYm", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{"pXm", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", 
    RowBox[{"pXf", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.69674861664533*^9, 3.696748757601643*^9}, {
  3.696751778998633*^9, 3.696751780493679*^9}, {3.696751822548191*^9, 
  3.6967518545755587`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"freqYm", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
       "2", " ", "Faa", " ", "MAa", " ", "MAA", " ", "waf", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "-", 
       RowBox[{
       "2", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wAf", " ", "wAm", " ", 
        "\[Alpha]m"}], "+", 
       RowBox[{"FAa", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
          RowBox[{"2", " ", "MAa", " ", "wam", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "MAA"}], " ", "wAf", " ", "\[Alpha]f"}], "+", 
          RowBox[{"2", " ", "MAa", " ", "waf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
           "\[Alpha]m"}]}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FAa", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MAa", " ", "waf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}]}], "-", 
            RowBox[{"MAA", " ", "wAf", " ", "\[Alpha]f"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
            RowBox[{"2", " ", "MAa", " ", "wam", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
         "+", 
         RowBox[{"MAa", " ", "MAA", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "FAA"}], " ", "wAf", " ", "wAm"}], "+", 
            RowBox[{"2", " ", "Faa", " ", "waf", " ", "wam", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]}], 
        ")"}]}], ")"}]}]}], ",", 
   RowBox[{"pYm", "\[Rule]", "1"}], ",", 
   RowBox[{"pXm", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"MAA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MAA", " ", "wAm"}], "-", 
            RowBox[{"2", " ", "MAa", " ", "wam", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
         "+", 
         RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], ")"}],
      "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "FAa"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
          RowBox[{"2", " ", "MAa", " ", "wam", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAA", " ", "wAf", " ", "\[Alpha]f"}], "+", 
          RowBox[{"2", " ", "MAa", " ", "waf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], "+", 
       
       RowBox[{"2", " ", "MAa", " ", "MAA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Faa", " ", "waf", " ", "wam"}], "+", 
          RowBox[{"FAA", " ", "wAf", " ", "wAm"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]}], ",", 
   RowBox[{"pXf", "\[Rule]", 
    FractionBox[
     RowBox[{"waf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MAA", " ", "wAm"}], "-", 
           RowBox[{"2", " ", "MAa", " ", "wam", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"wAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "FAA"}], " ", "MAA", " ", "wAf", " ", "wAm"}], "+", 
         RowBox[{"FAa", " ", "waf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MAA", " ", "wAm"}], "-", 
            RowBox[{"2", " ", "MAa", " ", "wam", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]}], 
        ")"}]}], "+", 
      RowBox[{"2", " ", "Faa", " ", "MAa", " ", 
       SuperscriptBox["waf", "2"], " ", "wam", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}]]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.696748640190381*^9, 3.696748681968687*^9}, 
   3.6967487580355988`*^9, 3.696751782051491*^9, 3.696751857184095*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"freqYm", "\[Rule]", "\[Alpha]m"}], ",", 
   RowBox[{"pYm", "\[Rule]", "1"}], ",", 
   RowBox[{"pXm", "\[Rule]", "0"}], ",", 
   RowBox[{"pXf", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.696748640190381*^9, 3.696748681968687*^9}, 
   3.6967487580355988`*^9, 3.696751782051491*^9, 3.696751857187337*^9}]
}, Open  ]],

Cell["\<\
Must now also solve for pYm=0, and find frequency on the Xs. \
\>", "Text",
 CellChangeTimes->{{3.69677703978051*^9, 3.696777091842876*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"pXmsol0", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"differenceEqsr0", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "/.", "freqYmsol"}], "/.", 
         RowBox[{"pYmsol", "[", 
          RowBox[{"[", "1", "]"}], "]"}]}], ")"}], "\[Equal]", "0"}], ",", 
      RowBox[{"{", "pXm", "}"}]}], "]"}], "]"}], 
   "]"}]}], "\[IndentingNewLine]", 
 RowBox[{"pXfsol0", "=", 
  RowBox[{"Flatten", "[", 
   RowBox[{"Simplify", "[", 
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"differenceEqsr0", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "/.", "freqYmsol"}], "/.", 
          RowBox[{"pYmsol", "[", 
           RowBox[{"[", "1", "]"}], "]"}]}], "/.", "pXmsol0"}], ")"}], 
       "\[Equal]", "0"}], ",", 
      RowBox[{"{", "pXf", "}"}]}], "]"}], "]"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.69675180492025*^9, 3.696751811193821*^9}, {
  3.6967519063653193`*^9, 3.696751913906106*^9}, {3.696751958019156*^9, 
  3.6967519663622017`*^9}, {3.6967661875716476`*^9, 3.696766197482809*^9}, {
  3.6967662498108273`*^9, 3.69676625425807*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"pXm", "\[Rule]", 
   FractionBox[
    RowBox[{"2", " ", "MAa", " ", "pXf", " ", "wAf", " ", "\[Alpha]m"}], 
    RowBox[{
     RowBox[{"Maa", " ", "waf"}], "-", 
     RowBox[{"Maa", " ", "pXf", " ", "waf"}], "+", 
     RowBox[{"2", " ", "MAa", " ", "pXf", " ", "wAf", " ", "\[Alpha]m"}]}]]}],
   "}"}]], "Output",
 CellChangeTimes->{
  3.6967519155496483`*^9, 3.696751966778185*^9, {3.6967661610332117`*^9, 
   3.6967662545229263`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"pXf", "\[Rule]", "0"}], ",", 
   RowBox[{"pXf", "\[Rule]", "1"}], ",", 
   RowBox[{"pXf", "\[Rule]", 
    FractionBox[
     RowBox[{"waf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Faa", " ", "Maa", " ", "waf", " ", "wam"}], "-", 
        RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "wam"}], "+", 
           RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]}], 
          ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"Faa", " ", "Maa", " ", 
       SuperscriptBox["waf", "2"], " ", "wam"}], "+", 
      RowBox[{"wAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "2", " ", "FAA", " ", "MAa", " ", "wAf", " ", "wAm", " ", 
          "\[Alpha]m"}], "-", 
         RowBox[{"FAa", " ", "waf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Maa", " ", "wam"}], "+", 
            RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]}], 
           ")"}]}]}], ")"}]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6967519155496483`*^9, 3.696751966778185*^9, {3.6967661610332117`*^9, 
   3.6967662545824213`*^9}}]
}, Open  ]],

Cell["\<\
There are again 2 equilibria that maintain multiple alleles when pYm=0, one \
where there is a polymorphism on the X (solpoly1) and one where the X is \
fixed for the A allele (pXm=pXf=1, solfixed0). \
\>", "Text",
 CellChangeTimes->{{3.696777169489999*^9, 3.696777185057557*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"freqYm", ",", "pYm", ",", "pXm", ",", "pXf"}], "}"}], "/.", 
        "freqYmsol"}], "/.", 
       RowBox[{"pYmsol", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", "pXmsol0"}], "/.", 
     RowBox[{"pXfsol0", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"solpoly0", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"freqYm", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"pYm", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{"pXm", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", 
    RowBox[{"pXf", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"temp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"freqYm", ",", "pYm", ",", "pXm", ",", "pXf"}], "}"}], "/.", 
        "freqYmsol"}], "/.", 
       RowBox[{"pYmsol", "[", 
        RowBox[{"[", "1", "]"}], "]"}]}], "/.", "pXmsol"}], "/.", 
     RowBox[{"pXfsol", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], "//", "Simplify"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"solfixed0", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"freqYm", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "1", "]"}], "]"}]}], ",", 
    RowBox[{"pYm", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "2", "]"}], "]"}]}], ",", 
    RowBox[{"pXm", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ",", 
    RowBox[{"pXf", "\[Rule]", 
     RowBox[{"temp", "[", 
      RowBox[{"[", "4", "]"}], "]"}]}]}], "}"}]}]}], "Input",
 CellChangeTimes->{{3.696751980926755*^9, 3.6967519985967083`*^9}, {
  3.6967661237816553`*^9, 3.696766142886879*^9}, {3.696766204142405*^9, 
  3.696766269044464*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"freqYm", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"FAa", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "waf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}]}], "+", 
          RowBox[{"2", " ", "MAa", " ", "wAf", " ", "\[Alpha]f", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wam"}], "+", 
          RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]}], ")"}]}], 
       "+", 
       RowBox[{"2", " ", "Maa", " ", "MAa", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Faa"}], " ", "waf", " ", "wam", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "+", 
          RowBox[{"FAA", " ", "wAf", " ", "wAm", " ", "\[Alpha]m"}]}], 
         ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FAa", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Maa", " ", "waf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}]}], "-", 
            RowBox[{"MAa", " ", "wAf", " ", "\[Alpha]f"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Maa", " ", "wam"}], "+", 
            RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]}], 
           ")"}]}], "+", 
         RowBox[{"Maa", " ", "MAa", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Faa", " ", "waf", " ", "wam"}], "+", 
            RowBox[{
            "2", " ", "FAA", " ", "wAf", " ", "wAm", " ", "\[Alpha]m"}]}], 
           ")"}]}]}], ")"}]}], ")"}]}]}], ",", 
   RowBox[{"pYm", "\[Rule]", "0"}], ",", 
   RowBox[{"pXm", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"2", " ", "MAa", " ", "\[Alpha]m", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Faa"}], " ", "Maa", " ", "waf", " ", "wam"}], "+", 
         RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Maa", " ", "wam"}], "+", 
            RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]}], 
           ")"}]}]}], ")"}]}], 
      RowBox[{
       RowBox[{"2", " ", "Maa", " ", "MAa", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Faa", " ", "waf", " ", "wam"}], "+", 
          RowBox[{"FAA", " ", "wAf", " ", "wAm"}]}], ")"}], " ", 
        "\[Alpha]m"}], "+", 
       RowBox[{"FAa", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wam"}], "+", 
          RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]}], ")"}], 
        " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "waf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}]}], "-", 
          RowBox[{
          "2", " ", "MAa", " ", "wAf", " ", "\[Alpha]f", " ", "\[Alpha]m"}]}],
          ")"}]}]}]]}]}], ",", 
   RowBox[{"pXf", "\[Rule]", 
    FractionBox[
     RowBox[{"waf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Faa", " ", "Maa", " ", "waf", " ", "wam"}], "-", 
        RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "wam"}], "+", 
           RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]}], 
          ")"}]}]}], ")"}]}], 
     RowBox[{
      RowBox[{"Faa", " ", "Maa", " ", 
       SuperscriptBox["waf", "2"], " ", "wam"}], "+", 
      RowBox[{"wAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
         "2", " ", "FAA", " ", "MAa", " ", "wAf", " ", "wAm", " ", 
          "\[Alpha]m"}], "-", 
         RowBox[{"FAa", " ", "waf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Maa", " ", "wam"}], "+", 
            RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]}], 
           ")"}]}]}], ")"}]}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.69676613297502*^9, 3.696766172586775*^9}, {
  3.6967662085143347`*^9, 3.696766238278245*^9}, {3.6967662698793364`*^9, 
  3.6967662802853107`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"freqYm", "\[Rule]", 
    RowBox[{"1", "-", "\[Alpha]m"}]}], ",", 
   RowBox[{"pYm", "\[Rule]", "0"}], ",", 
   RowBox[{"pXm", "\[Rule]", "1"}], ",", 
   RowBox[{"pXf", "\[Rule]", "1"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.69676613297502*^9, 3.696766172586775*^9}, {
  3.6967662085143347`*^9, 3.696766238278245*^9}, {3.6967662698793364`*^9, 
  3.696766280291792*^9}}]
}, Open  ]],

Cell["\<\
There should be an unstable equilibrium where there is a polymorphism on the \
Y. \
\>", "Text",
 CellChangeTimes->{{3.6967520136376543`*^9, 3.696752100981361*^9}, {
  3.696777321118189*^9, 3.696777329181507*^9}}],

Cell["\<\
We can re-write solpoly0 and solpoly1 in terms of factorA and factorB \
(factorA0 and factorB0 used for solpoly0). \
\>", "Text",
 CellChangeTimes->{{3.696764721542993*^9, 3.696764739780463*^9}, {
  3.696766846632559*^9, 3.696766861868486*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"trysub0", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"factorB0", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Faa"}], " ", "Maa", " ", "waf", " ", "wam"}], "+", 
        RowBox[{"FAa", " ", "Maa", " ", "wAf", " ", "wam", " ", "\[Alpha]f"}],
         "+", 
        RowBox[{
        "2", " ", "FAa", " ", "MAa", " ", "wAf", " ", "wAm", " ", "\[Alpha]f",
          " ", "\[Alpha]m"}]}], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"factorA0", "->", 
      RowBox[{
       RowBox[{
       "2", " ", "FAA", " ", "MAa", " ", "wAf", " ", "wAm", " ", 
        "\[Alpha]m"}], "+", 
       RowBox[{"FAa", " ", "waf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wam"}], "+", 
          RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]}], 
         ")"}]}]}]}]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"pXm", "/.", "solpoly0"}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{"Maa", " ", "factorA0"}], 
       RowBox[{
        RowBox[{"Maa", " ", "factorA0"}], "-", 
        RowBox[{"2", " ", 
         RowBox[{"(", "\[Alpha]m", ")"}], "MAa", " ", "factorB0"}]}]]}], "/.",
      "trysub0"}], ")"}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"pXf", "/.", "solpoly0"}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"1", "-", 
      FractionBox[
       RowBox[{" ", 
        RowBox[{"wAf", " ", "factorA0"}]}], 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"wAf", " ", "factorA0"}], "-", " ", 
         RowBox[{"waf", " ", "factorB0"}]}], ")"}]]}], "/.", "trysub0"}], 
    ")"}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"freqYm", "/.", "solpoly0"}], ")"}], "-", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"factorA0", " ", "Maa"}], "-", 
        RowBox[{"2", " ", "factorB0", " ", "MAa", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}]}], 
       RowBox[{" ", 
        RowBox[{
         RowBox[{"factorA0", " ", "Maa"}], "-", " ", 
         RowBox[{"factorB0", " ", "MAa"}]}]}]], "/.", "trysub0"}], ")"}]}]}], 
  "//", "Factor"}]}], "Input",
 CellChangeTimes->{
  3.696763889402609*^9, 3.6967639305774317`*^9, {3.696764007416998*^9, 
   3.696764027692898*^9}, {3.696764168156623*^9, 3.696764171808805*^9}, 
   3.696764229036057*^9, 3.696764305146172*^9, {3.696764347226609*^9, 
   3.696764356170085*^9}, {3.696764397810892*^9, 3.696764401056625*^9}, {
   3.6967644811212187`*^9, 3.6967644860368357`*^9}, {3.696764651437174*^9, 
   3.6967646641877947`*^9}, {3.696764743431467*^9, 3.6967647695584*^9}, {
   3.696764806819408*^9, 3.6967648517245398`*^9}, {3.69676647234042*^9, 
   3.696766497506007*^9}, {3.696766657631235*^9, 3.6967666594067574`*^9}, {
   3.696766692200982*^9, 3.69676682598775*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.696763894696332*^9, 3.6967639309372663`*^9, {3.6967640077332706`*^9, 
   3.696764028091357*^9}, {3.696764169616864*^9, 3.696764172209859*^9}, 
   3.696764305485044*^9, {3.6967643480007153`*^9, 3.6967643566202927`*^9}, {
   3.696764398607975*^9, 3.696764401362499*^9}, 3.6967644868293037`*^9, 
   3.696764664631699*^9, 3.696764769977085*^9, 3.696764833808343*^9, 
   3.696766333468853*^9, {3.696766479965213*^9, 3.6967664978423767`*^9}, {
   3.696766724411779*^9, 3.6967668263374443`*^9}, 3.696777362897664*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.696763894696332*^9, 3.6967639309372663`*^9, {3.6967640077332706`*^9, 
   3.696764028091357*^9}, {3.696764169616864*^9, 3.696764172209859*^9}, 
   3.696764305485044*^9, {3.6967643480007153`*^9, 3.6967643566202927`*^9}, {
   3.696764398607975*^9, 3.696764401362499*^9}, 3.6967644868293037`*^9, 
   3.696764664631699*^9, 3.696764769977085*^9, 3.696764833808343*^9, 
   3.696766333468853*^9, {3.696766479965213*^9, 3.6967664978423767`*^9}, {
   3.696766724411779*^9, 3.6967668263374443`*^9}, 3.6967773629041843`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{
  3.696763894696332*^9, 3.6967639309372663`*^9, {3.6967640077332706`*^9, 
   3.696764028091357*^9}, {3.696764169616864*^9, 3.696764172209859*^9}, 
   3.696764305485044*^9, {3.6967643480007153`*^9, 3.6967643566202927`*^9}, {
   3.696764398607975*^9, 3.696764401362499*^9}, 3.6967644868293037`*^9, 
   3.696764664631699*^9, 3.696764769977085*^9, 3.696764833808343*^9, 
   3.696766333468853*^9, {3.696766479965213*^9, 3.6967664978423767`*^9}, {
   3.696766724411779*^9, 3.6967668263374443`*^9}, 3.69677736292889*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"trysub", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"factorB", "\[Rule]", 
      RowBox[{
       RowBox[{"FAa", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAA", " ", "waf", " ", "wAm", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Alpha]f"}], ")"}]}], "+", 
          RowBox[{"2", " ", "MAa", " ", "waf", " ", "wam", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Alpha]f"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"FAA", " ", "MAA", " ", "wAf", " ", "wAm"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"factorA", "->", 
      RowBox[{
       RowBox[{"FAa", " ", "\[Alpha]f", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAA", " ", "wAf", " ", "wAm"}], " ", "+", 
          RowBox[{"2", " ", "MAa", " ", "wAf", " ", "wam", "  ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}]}]}]}], "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"pXm", "/.", "solpoly1"}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"MAA", " ", "factorA"}], 
      RowBox[{
       RowBox[{"MAA", " ", "factorA"}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]m"}], ")"}], "MAa", " ", "factorB"}]}]], "/.",
      "trysub"}], ")"}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"pXf", "/.", "solpoly1"}], ")"}], "-", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{" ", 
       RowBox[{"waf", " ", "factorA"}]}], 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"waf", " ", "factorA"}], "+", " ", 
        RowBox[{"wAf", " ", "factorB"}]}], ")"}]], "/.", "trysub"}], ")"}]}], 
  "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"freqYm", "/.", "solpoly1"}], ")"}], "-", 
   RowBox[{
    FractionBox["1", "2"], 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"factorA", " ", "MAA"}], "+", 
        RowBox[{"2", " ", "factorB", " ", "MAa", " ", "\[Alpha]m"}]}], 
       RowBox[{" ", 
        RowBox[{
         RowBox[{"factorA", " ", "MAA"}], "+", " ", 
         RowBox[{"factorB", " ", "MAa"}]}]}]], "/.", "trysub"}], ")"}]}]}], "//",
   "Factor"}]}], "Input",
 CellChangeTimes->{{3.69676568412147*^9, 3.696765704373335*^9}, {
  3.696765747183895*^9, 3.696765780178947*^9}, {3.696765821554091*^9, 
  3.6967659141204977`*^9}, {3.696766311076291*^9, 3.696766317984091*^9}, {
  3.696766365949747*^9, 3.6967664472437983`*^9}, {3.696768275599373*^9, 
  3.696768430283022*^9}, {3.696768530482616*^9, 3.69676856733416*^9}, {
  3.696772120163361*^9, 3.69677213621565*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.696765761695388*^9, 3.696765780445632*^9}, {
   3.696765822073461*^9, 3.696765914427328*^9}, 3.696766318284788*^9, {
   3.6967663637623777`*^9, 3.69676638643849*^9}, {3.696766423099884*^9, 
   3.696766447640273*^9}, 3.696766924099113*^9, {3.696768281151429*^9, 
   3.696768430579479*^9}, {3.6967685308715267`*^9, 3.696768567656138*^9}, {
   3.696772131084483*^9, 3.696772136542211*^9}, 3.6967773639938517`*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.696765761695388*^9, 3.696765780445632*^9}, {
   3.696765822073461*^9, 3.696765914427328*^9}, 3.696766318284788*^9, {
   3.6967663637623777`*^9, 3.69676638643849*^9}, {3.696766423099884*^9, 
   3.696766447640273*^9}, 3.696766924099113*^9, {3.696768281151429*^9, 
   3.696768430579479*^9}, {3.6967685308715267`*^9, 3.696768567656138*^9}, {
   3.696772131084483*^9, 3.696772136542211*^9}, 3.696777363997486*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.696765761695388*^9, 3.696765780445632*^9}, {
   3.696765822073461*^9, 3.696765914427328*^9}, 3.696766318284788*^9, {
   3.6967663637623777`*^9, 3.69676638643849*^9}, {3.696766423099884*^9, 
   3.696766447640273*^9}, 3.696766924099113*^9, {3.696768281151429*^9, 
   3.696768430579479*^9}, {3.6967685308715267`*^9, 3.696768567656138*^9}, {
   3.696772131084483*^9, 3.696772136542211*^9}, 3.69677736400001*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Internal Stability", "Section",
 CellChangeTimes->{{3.696751768050068*^9, 3.696751770375415*^9}, {
  3.696777829588294*^9, 3.696777830388814*^9}}],

Cell[CellGroupData[{

Cell["Int Stab Matrix", "Subsubsection",
 CellChangeTimes->{{3.696761485896991*^9, 3.6967614889026423`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{"{", 
    RowBox[{
    "nextXAMf", ",", "nextXaMf", ",", "nextXAMm", ",", "nextXaMm", ",", 
     "nextYAMm", ",", "nextYaMm"}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"matIntFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"Transpose", "[", 
       RowBox[{"{", "\[IndentingNewLine]", 
        RowBox[{
         RowBox[{"D", "[", 
          RowBox[{"eqs", ",", "XAMf"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"D", "[", 
          RowBox[{"eqs", ",", "XaMf"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"D", "[", 
          RowBox[{"eqs", ",", "XAMm"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"D", "[", 
          RowBox[{"eqs", ",", "XaMm"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"D", "[", 
          RowBox[{"eqs", ",", "YAMm"}], "]"}], ",", "\[IndentingNewLine]", 
         RowBox[{"D", "[", 
          RowBox[{"eqs", ",", "YaMm"}], "]"}]}], "\[IndentingNewLine]", "}"}],
        "]"}], "/.", "SUBS"}], "/.", "subequil"}], "//", "Factor"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.694892752137855*^9, 3.69489297225054*^9}, 
   3.6948931884875803`*^9}],

Cell["From this we can derive the characteristic polynomial", "Text",
 CellChangeTimes->{{3.67672101846877*^9, 3.676721031016712*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyIntFull", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matIntFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "6", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675790963788534*^9, 3.6757909758461533`*^9}, {
  3.678763074902429*^9, 3.678763075065971*^9}, {3.6787641836824837`*^9, 
  3.678764184155055*^9}}],

Cell["\<\
Here, we only look at stability when the A allele is fixed on the Y (the two \
equilibria where the a allele is fixed on the Y are equivalent with a change \
of labels). \
\>", "Text",
 CellChangeTimes->{{3.6967779010695667`*^9, 3.696777941995714*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["solfixed1", "Subsubsection",
 CellChangeTimes->{{3.696772399743443*^9, 3.696772401407666*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"charpolyIntFull", "/.", "solfixed1"}], "/.", 
   RowBox[{"r", "\[Rule]", "0"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.696761529153597*^9, 3.6967615507773027`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     FractionBox[
      RowBox[{"Maa", " ", "wam"}], 
      RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]]}], "}"}], ",", 
   
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FAa", " ", "MAa", " ", "wAf", " ", "wam", " ", "\[Alpha]f"}],
         "-", 
        RowBox[{
        "FAa", " ", "MAa", " ", "wAf", " ", "wam", " ", "\[Alpha]f", " ", 
         "\[Alpha]m"}], "+", 
        SqrtBox[
         RowBox[{
         "FAa", " ", "MAa", " ", "wAf", " ", "wam", " ", "\[Alpha]f", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", "Faa", " ", "MAA", " ", "waf", " ", 
             "wAm"}], "-", 
            RowBox[{
            "FAa", " ", "MAa", " ", "wAf", " ", "wam", " ", "\[Alpha]f"}], 
            "+", 
            RowBox[{
            "FAa", " ", "MAa", " ", "wAf", " ", "wam", " ", "\[Alpha]f", " ", 
             "\[Alpha]m"}]}], ")"}]}]]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam"}], "-", 
        RowBox[{
        "2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
         "\[Alpha]m"}]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{
       "FAa", " ", "MAa", " ", "wAf", " ", "wam", " ", "\[Alpha]f", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "+", 
       SqrtBox[
        RowBox[{
        "FAa", " ", "MAa", " ", "wAf", " ", "wam", " ", "\[Alpha]f", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "2"}], " ", "Faa", " ", "MAA", " ", "waf", " ", 
            "wAm"}], "+", 
           RowBox[{
           "FAa", " ", "MAa", " ", "wAf", " ", "wam", " ", "\[Alpha]f", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]]}], 
      RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.696761536567327*^9, 3.696761551576604*^9}, {
   3.6967669089473743`*^9, 3.6967669324783487`*^9}, 3.696777388908884*^9}]
}, Open  ]],

Cell["Can think of the first eigenvalue as margaYm/margAYm", "Text",
 CellChangeTimes->{{3.696767268453466*^9, 3.696767288643589*^9}, {
  3.696772405608423*^9, 3.6967724068799963`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"margaYm", "=", 
   RowBox[{"wam", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "pXf", " ", "wAf", " ", "MAa", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pXf"}], ")"}], " ", "waf", " ", "Maa"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"margAYm", "=", 
   RowBox[{"wAm", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pXf", " ", "wAf", " ", "MAA"}], " ", "+", " ", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"1", "-", "pXf"}], ")"}], "waf", " ", "MAa", " ", 
       "\[Alpha]m"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   FractionBox["margaYm", "margAYm"], "/.", "solfixed1"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.696767294245434*^9, 3.696767409230732*^9}, {
  3.6967731275838547`*^9, 3.696773141126977*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"Maa", " ", "wam"}], 
  RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]]], "Output",
 CellChangeTimes->{
  3.696767342920508*^9, {3.6967673864424953`*^9, 3.696767409579814*^9}, 
   3.696772145197384*^9, {3.696773131141268*^9, 3.6967731417896*^9}, 
   3.6967773889659033`*^9}]
}, Open  ]],

Cell["\<\
The other eigenvalues come from the quadratic term in the chararacteristic \
polynomial. \
\>", "Text",
 CellChangeTimes->{{3.696772497510188*^9, 3.696772515508894*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Numerator", "[", 
      RowBox[{"Factor", "[", 
       RowBox[{
        RowBox[{"charpolyIntFull", "/.", "solfixed1"}], "/.", 
        RowBox[{"r", "\[Rule]", "0"}]}], "]"}], "]"}], "[", 
     RowBox[{"[", "4", "]"}], "]"}], ",", "\[Lambda]", ",", "Simplify"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"charpolyFixed1", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"%", "/", 
     RowBox[{"(", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"%", ",", 
        RowBox[{"\[Lambda]", "^", "2"}]}], "]"}], ")"}]}], ",", "\[Lambda]", 
    ",", "Simplify"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.696772425403919*^9, 3.696772495955443*^9}, {
  3.6967726221864243`*^9, 3.696772626824864*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   FractionBox[
    RowBox[{"FAa", " ", "MAA", " ", "wAf", " ", "wAm", " ", "\[Alpha]f"}], 
    RowBox[{
     RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam"}], "-", 
     RowBox[{
     "2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
      "\[Alpha]m"}]}]]}], "-", 
  FractionBox[
   RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f", " ", "\[Lambda]"}], 
   RowBox[{"Faa", " ", "waf"}]], "+", 
  SuperscriptBox["\[Lambda]", "2"]}]], "Output",
 CellChangeTimes->{{3.696772423873461*^9, 3.696772489549301*^9}, 
   3.696772627146813*^9}]
}, Open  ]],

Cell["\<\
Stability requires that the slope at \[Lambda]=1 is positive and that the \
intercept at \[Lambda]=1 is positive, otherwise one or both of these two \
eigenvalues will be greater than one:\
\>", "Text",
 CellChangeTimes->{{3.545504485855836*^9, 3.545504544142393*^9}, 
   3.555096125229538*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"slopeFixed1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"charpolyFixed1", ",", "\[Lambda]"}], "]"}], "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "1"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.545504547015267*^9, 3.54550457335086*^9}, 
   3.545504620479536*^9, {3.545504668413433*^9, 3.545504669988209*^9}, {
   3.545561424042444*^9, 3.545561425186051*^9}, 3.555096125229854*^9, {
   3.696769906528666*^9, 3.6967699143243837`*^9}, {3.696772560497032*^9, 
   3.696772564536975*^9}, {3.696772642170393*^9, 3.696772644974929*^9}}],

Cell[BoxData[
 RowBox[{"2", "-", 
  FractionBox[
   RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f"}], 
   RowBox[{"Faa", " ", "waf"}]]}]], "Output",
 CellChangeTimes->{
  3.555096305042485*^9, 3.55509633908276*^9, 3.5551031961848288`*^9, 
   3.555151059299786*^9, 3.555151234350992*^9, 3.555183132195793*^9, 
   3.5553365860130167`*^9, 3.555497994795848*^9, 3.5554999119461718`*^9, 
   3.556790618900114*^9, 3.556790740784568*^9, 3.578184572518409*^9, 
   3.588358551831656*^9, 3.588796192995798*^9, 3.5890497546305513`*^9, 
   3.5890499990855217`*^9, 3.589222317464388*^9, {3.595717338088036*^9, 
   3.5957173568584337`*^9}, 3.6405489414011803`*^9, 3.641223015203497*^9, {
   3.642530745984524*^9, 3.642530763504038*^9}, 3.668976899609435*^9, 
   3.6694003377187843`*^9, 3.6694743980003967`*^9, 3.669474854293838*^9, {
   3.669645105014584*^9, 3.6696451203415737`*^9}, 3.669665003519319*^9, 
   3.669724138625614*^9, 3.669728191756157*^9, 3.6697544535617847`*^9, 
   3.670073218421131*^9, 3.670369916387827*^9, 3.6732034163101892`*^9, 
   3.673286344143093*^9, 3.673542975943355*^9, 3.673709595514367*^9, 
   3.673880278368474*^9, 3.673919881696782*^9, 3.674071697980526*^9, 
   3.67422169108165*^9, 3.67424873890536*^9, 3.674779210339508*^9, {
   3.696769906832884*^9, 3.69676991476501*^9}, 3.696772589150433*^9, 
   3.696772645305626*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"interceptFixed1", "=", 
  RowBox[{
   RowBox[{"charpolyFixed1", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "1"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.5455046036232643`*^9, 3.545504617501589*^9}, {
   3.545504672413221*^9, 3.5455046735882263`*^9}, {3.545561421642241*^9, 
   3.5455614229143543`*^9}, 3.555096125233307*^9, {3.696769909263735*^9, 
   3.696769917953611*^9}, {3.6967725668007517`*^9, 3.696772568103941*^9}, {
   3.6967726486648903`*^9, 3.6967726533662043`*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f"}], 
   RowBox[{"Faa", " ", "waf"}]], "-", 
  FractionBox[
   RowBox[{"FAa", " ", "MAA", " ", "wAf", " ", "wAm", " ", "\[Alpha]f"}], 
   RowBox[{
    RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam"}], "-", 
    RowBox[{
    "2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
     "\[Alpha]m"}]}]]}]], "Output",
 CellChangeTimes->{
  3.5550963050765257`*^9, 3.555096339115573*^9, 3.555103196218032*^9, 
   3.555151059330452*^9, 3.555151234383954*^9, 3.555183132269191*^9, 
   3.555336586114266*^9, 3.555497994865361*^9, 3.555499911980421*^9, 
   3.556790618933721*^9, 3.556790740819503*^9, 3.578184574922998*^9, 
   3.588358551864442*^9, 3.588796193062533*^9, 3.5890497546810102`*^9, 
   3.5890499991174393`*^9, 3.589222317496071*^9, {3.595717338121992*^9, 
   3.5957173568890333`*^9}, 3.64054894397394*^9, 3.6412230153650703`*^9, {
   3.642530746031293*^9, 3.642530763547827*^9}, 3.668976899673716*^9, 
   3.6694003388718987`*^9, 3.669474398036862*^9, 3.669474854350943*^9, {
   3.669645105048645*^9, 3.669645120387609*^9}, 3.669665004321159*^9, 
   3.669724139508024*^9, 3.669728191792417*^9, 3.6697544536226463`*^9, 
   3.670073218465646*^9, 3.670369916426875*^9, 3.67320341647079*^9, 
   3.67328634420685*^9, 3.6735429759819107`*^9, 3.673709595558712*^9, 
   3.6738802784543333`*^9, 3.673919881729559*^9, 3.674071698019291*^9, 
   3.6742216911194973`*^9, 3.674248738951975*^9, 3.6747792103900433`*^9, {
   3.696769909550672*^9, 3.696769918273168*^9}, 3.69677258963039*^9, 
   3.696772653620967*^9}]
}, Open  ]],

Cell["\<\
We can use simpcond (the basic constraints on parameters) to find when the \
the slope and intercept are positive\
\>", "Text",
 CellChangeTimes->{{3.6967718130524406`*^9, 3.6967718469138517`*^9}, {
  3.696772590118512*^9, 3.696772590747039*^9}, {3.696772680051178*^9, 
  3.696772693242375*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"simpcond", "=", 
   RowBox[{"Reduce", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0", "<", "MAA"}], ",", 
      RowBox[{"0", "<", "MAa"}], ",", 
      RowBox[{"0", "<", "Maa"}], ",", 
      RowBox[{"0", "<", "FAA"}], ",", 
      RowBox[{"0", "<", "FAa"}], ",", 
      RowBox[{"0", "<", "Faa"}], ",", 
      RowBox[{"0", "<", "wAm"}], ",", 
      RowBox[{"0", "<", "wam"}], ",", 
      RowBox[{"0", "<", "wAf"}], ",", 
      RowBox[{"0", "<", "waf"}], ",", 
      RowBox[{"0", "<", "\[Alpha]m", "<", "1"}], ",", 
      RowBox[{"0", "<", "\[Alpha]f", "<", "1"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.696770405722204*^9, 3.696770419396018*^9}, {
  3.6967705205701857`*^9, 3.696770525602297*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reduce", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"slopeFixed1", ">", "0"}], ",", 
     RowBox[{"interceptFixed1", ">", "0"}], ",", "simpcond"}], "}"}], "]"}], "//",
   "Simplify"}]], "Input",
 CellChangeTimes->{{3.696772703253682*^9, 3.696772719941086*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FAA", ">", "0"}], "&&", 
  RowBox[{"Maa", ">", "0"}], "&&", 
  RowBox[{"wAf", ">", "0"}], "&&", 
  RowBox[{"\[Alpha]f", ">", "0"}], "&&", 
  RowBox[{"waf", ">", "0"}], "&&", 
  RowBox[{"Faa", ">", "0"}], "&&", 
  RowBox[{"FAa", ">", "0"}], "&&", 
  RowBox[{"\[Alpha]m", ">", "0"}], "&&", 
  RowBox[{"wAm", ">", "0"}], "&&", 
  RowBox[{"wam", ">", "0"}], "&&", 
  RowBox[{"MAA", ">", "0"}], "&&", 
  RowBox[{"\[Alpha]f", "<", "1"}], "&&", 
  RowBox[{
   RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f"}], "<", 
   RowBox[{"Faa", " ", "waf"}]}], "&&", 
  RowBox[{"\[Alpha]m", "<", "1"}], "&&", 
  RowBox[{
   RowBox[{
    RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MAA", " ", "wAm"}], "-", 
       RowBox[{"2", " ", "MAa", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], "<", 
   "0"}]}]], "Output",
 CellChangeTimes->{{3.6967727143848352`*^9, 3.696772720362214*^9}}]
}, Open  ]],

Cell["The last condition requires that factorA<0", "Text",
 CellChangeTimes->{{3.696772811784165*^9, 3.6967728220634604`*^9}, {
  3.6967731948721733`*^9, 3.6967731956390753`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"MAA", " ", "wAm"}], "-", 
       RowBox[{"2", " ", "MAa", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], "+", 
    RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "-", "factorA"}], "/.",
    "trysub"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6967727294149733`*^9, 3.696772742517446*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.696772735139722*^9, 3.696772742713881*^9}}]
}, Open  ]],

Cell["\<\
In addition we have the condition that FAa wAf \[Alpha]f<Faa waf. Overall the \
conditions for stability of this equilibrium are:\
\>", "Text",
 CellChangeTimes->{{3.6967729004780912`*^9, 3.696772912631343*^9}, {
  3.696777508796137*^9, 3.696777537322397*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stabCondFixed1", "=", 
  RowBox[{"Reduce", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"slopeFixed1", ">", "0"}], ",", 
     RowBox[{"interceptFixed1", ">", "0"}], ",", "simpcond", ",", 
     RowBox[{
      FractionBox[
       RowBox[{"Maa", " ", "wam"}], 
       RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]], "<", "1"}]}],
     "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.696774337834779*^9, 3.696774361770224*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FAA", ">", "0"}], "&&", 
  RowBox[{"wAf", ">", "0"}], "&&", 
  RowBox[{"0", "<", "\[Alpha]f", "<", "1"}], "&&", 
  RowBox[{"waf", ">", "0"}], "&&", 
  RowBox[{"Faa", ">", "0"}], "&&", 
  RowBox[{"0", "<", "FAa", "<", 
   FractionBox[
    RowBox[{"Faa", " ", "waf"}], 
    RowBox[{"wAf", " ", "\[Alpha]f"}]]}], "&&", 
  RowBox[{"0", "<", "\[Alpha]m", "<", "1"}], "&&", 
  RowBox[{"wAm", ">", "0"}], "&&", 
  RowBox[{"wam", ">", "0"}], "&&", 
  RowBox[{"MAA", ">", "0"}], "&&", 
  RowBox[{"MAa", ">", 
   FractionBox[
    RowBox[{"FAa", " ", "MAA", " ", "wAf", " ", "wAm", " ", "\[Alpha]f"}], 
    RowBox[{
     RowBox[{"2", " ", "Faa", " ", "waf", " ", "wam"}], "-", 
     RowBox[{"2", " ", "FAa", " ", "wAf", " ", "wam", " ", "\[Alpha]f"}], "-", 
     RowBox[{"2", " ", "Faa", " ", "waf", " ", "wam", " ", "\[Alpha]m"}], "+", 
     RowBox[{
     "2", " ", "FAa", " ", "wAf", " ", "wam", " ", "\[Alpha]f", " ", 
      "\[Alpha]m"}]}]]}], "&&", 
  RowBox[{"0", "<", "Maa", "<", 
   FractionBox[
    RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}], 
    "wam"]}]}]], "Output",
 CellChangeTimes->{3.696774362975659*^9, 3.6967775258459272`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["solpoly1", "Subsubsection",
 CellChangeTimes->{{3.696772390042576*^9, 3.696772392407639*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"charpolyIntFull", "/.", "solpoly1"}], "/.", 
   RowBox[{"r", "\[Rule]", "0"}]}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.696761572456973*^9, 3.6967615930212383`*^9}, {
  3.6967675588812428`*^9, 3.696767594344582*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    SuperscriptBox["\[Lambda]", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "FAa", " ", "Maa", " ", "MAa", " ", "waf", 
       " ", 
       SuperscriptBox["wam", "2"]}], "+", 
      RowBox[{"4", " ", "Faa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", 
       SuperscriptBox["wam", "2"]}], "-", 
      RowBox[{
      "FAa", " ", "Maa", " ", "MAA", " ", "waf", " ", "wam", " ", "wAm"}], 
      "+", 
      RowBox[{
      "FAA", " ", "Maa", " ", "MAA", " ", "wAf", " ", "wam", " ", "wAm"}], 
      "+", 
      RowBox[{"2", " ", "FAa", " ", "Maa", " ", "MAa", " ", "waf", " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f"}], "-", 
      RowBox[{"4", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", "wAf", " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f"}], "+", 
      RowBox[{
      "FAa", " ", "Maa", " ", "MAA", " ", "waf", " ", "wam", " ", "wAm", " ", 
       "\[Alpha]f"}], "-", 
      RowBox[{
      "2", " ", "FAa", " ", "MAa", " ", "MAA", " ", "wAf", " ", "wam", " ", 
       "wAm", " ", "\[Alpha]f"}], "+", 
      RowBox[{"2", " ", "FAa", " ", "Maa", " ", "MAa", " ", "waf", " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]m"}], "-", 
      RowBox[{"8", " ", "Faa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]m"}], "-", 
      RowBox[{"2", " ", "FAa", " ", "Maa", " ", "MAa", " ", "waf", " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f", " ", "\[Alpha]m"}], "+", 
      
      RowBox[{"8", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", "wAf", " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f", " ", "\[Alpha]m"}], "+", 
      
      RowBox[{
      "2", " ", "FAa", " ", "MAa", " ", "MAA", " ", "wAf", " ", "wam", " ", 
       "wAm", " ", "\[Alpha]f", " ", "\[Alpha]m"}], "+", 
      RowBox[{"4", " ", "Faa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", 
       SuperscriptBox["wam", "2"], " ", 
       SuperscriptBox["\[Alpha]m", "2"]}], "-", 
      RowBox[{"4", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", "wAf", " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f", " ", 
       SuperscriptBox["\[Alpha]m", "2"]}], "-", 
      RowBox[{
      "2", " ", "Faa", " ", "MAa", " ", "MAA", " ", "waf", " ", "wam", " ", 
       "wAm", " ", "\[Lambda]"}], "+", 
      RowBox[{
      "2", " ", "FAa", " ", "MAa", " ", "MAA", " ", "wAf", " ", "wam", " ", 
       "wAm", " ", "\[Alpha]f", " ", "\[Lambda]"}], "+", 
      RowBox[{"FAa", " ", 
       SuperscriptBox["MAA", "2"], " ", "wAf", " ", 
       SuperscriptBox["wAm", "2"], " ", "\[Alpha]f", " ", "\[Lambda]"}], "+", 
      
      RowBox[{"4", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", "wAm", " ", 
       "\[Alpha]m", " ", "\[Lambda]"}], "+", 
      RowBox[{
      "2", " ", "Faa", " ", "MAa", " ", "MAA", " ", "waf", " ", "wam", " ", 
       "wAm", " ", "\[Alpha]m", " ", "\[Lambda]"}], "+", 
      RowBox[{"2", " ", "FAa", " ", "MAa", " ", "MAA", " ", "waf", " ", 
       SuperscriptBox["wAm", "2"], " ", "\[Alpha]m", " ", "\[Lambda]"}], "-", 
      
      RowBox[{"2", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wAf", " ", 
       SuperscriptBox["wAm", "2"], " ", "\[Alpha]m", " ", "\[Lambda]"}], "-", 
      
      RowBox[{"4", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", "wAm", " ", 
       "\[Alpha]f", " ", "\[Alpha]m", " ", "\[Lambda]"}], "-", 
      RowBox[{
      "2", " ", "FAa", " ", "MAa", " ", "MAA", " ", "wAf", " ", "wam", " ", 
       "wAm", " ", "\[Alpha]f", " ", "\[Alpha]m", " ", "\[Lambda]"}], "-", 
      RowBox[{"2", " ", "FAa", " ", "MAa", " ", "MAA", " ", "waf", " ", 
       SuperscriptBox["wAm", "2"], " ", "\[Alpha]f", " ", "\[Alpha]m", " ", 
       "\[Lambda]"}], "-", 
      RowBox[{"4", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", "wAm", " ", 
       SuperscriptBox["\[Alpha]m", "2"], " ", "\[Lambda]"}], "+", 
      RowBox[{"4", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", "wAm", " ", 
       "\[Alpha]f", " ", 
       SuperscriptBox["\[Alpha]m", "2"], " ", "\[Lambda]"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Faa", " ", "FAa", " ", "MAa", " ", "MAA", " ", 
       SuperscriptBox["waf", "2"], " ", "wam", " ", "wAm"}], "-", 
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "waf", " ", 
       "wAf", " ", "wam", " ", "wAm"}], "-", 
      RowBox[{"2", " ", "Faa", " ", "FAa", " ", "MAa", " ", "MAA", " ", 
       SuperscriptBox["waf", "2"], " ", "wam", " ", "wAm", " ", "\[Alpha]f"}],
       "+", 
      RowBox[{"2", " ", "FAa", " ", "FAA", " ", "MAa", " ", "MAA", " ", 
       SuperscriptBox["wAf", "2"], " ", "wam", " ", "wAm", " ", "\[Alpha]f"}],
       "-", 
      RowBox[{"2", " ", "Faa", " ", "FAa", " ", "MAa", " ", "MAA", " ", 
       SuperscriptBox["waf", "2"], " ", "wam", " ", "wAm", " ", "\[Alpha]m"}],
       "+", 
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "waf", " ", 
       "wAf", " ", "wam", " ", "wAm", " ", "\[Alpha]m"}], "+", 
      RowBox[{"2", " ", "Faa", " ", "FAa", " ", "MAa", " ", "MAA", " ", 
       SuperscriptBox["waf", "2"], " ", "wam", " ", "wAm", " ", "\[Alpha]f", 
       " ", "\[Alpha]m"}], "-", 
      RowBox[{"2", " ", "FAa", " ", "FAA", " ", "MAa", " ", "MAA", " ", 
       SuperscriptBox["wAf", "2"], " ", "wam", " ", "wAm", " ", "\[Alpha]f", 
       " ", "\[Alpha]m"}], "+", 
      RowBox[{"4", " ", "Faa", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", 
       SuperscriptBox["waf", "2"], " ", 
       SuperscriptBox["wam", "2"], " ", "\[Lambda]"}], "-", 
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "waf", " ", 
       "wAf", " ", "wam", " ", "wAm", " ", "\[Lambda]"}], "-", 
      RowBox[{"4", " ", "Faa", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", 
       SuperscriptBox["waf", "2"], " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f", " ", "\[Lambda]"}], "+", 
      
      RowBox[{"FAa", " ", "FAA", " ", 
       SuperscriptBox["MAA", "2"], " ", 
       SuperscriptBox["wAf", "2"], " ", 
       SuperscriptBox["wAm", "2"], " ", "\[Alpha]f", " ", "\[Lambda]"}], "-", 
      
      RowBox[{"8", " ", "Faa", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", 
       SuperscriptBox["waf", "2"], " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]m", " ", "\[Lambda]"}], "+", 
      
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "waf", " ", 
       "wAf", " ", "wam", " ", "wAm", " ", "\[Alpha]m", " ", "\[Lambda]"}], 
      "+", 
      RowBox[{"8", " ", "Faa", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", 
       SuperscriptBox["waf", "2"], " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f", " ", "\[Alpha]m", " ", 
       "\[Lambda]"}], "+", 
      RowBox[{"4", " ", "Faa", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", 
       SuperscriptBox["waf", "2"], " ", 
       SuperscriptBox["wam", "2"], " ", 
       SuperscriptBox["\[Alpha]m", "2"], " ", "\[Lambda]"}], "-", 
      RowBox[{"4", " ", "Faa", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", 
       SuperscriptBox["waf", "2"], " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f", " ", 
       SuperscriptBox["\[Alpha]m", "2"], " ", "\[Lambda]"}], "+", 
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "waf", " ", 
       "wAf", " ", "wam", " ", "wAm", " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wAf", " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f", " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", "MAa", " ", "MAA", " ", "waf", " ", 
       "wAf", " ", "wam", " ", "wAm", " ", "\[Alpha]f", " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAA", "2"], " ", "waf", " ", "wAf", " ", 
       SuperscriptBox["wAm", "2"], " ", "\[Alpha]f", " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wAf", " ", 
       SuperscriptBox["wam", "2"], " ", 
       SuperscriptBox["\[Alpha]f", "2"], " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", "MAa", " ", "MAA", " ", "waf", " ", 
       "wAf", " ", "wam", " ", "wAm", " ", 
       SuperscriptBox["\[Alpha]f", "2"], " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAA", "2"], " ", "waf", " ", "wAf", " ", 
       SuperscriptBox["wAm", "2"], " ", 
       SuperscriptBox["\[Alpha]f", "2"], " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "-", 
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "waf", " ", 
       "wAf", " ", "wam", " ", "wAm", " ", "\[Alpha]m", " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wAf", " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f", " ", "\[Alpha]m", " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", "MAa", " ", "MAA", " ", "waf", " ", 
       "wAf", " ", "wam", " ", "wAm", " ", "\[Alpha]f", " ", "\[Alpha]m", " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wAf", " ", 
       SuperscriptBox["wam", "2"], " ", 
       SuperscriptBox["\[Alpha]f", "2"], " ", "\[Alpha]m", " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", "MAa", " ", "MAA", " ", "waf", " ", 
       "wAf", " ", "wam", " ", "wAm", " ", 
       SuperscriptBox["\[Alpha]f", "2"], " ", "\[Alpha]m", " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wAf", " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f", " ", 
       SuperscriptBox["\[Alpha]m", "2"], " ", 
       SuperscriptBox["\[Lambda]", "2"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wAf", " ", 
       SuperscriptBox["wam", "2"], " ", 
       SuperscriptBox["\[Alpha]f", "2"], " ", 
       SuperscriptBox["\[Alpha]m", "2"], " ", 
       SuperscriptBox["\[Lambda]", "2"]}]}], ")"}]}], ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"waf", " ", "wAf", " ", "wAm", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "Faa", " ", "MAa", " ", "MAA", " ", "waf", 
       " ", "wam"}], "+", 
      RowBox[{
      "2", " ", "FAa", " ", "MAa", " ", "MAA", " ", "wAf", " ", "wam", " ", 
       "\[Alpha]f"}], "+", 
      RowBox[{"FAa", " ", 
       SuperscriptBox["MAA", "2"], " ", "wAf", " ", "wAm", " ", "\[Alpha]f"}],
       "+", 
      RowBox[{"4", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", "\[Alpha]m"}],
       "+", 
      RowBox[{
      "2", " ", "Faa", " ", "MAa", " ", "MAA", " ", "waf", " ", "wam", " ", 
       "\[Alpha]m"}], "+", 
      RowBox[{
      "2", " ", "FAa", " ", "MAa", " ", "MAA", " ", "waf", " ", "wAm", " ", 
       "\[Alpha]m"}], "-", 
      RowBox[{
      "2", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wAf", " ", "wAm", " ", 
       "\[Alpha]m"}], "-", 
      RowBox[{"4", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", "\[Alpha]f", 
       " ", "\[Alpha]m"}], "-", 
      RowBox[{
      "2", " ", "FAa", " ", "MAa", " ", "MAA", " ", "wAf", " ", "wam", " ", 
       "\[Alpha]f", " ", "\[Alpha]m"}], "-", 
      RowBox[{
      "2", " ", "FAa", " ", "MAa", " ", "MAA", " ", "waf", " ", "wAm", " ", 
       "\[Alpha]f", " ", "\[Alpha]m"}], "-", 
      RowBox[{"4", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", 
       SuperscriptBox["\[Alpha]m", "2"]}], "+", 
      RowBox[{"4", " ", "FAa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", "\[Alpha]f", 
       " ", 
       SuperscriptBox["\[Alpha]m", "2"]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wam", " ", 
       "wAm"}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAa", "2"], " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f"}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", "MAa", " ", "MAA", " ", "wam", " ", 
       "wAm", " ", "\[Alpha]f"}], "-", 
      RowBox[{
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAA", "2"], " ", 
       SuperscriptBox["wAm", "2"], " ", "\[Alpha]f"}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAa", "2"], " ", 
       SuperscriptBox["wam", "2"], " ", 
       SuperscriptBox["\[Alpha]f", "2"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", "MAa", " ", "MAA", " ", "wam", " ", 
       "wAm", " ", 
       SuperscriptBox["\[Alpha]f", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAA", "2"], " ", 
       SuperscriptBox["wAm", "2"], " ", 
       SuperscriptBox["\[Alpha]f", "2"]}], "-", 
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wam", " ", 
       "wAm", " ", "\[Alpha]m"}], "+", 
      RowBox[{"8", " ", 
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAa", "2"], " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f", " ", "\[Alpha]m"}], "+", 
      
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", "MAa", " ", "MAA", " ", "wam", " ", 
       "wAm", " ", "\[Alpha]f", " ", "\[Alpha]m"}], "-", 
      RowBox[{"8", " ", 
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAa", "2"], " ", 
       SuperscriptBox["wam", "2"], " ", 
       SuperscriptBox["\[Alpha]f", "2"], " ", "\[Alpha]m"}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", "MAa", " ", "MAA", " ", "wam", " ", 
       "wAm", " ", 
       SuperscriptBox["\[Alpha]f", "2"], " ", "\[Alpha]m"}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAa", "2"], " ", 
       SuperscriptBox["wam", "2"], " ", "\[Alpha]f", " ", 
       SuperscriptBox["\[Alpha]m", "2"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["FAa", "2"], " ", 
       SuperscriptBox["MAa", "2"], " ", 
       SuperscriptBox["wam", "2"], " ", 
       SuperscriptBox["\[Alpha]f", "2"], " ", 
       SuperscriptBox["\[Alpha]m", "2"]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.6967615841640387`*^9, 3.696761596422634*^9}, {
   3.696767566763399*^9, 3.696767595219652*^9}, 3.696772146345154*^9, 
   3.696777549721257*^9}]
}, Open  ]],

Cell["\<\
One of the eigenvalues relates to the fixation of a on the Y:\
\>", "Text",
 CellChangeTimes->{{3.696767598524811*^9, 3.696767611709023*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Numerator", "[", 
     RowBox[{"Factor", "[", 
      RowBox[{
       RowBox[{"charpolyIntFull", "/.", "solpoly1"}], "/.", 
       RowBox[{"r", "\[Rule]", "0"}]}], "]"}], "]"}], "[", 
    RowBox[{"[", "2", "]"}], "]"}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Lambda]", "/.", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
     "Simplify"}], "//", "Flatten"}], ")"}]}]}], "Input",
 CellChangeTimes->{{3.696766980661766*^9, 3.696767016829116*^9}, {
   3.696767467683217*^9, 3.6967674906030903`*^9}, 3.696767553653261*^9, {
   3.696769159390011*^9, 3.696769176291683*^9}, {3.6967775732308397`*^9, 
   3.696777580221483*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"wam", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "FAA"}], " ", "Maa", " ", "MAA", " ", "wAf", " ", "wAm"}],
       "+", 
      RowBox[{"FAa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
         RowBox[{"2", " ", "MAa", " ", "wam", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Maa", " ", "waf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}]}], "+", 
         RowBox[{"2", " ", "MAa", " ", "wAf", " ", "\[Alpha]f", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"4", " ", "Faa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}], "2"]}]}], ")"}]}], 
   ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"wAm", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "2", " ", "Faa", " ", "MAa", " ", "MAA", " ", "waf", " ", "wam", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "-", 
      RowBox[{
      "2", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wAf", " ", "wAm", " ", 
       "\[Alpha]m"}], "+", 
      RowBox[{"FAa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
         RowBox[{"2", " ", "MAa", " ", "wam", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "MAA"}], " ", "wAf", " ", "\[Alpha]f"}], "+", 
         RowBox[{"2", " ", "MAa", " ", "waf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
          "\[Alpha]m"}]}], ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{
  3.696766984206148*^9, 3.696767017234832*^9, {3.6967674679834337`*^9, 
   3.696767490981944*^9}, 3.696767554023279*^9, {3.696769167633958*^9, 
   3.696769177263296*^9}, 3.6967721486595163`*^9, {3.696777551722722*^9, 
   3.6967775969058437`*^9}}]
}, Open  ]],

Cell["\<\
Again, the fixation of the a allele on the Y requires that the marginal \
fitness of the a on the Y is higher than the marginal fitness of A on the Y \
(given equilibrium frequencies of X). \
\>", "Text",
 CellChangeTimes->{{3.696767494819203*^9, 3.6967675431414433`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"margaYm", "=", 
   RowBox[{"wam", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", "pXf", " ", "wAf", " ", "MAa", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}], " ", "+", " ", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pXf"}], ")"}], " ", "waf", " ", "Maa"}]}], 
     ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"margAYm", "=", 
   RowBox[{"wAm", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pXf", " ", "wAf", " ", "MAA"}], " ", "+", " ", 
      RowBox[{"2", 
       RowBox[{"(", 
        RowBox[{"1", "-", "pXf"}], ")"}], "waf", " ", "MAa", " ", 
       "\[Alpha]m"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   FractionBox["margaYm", "margAYm"], "/.", "solpoly1"}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "-", "%%%%"}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.696767456094154*^9, 3.696767458146928*^9}, {
  3.696767699649435*^9, 3.6967677067520657`*^9}, {3.696769103375821*^9, 
  3.696769103556629*^9}, {3.696777590797106*^9, 3.6967775996518393`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"wam", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FAA", " ", "Maa", " ", "MAA", " ", "wAf", " ", "wAm"}], "-", 
      RowBox[{"FAa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
         RowBox[{"2", " ", "MAa", " ", "wam", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"Maa", " ", "waf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}]}], "+", 
         RowBox[{"2", " ", "MAa", " ", "wAf", " ", "\[Alpha]f", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], "+", 
      RowBox[{"4", " ", "Faa", " ", 
       SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}], "2"]}]}], ")"}]}], 
   ")"}], "/", 
  RowBox[{"(", 
   RowBox[{"wAm", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "Faa", " ", "MAa", " ", "MAA", " ", "waf", 
       " ", "wam", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "+", 
      RowBox[{
      "2", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wAf", " ", "wAm", " ", 
       "\[Alpha]m"}], "-", 
      RowBox[{"FAa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
         RowBox[{"2", " ", "MAa", " ", "wam", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "MAA"}], " ", "wAf", " ", "\[Alpha]f"}], "+", 
         RowBox[{"2", " ", "MAa", " ", "waf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
          "\[Alpha]m"}]}], ")"}]}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.696767458478908*^9, 3.696767479385158*^9}, 
   3.696767707224968*^9, 3.696769119065292*^9, 3.696772149220305*^9, 
   3.696777555007773*^9, 3.696777600050276*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.696767458478908*^9, 3.696767479385158*^9}, 
   3.696767707224968*^9, 3.696769119065292*^9, 3.696772149220305*^9, 
   3.696777555007773*^9, 3.69677760005192*^9}]
}, Open  ]],

Cell["Which can be re-written in terms of factorA and factorB:", "Text",
 CellChangeTimes->{{3.6967691061770773`*^9, 3.696769116488216*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     FractionBox[
      RowBox[{"wam", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"factorB", " ", "Maa"}], "+", 
         RowBox[{"2", " ", "factorA", " ", "MAa", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
      RowBox[{"wAm", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"factorA", " ", "MAA"}], "+", 
         RowBox[{"2", " ", "factorB", " ", "MAa", " ", "\[Alpha]m"}]}], 
        ")"}]}]], "-", 
     FractionBox["margaYm", "margAYm"]}], "/.", "solpoly1"}], "/.", 
   "trysub"}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.696769127855341*^9, 3.696769129653181*^9}, {
  3.696772153602271*^9, 3.696772162261814*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.696769117347967*^9, 3.696769129972022*^9}, {
   3.6967721505142813`*^9, 3.696772162561068*^9}, 3.696777557176464*^9}]
}, Open  ]],

Cell["\<\
As we shall see below, factorA and factorB must be positive, which allows us \
to say that stability requires the numerator to be less than the denominator: \

wam(factorB Maa+2 factorA MAa (1-\[Alpha]m))<wAm(factorA MAA+2 factorB MAa \
\[Alpha]m). \
\>", "Text",
 CellChangeTimes->{{3.696772182611907*^9, 3.696772248138384*^9}, {
  3.69677763107547*^9, 3.696777639497271*^9}}],

Cell["\<\
The other eigenvalues come from the quadratic term in the characteristic \
polynomial:\
\>", "Text",
 CellChangeTimes->{{3.6967725410851393`*^9, 3.696772553980865*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"Numerator", "[", 
      RowBox[{"Factor", "[", 
       RowBox[{
        RowBox[{"charpolyIntFull", "/.", "solpoly1"}], "/.", 
        RowBox[{"r", "\[Rule]", "0"}]}], "]"}], "]"}], "[", 
     RowBox[{"[", "3", "]"}], "]"}], ",", "\[Lambda]", ",", "Simplify"}], 
   "]"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"charpolyPoly1", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"%", "/", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"%", ",", 
       RowBox[{"\[Lambda]", "^", "2"}]}], "]"}]}], ",", "\[Lambda]", ",", 
    "Simplify"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.6967691857575617`*^9, 3.696769198410454*^9}, {
   3.69676928728345*^9, 3.6967692963851213`*^9}, {3.696769836317429*^9, 
   3.696769861653533*^9}, {3.6967698963601923`*^9, 3.696769901405363*^9}, 
   3.6967717972249727`*^9}],

Cell[BoxData[
 RowBox[{
  FractionBox[
   RowBox[{"2", " ", "MAa", " ", "MAA", " ", "wam", " ", "wAm", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Faa", " ", "waf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FAA", " ", "wAf"}], "+", 
         RowBox[{"FAa", " ", "waf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"FAa", " ", "FAA", " ", 
       SuperscriptBox["wAf", "2"], " ", "\[Alpha]f"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], 
   RowBox[{"waf", " ", "wAf", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["FAa", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", "\[Alpha]f", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAA", " ", "wAm"}], "-", 
          RowBox[{"2", " ", "MAa", " ", "wam", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], "2"]}],
       "-", 
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wam", " ", 
       "wAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FAa", " ", "FAA", " ", 
       SuperscriptBox["MAA", "2"], " ", 
       SuperscriptBox["wAf", "2"], " ", 
       SuperscriptBox["wAm", "2"], " ", "\[Alpha]f"}], "-", 
      RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "FAA"}], " ", "MAA", " ", "wAf", " ", "wAm"}], "+", 
         RowBox[{"2", " ", "FAa", " ", "MAa", " ", "waf", " ", "wam", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
    "\[Lambda]"}], 
   RowBox[{"waf", " ", "wAf", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["FAa", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", "\[Alpha]f", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAA", " ", "wAm"}], "-", 
          RowBox[{"2", " ", "MAa", " ", "wam", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], "2"]}],
       "-", 
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wam", " ", 
       "wAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]], "+", 
  SuperscriptBox["\[Lambda]", "2"]}]], "Output",
 CellChangeTimes->{{3.696769189140335*^9, 3.696769199449748*^9}, {
   3.696769842065898*^9, 3.696769862519417*^9}, 3.696769902176291*^9, 
   3.696771798098115*^9}]
}, Open  ]],

Cell["\<\
Stability requires that the slope at \[Lambda]=1 is positive and that the \
intercept at \[Lambda]=1 is positive, otherwise one or both of these two \
eigenvalues will be greater than one:\
\>", "Text",
 CellChangeTimes->{{3.545504485855836*^9, 3.545504544142393*^9}, 
   3.555096125229538*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"slopePoly1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"D", "[", 
     RowBox[{"charpolyPoly1", ",", "\[Lambda]"}], "]"}], "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "1"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.545504547015267*^9, 3.54550457335086*^9}, 
   3.545504620479536*^9, {3.545504668413433*^9, 3.545504669988209*^9}, {
   3.545561424042444*^9, 3.545561425186051*^9}, 3.555096125229854*^9, {
   3.696769906528666*^9, 3.6967699143243837`*^9}, {3.696772560497032*^9, 
   3.696772564536975*^9}}],

Cell[BoxData[
 RowBox[{"2", "+", 
  FractionBox[
   RowBox[{
    RowBox[{"FAa", " ", "FAA", " ", 
     SuperscriptBox["MAA", "2"], " ", 
     SuperscriptBox["wAf", "2"], " ", 
     SuperscriptBox["wAm", "2"], " ", "\[Alpha]f"}], "-", 
    RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "FAA"}], " ", "MAA", " ", "wAf", " ", "wAm"}], "+", 
       RowBox[{"2", " ", "FAa", " ", "MAa", " ", "waf", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], 
   RowBox[{"waf", " ", "wAf", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["FAa", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", "\[Alpha]f", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAA", " ", "wAm"}], "-", 
          RowBox[{"2", " ", "MAa", " ", "wam", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], "2"]}],
       "-", 
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wam", " ", 
       "wAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.555096305042485*^9, 3.55509633908276*^9, 3.5551031961848288`*^9, 
   3.555151059299786*^9, 3.555151234350992*^9, 3.555183132195793*^9, 
   3.5553365860130167`*^9, 3.555497994795848*^9, 3.5554999119461718`*^9, 
   3.556790618900114*^9, 3.556790740784568*^9, 3.578184572518409*^9, 
   3.588358551831656*^9, 3.588796192995798*^9, 3.5890497546305513`*^9, 
   3.5890499990855217`*^9, 3.589222317464388*^9, {3.595717338088036*^9, 
   3.5957173568584337`*^9}, 3.6405489414011803`*^9, 3.641223015203497*^9, {
   3.642530745984524*^9, 3.642530763504038*^9}, 3.668976899609435*^9, 
   3.6694003377187843`*^9, 3.6694743980003967`*^9, 3.669474854293838*^9, {
   3.669645105014584*^9, 3.6696451203415737`*^9}, 3.669665003519319*^9, 
   3.669724138625614*^9, 3.669728191756157*^9, 3.6697544535617847`*^9, 
   3.670073218421131*^9, 3.670369916387827*^9, 3.6732034163101892`*^9, 
   3.673286344143093*^9, 3.673542975943355*^9, 3.673709595514367*^9, 
   3.673880278368474*^9, 3.673919881696782*^9, 3.674071697980526*^9, 
   3.67422169108165*^9, 3.67424873890536*^9, 3.674779210339508*^9, {
   3.696769906832884*^9, 3.69676991476501*^9}, 3.696772589150433*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"interceptPoly1", "=", 
  RowBox[{
   RowBox[{"charpolyPoly1", "/.", 
    RowBox[{"\[Lambda]", "\[Rule]", "1"}]}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.5455046036232643`*^9, 3.545504617501589*^9}, {
   3.545504672413221*^9, 3.5455046735882263`*^9}, {3.545561421642241*^9, 
   3.5455614229143543`*^9}, 3.555096125233307*^9, {3.696769909263735*^9, 
   3.696769917953611*^9}, {3.6967725668007517`*^9, 3.696772568103941*^9}}],

Cell[BoxData[
 RowBox[{"1", "+", 
  FractionBox[
   RowBox[{
    RowBox[{"FAa", " ", "FAA", " ", 
     SuperscriptBox["MAA", "2"], " ", 
     SuperscriptBox["wAf", "2"], " ", 
     SuperscriptBox["wAm", "2"], " ", "\[Alpha]f"}], "-", 
    RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "FAA"}], " ", "MAA", " ", "wAf", " ", "wAm"}], "+", 
       RowBox[{"2", " ", "FAa", " ", "MAa", " ", "waf", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], 
   RowBox[{"waf", " ", "wAf", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["FAa", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", "\[Alpha]f", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAA", " ", "wAm"}], "-", 
          RowBox[{"2", " ", "MAa", " ", "wam", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], "2"]}],
       "-", 
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wam", " ", 
       "wAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]], "+", 
  FractionBox[
   RowBox[{"2", " ", "MAa", " ", "MAA", " ", "wam", " ", "wAm", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"Faa", " ", "waf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FAA", " ", "wAf"}], "+", 
         RowBox[{"FAa", " ", "waf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}]}]}], ")"}]}], "-", 
      RowBox[{"FAa", " ", "FAA", " ", 
       SuperscriptBox["wAf", "2"], " ", "\[Alpha]f"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], 
   RowBox[{"waf", " ", "wAf", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["FAa", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", "\[Alpha]f", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAA", " ", "wAm"}], "-", 
          RowBox[{"2", " ", "MAa", " ", "wam", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], "2"]}],
       "-", 
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wam", " ", 
       "wAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], 
     ")"}]}]]}]], "Output",
 CellChangeTimes->{
  3.5550963050765257`*^9, 3.555096339115573*^9, 3.555103196218032*^9, 
   3.555151059330452*^9, 3.555151234383954*^9, 3.555183132269191*^9, 
   3.555336586114266*^9, 3.555497994865361*^9, 3.555499911980421*^9, 
   3.556790618933721*^9, 3.556790740819503*^9, 3.578184574922998*^9, 
   3.588358551864442*^9, 3.588796193062533*^9, 3.5890497546810102`*^9, 
   3.5890499991174393`*^9, 3.589222317496071*^9, {3.595717338121992*^9, 
   3.5957173568890333`*^9}, 3.64054894397394*^9, 3.6412230153650703`*^9, {
   3.642530746031293*^9, 3.642530763547827*^9}, 3.668976899673716*^9, 
   3.6694003388718987`*^9, 3.669474398036862*^9, 3.669474854350943*^9, {
   3.669645105048645*^9, 3.669645120387609*^9}, 3.669665004321159*^9, 
   3.669724139508024*^9, 3.669728191792417*^9, 3.6697544536226463`*^9, 
   3.670073218465646*^9, 3.670369916426875*^9, 3.67320341647079*^9, 
   3.67328634420685*^9, 3.6735429759819107`*^9, 3.673709595558712*^9, 
   3.6738802784543333`*^9, 3.673919881729559*^9, 3.674071698019291*^9, 
   3.6742216911194973`*^9, 3.674248738951975*^9, 3.6747792103900433`*^9, {
   3.696769909550672*^9, 3.696769918273168*^9}, 3.69677258963039*^9}]
}, Open  ]],

Cell["\<\
We can use simpcond (the basic constraints on parameters) to find when the \
equilibrium is valid (between 0 and 1). \
\>", "Text",
 CellChangeTimes->{{3.6967718130524406`*^9, 3.6967718469138517`*^9}, {
  3.696772590118512*^9, 3.696772590747039*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"simpcond", "=", 
   RowBox[{"Reduce", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"0", "<", "MAA"}], ",", 
      RowBox[{"0", "<", "MAa"}], ",", 
      RowBox[{"0", "<", "Maa"}], ",", 
      RowBox[{"0", "<", "FAA"}], ",", 
      RowBox[{"0", "<", "FAa"}], ",", 
      RowBox[{"0", "<", "Faa"}], ",", 
      RowBox[{"0", "<", "wAm"}], ",", 
      RowBox[{"0", "<", "wam"}], ",", 
      RowBox[{"0", "<", "wAf"}], ",", 
      RowBox[{"0", "<", "waf"}], ",", 
      RowBox[{"0", "<", "\[Alpha]m", "<", "1"}], ",", 
      RowBox[{"0", "<", "\[Alpha]f", "<", "1"}]}], "}"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.696770405722204*^9, 3.696770419396018*^9}, {
  3.6967705205701857`*^9, 3.696770525602297*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"validCondPoly1", "=", 
  RowBox[{
   RowBox[{"Reduce", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pXm", "/.", "solpoly1"}], ")"}], ">", "0"}], ",", 
      RowBox[{
       RowBox[{"1", "-", 
        RowBox[{"(", 
         RowBox[{"pXm", "/.", "solpoly1"}], ")"}]}], ">", "0"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pXf", "/.", "solpoly1"}], ")"}], ">", "0"}], ",", 
      RowBox[{
       RowBox[{"1", "-", 
        RowBox[{"(", 
         RowBox[{"pXf", "/.", "solpoly1"}], ")"}]}], ">", "0"}], ",", 
      "simpcond"}], "}"}], "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.696770470772107*^9, 3.696770518946612*^9}, {
  3.6967719648775673`*^9, 3.696771965844455*^9}, {3.696772573234405*^9, 
  3.696772575417989*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Maa", ">", "0"}], "&&", 
  RowBox[{"wAm", ">", "0"}], "&&", 
  RowBox[{"wam", ">", "0"}], "&&", 
  RowBox[{"wAf", ">", "0"}], "&&", 
  RowBox[{"waf", ">", "0"}], "&&", 
  RowBox[{"MAa", ">", "0"}], "&&", 
  RowBox[{"0", "<", "\[Alpha]m", "<", "1"}], "&&", 
  RowBox[{"0", "<", "\[Alpha]f", "<", "1"}], "&&", 
  RowBox[{"MAA", ">", "0"}], "&&", 
  RowBox[{"FAa", ">", "0"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0", "<", "Faa", "<", 
       FractionBox[
        RowBox[{
         RowBox[{
         "2", " ", "FAa", " ", "MAa", " ", "wAf", " ", "wam", " ", 
          "\[Alpha]f"}], "+", 
         RowBox[{
         "FAa", " ", "MAA", " ", "wAf", " ", "wAm", " ", "\[Alpha]f"}], "-", 
         RowBox[{
         "2", " ", "FAa", " ", "MAa", " ", "wAf", " ", "wam", " ", 
          "\[Alpha]f", " ", "\[Alpha]m"}]}], 
        RowBox[{
         RowBox[{"2", " ", "MAa", " ", "waf", " ", "wam"}], "-", 
         RowBox[{
         "2", " ", "MAa", " ", "waf", " ", "wam", " ", "\[Alpha]m"}]}]]}], "&&", 
      RowBox[{"0", "<", "FAA", "<", 
       FractionBox[
        RowBox[{"FAa", " ", "waf", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
           RowBox[{"2", " ", "MAa", " ", "wam", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
        RowBox[{"MAA", " ", "wAf", " ", "wAm"}]]}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"MAa", " ", "waf", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FAa", " ", "wAf", " ", "\[Alpha]f", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MAA", " ", "wAm"}], "-", 
             RowBox[{"2", " ", "MAa", " ", "wam", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], ">", "0"}], "&&", 
      RowBox[{
       RowBox[{"MAA", " ", "wAf", " ", "wAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FAA", " ", "MAA", " ", "wAf", " ", "wAm"}], "+", 
          RowBox[{"FAa", " ", "waf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MAA", " ", "wAm"}], "-", 
             RowBox[{"2", " ", "MAa", " ", "wam", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]}], 
         ")"}]}], ">", "0"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{3.696770527119169*^9, 3.696771968379917*^9, 
  3.696772592438479*^9}]
}, Open  ]],

Cell["\<\
There are therefore two conditions under which this equilibrium exists, which \
are somewhat similar to overdominance and underdominance. \
\>", "Text",
 CellChangeTimes->{{3.696771852274707*^9, 3.696771879416992*^9}}],

Cell["\<\
However, there is only one way for this equilibrum to be valid and stable:\
\>", "Text",
 CellChangeTimes->{{3.696771888642918*^9, 3.696771918048517*^9}, {
  3.696772038166546*^9, 3.696772046542595*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reduce", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"slopePoly1", ">", "0"}], ",", 
     RowBox[{"interceptPoly1", ">", "0"}], ",", "validCondPoly1"}], "}"}], 
   "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6967711403090897`*^9, 3.6967711413880043`*^9}, {
  3.696772579848578*^9, 3.696772586247992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"wAm", ">", "0"}], "&&", 
  RowBox[{"0", "<", "\[Alpha]m", "<", "1"}], "&&", 
  RowBox[{"wam", ">", "0"}], "&&", 
  RowBox[{"MAA", ">", "0"}], "&&", 
  RowBox[{"MAa", ">", "0"}], "&&", 
  RowBox[{"0", "<", "\[Alpha]f", "<", "1"}], "&&", 
  RowBox[{"wAf", ">", "0"}], "&&", 
  RowBox[{"waf", ">", "0"}], "&&", 
  RowBox[{"Faa", ">", "0"}], "&&", 
  RowBox[{"FAa", ">", 
   FractionBox[
    RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], 
    RowBox[{"wAf", " ", "\[Alpha]f", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
       RowBox[{"2", " ", "MAa", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]]}], "&&", 
  RowBox[{"0", "<", "FAA", "<", 
   FractionBox[
    RowBox[{"FAa", " ", "waf", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
       RowBox[{"2", " ", "MAa", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
    RowBox[{"MAA", " ", "wAf", " ", "wAm"}]]}], "&&", 
  RowBox[{"Maa", ">", "0"}]}]], "Output",
 CellChangeTimes->{3.696770561810995*^9, 3.696770762856818*^9, 
  3.696771142564074*^9, 3.696772594715908*^9}]
}, Open  ]],

Cell["These conditions reduce to factorA>0 and factorB>0", "Text",
 CellChangeTimes->{{3.696771923137437*^9, 3.6967719269281178`*^9}, {
  3.696772062510599*^9, 3.6967720680775957`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Reduce", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"factorA", "/.", "trysub"}], ")"}], ">", "0"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"factorB", "/.", "trysub"}], ")"}], ">", "0"}], ",", 
     "simpcond"}], "}"}], "]"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.696771938145152*^9, 3.696772008770568*^9}, {
  3.696772074490446*^9, 3.6967720824587603`*^9}, {3.696773613924155*^9, 
  3.696773614340075*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Maa", ">", "0"}], "&&", 
  RowBox[{"0", "<", "\[Alpha]m", "<", "1"}], "&&", 
  RowBox[{"0", "<", "\[Alpha]f", "<", "1"}], "&&", 
  RowBox[{"wAm", ">", "0"}], "&&", 
  RowBox[{"wam", ">", "0"}], "&&", 
  RowBox[{"MAA", ">", "0"}], "&&", 
  RowBox[{"MAa", ">", "0"}], "&&", 
  RowBox[{"wAf", ">", "0"}], "&&", 
  RowBox[{"waf", ">", "0"}], "&&", 
  RowBox[{"Faa", ">", "0"}], "&&", 
  RowBox[{"FAa", ">", 
   FractionBox[
    RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], 
    RowBox[{"wAf", " ", "\[Alpha]f", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
       RowBox[{"2", " ", "MAa", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]]}], "&&", 
  RowBox[{"0", "<", "FAA", "<", 
   FractionBox[
    RowBox[{"FAa", " ", "waf", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
       RowBox[{"2", " ", "MAa", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
    RowBox[{"MAA", " ", "wAf", " ", "wAm"}]]}]}]], "Output",
 CellChangeTimes->{{3.696771953590089*^9, 3.6967719619800787`*^9}, {
   3.696772003371681*^9, 3.696772009107617*^9}, {3.696772077111389*^9, 
   3.696772082905573*^9}, 3.696773614770401*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stabCondPoly1", "=", 
  RowBox[{
   RowBox[{"Reduce", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"factorA", "/.", "trysub"}], ")"}], ">", "0"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"factorB", "/.", "trysub"}], ")"}], ">", "0"}], ",", 
      "simpcond"}], "}"}], "]"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.696773489418521*^9, 3.696773500234314*^9}, {
   3.69677359268655*^9, 3.696773607070099*^9}, 3.696773704774768*^9, {
   3.696774076917728*^9, 3.696774078675186*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"Maa", ">", "0"}], "&&", 
  RowBox[{"0", "<", "\[Alpha]m", "<", "1"}], "&&", 
  RowBox[{"0", "<", "\[Alpha]f", "<", "1"}], "&&", 
  RowBox[{"wAm", ">", "0"}], "&&", 
  RowBox[{"wam", ">", "0"}], "&&", 
  RowBox[{"MAA", ">", "0"}], "&&", 
  RowBox[{"MAa", ">", "0"}], "&&", 
  RowBox[{"wAf", ">", "0"}], "&&", 
  RowBox[{"waf", ">", "0"}], "&&", 
  RowBox[{"Faa", ">", "0"}], "&&", 
  RowBox[{"FAa", ">", 
   FractionBox[
    RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], 
    RowBox[{"wAf", " ", "\[Alpha]f", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
       RowBox[{"2", " ", "MAa", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]]}], "&&", 
  RowBox[{"0", "<", "FAA", "<", 
   FractionBox[
    RowBox[{"FAa", " ", "waf", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
       RowBox[{"2", " ", "MAa", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
    RowBox[{"MAA", " ", "wAf", " ", "wAm"}]]}]}]], "Output",
 CellChangeTimes->{{3.696773599071334*^9, 3.69677361701908*^9}, 
   3.6967737058139277`*^9, 3.696774078973975*^9}]
}, Open  ]],

Cell[TextData[{
 "Thus, we have factorA>0, factorB>0 and ",
 Cell[BoxData[
  RowBox[{
   FractionBox[
    RowBox[{"wam", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"factorB", " ", "Maa"}], "+", 
       RowBox[{"2", " ", "factorA", " ", "MAa", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
    RowBox[{"wAm", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"factorA", " ", "MAA"}], "+", 
       RowBox[{"2", " ", "factorB", " ", "MAa", " ", "\[Alpha]m"}]}], 
      ")"}]}]], "<", "1"}]],
  CellChangeTimes->{{3.696774106314692*^9, 3.6967741278772583`*^9}, {
   3.696774539437426*^9, 3.696774550509009*^9}, {3.696775093933791*^9, 
   3.696775094105528*^9}}],
 ". "
}], "Text",
 CellChangeTimes->{{3.696777746006667*^9, 3.696777764861598*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"stabCondPoly1", "=", 
  RowBox[{
   RowBox[{"Reduce", "[", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"factorA", "/.", "trysub"}], ")"}], ">", "0"}], ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"factorB", "/.", "trysub"}], ")"}], ">", "0"}], ",", 
      "simpcond", ",", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         FractionBox[
          RowBox[{"wam", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"factorB", " ", "Maa"}], "+", 
             RowBox[{"2", " ", "factorA", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{"1", "-", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
          RowBox[{"wAm", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"factorA", " ", "MAA"}], "+", 
             RowBox[{"2", " ", "factorB", " ", "MAa", " ", "\[Alpha]m"}]}], 
            ")"}]}]], "/.", "trysub"}], ")"}], "<", "1"}]}], "}"}], "]"}], "//",
    "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.696774106314692*^9, 3.6967741278772583`*^9}, {
  3.696774539437426*^9, 3.696774550509009*^9}, {3.696775093933791*^9, 
  3.696775094105528*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"wAm", ">", "0"}], "&&", 
  RowBox[{"0", "<", "\[Alpha]m", "<", "1"}], "&&", 
  RowBox[{"wam", ">", "0"}], "&&", 
  RowBox[{"MAA", ">", "0"}], "&&", 
  RowBox[{"Faa", ">", "0"}], "&&", 
  RowBox[{"wAf", ">", "0"}], "&&", 
  RowBox[{"0", "<", "FAA"}], "&&", 
  RowBox[{"0", "<", "Maa"}], "&&", 
  RowBox[{"0", "<", "\[Alpha]f"}], "&&", 
  RowBox[{"Maa", "<", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MAA", " ", "wAm"}], "+", 
         RowBox[{"2", " ", "MAa", " ", "wam", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "-", 
      RowBox[{"2", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wAf", " ", 
       SuperscriptBox["wAm", "2"], " ", "\[Alpha]m"}], "-", 
      RowBox[{"FAa", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
         RowBox[{"2", " ", "MAa", " ", "wam", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MAA", " ", "wAf", " ", "wAm", " ", "\[Alpha]f"}], "+", 
         RowBox[{"2", " ", "MAa", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"wAf", " ", "wam", " ", "\[Alpha]f", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "-", 
            RowBox[{"waf", " ", "wAm", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
             "\[Alpha]m"}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"wam", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "FAA"}], " ", "MAA", " ", "wAf", " ", "wAm"}], "+", 
        RowBox[{"FAa", " ", "waf", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
           RowBox[{"2", " ", "MAa", " ", "wam", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]}], 
       ")"}]}], ")"}]}]}], "&&", 
  RowBox[{"\[Alpha]f", "<", "1"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"FAa", ">", 
       FractionBox[
        RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], 
        RowBox[{"wAf", " ", "\[Alpha]f", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
           RowBox[{"2", " ", "MAa", " ", "wam", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]]}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAa", ">", 
           FractionBox[
            RowBox[{"MAA", " ", "wAm"}], 
            RowBox[{
             RowBox[{"2", " ", "wam"}], "-", 
             RowBox[{"2", " ", "wam", " ", "\[Alpha]m"}]}]]}], "&&", 
          RowBox[{"waf", "\[GreaterEqual]", 
           FractionBox[
            RowBox[{"wAf", " ", "\[Alpha]f", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"MAA", " ", "wAm"}], "+", 
               RowBox[{"2", " ", "MAa", " ", "wam", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
            
            RowBox[{"2", " ", "MAa", " ", "wAm", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
             "\[Alpha]m"}]]}], "&&", 
          RowBox[{
           RowBox[{"MAa", " ", "MAA", " ", "wAf", " ", 
            SuperscriptBox["wAm", "2"], " ", "\[Alpha]m", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", "Faa", " ", "MAa", " ", "waf", " ", 
               "wam", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"MAA", " ", "wAm"}], "+", 
                 RowBox[{"2", " ", "MAa", " ", "wam", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "+", 
              RowBox[{
              "2", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wAf", " ", 
               SuperscriptBox["wAm", "2"], " ", "\[Alpha]m"}], "+", 
              RowBox[{"FAa", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
                 RowBox[{"2", " ", "MAa", " ", "wam", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], 
               " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"MAA", " ", "wAf", " ", "wAm", " ", "\[Alpha]f"}], 
                 "+", 
                 RowBox[{"2", " ", "MAa", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"wAf", " ", "wam", " ", "\[Alpha]f", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "-", 
                    RowBox[{"waf", " ", "wAm", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
                    "\[Alpha]m"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "<", 
           "0"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"waf", ">", "0"}], "&&", 
          RowBox[{"0", "<", "MAa"}], "&&", 
          RowBox[{
           RowBox[{"MAA", " ", "wAf", " ", "wAm", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"FAA", " ", "MAA", " ", "wAf", " ", "wAm"}], "+", 
              RowBox[{"FAa", " ", "waf", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"MAA", " ", "wAm"}], "-", 
                 RowBox[{"2", " ", "MAa", " ", "wam", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], 
                ")"}]}]}], ")"}]}], "<", "0"}], "&&", 
          RowBox[{"MAa", "\[LessEqual]", 
           FractionBox[
            RowBox[{"MAA", " ", "wAm"}], 
            RowBox[{
             RowBox[{"2", " ", "wam"}], "-", 
             RowBox[{"2", " ", "wam", " ", "\[Alpha]m"}]}]]}]}], ")"}]}], 
       ")"}]}], ")"}], "||", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"MAa", ">", 
       FractionBox[
        RowBox[{"MAA", " ", "wAm"}], 
        RowBox[{
         RowBox[{"2", " ", "wam"}], "-", 
         RowBox[{"2", " ", "wam", " ", "\[Alpha]m"}]}]]}], "&&", 
      RowBox[{"0", "<", "waf"}], "&&", 
      RowBox[{"FAa", "<", 
       FractionBox[
        RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MAA", " ", "wAm"}], "+", 
           RowBox[{"2", " ", "MAa", " ", "wam", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
           RowBox[{"2", " ", "MAa", " ", "wam", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MAA", " ", "wAf", " ", "wAm", " ", "\[Alpha]f"}], "+", 
           RowBox[{"2", " ", "MAa", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"wAf", " ", "wam", " ", "\[Alpha]f", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "-", 
              RowBox[{"waf", " ", "wAm", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
               "\[Alpha]m"}]}], ")"}]}]}], ")"}]}]]}], "&&", 
      RowBox[{
       RowBox[{"MAa", " ", "MAA", " ", "wAf", " ", 
        SuperscriptBox["wAm", "2"], " ", "\[Alpha]m", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "Faa", " ", "MAa", " ", "waf", " ", "wam",
            " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MAA", " ", "wAm"}], "+", 
             RowBox[{"2", " ", "MAa", " ", "wam", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "+", 
          RowBox[{"2", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wAf", " ", 
           SuperscriptBox["wAm", "2"], " ", "\[Alpha]m"}], "+", 
          RowBox[{"FAa", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
             RowBox[{"2", " ", "MAa", " ", "wam", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MAA", " ", "wAf", " ", "wAm", " ", "\[Alpha]f"}], "+", 
             RowBox[{"2", " ", "MAa", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"wAf", " ", "wam", " ", "\[Alpha]f", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "-", 
                RowBox[{"waf", " ", "wAm", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
                 "\[Alpha]m"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], "<", "0"}], "&&", 
      RowBox[{"waf", "<", 
       FractionBox[
        RowBox[{"wAf", " ", "\[Alpha]f", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"MAA", " ", "wAm"}], "+", 
           RowBox[{"2", " ", "MAa", " ", "wam", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
        RowBox[{"2", " ", "MAa", " ", "wAm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
         "\[Alpha]m"}]]}], "&&", 
      RowBox[{
       FractionBox[
        RowBox[{"2", " ", "Faa", " ", "MAa", " ", "waf", " ", "wam", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], 
        RowBox[{"wAf", " ", "\[Alpha]f", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
           RowBox[{"2", " ", "MAa", " ", "wam", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]], 
       "<", "FAa"}]}], ")"}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.696774114586972*^9, 3.696774128770426*^9}, {
   3.696774543449305*^9, 3.696774550848011*^9}, 3.696775094883045*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["External Stability (R=0)", "Section",
 CellChangeTimes->{{3.6967778226870317`*^9, 3.696777826771945*^9}, {
  3.696779295216138*^9, 3.696779296704048*^9}}],

Cell[CellGroupData[{

Cell["General", "Subsection",
 CellChangeTimes->{{3.696779260515575*^9, 3.696779261249301*^9}}],

Cell["\<\
I take the eigenvalues when R=0 for neo-W and neo-Y from turnoverSOM.nb:\
\>", "Text",
 CellChangeTimes->{{3.696778071311314*^9, 3.696778099696006*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eigensR0neoY", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox[
       RowBox[{"wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", "waf"}], "+", 
          RowBox[{"2", " ", "MAa", " ", "pXf", " ", "wAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "meanM"}]]}], ",", 
     FractionBox[
      RowBox[{"wAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"MAA", " ", "pXf", " ", "wAf"}], "-", 
         RowBox[{"2", " ", "MAa", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", "waf", " ", 
          "\[Alpha]m"}]}], ")"}]}], 
      RowBox[{"2", " ", "meanM"}]]}], "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"eigensR0neoW", "=", 
   RowBox[{"{", 
    RowBox[{
     FractionBox[
      RowBox[{"wAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"FAA", " ", "pAveM", " ", "wAm"}], "-", 
         RowBox[{"2", " ", "FAa", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", "wam", " ", 
          "\[Alpha]f"}]}], ")"}]}], 
      RowBox[{"2", " ", "meanF"}]], ",", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{"waf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Faa", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", "wam"}], "+", 
          RowBox[{"2", " ", "FAa", " ", "pAveM", " ", "wAm", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}]}]}], ")"}]}], 
       RowBox[{"2", " ", "meanF"}]]}]}], "}"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.696778166726762*^9, 3.696778188525784*^9}}],

Cell["\<\
Where meanM/meanF is male/female mean fitness (actually this is the mean \
fitnesses multiplied by the mean Haploid fitness of males and of females, as \
defined in the text). \
\>", "Text",
 CellChangeTimes->{{3.6967782899254627`*^9, 3.696778383458973*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"femaleMeanFit", "=", 
   RowBox[{
    RowBox[{"Faa", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "freqYm"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pXf"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pXm"}], ")"}], " ", "waf", " ", "wam"}], "+", 
    RowBox[{"FAa", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "freqYm"}], ")"}], " ", "pXf", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pXm"}], ")"}], " ", "wAf", " ", "wam"}], "+", 
    RowBox[{"FAa", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "freqYm"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pXf"}], ")"}], " ", "pXm", " ", "waf", " ", "wAm"}], 
    "+", 
    RowBox[{"FAA", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "freqYm"}], ")"}], " ", "pXf", " ", "pXm", " ", "wAf",
      " ", "wAm"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681898268466964*^9, 3.6818983708017797`*^9}, {
   3.6818984949585733`*^9, 3.681898533386279*^9}, {3.68190108087703*^9, 
   3.681901084934218*^9}, {3.681901144685513*^9, 3.681901154780171*^9}, {
   3.681901385648533*^9, 3.681901386601219*^9}, {3.6819016152621*^9, 
   3.681901637595449*^9}, 3.681901842920384*^9, 3.6819027638144817`*^9, {
   3.681903858647367*^9, 3.681903859300173*^9}, {3.6863818000961943`*^9, 
   3.686381824765128*^9}, {3.694954654448914*^9, 3.694954657568048*^9}, 
   3.694976450534129*^9, {3.6949766751303*^9, 3.694976693033786*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"maleMeanFit", "=", 
   RowBox[{
    RowBox[{"freqYm", " ", "Maa", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pXf"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pYm"}], ")"}], " ", "waf", " ", "wam"}], "+", 
    RowBox[{"freqYm", " ", "MAa", " ", "pXf", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pYm"}], ")"}], " ", "wAf", " ", "wam"}], "+", 
    RowBox[{"freqYm", " ", "MAa", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pXf"}], ")"}], " ", "pYm", " ", "waf", " ", "wAm"}], 
    "+", 
    RowBox[{
    "freqYm", " ", "MAA", " ", "pXf", " ", "pYm", " ", "wAf", " ", 
     "wAm"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681901249067821*^9, 3.6819012978398542`*^9}, {
   3.681901363538598*^9, 3.681901384083459*^9}, {3.681901546264427*^9, 
   3.681901547139256*^9}, {3.6819016461771812`*^9, 3.6819016541406918`*^9}, {
   3.681901830998515*^9, 3.681901845963574*^9}, {3.6819027552099323`*^9, 
   3.681902760712364*^9}, {3.682072412323092*^9, 3.68207244637437*^9}, {
   3.682072508629033*^9, 3.682072509244377*^9}, {3.685529897041615*^9, 
   3.685529925782366*^9}, {3.685881904356382*^9, 3.6858819411706448`*^9}, {
   3.6863818330941753`*^9, 3.6863818517180767`*^9}, {3.686382196801606*^9, 
   3.6863821989178057`*^9}, 3.694954660172323*^9, 3.694976450536187*^9, {
   3.6949766817629433`*^9, 3.694976690945627*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["neo-Y", "Subsection",
 CellChangeTimes->{{3.696778199669536*^9, 3.6967782005094357`*^9}}],

Cell[CellGroupData[{

Cell["solfixed1", "Subsubsection",
 CellChangeTimes->{{3.696778203806044*^9, 3.6967782149804907`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eigensR0neoY", "/.", 
    RowBox[{"meanM", "->", "maleMeanFit"}]}], "/.", "solfixed1"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.696778237828692*^9, 3.6967782558470707`*^9}, {
  3.696778394253737*^9, 3.696778399964737*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"Maa", " ", "wam"}], 
    RowBox[{"2", " ", "MAa", " ", "wAm", " ", "\[Alpha]m"}]], ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.696778256284368*^9, 3.696778400248603*^9}]
}, Open  ]],

Cell["\<\
The first eigenvalue is always <1 given the stability conditions (this is the \
stability condition that requires A to have higher marginal fitness on the \
Y). \
\>", "Text",
 CellChangeTimes->{{3.6967784081295137`*^9, 3.696778460467245*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["solpoly1", "Subsubsection",
 CellChangeTimes->{{3.696778217484324*^9, 3.696778219124878*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eigensR0neoY", "/.", 
    RowBox[{"meanM", "->", "maleMeanFit"}]}], "/.", "solpoly1"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.696778467341234*^9, 3.6967784687315083`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"wam", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"FAA", " ", "Maa", " ", "MAA", " ", "wAf", " ", "wAm"}], "-", 
        
        RowBox[{"FAa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
           RowBox[{"2", " ", "MAa", " ", "wam", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "waf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}]}], "+", 
           RowBox[{"2", " ", "MAa", " ", "wAf", " ", "\[Alpha]f", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{"4", " ", "Faa", " ", 
         SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}], "2"]}]}], ")"}]}], 
     ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"wAm", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", "Faa", " ", "MAa", " ", "MAA", " ", "waf", 
         " ", "wam", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "+", 
        RowBox[{
        "2", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wAf", " ", "wAm", " ", 
         "\[Alpha]m"}], "-", 
        RowBox[{"FAa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
           RowBox[{"2", " ", "MAa", " ", "wam", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "MAA"}], " ", "wAf", " ", "\[Alpha]f"}], "+", 
           RowBox[{"2", " ", "MAa", " ", "waf", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
            "\[Alpha]m"}]}], ")"}]}]}], ")"}]}], ")"}]}], ",", "1"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.696778469065275*^9}]
}, Open  ]],

Cell["Again, the first eigenvalue is always <1", "Text",
 CellChangeTimes->{{3.696778511505158*^9, 3.6967785222477703`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"FAA", " ", "Maa", " ", "MAA", " ", "wAf", " ", "wAm"}], 
          "-", 
          RowBox[{"FAa", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
             RowBox[{"2", " ", "MAa", " ", "wam", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"Maa", " ", "waf", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}]}], "+", 
             RowBox[{"2", " ", "MAa", " ", "wAf", " ", "\[Alpha]f", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
          "+", 
          RowBox[{"4", " ", "Faa", " ", 
           SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}], "2"]}]}], 
         ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"wAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "Faa", " ", "MAa", " ", "MAA", " ", "waf",
            " ", "wam", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "+", 
          RowBox[{
          "2", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wAf", " ", "wAm", 
           " ", "\[Alpha]m"}], "-", 
          RowBox[{"FAa", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
             RowBox[{"2", " ", "MAa", " ", "wam", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "MAA"}], " ", "wAf", " ", "\[Alpha]f"}], "+", 
             RowBox[{"2", " ", "MAa", " ", "waf", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
              "\[Alpha]m"}]}], ")"}]}]}], ")"}]}], ")"}]}], ">", "1"}], ",", 
    "stabCondPoly1"}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.696778477983734*^9, 3.696778495350684*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.696778500074121*^9}]
}, Open  ]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["neo-W", "Subsection",
 CellChangeTimes->{{3.696778221765439*^9, 3.69677822265329*^9}}],

Cell[CellGroupData[{

Cell["solfixed1", "Subsubsection",
 CellChangeTimes->{{3.696778224837051*^9, 3.696778226580247*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eigensR0neoWfixed1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"eigensR0neoW", "/.", 
      RowBox[{"meanF", "\[Rule]", "femaleMeanFit"}]}], "/.", 
     RowBox[{"pAveM", "\[Rule]", 
      RowBox[{
       RowBox[{"freqYm", " ", "pYm"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "freqYm"}], ")"}], "pXm"}]}]}]}], "/.", 
    "solfixed1"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.69677853640318*^9, 3.6967785451541147`*^9}, {
  3.696778578227323*^9, 3.696778578451893*^9}, {3.6967787110870943`*^9, 
  3.696778714415099*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"2", " ", "FAa", " ", "wAf", " ", "wam", " ", "\[Alpha]f"}], "+", 
     RowBox[{"FAA", " ", "wAf", " ", "wAm", " ", "\[Alpha]m"}], "-", 
     RowBox[{
     "2", " ", "FAa", " ", "wAf", " ", "wam", " ", "\[Alpha]f", " ", 
      "\[Alpha]m"}]}], 
    RowBox[{
     RowBox[{"2", " ", "Faa", " ", "waf", " ", "wam"}], "-", 
     RowBox[{"2", " ", "Faa", " ", "waf", " ", "wam", " ", "\[Alpha]m"}]}]], 
   ",", 
   FractionBox[
    RowBox[{
     RowBox[{"Faa", " ", "wam", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "+", 
     RowBox[{"2", " ", "FAa", " ", "wAm", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", "\[Alpha]m"}]}], 
    RowBox[{"2", " ", "Faa", " ", "wam", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.696778552743115*^9, 3.6967785787589617`*^9}, 
   3.6967787147404823`*^9}]
}, Open  ]],

Cell["Ignoring haploid selection", "Text",
 CellChangeTimes->{{3.696779007197901*^9, 3.696779010762656*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"eigensR0neoWfixed1", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", "1"}], ",", 
    RowBox[{
     RowBox[{"eigensR0neoWfixed1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "<", "1"}], ",", "stabCondFixed1", ",", 
    
    RowBox[{"\[Alpha]m", "\[Equal]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"\[Alpha]f", "\[Equal]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"wAm", "\[Equal]", "1"}], ",", 
    RowBox[{"wam", "\[Equal]", "1"}], ",", 
    RowBox[{"wAf", "\[Equal]", "1"}], ",", 
    RowBox[{"waf", "\[Equal]", "1"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.696778737351242*^9, 3.696778860676505*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"FAa", ">", "0"}], "&&", 
  RowBox[{"Faa", ">", "FAa"}], "&&", 
  RowBox[{"MAA", ">", "0"}], "&&", 
  RowBox[{"MAa", ">", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"FAa", " ", "MAA"}], 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "Faa"}], "+", "FAa"}]]}]}], "&&", 
  RowBox[{"0", "<", "Maa", "<", "MAa"}], "&&", 
  RowBox[{"0", "<", "FAA", "<", 
   RowBox[{
    RowBox[{"2", " ", "Faa"}], "-", "FAa"}]}], "&&", 
  RowBox[{"\[Alpha]m", "\[Equal]", 
   FractionBox["1", "2"]}], "&&", 
  RowBox[{"\[Alpha]f", "\[Equal]", 
   FractionBox["1", "2"]}], "&&", 
  RowBox[{"wAm", "\[Equal]", "1"}], "&&", 
  RowBox[{"wam", "\[Equal]", "1"}], "&&", 
  RowBox[{"wAf", "\[Equal]", "1"}], "&&", 
  RowBox[{"waf", "\[Equal]", "1"}]}]], "Output",
 CellChangeTimes->{{3.696778852062372*^9, 3.696778861028006*^9}}]
}, Open  ]],

Cell["\<\
Which adds the condition that FAA<2 Faa-FAa over and above the stability \
conditions (which require 0<2 Faa-FAa). i.e., if 2 Faa-FAa<FAA, then one of \
the eigenvalues is greater than 1. \
\>", "Text",
 CellChangeTimes->{{3.6967789548072453`*^9, 3.696778995688302*^9}, {
  3.696779029548963*^9, 3.696779046829534*^9}, {3.6967791130044413`*^9, 
  3.6967791325654593`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"eigensR0neoWfixed1", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", "1"}], ",", 
    RowBox[{
     RowBox[{"eigensR0neoWfixed1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "<", "1"}], ",", "stabCondFixed1", ",", 
    
    RowBox[{"Faa", "<", 
     FractionBox[
      RowBox[{"FAA", "+", "FAa"}], "2"]}], ",", 
    RowBox[{"\[Alpha]m", "\[Equal]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"\[Alpha]f", "\[Equal]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"wAm", "\[Equal]", "1"}], ",", 
    RowBox[{"wam", "\[Equal]", "1"}], ",", 
    RowBox[{"wAf", "\[Equal]", "1"}], ",", 
    RowBox[{"waf", "\[Equal]", "1"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.696779062987764*^9, 3.6967791071540747`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.696779063480651*^9, 3.696779068666869*^9}, 
   3.6967791077816877`*^9}]
}, Open  ]],

Cell[TextData[{
 "This condition is also ",
 Cell[BoxData[
  RowBox[{"Faa", "<", 
   FractionBox[
    RowBox[{"FAA", "+", "FAa"}], "2"]}]],
  CellChangeTimes->{{3.696779062987764*^9, 3.6967791071540747`*^9}}],
 ". This looks like the fitness of the neo-W-A haplotype, which inherits the \
a (from an Xm) or the A (from a Ym) with equal probability (no haploid \
selection). Thus, this condition again indicates when the neo-W-A haplotype \
is favoured in females. "
}], "Text",
 CellChangeTimes->{{3.696779134703122*^9, 3.696779230058237*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["solpoly1", "Subsubsection",
 CellChangeTimes->{{3.696778228747983*^9, 3.696778229981522*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eigensR0neoWpoly1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"eigensR0neoW", "/.", 
      RowBox[{"meanF", "\[Rule]", "femaleMeanFit"}]}], "/.", 
     RowBox[{"pAveM", "\[Rule]", 
      RowBox[{
       RowBox[{"freqYm", " ", "pYm"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "freqYm"}], ")"}], "pXm"}]}]}]}], "/.", 
    "solpoly1"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.696778547327882*^9, 3.6967785746916428`*^9}, {
  3.696778622220047*^9, 3.696778625008966*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
      "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "waf", " ", 
       "wam", " ", "wAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["FAa", "2"], " ", "MAa", " ", "waf", " ", "wam", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", "\[Alpha]f", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
         RowBox[{"2", " ", "MAa", " ", "wam", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "-", 
      RowBox[{
       SuperscriptBox["FAA", "2"], " ", "MAa", " ", "MAA", " ", "wAf", " ", 
       SuperscriptBox["wAm", "2"], " ", "\[Alpha]m"}], "+", 
      RowBox[{"FAa", " ", "FAA", " ", "wAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["MAA", "2"], " ", "wAf", " ", "wAm", " ", 
          "\[Alpha]f"}], "-", 
         RowBox[{"MAa", " ", "MAA", " ", "waf", " ", "wAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", "\[Alpha]m"}],
          "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["MAa", "2"], " ", "waf", " ", "wam", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}], " ", 
          "\[Alpha]m"}]}], ")"}]}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"waf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["FAa", "2"]}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", "\[Alpha]f", 
         " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"MAA", " ", "wAm"}], "-", 
            RowBox[{"2", " ", "MAa", " ", "wam", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], 
          "2"]}], "+", 
        RowBox[{
        "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wam", " ", 
         "wAm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
     ")"}]}], ",", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"Faa", " ", "MAa", " ", "wam", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "FAA"}], " ", "MAA", " ", "wAf", " ", "wAm"}], "+", 
          RowBox[{"FAa", " ", "waf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"3", " ", "MAA", " ", "wAm"}], "+", 
             RowBox[{"2", " ", "MAa", " ", "wam", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}]}], 
         ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}], "+", 
       RowBox[{"2", " ", "FAa", " ", "wAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "FAA"}], " ", "MAa", " ", "MAA", " ", "wAf", " ", 
           "wAm", " ", "\[Alpha]m"}], "+", 
          RowBox[{"FAa", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "MAA"}], " ", "wAm"}], "+", 
             RowBox[{"2", " ", "MAa", " ", "wam", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "MAA"}], " ", "wAf", " ", "\[Alpha]f"}], "+", 
             RowBox[{"MAa", " ", "waf", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", 
              "\[Alpha]m"}]}], ")"}]}]}], ")"}]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"wAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           SuperscriptBox["FAa", "2"]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]f"}], ")"}], " ", "\[Alpha]f", 
          " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"MAA", " ", "wAm"}], "-", 
             RowBox[{"2", " ", "MAa", " ", "wam", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}], 
           "2"]}], "+", 
         RowBox[{
         "2", " ", "Faa", " ", "FAA", " ", "MAa", " ", "MAA", " ", "wam", " ",
           "wAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "\[Alpha]m"}], ")"}]}]}], ")"}]}], 
      ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6967785509091988`*^9, 3.6967785759592733`*^9}, 
   3.696778625332961*^9}]
}, Open  ]],

Cell["\<\
One of these eigenvalues must be greater than 1 if we add the condition that \
MAa>MAA and ignore haploid selection. The A is fixed on the Y so this \
condition means that the a allele is favoured during selection on the X in \
males. Since a polymorphism is maintained, this must also mean that the A \
allele is favoured during selection on the X in females. \
\>", "Text",
 CellChangeTimes->{{3.696774761353716*^9, 3.696774833091926*^9}, {
  3.6967749590302887`*^9, 3.6967749599096317`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"eigensR0neoWpoly1", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "<", "1"}], ",", 
    RowBox[{
     RowBox[{"eigensR0neoWpoly1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "<", "1"}], ",", "stabCondPoly1", ",", 
    RowBox[{"MAa", ">", "MAA"}], ",", 
    RowBox[{"\[Alpha]m", "\[Equal]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"\[Alpha]f", "\[Equal]", 
     RowBox[{"1", "/", "2"}]}], ",", 
    RowBox[{"wAm", "\[Equal]", "1"}], ",", 
    RowBox[{"wam", "\[Equal]", "1"}], ",", 
    RowBox[{"wAf", "\[Equal]", "1"}], ",", 
    RowBox[{"waf", "\[Equal]", "1"}]}], "}"}], "]"}]], "Input",
 CellChangeTimes->{{3.696773440634986*^9, 3.696773480344533*^9}, {
   3.696773536405012*^9, 3.696773572915753*^9}, {3.696773631121213*^9, 
   3.696773657484611*^9}, {3.696773729524659*^9, 3.696773796299111*^9}, {
   3.696774022966588*^9, 3.6967740233494873`*^9}, {3.696774596355344*^9, 
   3.696774620145775*^9}, {3.6967747050678473`*^9, 3.696774740823328*^9}, 
   3.696774988129118*^9, {3.696775031604508*^9, 3.696775049454804*^9}, {
   3.696775099334269*^9, 3.696775114467286*^9}, {3.696776503820238*^9, 
   3.6967765266084213`*^9}, {3.69677862757171*^9, 3.696778631497778*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{
  3.696773444758233*^9, {3.696773555365917*^9, 3.696773574613181*^9}, {
   3.696773638061728*^9, 3.696773669847254*^9}, 3.6967737385205193`*^9, {
   3.696773772277461*^9, 3.69677379706324*^9}, 3.6967740241470957`*^9, {
   3.696774597881418*^9, 3.696774620751227*^9}, {3.6967747159688253`*^9, 
   3.69677474164926*^9}, 3.696774861093635*^9, 3.696774988961801*^9, {
   3.6967750323843927`*^9, 3.696775050697363*^9}, 3.696775109475589*^9, 
   3.696776527417996*^9, {3.696778614645973*^9, 3.696778632216259*^9}}]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{948, 796},
WindowMargins->{{20, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 196, 2, 148, "Title"],
Cell[CellGroupData[{
Cell[800, 28, 682, 9, 80, "Section"],
Cell[CellGroupData[{
Cell[1507, 41, 105, 1, 34, "Subsection"],
Cell[1615, 44, 1201, 18, 41, "Text"],
Cell[2819, 64, 5074, 142, 448, "Input"],
Cell[7896, 208, 581, 9, 26, "Text"],
Cell[CellGroupData[{
Cell[8502, 221, 1138, 23, 43, "Input"],
Cell[9643, 246, 1490, 21, 27, "Output"],
Cell[11136, 269, 1492, 21, 27, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[12677, 296, 150, 2, 26, "Subsection"],
Cell[12830, 300, 300, 5, 30, "Text"],
Cell[13133, 307, 23894, 723, 1780, "Input"],
Cell[37030, 1032, 210, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[37265, 1039, 2268, 35, 352, "Input"],
Cell[39536, 1076, 523, 8, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[40108, 1090, 105, 1, 26, "Subsection"],
Cell[40216, 1093, 646, 10, 49, "Text"],
Cell[40865, 1105, 9515, 250, 998, "Input"],
Cell[50383, 1357, 141, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[50549, 1362, 1255, 21, 182, "Input"],
Cell[51807, 1385, 415, 6, 70, "Output"]
}, Open  ]],
Cell[52237, 1394, 8440, 230, 981, "Input"],
Cell[60680, 1626, 192, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[60897, 1632, 1325, 22, 182, "Input"],
Cell[62225, 1656, 459, 6, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[62733, 1668, 146, 2, 26, "Subsection"],
Cell[62882, 1672, 491, 15, 220, "Text"],
Cell[63376, 1689, 3519, 93, 777, "Input"],
Cell[66898, 1784, 3863, 96, 777, "Input"],
Cell[70764, 1882, 116, 1, 30, "Text"],
Cell[70883, 1885, 17674, 495, 1253, "Input"],
Cell[CellGroupData[{
Cell[88582, 2384, 422, 8, 28, "Input"],
Cell[89007, 2394, 688, 10, 70, "Output"]
}, Open  ]],
Cell[89710, 2407, 120, 1, 30, "Text"],
Cell[89833, 2410, 17710, 495, 1253, "Input"],
Cell[CellGroupData[{
Cell[107568, 2909, 323, 7, 28, "Input"],
Cell[107894, 2918, 473, 7, 70, "Output"]
}, Open  ]],
Cell[108382, 2928, 174, 4, 30, "Text"],
Cell[108559, 2934, 886, 16, 216, "Input"],
Cell[109448, 2952, 130, 1, 30, "Text"],
Cell[109581, 2955, 1563, 26, 369, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[111193, 2987, 634, 8, 50, "Section"],
Cell[111830, 2997, 171, 2, 26, "Text"],
Cell[112004, 3001, 1850, 39, 283, "Input"],
Cell[CellGroupData[{
Cell[113879, 3044, 217, 4, 27, "Input"],
Cell[114099, 3050, 585, 19, 27, "Output"]
}, Open  ]],
Cell[114699, 3072, 279, 5, 41, "Text"],
Cell[114981, 3079, 488, 8, 26, "Text"],
Cell[115472, 3089, 1126, 21, 103, "Input"],
Cell[116601, 3112, 140, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[116766, 3117, 253, 6, 27, "Input"],
Cell[117022, 3125, 9432, 279, 193, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[126491, 3409, 903, 25, 43, "Input"],
Cell[127397, 3436, 2247, 63, 58, "Output"],
Cell[129647, 3501, 374, 8, 27, "Output"]
}, Open  ]],
Cell[130036, 3512, 163, 3, 26, "Text"],
Cell[CellGroupData[{
Cell[130224, 3519, 1216, 34, 43, "Input"],
Cell[131443, 3555, 655, 17, 49, "Output"],
Cell[132101, 3574, 1704, 45, 49, "Output"]
}, Open  ]],
Cell[133820, 3622, 295, 5, 41, "Text"],
Cell[CellGroupData[{
Cell[134140, 3631, 2089, 63, 73, "Input"],
Cell[136232, 3696, 5554, 155, 174, "Output"],
Cell[141789, 3853, 370, 8, 27, "Output"]
}, Open  ]],
Cell[142174, 3864, 150, 3, 26, "Text"],
Cell[CellGroupData[{
Cell[142349, 3871, 1318, 35, 43, "Input"],
Cell[143670, 3908, 475, 12, 49, "Output"],
Cell[144148, 3922, 1222, 34, 49, "Output"]
}, Open  ]],
Cell[145385, 3959, 290, 5, 41, "Text"],
Cell[CellGroupData[{
Cell[145700, 3968, 2094, 63, 73, "Input"],
Cell[147797, 4033, 4463, 123, 152, "Output"],
Cell[152263, 4158, 424, 10, 27, "Output"]
}, Open  ]],
Cell[152702, 4171, 223, 5, 26, "Text"],
Cell[152928, 4178, 254, 5, 26, "Text"],
Cell[CellGroupData[{
Cell[153207, 4187, 3163, 86, 155, "Input"],
Cell[156373, 4275, 563, 8, 27, "Output"],
Cell[156939, 4285, 565, 8, 27, "Output"],
Cell[157507, 4295, 562, 8, 27, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[158106, 4308, 3002, 83, 154, "Input"],
Cell[161111, 4393, 461, 6, 27, "Output"],
Cell[161575, 4401, 459, 6, 27, "Output"],
Cell[162037, 4409, 458, 6, 27, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[162544, 4421, 152, 2, 50, "Section"],
Cell[CellGroupData[{
Cell[162721, 4427, 108, 1, 35, "Subsubsection"],
Cell[162832, 4430, 1211, 30, 148, "Input"],
Cell[164046, 4462, 134, 1, 26, "Text"],
Cell[164183, 4465, 398, 10, 27, "Input"],
Cell[164584, 4477, 262, 5, 26, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[164883, 4487, 100, 1, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[165008, 4492, 372, 10, 43, "Input"],
Cell[165383, 4504, 2901, 79, 130, "Output"]
}, Open  ]],
Cell[168299, 4586, 185, 2, 26, "Text"],
Cell[CellGroupData[{
Cell[168509, 4592, 955, 28, 79, "Input"],
Cell[169467, 4622, 321, 7, 46, "Output"]
}, Open  ]],
Cell[169803, 4632, 179, 4, 26, "Text"],
Cell[CellGroupData[{
Cell[170007, 4640, 807, 22, 43, "Input"],
Cell[170817, 4664, 592, 15, 47, "Output"]
}, Open  ]],
Cell[171424, 4682, 304, 6, 26, "Text"],
Cell[CellGroupData[{
Cell[171753, 4692, 588, 11, 27, "Input"],
Cell[172344, 4705, 1338, 22, 47, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[173719, 4732, 517, 9, 27, "Input"],
Cell[174239, 4743, 1616, 29, 47, "Output"]
}, Open  ]],
Cell[175870, 4775, 305, 6, 26, "Text"],
Cell[176178, 4783, 759, 20, 43, "Input"],
Cell[CellGroupData[{
Cell[176962, 4807, 301, 8, 27, "Input"],
Cell[177266, 4817, 1203, 33, 43, "Output"]
}, Open  ]],
Cell[178484, 4853, 179, 2, 26, "Text"],
Cell[CellGroupData[{
Cell[178688, 4859, 642, 17, 27, "Input"],
Cell[179333, 4878, 94, 1, 27, "Output"]
}, Open  ]],
Cell[179442, 4882, 270, 5, 26, "Text"],
Cell[CellGroupData[{
Cell[179737, 4891, 461, 12, 46, "Input"],
Cell[180201, 4905, 1182, 29, 84, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[181432, 4940, 99, 1, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[181556, 4945, 274, 6, 27, "Input"],
Cell[181833, 4953, 15429, 334, 479, "Output"]
}, Open  ]],
Cell[197277, 5290, 151, 3, 26, "Text"],
Cell[CellGroupData[{
Cell[197453, 5297, 819, 22, 43, "Input"],
Cell[198275, 5321, 2464, 69, 69, "Output"]
}, Open  ]],
Cell[200754, 5393, 282, 5, 41, "Text"],
Cell[CellGroupData[{
Cell[201061, 5402, 1133, 31, 96, "Input"],
Cell[202197, 5435, 2375, 66, 69, "Output"],
Cell[204575, 5503, 211, 3, 27, "Output"]
}, Open  ]],
Cell[204801, 5509, 140, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[204966, 5514, 762, 22, 49, "Input"],
Cell[205731, 5538, 168, 2, 27, "Output"]
}, Open  ]],
Cell[205914, 5543, 387, 8, 41, "Text"],
Cell[206304, 5553, 178, 4, 26, "Text"],
Cell[CellGroupData[{
Cell[206507, 5561, 904, 23, 43, "Input"],
Cell[207414, 5586, 3251, 92, 106, "Output"]
}, Open  ]],
Cell[210680, 5681, 304, 6, 26, "Text"],
Cell[CellGroupData[{
Cell[211009, 5691, 540, 11, 27, "Input"],
Cell[211552, 5704, 2760, 63, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214349, 5772, 461, 8, 27, "Input"],
Cell[214813, 5782, 4124, 103, 104, "Output"]
}, Open  ]],
Cell[218952, 5888, 260, 5, 26, "Text"],
Cell[219215, 5895, 759, 20, 43, "Input"],
Cell[CellGroupData[{
Cell[219999, 5919, 824, 23, 58, "Input"],
Cell[220826, 5944, 3217, 86, 149, "Output"]
}, Open  ]],
Cell[224058, 6033, 228, 4, 26, "Text"],
Cell[224289, 6039, 213, 4, 26, "Text"],
Cell[CellGroupData[{
Cell[224527, 6047, 359, 9, 27, "Input"],
Cell[224889, 6058, 1542, 43, 64, "Output"]
}, Open  ]],
Cell[226446, 6104, 185, 2, 26, "Text"],
Cell[CellGroupData[{
Cell[226656, 6110, 514, 14, 27, "Input"],
Cell[227173, 6126, 1621, 44, 64, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[228831, 6175, 580, 15, 27, "Input"],
Cell[229414, 6192, 1546, 43, 64, "Output"]
}, Open  ]],
Cell[230975, 6238, 794, 23, 38, "Text"],
Cell[CellGroupData[{
Cell[231794, 6265, 1185, 33, 90, "Input"],
Cell[232982, 6300, 12267, 316, 359, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[245310, 6623, 160, 2, 80, "Section"],
Cell[CellGroupData[{
Cell[245495, 6629, 95, 1, 44, "Subsection"],
Cell[245593, 6632, 162, 3, 26, "Text"],
Cell[245758, 6637, 2011, 59, 82, "Input"],
Cell[247772, 6698, 268, 5, 41, "Text"],
Cell[248043, 6705, 1455, 33, 43, "Input"],
Cell[249501, 6740, 1384, 28, 43, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[250922, 6773, 95, 1, 36, "Subsection"],
Cell[CellGroupData[{
Cell[251042, 6778, 102, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[251169, 6783, 285, 7, 27, "Input"],
Cell[251457, 6792, 248, 7, 46, "Output"]
}, Open  ]],
Cell[251720, 6802, 253, 5, 26, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[252010, 6812, 99, 1, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[252134, 6817, 235, 6, 27, "Input"],
Cell[252372, 6825, 2416, 68, 73, "Output"]
}, Open  ]],
Cell[254803, 6896, 124, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[254952, 6901, 2653, 71, 108, "Input"],
Cell[257608, 6974, 74, 1, 27, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[257743, 6982, 92, 1, 44, "Subsection"],
Cell[CellGroupData[{
Cell[257860, 6987, 100, 1, 35, "Subsubsection"],
Cell[CellGroupData[{
Cell[257985, 6992, 602, 16, 43, "Input"],
Cell[258590, 7010, 1070, 29, 48, "Output"]
}, Open  ]],
Cell[259675, 7042, 108, 1, 26, "Text"],
Cell[CellGroupData[{
Cell[259808, 7047, 728, 19, 43, "Input"],
Cell[260539, 7068, 854, 24, 80, "Output"]
}, Open  ]],
Cell[261408, 7095, 382, 7, 41, "Text"],
Cell[CellGroupData[{
Cell[261815, 7106, 822, 22, 72, "Input"],
Cell[262640, 7130, 126, 2, 27, "Output"]
}, Open  ]],
Cell[262781, 7135, 543, 12, 51, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[263361, 7152, 99, 1, 29, "Subsubsection"],
Cell[CellGroupData[{
Cell[263485, 7157, 550, 15, 43, "Input"],
Cell[264038, 7174, 5595, 157, 129, "Output"]
}, Open  ]],
Cell[269648, 7334, 504, 8, 56, "Text"],
Cell[CellGroupData[{
Cell[270177, 7346, 1274, 26, 43, "Input"],
Cell[271454, 7374, 561, 8, 27, "Output"]
}, Open  ]]
}, Closed]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
