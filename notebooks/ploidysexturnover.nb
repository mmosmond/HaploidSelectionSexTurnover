(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    454231,      12702]
NotebookOptionsPosition[    426007,      11830]
NotebookOutlinePosition[    426393,      11847]
CellTagsIndexPosition[    426350,      11844]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Sperm/pollen competition drives sex chromosome turnover \
\>", "Title",
 CellChangeTimes->{{3.6756461584547977`*^9, 3.675646190672323*^9}, {
   3.675691343813216*^9, 3.675691344643425*^9}, {3.675718324413807*^9, 
   3.6757183349582043`*^9}, {3.675719587684537*^9, 3.675719616196001*^9}, 
   3.6759056672964783`*^9, {3.676585253711862*^9, 3.676585256794689*^9}}],

Cell["Michael Scott & Matthew Osmond", "Subtitle",
 CellChangeTimes->{{3.6756909919076443`*^9, 3.675690999875959*^9}}],

Cell["\<\
This is much like van Doorn & Kirkpatrick 2007 (Nature 449:909), but with \
sperm/pollen competition as well. Our hypothesis is that ploidally \
antagonistic selection will remove the need for sexually antagonistic \
selection to drive sex chromosome turnover.\t\
\>", "Text",
 CellChangeTimes->{{3.675719638233714*^9, 3.675719730889935*^9}, {
  3.6761377614286613`*^9, 3.6761378391307373`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["First try (delete?)", "Title",
 CellChangeTimes->{{3.676584749923991*^9, 3.676584754138258*^9}, {
  3.676585234795609*^9, 3.676585239450625*^9}}],

Cell[CellGroupData[{

Cell["Resident life-cycle", "Section",
 CellChangeTimes->{{3.6756910197792797`*^9, 3.675691024113359*^9}, {
  3.67569412935745*^9, 3.6756941314240303`*^9}, {3.675707349839982*^9, 
  3.675707351884247*^9}, {3.675709974013658*^9, 3.675709982915987*^9}}],

Cell["\<\
We start with haploid selection, which occurs in sperm/pollen only. Let XAm \
be the frequency of allele A at the diallelic autosomal locus in \
gametes/pollen with an X allele at the diallelic sex-determining locus. Let \
YA be the frequency of allele A at the diallelic autosomal locus in \
gametes/pollen with an Y allele at the diallelic sex-determining locus. Let \
XAf be the frequency of allele A at the diallelic autosomal locus in eggs \
(which necessarily have an X allele at the diallelic sex-determining locus). \
Males make \[Alpha]% of their sperm/pollen Y-bearing. After selection on male \
gametes/pollen we then have frequencies of A (and a) in each type of \
gamete/pollen:\
\>", "Text",
 CellChangeTimes->{{3.675646210075425*^9, 3.6756462139879293`*^9}, {
  3.675692881948024*^9, 3.675692905462323*^9}, {3.675702634397826*^9, 
  3.6757026600570383`*^9}, {3.675710000498989*^9, 3.675710437600037*^9}, {
  3.6757106247367887`*^9, 3.675710626158669*^9}, {3.6761379095010347`*^9, 
  3.676137962328772*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wbarHap", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"wA", " ", "XAm"}], "+", 
       RowBox[{"wa", " ", "Xam"}]}], ")"}]}], "+", 
    RowBox[{"\[Alpha]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"wA", " ", "YA"}], "+", 
       RowBox[{"wa", " ", "Ya"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAms", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Alpha]"}], ")"}], "wA", " ", 
    RowBox[{"XAm", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xams", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Alpha]"}], ")"}], "wa", " ", 
    RowBox[{"Xam", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAs", "=", 
   RowBox[{"\[Alpha]", " ", "wA", "*", 
    RowBox[{"YA", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yas", "=", 
   RowBox[{"\[Alpha]", " ", "wa", "*", 
    RowBox[{"Ya", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAfs", "=", "XAf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xafs", "=", "Xaf"}], ";"}]}], "Input",
 CellChangeTimes->{{3.675645810680058*^9, 3.6756459276391087`*^9}, {
   3.6756459611641893`*^9, 3.67564599552956*^9}, {3.6756463012573423`*^9, 
   3.6756463017774*^9}, 3.675646515472443*^9, {3.675646641547511*^9, 
   3.675646657805133*^9}, {3.675647674839451*^9, 3.6756477105194483`*^9}, {
   3.675691050900692*^9, 3.6756912374806137`*^9}, {3.675691327244226*^9, 
   3.675691327340498*^9}, {3.675702032463594*^9, 3.675702091069471*^9}, 
   3.675702137656342*^9, {3.675727270631213*^9, 3.67572733497223*^9}, {
   3.675727409214241*^9, 3.675727449474516*^9}}],

Cell["\<\
Check that frequencies A and a in the gametes produced by each sex sum to one \
after selection:\
\>", "Text",
 CellChangeTimes->{{3.675691241028049*^9, 3.675691262904736*^9}, {
   3.675691499842326*^9, 3.675691508954028*^9}, {3.6757021446730413`*^9, 
   3.6757021466313477`*^9}, 3.67570266834774*^9, {3.675710454342794*^9, 
   3.675710458811872*^9}, {3.675711308941972*^9, 3.6757113347037287`*^9}, {
   3.6761380232804413`*^9, 3.67613802836209*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAms", "+", "Xams", "+", "YAs", "+", "Yas"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{"XAfs", "+", "Xafs"}]}], "/.", 
   RowBox[{"XAf", "\[Rule]", 
    RowBox[{"1", "-", "Xaf"}]}]}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.6757273549842978`*^9, 3.675727390607794*^9}, {
  3.6757276397063427`*^9, 3.6757276468903522`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, 
   3.675884020229591*^9, 3.6758943462692013`*^9, 3.6761378515720167`*^9, 
   3.676146232165584*^9, 3.676205569499588*^9, 3.676570768406241*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, 
   3.675884020229591*^9, 3.6758943462692013`*^9, 3.6761378515720167`*^9, 
   3.676146232165584*^9, 3.676205569499588*^9, 3.676570768407979*^9}]
}, Open  ]],

Cell["\<\
After random mating, the frequencies of the diploid genotypes are\
\>", "Text",
 CellChangeTimes->{{3.675646094888542*^9, 3.675646099390658*^9}, {
  3.675646217785323*^9, 3.675646250704771*^9}, {3.67570268816877*^9, 
  3.6757027045136023`*^9}, {3.676146332376375*^9, 3.67614633258622*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAXA", "=", 
   RowBox[{"XAfs", " ", "XAms"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXa", "=", 
   RowBox[{
    RowBox[{"XAfs", " ", "Xams"}], "+", 
    RowBox[{"Xafs", " ", "XAms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaXa", "=", 
   RowBox[{"Xafs", " ", "Xams"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYA", "=", 
   RowBox[{"XAfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYa", "=", 
   RowBox[{"XAfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYA", "=", 
   RowBox[{"Xafs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYa", "=", 
   RowBox[{"Xafs", " ", "Yas"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646256909181*^9, 3.675646272815617*^9}, {
   3.675646370257011*^9, 3.67564637079287*^9}, {3.675646404699778*^9, 
   3.675646517567526*^9}, {3.675646573911735*^9, 3.675646591557143*^9}, {
   3.675646627619878*^9, 3.67564663177063*^9}, {3.675646667841331*^9, 
   3.675646747122738*^9}, {3.675691396390801*^9, 3.675691472391663*^9}, {
   3.675691536695323*^9, 3.675691538414453*^9}, {3.675691639085917*^9, 
   3.675691650195237*^9}, {3.675691682513646*^9, 3.675691696533524*^9}, {
   3.675691755294464*^9, 3.6756917629827957`*^9}, {3.675691824386702*^9, 
   3.675691852603437*^9}, {3.675692700413486*^9, 3.675692712195026*^9}, {
   3.67569296671769*^9, 3.675692967464675*^9}, {3.6756930389284983`*^9, 
   3.675693095368285*^9}, {3.675693137308187*^9, 3.675693184356132*^9}, {
   3.675693221908244*^9, 3.6756932234970217`*^9}, {3.675693268122773*^9, 
   3.675693270392726*^9}, {3.675693410576119*^9, 3.675693460007984*^9}, {
   3.675693492300033*^9, 3.675693533360964*^9}, 3.675693600152028*^9, {
   3.675702177145516*^9, 3.675702196152766*^9}, {3.6757023129704742`*^9, 
   3.675702317051364*^9}}],

Cell["\<\
Check that frequencies sum to one\
\>", "Text",
 CellChangeTimes->{{3.676146335746284*^9, 3.676146339863083*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "XAXA", "+", "XAXa", "+", "XaXa", "+", "XAYA", "+", "XAYa", "+", "XaYA", 
    "+", "XaYa"}], "/.", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "XAf"}]}]}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.67614624086416*^9, 3.676146281754944*^9}, {
  3.676146316683073*^9, 3.676146326319971*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.676146248582675*^9, 3.6761462821854057`*^9}, {
   3.676146317018733*^9, 3.676146326719157*^9}, 3.6762055695703983`*^9, 
   3.676570768460847*^9}]
}, Open  ]],

Cell["\<\
Without selection, after mating the sex ratio (% male) is\
\>", "Text",
 CellChangeTimes->{{3.675691479260996*^9, 3.675691518331197*^9}, {
   3.675702245714006*^9, 3.675702247314129*^9}, 3.675702712372058*^9, 
   3.6757852851401663`*^9, {3.676138045171205*^9, 3.676138079620078*^9}, {
   3.676142901860179*^9, 3.676142907791334*^9}, {3.676146353533441*^9, 
   3.676146356796474*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"XAYA", "+", "XAYa", "+", "XaYA", "+", "XaYa"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
        "XAXA", "+", "XAXa", "+", "XaXa", "+", "XAYA", "+", "XAYa", "+", 
         "XaYA", "+", "XaYa"}], ")"}]}], "/.", 
      RowBox[{"wA", "\[Rule]", "1"}]}], "/.", 
     RowBox[{"wa", "\[Rule]", "1"}]}], "/.", 
    RowBox[{"Ya", "\[Rule]", 
     RowBox[{"1", "-", "YA"}]}]}], "/.", 
   RowBox[{"Xam", "\[Rule]", 
    RowBox[{"1", "-", "XAm"}]}]}], "//", "Factor"}]], "Input"],

Cell[BoxData["\[Alpha]"], "Output",
 CellChangeTimes->{{3.6757854032095118`*^9, 3.6757854082341347`*^9}, 
   3.675884022348506*^9, 3.675894346335474*^9, 3.676137851669938*^9, 
   3.676146232265835*^9, 3.676205569603647*^9, 3.676570768503188*^9}]
}, Open  ]],

Cell["\<\
After diploid selection (which can differ between males Mij and females Fij) \
the frequencies of the diploid genotypes in each sex are\
\>", "Text",
 CellChangeTimes->{{3.6756467552456417`*^9, 3.67564676342205*^9}, {
  3.675702725992881*^9, 3.67570275267984*^9}, {3.6761380890989847`*^9, 
  3.6761380925668793`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wbarF", "=", 
   RowBox[{
    RowBox[{"FAA", " ", "XAXA"}], "+", 
    RowBox[{"FAa", " ", "XAXa"}], "+", 
    RowBox[{"Faa", " ", "XaXa"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wbarM", "=", 
   RowBox[{
    RowBox[{"MAA", " ", "XAYA"}], "+", 
    RowBox[{"MAa", " ", "XAYa"}], "+", 
    RowBox[{"MAa", " ", "XaYA"}], "+", 
    RowBox[{"Maa", " ", "XaYa"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXAs", "=", 
   RowBox[{"FAA", " ", 
    RowBox[{"XAXA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXas", "=", 
   RowBox[{"FAa", " ", 
    RowBox[{"XAXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaXas", "=", 
   RowBox[{"Faa", " ", 
    RowBox[{"XaXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XaYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYas", "=", 
   RowBox[{"Maa", " ", 
    RowBox[{"XaYa", "/", "wbarM"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646788099258*^9, 3.675646827315172*^9}, {
  3.675646906255657*^9, 3.6756471746197577`*^9}, {3.6756477305962267`*^9, 
  3.675647791098443*^9}, {3.675693609968581*^9, 3.6756936401475143`*^9}, {
  3.675702773030509*^9, 3.675702825109133*^9}}],

Cell["\<\
Check that frequencies of diploid genotypes in each sex sum to one after \
diploid selection:\
\>", "Text",
 CellChangeTimes->{{3.67569367511821*^9, 3.6756936990142593`*^9}, {
  3.675702840764554*^9, 3.675702847452877*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAXAs", "+", "XAXas", "+", "XaXas"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAYAs", "+", "XAYas", "+", "XaYAs", "+", "XaYas"}]}], "//", 
  "Factor"}]}], "Input",
 CellChangeTimes->{{3.67569371292774*^9, 3.675693719435033*^9}, {
  3.675702830827154*^9, 3.675702835546769*^9}, {3.67570296812504*^9, 
  3.675702969573578*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9, 3.675727555437428*^9, 
   3.6757852556150913`*^9, 3.6757854222905197`*^9, 3.675884027160019*^9, 
   3.675894346403042*^9, 3.676137851736586*^9, 3.676146232332129*^9, 
   3.67620556964918*^9, 3.676570768547803*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9, 3.675727555437428*^9, 
   3.6757852556150913`*^9, 3.6757854222905197`*^9, 3.675884027160019*^9, 
   3.675894346403042*^9, 3.676137851736586*^9, 3.676146232332129*^9, 
   3.67620556964918*^9, 3.676570768548954*^9}]
}, Open  ]],

Cell["\<\
Finally, meiosis occurs, giving the haploid frequencies at the start of the \
next generation\
\>", "Text",
 CellChangeTimes->{{3.675647183205927*^9, 3.675647193439426*^9}, {
  3.675702857268779*^9, 3.6757029057817707`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAfprime", "=", 
   RowBox[{"XAXAs", "+", 
    RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xafprime", "=", 
   RowBox[{"XaXas", "+", 
    RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAmprime", "=", 
   RowBox[{"XAYAs", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}], "XAYas"}], "+", 
    RowBox[{"r", " ", "XaYAs"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xamprime", "=", 
   RowBox[{"XaYas", "+", 
    RowBox[{"r", " ", "XAYas"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}], " ", "XaYAs"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAprime", "=", 
   RowBox[{"XAYAs", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}], "XaYAs"}], "+", " ", 
    RowBox[{"r", " ", "XAYas"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yaprime", "=", 
   RowBox[{"XaYas", "+", 
    RowBox[{"r", " ", "XaYAs"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", " ", "r"}], ")"}], " ", "XAYas"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6756472292114067`*^9, 3.6756473420504217`*^9}, {
  3.6756473952800293`*^9, 3.675647424390531*^9}, {3.675647484585294*^9, 
  3.675647589565673*^9}, {3.675648941522543*^9, 3.675649018308858*^9}, {
  3.675649385250359*^9, 3.675649410886257*^9}, {3.675693872816942*^9, 
  3.675693896989888*^9}, {3.675693964935532*^9, 3.6756940172718267`*^9}, {
  3.675694055414246*^9, 3.6756941117619743`*^9}, {3.675702930758318*^9, 
  3.675702948794842*^9}}],

Cell["\<\
Check that frequencies of haploid genotypes sum to one after meiosis\
\>", "Text",
 CellChangeTimes->{{3.67569367511821*^9, 3.6756936990142593`*^9}, {
  3.67569375263811*^9, 3.675693763639084*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAfprime", "+", "Xafprime"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAmprime", "+", "Xamprime"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"YAprime", "+", "Yaprime"}]}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.67569371292774*^9, 3.675693719435033*^9}, {
  3.675693774249498*^9, 3.675693826562112*^9}, {3.675702917688963*^9, 
  3.675702960491468*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675693788565115*^9, 3.675693826974794*^9, 
   3.675693898532673*^9, {3.675693974855103*^9, 3.675694020508545*^9}, 
   3.675694073054261*^9, 3.6756941134149103`*^9, {3.675702911869741*^9, 
   3.675702960821375*^9}, 3.675727577178288*^9, 3.67578542429417*^9, 
   3.6758943464859247`*^9, 3.676137851803961*^9, 3.676146232398088*^9, 
   3.6762055697008677`*^9, 3.676570768596898*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675693788565115*^9, 3.675693826974794*^9, 
   3.675693898532673*^9, {3.675693974855103*^9, 3.675694020508545*^9}, 
   3.675694073054261*^9, 3.6756941134149103`*^9, {3.675702911869741*^9, 
   3.675702960821375*^9}, 3.675727577178288*^9, 3.67578542429417*^9, 
   3.6758943464859247`*^9, 3.676137851803961*^9, 3.676146232398088*^9, 
   3.6762055697008677`*^9, 3.6765707685980043`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675693788565115*^9, 3.675693826974794*^9, 
   3.675693898532673*^9, {3.675693974855103*^9, 3.675694020508545*^9}, 
   3.675694073054261*^9, 3.6756941134149103`*^9, {3.675702911869741*^9, 
   3.675702960821375*^9}, 3.675727577178288*^9, 3.67578542429417*^9, 
   3.6758943464859247`*^9, 3.676137851803961*^9, 3.676146232398088*^9, 
   3.6762055697008677`*^9, 3.6765707685989103`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Resident equilibrium", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9}],

Cell["\<\
We now solve for the equilibrium frequency of A in each of the haploid \
genotypes. Equilibrium is achieved when the following three equations are zero\
\>", "Text",
 CellChangeTimes->{{3.675694155902801*^9, 3.675694193760104*^9}, {
  3.6756944337868023`*^9, 3.6756944351881227`*^9}, {3.6757029847267847`*^9, 
  3.67570303405547*^9}, {3.675710696458521*^9, 3.675710706286772*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqs", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAfprime", "-", "XAf"}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAmprime", "-", "XAm"}], ",", "\[IndentingNewLine]", 
     RowBox[{"YAprime", "-", "YA"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675647987041369*^9, 3.67564802904979*^9}, {
   3.675650509895372*^9, 3.675650527299842*^9}, {3.6756941716513157`*^9, 
   3.6756941738671913`*^9}, {3.675694338488646*^9, 3.675694340978696*^9}, {
   3.675694394143187*^9, 3.6756944261522427`*^9}, 3.6756944751724463`*^9, 
   3.675702984727247*^9, {3.675703036868017*^9, 3.675703037688758*^9}, 
   3.67578824463701*^9}],

Cell["\<\
To simplify the analysis we assume weak selection in both haploids \
(sperm/pollen) and diploids\
\>", "Text",
 CellChangeTimes->{{3.675694205010009*^9, 3.675694211923259*^9}, 
   3.67570298472752*^9, {3.6757030454432507`*^9, 3.6757030568360033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weaksel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAm", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAm", " ", "sAm", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Maa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAf", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAf", " ", "sAf", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Faa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"wA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"t", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"wa", "\[Rule]", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67564806523287*^9, 3.675648221558539*^9}, {
   3.675694367971285*^9, 3.6756943845803022`*^9}, 3.6757029847280283`*^9}],

Cell["We can write the frequencies as Taylor series", "Text",
 CellChangeTimes->{{3.675707045047565*^9, 3.6757070543930063`*^9}, {
  3.675707367038864*^9, 3.675707370179316*^9}, {3.675711803871513*^9, 
  3.6757118112225847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frequenciessub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", 
      RowBox[{"XAf0", "+", 
       RowBox[{"XAf1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAm", "\[Rule]", 
      RowBox[{"XAm0", "+", 
       RowBox[{"XAm1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YA", "\[Rule]", 
      RowBox[{"YA0", "+", 
       RowBox[{"YA1", " ", "\[Epsilon]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675648297857716*^9, 3.6756483630660057`*^9}, 
   3.675648454638584*^9, 3.675702984736863*^9}],

Cell["\<\
Without selection, the recursions for the change in frequency of A in each \
gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.6757032054455214`*^9, 3.6757032697493563`*^9}, {
   3.6757098202812138`*^9, 3.675709824765788*^9}, {3.6757117765596933`*^9, 
   3.6757117850524673`*^9}, {3.675711818872109*^9, 3.6757118199810133`*^9}, 
   3.6761381565029078`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs0", "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "frequenciessub"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.675703197099375*^9, 3.675703198353765*^9}, {
  3.675703326603519*^9, 3.675703332003808*^9}, {3.67570336997014*^9, 
  3.675703373531238*^9}, {3.675707060003501*^9, 3.675707071963544*^9}, {
  3.675707629815399*^9, 3.675707668691402*^9}, {3.6757098279293118`*^9, 
  3.6757098635569563`*^9}, {3.675785533464711*^9, 3.675785543888385*^9}, {
  3.675788240589053*^9, 3.675788247183043*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "XAf0"}], "+", "XAm0"}], ")"}]}], ",", 
   RowBox[{"XAf0", "-", 
    RowBox[{"r", " ", "XAf0"}], "-", "XAm0", "+", 
    RowBox[{"r", " ", "YA0"}]}], ",", 
   RowBox[{
    RowBox[{"r", " ", "XAf0"}], "-", 
    RowBox[{"r", " ", "YA0"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675703373832204*^9, 3.675707072550578*^9, 3.6757076390361347`*^9, 
   3.675707669538135*^9, {3.675709828918172*^9, 3.6757098643685303`*^9}, 
   3.675727585946179*^9, 3.675785428940669*^9, 3.675788254779942*^9, 
   3.6761381624813623`*^9, 3.676146369707528*^9, 3.676205569877428*^9, 
   3.676570768762731*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675709831409095*^9, 3.6757098343025913`*^9}, {
  3.675710744701475*^9, 3.675710745621426*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"differenceEqs0", "\[Equal]", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"XAf0", ",", "XAm0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675709931730151*^9, 3.675709948227565*^9}, 
   3.676138176648445*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"XAf0", "\[Rule]", "YA0"}], ",", 
    RowBox[{"XAm0", "\[Rule]", "YA0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6757098363525476`*^9, {3.6757099323567266`*^9, 3.675709948639193*^9}, 
   3.675727587389184*^9, 3.675785430130021*^9, 3.67578825590738*^9, {
   3.676138165134851*^9, 3.676138177014187*^9}, 3.676146369743536*^9, 
   3.6762055698992853`*^9, 3.67657076880284*^9}]
}, Open  ]],

Cell["\<\
So, with no selection, the equilibrium frequency of A in each gamete/pollen \
type is equal (and we call this pA).\
\>", "Text",
 CellChangeTimes->{{3.675703427939505*^9, 3.6757035626138153`*^9}, {
   3.675706719194449*^9, 3.675706765062245*^9}, 3.67570996472328*^9, {
   3.6757107664993973`*^9, 3.675710849444377*^9}}],

Cell["\<\
Now, looking at only the first order selection terms, the recursions for the \
change in frequency of A in each gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.67570356712366*^9, 3.675703572187316*^9}, {
  3.67570609431063*^9, 3.675706097287983*^9}, {3.6757069069525433`*^9, 
  3.6757069072532797`*^9}, {3.67571091918222*^9, 3.6757109367564697`*^9}, {
  3.675711772412171*^9, 3.67571177325072*^9}, {3.675716463608975*^9, 
  3.67571647265489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs1", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
              RowBox[{"Xaf", "\[Rule]", 
               RowBox[{"1", "-", "XAf"}]}]}], "/.", 
             RowBox[{"Ya", "\[Rule]", 
              RowBox[{"1", "-", "YA"}]}]}], "/.", 
            RowBox[{"Xam", "\[Rule]", 
             RowBox[{"1", "-", "XAm"}]}]}], "/.", "frequenciessub"}], "/.", 
          "sol0"}], "/.", 
         RowBox[{"YA0", "\[Rule]", "pA"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
     ",", "\[Epsilon]", ",", "Factor"}], "]"}], "//", "Flatten"}]}]], "Input",\

 CellChangeTimes->{{3.6757068495866413`*^9, 3.6757068907711554`*^9}, {
  3.6757069302403297`*^9, 3.675706982461239*^9}, {3.675707087605297*^9, 
  3.6757071228419533`*^9}, {3.67570718969317*^9, 3.675707319107386*^9}, {
  3.675707511314725*^9, 3.675707512612761*^9}, {3.675710885258552*^9, 
  3.675710885357044*^9}, {3.675711221036006*^9, 3.675711227798399*^9}, {
  3.675788237526182*^9, 3.6757882495037823`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}], "-", "XAf1", "+", "XAm1"}], 
     ")"}], " ", "\[Epsilon]"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "r", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}], "+", "XAf1", "-", 
      RowBox[{"r", " ", "XAf1"}], "-", "XAm1", "+", 
      RowBox[{"r", " ", "YA1"}]}], ")"}], " ", "\[Epsilon]"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}], "-", 
      RowBox[{"pA", " ", "r", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}], "+", 
      RowBox[{"r", " ", "XAf1"}], "-", 
      RowBox[{"r", " ", "YA1"}]}], ")"}], " ", "\[Epsilon]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675706852317442*^9, 3.675706918829287*^9}, {
   3.675706950931774*^9, 3.675706982932413*^9}, {3.6757070910767508`*^9, 
   3.675707123327277*^9}, {3.6757071925330353`*^9, 3.675707319486848*^9}, 
   3.675707513296742*^9, 3.67570768217498*^9, {3.675710857628578*^9, 
   3.675710885875184*^9}, {3.675711222477412*^9, 3.67571122814371*^9}, 
   3.67572758892033*^9, 3.675785431200643*^9, 3.6757882566822844`*^9, 
   3.67613819572523*^9, 3.6761463697988167`*^9, 3.67620556995926*^9, 
   3.676570768862144*^9}]
}, Open  ]],

Cell["\<\
Instead of solving for the first order genotype frequencies we will instead \
solve for the difference in the frequency of A in the different gamete/pollen \
types.\
\>", "Text",
 CellChangeTimes->{{3.6757135825548286`*^9, 3.675713633862471*^9}, 
   3.6757138892769423`*^9, {3.675716482887339*^9, 3.6757164842940083`*^9}}],

Cell["\<\
The difference in the frequency of A with X in females and X in males is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.6757138909855633`*^9, 3.675713959445539*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfXm", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"XAf1", "\[Rule]", 
       RowBox[{"dpAXfXm", "+", "XAm1"}]}]}], ",", "dpAXfXm"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.67571264493021*^9, 3.675712689537509*^9}, {
   3.675712721625124*^9, 3.675712730987232*^9}, {3.6757136496293707`*^9, 
   3.6757136649001226`*^9}, {3.675716490314892*^9, 3.675716491532194*^9}, 
   3.676138201444324*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfXm", "\[Rule]", 
   RowBox[{
    RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
    RowBox[{"6", " ", "hAf", " ", 
     SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
    RowBox[{"4", " ", "hAf", " ", 
     SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
    RowBox[{"pA", " ", "t"}], "-", 
    RowBox[{
     SuperscriptBox["pA", "2"], " ", "t"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675712649738289*^9, 3.675712661484269*^9}, 
   3.675712732353135*^9, 3.6757136656167507`*^9, 3.675716491898244*^9, 
   3.6757275909002647`*^9, 3.675785432660453*^9, 3.675788258653908*^9, 
   3.676138202533581*^9, 3.676146369841419*^9, 3.67620556998715*^9, 
   3.676570768903221*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in males and Y is (at equilibrium \
to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713966791181*^9, 3.6757139830606413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXmY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"differenceEqs1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
        RowBox[{"XAf1", "\[Rule]", 
         RowBox[{"dpAXfXm", "+", "XAm1"}]}]}], "/.", "eqdpAXfXm"}], "/.", 
      RowBox[{"XAm1", "\[Rule]", 
       RowBox[{"dpAXmY", "+", "YA1"}]}]}], ",", "dpAXmY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757127688027287`*^9, 3.675712794290226*^9}, {
   3.6757128674967947`*^9, 3.675712955948361*^9}, {3.675713232210559*^9, 
   3.675713326592478*^9}, {3.675713674096274*^9, 3.6757136876868258`*^9}, {
   3.6757164945548773`*^9, 3.675716495980947*^9}, 3.67613820556537*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXmY", "\[Rule]", 
   RowBox[{
    FractionBox["1", "r"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "r", " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "-", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675713327517667*^9, {3.675713675336254*^9, 3.6757136899362087`*^9}, 
   3.675716496367241*^9, 3.67572759200576*^9, 3.675785433424408*^9, 
   3.675788259415702*^9, 3.67613820593443*^9, 3.676146369870596*^9, 
   3.676205570023275*^9, 3.676570768954109*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in females and Y is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713993050933*^9, 3.6757140012817707`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"XAf1", "\[Rule]", 
       RowBox[{"dpAXfY", "+", "YA1"}]}]}], ",", "dpAXfY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757133432729*^9, 3.6757133796267223`*^9}, {
   3.675713699819319*^9, 3.675713703005155*^9}, {3.67571649868948*^9, 
   3.675716499747883*^9}, 3.676138209372942*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfY", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "hAm"}], " ", "pA", " ", "sAm"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{"3", " ", "hAm", " ", 
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"2", " ", "hAm", " ", 
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"pA", " ", "t"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "t"}], "+", 
     RowBox[{"pA", " ", "r", " ", "t"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], "r"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675713343667881*^9, 3.675713380152212*^9}, 
   3.675713703634624*^9, 3.675716500081162*^9, 3.675727593224564*^9, 
   3.67578543490516*^9, 3.675788260830711*^9, 3.6761382097330837`*^9, 
   3.676146369921947*^9, 3.676205570073062*^9, 3.676570768987417*^9}]
}, Open  ]],

Cell["\<\
So then, to first order, the equilibrium haploid genotype frequencies are\
\>", "Text",
 CellChangeTimes->{{3.6757175107821083`*^9, 3.675717533841239*^9}, {
  3.6761417305097446`*^9, 3.676141730843671*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqXAf", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"XAf0", "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXmY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"YA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXmY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675716895475359*^9, 3.675716900512623*^9}, {
  3.675717278127964*^9, 3.675717294591033*^9}, {3.675717351754582*^9, 
  3.675717366375647*^9}, {3.675717543006982*^9, 3.675717544667244*^9}, {
  3.6757178596731443`*^9, 3.675717863093356*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
         RowBox[{"hAm", " ", "sAm"}], "-", 
         RowBox[{"pA", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "sAf"}], "+", "sAm", "-", 
            RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]", "-", 
            RowBox[{"pA", " ", "\[Epsilon]"}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{3.6757169011353207`*^9, 3.6757173669613256`*^9, 
  3.6757175450525827`*^9, 3.675717864205447*^9, 3.675727594742791*^9, 
  3.675785436211323*^9, 3.675788261479598*^9, 3.6761382181729927`*^9, 
  3.67614636998634*^9, 3.676205570138258*^9, 3.6765707690413733`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqXAm", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"XAm0", "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"YA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXfY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675716688271459*^9, 3.6757167143895473`*^9}, {
  3.675716769539331*^9, 3.6757167848745613`*^9}, {3.675716835976749*^9, 
  3.6757168663757353`*^9}, {3.675717219433107*^9, 3.675717236319748*^9}, {
  3.675717303688327*^9, 3.675717309958682*^9}, {3.675717548817417*^9, 
  3.675717549768239*^9}, {3.67571786788925*^9, 3.675717869340398*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pA"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.6757167147918577`*^9, {3.675716770743403*^9, 3.675716785278078*^9}, {
   3.675716840197975*^9, 3.6757168668171043`*^9}, 3.675717236886405*^9, 
   3.675717371726769*^9, 3.675717550116539*^9, 3.675717875403976*^9, 
   3.675727595426388*^9, 3.6757854369665747`*^9, 3.675788263530697*^9, 
   3.6761382197593737`*^9, 3.676146370055738*^9, 3.676205570198845*^9, 
   3.6765707690985727`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqYA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"YA0", "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"YA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfY"}], "/.", 
    "eqdpAXfXm"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675717392424321*^9, 3.675717393210609*^9}, {
  3.675717465498665*^9, 3.675717499551214*^9}, {3.67571755307234*^9, 
  3.675717554018692*^9}, {3.6757178713638563`*^9, 3.675717873545209*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{3.67571750048251*^9, 3.675717554350906*^9, 
  3.675717874008835*^9, 3.675727596078721*^9, 3.6757854378569937`*^9, 
  3.675788264699403*^9, 3.676138221083902*^9, 3.6761463700923843`*^9, 
  3.676205570233659*^9, 3.676570769136858*^9}]
}, Open  ]],

Cell["The change in the equilibrium frequency of A is", "Text",
 CellChangeTimes->{{3.67571806556964*^9, 3.675718103851286*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpA", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"2", " ", "XAfprime"}], "+", "XAmprime", "+", 
                 "YAprime", "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "XAf"}], "-", "XAm", "-", "YA"}], ")"}]}], "/.",
                 "weaksel"}], "/.", 
               RowBox[{"Xaf", "\[Rule]", 
                RowBox[{"1", "-", "XAf"}]}]}], "/.", 
              RowBox[{"Ya", "\[Rule]", 
               RowBox[{"1", "-", "YA"}]}]}], "/.", 
             RowBox[{"Xam", "\[Rule]", 
              RowBox[{"1", "-", "XAm"}]}]}], "/.", 
            RowBox[{"XAf", "\[Rule]", "eqXAf"}]}], "/.", 
           RowBox[{"XAm", "\[Rule]", "eqXAm"}]}], "/.", 
          RowBox[{"YA", "\[Rule]", "eqYA"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
      "/", "4"}], ",", "\[Epsilon]", ",", "Simplify"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675717647887065*^9, 3.675717697126732*^9}, {
   3.675717728154462*^9, 3.675717827465465*^9}, {3.675717886726254*^9, 
   3.6757179766881647`*^9}, {3.675718083857135*^9, 3.6757180905764112`*^9}, 
   3.67571817039502*^9, {3.675719298161072*^9, 3.675719300128034*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"pA", "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
      RowBox[{"hAm", " ", "sAm"}], "-", 
      RowBox[{"pA", " ", 
       RowBox[{"(", 
        RowBox[{"sAf", "+", "sAm", "-", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], ")"}], 
    " ", "\[Epsilon]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675717675625972*^9, 3.675717697744046*^9}, {
   3.675717736995945*^9, 3.675717827905334*^9}, {3.675717912013361*^9, 
   3.6757179770805798`*^9}, {3.675718122247941*^9, 3.675718137314794*^9}, 
   3.675718171232416*^9, {3.675719279665413*^9, 3.6757193043150883`*^9}, 
   3.675727597413587*^9, 3.675785439649287*^9, 3.67578826604628*^9, 
   3.676138226117289*^9, 3.676146370223422*^9, 3.676205570352737*^9, 
   3.676570769261799*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.6757181100991917`*^9, 3.675718119482112*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpA", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dpA", "-", "pA"}], "\[Equal]", "0"}], ",", "pA"}], "]"}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.675717988879238*^9, 3.67571803095448*^9}, {
  3.6757181277583733`*^9, 3.6757181353000813`*^9}, {3.6757192734183817`*^9, 
  3.6757193075868177`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"hAf", " ", "sAf"}], "+", 
        RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
       RowBox[{"sAf", "-", 
        RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
        RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675717995245247*^9, 3.675718031314158*^9}, {
   3.675718129676858*^9, 3.675718138913946*^9}, 3.67571817443064*^9, {
   3.675719281498005*^9, 3.675719308048888*^9}, 3.675727602150854*^9, 
   3.675785444054607*^9, 3.675788267688079*^9, 3.676138228966215*^9, 
   3.6761463703060913`*^9, 3.676205570544559*^9, 3.676570769474367*^9}]
}, Open  ]],

Cell["\<\
Notice that when t=0 we have equation \[OpenCurlyDoubleQuote]avgpASubs\
\[CloseCurlyDoubleQuote] in van Doorn & Kirkpatrick 2007 (SOM page 6). \
Sperm/pollen selection acts to increase the frequency of A (if selected for: \
t>0).\
\>", "Text",
 CellChangeTimes->{{3.675718177833785*^9, 3.6757182794849873`*^9}, {
  3.676138242309498*^9, 3.67613824280681*^9}}],

Cell["\<\
Also notice that, without sperm/pollen competition, the non-trivial \
equilibrium does not exist when there is no sexually antagonistic selection\
\>", "Text",
 CellChangeTimes->{{3.675721309214287*^9, 3.6757213820811357`*^9}, {
  3.6761417488221397`*^9, 3.676141750861703*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"0", "<", "pA"}], "/.", 
       RowBox[{"eqpA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", ">", "pA"}], "/.", 
       RowBox[{"eqpA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "&&", 
    RowBox[{"sAm", ">", "0"}], "&&", 
    RowBox[{"sAf", ">", "0"}], "&&", 
    RowBox[{"hAf", ">", "0"}], "&&", 
    RowBox[{"hAm", ">", "0"}], "&&", 
    RowBox[{"hAf", "<", "1"}], "&&", 
    RowBox[{"hAm", "<", "1"}]}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.675721205546542*^9, 3.6757213041340637`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.6757212132856903`*^9, 3.675721304688283*^9}, 
   3.6757276039667053`*^9, 3.675785445007743*^9, 3.675788269474324*^9, 
   3.676138247485269*^9, 3.6761463703421097`*^9, 3.676205570701029*^9, 
   3.67657076960826*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"0", "<", "pA"}], "/.", 
       RowBox[{"eqpA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", ">", "pA"}], "/.", 
       RowBox[{"eqpA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "&&", 
    RowBox[{"sAm", "<", "0"}], "&&", 
    RowBox[{"sAf", "<", "0"}], "&&", 
    RowBox[{"hAf", ">", "0"}], "&&", 
    RowBox[{"hAm", ">", "0"}], "&&", 
    RowBox[{"hAf", "<", "1"}], "&&", 
    RowBox[{"hAm", "<", "1"}]}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.675721356822701*^9, 3.675721358972645*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.675721359354959*^9, 3.675727604482841*^9, 
  3.67578544579348*^9, 3.675788270629342*^9, 3.6761382489845953`*^9, 
  3.676146370374893*^9, 3.676205570738555*^9, 3.67657076963019*^9}]
}, Open  ]],

Cell["\<\
But with sperm/pollen competition the non-trivial equilirbium can exist, even \
without sexually antagonistic selection\
\>", "Text",
 CellChangeTimes->{{3.6757213615608473`*^9, 3.6757213940767937`*^9}, {
  3.675721438770338*^9, 3.675721440381878*^9}, {3.675721584413671*^9, 
  3.6757215921481323`*^9}, {3.676138261321*^9, 3.676138268712246*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0", "<", "pA"}], "/.", 
      RowBox[{"eqpA", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", ">", "pA"}], "/.", 
      RowBox[{"eqpA", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "&&", 
    RowBox[{"sAm", "<", "0"}], "&&", 
    RowBox[{"sAf", "<", "0"}], "&&", 
    RowBox[{"hAf", ">", "0"}], "&&", 
    RowBox[{"hAm", ">", "0"}], "&&", 
    RowBox[{"hAf", "<", "1"}], "&&", 
    RowBox[{"hAm", "<", "1"}], "&&", 
    RowBox[{"t", ">", "0"}]}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.675721404126423*^9, 3.6757214202988453`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sAm", "<", "0"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sAf", "\[LessEqual]", "sAm"}], "&&", 
      RowBox[{"0", "<", "hAm", "<", "1"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0", "<", "hAf", "<", 
           FractionBox[
            RowBox[{"sAf", "+", "sAm", "-", 
             RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
            RowBox[{"2", " ", "sAf"}]]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
            RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
           RowBox[{
            RowBox[{"-", "sAf"}], "+", 
            RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
            RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"sAf", "+", "sAm", "-", 
             RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
            RowBox[{"2", " ", "sAf"}]], "<", "hAf", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "sAf"}], "+", 
            RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
            RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
            RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], ")"}], "||", 
    
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sAm", "<", "sAf", "<", "0"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0", "<", "hAm", "\[LessEqual]", 
           FractionBox[
            RowBox[{
             RowBox[{"-", "sAf"}], "+", "sAm"}], 
            RowBox[{"2", " ", "sAm"}]]}], "&&", 
          RowBox[{"0", "<", "hAf", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
            RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
           RowBox[{
            RowBox[{"-", "sAf"}], "+", 
            RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
            RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"-", "sAf"}], "+", "sAm"}], 
            RowBox[{"2", " ", "sAm"}]], "<", "hAm", "<", 
           FractionBox[
            RowBox[{"sAf", "+", "sAm"}], 
            RowBox[{"2", " ", "sAm"}]]}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0", "<", "hAf", "<", 
               FractionBox[
                RowBox[{"sAf", "+", "sAm", "-", 
                 RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
                RowBox[{"2", " ", "sAf"}]]}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
                RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
               RowBox[{
                RowBox[{"-", "sAf"}], "+", 
                RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
                RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"sAf", "+", "sAm", "-", 
                 RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
                RowBox[{"2", " ", "sAf"}]], "<", "hAf", "<", "1"}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "sAf"}], "+", 
                RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
                RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
                RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"sAf", "+", "sAm"}], 
            RowBox[{"2", " ", "sAm"}]], "\[LessEqual]", "hAm", "<", "1"}], "&&", 
          RowBox[{"0", "<", "hAf", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "sAf"}], "+", 
            RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
            RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
            RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.675721408263239*^9, 3.675721421048749*^9}, 
   3.675727605660432*^9, 3.675785446857723*^9, 3.675788271626335*^9, 
   3.676138271231243*^9, 3.676146370423925*^9, 3.676205570789567*^9, 
   3.676570769680361*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"pA", "/.", 
          RowBox[{"eqpA", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
         RowBox[{"sAf", "\[Rule]", 
          RowBox[{"-", "s"}]}]}], "/.", 
        RowBox[{"sAm", "\[Rule]", 
         RowBox[{"-", "s"}]}]}], "/.", 
       RowBox[{"hAf", "\[Rule]", "h"}]}], "/.", 
      RowBox[{"hAm", "\[Rule]", "h"}]}], "/.", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{"1", "/", "10"}]}]}], "/.", 
    RowBox[{"h", "\[Rule]", "1"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67572144834195*^9, 3.675721547741859*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwV0HlYjAkAx/GRikh6NKZpipUnzDqSotJqfypCaJNOBqkYrN2KiJERagtT
ikRlUDqUjJnoeNmp7emwelJylA68HdMxNfNuzXZf2/7xfb7/f4x9A1yPqNFo
tN3T/f9UORH8LtL456qbEaNTUxROqC38K5dOA2dytm/RJIVBJk98k64LxUnB
29AJCpvScth8+hLMc7p9b2SUwvfucv8zdDM4q6dYqgYoSAQf1ILom/H+3J+n
OnoosL59qf2d7oK6wyp5VT2Fak0O8RvdB98tDjclPqdAb9ntHV0SiA0DV3iB
XhSCzJPbNGTnMPsfw/J5sygsDr6hqAkIg5IVVOJQoMRo0OGpnNJwMP20Q/N9
lBD9qMNMfheF4vbFrdR8JTzVPzoamEYj+2qI5tFCBZKj9Bl0aSyyXAXNwb4K
DPWYaZsU3cLS/cyDTgsUqPbxmBcqjwcZJhdyXvcizrwzrrkvASzS4tqGE70I
FJYGaVD3wA3YuDyT1YtKgxzOWf1kjBhGXHYv64GuaqqSYgmhqbY9qvJ0D2q/
Htoi2fEQXhp7doca9aBeHCFYVPAIUmtGWUWFHJuM4wo78lPwIN21o/6sHAeS
lsr3VqWibO3nimVL5BgoOX5ga81j+KuqXW1qurGz37KusTMNOz7pCG+EdMOU
ygp1G0uHvWxO4hnjbvyR9MHfdTwD+Wv5m5fXduG+82XXfxc8QeBdqww9XhfY
Etllln4W0qyPFbxhd8GepL6ZMLLRq+XOozd0woAZZvdx5VOcH44cE17pBHey
XKaxJgdhS8zZynWdOK2Iu9m85RmqjizVu9DYAe2smdy7niKsaap+/ii8Ayy9
VWF1ns+hdb1/SLC+Ayr7kzXNlmKwPTiTeV9liP8ovBRbKEbZfltxukCGUKdU
x3wrCU7HNeqZ2spQWn5cV1QiwdF26QZVRzu2MrXHuPa5qAtkzryU0I5lAUFd
qne5uM4iYrahHZuFkkE7lxconHhfXqdoQ6qkzFDt/QuM6aaLJoVt8KtMcojf
9xJX7Yrd/ba14dCrnYKuppeIeOryJGawFa9ExfU6x/JQZc4mBh+0gnNN0yaz
Lw8r5K8vDG1vxcaf2NIZp/Ix0VjRXTTcguA+bQfTiXwwu/UZpSktkPOruo0u
FUBkRiqiXVqQ2X8w8+JkAbye+If00VpQeuIlVxxViG22a4vjskmwXrVvT9ci
IJ4blDvsTWLiojpLNpeA/TppTawXCdLOpMdEh8AnDy0F25NExlu/6LQFBEZS
UlZ4u5GwaGitfWxIwM76w33CmcSuYXJf6hoCtf4WkTwHEhctv558uIdAv3Rg
//hqEj6j47bf9xIIb7M7H7+KxJYio/k/eBBgaMUkrF5JYo4jR/JgHwEbt+W1
nBUkEtybBoR+BK7KPRylxiREwQ38+2cI0PULzfgMEnHWI780hxDI2KTuzFhI
InicaWzEI2Dt6/KrSI+ETbhXaTKfAOdZV/o3XRJvbtfPSo4kkOZgYIi5JLI9
h740XiNgefyIdb0WiRhD/WyWgMDfMRL3gNkk3B577EqKJdDbsCP2oQYJK+7Z
RY23CPCn7jyzUp/2W5WgNLhDQHdZa2WN2rSfMq/Y+y6BVCfTLu6Mab/cz7GJ
iQTWB/I0aDQS/wFx+WwU
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.5},
  Method->{},
  PlotRange->NCache[{{0, 
      Rational[1, 10]}, {0.5000000102040816, 0.9999999897959184}}, {{
     0, 0.1}, {0.5000000102040816, 0.9999999897959184}}],
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{{3.675721496083349*^9, 3.675721548166576*^9}, 
   3.675727607864105*^9, 3.6757882735873823`*^9, 3.676138275405953*^9, 
   3.676146370457938*^9, 3.6762055709353447`*^9, 3.676570769803804*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Special case", "Subsection",
 CellChangeTimes->{{3.676141114894979*^9, 3.676141116947991*^9}}],

Cell["\<\
Note that when there are no sex differences in selection\
\>", "Text",
 CellChangeTimes->{{3.676141122876837*^9, 3.676141146610197*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subPAS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FAA", "\[Rule]", "WAA"}], ",", 
     RowBox[{"FAa", "\[Rule]", "WAa"}], ",", 
     RowBox[{"Faa", "\[Rule]", "Waa"}], ",", 
     RowBox[{"MAA", "\[Rule]", "WAA"}], ",", 
     RowBox[{"MAa", "\[Rule]", "WAa"}], ",", 
     RowBox[{"Maa", "\[Rule]", "Waa"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.67578767630304*^9, 3.675787702421009*^9}}],

Cell["\<\
and recombination between the autosomal and sex-determining locus is free, \
the equilibirum condtions become\
\>", "Text",
 CellChangeTimes->{{3.676141153795107*^9, 3.676141188484377*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqsPAS", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XAfprime", "-", "XAf"}], ",", "\[IndentingNewLine]", 
       RowBox[{"XAmprime", "-", "XAm"}], ",", "\[IndentingNewLine]", 
       RowBox[{"YAprime", "-", "YA"}]}], "\[IndentingNewLine]", "}"}], "/.", 
     "subPAS"}], "/.", 
    RowBox[{"r", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675787718650551*^9, 3.675787723701189*^9}, {
  3.675787963351767*^9, 3.675787964383904*^9}, {3.67578822894055*^9, 
  3.675788231642598*^9}}],

Cell["\<\
Using the fact that the freqeuencies of A and a must sum to one in each \
gamete type\
\>", "Text",
 CellChangeTimes->{{3.6761411924078703`*^9, 3.6761412091788597`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subRes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Xaf", "\[Rule]", 
      RowBox[{"1", "-", "XAf"}]}], ",", 
     RowBox[{"Xam", "\[Rule]", 
      RowBox[{"1", "-", "XAm"}]}], ",", 
     RowBox[{"Ya", "\[Rule]", 
      RowBox[{"1", "-", "YA"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675787741056987*^9, 3.675787766946458*^9}}],

Cell["\<\
we can directly solve for the equilibrium frequencies without assuming weak \
selection\
\>", "Text",
 CellChangeTimes->{{3.67614121677299*^9, 3.676141226410625*^9}, {
  3.6761417749056*^9, 3.676141775510998*^9}, {3.676141820439823*^9, 
  3.67614184300416*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"differenceEqsPAS", "/.", "subRes"}], ")"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"XAf", ",", "XAm", ",", "YA"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6757879734470587`*^9, 3.6757879843428593`*^9}, 
   3.675788281517105*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", "0"}], ",", 
     RowBox[{"XAm", "\[Rule]", "0"}], ",", 
     RowBox[{"YA", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", "1"}], ",", 
     RowBox[{"XAm", "\[Rule]", "1"}], ",", 
     RowBox[{"YA", "\[Rule]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "wa", " ", "Waa"}], "-", 
        RowBox[{"wa", " ", "WAa"}], "-", 
        RowBox[{"wA", " ", "WAa"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wa", " ", "Waa"}], "-", 
          RowBox[{"wa", " ", "WAa"}], "-", 
          RowBox[{"wA", " ", "WAa"}], "+", 
          RowBox[{"wA", " ", "WAA"}]}], ")"}]}]]}], ",", 
     RowBox[{"XAm", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "wa", " ", "Waa"}], "-", 
        RowBox[{"wa", " ", "WAa"}], "-", 
        RowBox[{"wA", " ", "WAa"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wa", " ", "Waa"}], "-", 
          RowBox[{"wa", " ", "WAa"}], "-", 
          RowBox[{"wA", " ", "WAa"}], "+", 
          RowBox[{"wA", " ", "WAA"}]}], ")"}]}]]}], ",", 
     RowBox[{"YA", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "wa", " ", "Waa"}], "-", 
        RowBox[{"wa", " ", "WAa"}], "-", 
        RowBox[{"wA", " ", "WAa"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wa", " ", "Waa"}], "-", 
          RowBox[{"wa", " ", "WAa"}], "-", 
          RowBox[{"wA", " ", "WAa"}], "+", 
          RowBox[{"wA", " ", "WAA"}]}], ")"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675787986587545*^9, 3.675788283645953*^9, 
  3.6761383296719847`*^9, 3.6761463717663927`*^9, 3.676205572159783*^9, 
  3.6765707710972853`*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Stability of autosomal polymorphism in the resident\
\>", "Section",
 CellChangeTimes->{{3.675728118153309*^9, 3.6757281301025343`*^9}, {
  3.6761383443022337`*^9, 3.676138346514113*^9}, {3.676141241053759*^9, 
  3.676141300578786*^9}}],

Cell["\<\
Here we examine when the polymorphism on the autosomal locus (i.e., the \
non-trivial equilibrium frequency of A derived above) is stable. We do this \
not by examining the stability of the polymorphic equilibrium itself, but \
instead by checking when the fixation of A and a are unstable (which is \
mathematically easier). \
\>", "Text",
 CellChangeTimes->{{3.676138378119439*^9, 3.676138435872447*^9}, {
  3.676138707706851*^9, 3.676138730883357*^9}, {3.676138835861014*^9, 
  3.676138938757375*^9}}],

Cell["\<\
We will use the fact that the frequencies of A and a in each gamete type sum \
to one\
\>", "Text",
 CellChangeTimes->{{3.676138744905406*^9, 3.676138768462101*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subRes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Xaf", "\[Rule]", 
      RowBox[{"1", "-", "XAf"}]}], ",", 
     RowBox[{"Xam", "\[Rule]", 
      RowBox[{"1", "-", "XAm"}]}], ",", 
     RowBox[{"Ya", "\[Rule]", 
      RowBox[{"1", "-", "YA"}]}]}], "}"}]}], ";"}]], "Input"],

Cell["The Jacobian is", "Text",
 CellChangeTimes->{{3.676138776598105*^9, 3.676138803470117*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"matIntFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "XAf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "Xaf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "XAm"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "Xam"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "YA"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "Ya"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], "/.", "subRes"}], "//", 
    "Factor"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"MatrixForm", "[", "%", "]"}], ";"}]}], "Input",
 CellChangeTimes->{{3.6757908602069187`*^9, 3.675790921689528*^9}, 
   3.676138807897334*^9}],

Cell["\<\
Giving characteristic polynomial\
\>", "Text",
 CellChangeTimes->{{3.6761388139173317`*^9, 3.67613881981981*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyIntFull", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matIntFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "6", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675790963788534*^9, 3.6757909758461533`*^9}}],

Cell[CellGroupData[{

Cell["When A is fixed", "Subsection",
 CellChangeTimes->{{3.6761393314598627`*^9, 3.67613934706905*^9}}],

Cell["\<\
When A is fixed the characteristic polynomial becomes\
\>", "Text",
 CellChangeTimes->{{3.6761389476929903`*^9, 3.6761389553617764`*^9}, {
  3.676141857627771*^9, 3.676141864276424*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyInt1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"charpolyIntFull", "/.", 
      RowBox[{"XAf", "\[Rule]", "1"}]}], "/.", 
     RowBox[{"XAm", "\[Rule]", "1"}]}], "/.", 
    RowBox[{"YA", "\[Rule]", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675789475257841*^9, 3.675789495224863*^9}, {
   3.675790419784018*^9, 3.675790436109337*^9}, {3.675790707473653*^9, 
   3.6757907121912107`*^9}, 3.675790981141562*^9}],

Cell["\<\
With no selection the eigenvalues are\
\>", "Text",
 CellChangeTimes->{{3.67613895976469*^9, 3.676138986050075*^9}, {
  3.676141868265463*^9, 3.6761418692203836`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyInt1", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.675790438158463*^9, 3.675790490819627*^9}, 
   3.6757907161064987`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "r"}], "-", 
        SqrtBox[
         RowBox[{"9", "-", 
          RowBox[{"20", " ", "r"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "r"}], "+", 
        SqrtBox[
         RowBox[{"9", "-", 
          RowBox[{"20", " ", "r"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675790470203415*^9, 3.67579049112579*^9}, 
   3.675790716637494*^9, 3.675790762410632*^9, 3.675790984892763*^9, 
   3.676139533177137*^9, 3.676146376887926*^9, 3.676205575382392*^9, 
   3.676570774205508*^9}]
}, Open  ]],

Cell["\<\
Notice that since 0<=r<=1/2 the leading eigenvalue is 1 when there is no \
selection. \
\>", "Text",
 CellChangeTimes->{{3.6761390077177687`*^9, 3.67613902111056*^9}, {
  3.676139087582918*^9, 3.6761390941029663`*^9}, {3.676139137841057*^9, 
  3.67613918635388*^9}}],

Cell["\<\
Now assuming weak selection and looking at only the first order term, we have\
\
\>", "Text",
 CellChangeTimes->{{3.676139191171813*^9, 3.6761392207611322`*^9}, {
  3.6761418863895597`*^9, 3.676141887728991*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"charpolyInt1", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Lambda]", "\[Rule]", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"A\[Lambda]1", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}], "//",
    "Flatten"}]}]}], "Input",
 CellChangeTimes->{{3.6757905419305773`*^9, 3.67579059667633*^9}, {
  3.6757909951816072`*^9, 3.6757909952509527`*^9}, {3.6761395269142036`*^9, 
  3.6761395297245483`*^9}, {3.676139564945251*^9, 3.6761395660688667`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "sAf"}], "+", 
      RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
      RowBox[{"hAm", " ", "sAm"}], "-", "t"}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675790543416122*^9, 3.675790597173519*^9}, {
   3.675790990374691*^9, 3.675790995487912*^9}, 3.676139534428669*^9, 
   3.676139566428748*^9, 3.6761463769196033`*^9, 3.6762055754219503`*^9, 
   3.676570774233367*^9}]
}, Open  ]],

Cell["\<\
So, combining zero and first order terms, the leading eigenvalue is 1 plus \
this amount, and thus the fixation of A is unstable when this amount is \
positive.\
\>", "Text",
 CellChangeTimes->{{3.676139227763835*^9, 3.676139272023695*^9}, {
  3.6761393086529617`*^9, 3.676139312401525*^9}, {3.67614190203433*^9, 
  3.6761419040224867`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["When a is fixed", "Subsection",
 CellChangeTimes->{{3.676139354800459*^9, 3.676139360015429*^9}}],

Cell["\<\
When a is fixed the characteristic polynomial becomes\
\>", "Text",
 CellChangeTimes->{{3.676139366499325*^9, 3.676139381084874*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyInt0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"charpolyIntFull", "/.", 
      RowBox[{"XAf", "\[Rule]", "0"}]}], "/.", 
     RowBox[{"XAm", "\[Rule]", "0"}]}], "/.", 
    RowBox[{"YA", "\[Rule]", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675789475257841*^9, 3.675789495224863*^9}, {
   3.675790419784018*^9, 3.675790436109337*^9}, {3.675790707473653*^9, 
   3.6757907121912107`*^9}, 3.675790981141562*^9, {3.675791011580246*^9, 
   3.6757910160572977`*^9}}],

Cell["\<\
With no selection the eigenvalues are \
\>", "Text",
 CellChangeTimes->{{3.676139384691824*^9, 3.676139394575325*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyInt0", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.675790438158463*^9, 3.675790490819627*^9}, 
   3.6757907161064987`*^9, {3.675791021778805*^9, 3.6757910218818493`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "r"}], "-", 
        SqrtBox[
         RowBox[{"9", "-", 
          RowBox[{"20", " ", "r"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "r"}], "+", 
        SqrtBox[
         RowBox[{"9", "-", 
          RowBox[{"20", " ", "r"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675790470203415*^9, 3.67579049112579*^9}, 
   3.675790716637494*^9, 3.675790762410632*^9, 3.675790984892763*^9, {
   3.675791022931171*^9, 3.6757910250816393`*^9}, {3.676139508927347*^9, 
   3.676139512044609*^9}, 3.676146377003367*^9, 3.676205575483843*^9, 
   3.6765707742930593`*^9}]
}, Open  ]],

Cell["\<\
And with 0<=r<=1/2 the leading eigenvalue is 1.\
\>", "Text",
 CellChangeTimes->{{3.6761393979525213`*^9, 3.676139408520269*^9}}],

Cell["\<\
With weak selection the first order term is\
\>", "Text",
 CellChangeTimes->{{3.6761394133891993`*^9, 3.676139420869144*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"charpolyInt0", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Lambda]", "\[Rule]", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"a\[Lambda]1", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}], "//",
    "Flatten"}]}]}], "Input",
 CellChangeTimes->{{3.6757905419305773`*^9, 3.67579059667633*^9}, {
  3.6757909951816072`*^9, 3.6757909952509527`*^9}, {3.675791030843678*^9, 
  3.6757910309227667`*^9}, {3.676139481263156*^9, 3.676139523288122*^9}, {
  3.676139559560701*^9, 3.676139561179578*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAf", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675799455916547*^9, {3.676139499027871*^9, 3.676139524178032*^9}, 
   3.676139562179957*^9, 3.6761463770410547`*^9, 3.6762055755319023`*^9, 
   3.6765707743369913`*^9}]
}, Open  ]],

Cell["\<\
So the fixation of a is unstable when this is positive.\
\>", "Text",
 CellChangeTimes->{{3.676139429367836*^9, 3.676139446633391*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Stability of polymorphism", "Subsection",
 CellChangeTimes->{{3.676139467473007*^9, 3.676139472363806*^9}}],

Cell["\<\
We have a protected polymorphism on the autosomal locus in the resident \
population when both the fixation and loss of A is unstable, which requires \
that\
\>", "Text",
 CellChangeTimes->{{3.67579927992915*^9, 3.675799368289077*^9}, {
  3.676139648544547*^9, 3.676139649767795*^9}, {3.676139827572402*^9, 
  3.676139827844163*^9}, {3.676141926847138*^9, 3.676141960576277*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0", "<", "\[Delta]\[Lambda]1"}], "/.", "A\[Lambda]1"}], ")"}], 
    "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0", "<", "\[Delta]\[Lambda]1"}], "/.", "a\[Lambda]1"}], 
     ")"}]}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.6761395397423983`*^9, 3.6761395917114067`*^9}, {
  3.676139627647233*^9, 3.676139632491366*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sAm", "<", "0"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", "<", "0"}], "&&", 
        RowBox[{"hAf", "<", 
         FractionBox[
          RowBox[{"sAf", "+", "sAm", "-", 
           RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
          RowBox[{"2", " ", "sAf"}]]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
          RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAf"}], "+", 
          RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
          RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", "\[Equal]", "0"}], "&&", 
        RowBox[{"hAm", "<", 
         FractionBox["1", "2"]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "hAm"}], " ", "sAm"}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAm"}], "+", 
          RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", ">", "0"}], "&&", 
        RowBox[{"hAf", ">", 
         FractionBox[
          RowBox[{"sAf", "+", "sAm", "-", 
           RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
          RowBox[{"2", " ", "sAf"}]]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
          RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAf"}], "+", 
          RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
          RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], ")"}], "||", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sAm", "\[Equal]", "0"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", "<", "0"}], "&&", 
        RowBox[{"hAf", "<", 
         FractionBox["1", "2"]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "hAf"}], " ", "sAf"}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAf"}], "+", 
          RowBox[{"hAf", " ", "sAf"}]}]}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", ">", "0"}], "&&", 
        RowBox[{"hAf", ">", 
         FractionBox["1", "2"]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "hAf"}], " ", "sAf"}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAf"}], "+", 
          RowBox[{"hAf", " ", "sAf"}]}]}]}], ")"}]}], ")"}]}], ")"}], "||", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"sAm", ">", "0"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", "<", "0"}], "&&", 
        RowBox[{"hAf", "<", 
         FractionBox[
          RowBox[{"sAf", "+", "sAm", "-", 
           RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
          RowBox[{"2", " ", "sAf"}]]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
          RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAf"}], "+", 
          RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
          RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", "\[Equal]", "0"}], "&&", 
        RowBox[{"hAm", ">", 
         FractionBox["1", "2"]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "hAm"}], " ", "sAm"}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAm"}], "+", 
          RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"sAf", ">", "0"}], "&&", 
        RowBox[{"hAf", ">", 
         FractionBox[
          RowBox[{"sAf", "+", "sAm", "-", 
           RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
          RowBox[{"2", " ", "sAf"}]]}], "&&", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
          RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
         RowBox[{
          RowBox[{"-", "sAf"}], "+", 
          RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
          RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.67613954957887*^9, 3.676139592108487*^9}, 
   3.676139632951249*^9, 3.676146377101157*^9, 3.676205575643641*^9, 
   3.676570774425644*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Life-cycle with rare neo-y ", "Section",
 CellChangeTimes->{{3.6756910197792797`*^9, 3.675691024113359*^9}, {
  3.67569412935745*^9, 3.6756941314240303`*^9}, {3.675707349839982*^9, 
  3.675707351884247*^9}, {3.675709974013658*^9, 3.675709982915987*^9}, {
  3.6757923469668207`*^9, 3.675792350124728*^9}, {3.6761413144270782`*^9, 
  3.676141323737258*^9}}],

Cell["\<\
We now re-do the previous analyses with a rare dominant (to the X) \
masculinizing mutation at a new locus y. Let XAym be the frequency of A in \
X-bearing pollen/sperm with this new mutation, YAy be the frequency of A in \
Y-bearing pollen/sperm with this new mutation, and XAyf be the frequency of A \
in female gametes with this new mutation (this can only happen if the y \
mutation happened after haploids produced by diploid; otherwise the y \
mutation would have made the diploid male). Then, after haploid selection, \
the frequencies of gamete types from each sex are\
\>", "Text",
 CellChangeTimes->{{3.676139972803225*^9, 3.676140015442719*^9}, {
  3.676140067615103*^9, 3.6761401130152693`*^9}, {3.676140143529172*^9, 
  3.676140252405312*^9}, {3.6761402854946823`*^9, 3.676140443857773*^9}, {
  3.6761408620376587`*^9, 3.6761409078419228`*^9}, {3.6761413394238453`*^9, 
  3.676141368941441*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wbarHap", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"wA", " ", "XAm"}], "+", 
      RowBox[{"wa", " ", "Xam"}], "+", 
      RowBox[{"wA", " ", "XAym"}], "+", 
      RowBox[{"wa", " ", "Xaym"}]}], ")"}], "+", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"wA", " ", "YA"}], "+", 
      RowBox[{"wa", " ", "Ya"}], "+", 
      RowBox[{"wA", " ", "YAy"}], "+", 
      RowBox[{"wa", " ", "Yay"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAms", "=", 
   RowBox[{"wA", " ", 
    RowBox[{"XAm", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xams", "=", 
   RowBox[{"wa", " ", 
    RowBox[{"Xam", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyms", "=", 
   RowBox[{"wA", " ", 
    RowBox[{"XAym", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xayms", "=", 
   RowBox[{"wa", " ", 
    RowBox[{"Xaym", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAs", "=", " ", 
   RowBox[{"wA", "*", 
    RowBox[{"YA", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yas", "=", " ", 
   RowBox[{"wa", "*", 
    RowBox[{"Ya", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAys", "=", " ", 
   RowBox[{"wA", "*", 
    RowBox[{"YAy", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yays", "=", " ", 
   RowBox[{"wa", "*", 
    RowBox[{"Yay", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAfs", "=", "XAf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xafs", "=", "Xaf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyfs", "=", "XAyf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xayfs", "=", "Xayf"}], ";"}]}], "Input",
 CellChangeTimes->{{3.675887851245193*^9, 3.675887867834023*^9}}],

Cell["\<\
Check that frequencies of gametes types from each sex sum to one after \
haploid selection:\
\>", "Text",
 CellChangeTimes->{{3.675691241028049*^9, 3.675691262904736*^9}, {
   3.675691499842326*^9, 3.675691508954028*^9}, {3.6757021446730413`*^9, 
   3.6757021466313477`*^9}, 3.67570266834774*^9, {3.675710454342794*^9, 
   3.675710458811872*^9}, {3.675711308941972*^9, 3.6757113347037287`*^9}, {
   3.676140458259473*^9, 3.676140486907097*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{
   "XAms", "+", "Xams", "+", "YAs", "+", "Yas", "+", "XAyms", "+", "Xayms", 
    "+", "YAys", "+", "Yays"}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAfs", "+", "Xafs"}]}], "/.", 
  RowBox[{"Xaf", "\[Rule]", 
   RowBox[{"1", "-", "XAf"}]}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{"XAyfs", "+", "Xayfs"}]}], "/.", 
   RowBox[{"Xayf", "\[Rule]", 
    RowBox[{"1", "-", "XAyf"}]}]}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.6757273549842978`*^9, 3.675727390607794*^9}, {
  3.6757276397063427`*^9, 3.6757276468903522`*^9}, {3.675792572534343*^9, 
  3.675792597101988*^9}, {3.676140688447962*^9, 3.6761407315736322`*^9}, {
  3.676146394147027*^9, 3.676146426184784*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, {
   3.675792579770925*^9, 3.675792597332528*^9}, 3.6758682510725803`*^9, 
   3.675884051627248*^9, 3.67588787251865*^9, 3.675894802110652*^9, 
   3.67614048941061*^9, {3.6761463884044867`*^9, 3.676146426505209*^9}, 
   3.6765707744706497`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, {
   3.675792579770925*^9, 3.675792597332528*^9}, 3.6758682510725803`*^9, 
   3.675884051627248*^9, 3.67588787251865*^9, 3.675894802110652*^9, 
   3.67614048941061*^9, {3.6761463884044867`*^9, 3.676146426505209*^9}, 
   3.676570774473177*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, {
   3.675792579770925*^9, 3.675792597332528*^9}, 3.6758682510725803`*^9, 
   3.675884051627248*^9, 3.67588787251865*^9, 3.675894802110652*^9, 
   3.67614048941061*^9, {3.6761463884044867`*^9, 3.676146426505209*^9}, 
   3.676570774476101*^9}]
}, Open  ]],

Cell["\<\
After random mating, the frequencies of the diploid genotypes in each sex are\
\
\>", "Text",
 CellChangeTimes->{{3.675646094888542*^9, 3.675646099390658*^9}, {
  3.675646217785323*^9, 3.675646250704771*^9}, {3.67570268816877*^9, 
  3.6757027045136023`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAXA", "=", 
   RowBox[{"XAfs", " ", "XAms"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXa", "=", 
   RowBox[{
    RowBox[{"XAfs", " ", "Xams"}], "+", 
    RowBox[{"Xafs", " ", "XAms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaXa", "=", 
   RowBox[{"Xafs", " ", "Xams"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646256909181*^9, 3.675646272815617*^9}, {
   3.675646370257011*^9, 3.67564637079287*^9}, {3.675646404699778*^9, 
   3.675646517567526*^9}, {3.675646573911735*^9, 3.675646591557143*^9}, {
   3.675646627619878*^9, 3.67564663177063*^9}, {3.675646667841331*^9, 
   3.675646747122738*^9}, {3.675691396390801*^9, 3.675691472391663*^9}, {
   3.675691536695323*^9, 3.675691538414453*^9}, {3.675691639085917*^9, 
   3.675691650195237*^9}, {3.675691682513646*^9, 3.675691696533524*^9}, {
   3.675691755294464*^9, 3.6756917629827957`*^9}, {3.675691824386702*^9, 
   3.675691852603437*^9}, {3.675692700413486*^9, 3.675692712195026*^9}, {
   3.67569296671769*^9, 3.675692967464675*^9}, {3.6756930389284983`*^9, 
   3.675693095368285*^9}, {3.675693137308187*^9, 3.675693184356132*^9}, {
   3.675693221908244*^9, 3.6756932234970217`*^9}, {3.675693268122773*^9, 
   3.675693270392726*^9}, {3.675693410576119*^9, 3.675693460007984*^9}, {
   3.675693492300033*^9, 3.675693533360964*^9}, 3.675693600152028*^9, {
   3.675702177145516*^9, 3.675702196152766*^9}, {3.6757023129704742`*^9, 
   3.675702317051364*^9}, {3.675792623150811*^9, 3.675792640133086*^9}, {
   3.675792682078307*^9, 3.675792755658676*^9}}],

Cell["XX males (with a y)", "Text",
 CellChangeTimes->{{3.6757974445260983`*^9, 3.675797448757401*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAyXA", "=", 
   RowBox[{
    RowBox[{"XAyfs", " ", "XAms"}], "+", 
    RowBox[{"XAfs", " ", "XAyms"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXa", "=", 
   RowBox[{
    RowBox[{"XAyfs", " ", "Xams"}], "+", 
    RowBox[{"Xafs", " ", "XAyms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXay", "=", 
   RowBox[{
    RowBox[{"XAfs", " ", "Xayms"}], "+", 
    RowBox[{"Xayfs", " ", "XAms"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayXa", "=", 
   RowBox[{
    RowBox[{"Xayfs", " ", "Xams"}], "+", 
    RowBox[{"Xafs", " ", "Xayms"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXAy", "=", 
   RowBox[{"XAyfs", " ", "XAyms"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXay", "=", 
   RowBox[{
    RowBox[{"XAyfs", " ", "Xayms"}], "+", 
    RowBox[{"Xayfs", " ", "XAyms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayXay", "=", 
   RowBox[{"Xayfs", " ", "Xayms"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.67579276899787*^9, 3.675792796547286*^9}, {
  3.675792831210906*^9, 3.675792870802402*^9}}],

Cell["All other male types (can also carry y)", "Text",
 CellChangeTimes->{{3.675797452436947*^9, 3.675797460469445*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAYA", "=", 
   RowBox[{"XAfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYa", "=", 
   RowBox[{"XAfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYA", "=", 
   RowBox[{"Xafs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaYa", "=", 
    RowBox[{"Xafs", " ", "Yas"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYA", "=", 
   RowBox[{"XAyfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYa", "=", 
   RowBox[{"XAyfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayYA", "=", 
   RowBox[{"Xayfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XayYa", "=", 
    RowBox[{"Xayfs", " ", "Yas"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYAy", "=", 
   RowBox[{"XAfs", " ", "YAys"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYay", "=", 
   RowBox[{"XAfs", " ", "Yays"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYAy", "=", 
   RowBox[{"Xafs", " ", "YAys"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaYay", "=", 
    RowBox[{"Xafs", " ", "Yays"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYAy", "=", 
   RowBox[{"XAyfs", " ", "YAys"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYay", "=", 
   RowBox[{"XAyfs", " ", "Yays"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayYAy", "=", 
   RowBox[{"Xayfs", " ", "YAys"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayYay", "=", 
   RowBox[{"Xayfs", " ", "Yays"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675792946078992*^9, 3.6757930106965427`*^9}, {
  3.675793058926154*^9, 3.675793101198822*^9}}],

Cell["\<\
After diploid selection (which can differ between males and females) the \
frequencies of the diploid genotypes in each sex are\
\>", "Text",
 CellChangeTimes->{{3.6756467552456417`*^9, 3.67564676342205*^9}, {
  3.675702725992881*^9, 3.67570275267984*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wbarF", "=", 
   RowBox[{
    RowBox[{"FAA", " ", "XAXA"}], "+", 
    RowBox[{"FAa", " ", "XAXa"}], "+", 
    RowBox[{"Faa", " ", "XaXa"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXAs", "=", 
   RowBox[{"FAA", " ", 
    RowBox[{"XAXA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXas", "=", 
   RowBox[{"FAa", " ", 
    RowBox[{"XAXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaXas", "=", 
    RowBox[{"Faa", " ", 
     RowBox[{"XaXa", "/", "wbarF"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wbarM", "=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MAA", " ", "XAyXA"}], "+", 
     RowBox[{"MAa", 
      RowBox[{"(", 
       RowBox[{"XAyXa", "+", "XAXay"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XayXa"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAyXAy"}], "+", 
     RowBox[{"MAa", " ", "XAyXay"}], "+", 
     RowBox[{"Maa", " ", "XayXay"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAYA"}], "+", 
     RowBox[{"MAa", " ", 
      RowBox[{"(", 
       RowBox[{"XAYa", "+", "XaYA"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XaYa"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAyYA"}], "+", 
     RowBox[{"MAa", 
      RowBox[{"(", 
       RowBox[{"XAyYa", "+", "XayYA"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XayYa"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAYAy"}], "+", 
     RowBox[{"MAa", 
      RowBox[{"(", 
       RowBox[{"XAYay", "+", "XaYAy"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XaYay"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAyYAy"}], "+", 
     RowBox[{"MAa", 
      RowBox[{"(", 
       RowBox[{"XAyYay", "+", "XayYAy"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XayYay"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"the", " ", "XY", " ", "males"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XaYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaYas", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XaYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
   "XYy", " ", "males", " ", "that", " ", "would", " ", "have", " ", "been", 
    " ", "males", " ", "anyway"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAyYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayYAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XayYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XayYas", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XayYa", "/", "wbarM"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYAys", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAYAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYays", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAYay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYAys", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XaYAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaYays", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XaYay", "/", "wbarM"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYAys", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyYAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYays", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAyYay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayYAys", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XayYAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XayYays", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XayYay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{
    RowBox[{"the", " ", "XXy", " ", "males"}], ",", " ", 
    RowBox[{"extra", " ", "males", " ", "created", " ", "by", " ", "neoY"}]}],
    "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyXA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAyXa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXays", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAXay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XayXas", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XayXa", "/", "wbarM"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXAys", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyXAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXays", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAyXay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayXays", "=", 
   RowBox[{"Maa", " ", 
    RowBox[{"XayXay", "/", "wbarM"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646788099258*^9, 3.675646827315172*^9}, {
   3.675646906255657*^9, 3.6756471746197577`*^9}, {3.6756477305962267`*^9, 
   3.675647791098443*^9}, {3.675693609968581*^9, 3.6756936401475143`*^9}, {
   3.675702773030509*^9, 3.675702825109133*^9}, {3.6757958668524837`*^9, 
   3.675796079670739*^9}, {3.675796179417987*^9, 3.675796260462306*^9}, {
   3.675796480404418*^9, 3.675796481420582*^9}, {3.675796553441423*^9, 
   3.67579667834494*^9}, {3.6757967212634993`*^9, 3.67579673565335*^9}, {
   3.675796766370957*^9, 3.675796913595641*^9}, {3.675796952452533*^9, 
   3.675796955994008*^9}, {3.6757970625420837`*^9, 3.675797062966584*^9}, {
   3.675797156973634*^9, 3.675797157898295*^9}, {3.675797509731503*^9, 
   3.6757975122266283`*^9}, 3.6757987828785143`*^9, {3.675798997687969*^9, 
   3.675798999203364*^9}}],

Cell["\<\
Check that frequencies of diploid genotypes in each sex sum to one after \
diploid selection:\
\>", "Text",
 CellChangeTimes->{{3.67569367511821*^9, 3.6756936990142593`*^9}, {
  3.675702840764554*^9, 3.675702847452877*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAXAs", "+", "XAXas", "+", "XaXas"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "\[Equal]", 
   RowBox[{"(", 
    RowBox[{
    "XAyXAs", "+", "XAyXas", "+", "XAXays", "+", "XayXas", "+", 
     "\[IndentingNewLine]", "XAyXAys", "+", "XAyXays", "+", "XayXays", "+", 
     "\[IndentingNewLine]", "XAYAs", "+", "XAYas", "+", "XaYAs", "+", "XaYas",
      "+", "\[IndentingNewLine]", "XAyYAs", "+", "XAyYas", "+", "XayYAs", "+",
      "XayYas", "+", "\[IndentingNewLine]", "XAYAys", "+", "XAYays", "+", 
     "XaYAys", "+", "XaYays", "+", "\[IndentingNewLine]", "XAyYAys", "+", 
     "XAyYays", "+", "XayYAys", "+", "XayYays"}], ")"}]}], "//", 
  "Factor"}]}], "Input",
 CellChangeTimes->{{3.67569371292774*^9, 3.675693719435033*^9}, {
  3.675702830827154*^9, 3.675702835546769*^9}, {3.67570296812504*^9, 
  3.675702969573578*^9}, {3.675797014550261*^9, 3.675797032376533*^9}, {
  3.6757970695377398`*^9, 3.675797081268633*^9}, {3.6757973986437397`*^9, 
  3.6757974173271914`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9, 3.675727555437428*^9, 
   3.6757852556150913`*^9, 3.6757854222905197`*^9, 3.675797082754839*^9, 
   3.6757971609091988`*^9, {3.675797400992137*^9, 3.675797417649136*^9}, 
   3.675799061857813*^9, 3.675868267413929*^9, 3.675884064066042*^9, 
   3.6758879080912523`*^9, 3.675894820235918*^9, 3.676570774591288*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9, 3.675727555437428*^9, 
   3.6757852556150913`*^9, 3.6757854222905197`*^9, 3.675797082754839*^9, 
   3.6757971609091988`*^9, {3.675797400992137*^9, 3.675797417649136*^9}, 
   3.675799061857813*^9, 3.675868267413929*^9, 3.675884064066042*^9, 
   3.6758879080912523`*^9, 3.675894820235918*^9, 3.676570774664179*^9}]
}, Open  ]],

Cell["\<\
NOTICE THAT, the frequency of all males after diploid selection sums to 1. \
There are both XX (with y) and XY males. For this reason I\[CloseCurlyQuote]m \
not sure we can make the frequencies of X and Y pollen/sperm both sum to 1. \
Rather, I changed the pollen/sperm production so that the total of X and Y \
pollen/sperm sum to 1. \
\>", "Text",
 CellChangeTimes->{{3.675897937055571*^9, 3.675898112308852*^9}}],

Cell["\<\
Finally, meiosis occurs, giving the haploid frequencies at the start of the \
next generation\
\>", "Text",
 CellChangeTimes->{{3.675647183205927*^9, 3.675647193439426*^9}, {
  3.675702857268779*^9, 3.6757029057817707`*^9}}],

Cell["Next, eggs/ovules are produced by females. ", "Text",
 CellChangeTimes->{{3.5358035703823357`*^9, 3.5358035880216312`*^9}, {
   3.540035348335928*^9, 3.540035358302086*^9}, {3.674493953287428*^9, 
   3.674494012419855*^9}, 3.675799601278284*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAfprime", "=", 
   RowBox[{"XAXAs", "+", 
    RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xafprime", "=", 
   RowBox[{"XaXas", "+", 
    RowBox[{"XAXas", "/", "2"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675799680833715*^9, 3.6757996941412067`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAfprime", "+", "Xafprime"}]}], "//", "Factor"}]], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6757998422199907`*^9, 3.6758682703443737`*^9, 
  3.675884066601346*^9, 3.67588414320271*^9, 3.675887913157668*^9, 
  3.6758948233446608`*^9, 3.676570774735321*^9}]
}, Open  ]],

Cell["\<\
NOTE: I have put the \[Alpha] (fraction of Y pollen/sperm produced by a male \
here)\
\>", "Text",
 CellChangeTimes->{{3.675897890026724*^9, 3.675897934647752*^9}, {
  3.675898124052725*^9, 3.675898124931974*^9}}],

Cell["\<\
r is the recombination rate between A and Y
R is the recombination rate between y and A
\[Chi] is the recombination rate between y and Y \
\>", "Text",
 CellChangeTimes->{{3.540035437149768*^9, 3.54003544478056*^9}, {
   3.540035542732253*^9, 3.540035542939846*^9}, 3.5400356972463627`*^9, {
   3.540035923604535*^9, 3.540036040586349*^9}, {3.540036213760168*^9, 
   3.540036242159268*^9}, {3.540036754700008*^9, 3.540036803790543*^9}, {
   3.54003685846948*^9, 3.540036984706725*^9}, {3.54003701775928*^9, 
   3.540037032315583*^9}, 3.540038125811358*^9, {3.556916665584009*^9, 
   3.55691668126228*^9}, {3.5569168428514147`*^9, 3.556916888640827*^9}, {
   3.556916933311759*^9, 3.556917080494673*^9}, {3.674494049278042*^9, 
   3.674494087250461*^9}, {3.674677710333157*^9, 3.67467771370854*^9}, 
   3.67467801036736*^9, {3.675799994654408*^9, 3.675800008557496*^9}, {
   3.675800063694265*^9, 3.6758001631762867`*^9}, {3.675800903709487*^9, 
   3.675800910209898*^9}, {3.675897375419611*^9, 3.6758973763555727`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAmprime", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"XAYAs", "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYas", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}], "+", 
         RowBox[{"XaYAs", " ", 
          RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYAys", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
         RowBox[{"XAyYAs", " ", 
          RowBox[{"(", 
           RowBox[{"r", "+", "R", "-", 
            RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYays", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
         RowBox[{"XayYAs", 
          RowBox[{"(", 
           RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
         RowBox[{"XaYAys", 
          RowBox[{"(", "\[Chi]", ")"}]}], "+", 
         RowBox[{"XAyYas", 
          RowBox[{"(", 
           RowBox[{"R", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"XAyXAs", "/", "2"}], "+", 
      RowBox[{"XAyXas", " ", 
       RowBox[{"R", "/", "2"}]}], "+", 
      RowBox[{"XAXays", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Xamprime", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"XaYas", "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYas", 
          RowBox[{"(", "r", ")"}]}], "+", 
         RowBox[{"XaYAs", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XaYays", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
         RowBox[{"XayYas", 
          RowBox[{"(", 
           RowBox[{"r", "+", "R", "-", 
            RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYays", 
          RowBox[{"(", "\[Chi]", ")"}]}], "+", 
         RowBox[{"XayYAs", 
          RowBox[{"(", 
           RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
         RowBox[{"XaYAys", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
         RowBox[{"XAyYas", 
          RowBox[{"(", 
           RowBox[{"r", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"XayXas", "/", "2"}], " ", "+", 
      RowBox[{"XAyXas", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
      RowBox[{"XAXays", " ", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"XAymprime", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"XAyYAys", "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAyYays", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}], "+", 
         RowBox[{"XayYAys", 
          RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYAys", 
          RowBox[{"(", 
           RowBox[{"r", "+", "R", "-", 
            RowBox[{"2", "\[Chi]"}]}], ")"}]}], "+", 
         RowBox[{"XAyYAs", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYays", 
          RowBox[{"(", 
           RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
         RowBox[{"XayYAs", 
          RowBox[{"(", "\[Chi]", ")"}]}], "+", 
         RowBox[{"XaYAys", 
          RowBox[{"(", 
           RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
         RowBox[{"XAyYas", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}]}], 
        ")"}]}], ")"}]}], "+", "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"XAyXAs", "/", "2"}], "+", 
      RowBox[{"XAyXas", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
      RowBox[{"XAXays", " ", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", "XAyXAys", "+", 
      RowBox[{"XAyXays", "/", "2"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Xaymprime", " ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"XayYays", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAyYays", 
           RowBox[{"(", "r", ")"}]}], "+", 
          RowBox[{"XayYAys", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XaYays", " ", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}], "+", 
          RowBox[{"XayYas", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYays", 
           RowBox[{"(", 
            RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XayYAs", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
          RowBox[{"XaYAys", 
           RowBox[{"(", 
            RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XAyYas", " ", 
           RowBox[{"(", "\[Chi]", ")"}]}]}], ")"}]}], ")"}]}], "+", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"XayXas", "/", "2"}], " ", "+", 
       RowBox[{"XAyXas", " ", 
        RowBox[{
         RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", 
       RowBox[{"XAXays", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", "XayXays", "+", 
       RowBox[{"XAyXays", "/", "2"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAprime", " ", "=", 
   RowBox[{"\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"XAYAs", "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYas", 
         RowBox[{"(", "r", ")"}]}], "+", 
        RowBox[{"XaYAs", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYAys", 
         RowBox[{"(", 
          RowBox[{"r", "+", "R", "-", 
           RowBox[{"2", "\[Chi]"}]}], ")"}]}], "+", 
        RowBox[{"XAyYAs", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYays", " ", 
         RowBox[{"(", 
          RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
        RowBox[{"XayYAs", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
        RowBox[{"XaYAys", 
         RowBox[{"(", 
          RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
        RowBox[{"XAyYas", 
         RowBox[{"(", "\[Chi]", ")"}]}]}], ")"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Yaprime", "=", 
   RowBox[{"\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"XaYas", "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYas", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}], "+", 
        RowBox[{"XaYAs", " ", 
         RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaYays", " ", 
         RowBox[{"(", 
          RowBox[{"r", "+", "R", "-", 
           RowBox[{"2", "\[Chi]"}]}], ")"}]}], "+", 
        RowBox[{"XayYas", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYays", 
         RowBox[{"(", 
          RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
        RowBox[{"XayYAs", 
         RowBox[{"(", "\[Chi]", ")"}]}], "+", 
        RowBox[{"XaYAys", 
         RowBox[{"(", 
          RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
        RowBox[{"XAyYas", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}]}], 
       ")"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"YAyprime", " ", "=", 
   RowBox[{"\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"XAyYAys", "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAyYays", 
         RowBox[{"(", "r", ")"}]}], "+", 
        RowBox[{"XayYAys", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYAys", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
        RowBox[{"XAyYAs", 
         RowBox[{"(", 
          RowBox[{"r", "+", "R", "-", 
           RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYays", " ", 
         RowBox[{"(", "\[Chi]", ")"}]}], "+", 
        RowBox[{"XayYAs", 
         RowBox[{"(", 
          RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
        RowBox[{"XaYAys", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
        RowBox[{"XAyYas", " ", 
         RowBox[{"(", 
          RowBox[{"r", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Yayprime", " ", "=", 
   RowBox[{"\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"XayYays", "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAyYays", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}], "+", 
        RowBox[{"XayYAys", 
         RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaYays", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
        RowBox[{"XayYas", 
         RowBox[{"(", 
          RowBox[{"r", "+", "R", "-", 
           RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYays", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
        RowBox[{"XayYAs", 
         RowBox[{"(", 
          RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
        RowBox[{"XaYAys", 
         RowBox[{"(", "\[Chi]", ")"}]}], "+", 
        RowBox[{"XAyYas", 
         RowBox[{"(", 
          RowBox[{"R", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.675800318268052*^9, 3.675800364577742*^9}, {
   3.675800865098575*^9, 3.675800884623233*^9}, {3.675800930421735*^9, 
   3.675801014309965*^9}, {3.675801186092061*^9, 3.6758012139661913`*^9}, {
   3.675801288344637*^9, 3.6758013193919163`*^9}, 3.6758013515875397`*^9, 
   3.675803064876067*^9, {3.675804066393259*^9, 3.675804153401239*^9}, {
   3.6758041863032217`*^9, 3.6758043374296703`*^9}, {3.675804379631474*^9, 
   3.675804405220408*^9}, {3.675804468773355*^9, 3.6758044760993967`*^9}, {
   3.6758045933291197`*^9, 3.6758046212813377`*^9}, {3.67580471281376*^9, 
   3.675804990041334*^9}, {3.675807250863433*^9, 3.675807267889496*^9}, {
   3.6758682828614893`*^9, 3.675868466544877*^9}, {3.675868847460205*^9, 
   3.675868879272049*^9}, {3.6758689945484457`*^9, 3.675869057323271*^9}, {
   3.6758692719968433`*^9, 3.675869505863051*^9}, {3.675869548461001*^9, 
   3.675869585213458*^9}, {3.675869672096408*^9, 3.675869707584916*^9}, {
   3.6758697924963293`*^9, 3.6758697988408422`*^9}, {3.6758701927023563`*^9, 
   3.675870195453092*^9}, {3.675884173345504*^9, 3.675884174905342*^9}, 
   3.675884205449786*^9, {3.675884613602296*^9, 3.675884726757524*^9}, {
   3.6758847843497334`*^9, 3.675884792191498*^9}, {3.6758877458634987`*^9, 
   3.67588780384052*^9}, {3.675888599989387*^9, 3.6758886145965652`*^9}, {
   3.675889229466887*^9, 3.675889260919652*^9}, {3.675889303528616*^9, 
   3.67588933806083*^9}, {3.675896536777073*^9, 3.67589656979839*^9}, {
   3.6758966227806807`*^9, 3.67589663667232*^9}, {3.6758966752114058`*^9, 
   3.675896710149926*^9}, {3.675896944667272*^9, 3.675897162875085*^9}, {
   3.675897210236834*^9, 3.6758972821423197`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{
  "XAmprime", "+", "Xamprime", "+", "XAymprime", "+", "Xaymprime", "+", 
   "YAprime", "+", "Yaprime", "+", "YAyprime", "+", "Yayprime"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.675897293006154*^9, 3.675897293415579*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{3.675897294149023*^9, 3.6765707752892113`*^9}]
}, Open  ]],

Cell["\<\
Which might be easier to look at in this form:

First, we write use the following terms, which will then allow us to choose \
different gene orders and different degrees of cross-over interference. 
* RX is the chance of a double recombinant 
* RA is the chance of either one or two recombination events in a triple \
heterozygote
* RO is the chance of exactly one recombination event separating y and Y
* R1 is the chance of only a recombination event between y and A
* R2 is the chance of only a recombination event between A and the Y\
\>", "Text",
 CellChangeTimes->{{3.6758973809630632`*^9, 3.6758973915682487`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subR", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RA", "\[Rule]", 
      RowBox[{"r", "+", "Rm", "-", "\[Chi]"}]}], ",", 
     RowBox[{"R0", "\[Rule]", 
      RowBox[{"r", "+", "Rm", "-", 
       RowBox[{"2", "\[Chi]"}]}]}], ",", 
     RowBox[{"R1", "\[Rule]", 
      RowBox[{"Rm", "-", "\[Chi]"}]}], ",", 
     RowBox[{"R2", "\[Rule]", 
      RowBox[{"r", "-", "\[Chi]"}]}]}], "}"}]}], ";"}]], "Input"],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAmprime", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"XAYAs", "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYas", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}], "+", 
         RowBox[{"XaYAs", " ", 
          RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYAys", 
          RowBox[{"(", 
           RowBox[{"1", "-", "R0"}], ")"}]}], "+", 
         RowBox[{"XAyYAs", " ", 
          RowBox[{"(", "R0", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYays", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "RA"}], ")"}]}], "+", 
         RowBox[{"XayYAs", 
          RowBox[{"(", "R2", ")"}]}], "+", 
         RowBox[{"XaYAys", 
          RowBox[{"(", "RX", ")"}]}], "+", 
         RowBox[{"XAyYas", 
          RowBox[{"(", "R1", ")"}]}]}], ")"}]}], ")"}]}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"XAyXAs", "/", "2"}], "+", 
      RowBox[{"XAyXas", " ", 
       RowBox[{"R", "/", "2"}]}], "+", 
      RowBox[{"XAXays", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"Xamprime", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"XaYas", "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYas", 
          RowBox[{"(", "r", ")"}]}], "+", 
         RowBox[{"XaYAs", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XaYays", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "R0"}], ")"}]}], "+", 
         RowBox[{"XayYas", 
          RowBox[{"(", "R0", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYays", 
          RowBox[{"(", "RX", ")"}]}], "+", 
         RowBox[{"XayYAs", 
          RowBox[{"(", "R1", ")"}]}], "+", 
         RowBox[{"XaYAys", 
          RowBox[{"(", 
           RowBox[{"1", "-", "RA"}], ")"}]}], "+", 
         RowBox[{"XAyYas", 
          RowBox[{"(", "R2", ")"}]}]}], ")"}]}], ")"}]}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"XayXas", "/", "2"}], " ", "+", 
      RowBox[{"XAyXas", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
      RowBox[{"XAXays", " ", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"XAymprime", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"XAyYAys", "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAyYays", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}], "+", 
         RowBox[{"XayYAys", 
          RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYAys", 
          RowBox[{"(", "R0", ")"}]}], "+", 
         RowBox[{"XAyYAs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "R0"}], ")"}]}]}], ")"}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYays", 
          RowBox[{"(", "R1", ")"}]}], "+", 
         RowBox[{"XayYAs", 
          RowBox[{"(", "RX", ")"}]}], "+", 
         RowBox[{"XaYAys", 
          RowBox[{"(", "R2", ")"}]}], "+", 
         RowBox[{"XAyYas", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "RA"}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"XAyXAs", "/", "2"}], "+", 
      RowBox[{"XAyXas", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
      RowBox[{"XAXays", " ", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", "XAyXAys", "+", 
      RowBox[{"XAyXays", "/", "2"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Xaymprime", " ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"XayYays", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAyYays", 
           RowBox[{"(", "r", ")"}]}], "+", 
          RowBox[{"XayYAys", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XaYays", " ", 
           RowBox[{"(", "R0", ")"}]}], "+", 
          RowBox[{"XayYas", 
           RowBox[{"(", 
            RowBox[{"1", "-", "R0"}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYays", 
           RowBox[{"(", "R2", ")"}]}], "+", 
          RowBox[{"XayYAs", 
           RowBox[{"(", 
            RowBox[{"1", "-", "RA"}], ")"}]}], "+", 
          RowBox[{"XaYAys", 
           RowBox[{"(", "R1", ")"}]}], "+", 
          RowBox[{"XAyYas", " ", 
           RowBox[{"(", "RX", ")"}]}]}], ")"}]}], ")"}]}], "+", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"XayXas", "/", "2"}], " ", "+", 
       RowBox[{"XAyXas", " ", 
        RowBox[{
         RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", 
       RowBox[{"XAXays", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", "XayXays", "+", 
       RowBox[{"XAyXays", "/", "2"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAprime", " ", "=", 
   RowBox[{"\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"XAYAs", "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYas", 
         RowBox[{"(", "r", ")"}]}], "+", 
        RowBox[{"XaYAs", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYAys", 
         RowBox[{"(", "R0", ")"}]}], "+", 
        RowBox[{"XAyYAs", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "R0"}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYays", " ", 
         RowBox[{"(", "R2", ")"}]}], "+", 
        RowBox[{"XayYAs", 
         RowBox[{"(", 
          RowBox[{"1", "-", "RA"}], ")"}]}], "+", 
        RowBox[{"XaYAys", 
         RowBox[{"(", "R1", ")"}]}], "+", 
        RowBox[{"XAyYas", 
         RowBox[{"(", "RX", ")"}]}]}], ")"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Yaprime", "=", 
   RowBox[{"\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"XaYas", "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYas", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}], "+", 
        RowBox[{"XaYAs", " ", 
         RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaYays", " ", 
         RowBox[{"(", "R0", ")"}]}], "+", 
        RowBox[{"XayYas", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "R0"}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYays", 
         RowBox[{"(", "R1", ")"}]}], "+", 
        RowBox[{"XayYAs", 
         RowBox[{"(", "RX", ")"}]}], "+", 
        RowBox[{"XaYAys", 
         RowBox[{"(", "R2", ")"}]}], "+", 
        RowBox[{"XAyYas", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "RA"}], ")"}]}]}], ")"}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"YAyprime", " ", "=", 
   RowBox[{"\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"XAyYAys", "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAyYays", 
         RowBox[{"(", "r", ")"}]}], "+", 
        RowBox[{"XayYAys", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYAys", 
         RowBox[{"(", 
          RowBox[{"1", "-", "R0"}], ")"}]}], "+", 
        RowBox[{"XAyYAs", 
         RowBox[{"(", "R0", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYays", " ", 
         RowBox[{"(", "RX", ")"}]}], "+", 
        RowBox[{"XayYAs", 
         RowBox[{"(", "R1", ")"}]}], "+", 
        RowBox[{"XaYAys", 
         RowBox[{"(", 
          RowBox[{"1", "-", "RA"}], ")"}]}], "+", 
        RowBox[{"XAyYas", " ", 
         RowBox[{"(", "R2", ")"}]}]}], ")"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Yayprime", " ", "=", 
   RowBox[{"\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"XayYays", "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAyYays", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}], "+", 
        RowBox[{"XayYAys", 
         RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaYays", 
         RowBox[{"(", 
          RowBox[{"1", "-", "R0"}], ")"}]}], "+", 
        RowBox[{"XayYas", 
         RowBox[{"(", "R0", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYays", 
         RowBox[{"(", 
          RowBox[{"1", "-", "RA"}], ")"}]}], "+", 
        RowBox[{"XayYAs", 
         RowBox[{"(", "R2", ")"}]}], "+", 
        RowBox[{"XaYAys", 
         RowBox[{"(", "RX", ")"}]}], "+", 
        RowBox[{"XAyYas", 
         RowBox[{"(", "R1", ")"}]}]}], ")"}]}], ")"}]}]}], ";"}]}], "Input"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{
   RowBox[{
   "XAmprime", "+", "Xamprime", "+", "XAymprime", "+", "Xaymprime", "+", 
    "YAprime", "+", "Yaprime", "+", "YAyprime", "+", "Yayprime"}], "/.", 
   "subR"}], "]"}]], "Input",
 CellChangeTimes->{{3.6758974076251907`*^9, 3.6758974637805643`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Maa", " ", "wa", " ", "Xam", " ", "Xayf"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "XAm", " ", "Xayf"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "Xam", " ", "XAyf"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAm", " ", "XAyf"}], "+", 
    RowBox[{"Maa", " ", "wa", " ", "Xaf", " ", "Xaym"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "Xaym"}], "+", 
    RowBox[{"Maa", " ", "wa", " ", "Xayf", " ", "Xaym"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAyf", " ", "Xaym"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "Xaf", " ", "XAym"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "XAym"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "Xayf", " ", "XAym"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAyf", " ", "XAym"}], "+", 
    RowBox[{"Maa", " ", "wa", " ", "Xaf", " ", "Ya"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "Ya"}], "+", 
    RowBox[{"Maa", " ", "wa", " ", "Xayf", " ", "Ya"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAyf", " ", "Ya"}], "+", 
    RowBox[{"MAa", " ", "RX", " ", "wa", " ", "XAyf", " ", "Ya"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "Xaf", " ", "YA"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "Xayf", " ", "YA"}], "+", 
    RowBox[{"MAa", " ", "RX", " ", "wA", " ", "Xayf", " ", "YA"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAyf", " ", "YA"}], "+", 
    RowBox[{"Maa", " ", "wa", " ", "Xaf", " ", "Yay"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "Yay"}], "+", 
    RowBox[{"MAa", " ", "RX", " ", "wa", " ", "XAf", " ", "Yay"}], "+", 
    RowBox[{"Maa", " ", "wa", " ", "Xayf", " ", "Yay"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAyf", " ", "Yay"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "Xaf", " ", "YAy"}], "+", 
    RowBox[{"MAa", " ", "RX", " ", "wA", " ", "Xaf", " ", "YAy"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YAy"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "Xayf", " ", "YAy"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAyf", " ", "YAy"}], "-", 
    RowBox[{"MAa", " ", "wa", " ", "XAyf", " ", "Ya", " ", "\[Chi]"}], "-", 
    RowBox[{"MAa", " ", "wA", " ", "Xayf", " ", "YA", " ", "\[Chi]"}], "-", 
    RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "Yay", " ", "\[Chi]"}], "-", 
    RowBox[{"MAa", " ", "wA", " ", "Xaf", " ", "YAy", " ", "\[Chi]"}]}], 
   ")"}], "/", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"Maa", " ", "wa", " ", "Xam", " ", "Xayf"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "XAm", " ", "Xayf"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "Xam", " ", "XAyf"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAm", " ", "XAyf"}], "+", 
    RowBox[{"Maa", " ", "wa", " ", "Xaf", " ", "Xaym"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "Xaym"}], "+", 
    RowBox[{"Maa", " ", "wa", " ", "Xayf", " ", "Xaym"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAyf", " ", "Xaym"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "Xaf", " ", "XAym"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "XAym"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "Xayf", " ", "XAym"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAyf", " ", "XAym"}], "+", 
    RowBox[{"Maa", " ", "wa", " ", "Xaf", " ", "Ya"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "Ya"}], "+", 
    RowBox[{"Maa", " ", "wa", " ", "Xayf", " ", "Ya"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAyf", " ", "Ya"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "Xaf", " ", "YA"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "Xayf", " ", "YA"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAyf", " ", "YA"}], "+", 
    RowBox[{"Maa", " ", "wa", " ", "Xaf", " ", "Yay"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "Yay"}], "+", 
    RowBox[{"Maa", " ", "wa", " ", "Xayf", " ", "Yay"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAyf", " ", "Yay"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "Xaf", " ", "YAy"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YAy"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "Xayf", " ", "YAy"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "XAyf", " ", "YAy"}]}], ")"}]}]], "Output",\

 CellChangeTimes->{{3.675897464902707*^9, 3.675897466838415*^9}, 
   3.676570775982298*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Resident equilibrium (new recursions - adjusted for the new position of \
\[Alpha])\
\>", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9, {3.675889497088314*^9, 3.675889497307007*^9}, {
   3.675897573374775*^9, 3.675897575830624*^9}, {3.675897716718397*^9, 
   3.6758977222283363`*^9}}],

Cell["We will assume that the neoY is absent ", "Text",
 CellChangeTimes->{{3.675897612080282*^9, 3.675897623453624*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subequil", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", "pXf"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xaf", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"1", "-", "pXf"}], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAm", "\[Rule]", 
      RowBox[{"pXm", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xam", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pXm"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YA", "\[Rule]", 
      RowBox[{"pY", "*", "\[Alpha]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Ya", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pY"}], ")"}], "*", "\[Alpha]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"XAyf", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xayf", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAym", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xaym", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"YAy", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Yay", "\[Rule]", "0"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675897631284259*^9, 3.675897659212982*^9}}],

Cell["\<\
We now solve for the equilibrium frequency of A in each of the haploid \
genotypes. Equilibrium is achieved when the following three equations are zero\
\>", "Text",
 CellChangeTimes->{{3.675694155902801*^9, 3.675694193760104*^9}, {
   3.6756944337868023`*^9, 3.6756944351881227`*^9}, {3.6757029847267847`*^9, 
   3.67570303405547*^9}, {3.675710696458521*^9, 3.675710706286772*^9}, 
   3.6758975924118633`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqs", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"XAfprime", "-", "XAf"}], ",", "\[IndentingNewLine]", 
      RowBox[{"XAmprime", "-", "XAm"}], ",", "\[IndentingNewLine]", 
      RowBox[{"YAprime", "-", "YA"}]}], "\[IndentingNewLine]", "}"}], "/.", 
    "subequil"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675647987041369*^9, 3.67564802904979*^9}, {
   3.675650509895372*^9, 3.675650527299842*^9}, {3.6756941716513157`*^9, 
   3.6756941738671913`*^9}, {3.675694338488646*^9, 3.675694340978696*^9}, {
   3.675694394143187*^9, 3.6756944261522427`*^9}, 3.6756944751724463`*^9, 
   3.675702984727247*^9, {3.675703036868017*^9, 3.675703037688758*^9}, 
   3.67578824463701*^9, 3.675897781726954*^9}],

Cell["\<\
To simplify the analysis we assume weak selection in both haploids \
(sperm/pollen) and diploids\
\>", "Text",
 CellChangeTimes->{{3.675694205010009*^9, 3.675694211923259*^9}, 
   3.67570298472752*^9, {3.6757030454432507`*^9, 3.6757030568360033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weaksel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAm", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAm", " ", "sAm", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Maa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAf", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAf", " ", "sAf", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Faa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"wA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"t", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"wa", "\[Rule]", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67564806523287*^9, 3.675648221558539*^9}, {
   3.675694367971285*^9, 3.6756943845803022`*^9}, 3.6757029847280283`*^9}],

Cell["We can write the frequencies as Taylor series", "Text",
 CellChangeTimes->{{3.675707045047565*^9, 3.6757070543930063`*^9}, {
  3.675707367038864*^9, 3.675707370179316*^9}, {3.675711803871513*^9, 
  3.6757118112225847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frequenciessub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pXf", "\[Rule]", 
      RowBox[{"pXf0", "+", 
       RowBox[{"pXf1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pXm", "\[Rule]", 
      RowBox[{"pXm0", "+", 
       RowBox[{"pXm1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pY", "\[Rule]", 
      RowBox[{"pY0", "+", 
       RowBox[{"pY1", " ", "\[Epsilon]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675648297857716*^9, 3.6756483630660057`*^9}, 
   3.675648454638584*^9, 3.675702984736863*^9, {3.67589080409908*^9, 
   3.675890831274033*^9}}],

Cell["\<\
Without selection the recursions for the change in frequency of A in each \
gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.6757032054455214`*^9, 3.6757032697493563`*^9}, {
  3.6757098202812138`*^9, 3.675709824765788*^9}, {3.6757117765596933`*^9, 
  3.6757117850524673`*^9}, {3.675711818872109*^9, 3.6757118199810133`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs0", "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", "frequenciessub"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.675703197099375*^9, 3.675703198353765*^9}, {
   3.675703326603519*^9, 3.675703332003808*^9}, {3.67570336997014*^9, 
   3.675703373531238*^9}, {3.675707060003501*^9, 3.675707071963544*^9}, {
   3.675707629815399*^9, 3.675707668691402*^9}, {3.6757098279293118`*^9, 
   3.6757098635569563`*^9}, {3.675785533464711*^9, 3.675785543888385*^9}, {
   3.675788240589053*^9, 3.675788247183043*^9}, {3.67588972373911*^9, 
   3.675889783320355*^9}, {3.675890096427137*^9, 3.675890101281641*^9}, {
   3.6758901865547256`*^9, 3.6758902265295887`*^9}, {3.675890260937232*^9, 
   3.675890325465114*^9}, {3.6758908417717113`*^9, 3.675890848577783*^9}, 
   3.675897777999179*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf0"}], "+", "pXm0"}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", "pXm0"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pXf0", "-", 
       RowBox[{"pXf0", " ", "r"}], "+", 
       RowBox[{"pY0", " ", "r"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}]}], "+", 
    RowBox[{"pXm0", " ", "\[Alpha]"}]}], ",", 
   RowBox[{
    RowBox[{"pXf0", " ", "r", " ", "\[Alpha]"}], "-", 
    RowBox[{"pY0", " ", "r", " ", "\[Alpha]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675890101919662*^9, 3.675890196227337*^9, 3.675890226890559*^9, 
   3.67589032606896*^9, {3.675890843995223*^9, 3.675890848999341*^9}, 
   3.675897682731414*^9, 3.675897786473518*^9, 3.676570776122645*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675709831409095*^9, 3.6757098343025913`*^9}, {
  3.675710744701475*^9, 3.675710745621426*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"differenceEqs0", "\[Equal]", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"pXf0", ",", "pXm0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675709931730151*^9, 3.675709948227565*^9}, 
   3.675889715650866*^9, {3.6758903329476337`*^9, 3.675890333531021*^9}, {
   3.675890856683935*^9, 3.6758908599323187`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"pXf0", "\[Rule]", "pY0"}], ",", 
    RowBox[{"pXm0", "\[Rule]", "pY0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6757098363525476`*^9, {3.6757099323567266`*^9, 3.675709948639193*^9}, 
   3.675727587389184*^9, 3.675785430130021*^9, 3.67578825590738*^9, 
   3.675889716378837*^9, 3.6758897866812677`*^9, {3.67589020611733*^9, 
   3.675890228462432*^9}, 3.675890334827342*^9, {3.675890851304111*^9, 
   3.675890860292238*^9}, 3.675897787493493*^9, 3.6765707761530848`*^9}]
}, Open  ]],

Cell["\<\
So, with no selection, the equilibrium frequency of A in each gamete/pollen \
type is equal (and we call this pA).\
\>", "Text",
 CellChangeTimes->{{3.675703427939505*^9, 3.6757035626138153`*^9}, {
   3.675706719194449*^9, 3.675706765062245*^9}, 3.67570996472328*^9, {
   3.6757107664993973`*^9, 3.675710849444377*^9}}],

Cell["\<\
Now, looking at only the first order selection terms, the recursions for the \
change in frequency of A in each gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.67570356712366*^9, 3.675703572187316*^9}, {
  3.67570609431063*^9, 3.675706097287983*^9}, {3.6757069069525433`*^9, 
  3.6757069072532797`*^9}, {3.67571091918222*^9, 3.6757109367564697`*^9}, {
  3.675711772412171*^9, 3.67571177325072*^9}, {3.675716463608975*^9, 
  3.67571647265489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
      ",", "\[Epsilon]", ",", "Factor"}], "]"}], "/.", 
    RowBox[{"pY0", "\[Rule]", "pA"}]}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757068495866413`*^9, 3.6757068907711554`*^9}, {
   3.6757069302403297`*^9, 3.675706982461239*^9}, {3.675707087605297*^9, 
   3.6757071228419533`*^9}, {3.67570718969317*^9, 3.675707319107386*^9}, {
   3.675707511314725*^9, 3.675707512612761*^9}, {3.675710885258552*^9, 
   3.675710885357044*^9}, {3.675711221036006*^9, 3.675711227798399*^9}, {
   3.675788237526182*^9, 3.6757882495037823`*^9}, {3.67588983758741*^9, 
   3.675889846791771*^9}, {3.675890066524867*^9, 3.67589008440499*^9}, {
   3.675890872602395*^9, 3.6758908784129057`*^9}, 3.675891388889962*^9, 
   3.675897774490415*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf1"}], "+", "pXm1", "+", 
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}]}], ")"}], " ", "\[Epsilon]"}], 
   ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf1"}], "+", "pXm1", "+", 
      RowBox[{"pXf1", " ", "r"}], "-", 
      RowBox[{"pY1", " ", "r"}], "-", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
      RowBox[{"pA", " ", "r", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", "\[Epsilon]"}], ",", 
   
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pXf1", " ", "r"}], "-", 
      RowBox[{"pY1", " ", "r"}], "+", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}], "-", 
      RowBox[{"pA", " ", "r", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], ")"}], " ", 
    "\[Alpha]", " ", "\[Epsilon]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675706852317442*^9, 3.675706918829287*^9}, {
   3.675706950931774*^9, 3.675706982932413*^9}, {3.6757070910767508`*^9, 
   3.675707123327277*^9}, {3.6757071925330353`*^9, 3.675707319486848*^9}, 
   3.675707513296742*^9, 3.67570768217498*^9, {3.675710857628578*^9, 
   3.675710885875184*^9}, {3.675711222477412*^9, 3.67571122814371*^9}, 
   3.67572758892033*^9, 3.675785431200643*^9, 3.6757882566822844`*^9, {
   3.6758898385316772`*^9, 3.675889853071372*^9}, 3.67589008578434*^9, 
   3.675890878782188*^9, 3.6758913896085997`*^9, 3.675897788776071*^9, 
   3.676570776203965*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"differenceEqs1", "\[Equal]", "0"}], ",", 
   RowBox[{"{", 
    RowBox[{"pXf1", ",", "pXm1", ",", "pY1"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.675893116701954*^9, 3.675893137632032*^9}}],

Cell[BoxData[
 RowBox[{"{", "}"}]], "Output",
 CellChangeTimes->{3.6758931380127087`*^9, 3.676570776237401*^9}]
}, Open  ]],

Cell["\<\
Instead of solving for the first order genotype frequencies we will instead \
solve for the difference in the frequency of A in the different gamete/pollen \
types.\
\>", "Text",
 CellChangeTimes->{{3.6757135825548286`*^9, 3.675713633862471*^9}, 
   3.6757138892769423`*^9, {3.675716482887339*^9, 3.6757164842940083`*^9}}],

Cell["\<\
The difference in the frequency of A with X in females and X in males is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.6757138909855633`*^9, 3.675713959445539*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfXm", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"pXf1", "\[Rule]", 
       RowBox[{"dpAXfXm", "+", "pXm1"}]}]}], ",", "dpAXfXm"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.67571264493021*^9, 3.675712689537509*^9}, {
   3.675712721625124*^9, 3.675712730987232*^9}, {3.6757136496293707`*^9, 
   3.6757136649001226`*^9}, {3.675716490314892*^9, 3.675716491532194*^9}, 
   3.675889959407155*^9, {3.6758909343383083`*^9, 3.675890951849391*^9}, {
   3.675891012447013*^9, 3.675891012934494*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfXm", "\[Rule]", 
   RowBox[{
    RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
    RowBox[{"6", " ", "hAf", " ", 
     SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
    RowBox[{"4", " ", "hAf", " ", 
     SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
    RowBox[{"pA", " ", "t"}], "-", 
    RowBox[{
     SuperscriptBox["pA", "2"], " ", "t"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675712649738289*^9, 3.675712661484269*^9}, 
   3.675712732353135*^9, 3.6757136656167507`*^9, 3.675716491898244*^9, 
   3.6757275909002647`*^9, 3.675785432660453*^9, 3.675788258653908*^9, {
   3.675889953796268*^9, 3.6758899597968283`*^9}, 3.675890959353971*^9, 
   3.6758910146488943`*^9, 3.6758913912775593`*^9, 3.676570776271274*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in males and Y is (at equilibrium \
to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713966791181*^9, 3.6757139830606413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXmY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"differenceEqs1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
        RowBox[{"pXf1", "\[Rule]", 
         RowBox[{"dpAXfXm", "+", "pXm1"}]}]}], "/.", "eqdpAXfXm"}], "/.", 
      RowBox[{"pXm1", "\[Rule]", 
       RowBox[{"dpAXmY", "+", "pY1"}]}]}], ",", "dpAXmY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.67589099313556*^9, 3.675891022927155*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXmY", "\[Rule]", 
   RowBox[{
    FractionBox["1", "r"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "r", " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "-", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6758910240913486`*^9, 3.6758913925003138`*^9, 
  3.676570776297948*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in females and Y is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713993050933*^9, 3.6757140012817707`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"pXf1", "\[Rule]", 
       RowBox[{"dpAXfY", "+", "pY1"}]}]}], ",", "dpAXfY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675891330267333*^9, 3.6758913402113733`*^9}, {
  3.675891370233397*^9, 3.675891383976934*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfY", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "hAm"}], " ", "pA", " ", "sAm"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{"3", " ", "hAm", " ", 
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"2", " ", "hAm", " ", 
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"pA", " ", "t"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "t"}], "+", 
     RowBox[{"pA", " ", "r", " ", "t"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], "r"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6758913358696117`*^9, 3.6758913405764227`*^9}, {
   3.675891373164547*^9, 3.675891393552059*^9}, 3.676570776402557*^9}]
}, Open  ]],

Cell["\<\
So then, to first order, the equilibrium haploid genotype frequencies are(?)\
\>", "Text",
 CellChangeTimes->{{3.6757175107821083`*^9, 3.675717533841239*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpXf", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pXf0", "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXmY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXmY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675716895475359*^9, 3.675716900512623*^9}, {
  3.675717278127964*^9, 3.675717294591033*^9}, {3.675717351754582*^9, 
  3.675717366375647*^9}, {3.675717543006982*^9, 3.675717544667244*^9}, {
  3.6757178596731443`*^9, 3.675717863093356*^9}, {3.675891412682151*^9, 
  3.6758914137821283`*^9}, {3.675891837469037*^9, 3.6758918377885427`*^9}, {
  3.6758919471830606`*^9, 3.67589194867479*^9}, {3.675892368331646*^9, 
  3.675892370571282*^9}, {3.6759005334571*^9, 3.675900555296269*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
         RowBox[{"hAm", " ", "sAm"}], "-", 
         RowBox[{"pA", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "sAf"}], "+", "sAm", "-", 
            RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]", "-", 
            RowBox[{"pA", " ", "\[Epsilon]"}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.6757169011353207`*^9, 3.6757173669613256`*^9, 3.6757175450525827`*^9, 
   3.675717864205447*^9, 3.675727594742791*^9, 3.675785436211323*^9, 
   3.675788261479598*^9, 3.675891416424108*^9, 3.6758918774492893`*^9, 
   3.675891958442032*^9, 3.675892370898428*^9, 3.6758935648073273`*^9, {
   3.6759005418256493`*^9, 3.675900555878397*^9}, 3.676570776442918*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpXm", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pXm0", "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXfY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675891861515366*^9, 3.675891862891082*^9}, 
   3.675891954716195*^9, {3.675900536393208*^9, 3.6759005575923357`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pA"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.675891430280157*^9, 3.675891875421072*^9, 3.6758919608167343`*^9, 
   3.675892371780211*^9, 3.675893565662033*^9, {3.675900542474494*^9, 
   3.6759005587820673`*^9}, 3.676570776487509*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpY", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pY0", "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfY"}], "/.", 
    "eqdpAXfXm"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675717392424321*^9, 3.675717393210609*^9}, {
   3.675717465498665*^9, 3.675717499551214*^9}, {3.67571755307234*^9, 
   3.675717554018692*^9}, {3.6757178713638563`*^9, 3.675717873545209*^9}, {
   3.6758918717163763`*^9, 3.6758918726910467`*^9}, 3.675891956101635*^9, {
   3.675893391454796*^9, 3.675893392916779*^9}, {3.675900539553142*^9, 
   3.675900562666452*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.67571750048251*^9, 3.675717554350906*^9, 3.675717874008835*^9, 
   3.675727596078721*^9, 3.6757854378569937`*^9, 3.675788264699403*^9, 
   3.675891496222584*^9, 3.675891873049327*^9, 3.6758919565695257`*^9, 
   3.6758923723983088`*^9, 3.675893566346439*^9, {3.675900543007511*^9, 
   3.675900562976172*^9}, 3.676570776520314*^9}]
}, Open  ]],

Cell["The recursion for pA is given by", "Text",
 CellChangeTimes->{{3.675894756303364*^9, 3.675894761327495*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"2", "XAfprime"}], "+", 
                RowBox[{"XAmprime", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "\[Alpha]"}], ")"}]}], "+", 
                RowBox[{"YAprime", "/", "\[Alpha]"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "XAf"}], "-", 
                  RowBox[{"XAm", "/", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Alpha]"}], ")"}]}], "-", 
                  RowBox[{"YA", "/", "\[Alpha]"}]}], ")"}]}], "/.", 
               "weaksel"}], "/.", "subequil"}], "/.", 
             RowBox[{"pXf", "\[Rule]", "eqpXf"}]}], "/.", 
            RowBox[{"pXm", "\[Rule]", "eqpXm"}]}], "/.", 
           RowBox[{"pY", "\[Rule]", "eqpY"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
       "/", "4"}], ",", "\[Epsilon]", ",", "Simplify"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675894617378331*^9, 3.675894690920476*^9}, {
  3.6758947376813*^9, 3.675894737903183*^9}, {3.675900548267981*^9, 
  3.6759005719630737`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"pA", "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
      RowBox[{"hAm", " ", "sAm"}], "-", 
      RowBox[{"pA", " ", 
       RowBox[{"(", 
        RowBox[{"sAf", "+", "sAm", "-", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], 
     ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675894643419367*^9, 3.675894691650373*^9}, 
   3.675894738536499*^9, 3.67590057252487*^9, 3.676570776673018*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675894741095875*^9, 3.6758947449904137`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"dpA", "-", "pA"}], "\[Equal]", "0"}], ",", "pA"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6758947492346077`*^9, 3.675894750434639*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"hAf", " ", "sAf"}], "+", 
       RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
      RowBox[{
       RowBox[{"-", "sAf"}], "+", 
       RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
       RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6758947512753477`*^9, 3.676570776703541*^9}]
}, Open  ]],

Cell["\<\
Notice that when t=0 we have equation \[OpenCurlyDoubleQuote]avgpASubs\
\[CloseCurlyDoubleQuote] in van Doorn & Kirkpatrick 2007 (SOM page 6). \
Sperm/pollen selection acts to increase the frequency of A (if selected for, \
t>0).\
\>", "Text",
 CellChangeTimes->{{3.675718177833785*^9, 3.6757182794849873`*^9}}]
}, Closed]],

Cell["\<\
Check (internal) Stability of Equilibrium (should be the same as above but \
need to adjust for \[Alpha])\
\>", "Section",
 CellChangeTimes->{{3.675728118153309*^9, 3.6757281301025343`*^9}, {
  3.675898152172256*^9, 3.675898162531384*^9}}],

Cell[CellGroupData[{

Cell["External Stability (i.e., invasion of a neo Y)", "Section",
 CellChangeTimes->{{3.675898184242074*^9, 3.675898192657653*^9}}],

Cell[CellGroupData[{

Cell[BoxData["subequil"], "Input",
 CellChangeTimes->{{3.675898272755611*^9, 3.675898273603898*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"XAf", "\[Rule]", "pXf"}], ",", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "pXf"}]}], ",", 
   RowBox[{"XAm", "\[Rule]", 
    RowBox[{"pXm", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", 
   RowBox[{"Xam", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXm"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", 
   RowBox[{"YA", "\[Rule]", 
    RowBox[{"pY", " ", "\[Alpha]"}]}], ",", 
   RowBox[{"Ya", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pY"}], ")"}], " ", "\[Alpha]"}]}], ",", 
   RowBox[{"XAyf", "\[Rule]", "0"}], ",", 
   RowBox[{"Xayf", "\[Rule]", "0"}], ",", 
   RowBox[{"XAym", "\[Rule]", "0"}], ",", 
   RowBox[{"Xaym", "\[Rule]", "0"}], ",", 
   RowBox[{"YAy", "\[Rule]", "0"}], ",", 
   RowBox[{"Yay", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.675898274076612*^9, 3.675899009180147*^9, 
  3.67657077673838*^9}]
}, Open  ]],

Cell["\<\
Notice that we don\[CloseCurlyQuote]t have recursions for XAyf or Xayf \
because y is a dominant male determining gene. However, we allowed these \
genotypes to create zygotes so we can include them in the stability matrix.\
\>", "Text",
 CellChangeTimes->{{3.6758991929846497`*^9, 3.67589926406907*^9}, {
  3.67589934114139*^9, 3.6758993427645893`*^9}, {3.675900036907325*^9, 
  3.6759000483741083`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matExtFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "XAyf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Xayf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "XAym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Xaym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "YAym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Yaym"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], "/.", "subequil"}], "//", 
    "Factor"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.675899271627995*^9, 3.675899299216916*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAa", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXm", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "R", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXm", " ", "R", " ", "wa"}], "+", 
          RowBox[{"MAA", " ", "pXm", " ", "wA"}], "+", 
          RowBox[{"2", " ", "MAa", " ", "wa", " ", "\[Alpha]"}], "-", 
          RowBox[{"2", " ", "MAa", " ", "pY", " ", "wa", " ", "\[Alpha]"}], 
          "-", 
          RowBox[{"2", " ", "MAa", " ", "RA", " ", "wa", " ", "\[Alpha]"}], 
          "+", 
          RowBox[{
          "2", " ", "MAa", " ", "pY", " ", "RA", " ", "wa", " ", "\[Alpha]"}],
           "+", 
          RowBox[{"2", " ", "MAA", " ", "pY", " ", "wA", " ", "\[Alpha]"}], 
          "-", 
          RowBox[{
          "2", " ", "MAA", " ", "pY", " ", "R0", " ", "wA", " ", 
           "\[Alpha]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      FractionBox[
       RowBox[{"MAa", " ", "wA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pXm", " ", "R"}], "+", 
          RowBox[{"2", " ", "pY", " ", "RX", " ", "\[Alpha]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"MAa", "-", 
          RowBox[{"MAa", " ", "pXf"}], "+", 
          RowBox[{"MAA", " ", "pXf"}], "-", 
          RowBox[{"MAa", " ", "R"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "R"}]}], ")"}], " ", "wA"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"MAa", " ", "pXf", " ", "R", " ", "wa"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
           RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
         "\[Alpha]"}]]}], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"MAa", " ", "wa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "R"}], "+", 
           RowBox[{"pXm", " ", "R"}], "-", 
           RowBox[{"2", " ", "RX", " ", "\[Alpha]"}], "+", 
           RowBox[{"2", " ", "pY", " ", "RX", " ", "\[Alpha]"}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
           RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
         "\[Alpha]"}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXm", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXm", " ", "wA"}], "+", 
          RowBox[{"MAa", " ", "pXm", " ", "R", " ", "wA"}], "-", 
          RowBox[{"2", " ", "Maa", " ", "wa", " ", "\[Alpha]"}], "+", 
          RowBox[{"2", " ", "Maa", " ", "pY", " ", "wa", " ", "\[Alpha]"}], 
          "+", 
          RowBox[{"2", " ", "Maa", " ", "R0", " ", "wa", " ", "\[Alpha]"}], 
          "-", 
          RowBox[{
          "2", " ", "Maa", " ", "pY", " ", "R0", " ", "wa", " ", "\[Alpha]"}],
           "-", 
          RowBox[{"2", " ", "MAa", " ", "pY", " ", "wA", " ", "\[Alpha]"}], 
          "+", 
          RowBox[{
          "2", " ", "MAa", " ", "pY", " ", "RA", " ", "wA", " ", 
           "\[Alpha]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      FractionBox[
       RowBox[{"MAa", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", "R", " ", "wA"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Maa"}], "+", 
           RowBox[{"Maa", " ", "pXf"}], "-", 
           RowBox[{"MAa", " ", "pXf"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "R"}]}], ")"}], " ", "wa"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "pXf", " ", "wa"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "pY", " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
           RowBox[{"MAa", " ", "pY", " ", "wA"}], "-", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "+", 
           RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
         "\[Alpha]"}]]}], "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "MAa"}], " ", "R2", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pY", " ", "R2", " ", "wa"}], "-", 
          RowBox[{"MAA", " ", "pY", " ", "R0", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
        RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
        RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
        RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
        RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
        RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
        RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
        RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
        RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"MAa", " ", "pY", " ", "R1", " ", "wA", " ", "\[Alpha]"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
         RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
         RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
         RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
         RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
         RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
         RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
         RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
         RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}]]}], "0", "0", 
      "0", "0"},
     {
      FractionBox[
       RowBox[{"MAa", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pY"}], ")"}], " ", "R1", " ", "wa", " ", 
        "\[Alpha]"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
        RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
        RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
        RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
        RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
        RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
        RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
        RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
        RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "R0", " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pY", " ", "R0", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pY", " ", "R2", " ", "wA"}]}], ")"}], " ", 
         "\[Alpha]"}], 
        RowBox[{
         RowBox[{"Maa", " ", "wa"}], "-", 
         RowBox[{"Maa", " ", "pXf", " ", "wa"}], "+", 
         RowBox[{"MAa", " ", "pXf", " ", "wa"}], "-", 
         RowBox[{"Maa", " ", "pY", " ", "wa"}], "+", 
         RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
         RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
         RowBox[{"MAa", " ", "pY", " ", "wA"}], "-", 
         RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "+", 
         RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}]]}], "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.675899300027032*^9, 3.6765707773094177`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyExt", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matExtFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "6", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6758993091981916`*^9, 3.6758993092948217`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"charpolyExt", "/.", "weaksel"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"\[Chi]", "\[Rule]", 
     RowBox[{"r", "*", "R"}]}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}]}], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     FractionBox["1", 
      RowBox[{"2", " ", "\[Alpha]"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     FractionBox[
      RowBox[{"1", "-", "R"}], 
      RowBox[{"2", " ", "\[Alpha]"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.675899316283032*^9, 3.675899557775223*^9, 
  3.676570777718989*^9}]
}, Open  ]],

Cell["\<\
It seems that Yy-bearing males have no effect on the invasion (would have \
been males anyway). The inclusion of Xiyf is also irrelevant as mutations \
arising in females are males in the next generation. \
\>", "Text",
 CellChangeTimes->{{3.6759000512139807`*^9, 3.6759001148215*^9}}],

Cell["\<\
The first order effect is on sex ratio. If the initial population has a sex \
ratio bias (e.g., produces an excess of X-bearing pollen/sperm, \
\[Alpha]<1/2), then a male determiner will invade. I think an initial sex \
ratio bias selecting for neo sex determiners was discussed by Jim Bull ???

Here, we will assume that any deviations from \[Alpha]=1/2 are on the order \
of \[Epsilon]\
\>", "Text",
 CellChangeTimes->{{3.675900116372485*^9, 3.675900177340706*^9}, {
  3.6759014924820547`*^9, 3.675901555528656*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Alpha]", "\[Rule]", 
         RowBox[{
          RowBox[{"1", "/", "2"}], "+", 
          RowBox[{"\[Delta]\[Alpha]", "*", "\[Epsilon]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"\[Chi]", "\[Rule]", 
     RowBox[{"r", "*", "R"}]}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.675900185889442*^9, 3.6759001924647408`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{"1", "-", "R"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6759001928050547`*^9, 3.676570777753991*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", 
            RowBox[{"\[Delta]\[Alpha]", "*", "\[Epsilon]"}]}]}]}], "/.", 
         RowBox[{"\[Lambda]", "\[Rule]", 
          RowBox[{"1", "+", 
           RowBox[{"\[Delta]\[Lambda]", "*", "\[Epsilon]"}]}]}]}], "/.", 
        "frequenciessub"}], "/.", "sol0"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.675900203768065*^9, 3.67590021603231*^9}, {
   3.675900300123855*^9, 3.675900338446018*^9}, 3.675900430018834*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "2"}], " ", "\[Delta]\[Alpha]"}]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.6759002164032507`*^9, {3.67590030988757*^9, 3.6759003389772167`*^9}, 
   3.67590043032834*^9, 3.676570777804644*^9}]
}, Open  ]],

Cell["\<\
Going to the next order in \[Epsilon] (and assuming that \[Delta]\[Alpha] is \
of order \[Epsilon]^2)\
\>", "Text",
 CellChangeTimes->{{3.6759003604720993`*^9, 3.675900376671677*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", 
            RowBox[{"\[Delta]\[Alpha]", "*", 
             RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
         RowBox[{"\[Lambda]", "\[Rule]", 
          RowBox[{"1", "+", 
           RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], "/.", 
        "frequenciessub"}], "/.", "sol0"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.675900392103478*^9, 3.6759004267641687`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", "0"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.675900397670813*^9, 3.6759004270810823`*^9}, 
   3.676570777853451*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", 
            RowBox[{"\[Delta]\[Alpha]", "*", 
             RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
         RowBox[{"\[Lambda]", "\[Rule]", 
          RowBox[{"1", "+", 
           RowBox[{"\[Delta]\[Lambda]2", "*", 
            RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
        "frequenciessub"}], "/.", "sol0"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]2"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.675900404967301*^9, 3.6759004329872217`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]2", "\[Rule]", 
    RowBox[{
     FractionBox["1", "R"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hAm", " ", "pXf1", " ", "R", " ", "sAm"}], "+", 
       RowBox[{"pXf1", " ", "pY0", " ", "R", " ", "sAm"}], "-", 
       RowBox[{
       "2", " ", "hAm", " ", "pXf1", " ", "pY0", " ", "R", " ", "sAm"}], "-", 
       
       RowBox[{"hAm", " ", "pY1", " ", "R", " ", "sAm"}], "-", 
       RowBox[{"pY0", " ", "pY1", " ", "R", " ", "sAm"}], "+", 
       RowBox[{
       "2", " ", "hAm", " ", "pY0", " ", "pY1", " ", "R", " ", "sAm"}], "+", 
       RowBox[{
        SuperscriptBox["hAm", "2"], " ", "pY0", " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{"2", " ", "hAm", " ", 
        SuperscriptBox["pY0", "2"], " ", 
        SuperscriptBox["sAm", "2"]}], "-", 
       RowBox[{"5", " ", 
        SuperscriptBox["hAm", "2"], " ", 
        SuperscriptBox["pY0", "2"], " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["pY0", "3"], " ", 
        SuperscriptBox["sAm", "2"]}], "-", 
       RowBox[{"6", " ", "hAm", " ", 
        SuperscriptBox["pY0", "3"], " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["hAm", "2"], " ", 
        SuperscriptBox["pY0", "3"], " ", 
        SuperscriptBox["sAm", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["pY0", "4"], " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{"4", " ", "hAm", " ", 
        SuperscriptBox["pY0", "4"], " ", 
        SuperscriptBox["sAm", "2"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["hAm", "2"], " ", 
        SuperscriptBox["pY0", "4"], " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{"pXf1", " ", "R", " ", "t"}], "-", 
       RowBox[{"pY1", " ", "R", " ", "t"}], "+", 
       RowBox[{"2", " ", "hAm", " ", "pY0", " ", "sAm", " ", "t"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["pY0", "2"], " ", "sAm", " ", "t"}], "-", 
       RowBox[{"6", " ", "hAm", " ", 
        SuperscriptBox["pY0", "2"], " ", "sAm", " ", "t"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["pY0", "3"], " ", "sAm", " ", "t"}], "+", 
       RowBox[{"4", " ", "hAm", " ", 
        SuperscriptBox["pY0", "3"], " ", "sAm", " ", "t"}], "-", 
       RowBox[{"hAm", " ", "pY0", " ", "R", " ", "sAm", " ", "t"}], "-", 
       RowBox[{
        SuperscriptBox["pY0", "2"], " ", "R", " ", "sAm", " ", "t"}], "+", 
       RowBox[{"3", " ", "hAm", " ", 
        SuperscriptBox["pY0", "2"], " ", "R", " ", "sAm", " ", "t"}], "+", 
       RowBox[{
        SuperscriptBox["pY0", "3"], " ", "R", " ", "sAm", " ", "t"}], "-", 
       RowBox[{"2", " ", "hAm", " ", 
        SuperscriptBox["pY0", "3"], " ", "R", " ", "sAm", " ", "t"}], "+", 
       RowBox[{"pY0", " ", 
        SuperscriptBox["t", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["pY0", "2"], " ", 
        SuperscriptBox["t", "2"]}], "-", 
       RowBox[{"pY0", " ", "R", " ", 
        SuperscriptBox["t", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["pY0", "2"], " ", "R", " ", 
        SuperscriptBox["t", "2"]}], "-", 
       RowBox[{"2", " ", "R", " ", "\[Delta]\[Alpha]"}]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6759004188756123`*^9, 3.6759004427625017`*^9}, 
   3.676570777925992*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["frequenciessub"], "Input",
 CellChangeTimes->{{3.675900511903131*^9, 3.675900513854611*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"pXf", "\[Rule]", 
    RowBox[{"pXf0", "+", 
     RowBox[{"pXf1", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"pXm", "\[Rule]", 
    RowBox[{"pXm0", "+", 
     RowBox[{"pXm1", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"pY", "\[Rule]", 
    RowBox[{"pY0", "+", 
     RowBox[{"pY1", " ", "\[Epsilon]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.675900514264566*^9, 3.676570777964861*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
           RowBox[{"\[Alpha]", "\[Rule]", 
            RowBox[{
             RowBox[{"1", "/", "2"}], "+", 
             RowBox[{"\[Delta]\[Alpha]", "*", 
              RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
          RowBox[{"\[Lambda]", "\[Rule]", 
           RowBox[{"1", "+", 
            RowBox[{"\[Delta]\[Lambda]2", "*", 
             RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
         RowBox[{"pXf", "\[Rule]", "eqpXf"}]}], "/.", 
        RowBox[{"pXm", "\[Rule]", "eqpXm"}]}], "/.", 
       RowBox[{"pY", "\[Rule]", "eqpY"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]2"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.675900504046673*^9, 3.675900521010648*^9}, {
  3.675900579608243*^9, 3.675900620024974*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]2", "\[Rule]", 
    RowBox[{
     FractionBox["1", 
      RowBox[{"r", " ", "R"}]], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
       "2", " ", "hAf", " ", "hAm", " ", "pA", " ", "R", " ", "sAf", " ", 
        "sAm"}], "+", 
       RowBox[{"2", " ", "hAf", " ", 
        SuperscriptBox["pA", "2"], " ", "R", " ", "sAf", " ", "sAm"}], "+", 
       RowBox[{"2", " ", "hAm", " ", 
        SuperscriptBox["pA", "2"], " ", "R", " ", "sAf", " ", "sAm"}], "-", 
       RowBox[{"10", " ", "hAf", " ", "hAm", " ", 
        SuperscriptBox["pA", "2"], " ", "R", " ", "sAf", " ", "sAm"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["pA", "3"], " ", "R", " ", "sAf", " ", "sAm"}], "-", 
       RowBox[{"6", " ", "hAf", " ", 
        SuperscriptBox["pA", "3"], " ", "R", " ", "sAf", " ", "sAm"}], "-", 
       RowBox[{"6", " ", "hAm", " ", 
        SuperscriptBox["pA", "3"], " ", "R", " ", "sAf", " ", "sAm"}], "+", 
       RowBox[{"16", " ", "hAf", " ", "hAm", " ", 
        SuperscriptBox["pA", "3"], " ", "R", " ", "sAf", " ", "sAm"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["pA", "4"], " ", "R", " ", "sAf", " ", "sAm"}], "+", 
       RowBox[{"4", " ", "hAf", " ", 
        SuperscriptBox["pA", "4"], " ", "R", " ", "sAf", " ", "sAm"}], "+", 
       RowBox[{"4", " ", "hAm", " ", 
        SuperscriptBox["pA", "4"], " ", "R", " ", "sAf", " ", "sAm"}], "-", 
       RowBox[{"8", " ", "hAf", " ", "hAm", " ", 
        SuperscriptBox["pA", "4"], " ", "R", " ", "sAf", " ", "sAm"}], "-", 
       RowBox[{
       "2", " ", "hAf", " ", "hAm", " ", "pA", " ", "r", " ", "R", " ", "sAf",
         " ", "sAm"}], "-", 
       RowBox[{"2", " ", "hAf", " ", 
        SuperscriptBox["pA", "2"], " ", "r", " ", "R", " ", "sAf", " ", 
        "sAm"}], "-", 
       RowBox[{"2", " ", "hAm", " ", 
        SuperscriptBox["pA", "2"], " ", "r", " ", "R", " ", "sAf", " ", 
        "sAm"}], "+", 
       RowBox[{"10", " ", "hAf", " ", "hAm", " ", 
        SuperscriptBox["pA", "2"], " ", "r", " ", "R", " ", "sAf", " ", 
        "sAm"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["pA", "3"], " ", "r", " ", "R", " ", "sAf", " ", 
        "sAm"}], "+", 
       RowBox[{"6", " ", "hAf", " ", 
        SuperscriptBox["pA", "3"], " ", "r", " ", "R", " ", "sAf", " ", 
        "sAm"}], "+", 
       RowBox[{"6", " ", "hAm", " ", 
        SuperscriptBox["pA", "3"], " ", "r", " ", "R", " ", "sAf", " ", 
        "sAm"}], "-", 
       RowBox[{"16", " ", "hAf", " ", "hAm", " ", 
        SuperscriptBox["pA", "3"], " ", "r", " ", "R", " ", "sAf", " ", 
        "sAm"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["pA", "4"], " ", "r", " ", "R", " ", "sAf", " ", 
        "sAm"}], "-", 
       RowBox[{"4", " ", "hAf", " ", 
        SuperscriptBox["pA", "4"], " ", "r", " ", "R", " ", "sAf", " ", 
        "sAm"}], "-", 
       RowBox[{"4", " ", "hAm", " ", 
        SuperscriptBox["pA", "4"], " ", "r", " ", "R", " ", "sAf", " ", 
        "sAm"}], "+", 
       RowBox[{"8", " ", "hAf", " ", "hAm", " ", 
        SuperscriptBox["pA", "4"], " ", "r", " ", "R", " ", "sAf", " ", 
        "sAm"}], "+", 
       RowBox[{
        SuperscriptBox["hAm", "2"], " ", "pA", " ", "r", " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{"2", " ", "hAm", " ", 
        SuperscriptBox["pA", "2"], " ", "r", " ", 
        SuperscriptBox["sAm", "2"]}], "-", 
       RowBox[{"5", " ", 
        SuperscriptBox["hAm", "2"], " ", 
        SuperscriptBox["pA", "2"], " ", "r", " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["pA", "3"], " ", "r", " ", 
        SuperscriptBox["sAm", "2"]}], "-", 
       RowBox[{"6", " ", "hAm", " ", 
        SuperscriptBox["pA", "3"], " ", "r", " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["hAm", "2"], " ", 
        SuperscriptBox["pA", "3"], " ", "r", " ", 
        SuperscriptBox["sAm", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["pA", "4"], " ", "r", " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{"4", " ", "hAm", " ", 
        SuperscriptBox["pA", "4"], " ", "r", " ", 
        SuperscriptBox["sAm", "2"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["hAm", "2"], " ", 
        SuperscriptBox["pA", "4"], " ", "r", " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{"2", " ", "hAf", " ", "pA", " ", "R", " ", "sAf", " ", "t"}], 
       "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["pA", "2"], " ", "R", " ", "sAf", " ", "t"}], "-", 
       RowBox[{"6", " ", "hAf", " ", 
        SuperscriptBox["pA", "2"], " ", "R", " ", "sAf", " ", "t"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["pA", "3"], " ", "R", " ", "sAf", " ", "t"}], "+", 
       RowBox[{"4", " ", "hAf", " ", 
        SuperscriptBox["pA", "3"], " ", "R", " ", "sAf", " ", "t"}], "-", 
       RowBox[{
       "2", " ", "hAf", " ", "pA", " ", "r", " ", "R", " ", "sAf", " ", "t"}],
        "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["pA", "2"], " ", "r", " ", "R", " ", "sAf", " ", "t"}],
        "+", 
       RowBox[{"6", " ", "hAf", " ", 
        SuperscriptBox["pA", "2"], " ", "r", " ", "R", " ", "sAf", " ", "t"}],
        "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["pA", "3"], " ", "r", " ", "R", " ", "sAf", " ", "t"}],
        "-", 
       RowBox[{"4", " ", "hAf", " ", 
        SuperscriptBox["pA", "3"], " ", "r", " ", "R", " ", "sAf", " ", "t"}],
        "+", 
       RowBox[{"2", " ", "hAm", " ", "pA", " ", "r", " ", "sAm", " ", "t"}], 
       "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["pA", "2"], " ", "r", " ", "sAm", " ", "t"}], "-", 
       RowBox[{"6", " ", "hAm", " ", 
        SuperscriptBox["pA", "2"], " ", "r", " ", "sAm", " ", "t"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["pA", "3"], " ", "r", " ", "sAm", " ", "t"}], "+", 
       RowBox[{"4", " ", "hAm", " ", 
        SuperscriptBox["pA", "3"], " ", "r", " ", "sAm", " ", "t"}], "+", 
       RowBox[{"pA", " ", "r", " ", 
        SuperscriptBox["t", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["pA", "2"], " ", "r", " ", 
        SuperscriptBox["t", "2"]}], "-", 
       RowBox[{"2", " ", "r", " ", "R", " ", "\[Delta]\[Alpha]"}]}], 
      ")"}]}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.675900588523295*^9, 3.675900640895134*^9}, {
   3.675900689026965*^9, 3.675900693756687*^9}, 3.67657077825985*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"\[Delta]\[Lambda]2", "/.", "%"}], "/.", 
    RowBox[{"pA", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"hAf", " ", "sAf"}], "+", 
       RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
      RowBox[{
       RowBox[{"-", "sAf"}], "+", 
       RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
       RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], ",", "\[Delta]\[Alpha]", 
   ",", "Simplify"}], "]"}]], "Input",
 CellChangeTimes->{{3.675900622422518*^9, 3.67590063839102*^9}, {
  3.675900671622023*^9, 3.6759006924223824`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", "-", 
       RowBox[{"2", " ", "R"}], "+", 
       RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
     SuperscriptBox["sAf", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["hAf", "2"], " ", 
        SuperscriptBox["sAf", "2"]}], "-", 
       RowBox[{"hAf", " ", "sAf", " ", 
        RowBox[{"(", 
         RowBox[{"sAf", "+", "sAm", "-", 
          RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"sAf", "+", "sAm", "-", 
          RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"hAm", " ", "sAm"}], "+", "t", "-", 
        RowBox[{"hAf", " ", 
         RowBox[{"(", 
          RowBox[{"sAm", "+", 
           RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}], "2"]}], 
    RowBox[{"r", " ", "R", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"sAf", "-", 
        RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
        RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}], "4"]}]], "-", 
   RowBox[{"2", " ", "\[Delta]\[Alpha]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675900623333364*^9, 3.6759006424812193`*^9}, {
   3.675900689644744*^9, 3.67590069423979*^9}, 3.676570778433765*^9}]
}, Open  ]],

Cell["\<\
The denominator looks suspiciously like pA. And van Doorn and Kirkpatrick \
have a p(1-p) term (which is often present due to Fisher\[CloseCurlyQuote]s \
fundamental theorum), so I will try those substitutions. \
\>", "Text",
 CellChangeTimes->{{3.675900912580791*^9, 3.675900980907439*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", "-", 
       RowBox[{"2", " ", "R"}], "+", 
       RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
     SuperscriptBox["sAf", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["hAf", "2"], " ", 
        SuperscriptBox["sAf", "2"]}], "-", 
       RowBox[{"hAf", " ", "sAf", " ", 
        RowBox[{"(", 
         RowBox[{"sAf", "+", "sAm", "-", 
          RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"sAf", "+", "sAm", "-", 
          RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"hAm", " ", "sAm"}], "+", "t", "-", 
        RowBox[{"hAf", " ", 
         RowBox[{"(", 
          RowBox[{"sAm", "+", 
           RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}], "2"]}], 
    RowBox[{"r", " ", "R", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"sAf", "-", 
        RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
        RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}], "4"]}]], "*", 
   RowBox[{"(", 
    RowBox[{"pA", "/", 
     FractionBox[
      RowBox[{
       RowBox[{"hAf", " ", "sAf"}], "+", 
       RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
      RowBox[{
       RowBox[{"-", "sAf"}], "+", 
       RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
       RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}], ")"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6759007071757517`*^9, 3.6759007150772657`*^9}, {
  3.6759007538315897`*^9, 3.675900754222602*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{"r", "-", 
      RowBox[{"2", " ", "R"}], "+", 
      RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
    SuperscriptBox["sAf", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "hAf"}], ")"}], " ", "sAf"}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "hAm"}], ")"}], " ", "sAm"}], "-", "t"}], 
     ")"}], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hAm", " ", "sAm"}], "+", "t", "-", 
       RowBox[{"hAf", " ", 
        RowBox[{"(", 
         RowBox[{"sAm", "+", 
          RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}], "2"]}], 
   RowBox[{"r", " ", "R", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{"sAf", "-", 
       RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
       RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}], "3"]}]]}]], "Output",
 CellChangeTimes->{{3.675900715754808*^9, 3.6759007548647423`*^9}, 
   3.675900798263206*^9, 3.675900999158967*^9, 3.675901163600465*^9, 
   3.675901207012755*^9, 3.6765707785265627`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "*", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pA"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       FractionBox[
        RowBox[{
         RowBox[{"hAf", " ", "sAf"}], "+", 
         RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
        RowBox[{
         RowBox[{"-", "sAf"}], "+", 
         RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}], ")"}]}], ")"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6759007206082373`*^9, 3.6759007608444443`*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
    RowBox[{"(", 
     RowBox[{"r", "-", 
      RowBox[{"2", " ", "R"}], "+", 
      RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
    SuperscriptBox["sAf", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hAm", " ", "sAm"}], "+", "t", "-", 
       RowBox[{"hAf", " ", 
        RowBox[{"(", 
         RowBox[{"sAm", "+", 
          RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}], "2"]}], 
   RowBox[{"r", " ", "R", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "sAm"}]}], ")"}], 
     "2"]}]]}]], "Output",
 CellChangeTimes->{{3.675900733173319*^9, 3.675900761274515*^9}, {
   3.6759007988334837`*^9, 3.675900803328377*^9}, {3.6759009970193453`*^9, 
   3.675900999797493*^9}, 3.6759011643077383`*^9, 3.675901207611429*^9, 
   3.676570778571918*^9}]
}, Open  ]],

Cell["\<\
I suspect the rest probably factors in the form given in van Doorn and \
Kirkpatrick.\
\>", "Text",
 CellChangeTimes->{{3.6759008749999237`*^9, 3.6759008999731693`*^9}, {
  3.6759012081771097`*^9, 3.6759012088627157`*^9}}],

Cell["They assume that the y is autosomal such that R=1/2", "Text",
 CellChangeTimes->{{3.675901145160612*^9, 3.675901154234661*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"R", "\[Rule]", 
   RowBox[{"1", "/", "2"}]}]}]], "Input",
 CellChangeTimes->{{3.675901158204167*^9, 3.675901160866362*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "r"}]}], ")"}], " ", 
    SuperscriptBox["sAf", "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hAm", " ", "sAm"}], "+", "t", "-", 
       RowBox[{"hAf", " ", 
        RowBox[{"(", 
         RowBox[{"sAm", "+", 
          RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}], "2"]}], 
   RowBox[{"r", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "sAm"}]}], ")"}], 
     "2"]}]]}]], "Output",
 CellChangeTimes->{3.675901165802801*^9, 3.675901210015018*^9, 
  3.676570778605172*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"%", "*", 
   RowBox[{"(", 
    RowBox[{"L", "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", "r"}]}], ")"}], "/", "r"}], ")"}]}], ")"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.675901173865703*^9, 3.675901212561532*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "L", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
   SuperscriptBox["sAf", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAm", " ", "sAm"}], "+", "t", "-", 
      RowBox[{"hAf", " ", 
       RowBox[{"(", 
        RowBox[{"sAm", "+", 
         RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}], "2"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "sAm"}]}], ")"}], 
   "2"]]], "Output",
 CellChangeTimes->{{3.675901201934219*^9, 3.675901212893882*^9}, 
   3.67657077865381*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"%", "/.", 
  RowBox[{"t", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.675900993597015*^9, 3.675900994787169*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"2", " ", "L", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
   SuperscriptBox["sAf", "2"], " ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "hAf"}], " ", "sAm"}], "+", 
      RowBox[{"hAm", " ", "sAm"}]}], ")"}], "2"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "sAm"}]}], ")"}], 
   "2"]]], "Output",
 CellChangeTimes->{{3.675900995116006*^9, 3.675901001381435*^9}, 
   3.6759012509427137`*^9, 3.676570778703511*^9}]
}, Open  ]],

Cell["I suspect these terms are really marginal fitnesses. ", "Text",
 CellChangeTimes->{{3.67590500778553*^9, 3.675905039226461*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Sigma]Am", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pA", "+", 
       RowBox[{"hAm", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAm"}], "-", 
    RowBox[{"pA", " ", "hAm", " ", "sAm"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Sigma]Af", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pA", "+", 
       RowBox[{"hAf", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAf"}], "-", 
    RowBox[{"pA", " ", "hAf", " ", "sAf"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Sigma]Am", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Sigma]Am", "-", "\[Sigma]Af"}], ")"}], "/", "2"}]}], "/.", 
    RowBox[{"pA", "->", 
     FractionBox[
      RowBox[{
       RowBox[{"hAf", " ", "sAf"}], "+", 
       RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
      RowBox[{
       RowBox[{"-", "sAf"}], "+", 
       RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
       RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.675901270573429*^9, 3.675901391992231*^9}, {
  3.675901833210272*^9, 3.675901896881093*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"hAf", "-", "hAm"}], ")"}], "2"], " ", 
   SuperscriptBox["sAf", "2"], " ", 
   SuperscriptBox["sAm", "2"]}], 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "sAm"}]}], ")"}], 
   "2"]]], "Output",
 CellChangeTimes->{{3.6759013458755703`*^9, 3.675901392516657*^9}, {
   3.675901851241784*^9, 3.675901866445881*^9}, 3.676570778771372*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", "L", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     SuperscriptBox["sAf", "2"], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "hAf"}], " ", "sAm"}], "+", 
        RowBox[{"hAm", " ", "sAm"}]}], ")"}], "2"]}], 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "sAm"}]}], ")"}], "2"]], 
   "*", 
   RowBox[{"SA", "/", 
    FractionBox[
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"hAf", "-", "hAm"}], ")"}], "2"], " ", 
      SuperscriptBox["sAf", "2"], " ", 
      SuperscriptBox["sAm", "2"]}], 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "sAm"}]}], ")"}], 
      "2"]]}]}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.675902004917067*^9, 3.675902014564226*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", "L", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", "SA"}]], "Output",\

 CellChangeTimes->{{3.675902011659827*^9, 3.675902014837785*^9}, 
   3.676570778836445*^9}]
}, Open  ]],

Cell["\<\
This should be adjusted to include t, which will take some finangling. \
\>", "Text",
 CellChangeTimes->{{3.675901959504385*^9, 3.675901976711637*^9}, {
  3.6759049787187853`*^9, 3.675904987563272*^9}, {3.6759050445224648`*^9, 
  3.6759050450423813`*^9}, {3.675905095570402*^9, 3.67590512033733*^9}}],

Cell["\<\
I believe that the a locus model should essential be where we assume the \
r=1/2 instead of R=1/2. Thus everything is equivalent except for the \
labelling (R versus r and sai for sAi). 

In their other analyses I think they assume that r is of a similar order to \
the selection terms. \
\>", "Text",
 CellChangeTimes->{{3.675901655447938*^9, 3.6759017803955297`*^9}}],

Cell["\<\
Other thoughts:
With our method we can also include an \[Alpha] of the new y. This is not so \
interesting though as non-mendelian inheritance is not thought to be that \
important. 
We should adjust the haploid fitnesses so that they are wXA, wXa, wYA, wYa \
etc. to allow general forms of selection on the haploids (e.g., if the Y has \
low fitness due to degeneration). 
We could also consider transitions to ZW systems by adjusting the recursion \
equations - I think this is where the action will be. 
With our method, we could also consider incomplete neoY systems - that is, \
they make males, but not all of the time (like an partial loss of female \
function mutation, rather than complete sterility). This would invovle the \
full invasion matrix, i.e., there would be Xiyf haploids to track. \
\>", "Text",
 CellChangeTimes->{{3.675905047874118*^9, 3.675905091997881*^9}, {
  3.675905130297331*^9, 3.6759053697324553`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Second try (delete?)", "Title",
 CellChangeTimes->{{3.676199608867482*^9, 3.6761996284811163`*^9}, {
  3.6765852259928017`*^9, 3.67658524286696*^9}}],

Cell[CellGroupData[{

Cell["Life-cycle", "Section",
 CellChangeTimes->{{3.6756910197792797`*^9, 3.675691024113359*^9}, {
   3.67569412935745*^9, 3.6756941314240303`*^9}, {3.675707349839982*^9, 
   3.675707351884247*^9}, {3.675709974013658*^9, 3.675709982915987*^9}, {
   3.6757923469668207`*^9, 3.675792350124728*^9}, {3.6761413144270782`*^9, 
   3.676141323737258*^9}, {3.676142978381001*^9, 3.67614297923321*^9}, 
   3.676199586158256*^9, 3.676206073928619*^9}],

Cell["\<\
We now re-do the previous analyses with a rare dominant (to the X) \
masculinizing mutation at a new locus y. We let yA be the frequency of A in \
pollen/sperm with this new mutation. Then, after haploid selection, the \
frequencies of haploid types from each sex are\
\>", "Text",
 CellChangeTimes->{{3.676139972803225*^9, 3.676140015442719*^9}, {
   3.676140067615103*^9, 3.6761401130152693`*^9}, {3.676140143529172*^9, 
   3.676140252405312*^9}, {3.6761402854946823`*^9, 3.676140443857773*^9}, {
   3.6761408620376587`*^9, 3.6761409078419228`*^9}, {3.6761413394238453`*^9, 
   3.676141368941441*^9}, {3.6761421127890797`*^9, 3.6761421663025913`*^9}, 
   3.676199586158813*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wbarHapXm", "=", " ", 
   RowBox[{
    RowBox[{"wA", " ", "XAm"}], "+", " ", 
    RowBox[{"wa", " ", "Xam"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wbarHapY", "=", " ", 
   RowBox[{
    RowBox[{"wA", " ", "YA"}], "+", " ", 
    RowBox[{"wa", " ", "Ya"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wbarHapy", "=", " ", 
   RowBox[{
    RowBox[{"wA", " ", "xA"}], "+", " ", 
    RowBox[{"wa", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "xA"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAms", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Alpha]"}], ")"}], " ", "wA", " ", 
    RowBox[{"XAm", "/", "wbarHapXm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xams", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Alpha]"}], ")"}], " ", "wa", " ", 
    RowBox[{"Xam", "/", "wbarHapXm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAs", "=", "  ", 
   RowBox[{"\[Alpha]", " ", "wA", "*", 
    RowBox[{"YA", "/", "wbarHapY"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yas", "=", " ", 
   RowBox[{"\[Alpha]", " ", "wa", "*", 
    RowBox[{"Ya", "/", "wbarHapY"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAfs", "=", "XAf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xafs", "=", "Xaf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yAs", "=", " ", 
   RowBox[{"\[Alpha]", " ", "wA", " ", "\[Epsilon]y", " ", 
    RowBox[{"xA", "/", "wbarHapy"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yas", "=", " ", 
   RowBox[{"\[Alpha]", " ", "wa", " ", "\[Epsilon]y", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "xA"}], ")"}], "/", "wbarHapy"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.675887851245193*^9, 3.675887867834023*^9}, {
   3.676141999159761*^9, 3.676142091103024*^9}, {3.676142174120762*^9, 
   3.676142199369879*^9}, {3.676142234237845*^9, 3.6761422412826653`*^9}, {
   3.676149131909862*^9, 3.67614922213706*^9}, {3.676149379748801*^9, 
   3.676149430057311*^9}, {3.676149471691319*^9, 3.676149484490981*^9}, {
   3.676149619753261*^9, 3.676149627248313*^9}, {3.676152777149371*^9, 
   3.6761528652841263`*^9}, 3.676199586159603*^9, {3.676205759277755*^9, 
   3.6762057873657627`*^9}}],

Cell["\<\
Check that frequencies of gametes types from each sex sum to the appropriate \
fraction after haploid selection:\
\>", "Text",
 CellChangeTimes->{{3.675691241028049*^9, 3.675691262904736*^9}, {
   3.675691499842326*^9, 3.675691508954028*^9}, {3.6757021446730413`*^9, 
   3.6757021466313477`*^9}, 3.67570266834774*^9, {3.675710454342794*^9, 
   3.675710458811872*^9}, {3.675711308941972*^9, 3.6757113347037287`*^9}, {
   3.676140458259473*^9, 3.676140486907097*^9}, 3.676199586160721*^9, {
   3.6762058698955383`*^9, 3.676205873473984*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"1", "-", "\[Alpha]"}], "==", 
    RowBox[{"XAms", "+", "Xams"}]}], "/.", 
   RowBox[{"Xam", "\[Rule]", 
    RowBox[{"1", "-", "XAm"}]}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]", "==", 
    RowBox[{"YAs", "+", "Yas"}]}], "/.", 
   RowBox[{"Ya", "\[Rule]", 
    RowBox[{"1", "-", "YA"}]}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{"XAfs", "+", "Xafs"}]}], "/.", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "XAf"}]}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]", " ", "\[Epsilon]y"}], "==", 
   RowBox[{"yAs", "+", "yas"}]}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.6762058553075027`*^9, 3.676205862337631*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.676205597799912*^9, 3.676205804339649*^9, 
  3.676205862891724*^9, 3.6762975094425383`*^9, 3.6763314735315857`*^9, 
  3.6765707789165363`*^9, 3.676578081579689*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.676205597799912*^9, 3.676205804339649*^9, 
  3.676205862891724*^9, 3.6762975094425383`*^9, 3.6763314735315857`*^9, 
  3.6765707789165363`*^9, 3.676578081584096*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.676205597799912*^9, 3.676205804339649*^9, 
  3.676205862891724*^9, 3.6762975094425383`*^9, 3.6763314735315857`*^9, 
  3.6765707789165363`*^9, 3.676578081587137*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.676205597799912*^9, 3.676205804339649*^9, 
  3.676205862891724*^9, 3.6762975094425383`*^9, 3.6763314735315857`*^9, 
  3.6765707789165363`*^9, 3.6765780815905724`*^9}]
}, Open  ]],

Cell["\<\
After random mating, the frequencies of the diploid genotypes are\
\>", "Text",
 CellChangeTimes->{{3.675646094888542*^9, 3.675646099390658*^9}, {
   3.675646217785323*^9, 3.675646250704771*^9}, {3.67570268816877*^9, 
   3.6757027045136023`*^9}, {3.676143601607935*^9, 3.6761436020295963`*^9}, 
   3.676199586165538*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAXA", "=", 
   RowBox[{"XAfs", " ", "XAms"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXa", "=", 
   RowBox[{
    RowBox[{"XAfs", " ", "Xams"}], "+", 
    RowBox[{"Xafs", " ", "XAms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaXa", "=", 
    RowBox[{"Xafs", " ", "Xams"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"XAYA", "=", 
   RowBox[{"XAfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYa", "=", 
   RowBox[{"XAfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYA", "=", 
   RowBox[{"Xafs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaYa", "=", 
    RowBox[{"Xafs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"XAyA", "=", 
   RowBox[{"XAfs", " ", "yAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAya", "=", 
   RowBox[{"XAfs", " ", "yas"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayA", "=", 
   RowBox[{"Xafs", " ", "yAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xaya", "=", 
   RowBox[{"Xafs", " ", "yas"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646256909181*^9, 3.675646272815617*^9}, {
   3.675646370257011*^9, 3.67564637079287*^9}, {3.675646404699778*^9, 
   3.675646517567526*^9}, {3.675646573911735*^9, 3.675646591557143*^9}, {
   3.675646627619878*^9, 3.67564663177063*^9}, {3.675646667841331*^9, 
   3.675646747122738*^9}, {3.675691396390801*^9, 3.675691472391663*^9}, {
   3.675691536695323*^9, 3.675691538414453*^9}, {3.675691639085917*^9, 
   3.675691650195237*^9}, {3.675691682513646*^9, 3.675691696533524*^9}, {
   3.675691755294464*^9, 3.6756917629827957`*^9}, {3.675691824386702*^9, 
   3.675691852603437*^9}, {3.675692700413486*^9, 3.675692712195026*^9}, {
   3.67569296671769*^9, 3.675692967464675*^9}, {3.6756930389284983`*^9, 
   3.675693095368285*^9}, {3.675693137308187*^9, 3.675693184356132*^9}, {
   3.675693221908244*^9, 3.6756932234970217`*^9}, {3.675693268122773*^9, 
   3.675693270392726*^9}, {3.675693410576119*^9, 3.675693460007984*^9}, {
   3.675693492300033*^9, 3.675693533360964*^9}, 3.675693600152028*^9, {
   3.675702177145516*^9, 3.675702196152766*^9}, {3.6757023129704742`*^9, 
   3.675702317051364*^9}, {3.675792623150811*^9, 3.675792640133086*^9}, {
   3.675792682078307*^9, 3.675792755658676*^9}, {3.6761425905197153`*^9, 
   3.676142594326068*^9}, 3.676199586165913*^9}],

Cell["\<\
Check that frequencies sum to the appropriate fraction\
\>", "Text",
 CellChangeTimes->{{3.6761436064259577`*^9, 3.676143611328102*^9}, 
   3.67619958616654*^9, {3.676205899432912*^9, 3.6762059064641323`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"1", "-", "\[Alpha]"}], "==", 
     RowBox[{"XAXA", "+", "XAXa", "+", "XaXa"}]}], "/.", 
    RowBox[{"Xaf", "\[Rule]", 
     RowBox[{"1", "-", "XAf"}]}]}], "/.", 
   RowBox[{"Xam", "\[Rule]", 
    RowBox[{"1", "-", "XAm"}]}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]", "==", 
     RowBox[{"XAYA", "+", "XAYa", "+", "XaYA", "+", "XaYa"}]}], "/.", 
    RowBox[{"Ya", "\[Rule]", 
     RowBox[{"1", "-", "YA"}]}]}], "/.", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "XAf"}]}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]", " ", "\[Epsilon]y"}], "==", 
    RowBox[{"XAyA", "+", "XAya", "+", "XayA", "+", "Xaya"}]}], "/.", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "XAf"}]}]}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.6762058834850693`*^9, 3.676205896199106*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.676205606183573*^9, {3.67620588002642*^9, 3.676205896776825*^9}, 
   3.67629750955724*^9, 3.676331473646187*^9, 3.676570779000814*^9, 
   3.676578081694895*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.676205606183573*^9, {3.67620588002642*^9, 3.676205896776825*^9}, 
   3.67629750955724*^9, 3.676331473646187*^9, 3.676570779000814*^9, 
   3.676578081699139*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.676205606183573*^9, {3.67620588002642*^9, 3.676205896776825*^9}, 
   3.67629750955724*^9, 3.676331473646187*^9, 3.676570779000814*^9, 
   3.676578081701861*^9}]
}, Open  ]],

Cell["\<\
After diploid selection (which can differ between males and females) the \
frequencies of the diploid genotypes in each sex are\
\>", "Text",
 CellChangeTimes->{{3.6756467552456417`*^9, 3.67564676342205*^9}, {
   3.675702725992881*^9, 3.67570275267984*^9}, 3.676199586169319*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"wbarF", "=", 
    RowBox[{
     RowBox[{"FAA", " ", "XAXA"}], "+", 
     RowBox[{"FAa", " ", "XAXa"}], "+", 
     RowBox[{"Faa", " ", "XaXa"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXAs", "=", 
   RowBox[{"FAA", " ", 
    RowBox[{"XAXA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXas", "=", 
   RowBox[{"FAa", " ", 
    RowBox[{"XAXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaXas", "=", 
    RowBox[{"Faa", " ", 
     RowBox[{"XaXa", "/", "wbarF"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wbarM", "=", 
    RowBox[{
     RowBox[{"MAA", " ", "XAYA"}], "+", 
     RowBox[{"MAa", " ", 
      RowBox[{"(", 
       RowBox[{"XAYa", "+", "XaYA"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XaYa"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"ignore", " ", "rare", " ", "mutants"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XaYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaYas", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XaYa", "/", "wbarM"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAya", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XayA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xayas", "=", 
   RowBox[{"Maa", " ", 
    RowBox[{"Xaya", "/", "wbarM"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646788099258*^9, 3.675646827315172*^9}, {
   3.675646906255657*^9, 3.6756471746197577`*^9}, {3.6756477305962267`*^9, 
   3.675647791098443*^9}, {3.675693609968581*^9, 3.6756936401475143`*^9}, {
   3.675702773030509*^9, 3.675702825109133*^9}, {3.6757958668524837`*^9, 
   3.675796079670739*^9}, {3.675796179417987*^9, 3.675796260462306*^9}, {
   3.675796480404418*^9, 3.675796481420582*^9}, {3.675796553441423*^9, 
   3.67579667834494*^9}, {3.6757967212634993`*^9, 3.67579673565335*^9}, {
   3.675796766370957*^9, 3.675796913595641*^9}, {3.675796952452533*^9, 
   3.675796955994008*^9}, {3.6757970625420837`*^9, 3.675797062966584*^9}, {
   3.675797156973634*^9, 3.675797157898295*^9}, {3.675797509731503*^9, 
   3.6757975122266283`*^9}, 3.6757987828785143`*^9, {3.675798997687969*^9, 
   3.675798999203364*^9}, {3.676143759564913*^9, 3.676143876897674*^9}, {
   3.6761439480553083`*^9, 3.676143948190496*^9}, {3.676146793545115*^9, 
   3.67614684534789*^9}, 3.6761995861704493`*^9, {3.676205614675086*^9, 
   3.6762056178719597`*^9}}],

Cell["\<\
Check that frequencies of diploid genotypes in each sex sum to one after \
diploid selection:\
\>", "Text",
 CellChangeTimes->{{3.67569367511821*^9, 3.6756936990142593`*^9}, {
   3.675702840764554*^9, 3.675702847452877*^9}, 3.676199586171295*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAXAs", "+", "XAXas", "+", "XaXas"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "\[Equal]", 
   RowBox[{"XAYAs", "+", "XAYas", "+", "XaYAs", "+", "XaYas"}]}], "//", 
  "Factor"}]}], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.676205623884274*^9, 3.6762059177767057`*^9, 
  3.676297509642558*^9, 3.6763314737147427`*^9, 3.676570779082673*^9, 
  3.676578081829523*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.676205623884274*^9, 3.6762059177767057`*^9, 
  3.676297509642558*^9, 3.6763314737147427`*^9, 3.676570779082673*^9, 
  3.67657808183342*^9}]
}, Open  ]],

Cell["Finally, meiosis occurs.", "Text",
 CellChangeTimes->{{3.675647183205927*^9, 3.675647193439426*^9}, {
   3.675702857268779*^9, 3.6757029057817707`*^9}, 3.676144147033208*^9, 
   3.676199586173295*^9}],

Cell["Eggs/ovules are produced by females:", "Text",
 CellChangeTimes->{{3.5358035703823357`*^9, 3.5358035880216312`*^9}, {
   3.540035348335928*^9, 3.540035358302086*^9}, {3.674493953287428*^9, 
   3.674494012419855*^9}, 3.675799601278284*^9, {3.676143982806048*^9, 
   3.676144009190897*^9}, 3.6761995861734257`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAfprime", "=", 
   RowBox[{"XAXAs", "+", 
    RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xafprime", "=", 
   RowBox[{"XaXas", "+", 
    RowBox[{"XAXas", "/", "2"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675799680833715*^9, 3.6757996941412067`*^9}, {
   3.676149324316855*^9, 3.676149325544795*^9}, {3.6761494980620604`*^9, 
   3.676149499624743*^9}, 3.676199586173596*^9}],

Cell["Check that frequencies sum to one", "Text",
 CellChangeTimes->{{3.6761441340031767`*^9, 3.676144138482572*^9}, 
   3.676199586174081*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAfprime", "+", "Xafprime"}]}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.676205922481855*^9, 3.676205923325824*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6762056328519506`*^9, 3.676205923728698*^9, 
  3.676297509709491*^9, 3.676331473781797*^9, 3.676570779184855*^9, 
  3.676578082016883*^9}]
}, Open  ]],

Cell["\<\
Pollen/sperm are produced by males:
r is the recombination rate between A and Y\
\>", "Text",
 CellChangeTimes->{{3.540035437149768*^9, 3.54003544478056*^9}, {
   3.540035542732253*^9, 3.540035542939846*^9}, 3.5400356972463627`*^9, {
   3.540035923604535*^9, 3.540036040586349*^9}, {3.540036213760168*^9, 
   3.540036242159268*^9}, {3.540036754700008*^9, 3.540036803790543*^9}, {
   3.54003685846948*^9, 3.540036984706725*^9}, {3.54003701775928*^9, 
   3.540037032315583*^9}, 3.540038125811358*^9, {3.556916665584009*^9, 
   3.55691668126228*^9}, {3.5569168428514147`*^9, 3.556916888640827*^9}, {
   3.556916933311759*^9, 3.556917080494673*^9}, {3.674494049278042*^9, 
   3.674494087250461*^9}, {3.674677710333157*^9, 3.67467771370854*^9}, 
   3.67467801036736*^9, {3.675799994654408*^9, 3.675800008557496*^9}, {
   3.675800063694265*^9, 3.6758001631762867`*^9}, {3.675800903709487*^9, 
   3.675800910209898*^9}, {3.675897375419611*^9, 3.6758973763555727`*^9}, {
   3.6761440055263147`*^9, 3.676144020885846*^9}, {3.676147035176601*^9, 
   3.676147035340662*^9}, {3.676147096324484*^9, 3.676147096477008*^9}, 
   3.676199586175479*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAmprime", " ", "=", 
   RowBox[{"XAYAs", "+", 
    RowBox[{"XAYas", 
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}]}], "+", 
    RowBox[{"XaYAs", " ", "r"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Xamprime", " ", "=", 
    RowBox[{
     RowBox[{"XAYas", " ", "r"}], "+", 
     RowBox[{"XaYAs", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "r"}], ")"}]}], "+", "XaYas"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"YAprime", " ", "=", 
   RowBox[{"XAYAs", "+", 
    RowBox[{"XAYas", " ", "r"}], "+", 
    RowBox[{"XaYAs", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yaprime", " ", "=", 
   RowBox[{
    RowBox[{"XAYas", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}]}], "+", 
    RowBox[{"XaYAs", " ", "r"}], "+", "XaYas"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675800318268052*^9, 3.675800364577742*^9}, {
   3.675800865098575*^9, 3.675800884623233*^9}, {3.675800930421735*^9, 
   3.675801014309965*^9}, {3.675801186092061*^9, 3.6758012139661913`*^9}, {
   3.675801288344637*^9, 3.6758013193919163`*^9}, 3.6758013515875397`*^9, 
   3.675803064876067*^9, {3.675804066393259*^9, 3.675804153401239*^9}, {
   3.6758041863032217`*^9, 3.6758043374296703`*^9}, {3.675804379631474*^9, 
   3.675804405220408*^9}, {3.675804468773355*^9, 3.6758044760993967`*^9}, {
   3.6758045933291197`*^9, 3.6758046212813377`*^9}, {3.67580471281376*^9, 
   3.675804990041334*^9}, {3.675807250863433*^9, 3.675807267889496*^9}, {
   3.6758682828614893`*^9, 3.675868466544877*^9}, {3.675868847460205*^9, 
   3.675868879272049*^9}, {3.6758689945484457`*^9, 3.675869057323271*^9}, {
   3.6758692719968433`*^9, 3.675869505863051*^9}, {3.675869548461001*^9, 
   3.675869585213458*^9}, {3.675869672096408*^9, 3.675869707584916*^9}, {
   3.6758697924963293`*^9, 3.6758697988408422`*^9}, {3.6758701927023563`*^9, 
   3.675870195453092*^9}, {3.675884173345504*^9, 3.675884174905342*^9}, 
   3.675884205449786*^9, {3.675884613602296*^9, 3.675884726757524*^9}, {
   3.6758847843497334`*^9, 3.675884792191498*^9}, {3.6758877458634987`*^9, 
   3.67588780384052*^9}, {3.675888599989387*^9, 3.6758886145965652`*^9}, {
   3.675889229466887*^9, 3.675889260919652*^9}, {3.675889303528616*^9, 
   3.67588933806083*^9}, {3.675896536777073*^9, 3.67589656979839*^9}, {
   3.6758966227806807`*^9, 3.67589663667232*^9}, {3.6758966752114058`*^9, 
   3.675896710149926*^9}, {3.675896944667272*^9, 3.675897162875085*^9}, {
   3.675897210236834*^9, 3.6758972821423197`*^9}, {3.676144028322125*^9, 
   3.676144070993865*^9}, {3.6761441769596453`*^9, 3.676144441895192*^9}, {
   3.676146910825089*^9, 3.6761469144318743`*^9}, {3.6761471000425863`*^9, 
   3.676147100371335*^9}, 3.676199586175791*^9}],

Cell["\<\
Check that the frequencies of A and a sum to one in each gamete type\
\>", "Text",
 CellChangeTimes->{{3.6761459247647343`*^9, 3.67614593273203*^9}, {
   3.6761471061486473`*^9, 3.676147118206574*^9}, 3.676199586176283*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAmprime", "+", "Xamprime"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"YAprime", "+", "Yaprime"}]}], "//", "Factor"}]}], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6762056421181583`*^9, 3.6762059277947693`*^9, 
  3.676297509791378*^9, 3.676331473847481*^9, 3.6765707792505617`*^9, 
  3.676578082213728*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6762056421181583`*^9, 3.6762059277947693`*^9, 
  3.676297509791378*^9, 3.676331473847481*^9, 3.6765707792505617`*^9, 
  3.676578082217596*^9}]
}, Open  ]],

Cell["\<\
Now, the frequency of A on the neo-y in the next generation is\
\>", "Text",
 CellChangeTimes->{{3.6761471255004587`*^9, 3.676147125916456*^9}, {
   3.676147502804685*^9, 3.676147521388979*^9}, 3.676199586178114*^9, {
   3.676205669611494*^9, 3.6762056742255783`*^9}, {3.676577423863628*^9, 
   3.6765774273909073`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xAprime", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"XAyAs", "+", 
     RowBox[{"XAyas", " ", "R"}], "+", 
     RowBox[{"XayAs", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}]}]}], 
    RowBox[{"XAyAs", "+", 
     RowBox[{"XAyas", " ", "R"}], "+", 
     RowBox[{"XayAs", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}]}], "+", 
     RowBox[{"XAyas", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}]}], "+", 
     RowBox[{"XayAs", " ", "R"}], "+", "Xayas"}]], "//", 
   "Factor"}]}]], "Input",
 CellChangeTimes->{{3.676206165746891*^9, 3.676206168430148*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "MAa"}], " ", "wA", " ", "xA", " ", "Xaf"}], "+", 
    RowBox[{"MAa", " ", "R", " ", "wA", " ", "xA", " ", "Xaf"}], "-", 
    RowBox[{"MAa", " ", "R", " ", "wa", " ", "XAf"}], "+", 
    RowBox[{"MAa", " ", "R", " ", "wa", " ", "xA", " ", "XAf"}], "-", 
    RowBox[{"MAA", " ", "wA", " ", "xA", " ", "XAf"}]}], 
   RowBox[{
    RowBox[{"Maa", " ", "wa", " ", "Xaf"}], "-", 
    RowBox[{"Maa", " ", "wa", " ", "xA", " ", "Xaf"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "xA", " ", "Xaf"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAf"}], "-", 
    RowBox[{"MAa", " ", "wa", " ", "xA", " ", "XAf"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "xA", " ", "XAf"}]}]]}]], "Output",
 CellChangeTimes->{3.676205650451346*^9, 3.676205930962201*^9, 
  3.6762061690041018`*^9, 3.676297509866753*^9, 3.676331473931458*^9, 
  3.676570779295562*^9, 3.676578082262344*^9}]
}, Open  ]],

Cell["\<\
And the growth rate of the neo-y is\
\>", "Text",
 CellChangeTimes->{{3.676147800730928*^9, 3.676147823628798*^9}, 
   3.676199586179883*^9, {3.676577432637713*^9, 3.676577434734714*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RA", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"XAyAs", "+", 
     RowBox[{"XAyas", " ", "R"}], "+", 
     RowBox[{"XayAs", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}]}], "+", 
     RowBox[{"XAyas", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}]}], "+", 
     RowBox[{"XayAs", " ", "R"}], "+", "Xayas"}], "\[Epsilon]y"], "//", 
   "Factor"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "Maa"}], " ", "wa", " ", "Xaf"}], "+", 
     RowBox[{"Maa", " ", "wa", " ", "xA", " ", "Xaf"}], "-", 
     RowBox[{"MAa", " ", "wA", " ", "xA", " ", "Xaf"}], "-", 
     RowBox[{"MAa", " ", "wa", " ", "XAf"}], "+", 
     RowBox[{"MAa", " ", "wa", " ", "xA", " ", "XAf"}], "-", 
     RowBox[{"MAA", " ", "wA", " ", "xA", " ", "XAf"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"wa", " ", "Ya"}], "+", 
     RowBox[{"wA", " ", "YA"}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "wa"}], "+", 
     RowBox[{"wa", " ", "xA"}], "-", 
     RowBox[{"wA", " ", "xA"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Maa", " ", "wa", " ", "Xaf", " ", "Ya"}], "+", 
     RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "Ya"}], "+", 
     RowBox[{"MAa", " ", "wA", " ", "Xaf", " ", "YA"}], "+", 
     RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}]}]]], "Output",\

 CellChangeTimes->{3.67620565691848*^9, 3.67620593382829*^9, 
  3.676297509929885*^9, 3.676331474002404*^9, 3.676570779371256*^9, 
  3.676578082344108*^9}]
}, Open  ]],

Cell["\<\
This collapses to van Doorn and Kirkpatrick under special circumstances \
(bottom page 3)\
\>", "Text",
 CellChangeTimes->{{3.676152735070064*^9, 3.676152754087295*^9}, 
   3.67619958618145*^9, {3.676582344731991*^9, 3.6765823534894047`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"RA", "/.", 
              RowBox[{"wA", "\[Rule]", "1"}]}], "/.", 
             RowBox[{"wa", "\[Rule]", "1"}]}], "/.", 
            RowBox[{"Maa", "\[Rule]", "1"}]}], "/.", 
           RowBox[{"MAa", "\[Rule]", 
            RowBox[{"1", "+", 
             RowBox[{"hAm", " ", "sAm"}]}]}]}], "/.", 
          RowBox[{"MAA", "\[Rule]", 
           RowBox[{"1", "+", "sAm"}]}]}], "/.", 
         RowBox[{"Faa", "\[Rule]", "1"}]}], "/.", 
        RowBox[{"FAa", "\[Rule]", 
         RowBox[{"1", "+", 
          RowBox[{"hAf", " ", "sAf"}]}]}]}], "/.", 
       RowBox[{"FAA", "\[Rule]", 
        RowBox[{"1", "+", "sAf"}]}]}], "/.", 
      RowBox[{"Ya", "\[Rule]", 
       RowBox[{"1", "-", "YA"}]}]}], "/.", 
     RowBox[{"Xam", "\[Rule]", 
      RowBox[{"1", "-", "XAm"}]}]}], "/.", 
    RowBox[{"Xaf", "\[Rule]", 
     RowBox[{"1", "-", "XAf"}]}]}], "/.", 
   RowBox[{"xa", "\[Rule]", 
    RowBox[{"1", "-", "xA"}]}]}], "//", "FullSimplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "+", 
   RowBox[{"sAm", " ", "xA", " ", "XAf"}], "+", 
   RowBox[{"hAm", " ", "sAm", " ", 
    RowBox[{"(", 
     RowBox[{"xA", "+", "XAf", "-", 
      RowBox[{"2", " ", "xA", " ", "XAf"}]}], ")"}]}]}], 
  RowBox[{"1", "+", 
   RowBox[{"sAm", " ", "XAf", " ", "YA"}], "+", 
   RowBox[{"hAm", " ", "sAm", " ", 
    RowBox[{"(", 
     RowBox[{"XAf", "+", "YA", "-", 
      RowBox[{"2", " ", "XAf", " ", "YA"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{3.676205683653319*^9, 3.676205936378998*^9, 
  3.6762975102260313`*^9, 3.6763314743080997`*^9, 3.676570779560524*^9, 
  3.676578082634514*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Equilibrium", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9, 3.676206076324637*^9}],

Cell["\<\
We now solve for the equilibrium frequency of A in each of the haploid \
genotypes. Equilibrium is achieved when the following equations are zero\
\>", "Text",
 CellChangeTimes->{{3.675694155902801*^9, 3.675694193760104*^9}, {
  3.6756944337868023`*^9, 3.6756944351881227`*^9}, {3.6757029847267847`*^9, 
  3.67570303405547*^9}, {3.675710696458521*^9, 3.675710706286772*^9}, {
  3.676206098927346*^9, 3.67620611994131*^9}, {3.676582413597246*^9, 
  3.676582413722025*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqs", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAfprime", "-", "XAf"}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAmprime", "-", "XAm"}], ",", "\[IndentingNewLine]", 
     RowBox[{"YAprime", "-", "YA"}], ",", "\[IndentingNewLine]", 
     RowBox[{"xAprime", "-", "xA"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675647987041369*^9, 3.67564802904979*^9}, {
   3.675650509895372*^9, 3.675650527299842*^9}, {3.6756941716513157`*^9, 
   3.6756941738671913`*^9}, {3.675694338488646*^9, 3.675694340978696*^9}, {
   3.675694394143187*^9, 3.6756944261522427`*^9}, 3.6756944751724463`*^9, 
   3.675702984727247*^9, {3.675703036868017*^9, 3.675703037688758*^9}, 
   3.67578824463701*^9, {3.6762061216237183`*^9, 3.676206147752295*^9}, {
   3.6762061820923433`*^9, 3.676206183709196*^9}}],

Cell["\<\
To simplify the analysis we assume weak selection in both haploids \
(sperm/pollen) and diploids\
\>", "Text",
 CellChangeTimes->{{3.675694205010009*^9, 3.675694211923259*^9}, 
   3.67570298472752*^9, {3.6757030454432507`*^9, 3.6757030568360033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weaksel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAm", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAm", " ", "sAm", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Maa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAf", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAf", " ", "sAf", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Faa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"wA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"t", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"wa", "\[Rule]", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67564806523287*^9, 3.675648221558539*^9}, {
   3.675694367971285*^9, 3.6756943845803022`*^9}, 3.6757029847280283`*^9}],

Cell["We can write the frequencies as Taylor series", "Text",
 CellChangeTimes->{{3.675707045047565*^9, 3.6757070543930063`*^9}, {
  3.675707367038864*^9, 3.675707370179316*^9}, {3.675711803871513*^9, 
  3.6757118112225847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frequenciessub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", 
      RowBox[{"XAf0", "+", 
       RowBox[{"XAf1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAm", "\[Rule]", 
      RowBox[{"XAm0", "+", 
       RowBox[{"XAm1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YA", "\[Rule]", 
      RowBox[{"YA0", "+", 
       RowBox[{"YA1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"xA", "\[Rule]", 
      RowBox[{"xA0", "+", 
       RowBox[{"xA1", " ", "\[Epsilon]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675648297857716*^9, 3.6756483630660057`*^9}, 
   3.675648454638584*^9, 3.675702984736863*^9, {3.6762068917424583`*^9, 
   3.676206901931716*^9}}],

Cell["\<\
Without selection, the recursions for the change in frequency of A in each \
gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.6757032054455214`*^9, 3.6757032697493563`*^9}, {
   3.6757098202812138`*^9, 3.675709824765788*^9}, {3.6757117765596933`*^9, 
   3.6757117850524673`*^9}, {3.675711818872109*^9, 3.6757118199810133`*^9}, 
   3.6761381565029078`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs0", "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "frequenciessub"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.675703197099375*^9, 3.675703198353765*^9}, {
  3.675703326603519*^9, 3.675703332003808*^9}, {3.67570336997014*^9, 
  3.675703373531238*^9}, {3.675707060003501*^9, 3.675707071963544*^9}, {
  3.675707629815399*^9, 3.675707668691402*^9}, {3.6757098279293118`*^9, 
  3.6757098635569563`*^9}, {3.675785533464711*^9, 3.675785543888385*^9}, {
  3.675788240589053*^9, 3.675788247183043*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "XAf0"}], "+", "XAm0"}], ")"}]}], ",", 
   RowBox[{"XAf0", "-", 
    RowBox[{"r", " ", "XAf0"}], "-", "XAm0", "+", 
    RowBox[{"r", " ", "YA0"}]}], ",", 
   RowBox[{
    RowBox[{"r", " ", "XAf0"}], "-", 
    RowBox[{"r", " ", "YA0"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "R"}], " ", "xA0"}], "+", 
    RowBox[{"R", " ", "XAf0"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675703373832204*^9, 3.675707072550578*^9, 3.6757076390361347`*^9, 
   3.675707669538135*^9, {3.675709828918172*^9, 3.6757098643685303`*^9}, 
   3.675727585946179*^9, 3.675785428940669*^9, 3.675788254779942*^9, 
   3.6761381624813623`*^9, 3.676146369707528*^9, 3.676205569877428*^9, 
   3.676206197071246*^9, 3.676206906572702*^9, 3.676297519938478*^9, 
   3.676331482213591*^9, 3.676570779809972*^9, 3.676578085302965*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675709831409095*^9, 3.6757098343025913`*^9}, {
  3.675710744701475*^9, 3.675710745621426*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"differenceEqs0", "\[Equal]", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"XAf0", ",", "XAm0", ",", "YA0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675709931730151*^9, 3.675709948227565*^9}, 
   3.676138176648445*^9, {3.676206210111945*^9, 3.676206222819953*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"XAf0", "\[Rule]", "xA0"}], ",", 
    RowBox[{"XAm0", "\[Rule]", "xA0"}], ",", 
    RowBox[{"YA0", "\[Rule]", "xA0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6757098363525476`*^9, {3.6757099323567266`*^9, 3.675709948639193*^9}, 
   3.675727587389184*^9, 3.675785430130021*^9, 3.67578825590738*^9, {
   3.676138165134851*^9, 3.676138177014187*^9}, 3.676146369743536*^9, 
   3.6762055698992853`*^9, {3.676206202720709*^9, 3.676206223421821*^9}, 
   3.676206909229083*^9, 3.676297519977676*^9, 3.6763314822510242`*^9, 
   3.676570779849722*^9, 3.676578085332281*^9}]
}, Open  ]],

Cell["\<\
So, with no selection, the equilibrium frequency of A in each gamete/pollen \
type is equal (and we call this pA).\
\>", "Text",
 CellChangeTimes->{{3.675703427939505*^9, 3.6757035626138153`*^9}, {
   3.675706719194449*^9, 3.675706765062245*^9}, 3.67570996472328*^9, {
   3.6757107664993973`*^9, 3.675710849444377*^9}}],

Cell["\<\
Now, looking at only the first order selection terms, the recursions for the \
change in frequency of A in each gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.67570356712366*^9, 3.675703572187316*^9}, {
  3.67570609431063*^9, 3.675706097287983*^9}, {3.6757069069525433`*^9, 
  3.6757069072532797`*^9}, {3.67571091918222*^9, 3.6757109367564697`*^9}, {
  3.675711772412171*^9, 3.67571177325072*^9}, {3.675716463608975*^9, 
  3.67571647265489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs1", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
              RowBox[{"Xaf", "\[Rule]", 
               RowBox[{"1", "-", "XAf"}]}]}], "/.", 
             RowBox[{"Ya", "\[Rule]", 
              RowBox[{"1", "-", "YA"}]}]}], "/.", 
            RowBox[{"Xam", "\[Rule]", 
             RowBox[{"1", "-", "XAm"}]}]}], "/.", "frequenciessub"}], "/.", 
          "sol0"}], "/.", 
         RowBox[{"xA0", "\[Rule]", "pA"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
     ",", "\[Epsilon]", ",", "FullSimplify"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757068495866413`*^9, 3.6757068907711554`*^9}, {
   3.6757069302403297`*^9, 3.675706982461239*^9}, {3.675707087605297*^9, 
   3.6757071228419533`*^9}, {3.67570718969317*^9, 3.675707319107386*^9}, {
   3.675707511314725*^9, 3.675707512612761*^9}, {3.675710885258552*^9, 
   3.675710885357044*^9}, {3.675711221036006*^9, 3.675711227798399*^9}, {
   3.675788237526182*^9, 3.6757882495037823`*^9}, {3.676206330042294*^9, 
   3.676206330302553*^9}, 3.67620692373077*^9, {3.6762986203392563`*^9, 
   3.6762986377813377`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "pA", " ", "sAf"}], "+", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", "t"}], 
        ")"}]}], "-", "XAf1", "+", "XAm1"}], ")"}], " ", "\[Epsilon]"}], ",", 
   
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["pA", "3"]}], " ", "sAm"}], "+", 
      RowBox[{"hAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "r", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"sAm", "-", 
         RowBox[{"r", " ", "t"}]}], ")"}]}], "+", "XAf1", "-", 
      RowBox[{"r", " ", "XAf1"}], "-", "XAm1", "+", 
      RowBox[{"r", " ", "YA1"}]}], ")"}], " ", "\[Epsilon]"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["pA", "3"]}], " ", "sAm"}], "+", 
      RowBox[{"hAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"sAm", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "t"}]}], ")"}]}], "+", 
      RowBox[{"pA", " ", 
       RowBox[{"(", 
        RowBox[{"t", "-", 
         RowBox[{"r", " ", "t"}]}], ")"}]}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"XAf1", "-", "YA1"}], ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
   ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        SuperscriptBox["pA", "3"]}], " ", "sAm"}], "+", 
      RowBox[{"hAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"sAm", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "t"}]}], ")"}]}], "+", 
      RowBox[{"pA", " ", 
       RowBox[{"(", 
        RowBox[{"t", "-", 
         RowBox[{"R", " ", "t"}]}], ")"}]}], "+", 
      RowBox[{"R", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "xA1"}], "+", "XAf1"}], ")"}]}]}], ")"}], " ", 
    "\[Epsilon]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675706852317442*^9, 3.675706918829287*^9}, {
   3.675706950931774*^9, 3.675706982932413*^9}, {3.6757070910767508`*^9, 
   3.675707123327277*^9}, {3.6757071925330353`*^9, 3.675707319486848*^9}, 
   3.675707513296742*^9, 3.67570768217498*^9, {3.675710857628578*^9, 
   3.675710885875184*^9}, {3.675711222477412*^9, 3.67571122814371*^9}, 
   3.67572758892033*^9, 3.675785431200643*^9, 3.6757882566822844`*^9, 
   3.67613819572523*^9, 3.6761463697988167`*^9, 3.67620556995926*^9, 
   3.676206237812422*^9, 3.676206331113261*^9, {3.6762069128046007`*^9, 
   3.6762069243203497`*^9}, 3.676297520059561*^9, {3.676298622238855*^9, 
   3.676298638439507*^9}, 3.676331482642354*^9, 3.6765707802188673`*^9, 
   3.676578085817657*^9}]
}, Open  ]],

Cell["\<\
Instead of solving for the first order genotype frequencies we will instead \
solve for the difference in the frequency of A in the different gamete/pollen \
types.\
\>", "Text",
 CellChangeTimes->{{3.6757135825548286`*^9, 3.675713633862471*^9}, 
   3.6757138892769423`*^9, {3.675716482887339*^9, 3.6757164842940083`*^9}}],

Cell["\<\
The difference in the frequency of A with X in females and X in males is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.6757138909855633`*^9, 3.675713959445539*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfXm", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"XAf1", "\[Rule]", 
       RowBox[{"dpAXfXm", "+", "XAm1"}]}]}], ",", "dpAXfXm"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.67571264493021*^9, 3.675712689537509*^9}, {
   3.675712721625124*^9, 3.675712730987232*^9}, {3.6757136496293707`*^9, 
   3.6757136649001226`*^9}, {3.675716490314892*^9, 3.675716491532194*^9}, 
   3.676138201444324*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfXm", "\[Rule]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "hAf", " ", "sAf"}], "-", 
      RowBox[{"2", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", "pA", " ", "sAf"}], "-", "t"}], ")"}]}]}],
   "}"}]], "Output",
 CellChangeTimes->{{3.675712649738289*^9, 3.675712661484269*^9}, 
   3.675712732353135*^9, 3.6757136656167507`*^9, 3.675716491898244*^9, 
   3.6757275909002647`*^9, 3.675785432660453*^9, 3.675788258653908*^9, 
   3.676138202533581*^9, 3.676146369841419*^9, 3.67620556998715*^9, 
   3.676206252856477*^9, 3.676206333825591*^9, 3.676206927964473*^9, 
   3.676297520092165*^9, 3.676331482683996*^9, 3.6765707802549677`*^9, 
   3.676578085929885*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in males and Y is (at equilibrium \
to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713966791181*^9, 3.6757139830606413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXmY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"differenceEqs1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
        RowBox[{"XAf1", "\[Rule]", 
         RowBox[{"dpAXfXm", "+", "XAm1"}]}]}], "/.", "eqdpAXfXm"}], "/.", 
      RowBox[{"XAm1", "\[Rule]", 
       RowBox[{"dpAXmY", "+", "YA1"}]}]}], ",", "dpAXmY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757127688027287`*^9, 3.675712794290226*^9}, {
   3.6757128674967947`*^9, 3.675712955948361*^9}, {3.675713232210559*^9, 
   3.675713326592478*^9}, {3.675713674096274*^9, 3.6757136876868258`*^9}, {
   3.6757164945548773`*^9, 3.675716495980947*^9}, 3.67613820556537*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXmY", "\[Rule]", 
   RowBox[{
    FractionBox["1", "r"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "r", " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "-", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675713327517667*^9, {3.675713675336254*^9, 3.6757136899362087`*^9}, 
   3.675716496367241*^9, 3.67572759200576*^9, 3.675785433424408*^9, 
   3.675788259415702*^9, 3.67613820593443*^9, 3.676146369870596*^9, 
   3.676205570023275*^9, 3.6762062700406523`*^9, 3.6762063358443003`*^9, 
   3.676206929614828*^9, 3.6762975201311283`*^9, 3.676331482719976*^9, 
   3.676570780305231*^9, 3.6765780860148687`*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in females and Y is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713993050933*^9, 3.6757140012817707`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"XAf1", "\[Rule]", 
       RowBox[{"dpAXfY", "+", "YA1"}]}]}], ",", "dpAXfY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757133432729*^9, 3.6757133796267223`*^9}, {
   3.675713699819319*^9, 3.675713703005155*^9}, {3.67571649868948*^9, 
   3.675716499747883*^9}, 3.676138209372942*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfY", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "hAm"}], " ", "pA", " ", "sAm"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{"3", " ", "hAm", " ", 
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"2", " ", "hAm", " ", 
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"pA", " ", "t"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "t"}], "+", 
     RowBox[{"pA", " ", "r", " ", "t"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], "r"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675713343667881*^9, 3.675713380152212*^9}, 
   3.675713703634624*^9, 3.675716500081162*^9, 3.675727593224564*^9, 
   3.67578543490516*^9, 3.675788260830711*^9, 3.6761382097330837`*^9, 
   3.676146369921947*^9, 3.676205570073062*^9, 3.676206272424686*^9, 
   3.676206338625866*^9, 3.67620693171352*^9, 3.676297520179927*^9, 
   3.676331482767943*^9, 3.676570780353633*^9, 3.676578086117731*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in females and with y is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.67620668720214*^9, 3.676206694600065*^9}, {
  3.676206748941304*^9, 3.676206762757042*^9}, {3.676206814428582*^9, 
  3.676206815834803*^9}, {3.676207047232016*^9, 3.6762070532708406`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAyXf", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "[", 
        RowBox[{"[", "4", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"xA1", "\[Rule]", 
       RowBox[{"dpAyXf", "+", "XAf1"}]}]}], ",", "dpAyXf"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6762068435486403`*^9, 3.676206872854899*^9}, {
  3.6762069399855967`*^9, 3.676206978818801*^9}, {3.676207056290737*^9, 
  3.676207098002654*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAyXf", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
     RowBox[{"3", " ", "hAm", " ", 
      SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
     RowBox[{"2", " ", "hAm", " ", 
      SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
     RowBox[{"pA", " ", "t"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "t"}], "-", 
     RowBox[{"pA", " ", "R", " ", "t"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "R", " ", "t"}]}], "R"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.676206839776381*^9, 3.6762068733286953`*^9}, 
   3.6762069349813213`*^9, 3.6762069874654913`*^9, 3.6762070600857964`*^9, {
   3.676207091352385*^9, 3.676207098303117*^9}, 3.676297520207323*^9, 
   3.676331482815321*^9, 3.676570780399734*^9, 3.676578086417328*^9}]
}, Open  ]],

Cell["\<\
So then, to first order, the equilibrium haploid genotype frequencies are\
\>", "Text",
 CellChangeTimes->{{3.6757175107821083`*^9, 3.675717533841239*^9}, {
  3.6761417305097446`*^9, 3.676141730843671*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqXAf", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"XAf0", "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXmY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"xA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXmY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675716895475359*^9, 3.675716900512623*^9}, {
   3.675717278127964*^9, 3.675717294591033*^9}, {3.675717351754582*^9, 
   3.675717366375647*^9}, {3.675717543006982*^9, 3.675717544667244*^9}, {
   3.6757178596731443`*^9, 3.675717863093356*^9}, 3.6762063628843603`*^9, 
   3.676207117028911*^9}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
         RowBox[{"hAm", " ", "sAm"}], "-", 
         RowBox[{"pA", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "sAf"}], "+", "sAm", "-", 
            RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]", "-", 
            RowBox[{"pA", " ", "\[Epsilon]"}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.6757169011353207`*^9, 3.6757173669613256`*^9, 3.6757175450525827`*^9, 
   3.675717864205447*^9, 3.675727594742791*^9, 3.675785436211323*^9, 
   3.675788261479598*^9, 3.6761382181729927`*^9, 3.67614636998634*^9, 
   3.676205570138258*^9, 3.676206275135827*^9, {3.676206340941736*^9, 
   3.676206363326641*^9}, {3.6762071127566023`*^9, 3.676207117605204*^9}, 
   3.6762975202596693`*^9, 3.67633148288348*^9, 3.676570780453168*^9, 
   3.676578086568618*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqXAm", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"XAm0", "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"xA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXfY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675716688271459*^9, 3.6757167143895473`*^9}, {
   3.675716769539331*^9, 3.6757167848745613`*^9}, {3.675716835976749*^9, 
   3.6757168663757353`*^9}, {3.675717219433107*^9, 3.675717236319748*^9}, {
   3.675717303688327*^9, 3.675717309958682*^9}, {3.675717548817417*^9, 
   3.675717549768239*^9}, {3.67571786788925*^9, 3.675717869340398*^9}, 
   3.6762063659196672`*^9, 3.676207120270516*^9}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pA"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.6757167147918577`*^9, {3.675716770743403*^9, 3.675716785278078*^9}, {
   3.675716840197975*^9, 3.6757168668171043`*^9}, 3.675717236886405*^9, 
   3.675717371726769*^9, 3.675717550116539*^9, 3.675717875403976*^9, 
   3.675727595426388*^9, 3.6757854369665747`*^9, 3.675788263530697*^9, 
   3.6761382197593737`*^9, 3.676146370055738*^9, 3.676205570198845*^9, 
   3.6762062888273897`*^9, {3.676206343451066*^9, 3.6762063663997517`*^9}, 
   3.676207120725705*^9, 3.676297520315423*^9, 3.6763314829441643`*^9, 
   3.676570780487576*^9, 3.67657808674751*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqYA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"YA0", "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"xA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfY"}], "/.", 
    "eqdpAXfXm"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675717392424321*^9, 3.675717393210609*^9}, {
   3.675717465498665*^9, 3.675717499551214*^9}, {3.67571755307234*^9, 
   3.675717554018692*^9}, {3.6757178713638563`*^9, 3.675717873545209*^9}, 
   3.676206369455371*^9, 3.676207123685582*^9}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.67571750048251*^9, 3.675717554350906*^9, 3.675717874008835*^9, 
   3.675727596078721*^9, 3.6757854378569937`*^9, 3.675788264699403*^9, 
   3.676138221083902*^9, 3.6761463700923843`*^9, 3.676205570233659*^9, 
   3.676206290823811*^9, {3.676206345126548*^9, 3.6762063698272343`*^9}, 
   3.676207124137311*^9, 3.676297520346842*^9, 3.6763314829817657`*^9, 
   3.676570780519195*^9, 3.6765780868857183`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqxA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"xA0", "+", 
          RowBox[{"\[Epsilon]", " ", "dpAXfY"}], "-", 
          RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
          RowBox[{"\[Epsilon]", " ", "dpAyXf"}]}], "/.", "sol0"}], "/.", 
        RowBox[{"xA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfY"}], "/.", 
      "eqdpAXfXm"}], "/.", "eqdpAyXf"}], "/.", "eqdpAXmY"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.676579498494025*^9, 3.676579499136211*^9}, {
  3.676579560434072*^9, 3.676579581689307*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"r", " ", "R"}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "pA", " ", "r", " ", "R", " ", "sAf"}], 
         "+", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "r", " ", "R", " ", 
          "sAf"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{"r", "-", "R"}], ")"}], " ", "sAm"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "pA", " ", 
          RowBox[{"(", 
           RowBox[{"r", "-", "R"}], ")"}], " ", "sAm"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"r", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", "R"}], ")"}], 
          " ", "t"}]}], ")"}], " ", "\[Epsilon]"}]}], ")"}]}], 
   RowBox[{"r", " ", "R"}]], "}"}]], "Output",
 CellChangeTimes->{{3.6765794900829268`*^9, 3.67657950001033*^9}, {
  3.676579561476856*^9, 3.676579582064356*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"eqxA", "/.", 
    RowBox[{"t", "\[Rule]", "0"}]}], "/.", 
   RowBox[{"R", "\[Rule]", 
    RowBox[{"1", "/", "2"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6765795264266777`*^9, 3.6765795366756163`*^9}, {
  3.676579597319757*^9, 3.6765795985278387`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{"r", "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "2"}], " ", "pA", " ", "r", " ", "sAf"}], "+", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "r", " ", "sAf"}], "-", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "pA"}], "+", 
            RowBox[{"hAm", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "pA"}]}], ")"}]}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "r"}]}], ")"}], " ", "sAm"}]}], ")"}], " ", 
       "\[Epsilon]"}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{{3.676579532179158*^9, 3.676579599162259*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"RA", "/.", "weaksel"}], "/.", 
        RowBox[{"Xaf", "\[Rule]", 
         RowBox[{"1", "-", "XAf"}]}]}], "/.", 
       RowBox[{"Ya", "\[Rule]", 
        RowBox[{"1", "-", "YA"}]}]}], "/.", 
      RowBox[{"Xam", "\[Rule]", 
       RowBox[{"1", "-", "XAm"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.676580110146843*^9, 3.676580196740995*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   RowBox[{"sAm", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "XAf"}], "+", 
      RowBox[{"hAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "XAf"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"xA", "-", "YA"}], ")"}], " ", "\[Epsilon]"}], "+", 
   RowBox[{
    SuperscriptBox["sAm", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAf", " ", "YA"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{"XAf", "+", "YA", "-", 
            RowBox[{"2", " ", "XAf", " ", "YA"}]}], ")"}]}]}], ")"}], "2"], 
      "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"xA", " ", "XAf"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{"xA", "+", "XAf", "-", 
            RowBox[{"2", " ", "xA", " ", "XAf"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "XAf"}], " ", "YA"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "YA"}], "+", 
            RowBox[{"XAf", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "YA"}]}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}], " ", 
    SuperscriptBox["\[Epsilon]", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   1, -$CellContext`sAm (-$CellContext`XAf + $CellContext`hAm (-1 + 
       2 $CellContext`XAf)) ($CellContext`xA - $CellContext`YA), \
$CellContext`sAm^2 (($CellContext`XAf $CellContext`YA + $CellContext`hAm \
($CellContext`XAf + $CellContext`YA - 
         2 $CellContext`XAf $CellContext`YA))^2 + ($CellContext`xA \
$CellContext`XAf + $CellContext`hAm ($CellContext`xA + $CellContext`XAf - 
         2 $CellContext`xA $CellContext`XAf)) (-$CellContext`XAf \
$CellContext`YA + $CellContext`hAm (-$CellContext`YA + $CellContext`XAf (-1 + 
           2 $CellContext`YA))))}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.676580110732362*^9, 3.67658016937654*^9}}]
}, Open  ]],

Cell["The change in the equilibrium frequency of A is", "Text",
 CellChangeTimes->{{3.67571806556964*^9, 3.675718103851286*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpA", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"2", " ", "XAfprime"}], "+", "XAmprime", "+", 
                 "YAprime", "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "XAf"}], "-", "XAm", "-", "YA"}], ")"}]}], "/.",
                 "weaksel"}], "/.", 
               RowBox[{"Xaf", "\[Rule]", 
                RowBox[{"1", "-", "XAf"}]}]}], "/.", 
              RowBox[{"Ya", "\[Rule]", 
               RowBox[{"1", "-", "YA"}]}]}], "/.", 
             RowBox[{"Xam", "\[Rule]", 
              RowBox[{"1", "-", "XAm"}]}]}], "/.", 
            RowBox[{"XAf", "\[Rule]", "eqXAf"}]}], "/.", 
           RowBox[{"XAm", "\[Rule]", "eqXAm"}]}], "/.", 
          RowBox[{"YA", "\[Rule]", "eqYA"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
      "/", "4"}], ",", "\[Epsilon]", ",", "Simplify"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675717647887065*^9, 3.675717697126732*^9}, {
   3.675717728154462*^9, 3.675717827465465*^9}, {3.675717886726254*^9, 
   3.6757179766881647`*^9}, {3.675718083857135*^9, 3.6757180905764112`*^9}, 
   3.67571817039502*^9, {3.675719298161072*^9, 3.675719300128034*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"pA", "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
      RowBox[{"hAm", " ", "sAm"}], "-", 
      RowBox[{"pA", " ", 
       RowBox[{"(", 
        RowBox[{"sAf", "+", "sAm", "-", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], ")"}], 
    " ", "\[Epsilon]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675717675625972*^9, 3.675717697744046*^9}, {
   3.675717736995945*^9, 3.675717827905334*^9}, {3.675717912013361*^9, 
   3.6757179770805798`*^9}, {3.675718122247941*^9, 3.675718137314794*^9}, 
   3.675718171232416*^9, {3.675719279665413*^9, 3.6757193043150883`*^9}, 
   3.675727597413587*^9, 3.675785439649287*^9, 3.67578826604628*^9, 
   3.676138226117289*^9, 3.676146370223422*^9, 3.676205570352737*^9, 
   3.676206296389659*^9, {3.67620634706423*^9, 3.676206375228558*^9}, 
   3.676207128152871*^9, 3.676297520582735*^9, 3.676298332781748*^9, 
   3.676331483548442*^9, 3.67657078078118*^9, 3.676578087230349*^9, 
   3.676578734997006*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.6757181100991917`*^9, 3.675718119482112*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpA", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dpA", "-", "pA"}], "\[Equal]", "0"}], ",", "pA"}], "]"}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.675717988879238*^9, 3.67571803095448*^9}, {
  3.6757181277583733`*^9, 3.6757181353000813`*^9}, {3.6757192734183817`*^9, 
  3.6757193075868177`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"hAf", " ", "sAf"}], "+", 
        RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
       RowBox[{"sAf", "-", 
        RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
        RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675717995245247*^9, 3.675718031314158*^9}, {
   3.675718129676858*^9, 3.675718138913946*^9}, 3.67571817443064*^9, {
   3.675719281498005*^9, 3.675719308048888*^9}, 3.675727602150854*^9, 
   3.675785444054607*^9, 3.675788267688079*^9, 3.676138228966215*^9, 
   3.6761463703060913`*^9, 3.676205570544559*^9, 3.676206298808464*^9, {
   3.676206349876573*^9, 3.676206377786057*^9}, 3.676207130419146*^9, 
   3.676297520663327*^9, 3.676331483702094*^9, 3.6765707808531227`*^9, 
   3.67657808761314*^9}]
}, Open  ]],

Cell["\<\
Notice that when t=0 we have equation \[OpenCurlyDoubleQuote]avgpASubs\
\[CloseCurlyDoubleQuote] in van Doorn & Kirkpatrick 2007 (SOM page 6). \
Sperm/pollen selection acts to increase the frequency of A (if selected for: \
t>0).\
\>", "Text",
 CellChangeTimes->{{3.675718177833785*^9, 3.6757182794849873`*^9}, {
  3.676138242309498*^9, 3.67613824280681*^9}}],

Cell["\<\
Also notice that, without sperm/pollen competition, the non-trivial \
equilibrium does not exist when there is no sexually antagonistic selection\
\>", "Text",
 CellChangeTimes->{{3.675721309214287*^9, 3.6757213820811357`*^9}, {
  3.6761417488221397`*^9, 3.676141750861703*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"0", "<", "pA"}], "/.", 
       RowBox[{"eqpA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", ">", "pA"}], "/.", 
       RowBox[{"eqpA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "&&", 
    RowBox[{"sAm", ">", "0"}], "&&", 
    RowBox[{"sAf", ">", "0"}], "&&", 
    RowBox[{"hAf", ">", "0"}], "&&", 
    RowBox[{"hAm", ">", "0"}], "&&", 
    RowBox[{"hAf", "<", "1"}], "&&", 
    RowBox[{"hAm", "<", "1"}]}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.675721205546542*^9, 3.6757213041340637`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.6757212132856903`*^9, 3.675721304688283*^9}, 
   3.6757276039667053`*^9, 3.675785445007743*^9, 3.675788269474324*^9, 
   3.676138247485269*^9, 3.6761463703421097`*^9, 3.676205570701029*^9, 
   3.676206442662768*^9, 3.6762975207081947`*^9, 3.676331483836591*^9, 
   3.676570780887677*^9, 3.676578087784376*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"0", "<", "pA"}], "/.", 
       RowBox[{"eqpA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", ">", "pA"}], "/.", 
       RowBox[{"eqpA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "&&", 
    RowBox[{"sAm", "<", "0"}], "&&", 
    RowBox[{"sAf", "<", "0"}], "&&", 
    RowBox[{"hAf", ">", "0"}], "&&", 
    RowBox[{"hAm", ">", "0"}], "&&", 
    RowBox[{"hAf", "<", "1"}], "&&", 
    RowBox[{"hAm", "<", "1"}]}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.675721356822701*^9, 3.675721358972645*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.675721359354959*^9, 3.675727604482841*^9, 
  3.67578544579348*^9, 3.675788270629342*^9, 3.6761382489845953`*^9, 
  3.676146370374893*^9, 3.676205570738555*^9, 3.6762064440288486`*^9, 
  3.676297520747216*^9, 3.676331483884354*^9, 3.6765707809362717`*^9, 
  3.676578087928213*^9}]
}, Open  ]],

Cell["\<\
But with sperm/pollen competition the non-trivial equilirbium can exist, even \
without sexually antagonistic selection\
\>", "Text",
 CellChangeTimes->{{3.6757213615608473`*^9, 3.6757213940767937`*^9}, {
  3.675721438770338*^9, 3.675721440381878*^9}, {3.675721584413671*^9, 
  3.6757215921481323`*^9}, {3.676138261321*^9, 3.676138268712246*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0", "<", "pA"}], "/.", 
      RowBox[{"eqpA", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", ">", "pA"}], "/.", 
      RowBox[{"eqpA", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "&&", 
    RowBox[{"sAm", "<", "0"}], "&&", 
    RowBox[{"sAf", "<", "0"}], "&&", 
    RowBox[{"hAf", ">", "0"}], "&&", 
    RowBox[{"hAm", ">", "0"}], "&&", 
    RowBox[{"hAf", "<", "1"}], "&&", 
    RowBox[{"hAm", "<", "1"}], "&&", 
    RowBox[{"t", ">", "0"}]}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.675721404126423*^9, 3.6757214202988453`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sAm", "<", "0"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sAf", "\[LessEqual]", "sAm"}], "&&", 
      RowBox[{"0", "<", "hAm", "<", "1"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0", "<", "hAf", "<", 
           FractionBox[
            RowBox[{"sAf", "+", "sAm", "-", 
             RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
            RowBox[{"2", " ", "sAf"}]]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
            RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
           RowBox[{
            RowBox[{"-", "sAf"}], "+", 
            RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
            RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"sAf", "+", "sAm", "-", 
             RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
            RowBox[{"2", " ", "sAf"}]], "<", "hAf", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "sAf"}], "+", 
            RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
            RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
            RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], ")"}], "||", 
    
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sAm", "<", "sAf", "<", "0"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0", "<", "hAm", "\[LessEqual]", 
           FractionBox[
            RowBox[{
             RowBox[{"-", "sAf"}], "+", "sAm"}], 
            RowBox[{"2", " ", "sAm"}]]}], "&&", 
          RowBox[{"0", "<", "hAf", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
            RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
           RowBox[{
            RowBox[{"-", "sAf"}], "+", 
            RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
            RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"-", "sAf"}], "+", "sAm"}], 
            RowBox[{"2", " ", "sAm"}]], "<", "hAm", "<", 
           FractionBox[
            RowBox[{"sAf", "+", "sAm"}], 
            RowBox[{"2", " ", "sAm"}]]}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0", "<", "hAf", "<", 
               FractionBox[
                RowBox[{"sAf", "+", "sAm", "-", 
                 RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
                RowBox[{"2", " ", "sAf"}]]}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
                RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
               RowBox[{
                RowBox[{"-", "sAf"}], "+", 
                RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
                RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"sAf", "+", "sAm", "-", 
                 RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
                RowBox[{"2", " ", "sAf"}]], "<", "hAf", "<", "1"}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "sAf"}], "+", 
                RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
                RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
                RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"sAf", "+", "sAm"}], 
            RowBox[{"2", " ", "sAm"}]], "\[LessEqual]", "hAm", "<", "1"}], "&&", 
          RowBox[{"0", "<", "hAf", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "sAf"}], "+", 
            RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
            RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
            RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.675721408263239*^9, 3.675721421048749*^9}, 
   3.675727605660432*^9, 3.675785446857723*^9, 3.675788271626335*^9, 
   3.676138271231243*^9, 3.676146370423925*^9, 3.676205570789567*^9, 
   3.676206448119183*^9, 3.6762975208629208`*^9, 3.676331483936083*^9, 
   3.6765707809948606`*^9, 3.676578088100183*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"pA", "/.", 
          RowBox[{"eqpA", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
         RowBox[{"sAf", "\[Rule]", 
          RowBox[{"-", "s"}]}]}], "/.", 
        RowBox[{"sAm", "\[Rule]", 
         RowBox[{"-", "s"}]}]}], "/.", 
       RowBox[{"hAf", "\[Rule]", "h"}]}], "/.", 
      RowBox[{"hAm", "\[Rule]", "h"}]}], "/.", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{"1", "/", "10"}]}]}], "/.", 
    RowBox[{"h", "\[Rule]", "1"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67572144834195*^9, 3.675721547741859*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwV0HlYjAkAx/GRikh6NKZpipUnzDqSotJqfypCaJNOBqkYrN2KiJERagtT
ikRlUDqUjJnoeNmp7emwelJylA68HdMxNfNuzXZf2/7xfb7/f4x9A1yPqNFo
tN3T/f9UORH8LtL456qbEaNTUxROqC38K5dOA2dytm/RJIVBJk98k64LxUnB
29AJCpvScth8+hLMc7p9b2SUwvfucv8zdDM4q6dYqgYoSAQf1ILom/H+3J+n
OnoosL59qf2d7oK6wyp5VT2Fak0O8RvdB98tDjclPqdAb9ntHV0SiA0DV3iB
XhSCzJPbNGTnMPsfw/J5sygsDr6hqAkIg5IVVOJQoMRo0OGpnNJwMP20Q/N9
lBD9qMNMfheF4vbFrdR8JTzVPzoamEYj+2qI5tFCBZKj9Bl0aSyyXAXNwb4K
DPWYaZsU3cLS/cyDTgsUqPbxmBcqjwcZJhdyXvcizrwzrrkvASzS4tqGE70I
FJYGaVD3wA3YuDyT1YtKgxzOWf1kjBhGXHYv64GuaqqSYgmhqbY9qvJ0D2q/
Htoi2fEQXhp7doca9aBeHCFYVPAIUmtGWUWFHJuM4wo78lPwIN21o/6sHAeS
lsr3VqWibO3nimVL5BgoOX5ga81j+KuqXW1qurGz37KusTMNOz7pCG+EdMOU
ygp1G0uHvWxO4hnjbvyR9MHfdTwD+Wv5m5fXduG+82XXfxc8QeBdqww9XhfY
Etllln4W0qyPFbxhd8GepL6ZMLLRq+XOozd0woAZZvdx5VOcH44cE17pBHey
XKaxJgdhS8zZynWdOK2Iu9m85RmqjizVu9DYAe2smdy7niKsaap+/ii8Ayy9
VWF1ns+hdb1/SLC+Ayr7kzXNlmKwPTiTeV9liP8ovBRbKEbZfltxukCGUKdU
x3wrCU7HNeqZ2spQWn5cV1QiwdF26QZVRzu2MrXHuPa5qAtkzryU0I5lAUFd
qne5uM4iYrahHZuFkkE7lxconHhfXqdoQ6qkzFDt/QuM6aaLJoVt8KtMcojf
9xJX7Yrd/ba14dCrnYKuppeIeOryJGawFa9ExfU6x/JQZc4mBh+0gnNN0yaz
Lw8r5K8vDG1vxcaf2NIZp/Ix0VjRXTTcguA+bQfTiXwwu/UZpSktkPOruo0u
FUBkRiqiXVqQ2X8w8+JkAbye+If00VpQeuIlVxxViG22a4vjskmwXrVvT9ci
IJ4blDvsTWLiojpLNpeA/TppTawXCdLOpMdEh8AnDy0F25NExlu/6LQFBEZS
UlZ4u5GwaGitfWxIwM76w33CmcSuYXJf6hoCtf4WkTwHEhctv558uIdAv3Rg
//hqEj6j47bf9xIIb7M7H7+KxJYio/k/eBBgaMUkrF5JYo4jR/JgHwEbt+W1
nBUkEtybBoR+BK7KPRylxiREwQ38+2cI0PULzfgMEnHWI780hxDI2KTuzFhI
InicaWzEI2Dt6/KrSI+ETbhXaTKfAOdZV/o3XRJvbtfPSo4kkOZgYIi5JLI9
h740XiNgefyIdb0WiRhD/WyWgMDfMRL3gNkk3B577EqKJdDbsCP2oQYJK+7Z
RY23CPCn7jyzUp/2W5WgNLhDQHdZa2WN2rSfMq/Y+y6BVCfTLu6Mab/cz7GJ
iQTWB/I0aDQS/wFx+WwU
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesLabel->{None, None},
  AxesOrigin->{0, 0.5},
  Method->{},
  PlotRange->NCache[{{0, 
      Rational[1, 10]}, {0.5000000102040816, 0.9999999897959184}}, {{
     0, 0.1}, {0.5000000102040816, 0.9999999897959184}}],
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{{3.675721496083349*^9, 3.675721548166576*^9}, 
   3.675727607864105*^9, 3.6757882735873823`*^9, 3.676138275405953*^9, 
   3.676146370457938*^9, 3.6762055709353447`*^9, 3.67620645036299*^9, 
   3.676297521002735*^9, 3.676331484085239*^9, 3.676570781037498*^9, 
   3.676578088297379*^9}]
}, Open  ]],

Cell["\<\
Does the average selection differential disappear at equilibrium?\
\>", "Text",
 CellChangeTimes->{{3.6762116257875547`*^9, 3.676211645548607*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Sigma]Am", "+", "\[Sigma]Af"}], ")"}], "/", "2"}], "/.", 
     RowBox[{"\[Sigma]Am", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pA", "+", 
         RowBox[{"hAm", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "pA"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
       "sAm"}]}]}], "/.", 
    RowBox[{"\[Sigma]Af", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"pA", "+", 
        RowBox[{"hAf", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "pA"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
      "sAf"}]}]}], "/.", 
   RowBox[{"eqpA", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{3.676211279333569*^9}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{"t", " ", "\[Epsilon]"}], "2"]}]], "Output",
 CellChangeTimes->{{3.676211275657774*^9, 3.6762112796748457`*^9}, 
   3.676211752158146*^9, 3.676298042427384*^9, 3.676298351120221*^9, 
   3.6765707867874947`*^9, 3.6765780631278954`*^9, 3.676578096551182*^9}]
}, Open  ]],

Cell[" not unless t=0", "Text",
 CellChangeTimes->{{3.6762116488937893`*^9, 3.676211652545933*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"\[Sigma]Am", "+", "\[Sigma]Af"}], ")"}], "/", "2"}], "/.", 
      RowBox[{"\[Sigma]Am", "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pA", "+", 
          RowBox[{"hAm", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", "pA"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
        "sAm"}]}]}], "/.", 
     RowBox[{"\[Sigma]Af", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pA", "+", 
         RowBox[{"hAf", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "pA"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
       "sAf"}]}]}], "/.", 
    RowBox[{"eqpA", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.676211267392529*^9, 3.676211271386202*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.676211264657189*^9, 3.6762112718079863`*^9}, 
   3.6762980487418013`*^9, 3.676570786836441*^9, 3.676578096601262*^9}]
}, Open  ]],

Cell["or we include haploid selection in the original formulation", "Text",
 CellChangeTimes->{{3.676211655922555*^9, 3.676211668436595*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Sigma]Am", "+", "\[Sigma]Af", "+", 
        RowBox[{"t", " ", "\[Epsilon]"}]}], ")"}], "/", "2"}], "/.", 
     RowBox[{"\[Sigma]Am", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pA", "+", 
         RowBox[{"hAm", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "pA"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
       "sAm"}]}]}], "/.", 
    RowBox[{"\[Sigma]Af", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"pA", "+", 
        RowBox[{"hAf", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "pA"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
      "sAf"}]}]}], "/.", 
   RowBox[{"eqpA", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.676211135317142*^9, 3.676211254688655*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.6762111370366497`*^9, 3.67621125550736*^9}, 
   3.6762980508761168`*^9, 3.676570786886437*^9, 3.676578096666553*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Special case", "Subsection",
 CellChangeTimes->{{3.676141114894979*^9, 3.676141116947991*^9}}],

Cell["Note that when there are no sex differences in selection", "Text",
 CellChangeTimes->{{3.676141122876837*^9, 3.676141146610197*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subPAS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FAA", "\[Rule]", "WAA"}], ",", 
     RowBox[{"FAa", "\[Rule]", "WAa"}], ",", 
     RowBox[{"Faa", "\[Rule]", "Waa"}], ",", 
     RowBox[{"MAA", "\[Rule]", "WAA"}], ",", 
     RowBox[{"MAa", "\[Rule]", "WAa"}], ",", 
     RowBox[{"Maa", "\[Rule]", "Waa"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.67578767630304*^9, 3.675787702421009*^9}}],

Cell["\<\
and recombination between the autosomal and sex-determining locus is free, \
the non-mutant (resident) equilibirum condtions become\
\>", "Text",
 CellChangeTimes->{{3.676141153795107*^9, 3.676141188484377*^9}, {
  3.6762100842338448`*^9, 3.676210088622469*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqsPAS", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XAfprime", "-", "XAf"}], ",", "\[IndentingNewLine]", 
       RowBox[{"XAmprime", "-", "XAm"}], ",", "\[IndentingNewLine]", 
       RowBox[{"YAprime", "-", "YA"}]}], "\[IndentingNewLine]", "}"}], "/.", 
     "subPAS"}], "/.", 
    RowBox[{"r", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675787718650551*^9, 3.675787723701189*^9}, {
   3.675787963351767*^9, 3.675787964383904*^9}, {3.67578822894055*^9, 
   3.675788231642598*^9}, {3.676210000156026*^9, 3.676210009755402*^9}, 
   3.676210072118704*^9}],

Cell["\<\
Using the fact that the freqeuencies of A and a must sum to one in each \
gamete type\
\>", "Text",
 CellChangeTimes->{{3.6761411924078703`*^9, 3.6761412091788597`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subRes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Xaf", "\[Rule]", 
      RowBox[{"1", "-", "XAf"}]}], ",", 
     RowBox[{"Xam", "\[Rule]", 
      RowBox[{"1", "-", "XAm"}]}], ",", 
     RowBox[{"Ya", "\[Rule]", 
      RowBox[{"1", "-", "YA"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675787741056987*^9, 3.675787766946458*^9}, {
   3.6762100158719*^9, 3.676210025120159*^9}, 3.676210067081636*^9}],

Cell["\<\
we can directly solve for the equilibrium frequencies without assuming weak \
selection\
\>", "Text",
 CellChangeTimes->{{3.67614121677299*^9, 3.676141226410625*^9}, {
  3.6761417749056*^9, 3.676141775510998*^9}, {3.676141820439823*^9, 
  3.67614184300416*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"differenceEqsPAS", "/.", "subRes"}], ")"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"XAf", ",", "XAm", ",", "YA"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6757879734470587`*^9, 3.6757879843428593`*^9}, 
   3.675788281517105*^9, {3.676210031013042*^9, 3.676210063511486*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", "0"}], ",", 
     RowBox[{"XAm", "\[Rule]", "0"}], ",", 
     RowBox[{"YA", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", "1"}], ",", 
     RowBox[{"XAm", "\[Rule]", "1"}], ",", 
     RowBox[{"YA", "\[Rule]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "wa", " ", "Waa"}], "-", 
        RowBox[{"wa", " ", "WAa"}], "-", 
        RowBox[{"wA", " ", "WAa"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wa", " ", "Waa"}], "-", 
          RowBox[{"wa", " ", "WAa"}], "-", 
          RowBox[{"wA", " ", "WAa"}], "+", 
          RowBox[{"wA", " ", "WAA"}]}], ")"}]}]]}], ",", 
     RowBox[{"XAm", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "wa", " ", "Waa"}], "-", 
        RowBox[{"wa", " ", "WAa"}], "-", 
        RowBox[{"wA", " ", "WAa"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wa", " ", "Waa"}], "-", 
          RowBox[{"wa", " ", "WAa"}], "-", 
          RowBox[{"wA", " ", "WAa"}], "+", 
          RowBox[{"wA", " ", "WAA"}]}], ")"}]}]]}], ",", 
     RowBox[{"YA", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "wa", " ", "Waa"}], "-", 
        RowBox[{"wa", " ", "WAa"}], "-", 
        RowBox[{"wA", " ", "WAa"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wa", " ", "Waa"}], "-", 
          RowBox[{"wa", " ", "WAa"}], "-", 
          RowBox[{"wA", " ", "WAa"}], "+", 
          RowBox[{"wA", " ", "WAA"}]}], ")"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.676210036360671*^9, 3.676210077226211*^9}, 
   3.6762975228097477`*^9, 3.676331485600566*^9, 3.67657078217767*^9, 
   3.6765780905054092`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Neo-y growth", "Section",
 CellChangeTimes->{{3.676582252051412*^9, 3.676582269447054*^9}}],

Cell["", "Text"],

Cell[BoxData[
 RowBox[{
  RowBox[{"pAsubs", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", 
      RowBox[{"pA", "+", 
       RowBox[{
        FractionBox["1", "3"], "\[Epsilon]", " ", "dpAXY"}], "+", 
       RowBox[{"\[Epsilon]", " ", "dpAXfXm"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAm", "\[Rule]", 
      RowBox[{"pA", "+", 
       RowBox[{
        FractionBox["1", "3"], "\[Epsilon]", " ", "dpAXY"}], "-", 
       RowBox[{"\[Epsilon]", " ", "dpAXfXm"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YA", "\[Rule]", 
      RowBox[{"pA", "-", 
       RowBox[{"\[Epsilon]", " ", "dpAXY"}], "-", 
       RowBox[{"\[Epsilon]", " ", "dpAXfXm"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"xA", "\[Rule]", 
      RowBox[{"pA", "+", 
       RowBox[{
        FractionBox["1", "3"], "\[Epsilon]", " ", "dpAXY"}], "-", 
       RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
       RowBox[{"2", "\[Epsilon]", " ", "dpAxXm"}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6765806182823467`*^9, 3.67658076569499*^9}, {
  3.6765808375724983`*^9, 3.676580838499551*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"approxRA", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"RA", "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "pAsubs"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6765807827359753`*^9, 3.676580854074707*^9}, {
  3.676582023871292*^9, 3.676582026168914*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   RowBox[{
    FractionBox["2", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "dpAxXm"}], "+", 
        RowBox[{"2", " ", "dpAXY"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "pA"}], "+", 
        RowBox[{"hAm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "pA"}]}], ")"}]}]}], ")"}], " ", "sAm"}], ")"}], 
    " ", 
    SuperscriptBox["\[Epsilon]", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   1, 0, Rational[-2, 3] (3 $CellContext`dpAxXm + 
     2 $CellContext`dpAXY) (-$CellContext`pA + $CellContext`hAm (-1 + 
       2 $CellContext`pA)) $CellContext`sAm}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.6765808162942142`*^9, 3.676580854374343*^9}, 
   3.676582026714388*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXY", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "XAfprime"}], "+", "XAmprime", "-", 
             "YAprime"}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "XAf"}], "+", "XAm", "-", "YA"}], ")"}]}], "/.", 
          "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "pAsubs"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.676580883808177*^9, 3.676580896867023*^9}, {
   3.676580959265214*^9, 3.6765809613463917`*^9}, {3.676581065889534*^9, 
   3.676581066519405*^9}, 3.676581371277791*^9, 3.676581423427621*^9, {
   3.6765815851357327`*^9, 3.676581586215435*^9}, 3.676581635398266*^9, 
   3.676582992439571*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", "dpAXfXm", " ", "r"}], "-", 
      FractionBox[
       RowBox[{"8", " ", "dpAXY", " ", "r"}], "3"], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAf"}], "+", 
         RowBox[{"hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
         RowBox[{"r", " ", "t"}]}], ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
   "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 
   0, {(-4) $CellContext`dpAXfXm $CellContext`r + 
    Rational[-8, 3] $CellContext`dpAXY $CellContext`r + 
    2 (-1 + $CellContext`pA) $CellContext`pA (-$CellContext`pA \
$CellContext`sAf + $CellContext`hAf (-1 + 
        2 $CellContext`pA) $CellContext`sAf - $CellContext`r $CellContext`t)},
    1, 2, 1],
  Editable->False]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.676580884679142*^9, 3.676580897283772*^9}, 
   3.676580961878104*^9, 3.676581066981305*^9, 3.676581371726273*^9, 
   3.676581424061479*^9, 3.676581586516067*^9, 3.676581635801958*^9, 
   3.676582992441887*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfXm", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"XAfprime", "-", "XAmprime"}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{"XAf", "-", "XAm"}], ")"}]}], "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "pAsubs"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.676581112007431*^9, 3.676581139917885*^9}, {
   3.67658159576521*^9, 3.676581596801098*^9}, 3.676581638264957*^9, 
   3.67658299244444*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"4", " ", "dpAXY", " ", "r"}], "3"], "+", 
      RowBox[{"dpAXfXm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         RowBox[{"2", " ", "r"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "+", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}], "-", 
         RowBox[{"2", " ", "pA", " ", 
          RowBox[{"(", 
           RowBox[{"sAf", "-", "sAm", "+", 
            RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t", "+", 
         RowBox[{"2", " ", "r", " ", "t"}]}], ")"}]}]}], ")"}], " ", 
    "\[Epsilon]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   Rational[4, 
       3] $CellContext`dpAXY $CellContext`r + $CellContext`dpAXfXm (-3 + 
      2 $CellContext`r) + 
    Rational[1, 2] (-1 + $CellContext`pA) $CellContext`pA (
      2 $CellContext`hAf (-1 + 2 $CellContext`pA) $CellContext`sAf + 
      2 $CellContext`hAm $CellContext`sAm - 
      2 $CellContext`pA ($CellContext`sAf - $CellContext`sAm + 
       2 $CellContext`hAm $CellContext`sAm) - $CellContext`t + 
      2 $CellContext`r $CellContext`t)}, 1, 2, 1],
  Editable->False]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.676581141700481*^9, 3.6765815970517263`*^9, 
  3.676581638666195*^9, 3.6765829924468*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpasubs1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eqdpAXY", "\[Equal]", "0"}], ",", 
        RowBox[{"eqdpAXfXm", "\[Equal]", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"dpAXY", ",", "dpAXfXm"}], "}"}]}], "]"}], "//", "Flatten"}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6765816270811863`*^9, 3.676581707261133*^9}, 
   3.6765829924489326`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dpAXY", "\[Rule]", 
    RowBox[{"-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"4", " ", "r"}]], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{"4", " ", "r"}]}], ")"}], " ", "sAf"}], "+", 
         RowBox[{"pA", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", "sAf"}], "-", 
            RowBox[{"4", " ", "r", " ", "sAf"}], "+", 
            RowBox[{"2", " ", "r", " ", "sAm"}], "-", 
            RowBox[{"4", " ", "hAm", " ", "r", " ", "sAm"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}]}]}]}]}],
    ",", 
   RowBox[{"dpAXfXm", "\[Rule]", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "hAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "+", 
       RowBox[{"2", " ", "hAm", " ", "sAm"}], "+", 
       RowBox[{"2", " ", "pA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "sAf"}], "+", "sAm", "-", 
          RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], 
      ")"}]}]}]}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6765816757750797`*^9, 3.6765817078003407`*^9}, 
   3.6765829924512672`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXmx", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"XAmprime", "-", "xAprime"}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{"XAm", "-", "xA"}], ")"}]}], "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "pAsubs"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.676581751952197*^9, 3.676581841862712*^9}, 
   3.676582125626697*^9, 3.6765829924529867`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       FractionBox[
        RowBox[{"4", " ", "dpAXY", " ", "r"}], "3"]}], "+", 
      RowBox[{"2", " ", "dpAxXm", " ", "R"}], "-", 
      RowBox[{"2", " ", "dpAXfXm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}]}], "-", 
      RowBox[{"pA", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}], "+", 
      RowBox[{"pA", " ", "r", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}], "+", 
      RowBox[{"pA", " ", "R", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "R", " ", "t"}]}], ")"}], " ", 
    "\[Epsilon]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   Rational[-4, 3] $CellContext`dpAXY $CellContext`r + 
    2 $CellContext`dpAxXm $CellContext`R - 
    2 $CellContext`dpAXfXm (-1 + $CellContext`r + $CellContext`R) - \
$CellContext`pA $CellContext`t + $CellContext`pA^2 $CellContext`t + \
$CellContext`pA $CellContext`r $CellContext`t - $CellContext`pA^2 \
$CellContext`r $CellContext`t + $CellContext`pA $CellContext`R $CellContext`t - \
$CellContext`pA^2 $CellContext`R $CellContext`t}, 1, 2, 1],
  Editable->False]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6765818231028633`*^9, 3.676581842312065*^9}, 
   3.676582126018179*^9, 3.676582992454348*^9}]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.676581924141981*^9, 3.676581925770255*^9}, 
   3.6765829924555264`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpasubs2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eqdpAXmx", "\[Equal]", "0"}], "}"}], ",", 
      RowBox[{"{", "dpAxXm", "}"}]}], "]"}], "//", "Flatten"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.676581930000905*^9, 3.67658196549391*^9}, 
   3.676582992455833*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAxXm", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{"4", " ", "dpAXY", " ", "r"}], "+", 
     RowBox[{"6", " ", "dpAXfXm", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", "t"}]}], 
    RowBox[{"6", " ", "R"}]]}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6765819559782963`*^9, 3.676581965854865*^9}, 
   3.676582128983177*^9, 3.676582992457651*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpasubs3", "=", 
  RowBox[{
   RowBox[{"dpasubs2", "/.", "dpasubs1"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.676581989717371*^9, 3.6765820072938843`*^9}, 
   3.676582992459038*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAxXm", "\[Rule]", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"6", " ", "R"}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", "R"}]}], ")"}], " ", "sAf"}], "+", 
       RowBox[{"pA", " ", 
        RowBox[{"(", 
         RowBox[{"sAf", "-", 
          RowBox[{"4", " ", "R", " ", "sAf"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "hAm"}], "+", "R", "-", 
             RowBox[{"2", " ", "hAm", " ", "R"}]}], ")"}], " ", "sAm"}]}], 
         ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.676582000913072*^9, 3.676582007612401*^9}, 
   3.676582130802669*^9, 3.676582992459941*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"appRA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"approxRA", "/.", "dpasubs1"}], "/.", "dpasubs3"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.676582036645348*^9, 3.676582054648892*^9}, {
   3.6765820946511803`*^9, 3.676582096294909*^9}, 3.676582992460651*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"3", " ", "r", " ", "R"}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pA"}], "+", 
       RowBox[{"hAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}]}]}], ")"}], " ", "sAm", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"r", "-", 
          RowBox[{"3", " ", "R"}]}], ")"}], " ", "sAf"}], "+", 
       RowBox[{"pA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "R", " ", "sAf"}], "-", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{"sAf", "-", 
             RowBox[{"2", " ", "sAm"}], "+", 
             RowBox[{"4", " ", "hAm", " ", "sAm"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox["\[Epsilon]", "2"]}]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   1, 0, Rational[
     1, 3] (-1 + $CellContext`pA) $CellContext`pA (-$CellContext`pA + \
$CellContext`hAm (-1 + 
       2 $CellContext`pA)) $CellContext`r^(-1) $CellContext`R^(-1) \
$CellContext`sAm ($CellContext`hAf (-1 + 2 $CellContext`pA) ($CellContext`r - 
       3 $CellContext`R) $CellContext`sAf + $CellContext`pA (
       3 $CellContext`R $CellContext`sAf - $CellContext`r ($CellContext`sAf - 
        2 $CellContext`sAm + 4 $CellContext`hAm $CellContext`sAm)) + 
     2 $CellContext`r ($CellContext`hAm $CellContext`sAm + $CellContext`t))}, 
   0, 3, 1],
  Editable->False]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.676582042583074*^9, 3.6765820551321507`*^9}, 
   3.6765820966851673`*^9, 3.676582133608912*^9, 3.676582992461474*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"appRA", "/.", 
    RowBox[{"t", "\[Rule]", "0"}]}], "/.", 
   RowBox[{"R", "\[Rule]", 
    RowBox[{"1", "/", "2"}]}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.676582097530673*^9, 3.676582104216473*^9}, {
   3.676582138289132*^9, 3.676582139573832*^9}, 3.6765829924622087`*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"3", " ", "r"}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pA"}], "+", 
       RowBox[{"hAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}]}]}], ")"}], " ", "sAm", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "pA"}], "+", 
          RowBox[{"hAf", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "pA"}]}], ")"}]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "3"}], "+", 
          RowBox[{"2", " ", "r"}]}], ")"}], " ", "sAf"}], "+", 
       RowBox[{"4", " ", 
        RowBox[{"(", 
         RowBox[{"hAm", "+", "pA", "-", 
          RowBox[{"2", " ", "hAm", " ", "pA"}]}], ")"}], " ", "r", " ", 
        "sAm"}]}], ")"}], " ", 
     SuperscriptBox["\[Epsilon]", "2"]}]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   1, 0, Rational[
     1, 3] (-1 + $CellContext`pA) $CellContext`pA (-$CellContext`pA + \
$CellContext`hAm (-1 + 
       2 $CellContext`pA)) $CellContext`r^(-1) $CellContext`sAm \
((-$CellContext`pA + $CellContext`hAf (-1 + 2 $CellContext`pA)) (-3 + 
       2 $CellContext`r) $CellContext`sAf + 
     4 ($CellContext`hAm + $CellContext`pA - 
       2 $CellContext`hAm $CellContext`pA) $CellContext`r $CellContext`sAm)}, 
   0, 3, 1],
  Editable->False]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.676582098835987*^9, 3.676582104559106*^9}, {
   3.676582136222137*^9, 3.676582139907782*^9}, 3.6765829924630337`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"kirk", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", "-", 
          RowBox[{"VA", " ", "LA", " ", "SA"}]}], "}"}], "/.", 
        RowBox[{"VA", "\[Rule]", 
         RowBox[{"pA", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pA"}], ")"}]}]}]}], "/.", 
       RowBox[{"LA", "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "r"}]}], ")"}], "/", "r"}]}]}], "/.", 
      RowBox[{"SA", "\[Rule]", 
       RowBox[{"\[Sigma]Am", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Sigma]Am", "-", "\[Sigma]Af"}], ")"}], "/", "2"}]}]}]}], 
     "/.", 
     RowBox[{"\[Sigma]Am", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pA", "+", 
         RowBox[{"hAm", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "pA"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
       "sAm"}]}]}], "/.", 
    RowBox[{"\[Sigma]Af", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"pA", "+", 
        RowBox[{"hAf", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "pA"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
      "sAf"}]}]}], "//", "FullSimplify"}]}]], "Input",
 CellChangeTimes->{3.676582992463908*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"1", "-", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"2", " ", "r"}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{"hAm", "+", "pA", "-", 
       RowBox[{"2", " ", "hAm", " ", "pA"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}]}], ")"}], " ", "sAm", " ", "\[Epsilon]", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{"hAf", "+", "pA", "-", 
           RowBox[{"2", " ", "hAf", " ", "pA"}]}], ")"}]}], " ", "sAf", " ", 
        "\[Epsilon]"}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"hAm", "+", "pA", "-", 
          RowBox[{"2", " ", "hAm", " ", "pA"}]}], ")"}], " ", "sAm", " ", 
        "\[Epsilon]"}]}], ")"}]}]}]}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.676582181177456*^9, 3.676582992464662*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"appRA", "-", "kirk"}], "/.", 
     RowBox[{"eqpA", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
    RowBox[{"R", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}]}], "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.6765821880670652`*^9, 3.676582235943553*^9}, 
   3.676582992465501*^9}],

Cell[BoxData[
 RowBox[{"{", 
  InterpretationBox[
   SuperscriptBox[
    RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
   SeriesData[$CellContext`\[Epsilon], 0, {}, 3, 3, 1],
   Editable->False], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.676582190848565*^9, 3.676582236237438*^9}, 
   3.676582992466229*^9}]
}, Open  ]]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
1 - Effect of a sexually-antagonistic locus on the sex chromosome\
\>", "Title",
 CellChangeTimes->{{3.676582480718354*^9, 3.676582483582519*^9}, 
   3.676583567519174*^9, {3.676583924245014*^9, 3.676583948032938*^9}}],

Cell[CellGroupData[{

Cell["Recursion equations", "Section",
 CellChangeTimes->{{3.6756910197792797`*^9, 3.675691024113359*^9}, {
   3.67569412935745*^9, 3.6756941314240303`*^9}, {3.675707349839982*^9, 
   3.675707351884247*^9}, {3.675709974013658*^9, 3.675709982915987*^9}, {
   3.6757923469668207`*^9, 3.675792350124728*^9}, {3.6761413144270782`*^9, 
   3.676141323737258*^9}, {3.676142978381001*^9, 3.67614297923321*^9}, 
   3.676199586158256*^9, 3.676206073928619*^9, {3.6765825189533577`*^9, 
   3.676582521678049*^9}}],

Cell["\<\
We start with haploid selection, which occurs in sperm/pollen only. Let XAm \
be the frequency of allele 1 at the diallelic autosomal locus A in \
gametes/pollen with an X allele at the original diallelic sex-determining \
locus (ie the frequency of A1 in male gametes with X chromosomes). Let YA be \
the frequency of allele 1 at the diallelic autosomal locus A in \
gametes/pollen with a Y allele at the diallelic sex-determining locus (ie the \
frequency of A1 in male gametes with Y chromosomes). Let XAf be the frequency \
of allele 1 at the diallelic autosomal locus A in eggs (which necessarily \
have an X allele at the original diallelic sex-determining locus). And let yA \
be the frequency of allele 1 at the diallelic autosomal locus A in \
pollen/sperm with a new dominant macculinizing (ie a neo-y) mutation. We \
assume males make \[Alpha]% of their sperm/pollen with Y (or y). After \
selection on male gametes/pollen we then have\
\>", "Text",
 CellChangeTimes->{{3.675646210075425*^9, 3.6756462139879293`*^9}, {
  3.675692881948024*^9, 3.675692905462323*^9}, {3.675702634397826*^9, 
  3.6757026600570383`*^9}, {3.675710000498989*^9, 3.675710437600037*^9}, {
  3.6757106247367887`*^9, 3.675710626158669*^9}, {3.6761379095010347`*^9, 
  3.676137962328772*^9}, {3.676584792355638*^9, 3.6765849713109922`*^9}, {
  3.676585005798175*^9, 3.6765850557890997`*^9}, {3.676585102524021*^9, 
  3.6765851299230433`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wbarHapXm", "=", " ", 
   RowBox[{
    RowBox[{"wA", " ", "XAm"}], "+", " ", 
    RowBox[{"wa", " ", "Xam"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wbarHapY", "=", " ", 
   RowBox[{
    RowBox[{"wA", " ", "YA"}], "+", " ", 
    RowBox[{"wa", " ", "Ya"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wbarHapy", "=", " ", 
   RowBox[{
    RowBox[{"wA", " ", "xA"}], "+", " ", 
    RowBox[{"wa", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "xA"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAms", "=", " ", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Alpha]"}], ")"}], " ", "wA", " ", 
    RowBox[{"XAm", "/", "wbarHapXm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xams", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Alpha]"}], ")"}], " ", "wa", " ", 
    RowBox[{"Xam", "/", "wbarHapXm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAs", "=", "  ", 
   RowBox[{"\[Alpha]", " ", "wA", "*", 
    RowBox[{"YA", "/", "wbarHapY"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yas", "=", " ", 
   RowBox[{"\[Alpha]", " ", "wa", "*", 
    RowBox[{"Ya", "/", "wbarHapY"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAfs", "=", "XAf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xafs", "=", "Xaf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yAs", "=", " ", 
   RowBox[{"\[Alpha]", " ", "wA", " ", "\[Epsilon]y", " ", 
    RowBox[{"xA", "/", "wbarHapy"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"yas", "=", " ", 
   RowBox[{"\[Alpha]", " ", "wa", " ", "\[Epsilon]y", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "xA"}], ")"}], "/", "wbarHapy"}]}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.675887851245193*^9, 3.675887867834023*^9}, {
   3.676141999159761*^9, 3.676142091103024*^9}, {3.676142174120762*^9, 
   3.676142199369879*^9}, {3.676142234237845*^9, 3.6761422412826653`*^9}, {
   3.676149131909862*^9, 3.67614922213706*^9}, {3.676149379748801*^9, 
   3.676149430057311*^9}, {3.676149471691319*^9, 3.676149484490981*^9}, {
   3.676149619753261*^9, 3.676149627248313*^9}, {3.676152777149371*^9, 
   3.6761528652841263`*^9}, 3.676199586159603*^9, {3.676205759277755*^9, 
   3.6762057873657627`*^9}}],

Cell["\<\
where wA and wa describe selection in male gametes/pollen, \[Epsilon]y is the \
(small) frequency of the neo-y mutation, and xA is the frequency of A in \
gametes with the neo-y.\
\>", "Text",
 CellChangeTimes->{{3.67658509587938*^9, 3.676585096527823*^9}, {
  3.676585137826956*^9, 3.676585201042717*^9}}],

Cell["\<\
Check that frequencies of allele 1 in each gametes type sums to the \
appropriate fraction after haploid selection:\
\>", "Text",
 CellChangeTimes->{{3.675691241028049*^9, 3.675691262904736*^9}, {
   3.675691499842326*^9, 3.675691508954028*^9}, {3.6757021446730413`*^9, 
   3.6757021466313477`*^9}, 3.67570266834774*^9, {3.675710454342794*^9, 
   3.675710458811872*^9}, {3.675711308941972*^9, 3.6757113347037287`*^9}, {
   3.676140458259473*^9, 3.676140486907097*^9}, 3.676199586160721*^9, {
   3.6762058698955383`*^9, 3.676205873473984*^9}, {3.6765853116814632`*^9, 
   3.676585327191327*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"1", "-", "\[Alpha]"}], "==", 
    RowBox[{"XAms", "+", "Xams"}]}], "/.", 
   RowBox[{"Xam", "\[Rule]", 
    RowBox[{"1", "-", "XAm"}]}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]", "==", 
    RowBox[{"YAs", "+", "Yas"}]}], "/.", 
   RowBox[{"Ya", "\[Rule]", 
    RowBox[{"1", "-", "YA"}]}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{"XAfs", "+", "Xafs"}]}], "/.", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "XAf"}]}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Alpha]", " ", "\[Epsilon]y"}], "==", 
   RowBox[{"yAs", "+", "yas"}]}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.6762058553075027`*^9, 3.676205862337631*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.676205597799912*^9, 3.676205804339649*^9, 
  3.676205862891724*^9, 3.6762975094425383`*^9, 3.6763314735315857`*^9, 
  3.6765707789165363`*^9, 3.676578081579689*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.676205597799912*^9, 3.676205804339649*^9, 
  3.676205862891724*^9, 3.6762975094425383`*^9, 3.6763314735315857`*^9, 
  3.6765707789165363`*^9, 3.676578081584096*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.676205597799912*^9, 3.676205804339649*^9, 
  3.676205862891724*^9, 3.6762975094425383`*^9, 3.6763314735315857`*^9, 
  3.6765707789165363`*^9, 3.676578081587137*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.676205597799912*^9, 3.676205804339649*^9, 
  3.676205862891724*^9, 3.6762975094425383`*^9, 3.6763314735315857`*^9, 
  3.6765707789165363`*^9, 3.6765780815905724`*^9}]
}, Open  ]],

Cell["\<\
After random mating, the frequencies of the diploid genotypes are\
\>", "Text",
 CellChangeTimes->{{3.675646094888542*^9, 3.675646099390658*^9}, {
   3.675646217785323*^9, 3.675646250704771*^9}, {3.67570268816877*^9, 
   3.6757027045136023`*^9}, {3.676143601607935*^9, 3.6761436020295963`*^9}, 
   3.676199586165538*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAXA", "=", 
   RowBox[{"XAfs", " ", "XAms"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXa", "=", 
   RowBox[{
    RowBox[{"XAfs", " ", "Xams"}], "+", 
    RowBox[{"Xafs", " ", "XAms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaXa", "=", 
    RowBox[{"Xafs", " ", "Xams"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"XAYA", "=", 
   RowBox[{"XAfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYa", "=", 
   RowBox[{"XAfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYA", "=", 
   RowBox[{"Xafs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaYa", "=", 
    RowBox[{"Xafs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"XAyA", "=", 
   RowBox[{"XAfs", " ", "yAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAya", "=", 
   RowBox[{"XAfs", " ", "yas"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayA", "=", 
   RowBox[{"Xafs", " ", "yAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xaya", "=", 
   RowBox[{"Xafs", " ", "yas"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646256909181*^9, 3.675646272815617*^9}, {
   3.675646370257011*^9, 3.67564637079287*^9}, {3.675646404699778*^9, 
   3.675646517567526*^9}, {3.675646573911735*^9, 3.675646591557143*^9}, {
   3.675646627619878*^9, 3.67564663177063*^9}, {3.675646667841331*^9, 
   3.675646747122738*^9}, {3.675691396390801*^9, 3.675691472391663*^9}, {
   3.675691536695323*^9, 3.675691538414453*^9}, {3.675691639085917*^9, 
   3.675691650195237*^9}, {3.675691682513646*^9, 3.675691696533524*^9}, {
   3.675691755294464*^9, 3.6756917629827957`*^9}, {3.675691824386702*^9, 
   3.675691852603437*^9}, {3.675692700413486*^9, 3.675692712195026*^9}, {
   3.67569296671769*^9, 3.675692967464675*^9}, {3.6756930389284983`*^9, 
   3.675693095368285*^9}, {3.675693137308187*^9, 3.675693184356132*^9}, {
   3.675693221908244*^9, 3.6756932234970217`*^9}, {3.675693268122773*^9, 
   3.675693270392726*^9}, {3.675693410576119*^9, 3.675693460007984*^9}, {
   3.675693492300033*^9, 3.675693533360964*^9}, 3.675693600152028*^9, {
   3.675702177145516*^9, 3.675702196152766*^9}, {3.6757023129704742`*^9, 
   3.675702317051364*^9}, {3.675792623150811*^9, 3.675792640133086*^9}, {
   3.675792682078307*^9, 3.675792755658676*^9}, {3.6761425905197153`*^9, 
   3.676142594326068*^9}, 3.676199586165913*^9}],

Cell["\<\
Check that frequencies sum to the appropriate fraction\
\>", "Text",
 CellChangeTimes->{{3.6761436064259577`*^9, 3.676143611328102*^9}, 
   3.67619958616654*^9, {3.676205899432912*^9, 3.6762059064641323`*^9}, {
   3.676585335249318*^9, 3.6765853393839397`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"1", "-", "\[Alpha]"}], "==", 
     RowBox[{"XAXA", "+", "XAXa", "+", "XaXa"}]}], "/.", 
    RowBox[{"Xaf", "\[Rule]", 
     RowBox[{"1", "-", "XAf"}]}]}], "/.", 
   RowBox[{"Xam", "\[Rule]", 
    RowBox[{"1", "-", "XAm"}]}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]", "==", 
     RowBox[{"XAYA", "+", "XAYa", "+", "XaYA", "+", "XaYa"}]}], "/.", 
    RowBox[{"Ya", "\[Rule]", 
     RowBox[{"1", "-", "YA"}]}]}], "/.", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "XAf"}]}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"\[Alpha]", " ", "\[Epsilon]y"}], "==", 
    RowBox[{"XAyA", "+", "XAya", "+", "XayA", "+", "Xaya"}]}], "/.", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "XAf"}]}]}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.6762058834850693`*^9, 3.676205896199106*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.676205606183573*^9, {3.67620588002642*^9, 3.676205896776825*^9}, 
   3.67629750955724*^9, 3.676331473646187*^9, 3.676570779000814*^9, 
   3.676578081694895*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.676205606183573*^9, {3.67620588002642*^9, 3.676205896776825*^9}, 
   3.67629750955724*^9, 3.676331473646187*^9, 3.676570779000814*^9, 
   3.676578081699139*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.676205606183573*^9, {3.67620588002642*^9, 3.676205896776825*^9}, 
   3.67629750955724*^9, 3.676331473646187*^9, 3.676570779000814*^9, 
   3.676578081701861*^9}]
}, Open  ]],

Cell["\<\
After diploid selection (which can differ between males and females) the \
frequencies of the diploid genotypes in each sex are\
\>", "Text",
 CellChangeTimes->{{3.6756467552456417`*^9, 3.67564676342205*^9}, {
   3.675702725992881*^9, 3.67570275267984*^9}, 3.676199586169319*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"wbarF", "=", 
    RowBox[{
     RowBox[{"FAA", " ", "XAXA"}], "+", 
     RowBox[{"FAa", " ", "XAXa"}], "+", 
     RowBox[{"Faa", " ", "XaXa"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXAs", "=", 
   RowBox[{"FAA", " ", 
    RowBox[{"XAXA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXas", "=", 
   RowBox[{"FAa", " ", 
    RowBox[{"XAXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaXas", "=", 
    RowBox[{"Faa", " ", 
     RowBox[{"XaXa", "/", "wbarF"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wbarM", "=", 
    RowBox[{
     RowBox[{"MAA", " ", "XAYA"}], "+", 
     RowBox[{"MAa", " ", 
      RowBox[{"(", 
       RowBox[{"XAYa", "+", "XaYA"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XaYa"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"ignore", " ", "rare", " ", "mutants"}], "*)"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XaYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaYas", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XaYa", "/", "wbarM"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAya", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XayA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xayas", "=", 
   RowBox[{"Maa", " ", 
    RowBox[{"Xaya", "/", "wbarM"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646788099258*^9, 3.675646827315172*^9}, {
   3.675646906255657*^9, 3.6756471746197577`*^9}, {3.6756477305962267`*^9, 
   3.675647791098443*^9}, {3.675693609968581*^9, 3.6756936401475143`*^9}, {
   3.675702773030509*^9, 3.675702825109133*^9}, {3.6757958668524837`*^9, 
   3.675796079670739*^9}, {3.675796179417987*^9, 3.675796260462306*^9}, {
   3.675796480404418*^9, 3.675796481420582*^9}, {3.675796553441423*^9, 
   3.67579667834494*^9}, {3.6757967212634993`*^9, 3.67579673565335*^9}, {
   3.675796766370957*^9, 3.675796913595641*^9}, {3.675796952452533*^9, 
   3.675796955994008*^9}, {3.6757970625420837`*^9, 3.675797062966584*^9}, {
   3.675797156973634*^9, 3.675797157898295*^9}, {3.675797509731503*^9, 
   3.6757975122266283`*^9}, 3.6757987828785143`*^9, {3.675798997687969*^9, 
   3.675798999203364*^9}, {3.676143759564913*^9, 3.676143876897674*^9}, {
   3.6761439480553083`*^9, 3.676143948190496*^9}, {3.676146793545115*^9, 
   3.67614684534789*^9}, 3.6761995861704493`*^9, {3.676205614675086*^9, 
   3.6762056178719597`*^9}}],

Cell["\<\
Check that frequencies of diploid genotypes in each sex sum to one after \
diploid selection:\
\>", "Text",
 CellChangeTimes->{{3.67569367511821*^9, 3.6756936990142593`*^9}, {
   3.675702840764554*^9, 3.675702847452877*^9}, 3.676199586171295*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAXAs", "+", "XAXas", "+", "XaXas"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "\[Equal]", 
   RowBox[{"XAYAs", "+", "XAYas", "+", "XaYAs", "+", "XaYas"}]}], "//", 
  "Factor"}]}], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.676205623884274*^9, 3.6762059177767057`*^9, 
  3.676297509642558*^9, 3.6763314737147427`*^9, 3.676570779082673*^9, 
  3.676578081829523*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.676205623884274*^9, 3.6762059177767057`*^9, 
  3.676297509642558*^9, 3.6763314737147427`*^9, 3.676570779082673*^9, 
  3.67657808183342*^9}]
}, Open  ]],

Cell["Finally, meiosis occurs.", "Text",
 CellChangeTimes->{{3.675647183205927*^9, 3.675647193439426*^9}, {
   3.675702857268779*^9, 3.6757029057817707`*^9}, 3.676144147033208*^9, 
   3.676199586173295*^9}],

Cell["Eggs/ovules are produced by females:", "Text",
 CellChangeTimes->{{3.5358035703823357`*^9, 3.5358035880216312`*^9}, {
   3.540035348335928*^9, 3.540035358302086*^9}, {3.674493953287428*^9, 
   3.674494012419855*^9}, 3.675799601278284*^9, {3.676143982806048*^9, 
   3.676144009190897*^9}, 3.6761995861734257`*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAfprime", "=", 
   RowBox[{"XAXAs", "+", 
    RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xafprime", "=", 
   RowBox[{"XaXas", "+", 
    RowBox[{"XAXas", "/", "2"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675799680833715*^9, 3.6757996941412067`*^9}, {
   3.676149324316855*^9, 3.676149325544795*^9}, {3.6761494980620604`*^9, 
   3.676149499624743*^9}, 3.676199586173596*^9}],

Cell["Check that frequencies sum to one", "Text",
 CellChangeTimes->{{3.6761441340031767`*^9, 3.676144138482572*^9}, 
   3.676199586174081*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAfprime", "+", "Xafprime"}]}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.676205922481855*^9, 3.676205923325824*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6762056328519506`*^9, 3.676205923728698*^9, 
  3.676297509709491*^9, 3.676331473781797*^9, 3.676570779184855*^9, 
  3.676578082016883*^9}]
}, Open  ]],

Cell["Pollen/sperm are produced by males:", "Text",
 CellChangeTimes->{{3.540035437149768*^9, 3.54003544478056*^9}, {
   3.540035542732253*^9, 3.540035542939846*^9}, 3.5400356972463627`*^9, {
   3.540035923604535*^9, 3.540036040586349*^9}, {3.540036213760168*^9, 
   3.540036242159268*^9}, {3.540036754700008*^9, 3.540036803790543*^9}, {
   3.54003685846948*^9, 3.540036984706725*^9}, {3.54003701775928*^9, 
   3.540037032315583*^9}, 3.540038125811358*^9, {3.556916665584009*^9, 
   3.55691668126228*^9}, {3.5569168428514147`*^9, 3.556916888640827*^9}, {
   3.556916933311759*^9, 3.556917080494673*^9}, {3.674494049278042*^9, 
   3.674494087250461*^9}, {3.674677710333157*^9, 3.67467771370854*^9}, 
   3.67467801036736*^9, {3.675799994654408*^9, 3.675800008557496*^9}, {
   3.675800063694265*^9, 3.6758001631762867`*^9}, {3.675800903709487*^9, 
   3.675800910209898*^9}, {3.675897375419611*^9, 3.6758973763555727`*^9}, {
   3.6761440055263147`*^9, 3.676144020885846*^9}, {3.676147035176601*^9, 
   3.676147035340662*^9}, {3.676147096324484*^9, 3.676147096477008*^9}, 
   3.676199586175479*^9, {3.676585350190591*^9, 3.6765853505740633`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAmprime", " ", "=", 
   RowBox[{"XAYAs", "+", 
    RowBox[{"XAYas", 
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}]}], "+", 
    RowBox[{"XaYAs", " ", "r"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Xamprime", " ", "=", 
    RowBox[{
     RowBox[{"XAYas", " ", "r"}], "+", 
     RowBox[{"XaYAs", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "r"}], ")"}]}], "+", "XaYas"}]}], ";"}], 
  "\[IndentingNewLine]"}], "\n", 
 RowBox[{
  RowBox[{"YAprime", " ", "=", 
   RowBox[{"XAYAs", "+", 
    RowBox[{"XAYas", " ", "r"}], "+", 
    RowBox[{"XaYAs", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yaprime", " ", "=", 
   RowBox[{
    RowBox[{"XAYas", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}]}], "+", 
    RowBox[{"XaYAs", " ", "r"}], "+", "XaYas"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675800318268052*^9, 3.675800364577742*^9}, {
   3.675800865098575*^9, 3.675800884623233*^9}, {3.675800930421735*^9, 
   3.675801014309965*^9}, {3.675801186092061*^9, 3.6758012139661913`*^9}, {
   3.675801288344637*^9, 3.6758013193919163`*^9}, 3.6758013515875397`*^9, 
   3.675803064876067*^9, {3.675804066393259*^9, 3.675804153401239*^9}, {
   3.6758041863032217`*^9, 3.6758043374296703`*^9}, {3.675804379631474*^9, 
   3.675804405220408*^9}, {3.675804468773355*^9, 3.6758044760993967`*^9}, {
   3.6758045933291197`*^9, 3.6758046212813377`*^9}, {3.67580471281376*^9, 
   3.675804990041334*^9}, {3.675807250863433*^9, 3.675807267889496*^9}, {
   3.6758682828614893`*^9, 3.675868466544877*^9}, {3.675868847460205*^9, 
   3.675868879272049*^9}, {3.6758689945484457`*^9, 3.675869057323271*^9}, {
   3.6758692719968433`*^9, 3.675869505863051*^9}, {3.675869548461001*^9, 
   3.675869585213458*^9}, {3.675869672096408*^9, 3.675869707584916*^9}, {
   3.6758697924963293`*^9, 3.6758697988408422`*^9}, {3.6758701927023563`*^9, 
   3.675870195453092*^9}, {3.675884173345504*^9, 3.675884174905342*^9}, 
   3.675884205449786*^9, {3.675884613602296*^9, 3.675884726757524*^9}, {
   3.6758847843497334`*^9, 3.675884792191498*^9}, {3.6758877458634987`*^9, 
   3.67588780384052*^9}, {3.675888599989387*^9, 3.6758886145965652`*^9}, {
   3.675889229466887*^9, 3.675889260919652*^9}, {3.675889303528616*^9, 
   3.67588933806083*^9}, {3.675896536777073*^9, 3.67589656979839*^9}, {
   3.6758966227806807`*^9, 3.67589663667232*^9}, {3.6758966752114058`*^9, 
   3.675896710149926*^9}, {3.675896944667272*^9, 3.675897162875085*^9}, {
   3.675897210236834*^9, 3.6758972821423197`*^9}, {3.676144028322125*^9, 
   3.676144070993865*^9}, {3.6761441769596453`*^9, 3.676144441895192*^9}, {
   3.676146910825089*^9, 3.6761469144318743`*^9}, {3.6761471000425863`*^9, 
   3.676147100371335*^9}, 3.676199586175791*^9}],

Cell["\<\
where r is the recombination rate between the A and original sex-determining \
locus.\
\>", "Text",
 CellChangeTimes->{{3.6765853555309963`*^9, 3.676585413904562*^9}}],

Cell["\<\
Check that the frequencies of allele 1 sum to one in each gamete type\
\>", "Text",
 CellChangeTimes->{{3.6761459247647343`*^9, 3.67614593273203*^9}, {
   3.6761471061486473`*^9, 3.676147118206574*^9}, 3.676199586176283*^9, {
   3.676585385785234*^9, 3.676585391764709*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAmprime", "+", "Xamprime"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"YAprime", "+", "Yaprime"}]}], "//", "Factor"}]}], "Input"],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6762056421181583`*^9, 3.6762059277947693`*^9, 
  3.676297509791378*^9, 3.676331473847481*^9, 3.6765707792505617`*^9, 
  3.676578082213728*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.6762056421181583`*^9, 3.6762059277947693`*^9, 
  3.676297509791378*^9, 3.676331473847481*^9, 3.6765707792505617`*^9, 
  3.676578082217596*^9}]
}, Open  ]],

Cell["\<\
Now, the frequency of allele 1 on the neo-y in the next generation is\
\>", "Text",
 CellChangeTimes->{{3.6761471255004587`*^9, 3.676147125916456*^9}, {
   3.676147502804685*^9, 3.676147521388979*^9}, 3.676199586178114*^9, {
   3.676205669611494*^9, 3.6762056742255783`*^9}, {3.676577423863628*^9, 
   3.6765774273909073`*^9}, {3.6765853985170107`*^9, 3.6765853995368843`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"xAprime", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"XAyAs", "+", 
     RowBox[{"XAyas", " ", "R"}], "+", 
     RowBox[{"XayAs", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}]}]}], 
    RowBox[{"XAyAs", "+", 
     RowBox[{"XAyas", " ", "R"}], "+", 
     RowBox[{"XayAs", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}]}], "+", 
     RowBox[{"XAyas", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}]}], "+", 
     RowBox[{"XayAs", " ", "R"}], "+", "Xayas"}]], "//", 
   "Factor"}]}]], "Input",
 CellChangeTimes->{{3.676206165746891*^9, 3.676206168430148*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{
     RowBox[{"-", "MAa"}], " ", "wA", " ", "xA", " ", "Xaf"}], "+", 
    RowBox[{"MAa", " ", "R", " ", "wA", " ", "xA", " ", "Xaf"}], "-", 
    RowBox[{"MAa", " ", "R", " ", "wa", " ", "XAf"}], "+", 
    RowBox[{"MAa", " ", "R", " ", "wa", " ", "xA", " ", "XAf"}], "-", 
    RowBox[{"MAA", " ", "wA", " ", "xA", " ", "XAf"}]}], 
   RowBox[{
    RowBox[{"Maa", " ", "wa", " ", "Xaf"}], "-", 
    RowBox[{"Maa", " ", "wa", " ", "xA", " ", "Xaf"}], "+", 
    RowBox[{"MAa", " ", "wA", " ", "xA", " ", "Xaf"}], "+", 
    RowBox[{"MAa", " ", "wa", " ", "XAf"}], "-", 
    RowBox[{"MAa", " ", "wa", " ", "xA", " ", "XAf"}], "+", 
    RowBox[{"MAA", " ", "wA", " ", "xA", " ", "XAf"}]}]]}]], "Output",
 CellChangeTimes->{3.676205650451346*^9, 3.676205930962201*^9, 
  3.6762061690041018`*^9, 3.676297509866753*^9, 3.676331473931458*^9, 
  3.676570779295562*^9, 3.676578082262344*^9}]
}, Open  ]],

Cell["\<\
where R is the recombination rate between the A and novel sex-determining \
locus.\
\>", "Text",
 CellChangeTimes->{{3.6765854389040203`*^9, 3.676585459455586*^9}}],

Cell["\<\
And the growth rate of the neo-y itself is\
\>", "Text",
 CellChangeTimes->{{3.676147800730928*^9, 3.676147823628798*^9}, 
   3.676199586179883*^9, {3.676577432637713*^9, 3.676577434734714*^9}, {
   3.67658543455127*^9, 3.676585435382078*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"RA", "=", 
  RowBox[{
   FractionBox[
    RowBox[{"XAyAs", "+", 
     RowBox[{"XAyas", " ", "R"}], "+", 
     RowBox[{"XayAs", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}]}], "+", 
     RowBox[{"XAyas", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}]}], "+", 
     RowBox[{"XayAs", " ", "R"}], "+", "Xayas"}], "\[Epsilon]y"], "//", 
   "Factor"}]}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "Maa"}], " ", "wa", " ", "Xaf"}], "+", 
     RowBox[{"Maa", " ", "wa", " ", "xA", " ", "Xaf"}], "-", 
     RowBox[{"MAa", " ", "wA", " ", "xA", " ", "Xaf"}], "-", 
     RowBox[{"MAa", " ", "wa", " ", "XAf"}], "+", 
     RowBox[{"MAa", " ", "wa", " ", "xA", " ", "XAf"}], "-", 
     RowBox[{"MAA", " ", "wA", " ", "xA", " ", "XAf"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"wa", " ", "Ya"}], "+", 
     RowBox[{"wA", " ", "YA"}]}], ")"}]}], 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "wa"}], "+", 
     RowBox[{"wa", " ", "xA"}], "-", 
     RowBox[{"wA", " ", "xA"}]}], ")"}], " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"Maa", " ", "wa", " ", "Xaf", " ", "Ya"}], "+", 
     RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "Ya"}], "+", 
     RowBox[{"MAa", " ", "wA", " ", "Xaf", " ", "YA"}], "+", 
     RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}]}]]], "Output",\

 CellChangeTimes->{3.67620565691848*^9, 3.67620593382829*^9, 
  3.676297509929885*^9, 3.676331474002404*^9, 3.676570779371256*^9, 
  3.676578082344108*^9}]
}, Open  ]],

Cell["\<\
This collapses to van Doorn and Kirkpatrick\[CloseCurlyQuote]s result under \
special circumstances (bottom page 3)\
\>", "Text",
 CellChangeTimes->{{3.676152735070064*^9, 3.676152754087295*^9}, 
   3.67619958618145*^9, {3.676582344731991*^9, 3.6765823534894047`*^9}, {
   3.676585472995944*^9, 3.676585473878415*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"RA", "/.", 
              RowBox[{"wA", "\[Rule]", "1"}]}], "/.", 
             RowBox[{"wa", "\[Rule]", "1"}]}], "/.", 
            RowBox[{"Maa", "\[Rule]", "1"}]}], "/.", 
           RowBox[{"MAa", "\[Rule]", 
            RowBox[{"1", "+", 
             RowBox[{"hAm", " ", "sAm"}]}]}]}], "/.", 
          RowBox[{"MAA", "\[Rule]", 
           RowBox[{"1", "+", "sAm"}]}]}], "/.", 
         RowBox[{"Faa", "\[Rule]", "1"}]}], "/.", 
        RowBox[{"FAa", "\[Rule]", 
         RowBox[{"1", "+", 
          RowBox[{"hAf", " ", "sAf"}]}]}]}], "/.", 
       RowBox[{"FAA", "\[Rule]", 
        RowBox[{"1", "+", "sAf"}]}]}], "/.", 
      RowBox[{"Ya", "\[Rule]", 
       RowBox[{"1", "-", "YA"}]}]}], "/.", 
     RowBox[{"Xam", "\[Rule]", 
      RowBox[{"1", "-", "XAm"}]}]}], "/.", 
    RowBox[{"Xaf", "\[Rule]", 
     RowBox[{"1", "-", "XAf"}]}]}], "/.", 
   RowBox[{"xa", "\[Rule]", 
    RowBox[{"1", "-", "xA"}]}]}], "//", "FullSimplify"}]], "Input"],

Cell[BoxData[
 FractionBox[
  RowBox[{"1", "+", 
   RowBox[{"sAm", " ", "xA", " ", "XAf"}], "+", 
   RowBox[{"hAm", " ", "sAm", " ", 
    RowBox[{"(", 
     RowBox[{"xA", "+", "XAf", "-", 
      RowBox[{"2", " ", "xA", " ", "XAf"}]}], ")"}]}]}], 
  RowBox[{"1", "+", 
   RowBox[{"sAm", " ", "XAf", " ", "YA"}], "+", 
   RowBox[{"hAm", " ", "sAm", " ", 
    RowBox[{"(", 
     RowBox[{"XAf", "+", "YA", "-", 
      RowBox[{"2", " ", "XAf", " ", "YA"}]}], ")"}]}]}]]], "Output",
 CellChangeTimes->{3.676205683653319*^9, 3.676205936378998*^9, 
  3.6762975102260313`*^9, 3.6763314743080997`*^9, 3.676570779560524*^9, 
  3.676578082634514*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Weak selection approximation", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9, 3.676206076324637*^9, {3.676582539239078*^9, 
   3.676582542329505*^9}, {3.676583990586585*^9, 3.676583993478483*^9}}],

Cell["\<\
To simplify the following analysis we assume weak selection in both haploids \
(sperm/pollen) and diploids\
\>", "Text",
 CellChangeTimes->{{3.675694205010009*^9, 3.675694211923259*^9}, 
   3.67570298472752*^9, {3.6757030454432507`*^9, 3.6757030568360033`*^9}, {
   3.676582566945178*^9, 3.6765825689281187`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weaksel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAm", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAm", " ", "sAm", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Maa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAf", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAf", " ", "sAf", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Faa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"wA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"t", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"wa", "\[Rule]", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67564806523287*^9, 3.675648221558539*^9}, {
   3.675694367971285*^9, 3.6756943845803022`*^9}, 3.6757029847280283`*^9}],

Cell["\<\
We will solve for the equilibrium frequency of allele 1 in each of the \
haploid genotypes. Equilibrium is achieved when the following equations are \
zero\
\>", "Text",
 CellChangeTimes->{{3.675694155902801*^9, 3.675694193760104*^9}, {
  3.6756944337868023`*^9, 3.6756944351881227`*^9}, {3.6757029847267847`*^9, 
  3.67570303405547*^9}, {3.675710696458521*^9, 3.675710706286772*^9}, {
  3.676206098927346*^9, 3.67620611994131*^9}, {3.676582413597246*^9, 
  3.676582413722025*^9}, {3.676582573510099*^9, 3.676582574660082*^9}, {
  3.676585485737124*^9, 3.676585487171049*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqs", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAfprime", "-", "XAf"}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAmprime", "-", "XAm"}], ",", "\[IndentingNewLine]", 
     RowBox[{"YAprime", "-", "YA"}], ",", "\[IndentingNewLine]", 
     RowBox[{"xAprime", "-", "xA"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675647987041369*^9, 3.67564802904979*^9}, {
   3.675650509895372*^9, 3.675650527299842*^9}, {3.6756941716513157`*^9, 
   3.6756941738671913`*^9}, {3.675694338488646*^9, 3.675694340978696*^9}, {
   3.675694394143187*^9, 3.6756944261522427`*^9}, 3.6756944751724463`*^9, 
   3.675702984727247*^9, {3.675703036868017*^9, 3.675703037688758*^9}, 
   3.67578824463701*^9, {3.6762061216237183`*^9, 3.676206147752295*^9}, {
   3.6762061820923433`*^9, 3.676206183709196*^9}}],

Cell["We can write the frequencies as Taylor series", "Text",
 CellChangeTimes->{{3.675707045047565*^9, 3.6757070543930063`*^9}, {
  3.675707367038864*^9, 3.675707370179316*^9}, {3.675711803871513*^9, 
  3.6757118112225847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frequenciessub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", 
      RowBox[{"XAf0", "+", 
       RowBox[{"XAf1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAm", "\[Rule]", 
      RowBox[{"XAm0", "+", 
       RowBox[{"XAm1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YA", "\[Rule]", 
      RowBox[{"YA0", "+", 
       RowBox[{"YA1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"xA", "\[Rule]", 
      RowBox[{"xA0", "+", 
       RowBox[{"xA1", " ", "\[Epsilon]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675648297857716*^9, 3.6756483630660057`*^9}, 
   3.675648454638584*^9, 3.675702984736863*^9, {3.6762068917424583`*^9, 
   3.676206901931716*^9}}],

Cell["\<\
Without selection, the recursions for the change in frequency of allele 1 in \
each gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.6757032054455214`*^9, 3.6757032697493563`*^9}, {
   3.6757098202812138`*^9, 3.675709824765788*^9}, {3.6757117765596933`*^9, 
   3.6757117850524673`*^9}, {3.675711818872109*^9, 3.6757118199810133`*^9}, 
   3.6761381565029078`*^9, {3.6765854945288477`*^9, 3.67658549558394*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs0", "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "frequenciessub"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.675703197099375*^9, 3.675703198353765*^9}, {
  3.675703326603519*^9, 3.675703332003808*^9}, {3.67570336997014*^9, 
  3.675703373531238*^9}, {3.675707060003501*^9, 3.675707071963544*^9}, {
  3.675707629815399*^9, 3.675707668691402*^9}, {3.6757098279293118`*^9, 
  3.6757098635569563`*^9}, {3.675785533464711*^9, 3.675785543888385*^9}, {
  3.675788240589053*^9, 3.675788247183043*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "XAf0"}], "+", "XAm0"}], ")"}]}], ",", 
   RowBox[{"XAf0", "-", 
    RowBox[{"r", " ", "XAf0"}], "-", "XAm0", "+", 
    RowBox[{"r", " ", "YA0"}]}], ",", 
   RowBox[{
    RowBox[{"r", " ", "XAf0"}], "-", 
    RowBox[{"r", " ", "YA0"}]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "R"}], " ", "xA0"}], "+", 
    RowBox[{"R", " ", "XAf0"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675703373832204*^9, 3.675707072550578*^9, 3.6757076390361347`*^9, 
   3.675707669538135*^9, {3.675709828918172*^9, 3.6757098643685303`*^9}, 
   3.675727585946179*^9, 3.675785428940669*^9, 3.675788254779942*^9, 
   3.6761381624813623`*^9, 3.676146369707528*^9, 3.676205569877428*^9, 
   3.676206197071246*^9, 3.676206906572702*^9, 3.676297519938478*^9, 
   3.676331482213591*^9, 3.676570779809972*^9, 3.676578085302965*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675709831409095*^9, 3.6757098343025913`*^9}, {
  3.675710744701475*^9, 3.675710745621426*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"differenceEqs0", "\[Equal]", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"XAf0", ",", "XAm0", ",", "YA0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675709931730151*^9, 3.675709948227565*^9}, 
   3.676138176648445*^9, {3.676206210111945*^9, 3.676206222819953*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"XAf0", "\[Rule]", "xA0"}], ",", 
    RowBox[{"XAm0", "\[Rule]", "xA0"}], ",", 
    RowBox[{"YA0", "\[Rule]", "xA0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6757098363525476`*^9, {3.6757099323567266`*^9, 3.675709948639193*^9}, 
   3.675727587389184*^9, 3.675785430130021*^9, 3.67578825590738*^9, {
   3.676138165134851*^9, 3.676138177014187*^9}, 3.676146369743536*^9, 
   3.6762055698992853`*^9, {3.676206202720709*^9, 3.676206223421821*^9}, 
   3.676206909229083*^9, 3.676297519977676*^9, 3.6763314822510242`*^9, 
   3.676570779849722*^9, 3.676578085332281*^9}]
}, Open  ]],

Cell["\<\
So, with no selection, the equilibrium frequency of allele 1 in each \
gamete/pollen type is equal (and we call this pA).\
\>", "Text",
 CellChangeTimes->{{3.675703427939505*^9, 3.6757035626138153`*^9}, {
   3.675706719194449*^9, 3.675706765062245*^9}, 3.67570996472328*^9, {
   3.6757107664993973`*^9, 3.675710849444377*^9}, {3.67658549993237*^9, 
   3.6765855007726107`*^9}}],

Cell[CellGroupData[{

Cell["Weak linkage approximation", "Subsection",
 CellChangeTimes->{{3.676583982853201*^9, 3.6765840292901897`*^9}}],

Cell["\<\
Following van Doorn and Kirkpatrick, when recombination between the A and \
neo-y loci is strong relative to selection, we can write the frequencies of \
allele 1 in each haploid type like\
\>", "Text",
 CellChangeTimes->{{3.676582681109103*^9, 3.676582711765044*^9}, {
  3.676583663659438*^9, 3.676583701804626*^9}, {3.676585515481655*^9, 
  3.676585516714439*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pAsubs", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", 
      RowBox[{"pA", "+", 
       RowBox[{
        FractionBox["1", "3"], "\[Epsilon]", " ", "dpAXY"}], "+", 
       RowBox[{"\[Epsilon]", " ", "dpAXfXm"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAm", "\[Rule]", 
      RowBox[{"pA", "+", 
       RowBox[{
        FractionBox["1", "3"], "\[Epsilon]", " ", "dpAXY"}], "-", 
       RowBox[{"\[Epsilon]", " ", "dpAXfXm"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YA", "\[Rule]", 
      RowBox[{"pA", "-", 
       RowBox[{"\[Epsilon]", " ", "dpAXY"}], "-", 
       RowBox[{"\[Epsilon]", " ", "dpAXfXm"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"xA", "\[Rule]", 
      RowBox[{"pA", "+", 
       RowBox[{
        FractionBox["1", "3"], "\[Epsilon]", " ", "dpAXY"}], "-", 
       RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
       RowBox[{"2", "\[Epsilon]", " ", "dpAxXm"}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6765806182823467`*^9, 3.67658076569499*^9}, {
  3.6765808375724983`*^9, 3.676580838499551*^9}, {3.676582796261376*^9, 
  3.676582801741729*^9}}],

Cell["\<\
where dpAXY is the difference in the frequency of allele 1 on X vs Y \
chromosomes, dpAXfXm is the difference in the frequency of allele 1 on female \
vs male X chromosomes, and dpAxXm is the difference in the frequency of \
allele 1 on X chromosomes in males with novel vs original sex determination \
factors.\
\>", "Text",
 CellChangeTimes->{{3.676582733558008*^9, 3.6765829061581078`*^9}, {
  3.676585521925498*^9, 3.676585532659276*^9}}],

Cell["\<\
We can then approximate the growth rate of the neo-y as\
\>", "Text",
 CellChangeTimes->{{3.6765829246041737`*^9, 3.676582949342616*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"approxRA", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"RA", "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "pAsubs"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6765807827359753`*^9, 3.676580854074707*^9}, {
  3.676582023871292*^9, 3.676582026168914*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   RowBox[{
    FractionBox["2", "3"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", "dpAxXm"}], "+", 
        RowBox[{"2", " ", "dpAXY"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "pA"}], "+", 
        RowBox[{"hAm", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "pA"}]}], ")"}]}]}], ")"}], " ", "sAm"}], ")"}], 
    " ", 
    SuperscriptBox["\[Epsilon]", "2"]}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   1, 0, Rational[-2, 3] (3 $CellContext`dpAxXm + 
     2 $CellContext`dpAXY) (-$CellContext`pA + $CellContext`hAm (-1 + 
       2 $CellContext`pA)) $CellContext`sAm}, 0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.6765808162942142`*^9, 3.676580854374343*^9}, 
   3.676582026714388*^9}]
}, Open  ]],

Cell["The recursion for dpAXY is", "Text",
 CellChangeTimes->{{3.676583004151986*^9, 3.676583011993733*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXY", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", " ", "XAfprime"}], "+", "XAmprime", "-", 
             "YAprime"}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "XAf"}], "+", "XAm", "-", "YA"}], ")"}]}], "/.", 
          "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "pAsubs"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.676580883808177*^9, 3.676580896867023*^9}, {
   3.676580959265214*^9, 3.6765809613463917`*^9}, {3.676581065889534*^9, 
   3.676581066519405*^9}, 3.676581371277791*^9, 3.676581423427621*^9, {
   3.6765815851357327`*^9, 3.676581586215435*^9}, 3.676581635398266*^9, 
   3.676582992439571*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "4"}], " ", "dpAXfXm", " ", "r"}], "-", 
      FractionBox[
       RowBox[{"8", " ", "dpAXY", " ", "r"}], "3"], "+", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAf"}], "+", 
         RowBox[{"hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
         RowBox[{"r", " ", "t"}]}], ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
   "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 
   0, {(-4) $CellContext`dpAXfXm $CellContext`r + 
    Rational[-8, 3] $CellContext`dpAXY $CellContext`r + 
    2 (-1 + $CellContext`pA) $CellContext`pA (-$CellContext`pA \
$CellContext`sAf + $CellContext`hAf (-1 + 
        2 $CellContext`pA) $CellContext`sAf - $CellContext`r $CellContext`t)},
    1, 2, 1],
  Editable->False]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.676580884679142*^9, 3.676580897283772*^9}, 
   3.676580961878104*^9, 3.676581066981305*^9, 3.676581371726273*^9, 
   3.676581424061479*^9, 3.676581586516067*^9, 3.676581635801958*^9, 
   3.676582992441887*^9}]
}, Open  ]],

Cell["The recursion for dpXfXm is", "Text",
 CellChangeTimes->{{3.6765830141793623`*^9, 3.676583024449457*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfXm", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"XAfprime", "-", "XAmprime"}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{"XAf", "-", "XAm"}], ")"}]}], "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "pAsubs"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.676581112007431*^9, 3.676581139917885*^9}, {
   3.67658159576521*^9, 3.676581596801098*^9}, 3.676581638264957*^9, 
   3.67658299244444*^9}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"4", " ", "dpAXY", " ", "r"}], "3"], "+", 
      RowBox[{"dpAXfXm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", 
         RowBox[{"2", " ", "r"}]}], ")"}]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "+", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}], "-", 
         RowBox[{"2", " ", "pA", " ", 
          RowBox[{"(", 
           RowBox[{"sAf", "-", "sAm", "+", 
            RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t", "+", 
         RowBox[{"2", " ", "r", " ", "t"}]}], ")"}]}]}], ")"}], " ", 
    "\[Epsilon]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   Rational[4, 
       3] $CellContext`dpAXY $CellContext`r + $CellContext`dpAXfXm (-3 + 
      2 $CellContext`r) + 
    Rational[1, 2] (-1 + $CellContext`pA) $CellContext`pA (
      2 $CellContext`hAf (-1 + 2 $CellContext`pA) $CellContext`sAf + 
      2 $CellContext`hAm $CellContext`sAm - 
      2 $CellContext`pA ($CellContext`sAf - $CellContext`sAm + 
       2 $CellContext`hAm $CellContext`sAm) - $CellContext`t + 
      2 $CellContext`r $CellContext`t)}, 1, 2, 1],
  Editable->False]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{3.676581141700481*^9, 3.6765815970517263`*^9, 
  3.676581638666195*^9, 3.6765829924468*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.676583030500333*^9, 3.676583035286235*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpasubs1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eqdpAXY", "\[Equal]", "0"}], ",", 
        RowBox[{"eqdpAXfXm", "\[Equal]", "0"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"dpAXY", ",", "dpAXfXm"}], "}"}]}], "]"}], "//", "Flatten"}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.6765816270811863`*^9, 3.676581707261133*^9}, 
   3.6765829924489326`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"dpAXY", "\[Rule]", 
    RowBox[{"-", 
     RowBox[{
      FractionBox["1", 
       RowBox[{"4", " ", "r"}]], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{"4", " ", "r"}]}], ")"}], " ", "sAf"}], "+", 
         RowBox[{"pA", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", " ", "sAf"}], "-", 
            RowBox[{"4", " ", "r", " ", "sAf"}], "+", 
            RowBox[{"2", " ", "r", " ", "sAm"}], "-", 
            RowBox[{"4", " ", "hAm", " ", "r", " ", "sAm"}]}], ")"}]}], "+", 
         RowBox[{"2", " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}]}]}]}]}],
    ",", 
   RowBox[{"dpAXfXm", "\[Rule]", 
    RowBox[{
     FractionBox["1", "6"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"4", " ", "hAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "+", 
       RowBox[{"2", " ", "hAm", " ", "sAm"}], "+", 
       RowBox[{"2", " ", "pA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", "sAf"}], "+", "sAm", "-", 
          RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], 
      ")"}]}]}]}], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6765816757750797`*^9, 3.6765817078003407`*^9}, 
   3.6765829924512672`*^9}]
}, Open  ]],

Cell["The recursion for dpAxXm is", "Text",
 CellChangeTimes->{{3.676583039166065*^9, 3.6765830471899357`*^9}, {
  3.676583094087145*^9, 3.676583095512813*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAxXm", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"xAprime", "-", "XAmprime"}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{"xA", "-", "XAm"}], ")"}]}], "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "pAsubs"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.676583091611586*^9, 3.676583092582191*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"4", " ", "dpAXY", " ", "r"}], "3"], "-", 
      RowBox[{"2", " ", "dpAxXm", " ", "R"}], "+", 
      RowBox[{"2", " ", "dpAXfXm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}]}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}], "-", 
      RowBox[{"pA", " ", "r", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}], "-", 
      RowBox[{"pA", " ", "R", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "R", " ", "t"}]}], ")"}], " ", 
    "\[Epsilon]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   Rational[4, 3] $CellContext`dpAXY $CellContext`r - 
    2 $CellContext`dpAxXm $CellContext`R + 
    2 $CellContext`dpAXfXm (-1 + $CellContext`r + $CellContext`R) + \
$CellContext`pA $CellContext`t - $CellContext`pA^2 $CellContext`t - \
$CellContext`pA $CellContext`r $CellContext`t + $CellContext`pA^2 \
$CellContext`r $CellContext`t - $CellContext`pA $CellContext`R $CellContext`t + \
$CellContext`pA^2 $CellContext`R $CellContext`t}, 1, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.676583080250073*^9, 3.6765831020183897`*^9}}]
}, Open  ]],

Cell["And at equilibrium", "Text",
 CellChangeTimes->{{3.676583104285584*^9, 3.676583107198604*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpasubs2", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"eqdpAxXm", "\[Equal]", "0"}], "}"}], ",", 
      RowBox[{"{", "dpAxXm", "}"}]}], "]"}], "//", "Flatten"}], "//", 
   "FullSimplify"}]}]], "Input"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAxXm", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{"4", " ", "dpAXY", " ", "r"}], "+", 
     RowBox[{"6", " ", "dpAXfXm", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}]}], "+", 
     RowBox[{"3", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", "t"}]}], 
    RowBox[{"6", " ", "R"}]]}], "}"}]], "Output",
 CellChangeTimes->{3.676583116384721*^9}]
}, Open  ]],

Cell["\<\
Subbing in the previous equilibrium result gives\
\>", "Text",
 CellChangeTimes->{{3.6765831206852293`*^9, 3.6765831292482557`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpasubs3", "=", 
  RowBox[{
   RowBox[{"dpasubs2", "/.", "dpasubs1"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.676581989717371*^9, 3.6765820072938843`*^9}, 
   3.676582992459038*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAxXm", "\[Rule]", 
   RowBox[{
    FractionBox["1", 
     RowBox[{"6", " ", "R"}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"4", " ", "R"}]}], ")"}], " ", "sAf"}], "+", 
       RowBox[{"pA", " ", 
        RowBox[{"(", 
         RowBox[{"sAf", "-", 
          RowBox[{"4", " ", "R", " ", "sAf"}], "+", 
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "hAm"}], "+", "R", "-", 
             RowBox[{"2", " ", "hAm", " ", "R"}]}], ")"}], " ", "sAm"}]}], 
         ")"}]}], "+", 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.676582000913072*^9, 3.676582007612401*^9}, 
   3.676582130802669*^9, 3.676582992459941*^9}]
}, Open  ]],

Cell["\<\
Thus, at equilibrium, the growth rate of the rare neo-y is\
\>", "Text",
 CellChangeTimes->{{3.676583136027124*^9, 3.6765831599716597`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"appRA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"approxRA", "/.", "dpasubs1"}], "/.", "dpasubs3"}], "//", 
   "FullSimplify"}]}]], "Input"],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "+", 
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pA"}], "+", 
       RowBox[{"hAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}]}]}], ")"}], " ", "sAm", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"r", "-", 
          RowBox[{"3", " ", "R"}]}], ")"}], " ", "sAf"}], "+", 
       RowBox[{"pA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"3", " ", "R", " ", "sAf"}], "-", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{"sAf", "-", 
             RowBox[{"2", " ", "sAm"}], "+", 
             RowBox[{"4", " ", "hAm", " ", "sAm"}]}], ")"}]}]}], ")"}]}], "+", 
       RowBox[{"2", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox["\[Epsilon]", "2"]}], 
    RowBox[{"3", " ", "r", " ", "R"}]], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 3, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   1, 0, Rational[
     1, 3] (-1 + $CellContext`pA) $CellContext`pA (-$CellContext`pA + \
$CellContext`hAm (-1 + 
       2 $CellContext`pA)) $CellContext`r^(-1) $CellContext`R^(-1) \
$CellContext`sAm ($CellContext`hAf (-1 + 2 $CellContext`pA) ($CellContext`r - 
       3 $CellContext`R) $CellContext`sAf + $CellContext`pA (
       3 $CellContext`R $CellContext`sAf - $CellContext`r ($CellContext`sAf - 
        2 $CellContext`sAm + 4 $CellContext`hAm $CellContext`sAm)) + 
     2 $CellContext`r ($CellContext`hAm $CellContext`sAm + $CellContext`t))}, 
   0, 3, 1],
  Editable->False]], "Output",
 CellChangeTimes->{3.67658316763675*^9}]
}, Open  ]],

Cell["\<\
Finally, when the neo-y is rare, the change in the frequency of allele 1 is\
\>", "Text",
 CellChangeTimes->{{3.67571806556964*^9, 3.675718103851286*^9}, {
  3.6765834391762857`*^9, 3.676583453055295*^9}, {3.676585542401919*^9, 
  3.676585571067319*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"2", " ", "XAfprime"}], "+", "XAmprime", "+", "YAprime", 
            "-", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", "XAf"}], "+", "XAm", "+", "YA"}], ")"}]}], "/.", 
           "weaksel"}], "/.", 
          RowBox[{"Xaf", "\[Rule]", 
           RowBox[{"1", "-", "XAf"}]}]}], "/.", 
         RowBox[{"Ya", "\[Rule]", 
          RowBox[{"1", "-", "YA"}]}]}], "/.", 
        RowBox[{"Xam", "\[Rule]", 
         RowBox[{"1", "-", "XAm"}]}]}], "/.", "pAsubs"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "/", "4"}],
    "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675717647887065*^9, 3.675717697126732*^9}, {
   3.675717728154462*^9, 3.675717827465465*^9}, {3.675717886726254*^9, 
   3.6757179766881647`*^9}, {3.675718083857135*^9, 3.6757180905764112`*^9}, 
   3.67571817039502*^9, {3.675719298161072*^9, 3.675719300128034*^9}, {
   3.676585605195706*^9, 3.6765856364924994`*^9}, {3.6765857488167763`*^9, 
   3.6765857509556313`*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"3", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"2", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}]}], ")"}], " ", "\[Epsilon]"}], 
   "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   Rational[1, 
      2] ($CellContext`hAf $CellContext`pA $CellContext`sAf + \
$CellContext`pA^2 $CellContext`sAf - 
     3 $CellContext`hAf $CellContext`pA^2 $CellContext`sAf - \
$CellContext`pA^3 $CellContext`sAf + 
     2 $CellContext`hAf $CellContext`pA^3 $CellContext`sAf + $CellContext`hAm \
$CellContext`pA $CellContext`sAm + $CellContext`pA^2 $CellContext`sAm - 
     3 $CellContext`hAm $CellContext`pA^2 $CellContext`sAm - \
$CellContext`pA^3 $CellContext`sAm + 
     2 $CellContext`hAm $CellContext`pA^3 $CellContext`sAm + $CellContext`pA \
$CellContext`t - $CellContext`pA^2 $CellContext`t)}, 1, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.675717675625972*^9, 3.675717697744046*^9}, {
   3.675717736995945*^9, 3.675717827905334*^9}, {3.675717912013361*^9, 
   3.6757179770805798`*^9}, {3.675718122247941*^9, 3.675718137314794*^9}, 
   3.675718171232416*^9, {3.675719279665413*^9, 3.6757193043150883`*^9}, 
   3.675727597413587*^9, 3.675785439649287*^9, 3.67578826604628*^9, 
   3.676138226117289*^9, 3.676146370223422*^9, 3.676205570352737*^9, 
   3.676206296389659*^9, {3.67620634706423*^9, 3.676206375228558*^9}, 
   3.676207128152871*^9, 3.676297520582735*^9, 3.676298332781748*^9, 
   3.676331483548442*^9, 3.67657078078118*^9, 3.676578087230349*^9, 
   3.676578734997006*^9, 3.676585638371043*^9, 3.676585752141261*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.6757181100991917`*^9, 3.675718119482112*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpA", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"dpA", "\[Equal]", "0"}], ",", "pA"}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.675717988879238*^9, 3.67571803095448*^9}, {
   3.6757181277583733`*^9, 3.6757181353000813`*^9}, {3.6757192734183817`*^9, 
   3.6757193075868177`*^9}, 3.676585765707481*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"hAf", " ", "sAf"}], "+", 
        RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
       RowBox[{"sAf", "-", 
        RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
        RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675717995245247*^9, 3.675718031314158*^9}, {
   3.675718129676858*^9, 3.675718138913946*^9}, 3.67571817443064*^9, {
   3.675719281498005*^9, 3.675719308048888*^9}, 3.675727602150854*^9, 
   3.675785444054607*^9, 3.675788267688079*^9, 3.676138228966215*^9, 
   3.6761463703060913`*^9, 3.676205570544559*^9, 3.676206298808464*^9, {
   3.676206349876573*^9, 3.676206377786057*^9}, 3.676207130419146*^9, 
   3.676297520663327*^9, 3.676331483702094*^9, 3.6765707808531227`*^9, 
   3.67657808761314*^9, 3.676585666084318*^9, {3.6765857559077997`*^9, 
   3.676585766096719*^9}}]
}, Open  ]],

Cell["\<\
We can now use this in the expression for the neo-y growth rate. To check our \
work, the growth rate should reduce to Kirkpatrick\[CloseCurlyQuote]s result \
when there is no haploid selection and there is free recombination between \
the A locus and the novel sex determination locus\
\>", "Text",
 CellChangeTimes->{{3.676583180291844*^9, 3.67658324151683*^9}, {
  3.676583473577385*^9, 3.676583542975013*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"kirk", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"{", 
         RowBox[{"1", "-", 
          RowBox[{"VA", " ", "LA", " ", "SA"}]}], "}"}], "/.", 
        RowBox[{"VA", "\[Rule]", 
         RowBox[{"pA", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pA"}], ")"}]}]}]}], "/.", 
       RowBox[{"LA", "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "r"}]}], ")"}], "/", "r"}]}]}], "/.", 
      RowBox[{"SA", "\[Rule]", 
       RowBox[{"\[Sigma]Am", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Sigma]Am", "-", "\[Sigma]Af"}], ")"}], "/", "2"}]}]}]}], 
     "/.", 
     RowBox[{"\[Sigma]Am", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pA", "+", 
         RowBox[{"hAm", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "pA"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
       "sAm"}]}]}], "/.", 
    RowBox[{"\[Sigma]Af", "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"pA", "+", 
        RowBox[{"hAf", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           RowBox[{"2", "pA"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
      "sAf"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"appRA", "-", "kirk"}], "/.", 
     RowBox[{"eqpA", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
    RowBox[{"t", "\[Rule]", "0"}]}], "/.", 
   RowBox[{"R", "\[Rule]", 
    RowBox[{"1", "/", "2"}]}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.676583329405044*^9, 3.676583346640188*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  InterpretationBox[
   SuperscriptBox[
    RowBox[{"O", "[", "\[Epsilon]", "]"}], "3"],
   SeriesData[$CellContext`\[Epsilon], 0, {}, 3, 3, 1],
   Editable->False], "}"}]], "Output",
 CellChangeTimes->{{3.676583318842709*^9, 3.676583347125813*^9}, 
   3.676585773825858*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Tight linkage approximation", "Subsection",
 CellChangeTimes->{{3.676583710887702*^9, 3.676583716758197*^9}, {
  3.67658401403446*^9, 3.6765840210853662`*^9}}],

Cell["\<\
When recombination between the original sex-determining locus and the A locus \
is of the same order (or greater) as selection on the A locus, we can no \
longer assume the difference in the frequency of allele 1 with the X and Y to \
be small. Following van Doorn and Kirkpatrick, we use the new change of \
variables\
\>", "Text",
 CellChangeTimes->{{3.676584387492292*^9, 3.6765845086738358`*^9}, {
  3.676585787423489*^9, 3.6765858117223463`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"pAsubsLinked", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", 
      RowBox[{"pAX", "+", 
       RowBox[{"\[Epsilon]", " ", "dpAXfXm"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAm", "\[Rule]", 
      RowBox[{"pAX", "-", 
       RowBox[{"2", "\[Epsilon]", " ", "dpAXfXm"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"YA", "\[Rule]", "pAY"}], ",", "\[IndentingNewLine]", 
     RowBox[{"xA", "\[Rule]", 
      RowBox[{"pAX", "+", 
       RowBox[{"\[Epsilon]", " ", "dpAxX"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"r", "\[Rule]", 
      RowBox[{"\[Epsilon]", " ", "r1"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6765845199292593`*^9, 3.6765846288082247`*^9}, {
  3.676586106483119*^9, 3.6765861065996113`*^9}}],

Cell["\<\
where pAX and pAY are the average frequencies of allele 1 on X and Y \
chromosomes and dpAxX is the difference in the frequency of allele 1 with the \
novel sex-determining factor vs the original sex-determining factor.\
\>", "Text",
 CellChangeTimes->{{3.676584639381562*^9, 3.676584686528328*^9}, {
  3.6765858272906437`*^9, 3.676585890810379*^9}}],

Cell["\<\
An approximation for the growth rate of the neo-y is then\
\>", "Text",
 CellChangeTimes->{{3.6765859536512833`*^9, 3.676585971071102*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"approxRALinked", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"RA", "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "pAsubsLinked"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.676585904062738*^9, 3.676585939513118*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{"1", "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pAX"}], "+", 
      RowBox[{"hAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pAX"}]}], ")"}]}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"pAX", "-", "pAY"}], ")"}], " ", "sAm", " ", "\[Epsilon]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 0, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   1, -(-$CellContext`pAX + $CellContext`hAm (-1 + 
       2 $CellContext`pAX)) ($CellContext`pAX - $CellContext`pAY) \
$CellContext`sAm}, 0, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.6765859274394703`*^9, 3.67658593978104*^9}, 
   3.676586111320175*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of allele 1 on the X and Y chromosomes is \
then approximately\
\>", "Text",
 CellChangeTimes->{{3.676586056717393*^9, 3.676586083827791*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpAXYLinked", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "XAfprime"}], "+", "XAmprime", "-", 
             RowBox[{"3", "YAprime"}]}], ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "XAf"}], "+", "XAm", "-", 
             RowBox[{"3", "YA"}]}], ")"}]}], "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "pAsubsLinked"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.676586002316033*^9, 3.676586014417512*^9}, {
  3.676586076878158*^9, 3.676586170784618*^9}, {3.676586317308647*^9, 
  3.67658631805939*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "hAf"}]}], ")"}], " ", 
       SuperscriptBox["pAX", "3"], " ", "sAf"}], "-", 
      RowBox[{
       SuperscriptBox["pAX", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"6", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"hAm", "+", "pAY", "-", 
            RowBox[{"2", " ", "hAm", " ", "pAY"}]}], ")"}], " ", "sAm"}], "+",
          "t"}], ")"}]}], "+", 
      RowBox[{"pAX", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "4"}], " ", "r1"}], "+", 
         RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", 
         RowBox[{"pAY", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"3", " ", "pAY"}]}], ")"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"4", " ", "pAY"}], "-", 
            RowBox[{"6", " ", 
             SuperscriptBox["pAY", "2"]}]}], ")"}], " ", "sAm"}], "+", "t"}], 
        ")"}]}], "+", 
      RowBox[{"pAY", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", "r1"}], "+", 
         RowBox[{"3", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "pAY"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}]}]}], 
     ")"}], " ", "\[Epsilon]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 0, {
   2 (-1 + 2 $CellContext`hAf) $CellContext`pAX^3 $CellContext`sAf - \
$CellContext`pAX^2 ((-2 + 
       6 $CellContext`hAf) $CellContext`sAf + ($CellContext`hAm + \
$CellContext`pAY - 
       2 $CellContext`hAm $CellContext`pAY) $CellContext`sAm + \
$CellContext`t) + $CellContext`pAX ((-4) $CellContext`r1 + 
      2 $CellContext`hAf $CellContext`sAf + $CellContext`pAY (-2 + 
        3 $CellContext`pAY) $CellContext`sAm + $CellContext`hAm (1 + 
        4 $CellContext`pAY - 
        6 $CellContext`pAY^2) $CellContext`sAm + $CellContext`t) + \
$CellContext`pAY (4 $CellContext`r1 + 
      3 (-1 + $CellContext`pAY) ($CellContext`hAm $CellContext`sAm + \
$CellContext`t))}, 1, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.676586153945653*^9, 3.676586171442275*^9}, 
   3.6765863290792007`*^9}]
}, Open  ]],

Cell["\<\
And the rate of change in the average frequency of allele 1 is\
\>", "Text",
 CellChangeTimes->{{3.6765868410016327`*^9, 3.676586856684408*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpALinked", "=", 
  RowBox[{
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "XAfprime"}], "+", "XAmprime", "+", "YAprime"}], 
            ")"}], "-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"2", "XAf"}], "+", "XAm", "+", "YA"}], ")"}]}], "/.", 
          "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "pAsubsLinked"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "//", 
   "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.676586290411571*^9, 3.676586326914856*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", 
       SuperscriptBox["pAX", "3"], " ", "sAf"}], "+", 
      RowBox[{"2", " ", "hAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pAX"}], ")"}], " ", "pAX", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pAX"}]}], ")"}], " ", "sAf"}], "+", 
      RowBox[{
       SuperscriptBox["pAX", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "sAf"}], "-", 
         RowBox[{"pAY", " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pAY"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}]}], "-", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pAY"}], ")"}], " ", "pAY", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}], "+", 
      RowBox[{"pAX", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "pAY"}], ")"}]}], " ", "pAY", " ", 
          "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "pAY"}], ")"}], " ", "pAY"}]}], ")"}],
           " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}], " ", "\[Epsilon]"}], 
   "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 
   0, {(-2) $CellContext`pAX^3 $CellContext`sAf + 
    2 $CellContext`hAf (-1 + $CellContext`pAX) $CellContext`pAX (-1 + 
      2 $CellContext`pAX) $CellContext`sAf + $CellContext`pAX^2 (
      2 $CellContext`sAf - $CellContext`pAY $CellContext`sAm + \
$CellContext`hAm (-1 + 
        2 $CellContext`pAY) $CellContext`sAm - $CellContext`t) - (-1 + \
$CellContext`pAY) $CellContext`pAY ($CellContext`hAm $CellContext`sAm + \
$CellContext`t) + $CellContext`pAX (-(-2 + $CellContext`pAY) $CellContext`pAY \
$CellContext`sAm + $CellContext`hAm (1 + 
        2 (-2 + $CellContext`pAY) $CellContext`pAY) $CellContext`sAm + \
$CellContext`t)}, 1, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.676586305528173*^9, 3.67658632732787*^9}}]
}, Open  ]],

Cell["\<\
We can simplify these expressions with some new terms\
\>", "Text",
 CellChangeTimes->{{3.676586998722804*^9, 3.676587014101894*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"simplesubs", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"\[Sigma]AX", "\[Rule]", 
      RowBox[{
       RowBox[{
        RowBox[{"2", "/", "3"}], 
        RowBox[{"(", 
         RowBox[{"pAX", "+", 
          RowBox[{"hAf", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", "pAX"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
        "sAf"}], "+", 
       RowBox[{
        RowBox[{"1", "/", "3"}], 
        RowBox[{"(", 
         RowBox[{"pAY", "+", 
          RowBox[{"hAm", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", "pAY"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
        "sAm"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"\[Sigma]AY", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pAX", "+", 
         RowBox[{"hAm", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "pAX"}]}], ")"}]}]}], ")"}], "\[Epsilon]", " ", 
       "sAm"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"VAX", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pAX"}], ")"}], "pAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"VAY", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pAY"}], ")"}], "pAY"}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676587015564591*^9, 3.6765871697825403`*^9}, {
  3.676587208687361*^9, 3.676587250806056*^9}, {3.676587408795269*^9, 
  3.676587412034004*^9}}],

Cell["\<\
We can then write the recursion for the difference in the frequency of allele \
1 with X and Y like\
\>", "Text",
 CellChangeTimes->{{3.6765874283259573`*^9, 3.6765874774343576`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqpAXYLinkedSimp", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "4"}], 
     RowBox[{"(", 
      RowBox[{"pAX", "-", "pAY"}], ")"}], "r"}], "+", 
    RowBox[{"3", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"VAX", " ", "\[Sigma]AX"}], "-", 
       RowBox[{"VAY", " ", "\[Sigma]AY"}]}], ")"}]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"VAX", "-", 
       RowBox[{"3", "VAY"}]}], ")"}], "t", " ", "\[Epsilon]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.676587268873069*^9, 3.676587363068524*^9}, {
  3.6765874819519367`*^9, 3.6765875121539297`*^9}, {3.676587574994731*^9, 
  3.676587612565858*^9}, {3.676587647581994*^9, 3.6765876509015913`*^9}}],

Cell["Check that this is indeed true", "Text",
 CellChangeTimes->{{3.6765876911944723`*^9, 3.676587695870624*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eqpAXYLinkedSimp", "-", "eqpAXYLinked"}], "/.", "simplesubs"}], "/.", 
   RowBox[{"r", "\[Rule]", 
    RowBox[{"r1", " ", "\[Epsilon]"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6765873672201643`*^9, 3.676587396545806*^9}, {
  3.6765874454428596`*^9, 3.676587451998765*^9}}],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
  SeriesData[$CellContext`\[Epsilon], 0, {}, 2, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.676587367578302*^9, 3.67658745228249*^9}, {
  3.6765875037854357`*^9, 3.676587533868641*^9}, {3.6765875779876213`*^9, 
  3.676587614805255*^9}}]
}, Open  ]],

Cell["\<\
And therefore at equilibrium we have\
\>", "Text",
 CellChangeTimes->{{3.6765877810275507`*^9, 3.676587788258544*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"0", "==", "eqpAXYLinkedSimp"}], "/.", 
    RowBox[{
     RowBox[{"pAX", "-", "pAY"}], "\[Rule]", "dpAXY"}]}], ",", "dpAXY"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6765877155706377`*^9, 3.6765877760793858`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"dpAXY", "\[Rule]", 
    FractionBox[
     RowBox[{
      RowBox[{"t", " ", "VAX", " ", "\[Epsilon]"}], "-", 
      RowBox[{"3", " ", "t", " ", "VAY", " ", "\[Epsilon]"}], "+", 
      RowBox[{"3", " ", "VAX", " ", "\[Sigma]AX"}], "-", 
      RowBox[{"3", " ", "VAY", " ", "\[Sigma]AY"}]}], 
     RowBox[{"4", " ", "r"}]]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.676587716290772*^9, {3.676587761858404*^9, 3.676587776526894*^9}}]
}, Open  ]],

Cell["\<\
Similarly, we can write the change in the frequency of allele 1 as\
\>", "Text",
 CellChangeTimes->{{3.67658792359157*^9, 3.6765879381818743`*^9}, {
  3.676588005294889*^9, 3.676588008267151*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqpALinkedSimp", "=", 
   RowBox[{
    RowBox[{"3", "VAX", " ", "\[Sigma]AX"}], "+", 
    RowBox[{"VAY", " ", "\[Sigma]AY"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"VAX", "+", "VAY"}], ")"}], "t", " ", "\[Epsilon]"}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67658784167068*^9, 3.6765878727494507`*^9}, {
  3.676587918431789*^9, 3.676587918836789*^9}, {3.676587961818905*^9, 
  3.6765879875447273`*^9}}],

Cell["\<\
And check that this is indeed correct\
\>", "Text",
 CellChangeTimes->{{3.676587941810792*^9, 3.676587949658692*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"eqpALinkedSimp", "-", "eqpALinked"}], "/.", "simplesubs"}], "/.", 
   RowBox[{"r", "\[Rule]", 
    RowBox[{"r1", " ", "\[Epsilon]"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.676587881045948*^9, 3.676587892344213*^9}, 
   3.676587953632453*^9}],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
  SeriesData[$CellContext`\[Epsilon], 0, {}, 2, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.6765878856150703`*^9, 3.676587920230846*^9}, {
  3.676587953950102*^9, 3.6765879891997633`*^9}}]
}, Open  ]],

Cell["\<\
Therefore at equilibrium we have\
\>", "Text",
 CellChangeTimes->{{3.676588129625272*^9, 3.6765881375112543`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"variances", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{
        RowBox[{"eqpALinkedSimp", "\[Equal]", "0"}], ",", 
        RowBox[{"VA", "\[Equal]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"3", "VAX"}], "+", "VAY"}], ")"}], "/", "4"}]}]}], "}"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"VAX", ",", "VAY"}], "}"}]}], "]"}], "//", "Simplify"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.676588047649045*^9, 3.67658812246128*^9}, {
  3.676588254423493*^9, 3.676588256006276*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"VAX", "\[Rule]", 
    FractionBox[
     RowBox[{"4", " ", "VA", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"t", " ", "\[Epsilon]"}], "+", "\[Sigma]AY"}], ")"}]}], 
     RowBox[{
      RowBox[{"2", " ", "t", " ", "\[Epsilon]"}], "-", 
      RowBox[{"3", " ", "\[Sigma]AX"}], "+", 
      RowBox[{"3", " ", "\[Sigma]AY"}]}]]}], ",", 
   RowBox[{"VAY", "\[Rule]", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"4", " ", "VA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"t", " ", "\[Epsilon]"}], "+", 
         RowBox[{"3", " ", "\[Sigma]AX"}]}], ")"}]}], 
      RowBox[{
       RowBox[{"2", " ", "t", " ", "\[Epsilon]"}], "-", 
       RowBox[{"3", " ", "\[Sigma]AX"}], "+", 
       RowBox[{"3", " ", "\[Sigma]AY"}]}]]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.6765880773201103`*^9, 3.6765881227738943`*^9}, 
   3.676588256659614*^9}]
}, Open  ]],

Cell["\<\
where VA is the average variance in the frequency of allele 1 across all \
chromosomes.\
\>", "Text",
 CellChangeTimes->{{3.6765881434110622`*^9, 3.676588182021234*^9}}],

Cell["\<\
Finally, we can write the growth rate of the neo-y like\t\
\>", "Text",
 CellChangeTimes->{{3.6765882936776333`*^9, 3.676588314084442*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RAsimp", "=", 
   RowBox[{"1", "-", 
    RowBox[{"\[Sigma]AY", " ", 
     FractionBox[
      RowBox[{"3", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "VAX"}], " ", "\[Sigma]AX"}], "+", 
         RowBox[{"VAY", " ", "\[Sigma]AY"}]}], ")"}]}], 
      RowBox[{"4", " ", "r"}]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676588205154167*^9, 3.676588290105474*^9}, {
   3.676589249829822*^9, 3.676589268508422*^9}, 3.676589627623953*^9}],

Cell["\<\
This reduces to van Doorn and Kirkpatrick\[CloseCurlyQuote]s result in the \
absence of haploid selection\
\>", "Text",
 CellChangeTimes->{{3.67658966015904*^9, 3.676589682287039*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"RAsimp", "/.", "variances"}], "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.676589628952403*^9, 3.676589656645438*^9}}],

Cell[BoxData[
 RowBox[{"1", "-", 
  FractionBox[
   RowBox[{"4", " ", "VA", " ", "\[Sigma]AX", " ", 
    SuperscriptBox["\[Sigma]AY", "2"]}], 
   RowBox[{
    RowBox[{"r", " ", "\[Sigma]AX"}], "-", 
    RowBox[{"r", " ", "\[Sigma]AY"}]}]]}]], "Output",
 CellChangeTimes->{{3.6765896402718887`*^9, 3.676589656971941*^9}, {
  3.676590225290619*^9, 3.676590228486988*^9}}]
}, Open  ]],

Cell["\<\
And we check that this new expression is actually true\
\>", "Text",
 CellChangeTimes->{{3.676589143093421*^9, 3.676589153859576*^9}, {
  3.676589688182111*^9, 3.67658969041448*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"approxRALinked", "-", "RAsimp"}], "/.", "simplesubs"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6765902089817057`*^9, 3.676590233225494*^9}}],

Cell[BoxData[
 InterpretationBox[
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"hAm", "+", "pAX", "-", 
      RowBox[{"2", " ", "hAm", " ", "pAX"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{"pAX", "-", "pAY"}], ")"}], " ", "sAm", " ", "\[Epsilon]"}], "+", 
   InterpretationBox[
    SuperscriptBox[
     RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
    SeriesData[$CellContext`\[Epsilon], 0, {}, 1, 2, 1],
    Editable->False]}],
  SeriesData[$CellContext`\[Epsilon], 
   0, {($CellContext`hAm + $CellContext`pAX - 
     2 $CellContext`hAm $CellContext`pAX) ($CellContext`pAX - \
$CellContext`pAY) $CellContext`sAm}, 1, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.676590221874711*^9, 3.676590233542173*^9}}]
}, Open  ]],

Cell["\<\
It doesn\[CloseCurlyQuote]t seem to be (why?!). But we could instead write \
the neo-y growth rate like\
\>", "Text",
 CellChangeTimes->{{3.676590237085455*^9, 3.6765902815056334`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"RAsimp2", "=", 
   RowBox[{"1", "-", 
    RowBox[{"\[Sigma]AY", 
     RowBox[{"(", 
      RowBox[{"pAY", "-", "pAX"}], ")"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6765900695843554`*^9, 3.676590135075926*^9}, {
   3.676590213673218*^9, 3.676590218285602*^9}, 3.676590353455987*^9}],

Cell["And this seems to be correct", "Text",
 CellChangeTimes->{{3.676590255952269*^9, 3.676590268695765*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"approxRALinked", "-", "RAsimp2"}], "/.", "simplesubs"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6765901210588207`*^9, 3.676590122055189*^9}, 
   3.676590214695148*^9, 3.676590355090534*^9}],

Cell[BoxData[
 InterpretationBox[
  SuperscriptBox[
   RowBox[{"O", "[", "\[Epsilon]", "]"}], "2"],
  SeriesData[$CellContext`\[Epsilon], 0, {}, 2, 2, 1],
  Editable->False]], "Output",
 CellChangeTimes->{{3.676590118186528*^9, 3.6765901364546833`*^9}, 
   3.676590219839938*^9, {3.6765903475798798`*^9, 3.676590355378357*^9}}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 719},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 371, 6, 183, "Title"],
Cell[953, 30, 118, 1, 62, "Subtitle"],
Cell[1074, 33, 405, 7, 61, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1516, 45, 151, 2, 114, "Title"],
Cell[CellGroupData[{
Cell[1692, 51, 251, 3, 100, "Section"],
Cell[1946, 56, 1031, 16, 132, "Text"],
Cell[2980, 74, 1810, 47, 162, "Input"],
Cell[4793, 123, 460, 8, 37, "Text"],
Cell[CellGroupData[{
Cell[5278, 135, 454, 12, 57, "Input"],
Cell[5735, 149, 388, 5, 35, "Output"],
Cell[6126, 156, 388, 5, 35, "Output"]
}, Open  ]],
Cell[6529, 164, 299, 5, 37, "Text"],
Cell[6831, 171, 1884, 39, 162, "Input"],
Cell[8718, 212, 123, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[8866, 219, 356, 9, 35, "Input"],
Cell[9225, 230, 196, 3, 35, "Output"]
}, Open  ]],
Cell[9436, 236, 393, 7, 37, "Text"],
Cell[CellGroupData[{
Cell[9854, 247, 605, 18, 57, "Input"],
Cell[10462, 267, 245, 3, 35, "Output"]
}, Open  ]],
Cell[10722, 273, 327, 6, 37, "Text"],
Cell[11052, 281, 1608, 45, 204, "Input"],
Cell[12663, 328, 233, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[12921, 337, 435, 11, 57, "Input"],
Cell[13359, 350, 384, 6, 35, "Output"],
Cell[13746, 358, 384, 6, 35, "Output"]
}, Open  ]],
Cell[14145, 367, 234, 5, 37, "Text"],
Cell[14382, 374, 1627, 45, 141, "Input"],
Cell[16012, 421, 207, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[16244, 429, 522, 14, 78, "Input"],
Cell[16769, 445, 459, 7, 35, "Output"],
Cell[17231, 454, 461, 7, 35, "Output"],
Cell[17695, 463, 461, 7, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[18205, 476, 135, 2, 100, "Section"],
Cell[18343, 480, 390, 6, 88, "Text"],
Cell[18736, 488, 724, 14, 291, "Input"],
Cell[19463, 504, 261, 5, 88, "Text"],
Cell[19727, 511, 1167, 27, 547, "Input"],
Cell[20897, 540, 229, 3, 88, "Text"],
Cell[21129, 545, 661, 16, 291, "Input"],
Cell[21793, 563, 375, 7, 88, "Text"],
Cell[CellGroupData[{
Cell[22193, 574, 1017, 24, 82, "Input"],
Cell[23213, 600, 726, 19, 70, "Output"]
}, Open  ]],
Cell[23954, 622, 159, 2, 88, "Text"],
Cell[CellGroupData[{
Cell[24138, 628, 302, 8, 82, "Input"],
Cell[24443, 638, 454, 10, 70, "Output"]
}, Open  ]],
Cell[24912, 651, 329, 6, 88, "Text"],
Cell[25244, 659, 467, 8, 88, "Text"],
Cell[CellGroupData[{
Cell[25736, 671, 1325, 32, 188, "Input"],
Cell[27064, 705, 2658, 65, 70, "Output"]
}, Open  ]],
Cell[29737, 773, 332, 6, 88, "Text"],
Cell[30072, 781, 211, 4, 88, "Text"],
Cell[CellGroupData[{
Cell[30308, 789, 605, 15, 82, "Input"],
Cell[30916, 806, 877, 20, 70, "Output"]
}, Open  ]],
Cell[31808, 829, 200, 4, 88, "Text"],
Cell[CellGroupData[{
Cell[32033, 837, 799, 19, 82, "Input"],
Cell[32835, 858, 1767, 41, 70, "Output"]
}, Open  ]],
Cell[34617, 902, 202, 4, 88, "Text"],
Cell[CellGroupData[{
Cell[34844, 910, 547, 14, 82, "Input"],
Cell[35394, 926, 1000, 25, 70, "Output"]
}, Open  ]],
Cell[36409, 954, 216, 4, 88, "Text"],
Cell[CellGroupData[{
Cell[36650, 962, 638, 15, 87, "Input"],
Cell[37291, 979, 1278, 35, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[38606, 1019, 736, 16, 87, "Input"],
Cell[39345, 1037, 1535, 40, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[40917, 1082, 586, 14, 87, "Input"],
Cell[41506, 1098, 1352, 36, 70, "Output"]
}, Open  ]],
Cell[42873, 1137, 128, 1, 88, "Text"],
Cell[CellGroupData[{
Cell[43026, 1142, 1567, 39, 291, "Input"],
Cell[44596, 1183, 1092, 27, 70, "Output"]
}, Open  ]],
Cell[45703, 1213, 110, 1, 88, "Text"],
Cell[CellGroupData[{
Cell[45838, 1218, 384, 10, 87, "Input"],
Cell[46225, 1230, 893, 22, 70, "Output"]
}, Open  ]],
Cell[47133, 1255, 369, 7, 147, "Text"],
Cell[47505, 1264, 288, 5, 88, "Text"],
Cell[CellGroupData[{
Cell[47818, 1273, 821, 24, 137, "Input"],
Cell[48642, 1299, 269, 4, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[48948, 1308, 819, 24, 137, "Input"],
Cell[49770, 1334, 234, 3, 70, "Output"]
}, Open  ]],
Cell[50019, 1340, 356, 6, 88, "Text"],
Cell[CellGroupData[{
Cell[50400, 1350, 729, 21, 137, "Input"],
Cell[51132, 1373, 4878, 130, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[56047, 1508, 787, 24, 82, "Input"],
Cell[56837, 1534, 2371, 46, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[59245, 1585, 100, 1, 128, "Subsection"],
Cell[59348, 1588, 146, 3, 88, "Text"],
Cell[59497, 1593, 442, 11, 82, "Input"],
Cell[59942, 1606, 199, 4, 88, "Text"],
Cell[60144, 1612, 628, 15, 291, "Input"],
Cell[60775, 1629, 179, 4, 88, "Text"],
Cell[60957, 1635, 384, 11, 82, "Input"],
Cell[61344, 1648, 271, 6, 88, "Text"],
Cell[CellGroupData[{
Cell[61640, 1658, 405, 11, 82, "Input"],
Cell[62048, 1671, 1966, 57, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[64075, 1735, 246, 5, 62, "Section"],
Cell[64324, 1742, 514, 9, 147, "Text"],
Cell[64841, 1753, 175, 4, 88, "Text"],
Cell[65019, 1759, 318, 10, 82, "Input"],
Cell[65340, 1771, 97, 1, 88, "Text"],
Cell[65440, 1774, 2047, 54, 445, "Input"],
Cell[67490, 1830, 123, 3, 88, "Text"],
Cell[67616, 1835, 298, 8, 87, "Input"],
Cell[CellGroupData[{
Cell[67939, 1847, 104, 1, 128, "Subsection"],
Cell[68046, 1850, 196, 4, 88, "Text"],
Cell[68245, 1856, 461, 11, 87, "Input"],
Cell[68709, 1869, 177, 4, 88, "Text"],
Cell[CellGroupData[{
Cell[68911, 1877, 508, 14, 137, "Input"],
Cell[69422, 1893, 1323, 39, 70, "Output"]
}, Open  ]],
Cell[70760, 1935, 276, 6, 88, "Text"],
Cell[71039, 1943, 222, 5, 88, "Text"],
Cell[CellGroupData[{
Cell[71286, 1952, 946, 24, 137, "Input"],
Cell[72235, 1978, 550, 13, 70, "Output"]
}, Open  ]],
Cell[72800, 1994, 351, 7, 88, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[73188, 2006, 103, 1, 128, "Subsection"],
Cell[73294, 2009, 143, 3, 88, "Text"],
Cell[73440, 2014, 513, 12, 87, "Input"],
Cell[73956, 2028, 128, 3, 88, "Text"],
Cell[CellGroupData[{
Cell[74109, 2035, 556, 14, 137, "Input"],
Cell[74668, 2051, 1401, 40, 70, "Output"]
}, Open  ]],
Cell[76084, 2094, 139, 3, 88, "Text"],
Cell[76226, 2099, 135, 3, 88, "Text"],
Cell[CellGroupData[{
Cell[76386, 2106, 991, 25, 137, "Input"],
Cell[77380, 2133, 459, 12, 70, "Output"]
}, Open  ]],
Cell[77854, 2148, 145, 3, 88, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[78036, 2156, 113, 1, 128, "Subsection"],
Cell[78152, 2159, 389, 7, 88, "Text"],
Cell[CellGroupData[{
Cell[78566, 2170, 453, 13, 82, "Input"],
Cell[79022, 2185, 4435, 132, 70, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[83518, 2324, 361, 5, 62, "Section"],
Cell[83882, 2331, 918, 14, 265, "Text"],
Cell[84803, 2347, 1895, 56, 702, "Input"],
Cell[86701, 2405, 454, 8, 88, "Text"],
Cell[CellGroupData[{
Cell[87180, 2417, 826, 20, 188, "Input"],
Cell[88009, 2439, 488, 7, 70, "Output"],
Cell[88500, 2448, 486, 7, 70, "Output"],
Cell[88989, 2457, 486, 7, 70, "Output"]
}, Open  ]],
Cell[89490, 2467, 268, 6, 88, "Text"],
Cell[89761, 2475, 1580, 28, 188, "Input"],
Cell[91344, 2505, 103, 1, 88, "Text"],
Cell[91450, 2508, 1138, 33, 393, "Input"],
Cell[92591, 2543, 121, 1, 88, "Text"],
Cell[92715, 2546, 1873, 56, 1008, "Input"],
Cell[94591, 2604, 266, 5, 88, "Text"],
Cell[94860, 2611, 6402, 176, 2137, "Input"],
Cell[101265, 2789, 233, 5, 88, "Text"],
Cell[CellGroupData[{
Cell[101523, 2798, 1064, 21, 393, "Input"],
Cell[102590, 2821, 483, 7, 70, "Output"],
Cell[103076, 2830, 483, 7, 70, "Output"]
}, Open  ]],
Cell[103574, 2840, 425, 7, 206, "Text"],
Cell[104002, 2849, 234, 5, 88, "Text"],
Cell[104239, 2856, 251, 3, 88, "Text"],
Cell[104493, 2861, 333, 9, 137, "Input"],
Cell[CellGroupData[{
Cell[104851, 2874, 117, 3, 82, "Input"],
Cell[104971, 2879, 216, 3, 70, "Output"]
}, Open  ]],
Cell[105202, 2885, 223, 5, 88, "Text"],
Cell[105428, 2892, 1029, 16, 206, "Text"],
Cell[106460, 2910, 14272, 410, 1522, "Input"],
Cell[CellGroupData[{
Cell[120757, 3324, 274, 6, 87, "Input"],
Cell[121034, 3332, 94, 1, 70, "Output"]
}, Open  ]],
Cell[121143, 3336, 631, 12, 496, "Text"],
Cell[121777, 3350, 445, 13, 82, "Input"],
Cell[122225, 3365, 9837, 309, 1522, "Input"],
Cell[CellGroupData[{
Cell[132087, 3678, 309, 7, 87, "Input"],
Cell[132399, 3687, 4306, 73, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[136754, 3766, 354, 7, 62, "Section"],
Cell[137111, 3775, 121, 1, 88, "Text"],
Cell[137235, 3778, 1426, 33, 752, "Input"],
Cell[138664, 3813, 420, 7, 88, "Text"],
Cell[139087, 3822, 785, 15, 291, "Input"],
Cell[139875, 3839, 261, 5, 88, "Text"],
Cell[140139, 3846, 1167, 27, 547, "Input"],
Cell[141309, 3875, 229, 3, 88, "Text"],
Cell[141541, 3880, 710, 17, 291, "Input"],
Cell[142254, 3899, 344, 6, 88, "Text"],
Cell[CellGroupData[{
Cell[142623, 3909, 1006, 20, 82, "Input"],
Cell[143632, 3931, 856, 24, 70, "Output"]
}, Open  ]],
Cell[144503, 3958, 159, 2, 88, "Text"],
Cell[CellGroupData[{
Cell[144687, 3964, 402, 9, 82, "Input"],
Cell[145092, 3975, 550, 11, 70, "Output"]
}, Open  ]],
Cell[145657, 3989, 329, 6, 88, "Text"],
Cell[145989, 3997, 467, 8, 88, "Text"],
Cell[CellGroupData[{
Cell[146481, 4009, 1181, 25, 137, "Input"],
Cell[147665, 4036, 2888, 72, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[150590, 4113, 258, 6, 82, "Input"],
Cell[150851, 4121, 111, 2, 70, "Output"]
}, Open  ]],
Cell[150977, 4126, 332, 6, 88, "Text"],
Cell[151312, 4134, 211, 4, 88, "Text"],
Cell[CellGroupData[{
Cell[151548, 4142, 703, 16, 82, "Input"],
Cell[152254, 4160, 930, 20, 70, "Output"]
}, Open  ]],
Cell[153199, 4183, 200, 4, 88, "Text"],
Cell[CellGroupData[{
Cell[153424, 4191, 573, 16, 82, "Input"],
Cell[154000, 4209, 1581, 38, 70, "Output"]
}, Open  ]],
Cell[155596, 4250, 202, 4, 88, "Text"],
Cell[CellGroupData[{
Cell[155823, 4258, 477, 13, 82, "Input"],
Cell[156303, 4273, 865, 23, 70, "Output"]
}, Open  ]],
Cell[157183, 4299, 168, 3, 88, "Text"],
Cell[CellGroupData[{
Cell[157376, 4306, 880, 18, 87, "Input"],
Cell[158259, 4326, 1381, 37, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[159677, 4368, 517, 13, 87, "Input"],
Cell[160197, 4383, 1339, 37, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[161573, 4425, 764, 17, 87, "Input"],
Cell[162340, 4444, 1454, 38, 70, "Output"]
}, Open  ]],
Cell[163809, 4485, 114, 1, 88, "Text"],
Cell[CellGroupData[{
Cell[163948, 4490, 1529, 38, 238, "Input"],
Cell[165480, 4530, 756, 22, 70, "Output"]
}, Open  ]],
Cell[166251, 4555, 110, 1, 88, "Text"],
Cell[CellGroupData[{
Cell[166386, 4560, 212, 6, 82, "Input"],
Cell[166601, 4568, 600, 17, 70, "Output"]
}, Open  ]],
Cell[167216, 4588, 321, 6, 147, "Text"]
}, Closed]],
Cell[167552, 4597, 249, 5, 107, "Section"],
Cell[CellGroupData[{
Cell[167826, 4606, 131, 1, 62, "Section"],
Cell[CellGroupData[{
Cell[167982, 4611, 100, 1, 82, "Input"],
Cell[168085, 4614, 1022, 29, 70, "Output"]
}, Open  ]],
Cell[169122, 4646, 415, 7, 147, "Text"],
Cell[CellGroupData[{
Cell[169562, 4657, 1951, 52, 445, "Input"],
Cell[171516, 4711, 12907, 300, 70, "Output"]
}, Open  ]],
Cell[184438, 5014, 296, 8, 87, "Input"],
Cell[CellGroupData[{
Cell[184759, 5026, 505, 15, 137, "Input"],
Cell[185267, 5043, 723, 21, 70, "Output"]
}, Open  ]],
Cell[186005, 5067, 295, 5, 147, "Text"],
Cell[186303, 5074, 528, 10, 265, "Text"],
Cell[CellGroupData[{
Cell[186856, 5088, 761, 21, 137, "Input"],
Cell[187620, 5111, 583, 16, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[188240, 5132, 1006, 27, 137, "Input"],
Cell[189249, 5161, 323, 9, 70, "Output"]
}, Open  ]],
Cell[189587, 5173, 193, 4, 88, "Text"],
Cell[CellGroupData[{
Cell[189805, 5181, 973, 27, 137, "Input"],
Cell[190781, 5210, 214, 5, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[191032, 5220, 1006, 28, 137, "Input"],
Cell[192041, 5250, 3379, 80, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[195457, 5335, 106, 1, 82, "Input"],
Cell[195566, 5338, 438, 12, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[196041, 5355, 1191, 32, 188, "Input"],
Cell[197235, 5389, 6514, 143, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[203786, 5537, 618, 16, 141, "Input"],
Cell[204407, 5555, 1509, 42, 70, "Output"]
}, Open  ]],
Cell[205931, 5600, 301, 5, 147, "Text"],
Cell[CellGroupData[{
Cell[206257, 5609, 1795, 52, 285, "Input"],
Cell[208055, 5663, 1219, 36, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[209311, 5704, 608, 18, 141, "Input"],
Cell[209922, 5724, 1248, 38, 70, "Output"]
}, Open  ]],
Cell[211185, 5765, 232, 5, 88, "Text"],
Cell[211420, 5772, 133, 1, 88, "Text"],
Cell[CellGroupData[{
Cell[211578, 5777, 169, 4, 82, "Input"],
Cell[211750, 5783, 1070, 36, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[212857, 5824, 333, 11, 87, "Input"],
Cell[213193, 5837, 889, 30, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[214119, 5872, 145, 3, 82, "Input"],
Cell[214267, 5877, 840, 28, 70, "Output"]
}, Open  ]],
Cell[215122, 5908, 134, 1, 88, "Text"],
Cell[CellGroupData[{
Cell[215281, 5913, 1306, 41, 250, "Input"],
Cell[216590, 5956, 708, 23, 70, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[217335, 5984, 1518, 51, 158, "Input"],
Cell[218856, 6037, 244, 7, 70, "Output"]
}, Open  ]],
Cell[219115, 6047, 310, 5, 88, "Text"],
Cell[219428, 6054, 379, 8, 265, "Text"],
Cell[219810, 6064, 944, 16, 438, "Text"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[220803, 6086, 155, 2, 80, "Title"],
Cell[CellGroupData[{
Cell[220983, 6092, 441, 6, 100, "Section"],
Cell[221427, 6100, 689, 11, 61, "Text"],
Cell[222119, 6113, 2321, 60, 246, "Input"],
Cell[224443, 6175, 549, 9, 37, "Text"],
Cell[CellGroupData[{
Cell[225017, 6188, 838, 24, 99, "Input"],
Cell[225858, 6214, 217, 3, 35, "Output"],
Cell[226078, 6219, 217, 3, 35, "Output"],
Cell[226298, 6224, 217, 3, 35, "Output"],
Cell[226518, 6229, 219, 3, 35, "Output"]
}, Open  ]],
Cell[226752, 6235, 330, 6, 37, "Text"],
Cell[227085, 6243, 2496, 55, 288, "Input"],
Cell[229584, 6300, 219, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[229828, 6308, 975, 27, 78, "Input"],
Cell[230806, 6337, 216, 4, 35, "Output"],
Cell[231025, 6343, 216, 4, 35, "Output"],
Cell[231244, 6349, 216, 4, 35, "Output"]
}, Open  ]],
Cell[231475, 6356, 289, 5, 37, "Text"],
Cell[231767, 6363, 3195, 83, 372, "Input"],
Cell[234965, 6448, 256, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[235246, 6457, 279, 8, 57, "Input"],
Cell[235528, 6467, 193, 3, 35, "Output"],
Cell[235724, 6472, 192, 3, 35, "Output"]
}, Open  ]],
Cell[235931, 6478, 206, 3, 37, "Text"],
Cell[236140, 6483, 318, 4, 37, "Text"],
Cell[236461, 6489, 457, 11, 57, "Input"],
Cell[236921, 6502, 143, 2, 37, "Text"],
Cell[CellGroupData[{
Cell[237089, 6508, 183, 4, 35, "Input"],
Cell[237275, 6514, 191, 3, 35, "Output"]
}, Open  ]],
Cell[237481, 6520, 1145, 18, 61, "Text"],
Cell[238629, 6540, 2843, 56, 120, "Input"],
Cell[241475, 6598, 233, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[241733, 6606, 238, 7, 57, "Input"],
Cell[241974, 6615, 195, 3, 35, "Output"],
Cell[242172, 6620, 195, 3, 35, "Output"]
}, Open  ]],
Cell[242382, 6626, 330, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[242737, 6636, 633, 19, 62, "Input"],
Cell[243373, 6657, 945, 19, 56, "Output"]
}, Open  ]],
Cell[244333, 6679, 197, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[244555, 6687, 418, 13, 62, "Input"],
Cell[244976, 6702, 1172, 31, 58, "Output"]
}, Open  ]],
Cell[246163, 6736, 252, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[246440, 6745, 1175, 35, 57, "Input"],
Cell[247618, 6782, 638, 16, 58, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[248305, 6804, 148, 2, 100, "Section"],
Cell[248456, 6808, 481, 8, 37, "Text"],
Cell[248940, 6818, 890, 16, 141, "Input"],
Cell[249833, 6836, 261, 5, 37, "Text"],
Cell[250097, 6843, 1167, 27, 225, "Input"],
Cell[251267, 6872, 229, 3, 37, "Text"],
Cell[251499, 6877, 847, 20, 141, "Input"],
Cell[252349, 6899, 375, 7, 37, "Text"],
Cell[CellGroupData[{
Cell[252749, 6910, 1017, 24, 35, "Input"],
Cell[253769, 6936, 950, 24, 55, "Output"]
}, Open  ]],
Cell[254734, 6963, 159, 2, 37, "Text"],
Cell[CellGroupData[{
Cell[254918, 6969, 360, 8, 35, "Input"],
Cell[255281, 6979, 644, 13, 35, "Output"]
}, Open  ]],
Cell[255940, 6995, 329, 6, 37, "Text"],
Cell[256272, 7003, 467, 8, 37, "Text"],
Cell[CellGroupData[{
Cell[256764, 7015, 1463, 34, 78, "Input"],
Cell[258230, 7051, 3980, 115, 148, "Output"]
}, Open  ]],
Cell[262225, 7169, 332, 6, 37, "Text"],
Cell[262560, 7177, 211, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[262796, 7185, 605, 15, 35, "Input"],
Cell[263404, 7202, 871, 20, 36, "Output"]
}, Open  ]],
Cell[264290, 7225, 200, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[264515, 7233, 799, 19, 35, "Input"],
Cell[265317, 7254, 1915, 43, 92, "Output"]
}, Open  ]],
Cell[267247, 7300, 202, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[267474, 7308, 547, 14, 35, "Input"],
Cell[268024, 7324, 1139, 27, 58, "Output"]
}, Open  ]],
Cell[269178, 7354, 350, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[269553, 7364, 528, 14, 36, "Input"],
Cell[270084, 7380, 987, 24, 58, "Output"]
}, Open  ]],
Cell[271086, 7407, 216, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[271327, 7415, 691, 16, 36, "Input"],
Cell[272021, 7433, 1477, 39, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[273535, 7477, 790, 17, 36, "Input"],
Cell[274328, 7496, 1702, 42, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[276067, 7543, 636, 15, 36, "Input"],
Cell[276706, 7560, 1528, 39, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[278271, 7604, 636, 17, 36, "Input"],
Cell[278910, 7623, 1425, 42, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[280372, 7670, 320, 8, 36, "Input"],
Cell[280695, 7680, 1115, 33, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[281847, 7718, 628, 18, 36, "Input"],
Cell[282478, 7738, 2413, 66, 63, "Output"]
}, Open  ]],
Cell[284906, 7807, 128, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[285059, 7812, 1567, 39, 120, "Input"],
Cell[286629, 7853, 1302, 30, 55, "Output"]
}, Open  ]],
Cell[287946, 7886, 110, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[288081, 7891, 384, 10, 36, "Input"],
Cell[288468, 7903, 1062, 25, 56, "Output"]
}, Open  ]],
Cell[289545, 7931, 369, 7, 61, "Text"],
Cell[289917, 7940, 288, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[290230, 7949, 821, 24, 57, "Input"],
Cell[291054, 7975, 364, 5, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[291455, 7985, 819, 24, 57, "Input"],
Cell[292277, 8011, 333, 5, 35, "Output"]
}, Open  ]],
Cell[292625, 8019, 356, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[293006, 8029, 729, 21, 57, "Input"],
Cell[293738, 8052, 4974, 131, 282, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[298749, 8188, 787, 24, 35, "Input"],
Cell[299539, 8214, 2466, 48, 301, "Output"]
}, Open  ]],
Cell[302020, 8265, 157, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[302202, 8272, 863, 28, 36, "Input"],
Cell[303068, 8302, 311, 6, 54, "Output"]
}, Open  ]],
Cell[303394, 8311, 99, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[303518, 8316, 967, 30, 36, "Input"],
Cell[304488, 8348, 168, 2, 35, "Output"]
}, Open  ]],
Cell[304671, 8353, 141, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[304837, 8358, 935, 29, 36, "Input"],
Cell[305775, 8389, 167, 2, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[305979, 8396, 100, 1, 54, "Subsection"],
Cell[306082, 8399, 138, 1, 37, "Text"],
Cell[306223, 8402, 442, 11, 35, "Input"],
Cell[306668, 8415, 272, 5, 37, "Text"],
Cell[306943, 8422, 702, 16, 120, "Input"],
Cell[307648, 8440, 179, 4, 37, "Text"],
Cell[307830, 8446, 454, 12, 35, "Input"],
Cell[308287, 8460, 271, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[308583, 8470, 451, 11, 35, "Input"],
Cell[309037, 8483, 1967, 57, 94, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[311065, 8547, 97, 1, 100, "Section"],
Cell[311165, 8550, 16, 0, 37, "Text"],
Cell[311184, 8552, 1154, 27, 249, "Input"],
Cell[CellGroupData[{
Cell[312363, 8583, 701, 20, 36, "Input"],
Cell[313067, 8605, 1097, 32, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[314201, 8642, 1188, 32, 57, "Input"],
Cell[315392, 8676, 1575, 43, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[317004, 8724, 925, 26, 57, "Input"],
Cell[317932, 8752, 1916, 51, 57, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[319885, 8808, 488, 14, 36, "Input"],
Cell[320376, 8824, 1969, 59, 99, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[322382, 8888, 876, 25, 57, "Input"],
Cell[323261, 8915, 1639, 41, 57, "Output"]
}, Open  ]],
Cell[324915, 8959, 120, 2, 35, "Input"],
Cell[CellGroupData[{
Cell[325060, 8965, 378, 11, 36, "Input"],
Cell[325441, 8978, 729, 21, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[326207, 9004, 220, 5, 36, "Input"],
Cell[326430, 9011, 1389, 43, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[327856, 9059, 304, 7, 36, "Input"],
Cell[328163, 9068, 2327, 62, 82, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[330527, 9135, 340, 8, 36, "Input"],
Cell[330870, 9145, 2041, 58, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[332948, 9208, 1354, 44, 57, "Input"],
Cell[334305, 9254, 1012, 30, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[335354, 9289, 411, 12, 36, "Input"],
Cell[335768, 9303, 354, 10, 42, "Output"]
}, Open  ]]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[336183, 9320, 228, 4, 149, "Title"],
Cell[CellGroupData[{
Cell[336436, 9328, 502, 7, 100, "Section"],
Cell[336941, 9337, 1436, 21, 156, "Text"],
Cell[338380, 9360, 2321, 60, 246, "Input"],
Cell[340704, 9422, 316, 6, 61, "Text"],
Cell[341023, 9430, 604, 10, 37, "Text"],
Cell[CellGroupData[{
Cell[341652, 9444, 838, 24, 99, "Input"],
Cell[342493, 9470, 217, 3, 35, "Output"],
Cell[342713, 9475, 217, 3, 35, "Output"],
Cell[342933, 9480, 217, 3, 35, "Output"],
Cell[343153, 9485, 219, 3, 35, "Output"]
}, Open  ]],
Cell[343387, 9491, 330, 6, 37, "Text"],
Cell[343720, 9499, 2496, 55, 288, "Input"],
Cell[346219, 9556, 271, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[346515, 9565, 975, 27, 78, "Input"],
Cell[347493, 9594, 216, 4, 35, "Output"],
Cell[347712, 9600, 216, 4, 35, "Output"],
Cell[347931, 9606, 216, 4, 35, "Output"]
}, Open  ]],
Cell[348162, 9613, 289, 5, 37, "Text"],
Cell[348454, 9620, 3195, 83, 372, "Input"],
Cell[351652, 9705, 256, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[351933, 9714, 279, 8, 57, "Input"],
Cell[352215, 9724, 193, 3, 35, "Output"],
Cell[352411, 9729, 192, 3, 35, "Output"]
}, Open  ]],
Cell[352618, 9735, 206, 3, 37, "Text"],
Cell[352827, 9740, 318, 4, 37, "Text"],
Cell[353148, 9746, 457, 11, 57, "Input"],
Cell[353608, 9759, 143, 2, 37, "Text"],
Cell[CellGroupData[{
Cell[353776, 9765, 183, 4, 35, "Input"],
Cell[353962, 9771, 191, 3, 35, "Output"]
}, Open  ]],
Cell[354168, 9777, 1141, 15, 37, "Text"],
Cell[355312, 9794, 2843, 56, 120, "Input"],
Cell[358158, 9852, 177, 4, 37, "Text"],
Cell[358338, 9858, 284, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[358647, 9867, 238, 7, 57, "Input"],
Cell[358888, 9876, 195, 3, 35, "Output"],
Cell[359086, 9881, 195, 3, 35, "Output"]
}, Open  ]],
Cell[359296, 9887, 387, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[359708, 9897, 633, 19, 62, "Input"],
Cell[360344, 9918, 945, 19, 56, "Output"]
}, Open  ]],
Cell[361304, 9940, 174, 4, 37, "Text"],
Cell[361481, 9946, 253, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[361759, 9955, 418, 13, 62, "Input"],
Cell[362180, 9970, 1172, 31, 58, "Output"]
}, Open  ]],
Cell[363367, 10004, 328, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[363720, 10014, 1175, 35, 57, "Input"],
Cell[364898, 10051, 638, 16, 58, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[365585, 10073, 261, 3, 100, "Section"],
Cell[365849, 10078, 323, 6, 37, "Text"],
Cell[366175, 10086, 1167, 27, 225, "Input"],
Cell[367345, 10115, 586, 10, 37, "Text"],
Cell[367934, 10127, 890, 16, 141, "Input"],
Cell[368827, 10145, 229, 3, 37, "Text"],
Cell[369059, 10150, 847, 20, 141, "Input"],
Cell[369909, 10172, 429, 7, 37, "Text"],
Cell[CellGroupData[{
Cell[370363, 10183, 1017, 24, 35, "Input"],
Cell[371383, 10209, 950, 24, 55, "Output"]
}, Open  ]],
Cell[372348, 10236, 159, 2, 37, "Text"],
Cell[CellGroupData[{
Cell[372532, 10242, 360, 8, 35, "Input"],
Cell[372895, 10252, 644, 13, 35, "Output"]
}, Open  ]],
Cell[373554, 10268, 387, 7, 37, "Text"],
Cell[CellGroupData[{
Cell[373966, 10279, 116, 1, 54, "Subsection"],
Cell[374085, 10282, 376, 7, 61, "Text"],
Cell[374464, 10291, 1203, 28, 249, "Input"],
Cell[375670, 10321, 452, 8, 61, "Text"],
Cell[376125, 10331, 147, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[376297, 10338, 701, 20, 36, "Input"],
Cell[377001, 10360, 1097, 32, 56, "Output"]
}, Open  ]],
Cell[378113, 10395, 108, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[378246, 10400, 1188, 32, 78, "Input"],
Cell[379437, 10434, 1575, 43, 57, "Output"]
}, Open  ]],
Cell[381027, 10480, 111, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[381163, 10485, 925, 26, 57, "Input"],
Cell[382091, 10513, 1916, 51, 57, "Output"]
}, Open  ]],
Cell[384022, 10567, 108, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[384155, 10572, 488, 14, 36, "Input"],
Cell[384646, 10588, 1969, 59, 99, "Output"]
}, Open  ]],
Cell[386630, 10650, 160, 2, 37, "Text"],
Cell[CellGroupData[{
Cell[386815, 10656, 826, 24, 57, "Input"],
Cell[387644, 10682, 1516, 37, 57, "Output"]
}, Open  ]],
Cell[389175, 10722, 100, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[389300, 10727, 287, 9, 36, "Input"],
Cell[389590, 10738, 605, 18, 56, "Output"]
}, Open  ]],
Cell[390210, 10759, 142, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[390377, 10766, 220, 5, 36, "Input"],
Cell[390600, 10773, 1389, 43, 56, "Output"]
}, Open  ]],
Cell[392004, 10819, 150, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[392179, 10826, 164, 5, 36, "Input"],
Cell[392346, 10833, 2157, 58, 81, "Output"]
}, Open  ]],
Cell[394518, 10894, 264, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[394807, 10903, 1251, 32, 78, "Input"],
Cell[396061, 10937, 2573, 56, 81, "Output"]
}, Open  ]],
Cell[398649, 10996, 110, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[398784, 11001, 380, 9, 36, "Input"],
Cell[399167, 11012, 1136, 26, 56, "Output"]
}, Open  ]],
Cell[400318, 11041, 423, 7, 61, "Text"],
Cell[CellGroupData[{
Cell[400766, 11052, 1680, 54, 78, "Input"],
Cell[402449, 11108, 304, 8, 42, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[402802, 11122, 165, 2, 54, "Subsection"],
Cell[402970, 11126, 461, 8, 85, "Text"],
Cell[403434, 11136, 849, 20, 162, "Input"],
Cell[404286, 11158, 360, 6, 61, "Text"],
Cell[404649, 11166, 149, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[404823, 11173, 662, 19, 36, "Input"],
Cell[405488, 11194, 881, 25, 39, "Output"]
}, Open  ]],
Cell[406384, 11222, 184, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[406593, 11230, 1082, 30, 78, "Input"],
Cell[407678, 11262, 2803, 77, 70, "Output"]
}, Open  ]],
Cell[410496, 11342, 154, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[410675, 11349, 949, 28, 78, "Input"],
Cell[411627, 11379, 2623, 72, 70, "Output"]
}, Open  ]],
Cell[414265, 11454, 143, 3, 37, "Text"],
Cell[414411, 11459, 1554, 46, 141, "Input"],
Cell[415968, 11507, 193, 4, 37, "Text"],
Cell[416164, 11513, 708, 20, 35, "Input"],
Cell[416875, 11535, 114, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[417014, 11540, 350, 8, 36, "Input"],
Cell[417367, 11550, 352, 8, 39, "Output"]
}, Open  ]],
Cell[417734, 11561, 128, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[417887, 11568, 289, 8, 35, "Input"],
Cell[418179, 11578, 495, 12, 55, "Output"]
}, Open  ]],
Cell[418689, 11593, 206, 4, 37, "Text"],
Cell[418898, 11599, 457, 12, 35, "Input"],
Cell[419358, 11613, 127, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[419510, 11620, 319, 8, 36, "Input"],
Cell[419832, 11630, 304, 7, 39, "Output"]
}, Open  ]],
Cell[420151, 11640, 124, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[420300, 11647, 629, 19, 36, "Input"],
Cell[420932, 11668, 924, 26, 56, "Output"]
}, Open  ]],
Cell[421871, 11697, 179, 4, 37, "Text"],
Cell[422053, 11703, 149, 3, 37, "Text"],
Cell[422205, 11708, 506, 14, 58, "Input"],
Cell[422714, 11724, 194, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[422933, 11732, 219, 5, 36, "Input"],
Cell[423155, 11739, 369, 9, 59, "Output"]
}, Open  ]],
Cell[423539, 11751, 192, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[423756, 11759, 203, 5, 36, "Input"],
Cell[423962, 11766, 737, 19, 39, "Output"]
}, Open  ]],
Cell[424714, 11788, 195, 4, 37, "Text"],
Cell[424912, 11794, 323, 8, 35, "Input"],
Cell[425238, 11804, 110, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[425373, 11809, 252, 6, 36, "Input"],
Cell[425628, 11817, 327, 7, 39, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
