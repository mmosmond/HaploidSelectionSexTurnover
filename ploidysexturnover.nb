(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[     47279,       1312]
NotebookOptionsPosition[     43618,       1191]
NotebookOutlinePosition[     44005,       1208]
CellTagsIndexPosition[     43962,       1205]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Ploidally antagonistic selection (or sperm/pollen competition) drives sex \
chromosome turnover(?)\
\>", "Title",
 CellChangeTimes->{{3.6756461584547977`*^9, 3.675646190672323*^9}, {
  3.675691343813216*^9, 3.675691344643425*^9}, {3.675718324413807*^9, 
  3.6757183349582043`*^9}}],

Cell["Michael Scott & Matthew Osmond", "Subtitle",
 CellChangeTimes->{{3.6756909919076443`*^9, 3.675690999875959*^9}}],

Cell[CellGroupData[{

Cell["Resident life-cycle", "Section",
 CellChangeTimes->{{3.6756910197792797`*^9, 3.675691024113359*^9}, {
  3.67569412935745*^9, 3.6756941314240303`*^9}, {3.675707349839982*^9, 
  3.675707351884247*^9}, {3.675709974013658*^9, 3.675709982915987*^9}}],

Cell["\<\
We start with haploid selection, which occurs in sperm/pollen only. Let XAm \
be the frequency of allele A at the diallelic autosomal locus in \
gametes/pollen with an X allele at the diallelic sex-determining locus. Let \
YA be the frequency of allele A at the diallelic autosomal locus in \
gametes/pollen with an Y allele at the diallelic sex-determining locus. Let \
XAf be the frequency of allele A at the diallelic autosomal locus in eggs \
(which necessarily have an X allele at the diallelic sex-determining locus). \
After selection on male gametes/pollen we then have frequencies of A (and a) \
in each type of gamete/pollen:\
\>", "Text",
 CellChangeTimes->{{3.675646210075425*^9, 3.6756462139879293`*^9}, {
  3.675692881948024*^9, 3.675692905462323*^9}, {3.675702634397826*^9, 
  3.6757026600570383`*^9}, {3.675710000498989*^9, 3.675710437600037*^9}, {
  3.6757106247367887`*^9, 3.675710626158669*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wbarXm", "=", 
   RowBox[{
    RowBox[{"wA", " ", "XAm"}], "+", 
    RowBox[{"wa", " ", "Xam"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wbarY", "=", 
   RowBox[{
    RowBox[{"wA", " ", "YA"}], "+", 
    RowBox[{"wa", " ", "Ya"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAms", "=", 
   RowBox[{"wA", "*", 
    RowBox[{"XAm", "/", "wbarXm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xams", "=", 
   RowBox[{"wa", "*", 
    RowBox[{"Xam", "/", "wbarXm"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAs", "=", 
   RowBox[{"wA", "*", 
    RowBox[{"YA", "/", "wbarY"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yas", "=", 
   RowBox[{"wa", "*", 
    RowBox[{"Ya", "/", "wbarY"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAfs", "=", "XAf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xafs", "=", "Xaf"}], ";"}]}], "Input",
 CellChangeTimes->{{3.675645810680058*^9, 3.6756459276391087`*^9}, {
   3.6756459611641893`*^9, 3.67564599552956*^9}, {3.6756463012573423`*^9, 
   3.6756463017774*^9}, 3.675646515472443*^9, {3.675646641547511*^9, 
   3.675646657805133*^9}, {3.675647674839451*^9, 3.6756477105194483`*^9}, {
   3.675691050900692*^9, 3.6756912374806137`*^9}, {3.675691327244226*^9, 
   3.675691327340498*^9}, {3.675702032463594*^9, 3.675702091069471*^9}, 
   3.675702137656342*^9}],

Cell["\<\
Check that frequencies A and a in each gamete/pollen type sum to one after \
selection:\
\>", "Text",
 CellChangeTimes->{{3.675691241028049*^9, 3.675691262904736*^9}, {
   3.675691499842326*^9, 3.675691508954028*^9}, {3.6757021446730413`*^9, 
   3.6757021466313477`*^9}, 3.67570266834774*^9, {3.675710454342794*^9, 
   3.675710458811872*^9}, {3.675711308941972*^9, 3.6757113347037287`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAms", "+", "Xams"}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"YAs", "+", "Yas"}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAfs", "+", "Xafs"}]}], "/.", 
  RowBox[{"XAf", "\[Rule]", 
   RowBox[{"1", "-", "Xaf"}]}]}]}], "Input",
 CellChangeTimes->{{3.675691252785161*^9, 3.6756913352798967`*^9}, {
  3.6757021035580378`*^9, 3.675702129987976*^9}, {3.6757026754295063`*^9, 
  3.6757026815771637`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6756912843100643`*^9, 3.675691335597637*^9}, 
   3.6756934682580433`*^9, 3.675693544383304*^9, {3.6757021097462606`*^9, 
   3.675702130382599*^9}, 3.6757026819643106`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6756912843100643`*^9, 3.675691335597637*^9}, 
   3.6756934682580433`*^9, 3.675693544383304*^9, {3.6757021097462606`*^9, 
   3.675702130382599*^9}, 3.675702681968704*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6756912843100643`*^9, 3.675691335597637*^9}, 
   3.6756934682580433`*^9, 3.675693544383304*^9, {3.6757021097462606`*^9, 
   3.675702130382599*^9}, 3.675702681971348*^9}]
}, Open  ]],

Cell["\<\
After random mating, the frequencies of the diploid genotypes in each sex are\
\
\>", "Text",
 CellChangeTimes->{{3.675646094888542*^9, 3.675646099390658*^9}, {
  3.675646217785323*^9, 3.675646250704771*^9}, {3.67570268816877*^9, 
  3.6757027045136023`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAXA", "=", 
   RowBox[{"XAfs", " ", "XAms"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXa", "=", 
   RowBox[{
    RowBox[{"XAfs", " ", "Xams"}], "+", 
    RowBox[{"Xafs", " ", "XAms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaXa", "=", 
   RowBox[{"Xafs", " ", "Xams"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYA", "=", 
   RowBox[{"XAfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYa", "=", 
   RowBox[{"XAfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYA", "=", 
   RowBox[{"Xafs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYa", "=", 
   RowBox[{"Xafs", " ", "Yas"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646256909181*^9, 3.675646272815617*^9}, {
   3.675646370257011*^9, 3.67564637079287*^9}, {3.675646404699778*^9, 
   3.675646517567526*^9}, {3.675646573911735*^9, 3.675646591557143*^9}, {
   3.675646627619878*^9, 3.67564663177063*^9}, {3.675646667841331*^9, 
   3.675646747122738*^9}, {3.675691396390801*^9, 3.675691472391663*^9}, {
   3.675691536695323*^9, 3.675691538414453*^9}, {3.675691639085917*^9, 
   3.675691650195237*^9}, {3.675691682513646*^9, 3.675691696533524*^9}, {
   3.675691755294464*^9, 3.6756917629827957`*^9}, {3.675691824386702*^9, 
   3.675691852603437*^9}, {3.675692700413486*^9, 3.675692712195026*^9}, {
   3.67569296671769*^9, 3.675692967464675*^9}, {3.6756930389284983`*^9, 
   3.675693095368285*^9}, {3.675693137308187*^9, 3.675693184356132*^9}, {
   3.675693221908244*^9, 3.6756932234970217`*^9}, {3.675693268122773*^9, 
   3.675693270392726*^9}, {3.675693410576119*^9, 3.675693460007984*^9}, {
   3.675693492300033*^9, 3.675693533360964*^9}, 3.675693600152028*^9, {
   3.675702177145516*^9, 3.675702196152766*^9}, {3.6757023129704742`*^9, 
   3.675702317051364*^9}}],

Cell["\<\
Check that frequencies of diploid genotypes in each sex sum to one after \
mating:\
\>", "Text",
 CellChangeTimes->{{3.675691479260996*^9, 3.675691518331197*^9}, {
   3.675702245714006*^9, 3.675702247314129*^9}, 3.675702712372058*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{"XAXA", "+", "XAXa", "+", "XaXa"}]}], "/.", 
   RowBox[{"XAf", "\[Rule]", 
    RowBox[{"1", "-", "Xaf"}]}]}], "//", "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{"XAYA", "+", "XAYa", "+", "XaYA", "+", "XaYa"}]}], "/.", 
   RowBox[{"XAf", "\[Rule]", 
    RowBox[{"1", "-", "Xaf"}]}]}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.6756491904523573`*^9, 3.6756492136559467`*^9}, {
  3.6756492918310966`*^9, 3.6756492920380793`*^9}, {3.675691527465028*^9, 
  3.675691527751226*^9}, {3.6756915604361963`*^9, 3.675691618356741*^9}, {
  3.675691669111765*^9, 3.675691669699185*^9}, {3.675693116850299*^9, 
  3.67569311749518*^9}, {3.67569314860688*^9, 3.675693149176091*^9}, {
  3.675702220519374*^9, 3.675702224594302*^9}, {3.675702258255639*^9, 
  3.6757022591372232`*^9}, {3.675702715770293*^9, 3.67570271697053*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.675649213974503*^9, 3.675649292983405*^9, 3.675691529235651*^9, 
   3.675691561517929*^9, {3.6756916009921703`*^9, 3.675691618695776*^9}, {
   3.675691666317216*^9, 3.675691698418659*^9}, 3.6756917662431517`*^9, {
   3.6756927052292023`*^9, 3.675692718514035*^9}, 3.675692969767406*^9, {
   3.675693097991144*^9, 3.675693149453277*^9}, 3.675693186784671*^9, 
   3.675693226587893*^9, 3.675693430104121*^9, 3.675693553864966*^9, 
   3.6756936022533092`*^9, {3.675702209808015*^9, 3.675702224876165*^9}, 
   3.675702259497794*^9, {3.675702713683836*^9, 3.675702717251713*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.675649213974503*^9, 3.675649292983405*^9, 3.675691529235651*^9, 
   3.675691561517929*^9, {3.6756916009921703`*^9, 3.675691618695776*^9}, {
   3.675691666317216*^9, 3.675691698418659*^9}, 3.6756917662431517`*^9, {
   3.6756927052292023`*^9, 3.675692718514035*^9}, 3.675692969767406*^9, {
   3.675693097991144*^9, 3.675693149453277*^9}, 3.675693186784671*^9, 
   3.675693226587893*^9, 3.675693430104121*^9, 3.675693553864966*^9, 
   3.6756936022533092`*^9, {3.675702209808015*^9, 3.675702224876165*^9}, 
   3.675702259497794*^9, {3.675702713683836*^9, 3.675702717255129*^9}}]
}, Open  ]],

Cell["\<\
After diploid selection (which can differ between males and females) the \
frequencies of the diploid genotypes in each sex are\
\>", "Text",
 CellChangeTimes->{{3.6756467552456417`*^9, 3.67564676342205*^9}, {
  3.675702725992881*^9, 3.67570275267984*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wbarF", "=", 
   RowBox[{
    RowBox[{"FAA", " ", "XAXA"}], "+", 
    RowBox[{"FAa", " ", "XAXa"}], "+", 
    RowBox[{"Faa", " ", "XaXa"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wbarM", "=", 
   RowBox[{
    RowBox[{"MAA", " ", "XAYA"}], "+", 
    RowBox[{"MAa", " ", "XAYa"}], "+", 
    RowBox[{"MAa", " ", "XaYA"}], "+", 
    RowBox[{"Maa", " ", "XaYa"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXAs", "=", 
   RowBox[{"FAA", " ", 
    RowBox[{"XAXA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXas", "=", 
   RowBox[{"FAa", " ", 
    RowBox[{"XAXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaXas", "=", 
   RowBox[{"Faa", " ", 
    RowBox[{"XaXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XaYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYas", "=", 
   RowBox[{"Maa", " ", 
    RowBox[{"XaYa", "/", "wbarM"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646788099258*^9, 3.675646827315172*^9}, {
  3.675646906255657*^9, 3.6756471746197577`*^9}, {3.6756477305962267`*^9, 
  3.675647791098443*^9}, {3.675693609968581*^9, 3.6756936401475143`*^9}, {
  3.675702773030509*^9, 3.675702825109133*^9}}],

Cell["\<\
Check that frequencies of diploid genotypes in each sex sum to one after \
diploid selection:\
\>", "Text",
 CellChangeTimes->{{3.67569367511821*^9, 3.6756936990142593`*^9}, {
  3.675702840764554*^9, 3.675702847452877*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAXAs", "+", "XAXas", "+", "XaXas"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAYAs", "+", "XAYas", "+", "XaYAs", "+", "XaYas"}]}], "//", 
  "Factor"}]}], "Input",
 CellChangeTimes->{{3.67569371292774*^9, 3.675693719435033*^9}, {
  3.675702830827154*^9, 3.675702835546769*^9}, {3.67570296812504*^9, 
  3.675702969573578*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.6757029698749104`*^9}]
}, Open  ]],

Cell["\<\
Finally, meiosis occurs, giving the haploid frequencies at the start of the \
next generation\
\>", "Text",
 CellChangeTimes->{{3.675647183205927*^9, 3.675647193439426*^9}, {
  3.675702857268779*^9, 3.6757029057817707`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAfprime", "=", 
   RowBox[{"XAXAs", "+", 
    RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xafprime", "=", 
   RowBox[{"XaXas", "+", 
    RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAmprime", "=", 
   RowBox[{"XAYAs", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}], "XAYas"}], "+", 
    RowBox[{"r", " ", "XaYAs"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xamprime", "=", 
   RowBox[{"XaYas", "+", 
    RowBox[{"r", " ", "XAYas"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}], " ", "XaYAs"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAprime", "=", 
   RowBox[{"XAYAs", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}], "XaYAs"}], "+", " ", 
    RowBox[{"r", " ", "XAYas"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yaprime", "=", 
   RowBox[{"XaYas", "+", 
    RowBox[{"r", " ", "XaYAs"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", " ", "r"}], ")"}], " ", "XAYas"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6756472292114067`*^9, 3.6756473420504217`*^9}, {
  3.6756473952800293`*^9, 3.675647424390531*^9}, {3.675647484585294*^9, 
  3.675647589565673*^9}, {3.675648941522543*^9, 3.675649018308858*^9}, {
  3.675649385250359*^9, 3.675649410886257*^9}, {3.675693872816942*^9, 
  3.675693896989888*^9}, {3.675693964935532*^9, 3.6756940172718267`*^9}, {
  3.675694055414246*^9, 3.6756941117619743`*^9}, {3.675702930758318*^9, 
  3.675702948794842*^9}}],

Cell["\<\
Check that frequencies of haploid genotypes sum to one after meiosis\
\>", "Text",
 CellChangeTimes->{{3.67569367511821*^9, 3.6756936990142593`*^9}, {
  3.67569375263811*^9, 3.675693763639084*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAfprime", "+", "Xafprime"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAmprime", "+", "Xamprime"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"YAprime", "+", "Yaprime"}]}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.67569371292774*^9, 3.675693719435033*^9}, {
  3.675693774249498*^9, 3.675693826562112*^9}, {3.675702917688963*^9, 
  3.675702960491468*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675693788565115*^9, 3.675693826974794*^9, 
   3.675693898532673*^9, {3.675693974855103*^9, 3.675694020508545*^9}, 
   3.675694073054261*^9, 3.6756941134149103`*^9, {3.675702911869741*^9, 
   3.675702960821375*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675693788565115*^9, 3.675693826974794*^9, 
   3.675693898532673*^9, {3.675693974855103*^9, 3.675694020508545*^9}, 
   3.675694073054261*^9, 3.6756941134149103`*^9, {3.675702911869741*^9, 
   3.675702960824497*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675693788565115*^9, 3.675693826974794*^9, 
   3.675693898532673*^9, {3.675693974855103*^9, 3.675694020508545*^9}, 
   3.675694073054261*^9, 3.6756941134149103`*^9, {3.675702911869741*^9, 
   3.675702960827053*^9}}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Resident equilibrium", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9}],

Cell["\<\
We now solve for the equilibrium frequency of A in each of the haploid \
genotypes. Equilibrium is achieved when the following three equations are zero\
\>", "Text",
 CellChangeTimes->{{3.675694155902801*^9, 3.675694193760104*^9}, {
  3.6756944337868023`*^9, 3.6756944351881227`*^9}, {3.6757029847267847`*^9, 
  3.67570303405547*^9}, {3.675710696458521*^9, 3.675710706286772*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"recursions", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAfprime", "-", "XAf"}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAmprime", "-", "XAm"}], ",", "\[IndentingNewLine]", 
     RowBox[{"YAprime", "-", "YA"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675647987041369*^9, 3.67564802904979*^9}, {
   3.675650509895372*^9, 3.675650527299842*^9}, {3.6756941716513157`*^9, 
   3.6756941738671913`*^9}, {3.675694338488646*^9, 3.675694340978696*^9}, {
   3.675694394143187*^9, 3.6756944261522427`*^9}, 3.6756944751724463`*^9, 
   3.675702984727247*^9, {3.675703036868017*^9, 3.675703037688758*^9}}],

Cell["\<\
To simplify the analysis we assume weak selection in both haploids \
(sperm/pollen) and diploids\
\>", "Text",
 CellChangeTimes->{{3.675694205010009*^9, 3.675694211923259*^9}, 
   3.67570298472752*^9, {3.6757030454432507`*^9, 3.6757030568360033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weaksel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAm", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAm", " ", "sAm", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Maa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAf", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAf", " ", "sAf", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Faa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"wA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"t", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"wa", "\[Rule]", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67564806523287*^9, 3.675648221558539*^9}, {
   3.675694367971285*^9, 3.6756943845803022`*^9}, 3.6757029847280283`*^9}],

Cell["\<\
We can write the frequencies as Taylor series\
\>", "Text",
 CellChangeTimes->{{3.675707045047565*^9, 3.6757070543930063`*^9}, {
  3.675707367038864*^9, 3.675707370179316*^9}, {3.675711803871513*^9, 
  3.6757118112225847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frequenciessub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", 
      RowBox[{"XAf0", "+", 
       RowBox[{"XAf1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAm", "\[Rule]", 
      RowBox[{"XAm0", "+", 
       RowBox[{"XAm1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YA", "\[Rule]", 
      RowBox[{"YA0", "+", 
       RowBox[{"YA1", " ", "\[Epsilon]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675648297857716*^9, 3.6756483630660057`*^9}, 
   3.675648454638584*^9, 3.675702984736863*^9}],

Cell["\<\
Without selection the recursions for the change in frequency of A in each \
gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.6757032054455214`*^9, 3.6757032697493563`*^9}, {
  3.6757098202812138`*^9, 3.675709824765788*^9}, {3.6757117765596933`*^9, 
  3.6757117850524673`*^9}, {3.675711818872109*^9, 3.6757118199810133`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"recursions0", "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"recursions", "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "frequenciessub"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.675703197099375*^9, 3.675703198353765*^9}, {
  3.675703326603519*^9, 3.675703332003808*^9}, {3.67570336997014*^9, 
  3.675703373531238*^9}, {3.675707060003501*^9, 3.675707071963544*^9}, {
  3.675707629815399*^9, 3.675707668691402*^9}, {3.6757098279293118`*^9, 
  3.6757098635569563`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "XAf0"}], "+", "XAm0"}], ")"}]}], ",", 
   RowBox[{"XAf0", "-", 
    RowBox[{"r", " ", "XAf0"}], "-", "XAm0", "+", 
    RowBox[{"r", " ", "YA0"}]}], ",", 
   RowBox[{
    RowBox[{"r", " ", "XAf0"}], "-", 
    RowBox[{"r", " ", "YA0"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675703373832204*^9, 3.675707072550578*^9, 3.6757076390361347`*^9, 
   3.675707669538135*^9, {3.675709828918172*^9, 3.6757098643685303`*^9}}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675709831409095*^9, 3.6757098343025913`*^9}, {
  3.675710744701475*^9, 3.675710745621426*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"recursions0", "\[Equal]", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"XAf0", ",", "XAm0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675709931730151*^9, 3.675709948227565*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"XAf0", "\[Rule]", "YA0"}], ",", 
    RowBox[{"XAm0", "\[Rule]", "YA0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6757098363525476`*^9, {3.6757099323567266`*^9, 3.675709948639193*^9}}]
}, Open  ]],

Cell["\<\
So, with no selection, the equilibrium frequency of A in each gamete/pollen \
type is equal (and we call this pA).\
\>", "Text",
 CellChangeTimes->{{3.675703427939505*^9, 3.6757035626138153`*^9}, {
   3.675706719194449*^9, 3.675706765062245*^9}, 3.67570996472328*^9, {
   3.6757107664993973`*^9, 3.675710849444377*^9}}],

Cell["\<\
Now, looking at only the first order selection terms, the recursions for the \
change in frequency of A in each gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.67570356712366*^9, 3.675703572187316*^9}, {
  3.67570609431063*^9, 3.675706097287983*^9}, {3.6757069069525433`*^9, 
  3.6757069072532797`*^9}, {3.67571091918222*^9, 3.6757109367564697`*^9}, {
  3.675711772412171*^9, 3.67571177325072*^9}, {3.675716463608975*^9, 
  3.67571647265489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"recursions1", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"recursions", "/.", "weaksel"}], "/.", 
              RowBox[{"Xaf", "\[Rule]", 
               RowBox[{"1", "-", "XAf"}]}]}], "/.", 
             RowBox[{"Ya", "\[Rule]", 
              RowBox[{"1", "-", "YA"}]}]}], "/.", 
            RowBox[{"Xam", "\[Rule]", 
             RowBox[{"1", "-", "XAm"}]}]}], "/.", "frequenciessub"}], "/.", 
          "sol0"}], "/.", 
         RowBox[{"YA0", "\[Rule]", "pA"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
     ",", "\[Epsilon]", ",", "Factor"}], "]"}], "//", "Flatten"}]}]], "Input",\

 CellChangeTimes->{{3.6757068495866413`*^9, 3.6757068907711554`*^9}, {
  3.6757069302403297`*^9, 3.675706982461239*^9}, {3.675707087605297*^9, 
  3.6757071228419533`*^9}, {3.67570718969317*^9, 3.675707319107386*^9}, {
  3.675707511314725*^9, 3.675707512612761*^9}, {3.675710885258552*^9, 
  3.675710885357044*^9}, {3.675711221036006*^9, 3.675711227798399*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}], "-", "XAf1", "+", "XAm1"}], 
     ")"}], " ", "\[Epsilon]"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "r", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}], "+", "XAf1", "-", 
      RowBox[{"r", " ", "XAf1"}], "-", "XAm1", "+", 
      RowBox[{"r", " ", "YA1"}]}], ")"}], " ", "\[Epsilon]"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}], "-", 
      RowBox[{"pA", " ", "r", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}], "+", 
      RowBox[{"r", " ", "XAf1"}], "-", 
      RowBox[{"r", " ", "YA1"}]}], ")"}], " ", "\[Epsilon]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675706852317442*^9, 3.675706918829287*^9}, {
   3.675706950931774*^9, 3.675706982932413*^9}, {3.6757070910767508`*^9, 
   3.675707123327277*^9}, {3.6757071925330353`*^9, 3.675707319486848*^9}, 
   3.675707513296742*^9, 3.67570768217498*^9, {3.675710857628578*^9, 
   3.675710885875184*^9}, {3.675711222477412*^9, 3.67571122814371*^9}}]
}, Open  ]],

Cell["\<\
Instead of solving for the first order genotype frequencies we will instead \
solve for the difference in the frequency of A in the different gamete/pollen \
types.\
\>", "Text",
 CellChangeTimes->{{3.6757135825548286`*^9, 3.675713633862471*^9}, 
   3.6757138892769423`*^9, {3.675716482887339*^9, 3.6757164842940083`*^9}}],

Cell["\<\
The difference in the frequency of A with X in females and X in males is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.6757138909855633`*^9, 3.675713959445539*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfXm", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"recursions1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"XAf1", "\[Rule]", 
       RowBox[{"dpAXfXm", "+", "XAm1"}]}]}], ",", "dpAXfXm"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.67571264493021*^9, 3.675712689537509*^9}, {
  3.675712721625124*^9, 3.675712730987232*^9}, {3.6757136496293707`*^9, 
  3.6757136649001226`*^9}, {3.675716490314892*^9, 3.675716491532194*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfXm", "\[Rule]", 
   RowBox[{
    RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
    RowBox[{"6", " ", "hAf", " ", 
     SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
    RowBox[{"4", " ", "hAf", " ", 
     SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
    RowBox[{"pA", " ", "t"}], "-", 
    RowBox[{
     SuperscriptBox["pA", "2"], " ", "t"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675712649738289*^9, 3.675712661484269*^9}, 
   3.675712732353135*^9, 3.6757136656167507`*^9, 3.675716491898244*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in males and Y is (at equilibrium \
to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713966791181*^9, 3.6757139830606413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXmY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"recursions1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
        RowBox[{"XAf1", "\[Rule]", 
         RowBox[{"dpAXfXm", "+", "XAm1"}]}]}], "/.", "eqdpAXfXm"}], "/.", 
      RowBox[{"XAm1", "\[Rule]", 
       RowBox[{"dpAXmY", "+", "YA1"}]}]}], ",", "dpAXmY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757127688027287`*^9, 3.675712794290226*^9}, {
  3.6757128674967947`*^9, 3.675712955948361*^9}, {3.675713232210559*^9, 
  3.675713326592478*^9}, {3.675713674096274*^9, 3.6757136876868258`*^9}, {
  3.6757164945548773`*^9, 3.675716495980947*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXmY", "\[Rule]", 
   RowBox[{
    FractionBox["1", "r"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "r", " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "-", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675713327517667*^9, {3.675713675336254*^9, 3.6757136899362087`*^9}, 
   3.675716496367241*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in females and Y is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713993050933*^9, 3.6757140012817707`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"recursions1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"XAf1", "\[Rule]", 
       RowBox[{"dpAXfY", "+", "YA1"}]}]}], ",", "dpAXfY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757133432729*^9, 3.6757133796267223`*^9}, {
  3.675713699819319*^9, 3.675713703005155*^9}, {3.67571649868948*^9, 
  3.675716499747883*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfY", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "hAm"}], " ", "pA", " ", "sAm"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{"3", " ", "hAm", " ", 
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"2", " ", "hAm", " ", 
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"pA", " ", "t"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "t"}], "+", 
     RowBox[{"pA", " ", "r", " ", "t"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], "r"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675713343667881*^9, 3.675713380152212*^9}, 
   3.675713703634624*^9, 3.675716500081162*^9}]
}, Open  ]],

Cell["\<\
So then, to first order, the equilibrium haploid genotype frequencies are(?)\
\>", "Text",
 CellChangeTimes->{{3.6757175107821083`*^9, 3.675717533841239*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqXAf", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"XAf0", "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXmY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"YA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXmY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675716895475359*^9, 3.675716900512623*^9}, {
  3.675717278127964*^9, 3.675717294591033*^9}, {3.675717351754582*^9, 
  3.675717366375647*^9}, {3.675717543006982*^9, 3.675717544667244*^9}, {
  3.6757178596731443`*^9, 3.675717863093356*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
         RowBox[{"hAm", " ", "sAm"}], "-", 
         RowBox[{"pA", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "sAf"}], "+", "sAm", "-", 
            RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]", "-", 
            RowBox[{"pA", " ", "\[Epsilon]"}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{3.6757169011353207`*^9, 3.6757173669613256`*^9, 
  3.6757175450525827`*^9, 3.675717864205447*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqXAm", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"XAm0", "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"YA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXfY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675716688271459*^9, 3.6757167143895473`*^9}, {
  3.675716769539331*^9, 3.6757167848745613`*^9}, {3.675716835976749*^9, 
  3.6757168663757353`*^9}, {3.675717219433107*^9, 3.675717236319748*^9}, {
  3.675717303688327*^9, 3.675717309958682*^9}, {3.675717548817417*^9, 
  3.675717549768239*^9}, {3.67571786788925*^9, 3.675717869340398*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pA"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.6757167147918577`*^9, {3.675716770743403*^9, 3.675716785278078*^9}, {
   3.675716840197975*^9, 3.6757168668171043`*^9}, 3.675717236886405*^9, 
   3.675717371726769*^9, 3.675717550116539*^9, 3.675717875403976*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqYA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"YA0", "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"YA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfY"}], "/.", 
    "eqdpAXfXm"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675717392424321*^9, 3.675717393210609*^9}, {
  3.675717465498665*^9, 3.675717499551214*^9}, {3.67571755307234*^9, 
  3.675717554018692*^9}, {3.6757178713638563`*^9, 3.675717873545209*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{3.67571750048251*^9, 3.675717554350906*^9, 
  3.675717874008835*^9}]
}, Open  ]],

Cell["\<\
The change in the equilibrium frequency of A is\
\>", "Text",
 CellChangeTimes->{{3.67571806556964*^9, 3.675718103851286*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpA", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"2", " ", "XAfprime"}], "+", "XAmprime", "+", 
                 "YAprime", "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "XAf"}], "-", "XAm", "-", "YA"}], ")"}]}], "/.",
                 "weaksel"}], "/.", 
               RowBox[{"Xaf", "\[Rule]", 
                RowBox[{"1", "-", "XAf"}]}]}], "/.", 
              RowBox[{"Ya", "\[Rule]", 
               RowBox[{"1", "-", "YA"}]}]}], "/.", 
             RowBox[{"Xam", "\[Rule]", 
              RowBox[{"1", "-", "XAm"}]}]}], "/.", 
            RowBox[{"XAf", "\[Rule]", "eqXAf"}]}], "/.", 
           RowBox[{"XAm", "\[Rule]", "eqXAm"}]}], "/.", 
          RowBox[{"YA", "\[Rule]", "eqYA"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
      "/", "4"}], ",", "\[Epsilon]", ",", "Simplify"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675717647887065*^9, 3.675717697126732*^9}, {
   3.675717728154462*^9, 3.675717827465465*^9}, {3.675717886726254*^9, 
   3.6757179766881647`*^9}, {3.675718083857135*^9, 3.6757180905764112`*^9}, 
   3.67571817039502*^9, {3.675719298161072*^9, 3.675719300128034*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"pA", "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
      RowBox[{"hAm", " ", "sAm"}], "-", 
      RowBox[{"pA", " ", 
       RowBox[{"(", 
        RowBox[{"sAf", "+", "sAm", "-", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], ")"}], 
    " ", "\[Epsilon]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675717675625972*^9, 3.675717697744046*^9}, {
   3.675717736995945*^9, 3.675717827905334*^9}, {3.675717912013361*^9, 
   3.6757179770805798`*^9}, {3.675718122247941*^9, 3.675718137314794*^9}, 
   3.675718171232416*^9, {3.675719279665413*^9, 3.6757193043150883`*^9}}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.6757181100991917`*^9, 3.675718119482112*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpA", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dpA", "-", "pA"}], "\[Equal]", "0"}], ",", "pA"}], "]"}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.675717988879238*^9, 3.67571803095448*^9}, {
  3.6757181277583733`*^9, 3.6757181353000813`*^9}, {3.6757192734183817`*^9, 
  3.6757193075868177`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"hAf", " ", "sAf"}], "+", 
        RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
       RowBox[{"sAf", "-", 
        RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
        RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675717995245247*^9, 3.675718031314158*^9}, {
   3.675718129676858*^9, 3.675718138913946*^9}, 3.67571817443064*^9, {
   3.675719281498005*^9, 3.675719308048888*^9}}]
}, Open  ]],

Cell["\<\
Notice that when t=0 we have equation \[OpenCurlyDoubleQuote]avgpASubs\
\[CloseCurlyDoubleQuote] in van Doorn & Kirkpatrick 2007 (SOM page 6). \
Sperm/pollen selection acts to increase the frequency of A (if selected for, \
t>0).\
\>", "Text",
 CellChangeTimes->{{3.675718177833785*^9, 3.6757182794849873`*^9}}]
}, Open  ]],

Cell["Invasion of a neo-Y", "Section",
 CellChangeTimes->{{3.6757182993973627`*^9, 3.6757183075776167`*^9}}]
}, Open  ]]
},
WindowSize->{1166, 539},
WindowMargins->{{71, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 291, 6, 252, "Title"],
Cell[873, 30, 118, 1, 62, "Subtitle"],
Cell[CellGroupData[{
Cell[1016, 35, 251, 3, 100, "Section"],
Cell[1270, 40, 924, 14, 132, "Text"],
Cell[2197, 56, 1419, 37, 183, "Input"],
Cell[3619, 95, 400, 7, 37, "Text"],
Cell[CellGroupData[{
Cell[4044, 106, 553, 14, 78, "Input"],
Cell[4600, 122, 225, 3, 35, "Output"],
Cell[4828, 127, 223, 3, 35, "Output"],
Cell[5054, 132, 223, 3, 35, "Output"]
}, Open  ]],
Cell[5292, 138, 268, 6, 37, "Text"],
Cell[5563, 146, 1884, 39, 162, "Input"],
Cell[7450, 187, 244, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[7719, 196, 937, 19, 57, "Input"],
Cell[8659, 217, 630, 9, 35, "Output"],
Cell[9292, 228, 630, 9, 35, "Output"]
}, Open  ]],
Cell[9937, 240, 266, 5, 37, "Text"],
Cell[10206, 247, 1608, 45, 204, "Input"],
Cell[11817, 294, 233, 5, 37, "Text"],
Cell[CellGroupData[{
Cell[12075, 303, 435, 11, 57, "Input"],
Cell[12513, 316, 171, 3, 35, "Output"],
Cell[12687, 321, 173, 3, 35, "Output"]
}, Open  ]],
Cell[12875, 327, 234, 5, 37, "Text"],
Cell[13112, 334, 1627, 45, 141, "Input"],
Cell[14742, 381, 207, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[14974, 389, 522, 14, 78, "Input"],
Cell[15499, 405, 294, 5, 35, "Output"],
Cell[15796, 412, 294, 5, 35, "Output"],
Cell[16093, 419, 294, 5, 35, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[16436, 430, 135, 2, 62, "Section"],
Cell[16574, 434, 390, 6, 61, "Text"],
Cell[16967, 442, 696, 13, 120, "Input"],
Cell[17666, 457, 261, 5, 37, "Text"],
Cell[17930, 464, 1167, 27, 225, "Input"],
Cell[19100, 493, 237, 5, 37, "Text"],
Cell[19340, 500, 661, 16, 120, "Input"],
Cell[20004, 518, 344, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[20373, 528, 916, 23, 78, "Input"],
Cell[21292, 553, 558, 16, 55, "Output"]
}, Open  ]],
Cell[21865, 572, 159, 2, 37, "Text"],
Cell[CellGroupData[{
Cell[22049, 578, 273, 7, 35, "Input"],
Cell[22325, 587, 264, 7, 35, "Output"]
}, Open  ]],
Cell[22604, 597, 329, 6, 37, "Text"],
Cell[22936, 605, 467, 8, 37, "Text"],
Cell[CellGroupData[{
Cell[23428, 617, 1268, 31, 120, "Input"],
Cell[24699, 650, 2491, 62, 120, "Output"]
}, Open  ]],
Cell[27205, 715, 332, 6, 61, "Text"],
Cell[27540, 723, 211, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[27776, 731, 574, 14, 35, "Input"],
Cell[28353, 747, 710, 17, 42, "Output"]
}, Open  ]],
Cell[29078, 767, 200, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[29303, 775, 772, 19, 57, "Input"],
Cell[30078, 796, 1607, 39, 120, "Output"]
}, Open  ]],
Cell[31700, 838, 202, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[31927, 846, 520, 14, 35, "Input"],
Cell[32450, 862, 837, 23, 58, "Output"]
}, Open  ]],
Cell[33302, 888, 168, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[33495, 895, 638, 15, 36, "Input"],
Cell[34136, 912, 1115, 33, 55, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35288, 950, 736, 16, 36, "Input"],
Cell[36027, 968, 1363, 37, 60, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37427, 1010, 586, 14, 36, "Input"],
Cell[38016, 1026, 1188, 34, 60, "Output"]
}, Open  ]],
Cell[39219, 1063, 136, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[39380, 1070, 1567, 39, 141, "Input"],
Cell[40950, 1111, 927, 24, 55, "Output"]
}, Open  ]],
Cell[41892, 1138, 110, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[42027, 1143, 384, 10, 36, "Input"],
Cell[42414, 1155, 729, 20, 56, "Output"]
}, Open  ]],
Cell[43158, 1178, 321, 6, 61, "Text"]
}, Open  ]],
Cell[43494, 1187, 108, 1, 100, "Section"]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
