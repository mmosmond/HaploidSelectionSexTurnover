(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    317501,       8094]
NotebookOptionsPosition[    305028,       7704]
NotebookOutlinePosition[    305386,       7720]
CellTagsIndexPosition[    305343,       7717]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Gametic Selection, Sex-Ratio Bias, and Transitions Between Sex-Determining \
Systems\
\>", "Title",
 CellChangeTimes->{{3.6756461584547977`*^9, 3.675646190672323*^9}, {
   3.675691343813216*^9, 3.675691344643425*^9}, {3.675718324413807*^9, 
   3.6757183349582043`*^9}, {3.675719587684537*^9, 3.675719616196001*^9}, 
   3.6759056672964783`*^9, 3.676676533093017*^9, 3.678542642367774*^9, {
   3.678560549515456*^9, 3.678560568313982*^9}, 3.6820500476906357`*^9, {
   3.6854453306884403`*^9, 3.685445347162414*^9}}],

Cell["Michael F Scott, Matthew M Osmond, Sarah P Otto", "Subtitle",
 CellChangeTimes->{{3.6756909919076443`*^9, 3.675690999875959*^9}, {
  3.679939506599341*^9, 3.679939536485776*^9}, {3.683815470889019*^9, 
  3.683815474656125*^9}}],

Cell["\<\
Throughout this notebook we refer to ancestrally heterogametic and \
homogametic sexes. In the case of an ancestrally XY system, the heterogametic \
sex is male while the homogametic sex is female. In the case of an \
ancestrally ZW system, the homogametic sex is male while the heterogametic \
sex is female.

We then speak of homologous and non-homologous sex chromosome transitions. \
Homologous transitions are XY to XY or ZW to ZW while nonhomologous \
transitions are XY to ZW or ZW to XY. In terms of heterogametic and \
homogametic sexes, homologous transitions occur when the invading dominant \
neo-sex determiner (neo-Y or neo-W allele) causes its diploid carriers to \
become the ancestrally heterogametic sex, while non-homologous transitions \
occur when the invading dominant neo-sex determiner causes its diploid \
carriers to become the ancestrally homogametic sex (thus making the \
ancestrally homogametic sex become heterogametic).

Below, the subscripts \[OpenCurlyDoubleQuote]hom\[CloseCurlyDoubleQuote] and \
\[OpenCurlyDoubleQuote]het\[CloseCurlyDoubleQuote] refer to the ancestrally \
homogametic and heterogametic sexes. Thus, in a nonhomologous transition from \
e.g., XY to ZW, \[OpenCurlyDoubleQuote]het\[CloseCurlyDoubleQuote] refers to \
males despite the fact that males become homogametic once the transition is \
complete. This notation will help keep our results general to both XY and ZW \
systems.\
\>", "Text",
 CellChangeTimes->{{3.6984132228033752`*^9, 3.6984133764290247`*^9}, {
  3.6984135383128443`*^9, 3.698413857381938*^9}, {3.698414059989338*^9, 
  3.6984142703617287`*^9}, {3.6984195391359167`*^9, 3.6984195720896053`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["A. Offspring control", "Title",
 CellChangeTimes->{{3.681790744740692*^9, 3.681790746984047*^9}, 
   3.681790967276816*^9, {3.6818915562823353`*^9, 3.6818915646829967`*^9}, {
   3.681891823954941*^9, 3.681891828318096*^9}, {3.681894422770378*^9, 
   3.681894423198917*^9}, {3.6820500588075733`*^9, 3.6820500635285788`*^9}, {
   3.682930016449676*^9, 3.68293001766742*^9}, {3.682931061741871*^9, 
   3.6829310627002373`*^9}, {3.686831395367528*^9, 3.68683139571903*^9}, {
   3.694977707517466*^9, 3.694977714221402*^9}, {3.6950782825423403`*^9, 
   3.695078299261114*^9}, {3.695153103298314*^9, 3.695153103489496*^9}, 
   3.698412257179369*^9}],

Cell[CellGroupData[{

Cell["Life-cycle", "Section",
 CellChangeTimes->{{3.681743786104041*^9, 3.6817437925740137`*^9}, {
   3.681744758252803*^9, 3.6817447640802717`*^9}, {3.6817907535849123`*^9, 
   3.681790755198732*^9}, 3.681790964811371*^9}],

Cell[CellGroupData[{

Cell["Haploid competition", "Subsection",
 CellChangeTimes->{{3.681790761563039*^9, 3.681790767400532*^9}, {
  3.695053398651717*^9, 3.695053400125853*^9}, {3.696695122110588*^9, 
  3.6966951231463127`*^9}}],

Cell["Frequency of haploids from each sex", "Text",
 CellChangeTimes->{{3.697151250749948*^9, 3.697151258628313*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["freqHap", "sex_"], ":=", 
  RowBox[{"ParallelSum", "[", 
   RowBox[{
    SubscriptBox["fHap", 
     RowBox[{"x", ",", "y", ",", "z", ",", "sex"}]], ",", 
    RowBox[{"{", 
     RowBox[{"x", ",", 
      RowBox[{"{", 
       RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"y", ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"z", ",", 
      RowBox[{"{", 
       RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.697151183458856*^9, 3.697151199477862*^9}, 
   3.6971620991256037`*^9, {3.698414400107432*^9, 3.698414401468542*^9}}],

Cell["Mean haploid fitness of gametes from each sex", "Text",
 CellChangeTimes->{{3.696695130048037*^9, 3.696695161928997*^9}, {
  3.6966953911933403`*^9, 3.696695398865906*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["wbarHap", "sex_"], ":=", 
  RowBox[{
   SubscriptBox["wbarHap", "sex"], "=", 
   FractionBox[
    RowBox[{"ParallelSum", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["wHap", 
        RowBox[{"y", ",", "sex"}]], 
       SubscriptBox["fHap", 
        RowBox[{"x", ",", "y", ",", "z", ",", "sex"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}], 
    SubscriptBox["freqHap", "sex"]]}]}]], "Input",
 CellChangeTimes->{{3.68174069177772*^9, 3.681740709745438*^9}, {
  3.6817407470528183`*^9, 3.681740792567976*^9}, {3.681743989430183*^9, 
  3.681743993228486*^9}, {3.681744694112637*^9, 3.681744695061598*^9}, {
  3.681744770055842*^9, 3.681744781694951*^9}, {3.696695164212509*^9, 
  3.696695169314419*^9}, {3.69715114997863*^9, 3.697151179679657*^9}, {
  3.6971512189873543`*^9, 3.6971512227342453`*^9}, {3.697162090151134*^9, 
  3.697162092068632*^9}, {3.698414404908331*^9, 3.698414406277357*^9}}],

Cell["\<\
Frequencies of haploid genotypes from each sex following haploid competition, \
which occurs between gametes coming from the same sex\
\>", "Text",
 CellChangeTimes->{{3.696695176865569*^9, 3.696695199818366*^9}, {
  3.6966952399477863`*^9, 3.696695241475881*^9}, {3.696695404993683*^9, 
  3.6966954241384993`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fHapSel", 
   RowBox[{"x_", ",", "y_", ",", "z_", ",", "sex_"}]], ":=", 
  FractionBox[
   RowBox[{
    SubscriptBox["wHap", 
     RowBox[{"y", ",", "sex"}]], 
    SubscriptBox["fHap", 
     RowBox[{"x", ",", "y", ",", "z", ",", "sex"}]]}], 
   RowBox[{
    SubscriptBox["wbarHap", "sex"], 
    SubscriptBox["freqHap", "sex"]}]]}]], "Input",
 CellChangeTimes->{{3.68174069177772*^9, 3.681740709745438*^9}, {
  3.6817407470528183`*^9, 3.681740792567976*^9}, {3.681743989430183*^9, 
  3.681743993228486*^9}, {3.681744694112637*^9, 3.681744695061598*^9}, {
  3.681744770055842*^9, 3.681744781694951*^9}, {3.696695164212509*^9, 
  3.696695169314419*^9}, {3.69715122758352*^9, 3.6971512429961433`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Random mating", "Subsection",
 CellChangeTimes->{{3.6817907708613567`*^9, 3.681790772239373*^9}, {
  3.695053404145611*^9, 3.695053404843087*^9}}],

Cell["Gametes from the two sexes pair at random", "Text",
 CellChangeTimes->{{3.696695214602847*^9, 3.6966952286276083`*^9}, {
  3.696695432002734*^9, 3.6966954345306883`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fDip", 
   RowBox[{
   "xM_", ",", "yM_", ",", "zM_", ",", "xP_", ",", "yP_", ",", "zP_"}]], ":=", 
  RowBox[{
   SubscriptBox["fDip", 
    RowBox[{"xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP"}]], 
   "=", 
   RowBox[{
    SubscriptBox["fHapSel", 
     RowBox[{"xM", ",", "yM", ",", "zM", ",", "hom"}]], 
    SubscriptBox["fHapSel", 
     RowBox[{"xP", ",", "yP", ",", "zP", ",", "het"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.681740852705102*^9, 3.681740881236745*^9}, {
   3.681741102397697*^9, 3.681741112150375*^9}, 3.6817438071282473`*^9, 
   3.68174469800976*^9, {3.681744788822844*^9, 3.681744812868677*^9}, {
   3.698371781222054*^9, 3.69837178396603*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Sex determination", "Subsection",
 CellChangeTimes->{{3.68179077585012*^9, 3.681790778311782*^9}, {
  3.6950534072431593`*^9, 3.695053408004703*^9}}],

Cell["Determine the sex of newly formed diploids", "Text",
 CellChangeTimes->{{3.696695277141136*^9, 3.696695287573451*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fDipSex", 
   RowBox[{
   "xM_", ",", "yM_", ",", "zM_", ",", "xP_", ",", "yP_", ",", "zP_", ",", 
    "sex_"}]], ":=", 
  RowBox[{
   SubscriptBox["fDipSex", 
    RowBox[{
    "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
     "sex"}]], "=", 
   RowBox[{
    SubscriptBox["fDip", 
     RowBox[{"xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP"}]], 
    SubscriptBox["psex", 
     RowBox[{"zM", ",", "xP", ",", "zP", ",", "sex"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.681740916059374*^9, 3.681740941165064*^9}, {
   3.6817411271569843`*^9, 3.68174113488159*^9}, 3.681744699086836*^9, {
   3.681744820695732*^9, 3.681744847841905*^9}}],

Cell["\<\
where a diploid must become one heterogametic or homogametic\
\>", "Text",
 CellChangeTimes->{{3.681790782072919*^9, 3.681790792647656*^9}, {
  3.698371157392571*^9, 3.6983711604146013`*^9}, {3.6984142978219423`*^9, 
  3.6984143090759773`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumsex", "=", 
   RowBox[{
    SubscriptBox["psex", 
     RowBox[{"zM_", ",", "xP_", ",", "zP_", ",", "het"}]], "\[Rule]", 
    RowBox[{"1", "-", 
     SubscriptBox["psex", 
      RowBox[{"zM", ",", "xP", ",", "zP", ",", "hom"}]]}]}]}], ";"}]], "Input",\

 CellChangeTimes->{{3.681740963151202*^9, 3.681741006588331*^9}, {
  3.6817448642217417`*^9, 3.681744883117257*^9}, {3.698371163794825*^9, 
  3.6983711691439342`*^9}, {3.698371202106351*^9, 3.698371204593018*^9}}],

Cell["\<\
Rules for invasion of a dominant modifier into an XY (or ZW) system\
\>", "Text",
 CellChangeTimes->{{3.681790803628374*^9, 3.681790842176858*^9}, {
   3.695053524085052*^9, 3.6950535912772512`*^9}, 3.696695331640586*^9, {
   3.6966954462351923`*^9, 3.696695448475649*^9}, 3.698371253750304*^9, {
   3.698371401861559*^9, 3.698371404587001*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"invXY", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"M", ",", "YW", ",", "M", ",", "hom"}]], "\[Rule]", "0"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "always", " ", "heterogametic", " ", "sex", " ", "if", " ", "neo"}], 
       "-", 
       RowBox[{"SD", " ", "allele", " ", "wildtype", " ", 
        RowBox[{"(", "M", ")"}], " ", "and", " ", "have", " ", "Y", " ", "or",
         " ", "W", " ", 
        RowBox[{"(", "YW", ")"}], " ", "from", " ", "heterogametic", " ", 
        "parent"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"M", ",", "XZ", ",", "M", ",", "hom"}]], "\[Rule]", "1"}], ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "always", " ", "homogametic", " ", "sex", " ", "if", " ", "neo"}], "-", 
       RowBox[{"SD", " ", "allele", " ", "wildtype", " ", 
        RowBox[{"(", "M", ")"}], " ", "and", " ", "have", " ", "X", " ", "or",
         " ", "Z", " ", "from", " ", 
        RowBox[{"(", "XZ", ")"}], " ", "heterogametic", " ", "parent"}]}], 
      "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"m", ",", "xP_", ",", "zP_", ",", "hom"}]], "\[Rule]", "k"}], 
     ",", 
     RowBox[{"(*", 
      RowBox[{
       RowBox[{
       "ancestrally", " ", "homogametic", " ", "sex", " ", "with", " ", 
        "probability", " ", "k", " ", "if", " ", "mutation", " ", "at", " ", 
        "the", " ", "neo"}], "-", 
       RowBox[{"SD", " ", "locus", " ", 
        RowBox[{"(", "m", ")"}], " ", "from", " ", "homogametic", " ", 
        "parent"}]}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"zM_", ",", "xP_", ",", "m", ",", "hom"}]], "\[Rule]", "k"}]}],
     " ", 
    RowBox[{"(*", 
     RowBox[{
      RowBox[{
      "ancestrally", " ", "homogametic", " ", "sex", " ", "with", " ", 
       "probability", " ", "k", " ", "if", " ", "mutation", " ", "at", " ", 
       "the", " ", "neo"}], "-", 
      RowBox[{"SD", " ", "locus", " ", 
       RowBox[{"(", "m", ")"}], " ", "from", " ", "heterogametic", " ", 
       "parent"}]}], "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678749250078711*^9, 3.678749257734652*^9}, {
   3.678749341105864*^9, 3.678749495395021*^9}, {3.679945123194168*^9, 
   3.679945148394607*^9}, {3.6799451869399347`*^9, 3.679945240579802*^9}, {
   3.679945289781743*^9, 3.679945339491596*^9}, {3.6799453844002123`*^9, 
   3.679945402746641*^9}, {3.6799454634914007`*^9, 3.6799455567240467`*^9}, {
   3.6799484238045397`*^9, 3.679948455123131*^9}, {3.67994848956713*^9, 
   3.679948517654551*^9}, {3.679948569319213*^9, 3.679948570835786*^9}, {
   3.679951538898012*^9, 3.679951549755542*^9}, {3.68037305678191*^9, 
   3.680373067198072*^9}, {3.6803822046986856`*^9, 3.680382207715699*^9}, {
   3.680382278235017*^9, 3.68038254183022*^9}, {3.6803826726056223`*^9, 
   3.6803827011867247`*^9}, {3.681481533121539*^9, 3.681481811404159*^9}, {
   3.681482143533368*^9, 3.681482144703322*^9}, {3.681736556313373*^9, 
   3.681736594419837*^9}, {3.681736645992744*^9, 3.6817366988928537`*^9}, {
   3.681736750338529*^9, 3.681736811785675*^9}, {3.681736847176927*^9, 
   3.681736957382381*^9}, {3.6817438697025414`*^9, 3.681743921107368*^9}, 
   3.6817443638221292`*^9, {3.681744903243745*^9, 3.681744975780779*^9}, {
   3.681745009880579*^9, 3.681745061658045*^9}, {3.681790822233528*^9, 
   3.6817908224326878`*^9}, {3.695053621112494*^9, 3.6950536508891478`*^9}, {
   3.695053712275227*^9, 3.6950537228262157`*^9}, {3.6983711980465403`*^9, 
   3.698371396212751*^9}, {3.6984143592755938`*^9, 3.698414375355226*^9}, {
   3.698414451824972*^9, 3.6984144754680347`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Diploid selection", "Subsection",
 CellChangeTimes->{{3.6817908523566217`*^9, 3.681790854930419*^9}, {
  3.695053424001115*^9, 3.695053424708165*^9}}],

Cell["Frequencies of diploids from each sex", "Text",
 CellChangeTimes->{{3.6971512960507193`*^9, 3.6971513054322863`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["freqDip", "sex_"], ":=", 
  RowBox[{"ParallelSum", "[", 
   RowBox[{
    SubscriptBox["fDipSex", 
     RowBox[{
     "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
      "sex"}]], ",", 
    RowBox[{"{", 
     RowBox[{"xM", ",", 
      RowBox[{"{", 
       RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"yM", ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"zM", ",", 
      RowBox[{"{", 
       RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"xP", ",", 
      RowBox[{"{", 
       RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"yP", ",", 
      RowBox[{"{", 
       RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"zP", ",", 
      RowBox[{"{", 
       RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6971513262430763`*^9, 3.6971513267411213`*^9}, 
   3.69716210906399*^9, {3.698414419349148*^9, 3.698414425630577*^9}}],

Cell["Mean diploid fitness in each sex", "Text",
 CellChangeTimes->{{3.696695371490938*^9, 3.696695372672546*^9}, {
  3.696695458244852*^9, 3.6966954647319517`*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["wbarDip", "sex_"], ":=", 
  RowBox[{
   SubscriptBox["wbarDip", "sex"], "=", 
   FractionBox[
    RowBox[{"ParallelSum", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["wDip", 
        RowBox[{"yM", ",", "yP", ",", "sex"}]], 
       SubscriptBox["fDipSex", 
        RowBox[{
        "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
         "sex"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"xM", ",", 
        RowBox[{"{", 
         RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"yM", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zM", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xP", ",", 
        RowBox[{"{", 
         RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"yP", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zP", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}], 
    SubscriptBox["freqDip", "sex"]]}]}]], "Input",
 CellChangeTimes->{
  3.6971497937936907`*^9, {3.697149946702374*^9, 3.697149972474596*^9}, 
   3.697150235543221*^9, {3.697150277256873*^9, 3.697150280344022*^9}, {
   3.697151330025823*^9, 3.6971513335051527`*^9}, 3.697162111414228*^9, {
   3.698414430678187*^9, 3.698414435742556*^9}}],

Cell["\<\
Frequencies of diploid genotypes in each sex following diploid selection, \
which occurs separately in each sex (even if diploid selection is not direct \
competition between members of the same sex but instead viability selection, \
selection still effectively occurs \[OpenCurlyQuote]separately in each sex\
\[CloseCurlyQuote] because the next generation is sired by 50% heterogametic \
sex and 50% homogametic sex)\
\>", "Text",
 CellChangeTimes->{{3.696695476428199*^9, 3.696695510501577*^9}, {
  3.696695589856222*^9, 3.6966955941123123`*^9}, {3.696696090011167*^9, 
  3.6966962979217*^9}, {3.698371451343636*^9, 3.698371460300375*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fDipSel", 
   RowBox[{
   "xM_", ",", "yM_", ",", "zM_", ",", "xP_", ",", "yP_", ",", "zP_", ",", 
    "sex_"}]], ":=", 
  RowBox[{
   SubscriptBox["fDipSel", 
    RowBox[{
    "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
     "sex"}]], "=", 
   FractionBox[
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"yM", ",", "yP", ",", "sex"}]], 
     SubscriptBox["fDipSex", 
      RowBox[{
      "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
       "sex"}]]}], 
    RowBox[{
     SubscriptBox["wbarDip", "sex"], 
     SubscriptBox["freqDip", "sex"]}]]}]}]], "Input",
 CellChangeTimes->{{3.697150004307781*^9, 3.697150018911365*^9}, 
   3.697150105743805*^9, {3.697150294137301*^9, 3.697150305677289*^9}, {
   3.697151338394719*^9, 3.6971513388456793`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Meiosis", "Subsection",
 CellChangeTimes->{{3.6817908603315487`*^9, 3.681790862035611*^9}, {
  3.695053427266148*^9, 3.695053427971775*^9}}],

Cell["Gamete genotypes produced by diploids", "Text",
 CellChangeTimes->{{3.696695621410144*^9, 3.696695643290491*^9}, {
  3.6966963219398127`*^9, 3.69669633174671*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fHapNext", 
   RowBox[{"x_", ",", "y_", ",", "z_", ",", "sex_"}]], ":=", 
  RowBox[{
   SubscriptBox["fHapNext", 
    RowBox[{"x", ",", "y", ",", "z", ",", "sex"}]], "=", 
   RowBox[{"ParallelSum", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["fDipSel", 
       RowBox[{
       "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
        "sex"}]], 
      SubscriptBox["pseg", 
       RowBox[{
       "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
        "sex", ",", "x", ",", "y", ",", "z"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"xM", ",", 
       RowBox[{"{", 
        RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yM", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zM", ",", 
       RowBox[{"{", 
        RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xP", ",", 
       RowBox[{"{", 
        RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yP", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zP", ",", 
       RowBox[{"{", 
        RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6817440705483007`*^9, 3.6817440908841143`*^9}, {
  3.681744703057055*^9, 3.6817447059212723`*^9}, {3.681745089264248*^9, 
  3.681745102327985*^9}, {3.698414503733334*^9, 3.698414513819972*^9}}],

Cell[CellGroupData[{

Cell["Segregation", "Subsubsection",
 CellChangeTimes->{{3.6951408332729673`*^9, 3.6951408457141037`*^9}, {
   3.695140930171077*^9, 3.695140941721265*^9}, 3.695146498004241*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pseg0", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"triple", " ", "homozygote"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["pseg", 
      RowBox[{
      "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y1_", ",", "z1_", ",", 
       "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", "1"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"single", " ", "heterozygotes"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z1_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x1_", ",", "a", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      SubscriptBox["\[Alpha]", "sex"]}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x1_", ",", "a", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["\[Alpha]", "sex"]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x1_", ",", "A", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      SubscriptBox["\[Alpha]", "sex"]}], " ", ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x1_", ",", "A", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["\[Alpha]", "sex"]}], ")"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg2", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"double", " ", "heterozygotes"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z1_", ",", 
        "sex_", ",", "x2_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z1_", ",", 
        "sex_", ",", "x2_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], " ", 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x1_", ",", "a", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x1_", ",", "a", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x1_", ",", "a", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], " ", 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x1_", ",", "a", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z1_", ",", 
        "sex_", ",", "x2_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "male"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z1_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], " ", 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z1_", ",", 
        "sex_", ",", "x2_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x1_", ",", "A", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x1_", ",", "A", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x1_", ",", "A", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "sex"], " ", 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x1_", ",", "A", ",", "z2_", ",", 
        "sex_", ",", "x1_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "sex"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{"recAXandAM", "+", "recAMnotAX"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXnotAM", "+", "recAMnotAX"}], ")"}]}], ")"}], "/", 
       "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"(", 
          RowBox[{"recAXnotAM", "+", "recAMnotAX"}], ")"}]}], ")"}], "/", 
       "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"recAXnotAM", "+", "recAMnotAX"}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"recAXnotAM", "+", "recAMnotAX"}], ")"}], "/", "2"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg3", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"triple", " ", "heterozygote"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", "recAXandAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], "recAXandAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", "recAXandAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "het", ",", "x2_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], " ", "recAXandAM"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], " ", "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], " ", "recAXandAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "A", ",", "z1_", ",", "x2_", ",", "a", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], " ", "recAXandAM"}]}], ",",
      "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], " ", 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], 
       RowBox[{"(", 
        RowBox[{
        "1", "-", "recAMnotAX", "-", "recAXnotAM", "-", "recAXandAM"}], 
        ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "A", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], " ", "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "a", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], "recAXnotAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], " ", "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], "recAMnotAX"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x1_", ",", "A", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       SubscriptBox["\[Alpha]", "hom"], " ", "recAXandAM"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "a", ",", "z1_", ",", "x2_", ",", "A", ",", "z2_", ",", 
        "hom", ",", "x2_", ",", "a", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], " ", "recAXandAM"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg4", "=", 
   RowBox[{
    SubscriptBox["pseg", 
     RowBox[{
     "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
      "sex_", ",", "x_", ",", "y_", ",", "z_"}]], "\[Rule]", "0"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.678743407603024*^9, 3.678743407992798*^9}, {
   3.678743451388444*^9, 3.67874370896734*^9}, {3.678743739187004*^9, 
   3.6787437964386272`*^9}, {3.678743835224123*^9, 3.678744092201377*^9}, {
   3.678744261724123*^9, 3.678744264472003*^9}, {3.678745612751544*^9, 
   3.678745641984303*^9}, {3.67874649434549*^9, 3.678746541426771*^9}, {
   3.678746588409*^9, 3.678746681937327*^9}, {3.678746723757894*^9, 
   3.678746726465787*^9}, {3.678747087955186*^9, 3.678747088849813*^9}, 
   3.6787471567075977`*^9, {3.678747281988718*^9, 3.678747345020574*^9}, {
   3.678747431984068*^9, 3.67874755142631*^9}, {3.678747706661974*^9, 
   3.678747816389114*^9}, {3.678747910520447*^9, 3.67874808520201*^9}, {
   3.678748117158371*^9, 3.678748124005247*^9}, 3.6787481598608437`*^9, {
   3.6787483065670223`*^9, 3.6787483117635727`*^9}, {3.67874836658313*^9, 
   3.678748403085204*^9}, {3.6787513544793262`*^9, 3.678751396800355*^9}, {
   3.67994277150476*^9, 3.679942799274077*^9}, {3.679942831090846*^9, 
   3.679942912055253*^9}, {3.679949107745778*^9, 3.679949120757681*^9}, {
   3.679949262229959*^9, 3.679949268375124*^9}, {3.679949476794919*^9, 
   3.679949523563891*^9}, {3.680374604093164*^9, 3.680374627372505*^9}, {
   3.681497799779855*^9, 3.6814978041546593`*^9}, {3.681497949200699*^9, 
   3.681497969730068*^9}, {3.6814980083479347`*^9, 3.68149802692618*^9}, 
   3.681498690728004*^9, {3.681503295313662*^9, 3.681503299933617*^9}, {
   3.681503352635356*^9, 3.681503380988648*^9}, {3.681503421408928*^9, 
   3.681503592682515*^9}, {3.681739639029612*^9, 3.681739667227919*^9}, {
   3.681739710186636*^9, 3.6817397505186863`*^9}, {3.68173979007161*^9, 
   3.6817400224068947`*^9}, {3.6817402086731462`*^9, 3.681740553815752*^9}, 
   3.6817441247473288`*^9, {3.681745118289254*^9, 3.681745246566457*^9}, 
   3.681790293719043*^9, {3.681790495616611*^9, 3.68179055084875*^9}, {
   3.681790594196591*^9, 3.681790651669318*^9}, {3.685446566599594*^9, 
   3.685446613301856*^9}, {3.6854466594783163`*^9, 3.685446674108594*^9}, {
   3.685446725576165*^9, 3.685446846752988*^9}, {3.685448456509159*^9, 
   3.6854484978796*^9}, {3.685854818012582*^9, 3.68585488767402*^9}, {
   3.685857317433228*^9, 3.6858574839951363`*^9}, {3.685857630736331*^9, 
   3.685857652981037*^9}, {3.685857739461396*^9, 3.6858577821286917`*^9}, {
   3.685857869620257*^9, 3.685857871015697*^9}, {3.685867321622304*^9, 
   3.685867404776165*^9}, {3.685867554585763*^9, 3.685867556709074*^9}, {
   3.685867675545533*^9, 3.6858677608809643`*^9}, 3.685867840790553*^9, {
   3.685868411911867*^9, 3.6858684353076897`*^9}, {3.685868522045967*^9, 
   3.6858685841072397`*^9}, {3.6858686149097958`*^9, 3.685868696329458*^9}, {
   3.685868734377339*^9, 3.68586879707349*^9}, {3.686831493887526*^9, 
   3.686831517514574*^9}, {3.6868315591139107`*^9, 3.686831680594562*^9}, {
   3.686831719657514*^9, 3.6868318159633617`*^9}, 3.6868319155060797`*^9, {
   3.686831995721257*^9, 3.686831996372467*^9}, {3.691332475471079*^9, 
   3.69133253011084*^9}, {3.691332681143373*^9, 3.6913326965546722`*^9}, {
   3.691332726779971*^9, 3.69133272835781*^9}, {3.691332828003528*^9, 
   3.691332845155514*^9}, {3.6913329825497303`*^9, 3.691333001347786*^9}, {
   3.691333050923387*^9, 3.69133306680932*^9}, {3.691333135450306*^9, 
   3.691333174120304*^9}, {3.691333226061233*^9, 3.691333312473215*^9}, {
   3.695144821209661*^9, 3.695144832183332*^9}, {3.6951465122709303`*^9, 
   3.695146539414205*^9}, {3.695146641378426*^9, 3.69514664220968*^9}, {
   3.695146769575981*^9, 3.695146779440208*^9}, {3.695146864513186*^9, 
   3.695146875460191*^9}, {3.6951469318251*^9, 3.6951470843329573`*^9}, {
   3.695147162154175*^9, 3.695147319523302*^9}, {3.6951477560497704`*^9, 
   3.695147759616248*^9}, {3.695147828169773*^9, 3.695147832089531*^9}, {
   3.695147889338893*^9, 3.6951480286289062`*^9}, {3.695148916900036*^9, 
   3.6951489272427692`*^9}, {3.695148968284731*^9, 3.6951490636376677`*^9}, {
   3.695152560803286*^9, 3.695152660419541*^9}, {3.695296193742441*^9, 
   3.695296241076809*^9}, {3.6953081683410807`*^9, 3.695308331991477*^9}, {
   3.695308365636876*^9, 3.6953083926643667`*^9}, {3.695308422850751*^9, 
   3.6953084620596123`*^9}, {3.6953192360198393`*^9, 3.695319261451314*^9}, {
   3.6954856302757807`*^9, 3.695485795085445*^9}, {3.69837160744366*^9, 
   3.698371680756713*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Recombination probabilities for different arrangements of loci\
\>", "Subsubsection",
 CellChangeTimes->{{3.6951462034340267`*^9, 3.695146215368688*^9}, {
  3.695158518509029*^9, 3.69515852830969*^9}, {3.696696371132297*^9, 
  3.6966963733241158`*^9}}],

Cell["\<\
Let the probability of recombination (an odd number of cross-overs) between \
loci A and X be r, the probability of recombination between A and M be R, and \
the probability of recombination between X and M be \[Chi]. \
\>", "Text",
 CellChangeTimes->{{3.6951498188995733`*^9, 3.6951498768084497`*^9}, {
  3.695150045047242*^9, 3.695150115083332*^9}, {3.695408396146262*^9, 
  3.6954084332185497`*^9}}],

Cell["We can then write, in general,", "Text",
 CellChangeTimes->{{3.695408439003786*^9, 3.6954084684446087`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"recGen", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"recAXnotAM", "\[Rule]", 
      FractionBox[
       RowBox[{"r", "+", "\[Chi]", "-", "R"}], "2"]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"recAMnotAX", "\[Rule]", 
      FractionBox[
       RowBox[{"R", "+", "\[Chi]", "-", "r"}], "2"]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"recAXandAM", "\[Rule]", 
      FractionBox[
       RowBox[{"r", "+", "R", "-", "\[Chi]"}], "2"]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.695322414958308*^9, 3.6953225169844112`*^9}, {
  3.695324078272975*^9, 3.6953240785539303`*^9}, {3.69540340480464*^9, 
  3.695403444455276*^9}, {3.695403480136647*^9, 3.695403508563278*^9}, {
  3.6954084578240433`*^9, 3.695408462413484*^9}}],

Cell["\<\
and for specific orders of loci we can substitute in the value of \[Chi] \
(alternatively one could do the same for R or r)\
\>", "Text",
 CellChangeTimes->{{3.695408463908675*^9, 3.695408500798313*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"\[Chi]AXM", "=", 
   RowBox[{"\[Chi]", "\[Rule]", 
    RowBox[{
     RowBox[{"R", 
      RowBox[{"(", 
       RowBox[{"1", "-", "r"}], ")"}]}], "+", 
     RowBox[{"r", 
      RowBox[{"(", 
       RowBox[{"1", "-", "R"}], ")"}]}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]XAM", "=", 
   RowBox[{"\[Chi]", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"r", "-", "R"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "R"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"\[Chi]XMA", "=", 
   RowBox[{"\[Chi]", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"R", "-", "r"}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", "r"}]}], ")"}]}]}]}], ";"}]}], "Input"]
}, Closed]]
}, Closed]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Resident equilibrium (weak selection)", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9, {3.675889497088314*^9, 3.675889497307007*^9}, {
   3.675897573374775*^9, 3.675897575830624*^9}, {3.675897716718397*^9, 
   3.6758977222283363`*^9}, 3.676682250170936*^9, 3.676682959070333*^9, {
   3.6767193867939043`*^9, 3.676719388460558*^9}, {3.6785484984643793`*^9, 
   3.678548500198676*^9}, {3.67875273051103*^9, 3.678752732829526*^9}, {
   3.678768538688073*^9, 3.6787685439131317`*^9}}],

Cell["\<\
We begin with no mutations at the modifer locus and convert to variables \
describing the frequency of A in each type of haploid (e.g., pXZhom is the \
frequency of A on the X or Z in the homogametic sex), as well as the \
frequency of the hemizygous allele (Y or W) in haploids from the \
heterogametic sex (freqYWhet)\
\>", "Text",
 CellChangeTimes->{{3.681790894519829*^9, 3.6817909035331917`*^9}, {
  3.6984146439800787`*^9, 3.6984147421885242`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subequil", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "A", ",", "M", ",", "hom"}]], "\[Rule]", "pXZhom"}],
      ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "a", ",", "M", ",", "hom"}]], "\[Rule]", 
      RowBox[{"1", "-", "pXZhom"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "A", ",", "M", ",", "het"}]], "\[Rule]", 
      RowBox[{"pXZhet", " ", "*", 
       RowBox[{"(", 
        RowBox[{"1", "-", "freqYWhet"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"XZ", ",", "a", ",", "M", ",", "het"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pXZhet"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "freqYWhet"}], ")"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]], "\[Rule]", 
      RowBox[{"pYWhet", " ", "freqYWhet"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "a", ",", "M", ",", "het"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pYWhet"}], ")"}], "freqYWhet"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"x_", ",", "y_", ",", "m", ",", "sex_"}]], "\[Rule]", "0"}], 
     ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"YW", ",", "y_", ",", "M", ",", "hom"}]], "\[Rule]", "0"}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681744168796749*^9, 3.681744285955284*^9}, {
  3.681744456703849*^9, 3.68174446046725*^9}, {3.681744512032195*^9, 
  3.681744517689509*^9}, {3.681745250079322*^9, 3.681745268071438*^9}, {
  3.681790148659374*^9, 3.681790165932436*^9}, {3.685447049829194*^9, 
  3.685447083554977*^9}, {3.685447504158259*^9, 3.685447510415009*^9}, {
  3.686380638637718*^9, 3.686380657187717*^9}, {3.698371547172111*^9, 
  3.698371560825038*^9}, {3.698414557097672*^9, 3.698414630606821*^9}}],

Cell["\<\
We now wish to solve for the equilibrium frequencies of the haploid genotypes \
in gametes of each sex. Equilibrium is achieved when the following three \
equations are zero\
\>", "Text",
 CellChangeTimes->{{3.675694155902801*^9, 3.675694193760104*^9}, {
   3.6756944337868023`*^9, 3.6756944351881227`*^9}, {3.6757029847267847`*^9, 
   3.67570303405547*^9}, {3.675710696458521*^9, 3.675710706286772*^9}, 
   3.6758975924118633`*^9, {3.676719416278571*^9, 3.676719460360141*^9}, {
   3.678763369210025*^9, 3.678763372346648*^9}, 3.686831925632285*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["fHapNext", 
               RowBox[{"XZ", ",", "A", ",", "M", ",", "hom"}]], "-", 
              SubscriptBox["fHap", 
               RowBox[{"XZ", ",", "A", ",", "M", ",", "hom"}]]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["fHapNext", 
               RowBox[{"XZ", ",", "A", ",", "M", ",", "het"}]], "-", 
              SubscriptBox["fHap", 
               RowBox[{"XZ", ",", "A", ",", "M", ",", "het"}]]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["fHapNext", 
               RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]], "-", 
              SubscriptBox["fHap", 
               RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]], "+", 
                SubscriptBox["fHapNext", 
                 RowBox[{"YW", ",", "a", ",", "M", ",", "het"}]]}], ")"}], 
              "-", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["fHap", 
                 RowBox[{"YW", ",", "A", ",", "M", ",", "het"}]], "+", 
                SubscriptBox["fHap", 
                 RowBox[{"YW", ",", "a", ",", "M", ",", "het"}]]}], ")"}]}]}],
             "\[IndentingNewLine]", "}"}], "/.", "subequil"}], "/.", 
          "sumsex"}], "/.", "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.",
       "pseg2"}], "/.", "pseg3"}], "/.", "pseg4"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678750179056045*^9, 3.678750265971582*^9}, 
   3.6787516566515017`*^9, {3.681789829427744*^9, 3.68178992075916*^9}, 
   3.681891166870421*^9, {3.686380671924355*^9, 3.686380710269143*^9}, {
   3.686380907602208*^9, 3.6863809079182463`*^9}, {3.6983715046921463`*^9, 
   3.6983715258890343`*^9}, {3.698414752724012*^9, 3.6984147758719*^9}}],

Cell["\<\
To simplify the analysis we assume weak selection in both haploids and \
diploids and weak meiotic drive. In addition, we assume selection acts on the \
VS locus only\
\>", "Text",
 CellChangeTimes->{{3.675694205010009*^9, 3.675694211923259*^9}, 
   3.67570298472752*^9, {3.6757030454432507`*^9, 3.6757030568360033`*^9}, {
   3.678750297640636*^9, 3.678750297774932*^9}, {3.678750454508356*^9, 
   3.6787504833762913`*^9}, {3.685447574297616*^9, 3.6854475782461767`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weaksel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "sex_"}]], "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["sHap", "sex"], " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "sex_"}]], "\[Rule]", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "A", ",", "sex_"}]], "\[Rule]", 
      RowBox[{"1", "+", " ", 
       RowBox[{
        SubscriptBox["sDip", "sex"], " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "sex_"}]], "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["h", "sex"], " ", 
        SubscriptBox["sDip", "sex"], " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "sex_"}]], "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["h", "sex"], " ", 
        SubscriptBox["sDip", "sex"], " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "a", ",", "sex_"}]], "\[Rule]", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["\[Alpha]", "sex_"], "\[Rule]", 
      RowBox[{
       RowBox[{"1", "/", "2"}], "+", 
       RowBox[{
        SubscriptBox["\[Alpha]1", "sex"], " ", 
        RowBox[{"\[Epsilon]", "/", "2"}]}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.67564806523287*^9, 3.675648221558539*^9}, {
   3.675694367971285*^9, 3.6756943845803022`*^9}, 3.6757029847280283`*^9, {
   3.678750304645768*^9, 3.67875045056485*^9}, {3.678750489500865*^9, 
   3.6787505048047533`*^9}, {3.6787505350519323`*^9, 3.678750613437016*^9}, {
   3.678750650976028*^9, 3.678750663356496*^9}, {3.6787515109746723`*^9, 
   3.678751549594288*^9}, {3.681789961959874*^9, 3.6817900838735647`*^9}, {
   3.6838168666712627`*^9, 3.68381687442684*^9}, {3.6854475805614653`*^9, 
   3.685447599782713*^9}, {3.6854485192754717`*^9, 3.685448531484398*^9}, {
   3.686831932425375*^9, 3.686831943171628*^9}, {3.69515684949865*^9, 
   3.695156856809911*^9}}],

Cell["We can write the frequencies as Taylor series", "Text",
 CellChangeTimes->{{3.675707045047565*^9, 3.6757070543930063`*^9}, {
  3.675707367038864*^9, 3.675707370179316*^9}, {3.675711803871513*^9, 
  3.6757118112225847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frequenciessub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pXZhom", "\[Rule]", 
      RowBox[{"pXZhom0", "+", 
       RowBox[{"pXZhom1", " ", "\[Epsilon]"}], "+", 
       RowBox[{"pXZhom2", "*", 
        RowBox[{"\[Epsilon]", "^", "2"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pXZhet", "\[Rule]", 
      RowBox[{"pXZhet0", "+", 
       RowBox[{"pXZhet1", " ", "\[Epsilon]"}], "+", 
       RowBox[{"pXZhet2", "*", 
        RowBox[{"\[Epsilon]", "^", "2"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pYWhet", "\[Rule]", 
      RowBox[{"pYWhet0", "+", 
       RowBox[{"pYWhet1", " ", "\[Epsilon]"}], "+", 
       RowBox[{"pYWhet2", "*", 
        RowBox[{"\[Epsilon]", "^", "2"}]}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"freqYWhet", "\[Rule]", 
      RowBox[{"freqYWhet0", "+", 
       RowBox[{"freqYWhet1", " ", "\[Epsilon]"}], "+", 
       RowBox[{"freqYWhet2", "*", 
        RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675648297857716*^9, 3.6756483630660057`*^9}, 
   3.675648454638584*^9, 3.675702984736863*^9, {3.67589080409908*^9, 
   3.675890831274033*^9}, {3.67742655090767*^9, 3.677426553274468*^9}, {
   3.686380728527544*^9, 3.686380755556176*^9}, 3.6868343709397306`*^9, {
   3.698414789856226*^9, 3.698414839771706*^9}, {3.6984148746530647`*^9, 
   3.698414893317882*^9}}],

Cell["\<\
Without selection the recursions for the change in the frequencies are\
\>", "Text",
 CellChangeTimes->{{3.6757032054455214`*^9, 3.6757032697493563`*^9}, {
  3.6757098202812138`*^9, 3.675709824765788*^9}, {3.6757117765596933`*^9, 
  3.6757117850524673`*^9}, {3.675711818872109*^9, 3.6757118199810133`*^9}, {
  3.676719491260041*^9, 3.676719499308044*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs0", "=", 
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", "frequenciessub"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}]}]], "Input",
 CellChangeTimes->{{3.678751736367395*^9, 3.678751737467704*^9}, {
   3.678752209413887*^9, 3.678752212219976*^9}, 3.678752262803892*^9, {
   3.685447468281103*^9, 3.685447470446783*^9}, {3.6854475253827333`*^9, 
   3.685447570892086*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"pXZhet0", "-", "pXZhom0"}], "2"], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "pXZhet0"}], "+", 
      RowBox[{"2", " ", "freqYWhet0", " ", "pXZhet0"}], "+", "pXZhom0", "-", 
      RowBox[{"pXZhom0", " ", "recAXandAM"}], "+", 
      RowBox[{"pYWhet0", " ", "recAXandAM"}], "-", 
      RowBox[{"pXZhom0", " ", "recAXnotAM"}], "+", 
      RowBox[{"pYWhet0", " ", "recAXnotAM"}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"pYWhet0", "-", 
      RowBox[{"2", " ", "freqYWhet0", " ", "pYWhet0"}], "+", 
      RowBox[{"pXZhom0", " ", "recAXandAM"}], "-", 
      RowBox[{"pYWhet0", " ", "recAXandAM"}], "+", 
      RowBox[{"pXZhom0", " ", "recAXnotAM"}], "-", 
      RowBox[{"pYWhet0", " ", "recAXnotAM"}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"1", "-", 
      RowBox[{"2", " ", "freqYWhet0"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.67875164051635*^9, {3.678751716032783*^9, 3.6787517378070927`*^9}, 
   3.6787520627432127`*^9, 3.678752212888122*^9, 3.6787523426840563`*^9, 
   3.6787534142533073`*^9, 3.678763399028235*^9, 3.6787637498048763`*^9, 
   3.6787649279812727`*^9, 3.678769190501109*^9, 3.67993779987945*^9, 
   3.681790093930011*^9, 3.681790177016839*^9, 3.6817903134721537`*^9, 
   3.681790666763077*^9, 3.6818910310375347`*^9, 3.681891176521256*^9, 
   3.681897653546867*^9, 3.682049536847906*^9, 3.682133260044132*^9, 
   3.682144710656866*^9, 3.682920602235833*^9, 3.683816896620468*^9, 
   3.685447428394968*^9, 3.685447470963046*^9, {3.685447518239092*^9, 
   3.685447551041255*^9}, 3.68544760753404*^9, {3.685448523510034*^9, 
   3.685448534771299*^9}, 3.685714880361951*^9, 3.6858548020016737`*^9, {
   3.685856125479251*^9, 3.685856140079173*^9}, 3.685856182461566*^9, 
   3.685878963778384*^9, 3.6859368719441833`*^9, 3.6863807719980593`*^9, 
   3.6863809124378767`*^9, 3.686831955041347*^9, 3.6868320265653067`*^9, {
   3.686834394784305*^9, 3.686834403684424*^9}, 3.686890426277944*^9, 
   3.686903523929381*^9, 3.6869073622023563`*^9, 3.686907829512693*^9, 
   3.687623269532193*^9, 3.6911889675025797`*^9, 3.691198105514596*^9, 
   3.6912451623854227`*^9, 3.6912476726452847`*^9, 3.6912482724499187`*^9, 
   3.691327419174513*^9, 3.692542508934903*^9, 3.692605925609705*^9, 
   3.6926088975757523`*^9, 3.692613124578062*^9, 3.6927928280311623`*^9, 
   3.693566053383974*^9, 3.695053766993713*^9, 3.695054437717229*^9, 
   3.6951409743607893`*^9, 3.695147553564856*^9, 3.6951481179736967`*^9, 
   3.695149149645761*^9, 3.695152971019541*^9, 3.695156861482819*^9, 
   3.695220448429015*^9, 3.695222127299662*^9, 3.695295631755416*^9, 
   3.695301364294076*^9, 3.69530299086401*^9, 3.695308510870699*^9, 
   3.695315497833684*^9, 3.6953163698151093`*^9, 3.695319282328319*^9, 
   3.6953204581181717`*^9, 3.695322548948823*^9, 3.695392504621414*^9, 
   3.6953980050977716`*^9, 3.695408683490018*^9, 3.697149196582917*^9, 
   3.697149600197008*^9, 3.697149637115164*^9, 3.6971497383137083`*^9, 
   3.6971497721866493`*^9, {3.6971498088643713`*^9, 3.697149824172112*^9}, 
   3.6971503328339157`*^9, 3.697151353416005*^9, 3.6971618932075567`*^9, 
   3.6971621614787416`*^9, 3.697983993475668*^9, 3.69837153358043*^9, 
   3.6983715696507607`*^9, 3.698371690882296*^9, 3.698371750541999*^9, {
   3.69837179449718*^9, 3.698371814851795*^9}, 3.698414844439608*^9, 
   3.69841489494729*^9, 3.7156894521407433`*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675709831409095*^9, 3.6757098343025913`*^9}, {
  3.675710744701475*^9, 3.675710745621426*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"differenceEqs0", "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"pYWhet0", ",", "pXZhet0", ",", "freqYWhet0"}], "}"}]}], "]"}], 
   "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675709931730151*^9, 3.675709948227565*^9}, 
   3.675889715650866*^9, {3.6758903329476337`*^9, 3.675890333531021*^9}, {
   3.675890856683935*^9, 3.6758908599323187`*^9}, {3.678751782137336*^9, 
   3.678751811045862*^9}, 3.678753423267188*^9, {3.6817902045515413`*^9, 
   3.6817902078071213`*^9}, 3.681790677257793*^9, {3.681790714315344*^9, 
   3.6817907157750397`*^9}, {3.68544745791882*^9, 3.68544746435682*^9}, {
   3.6858560310190287`*^9, 3.685856068556876*^9}, {3.686380916208851*^9, 
   3.68638092846062*^9}, {3.695147612742502*^9, 3.69514761466743*^9}, 
   3.6951481231012707`*^9, {3.697149711499078*^9, 3.697149715752687*^9}, {
   3.6984148511242113`*^9, 3.698414869811221*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"pYWhet0", "\[Rule]", "pXZhom0"}], ",", 
   RowBox[{"pXZhet0", "\[Rule]", "pXZhom0"}], ",", 
   RowBox[{"freqYWhet0", "\[Rule]", 
    FractionBox["1", "2"]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6757098363525476`*^9, {3.6757099323567266`*^9, 3.675709948639193*^9}, 
   3.675727587389184*^9, 3.675785430130021*^9, 3.67578825590738*^9, 
   3.675889716378837*^9, 3.6758897866812677`*^9, {3.67589020611733*^9, 
   3.675890228462432*^9}, 3.675890334827342*^9, {3.675890851304111*^9, 
   3.675890860292238*^9}, 3.675897787493493*^9, 3.676652896317733*^9, 
   3.676719506219842*^9, 3.676730785030355*^9, 3.676747313194071*^9, 
   3.677426559438837*^9, 3.677594780023625*^9, 3.677957827657529*^9, 
   3.6782088645287457`*^9, 3.678542901403359*^9, 3.678546799300796*^9, {
   3.678751779484501*^9, 3.678751811553813*^9}, 3.67875206282722*^9, 
   3.67875221532375*^9, 3.6787523427641783`*^9, {3.678753416169854*^9, 
   3.678753423756329*^9}, 3.6787633990548487`*^9, 3.678763749842856*^9, 
   3.678764928017548*^9, 3.6787691905324583`*^9, 3.679937799964304*^9, {
   3.6817901817371817`*^9, 3.681790208510619*^9}, 3.681790313605155*^9, {
   3.681790666911725*^9, 3.681790677661216*^9}, 3.681790716129882*^9, 
   3.681891031269878*^9, 3.6818911789722967`*^9, 3.681897653588698*^9, 
   3.68204953688428*^9, 3.682133260085647*^9, 3.682144710692371*^9, 
   3.682920602269578*^9, 3.6838168987110786`*^9, {3.685447443795883*^9, 
   3.685447473562731*^9}, {3.6854475212148733`*^9, 3.68544755601586*^9}, 
   3.6854476094171667`*^9, {3.68544852733103*^9, 3.6854485372973547`*^9}, 
   3.6857148803900003`*^9, 3.685854802040399*^9, {3.685856031374407*^9, 
   3.68585606942542*^9}, 3.68585612551685*^9, 3.685856184832107*^9, 
   3.685878966939124*^9, 3.685936871979721*^9, {3.686380924739902*^9, 
   3.686380928972653*^9}, 3.686831962092031*^9, 3.6868320297453213`*^9, 
   3.686834397334124*^9, 3.6868904263215837`*^9, 3.686903524073765*^9, 
   3.686907362243144*^9, 3.6869078295426683`*^9, 3.687623269578989*^9, 
   3.691188967596525*^9, 3.69119810555093*^9, 3.691245162421948*^9, 
   3.6912476726792183`*^9, 3.6912482724868526`*^9, 3.6913274192262173`*^9, 
   3.6925425090039253`*^9, 3.692605925913631*^9, 3.692608897643393*^9, 
   3.692613124634487*^9, 3.692792828335712*^9, 3.693566053748837*^9, 
   3.695053768567173*^9, 3.695054437752605*^9, 3.695140976715064*^9, 
   3.695147566019754*^9, 3.695147615162827*^9, 3.6951481235098763`*^9, 
   3.695149152213373*^9, 3.695152971052154*^9, 3.69515686292342*^9, 
   3.69522044847016*^9, 3.695222127348042*^9, 3.695295631803527*^9, 
   3.695301364343553*^9, 3.695302990913575*^9, 3.695308510913556*^9, 
   3.695315497883857*^9, 3.695316369862607*^9, 3.695319282377275*^9, 
   3.6953204581508408`*^9, 3.695322548987134*^9, 3.695392504675274*^9, 
   3.695398005127637*^9, 3.695408683528782*^9, 3.697149196630734*^9, 
   3.697149605461795*^9, {3.697149711972267*^9, 3.6971497162689447`*^9}, 
   3.697150335050105*^9, 3.6971513562368393`*^9, 3.697161893247745*^9, 
   3.697162161520817*^9, 3.697983993514518*^9, 3.698371816875565*^9, {
   3.698414859447761*^9, 3.698414896451705*^9}, 3.715689452175922*^9}]
}, Open  ]],

Cell["\<\
So, with no selection or drive, the equilibrium frequency of A in each gamete \
type is equal (and we call this pA) and half of gametes from the hetermorphic \
sex carry the hemizygous SD allele (Y or W).\
\>", "Text",
 CellChangeTimes->{{3.675703427939505*^9, 3.6757035626138153`*^9}, {
   3.675706719194449*^9, 3.675706765062245*^9}, 3.67570996472328*^9, {
   3.6757107664993973`*^9, 3.675710849444377*^9}, {3.685447612838414*^9, 
   3.6854476142224197`*^9}, {3.686832040078635*^9, 3.686832055989235*^9}, {
   3.698371889386381*^9, 3.698371906407825*^9}, {3.698414913302499*^9, 
   3.698414923278223*^9}}],

Cell["\<\
Now, looking at only the first order selection terms, the recursions for the \
change in frequency of A in each gamete type are\
\>", "Text",
 CellChangeTimes->{{3.67570356712366*^9, 3.675703572187316*^9}, {
   3.67570609431063*^9, 3.675706097287983*^9}, {3.6757069069525433`*^9, 
   3.6757069072532797`*^9}, {3.67571091918222*^9, 3.6757109367564697`*^9}, {
   3.675711772412171*^9, 3.67571177325072*^9}, {3.675716463608975*^9, 
   3.67571647265489*^9}, 3.698414951609725*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
      ",", "\[Epsilon]", ",", "Factor"}], "]"}], "/.", 
    RowBox[{"pXZhom0", "\[Rule]", "pA"}]}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757068495866413`*^9, 3.6757068907711554`*^9}, {
   3.6757069302403297`*^9, 3.675706982461239*^9}, {3.675707087605297*^9, 
   3.6757071228419533`*^9}, {3.67570718969317*^9, 3.675707319107386*^9}, {
   3.675707511314725*^9, 3.675707512612761*^9}, {3.675710885258552*^9, 
   3.675710885357044*^9}, {3.675711221036006*^9, 3.675711227798399*^9}, {
   3.675788237526182*^9, 3.6757882495037823`*^9}, {3.67588983758741*^9, 
   3.675889846791771*^9}, {3.675890066524867*^9, 3.67589008440499*^9}, {
   3.675890872602395*^9, 3.6758908784129057`*^9}, 3.675891388889962*^9, 
   3.675897774490415*^9, 3.6774265727397633`*^9, {3.678752346006524*^9, 
   3.678752347228713*^9}, {3.695147684754757*^9, 3.695147687167241*^9}, 
   3.695148132471127*^9, 3.698414939044693*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{"pXZhet1", "-", "pXZhom1", "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sDip", "hom"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["sDip", "hom"]}], "+", 
      RowBox[{"2", " ", "pA", " ", 
       SubscriptBox["h", "hom"], " ", 
       SubscriptBox["sDip", "hom"]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["h", "hom"], " ", 
       SubscriptBox["sDip", "hom"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["h", "hom"], " ", 
       SubscriptBox["sDip", "hom"]}], "+", 
      RowBox[{"pA", " ", 
       SubscriptBox["sHap", "het"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "het"]}], "+", 
      RowBox[{"pA", " ", 
       SubscriptBox["sHap", "hom"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "hom"]}], "+", 
      RowBox[{"2", " ", "pA", " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "freqYWhet1", " ", "pA"}], "-", "pXZhet1", "+", 
      "pXZhom1", "-", 
      RowBox[{"pXZhom1", " ", "recAXandAM"}], "+", 
      RowBox[{"pYWhet1", " ", "recAXandAM"}], "-", 
      RowBox[{"pXZhom1", " ", "recAXnotAM"}], "+", 
      RowBox[{"pYWhet1", " ", "recAXnotAM"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sDip", "het"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["sDip", "het"]}], "+", 
      RowBox[{"pA", " ", 
       SubscriptBox["h", "het"], " ", 
       SubscriptBox["sDip", "het"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["h", "het"], " ", 
       SubscriptBox["sDip", "het"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["h", "het"], " ", 
       SubscriptBox["sDip", "het"]}], "+", 
      RowBox[{"pA", " ", "recAXandAM", " ", 
       SubscriptBox["sHap", "het"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "recAXandAM", " ", 
       SubscriptBox["sHap", "het"]}], "+", 
      RowBox[{"pA", " ", "recAXnotAM", " ", 
       SubscriptBox["sHap", "het"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "recAXnotAM", " ", 
       SubscriptBox["sHap", "het"]}], "+", 
      RowBox[{"pA", " ", 
       SubscriptBox["sHap", "hom"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "hom"]}], "-", 
      RowBox[{"pA", " ", "recAXandAM", " ", 
       SubscriptBox["sHap", "hom"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "recAXandAM", " ", 
       SubscriptBox["sHap", "hom"]}], "-", 
      RowBox[{"pA", " ", "recAXnotAM", " ", 
       SubscriptBox["sHap", "hom"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "recAXnotAM", " ", 
       SubscriptBox["sHap", "hom"]}], "+", 
      RowBox[{"pA", " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "freqYWhet1", " ", "pA"}], "+", 
      RowBox[{"pXZhom1", " ", "recAXandAM"}], "-", 
      RowBox[{"pYWhet1", " ", "recAXandAM"}], "+", 
      RowBox[{"pXZhom1", " ", "recAXnotAM"}], "-", 
      RowBox[{"pYWhet1", " ", "recAXnotAM"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sDip", "het"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["sDip", "het"]}], "+", 
      RowBox[{"pA", " ", 
       SubscriptBox["h", "het"], " ", 
       SubscriptBox["sDip", "het"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["h", "het"], " ", 
       SubscriptBox["sDip", "het"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["h", "het"], " ", 
       SubscriptBox["sDip", "het"]}], "+", 
      RowBox[{"pA", " ", 
       SubscriptBox["sHap", "het"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "het"]}], "-", 
      RowBox[{"pA", " ", "recAXandAM", " ", 
       SubscriptBox["sHap", "het"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "recAXandAM", " ", 
       SubscriptBox["sHap", "het"]}], "-", 
      RowBox[{"pA", " ", "recAXnotAM", " ", 
       SubscriptBox["sHap", "het"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "recAXnotAM", " ", 
       SubscriptBox["sHap", "het"]}], "+", 
      RowBox[{"pA", " ", "recAXandAM", " ", 
       SubscriptBox["sHap", "hom"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "recAXandAM", " ", 
       SubscriptBox["sHap", "hom"]}], "+", 
      RowBox[{"pA", " ", "recAXnotAM", " ", 
       SubscriptBox["sHap", "hom"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "recAXnotAM", " ", 
       SubscriptBox["sHap", "hom"]}], "+", 
      RowBox[{"pA", " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}]}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", "freqYWhet1"}], " ", "\[Epsilon]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675706852317442*^9, 3.675706918829287*^9}, {
   3.675706950931774*^9, 3.675706982932413*^9}, {3.6757070910767508`*^9, 
   3.675707123327277*^9}, {3.6757071925330353`*^9, 3.675707319486848*^9}, 
   3.675707513296742*^9, 3.67570768217498*^9, {3.675710857628578*^9, 
   3.675710885875184*^9}, {3.675711222477412*^9, 3.67571122814371*^9}, 
   3.67572758892033*^9, 3.675785431200643*^9, 3.6757882566822844`*^9, {
   3.6758898385316772`*^9, 3.675889853071372*^9}, 3.67589008578434*^9, 
   3.675890878782188*^9, 3.6758913896085997`*^9, 3.675897788776071*^9, 
   3.676652896382719*^9, 3.676719670536849*^9, 3.676730785076564*^9, 
   3.676747313246613*^9, {3.677426569551004*^9, 3.677426573382222*^9}, 
   3.677426845387473*^9, 3.677594780245098*^9, 3.6779578277133617`*^9, 
   3.678208864583046*^9, 3.678542901470283*^9, 3.678546799332457*^9, 
   3.67875235287332*^9, 3.67875342792347*^9, 3.678763399188438*^9, 
   3.678763749972834*^9, 3.678764928153727*^9, 3.678769190664701*^9, 
   3.679937800139977*^9, 3.6817903137542667`*^9, 3.681790666984543*^9, 
   3.681790718133628*^9, 3.6818910339655*^9, 3.681891180964037*^9, 
   3.6818976536741257`*^9, 3.682049536979245*^9, 3.682133260162579*^9, 
   3.6821447107713137`*^9, 3.682920602347398*^9, 3.6838169016427097`*^9, 
   3.685447621692202*^9, 3.68544854176237*^9, 3.685714880495698*^9, 
   3.68585480208704*^9, 3.685856125584722*^9, 3.685878969577038*^9, 
   3.6859368720690393`*^9, 3.686380938571844*^9, 3.686832061687167*^9, 
   3.6868344057774553`*^9, 3.6868904264251833`*^9, 3.6869035242086267`*^9, 
   3.686907362347149*^9, 3.6869078296999826`*^9, 3.687623269682755*^9, 
   3.691188967715625*^9, 3.691198105657494*^9, 3.6912451625350246`*^9, 
   3.691247672787588*^9, 3.6912482725992804`*^9, 3.69132741933954*^9, 
   3.6925425091658163`*^9, 3.69260592599305*^9, 3.692608897720051*^9, 
   3.6926131247107573`*^9, 3.692792828416999*^9, 3.693566054024653*^9, 
   3.69505376989566*^9, 3.695054437790783*^9, 3.695140980821327*^9, 
   3.695147649207181*^9, 3.695147687680698*^9, 3.695148132932829*^9, 
   3.695149153588661*^9, 3.695152971137844*^9, 3.695156864175723*^9, 
   3.6952204485928307`*^9, 3.69522212746946*^9, 3.695295631933179*^9, 
   3.695301364457165*^9, 3.6953029910277147`*^9, 3.6953085110284348`*^9, 
   3.6953154979996643`*^9, 3.69531636999629*^9, 3.695319282495563*^9, 
   3.695320458264676*^9, 3.695322549106007*^9, 3.695392504797521*^9, 
   3.695398005219429*^9, 3.6954086836255608`*^9, 3.697149196757021*^9, 
   3.697150337474085*^9, 3.697151361218339*^9, 3.6971618933558817`*^9, 
   3.697162161633811*^9, 3.6979839936903343`*^9, 3.698371820742393*^9, {
   3.698414930665928*^9, 3.698414939776182*^9}, 3.715689452271307*^9}]
}, Open  ]],

Cell["\<\
And from these three equations we can solve for the two of the first order \
differences and the mean frequency of A\
\>", "Text",
 CellChangeTimes->{{3.678752531664937*^9, 3.678752562395914*^9}, {
  3.6838166832997313`*^9, 3.683816691426601*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"realsol", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "\[Equal]", "0"}], "/.", 
       RowBox[{"pXZhet1", "\[Rule]", 
        RowBox[{"dpAXZhetXZhom", "+", "pXZhom1"}]}]}], "/.", 
      RowBox[{"pYWhet1", "\[Rule]", 
       RowBox[{"dpAYWhetXZhom", "+", "pXZhom1"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{
      "dpAXZhetXZhom", ",", "dpAYWhetXZhom", ",", "pA", ",", "freqYWhet1"}], 
      "}"}]}], "]"}], "//", "Factor"}]}]], "Input",
 CellChangeTimes->{{3.678752380284935*^9, 3.678752415079105*^9}, {
  3.678752448870285*^9, 3.6787525243231792`*^9}, {3.678766520981015*^9, 
  3.678766522387198*^9}, {3.686380944234239*^9, 3.6863809477391853`*^9}, {
  3.6928110591249027`*^9, 3.692811126362007*^9}, {3.698414959986412*^9, 
  3.6984150550994673`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpAXZhetXZhom", "\[Rule]", "0"}], ",", 
     RowBox[{"dpAYWhetXZhom", "\[Rule]", "0"}], ",", 
     RowBox[{"pA", "\[Rule]", "0"}], ",", 
     RowBox[{"freqYWhet1", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpAXZhetXZhom", "\[Rule]", "0"}], ",", 
     RowBox[{"dpAYWhetXZhom", "\[Rule]", "0"}], ",", 
     RowBox[{"pA", "\[Rule]", "1"}], ",", 
     RowBox[{"freqYWhet1", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpAXZhetXZhom", "\[Rule]", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["sDip", "het"]}], "+", 
            RowBox[{
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"]}], "-", 
            SubscriptBox["sDip", "hom"], "+", 
            RowBox[{
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"]}], "-", 
            SubscriptBox["sHap", "het"], "-", 
            SubscriptBox["sHap", "hom"], "-", 
            SubscriptBox["\[Alpha]1", "het"], "-", 
            SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"]}], "+", 
            RowBox[{
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"]}], "+", 
            SubscriptBox["sHap", "het"], "+", 
            SubscriptBox["sHap", "hom"], "+", 
            SubscriptBox["\[Alpha]1", "het"], "+", 
            SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sDip", "hom"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sDip", "hom"]}], "-", 
            RowBox[{
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "het"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "het"]}], "+", 
            RowBox[{
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "het"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "het"]}], "-", 
            RowBox[{
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "hom"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "hom"]}], "+", 
            RowBox[{
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "hom"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "hom"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["\[Alpha]1", "het"]}], "-", 
            RowBox[{"4", " ", 
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["\[Alpha]1", "het"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["\[Alpha]1", "hom"]}], "+", 
            RowBox[{"4", " ", 
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}], ")"}], "/", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["sDip", "het"]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "het"], " ", 
            SubscriptBox["sDip", "het"]}], "-", 
           SubscriptBox["sDip", "hom"], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"]}]}], ")"}], "3"]}]}]}], ",", 
     RowBox[{"dpAYWhetXZhom", "\[Rule]", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["sDip", "het"]}], "+", 
            RowBox[{
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"]}], "-", 
            SubscriptBox["sDip", "hom"], "+", 
            RowBox[{
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"]}], "-", 
            SubscriptBox["sHap", "het"], "-", 
            SubscriptBox["sHap", "hom"], "-", 
            SubscriptBox["\[Alpha]1", "het"], "-", 
            SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"]}], "+", 
            RowBox[{
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"]}], "+", 
            SubscriptBox["sHap", "het"], "+", 
            SubscriptBox["sHap", "hom"], "+", 
            SubscriptBox["\[Alpha]1", "het"], "+", 
            SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sDip", "hom"]}], "-", 
            RowBox[{
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sDip", "hom"]}], "-", 
            RowBox[{"recAXandAM", " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "het"]}], "-", 
            RowBox[{"recAXnotAM", " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "het"]}], "+", 
            RowBox[{"2", " ", "recAXandAM", " ", 
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "het"]}], "+", 
            RowBox[{"2", " ", "recAXnotAM", " ", 
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "het"]}], "+", 
            RowBox[{
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "het"]}], "-", 
            RowBox[{"recAXandAM", " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "het"]}], "-", 
            RowBox[{"recAXnotAM", " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "het"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "het"]}], "+", 
            RowBox[{"2", " ", "recAXandAM", " ", 
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "het"]}], "+", 
            RowBox[{"2", " ", "recAXnotAM", " ", 
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "het"]}], "-", 
            RowBox[{
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "hom"]}], "+", 
            RowBox[{"recAXandAM", " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "hom"]}], "+", 
            RowBox[{"recAXnotAM", " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "hom"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "hom"]}], "-", 
            RowBox[{"2", " ", "recAXandAM", " ", 
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "hom"]}], "-", 
            RowBox[{"2", " ", "recAXnotAM", " ", 
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["sHap", "hom"]}], "+", 
            RowBox[{"recAXandAM", " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "hom"]}], "+", 
            RowBox[{"recAXnotAM", " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "hom"]}], "-", 
            RowBox[{"2", " ", "recAXandAM", " ", 
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "hom"]}], "-", 
            RowBox[{"2", " ", "recAXnotAM", " ", 
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["sHap", "hom"]}], "+", 
            RowBox[{
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["\[Alpha]1", "het"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"], " ", 
             SubscriptBox["\[Alpha]1", "het"]}], "-", 
            RowBox[{
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["\[Alpha]1", "hom"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"], " ", 
             SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SubscriptBox["sDip", "het"]}], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["h", "het"], " ", 
              SubscriptBox["sDip", "het"]}], "-", 
             SubscriptBox["sDip", "hom"], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["h", "hom"], " ", 
              SubscriptBox["sDip", "hom"]}]}], ")"}], "3"]}], ")"}]}]}]}], 
     ",", 
     RowBox[{"pA", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox["h", "het"], " ", 
         SubscriptBox["sDip", "het"]}], "+", 
        RowBox[{
         SubscriptBox["h", "hom"], " ", 
         SubscriptBox["sDip", "hom"]}], "+", 
        SubscriptBox["sHap", "het"], "+", 
        SubscriptBox["sHap", "hom"], "+", 
        SubscriptBox["\[Alpha]1", "het"], "+", 
        SubscriptBox["\[Alpha]1", "hom"]}], 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["sDip", "het"]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["h", "het"], " ", 
         SubscriptBox["sDip", "het"]}], "-", 
        SubscriptBox["sDip", "hom"], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["h", "hom"], " ", 
         SubscriptBox["sDip", "hom"]}]}]]}], ",", 
     RowBox[{"freqYWhet1", "\[Rule]", "0"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.678752482888706*^9, 3.678752493868231*^9}, 
   3.6787525257014627`*^9, 3.678753430914579*^9, 3.678763399415782*^9, 
   3.6787637502158213`*^9, 3.678764928395048*^9, 3.678766524870788*^9, 
   3.6787691909696217`*^9, 3.679937800442492*^9, 3.6817903138543177`*^9, {
   3.681790667017806*^9, 3.6817907228467083`*^9}, 3.68189115135784*^9, 
   3.68189118399726*^9, 3.681897653939054*^9, 3.682049537294879*^9, 
   3.68213326045788*^9, 3.682144711078505*^9, 3.682920602613758*^9, 
   3.683816905354411*^9, 3.685447628167561*^9, 3.685448544843561*^9, 
   3.685714880860889*^9, 3.685856000127783*^9, 3.685856134962605*^9, 
   3.685878972813949*^9, 3.6859368725143137`*^9, 3.6863809490071697`*^9, 
   3.6868320676469*^9, 3.68683440827794*^9, 3.686890426850154*^9, 
   3.6869035247257557`*^9, 3.686907362763823*^9, 3.686907830138443*^9, 
   3.687623270143525*^9, 3.691188968190778*^9, 3.6911981061379223`*^9, 
   3.691245162999505*^9, 3.6912476732226963`*^9, 3.691248273034999*^9, 
   3.69132741980119*^9, 3.692542509734453*^9, 3.6926059269738407`*^9, 
   3.6926088980779*^9, 3.692613124939826*^9, 3.692792828927919*^9, 
   3.6928110699242783`*^9, 3.6928111271918383`*^9, 3.693566054529848*^9, 
   3.695053771699424*^9, 3.695054438017572*^9, 3.695140982812886*^9, 
   3.6951481409675827`*^9, 3.6951491552181597`*^9, 3.695152971488411*^9, 
   3.695156869481044*^9, 3.695220449056795*^9, 3.69522213047709*^9, 
   3.695295632402067*^9, 3.695301364951103*^9, 3.695302991473467*^9, 
   3.695308511768276*^9, 3.695315498698923*^9, 3.695316370738523*^9, 
   3.695319283218627*^9, 3.695320459001512*^9, 3.6953225498672037`*^9, 
   3.695392505429982*^9, 3.695398005813242*^9, 3.695408684215993*^9, 
   3.697149197507669*^9, 3.697151363747428*^9, 3.697161894141564*^9, 
   3.697162162339226*^9, 3.697983994282826*^9, 3.698371831837737*^9, 
   3.6984150562951393`*^9, 3.7156894527276583`*^9}]
}, Open  ]],

Cell["\<\
Alternatively we can calculate the solution in terms of the difference in \
frequency of A between X(Z)-bearing and Y(W)-bearing gametes from the \
hetermorphic sex\
\>", "Text",
 CellChangeTimes->{{3.693569199386832*^9, 3.69356923596961*^9}, {
  3.695054167254216*^9, 3.695054183516561*^9}, {3.698371927766963*^9, 
  3.698371938973918*^9}, {3.698415068049705*^9, 3.6984150687518463`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"realsol2", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "\[Equal]", "0"}], "/.", 
       RowBox[{"pXZhom1", "\[Rule]", 
        RowBox[{"dpAXZhomXZhet", "+", "pXZhet1"}]}]}], "/.", 
      RowBox[{"pYWhet1", "\[Rule]", 
       RowBox[{"dpAYWhetXZhet", "+", "pXZhet1"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{
      "dpAXZhomXZhet", ",", "dpAYWhetXZhet", ",", "pA", ",", "freqYWhet1"}], 
      "}"}]}], "]"}], "//", "Factor"}]}]], "Input",
 CellChangeTimes->{
  3.6935692395122232`*^9, 3.6951481521452513`*^9, {3.69841507705812*^9, 
   3.698415144374938*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpAXZhomXZhet", "\[Rule]", "0"}], ",", 
     RowBox[{"dpAYWhetXZhet", "\[Rule]", "0"}], ",", 
     RowBox[{"pA", "\[Rule]", "0"}], ",", 
     RowBox[{"freqYWhet1", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpAXZhomXZhet", "\[Rule]", "0"}], ",", 
     RowBox[{"dpAYWhetXZhet", "\[Rule]", "0"}], ",", 
     RowBox[{"pA", "\[Rule]", "1"}], ",", 
     RowBox[{"freqYWhet1", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpAXZhomXZhet", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["sDip", "het"]}], "+", 
           RowBox[{
            SubscriptBox["h", "het"], " ", 
            SubscriptBox["sDip", "het"]}], "-", 
           SubscriptBox["sDip", "hom"], "+", 
           RowBox[{
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"]}], "-", 
           SubscriptBox["sHap", "het"], "-", 
           SubscriptBox["sHap", "hom"], "-", 
           SubscriptBox["\[Alpha]1", "het"], "-", 
           SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["h", "het"], " ", 
            SubscriptBox["sDip", "het"]}], "+", 
           RowBox[{
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"]}], "+", 
           SubscriptBox["sHap", "het"], "+", 
           SubscriptBox["sHap", "hom"], "+", 
           SubscriptBox["\[Alpha]1", "het"], "+", 
           SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SubscriptBox["h", "het"], " ", 
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["sDip", "hom"]}], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["sDip", "hom"]}], "-", 
           RowBox[{
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["sHap", "het"]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "het"], " ", 
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["sHap", "het"]}], "+", 
           RowBox[{
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["sHap", "het"]}], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["sHap", "het"]}], "-", 
           RowBox[{
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "het"], " ", 
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["sHap", "hom"]}], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "-", 
           RowBox[{"4", " ", 
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"4", " ", 
            SubscriptBox["h", "het"], " ", 
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}], ")"}], "/", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", 
           SubscriptBox["sDip", "het"]}], "+", 
          RowBox[{"2", " ", 
           SubscriptBox["h", "het"], " ", 
           SubscriptBox["sDip", "het"]}], "-", 
          SubscriptBox["sDip", "hom"], "+", 
          RowBox[{"2", " ", 
           SubscriptBox["h", "hom"], " ", 
           SubscriptBox["sDip", "hom"]}]}], ")"}], "3"]}]}], ",", 
     RowBox[{"dpAYWhetXZhet", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "recAXandAM"}], "+", 
           RowBox[{"2", " ", "recAXnotAM"}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["sDip", "het"]}], "+", 
           RowBox[{
            SubscriptBox["h", "het"], " ", 
            SubscriptBox["sDip", "het"]}], "-", 
           SubscriptBox["sDip", "hom"], "+", 
           RowBox[{
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"]}], "-", 
           SubscriptBox["sHap", "het"], "-", 
           SubscriptBox["sHap", "hom"], "-", 
           SubscriptBox["\[Alpha]1", "het"], "-", 
           SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["h", "het"], " ", 
            SubscriptBox["sDip", "het"]}], "+", 
           RowBox[{
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"]}], "+", 
           SubscriptBox["sHap", "het"], "+", 
           SubscriptBox["sHap", "hom"], "+", 
           SubscriptBox["\[Alpha]1", "het"], "+", 
           SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["h", "het"], " ", 
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["sDip", "hom"]}], "-", 
           RowBox[{
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["sDip", "hom"]}], "+", 
           RowBox[{
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["sHap", "het"]}], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["sHap", "het"]}], "-", 
           RowBox[{
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "het"], " ", 
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "-", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "-", 
           RowBox[{
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "het"], " ", 
            SubscriptBox["sDip", "het"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["sDip", "het"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "het"], " ", 
             SubscriptBox["sDip", "het"]}], "-", 
            SubscriptBox["sDip", "hom"], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "hom"], " ", 
             SubscriptBox["sDip", "hom"]}]}], ")"}], "3"]}], ")"}]}]}], ",", 
     RowBox[{"pA", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{
         SubscriptBox["h", "het"], " ", 
         SubscriptBox["sDip", "het"]}], "+", 
        RowBox[{
         SubscriptBox["h", "hom"], " ", 
         SubscriptBox["sDip", "hom"]}], "+", 
        SubscriptBox["sHap", "het"], "+", 
        SubscriptBox["sHap", "hom"], "+", 
        SubscriptBox["\[Alpha]1", "het"], "+", 
        SubscriptBox["\[Alpha]1", "hom"]}], 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["sDip", "het"]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["h", "het"], " ", 
         SubscriptBox["sDip", "het"]}], "-", 
        SubscriptBox["sDip", "hom"], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["h", "hom"], " ", 
         SubscriptBox["sDip", "hom"]}]}]]}], ",", 
     RowBox[{"freqYWhet1", "\[Rule]", "0"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.695148152784584*^9, 3.695149157020667*^9, 
  3.695152971825259*^9, 3.695156872124853*^9, 3.695220449437908*^9, 
  3.695222130975398*^9, 3.695295632858808*^9, 3.6953013653620358`*^9, 
  3.695302991861381*^9, 3.695308512358492*^9, 3.695315499370803*^9, 
  3.69531637139884*^9, 3.695319283942216*^9, 3.695320459629202*^9, 
  3.695322550497199*^9, 3.6953925060951023`*^9, 3.695398006445704*^9, 
  3.695408684663247*^9, 3.6971491981264153`*^9, 3.697151365668791*^9, 
  3.6971618949522257`*^9, 3.6971621630085382`*^9, 3.6979839947463923`*^9, 
  3.698371849119334*^9, 3.698415145747802*^9, 3.715689453114914*^9}]
}, Open  ]],

Cell["Going to the next order in selection", "Text",
 CellChangeTimes->{{3.6868344126058283`*^9, 3.686834418049678*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqs2freqYW", "=", 
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"differenceEqs", "[", 
                 RowBox[{"[", "4", "]"}], "]"}], "/.", "weaksel"}], "/.", 
               "frequenciessub"}], "/.", "sol0"}], "/.", 
             RowBox[{"pXZhom0", "\[Rule]", "pA"}]}], "/.", 
            RowBox[{"pXZhet1", "\[Rule]", 
             RowBox[{"dpAXZhetXZhom", "+", "pXZhom1"}]}]}], "/.", 
           RowBox[{"pYWhet1", "\[Rule]", 
            RowBox[{"dpAYWhetXZhom", "+", "pXZhom1"}]}]}], "/.", 
          RowBox[{"realsol", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], 
      ",", "\[Epsilon]", ",", "Factor"}], "]"}], "//", "Flatten"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6863818653962603`*^9, 3.6863818881435633`*^9}, {
   3.686382723059884*^9, 3.686382723122312*^9}, {3.686383279670281*^9, 
   3.686383290512813*^9}, {3.686383380437603*^9, 3.686383410469685*^9}, {
   3.68638347837694*^9, 3.6863834841393557`*^9}, 3.68638366463343*^9, 
   3.695054416913224*^9, {3.69514823227831*^9, 3.695148234094158*^9}, 
   3.695148306029792*^9, {3.695149207645644*^9, 3.695149208988615*^9}, 
   3.695149259402616*^9, {3.695156919807366*^9, 3.695156921223497*^9}, 
   3.695156998801784*^9, 3.698371863241227*^9, 3.698415171241365*^9, {
   3.698415223757642*^9, 3.698415244719157*^9}}],

Cell["\<\
And we can solve for the leading order X(Z)-Y(W) bias in gametes from the \
hetermorphic sex\
\>", "Text",
 CellChangeTimes->{{3.686834434808115*^9, 3.6868344584620657`*^9}, {
  3.695054343753072*^9, 3.695054345600885*^9}, {3.6983719458666983`*^9, 
  3.698371958676064*^9}, {3.6984152670619373`*^9, 3.6984152676212997`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"freqYWhet2sol", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{"differenceEqs2freqYW", "\[Equal]", "0"}], ",", 
      RowBox[{"{", "freqYWhet2", "}"}]}], "]"}], "//", "Flatten"}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6863834555709667`*^9, 3.6863834619440536`*^9}, {
   3.686383502094328*^9, 3.6863835034230833`*^9}, {3.686383547214383*^9, 
   3.686383549909721*^9}, {3.686383655170779*^9, 3.686383658964765*^9}, 
   3.693566482646193*^9, 3.6950543181457863`*^9, 3.6950544105551987`*^9, {
   3.695148238421629*^9, 3.695148239494656*^9}, 3.6951483039107428`*^9, {
   3.695149211083536*^9, 3.695149212788513*^9}, 3.695149262196085*^9, {
   3.6951569233178587`*^9, 3.695156924758947*^9}, 3.6951569952656097`*^9, 
   3.698371869372764*^9, {3.6984151728006*^9, 3.698415178368125*^9}, {
   3.698415210211385*^9, 3.698415211786439*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"freqYWhet2", "\[Rule]", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "recAXandAM"}], "+", 
        RowBox[{"2", " ", "recAXnotAM"}]}], ")"}], " ", 
      SubscriptBox["\[Alpha]1", "het"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubsuperscriptBox["h", "het", "3"], " ", 
         SubsuperscriptBox["sDip", "het", "3"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["sDip", "hom"], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sHap", "hom"], "+", 
              SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{
         SubsuperscriptBox["h", "het", "2"], " ", 
         SubsuperscriptBox["sDip", "het", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", 
                SubscriptBox["h", "hom"]}]}], ")"}]}], " ", 
            SubscriptBox["sDip", "hom"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sDip", "hom"], "-", 
              SubscriptBox["sHap", "het"], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["sHap", "hom"]}], "-", 
              SubscriptBox["\[Alpha]1", "het"], "+", 
              RowBox[{"2", " ", 
               SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}], "+", 
           RowBox[{
            SubscriptBox["sDip", "het"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SubscriptBox["h", "hom"]}], ")"}], " ", 
               SubscriptBox["sDip", "hom"]}], "+", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "hom"], "+", 
                 SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "-", 
        RowBox[{
         SubscriptBox["h", "het"], " ", 
         SubscriptBox["sDip", "het"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SubsuperscriptBox["sDip", "hom", "2"], " ", 
            SubscriptBox["sHap", "het"]}], "+", 
           RowBox[{
            SubscriptBox["sDip", "hom"], " ", 
            SubsuperscriptBox["sHap", "het", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["sDip", "hom", "2"], " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{"4", " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["sHap", "het"], " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{"2", " ", 
            SubsuperscriptBox["sHap", "het", "2"], " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{"3", " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubsuperscriptBox["sHap", "hom", "2"]}], "+", 
           RowBox[{"4", " ", 
            SubscriptBox["sHap", "het"], " ", 
            SubsuperscriptBox["sHap", "hom", "2"]}], "+", 
           RowBox[{"2", " ", 
            SubsuperscriptBox["sHap", "hom", "3"]}], "+", 
           RowBox[{"2", " ", 
            SubsuperscriptBox["sDip", "hom", "2"], " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["sHap", "het"], " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "+", 
           RowBox[{"4", " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["sHap", "hom"], " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "+", 
           RowBox[{"4", " ", 
            SubscriptBox["sHap", "het"], " ", 
            SubscriptBox["sHap", "hom"], " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "+", 
           RowBox[{"4", " ", 
            SubsuperscriptBox["sHap", "hom", "2"], " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "+", 
           RowBox[{
            SubscriptBox["sDip", "hom"], " ", 
            SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["sHap", "hom"], " ", 
            SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "+", 
           RowBox[{
            SubsuperscriptBox["sDip", "hom", "2"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"4", " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["sHap", "het"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"2", " ", 
            SubsuperscriptBox["sHap", "het", "2"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"6", " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["sHap", "hom"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"8", " ", 
            SubscriptBox["sHap", "het"], " ", 
            SubscriptBox["sHap", "hom"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"6", " ", 
            SubsuperscriptBox["sHap", "hom", "2"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"4", " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubscriptBox["\[Alpha]1", "het"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"4", " ", 
            SubscriptBox["sHap", "het"], " ", 
            SubscriptBox["\[Alpha]1", "het"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"8", " ", 
            SubscriptBox["sHap", "hom"], " ", 
            SubscriptBox["\[Alpha]1", "het"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"2", " ", 
            SubsuperscriptBox["\[Alpha]1", "het", "2"], " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"3", " ", 
            SubscriptBox["sDip", "hom"], " ", 
            SubsuperscriptBox["\[Alpha]1", "hom", "2"]}], "+", 
           RowBox[{"4", " ", 
            SubscriptBox["sHap", "het"], " ", 
            SubsuperscriptBox["\[Alpha]1", "hom", "2"]}], "+", 
           RowBox[{"6", " ", 
            SubscriptBox["sHap", "hom"], " ", 
            SubsuperscriptBox["\[Alpha]1", "hom", "2"]}], "+", 
           RowBox[{"4", " ", 
            SubscriptBox["\[Alpha]1", "het"], " ", 
            SubsuperscriptBox["\[Alpha]1", "hom", "2"]}], "+", 
           RowBox[{"2", " ", 
            SubsuperscriptBox["\[Alpha]1", "hom", "3"]}], "-", 
           RowBox[{
            SubsuperscriptBox["sDip", "het", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sHap", "hom"], "+", 
              SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}], "-", 
           RowBox[{
            SubsuperscriptBox["h", "hom", "2"], " ", 
            SubsuperscriptBox["sDip", "hom", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "2"}], " ", 
               SubscriptBox["sDip", "het"]}], "+", 
              SubscriptBox["sDip", "hom"], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", 
                  SubscriptBox["sHap", "het"]}], "+", 
                 SubscriptBox["sHap", "hom"], "-", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Alpha]1", "het"]}], "+", 
                 SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{"2", " ", 
            SubscriptBox["sDip", "het"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox["sDip", "hom"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "het"], "+", 
                 SubscriptBox["\[Alpha]1", "het"]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "hom"], "+", 
                 SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "het"], "+", 
                 SubscriptBox["sHap", "hom"], "+", 
                 SubscriptBox["\[Alpha]1", "het"], "+", 
                 SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", 
               SubsuperscriptBox["sDip", "het", "2"]}], "-", 
              RowBox[{"2", " ", 
               SubscriptBox["sDip", "het"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "het"], "-", 
                 RowBox[{"2", " ", 
                  SubscriptBox["sHap", "hom"]}], "+", 
                 SubscriptBox["\[Alpha]1", "het"], "-", 
                 RowBox[{"2", " ", 
                  SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}], "+", 
              RowBox[{
               SubscriptBox["sDip", "hom"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sDip", "hom"], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    RowBox[{"-", "2"}], " ", 
                    SubscriptBox["sHap", "het"]}], "+", 
                    SubscriptBox["sHap", "hom"], "-", 
                    RowBox[{"2", " ", 
                    SubscriptBox["\[Alpha]1", "het"]}], "+", 
                    SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"]}], "+", 
           SubscriptBox["sHap", "het"], "+", 
           SubscriptBox["sHap", "hom"], "+", 
           SubscriptBox["\[Alpha]1", "het"], "+", 
           SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SubsuperscriptBox["h", "hom", "2"], " ", 
            SubsuperscriptBox["sDip", "hom", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sDip", "het"], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "het"], "+", 
                 SubscriptBox["\[Alpha]1", "het"]}], ")"}]}]}], ")"}]}], "-", 
           
           RowBox[{
            SubsuperscriptBox["sDip", "het", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sHap", "hom"], "+", 
              SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}], "+", 
           RowBox[{
            SubscriptBox["sDip", "hom"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sHap", "het"], "+", 
              SubscriptBox["\[Alpha]1", "het"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sDip", "hom"], "+", 
              SubscriptBox["sHap", "het"], "+", 
              SubscriptBox["sHap", "hom"], "+", 
              SubscriptBox["\[Alpha]1", "het"], "+", 
              SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}], "+", 
           RowBox[{
            SubscriptBox["sDip", "het"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               SubscriptBox["sDip", "hom"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "het"], "-", 
                 SubscriptBox["sHap", "hom"], "+", 
                 SubscriptBox["\[Alpha]1", "het"], "-", 
                 SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "hom"], "+", 
                 SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "het"], "+", 
                 SubscriptBox["sHap", "hom"], "+", 
                 SubscriptBox["\[Alpha]1", "het"], "+", 
                 SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}]}], ")"}]}], "-", 
           
           RowBox[{
            SubscriptBox["h", "hom"], " ", 
            SubscriptBox["sDip", "hom"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubsuperscriptBox["sDip", "het", "2"], "+", 
              RowBox[{
               SubscriptBox["sDip", "het"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sDip", "hom"], "+", 
                 RowBox[{"3", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["sHap", "het"], "+", 
                    SubscriptBox["\[Alpha]1", "het"]}], ")"}]}]}], ")"}]}], 
              "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "het"], "+", 
                 SubscriptBox["\[Alpha]1", "het"]}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"3", " ", 
                  SubscriptBox["sDip", "hom"]}], "+", 
                 RowBox[{"2", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["sHap", "het"], "+", 
                    SubscriptBox["sHap", "hom"], "+", 
                    SubscriptBox["\[Alpha]1", "het"], "+", 
                    SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}]}], ")"}]}]}], 
             ")"}]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      RowBox[{"(", 
       RowBox[{"recAXandAM", "+", "recAXnotAM"}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "het"]}]}], ")"}], " ", 
          SubscriptBox["sDip", "het"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "hom"]}]}], ")"}], " ", 
          SubscriptBox["sDip", "hom"]}]}], ")"}], "3"]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.698371993272331*^9, 3.698415330757696*^9, 
  3.715689534539452*^9}]
}, Open  ]],

Cell[TextData[{
 "which is simply ",
 Cell[BoxData[
  FormBox[
   SubscriptBox["\[Alpha]1", "het"], TraditionalForm]]],
 "/2 times the difference in frequency of A between Y(W)-bearing and \
X(Z)-bearing gametes from the hetermorphic sex"
}], "Text",
 CellChangeTimes->{{3.693569401716167*^9, 3.693569426397214*^9}, {
  3.695156988906992*^9, 3.695156989338797*^9}, {3.698372005170094*^9, 
  3.698372018718375*^9}, {3.6984152036429377`*^9, 3.6984152041691313`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"freqYWhet2", " ", "/.", "freqYWhet2sol"}], "/.", 
    RowBox[{"realsol2", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"dpAYWhetXZhet", " ", 
     RowBox[{
      SubscriptBox["\[Alpha]1", "het"], "/", "2"}]}], "==", "%"}], "/.", 
   RowBox[{"realsol2", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.69287663706389*^9, 3.6928766492028522`*^9}, {
  3.693569320748597*^9, 3.693569397034688*^9}, {3.695156983196702*^9, 
  3.695156983314877*^9}, {3.698371879084298*^9, 3.698371879364032*^9}, {
  3.698415193107616*^9, 3.6984151971970463`*^9}, {3.698415397128997*^9, 
  3.6984154072807703`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.692876652083344*^9, 3.693566090221219*^9, 3.693566489376848*^9, {
   3.693569346051766*^9, 3.693569397382689*^9}, 3.6950543569326477`*^9, 
   3.695054438569611*^9, 3.69514099623175*^9, 3.69514832150058*^9, 
   3.69514927307896*^9, 3.695152972261877*^9, {3.695156979672966*^9, 
   3.695156983786797*^9}, 3.69522045010538*^9, 3.695222131455697*^9, 
   3.69529563324657*^9, 3.695301365936228*^9, 3.6953029923836203`*^9, 
   3.695308513048559*^9, 3.695308595877844*^9, 3.695315499916712*^9, 
   3.695316371983735*^9, 3.6953192849877033`*^9, 3.6953204601766987`*^9, 
   3.6953225511942873`*^9, 3.695392506629303*^9, 3.6953980072295523`*^9, 
   3.6954086851853724`*^9, 3.697149198636324*^9, 3.697151376414349*^9, 
   3.697161895671844*^9, 3.697162163581653*^9, 3.697983995109832*^9, 
   3.698371999205061*^9, 3.698415330954756*^9, {3.698415402044854*^9, 
   3.6984154077463303`*^9}, 3.715689534582958*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Sex chromosome turnover", "Section",
 CellChangeTimes->{{3.678209119281839*^9, 3.678209120120673*^9}, {
   3.678543062217785*^9, 3.678543087289337*^9}, {3.678845327129443*^9, 
   3.678845334473263*^9}, {3.6788457352447*^9, 3.67884576834332*^9}, {
   3.681897609323646*^9, 3.681897629368148*^9}, {3.681898183456883*^9, 
   3.681898230696837*^9}, 3.681900462399898*^9, {3.682133711700137*^9, 
   3.682133712477377*^9}, {3.695066339337016*^9, 3.695066339536086*^9}}],

Cell["In this section we do not assume weak selection.", "Text",
 CellChangeTimes->{{3.695069181308769*^9, 3.6950691923640223`*^9}}],

Cell[CellGroupData[{

Cell["Mean lifetime fitness of residents", "Subsection",
 CellChangeTimes->{{3.685936929379376*^9, 3.685936944459811*^9}, {
  3.6950693531294537`*^9, 3.695069354632618*^9}, {3.695319286472085*^9, 
  3.695319297603525*^9}}],

Cell["\<\
We first define the mean fitness of non-mutant homogametic individuals over \
the entire life-cycle\
\>", "Text",
 CellChangeTimes->{{3.67820958015338*^9, 3.678209581848392*^9}, {
   3.678218773865472*^9, 3.678218792610045*^9}, 3.678543107091495*^9, {
   3.6818986054990177`*^9, 3.681898605788726*^9}, {3.681901258150548*^9, 
   3.681901259053981*^9}, {3.681901437344181*^9, 3.681901445383747*^9}, {
   3.68190187236559*^9, 3.681901897193009*^9}, {3.681902775116111*^9, 
   3.6819027794321127`*^9}, {3.681903847565377*^9, 3.681903849245577*^9}, {
   3.682050811782687*^9, 3.682050812665957*^9}, {3.682065544510603*^9, 
   3.682065569016514*^9}, {3.682065669647312*^9, 3.6820656945659733`*^9}, {
   3.698372047873217*^9, 3.698372054567367*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"homMeanFit", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXZhom"}], ")"}], 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "hom"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pXZhet"}], ")"}], 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "het"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "a", ",", "hom"}]]}], "+", "\[IndentingNewLine]", 
    RowBox[{"pXZhom", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "hom"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pXZhet"}], ")"}], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "het"}]], 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "hom"}]]}], "+", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXZhom"}], ")"}], 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "hom"}]], " ", "pXZhet", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "het"}]], 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "hom"}]]}], " ", "+", "\[IndentingNewLine]", 
    RowBox[{"pXZhom", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "hom"}]], " ", "pXZhet", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "het"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "A", ",", "hom"}]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681898268466964*^9, 3.6818983708017797`*^9}, {
   3.6818984949585733`*^9, 3.681898533386279*^9}, {3.68190108087703*^9, 
   3.681901084934218*^9}, {3.681901144685513*^9, 3.681901154780171*^9}, {
   3.681901385648533*^9, 3.681901386601219*^9}, {3.6819016152621*^9, 
   3.681901637595449*^9}, 3.681901842920384*^9, 3.6819027638144817`*^9, {
   3.681903858647367*^9, 3.681903859300173*^9}, {3.6863818000961943`*^9, 
   3.686381824765128*^9}, {3.697149263139967*^9, 3.6971493092913446`*^9}, {
   3.697162230775766*^9, 3.697162244245644*^9}, {3.697162651580434*^9, 
   3.697162661696076*^9}, {3.698372058511999*^9, 3.698372081747549*^9}, {
   3.6984154422995443`*^9, 3.698415473886338*^9}}],

Cell["\<\
and the mean fitness of non-mutant males over the entire life-cycle\
\>", "Text",
 CellChangeTimes->{{3.682065572600375*^9, 3.68206561683589*^9}, {
  3.682065679170457*^9, 3.682065706203755*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"hetMeanFit", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXZhom"}], ")"}], 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "hom"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pYWhet"}], ")"}], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "het"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "a", ",", "het"}]]}], "+", "\[IndentingNewLine]", 
    RowBox[{"pXZhom", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "hom"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pYWhet"}], ")"}], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "het"}]], 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "het"}]]}], "+", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXZhom"}], ")"}], 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "hom"}]], " ", "pYWhet", "  ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "het"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "het"}]]}], " ", "+", "\[IndentingNewLine]", 
    RowBox[{"pXZhom", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "hom"}]], " ", "pYWhet", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "het"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "A", ",", "het"}]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681901249067821*^9, 3.6819012978398542`*^9}, {
  3.681901363538598*^9, 3.681901384083459*^9}, {3.681901546264427*^9, 
  3.681901547139256*^9}, {3.6819016461771812`*^9, 3.6819016541406918`*^9}, {
  3.681901830998515*^9, 3.681901845963574*^9}, {3.6819027552099323`*^9, 
  3.681902760712364*^9}, {3.682072412323092*^9, 3.68207244637437*^9}, {
  3.682072508629033*^9, 3.682072509244377*^9}, {3.685529897041615*^9, 
  3.685529925782366*^9}, {3.685881904356382*^9, 3.6858819411706448`*^9}, {
  3.6863818330941753`*^9, 3.6863818517180767`*^9}, {3.686382196801606*^9, 
  3.6863821989178057`*^9}, {3.697162670996776*^9, 3.6971626817919817`*^9}, {
  3.697162853692922*^9, 3.6971628559447947`*^9}, {3.698372084611257*^9, 
  3.698372099588768*^9}, {3.6984154766645737`*^9, 3.698415493993685*^9}}],

Cell["\<\
These can be written as the products of mean fitness across sex and ploidy \
level and the frequency of sexes in the diploid stages\
\>", "Text",
 CellChangeTimes->{{3.6950762828398447`*^9, 3.6950762975038023`*^9}, {
  3.695076552480834*^9, 3.69507657219873*^9}, {3.6971624248622303`*^9, 
  3.6971624345884857`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"homMeanFit", "==", 
      FractionBox[
       RowBox[{
        SubscriptBox["freqDip", "hom"], 
        SubscriptBox["wbarDip", "hom"], 
        SubscriptBox["wbarHap", "het"], 
        SubscriptBox["wbarHap", "hom"]}], 
       RowBox[{" ", 
        RowBox[{"1", "-", "freqYWhet"}]}]]}], "/.", "subequil"}], "/.", 
    "sumsex"}], "/.", "invXY"}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6971622879921217`*^9, 3.6971622882896013`*^9}, 
   3.69716266608292*^9, {3.697162780828803*^9, 3.697162785633375*^9}, {
   3.697163109187051*^9, 3.6971631109741287`*^9}, {3.698372107777795*^9, 
   3.698372116787381*^9}, {3.698415502430925*^9, 3.698415504170063*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.697161965529808*^9, 3.697162167235216*^9, 3.697162254387228*^9, 
   3.697162288796241*^9, 3.697162667194302*^9, 3.6971627865135813`*^9, {
   3.6972203262286987`*^9, 3.697220337559712*^9}, 3.697983999656394*^9, 
   3.698372131009285*^9, {3.69841549893534*^9, 3.6984155046634607`*^9}, 
   3.7041552552339363`*^9, 3.715689534773616*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"hetMeanFit", "==", 
      FractionBox[
       RowBox[{
        SubscriptBox["freqDip", "het"], 
        SubscriptBox["wbarDip", "het"], 
        SubscriptBox["wbarHap", "het"], 
        SubscriptBox["wbarHap", "hom"]}], "freqYWhet"]}], "/.", "subequil"}], 
    "/.", "sumsex"}], "/.", "invXY"}], "//", "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.695076306167659*^9, 3.6950763443724823`*^9}, {
   3.695076376301353*^9, 3.695076395043723*^9}, {3.695076425509369*^9, 
   3.695076529007725*^9}, {3.69716230655477*^9, 3.697162309440134*^9}, 
   3.697162683432365*^9, {3.69716271454062*^9, 3.697162728134371*^9}, {
   3.697162790823305*^9, 3.697162797004085*^9}, {3.697162882046026*^9, 
   3.697162894360677*^9}, {3.698372120579947*^9, 3.698372128325012*^9}, {
   3.698415508793342*^9, 3.698415512518358*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.6950763293779573`*^9, 3.6950763446658287`*^9}, {
   3.6950763776572104`*^9, 3.695076395632031*^9}, {3.695076427389881*^9, 
   3.695076529347124*^9}, 3.695143839539111*^9, 3.6951484861334457`*^9, 
   3.695149310967157*^9, 3.695152984743354*^9, 3.695157075912943*^9, 
   3.6952206105126333`*^9, 3.695222132726009*^9, 3.6952956335874023`*^9, 
   3.69530136626373*^9, 3.69530299264834*^9, 3.695308684434732*^9, 
   3.6953155462310467`*^9, 3.695316375853654*^9, 3.6953192852939796`*^9, 
   3.6953204604410267`*^9, 3.695322551476589*^9, 3.695392506785573*^9, 
   3.6953980078465977`*^9, 3.697149321380168*^9, {3.697162302512041*^9, 
   3.697162310363028*^9}, 3.697162684018227*^9, {3.697162717492828*^9, 
   3.6971627289659557`*^9}, 3.697162797563301*^9, {3.697162883048787*^9, 
   3.697162894896861*^9}, 3.697220339008914*^9, 3.69798399969433*^9, 
   3.698372132525589*^9, 3.698415513835166*^9, 3.704155255429997*^9, 
   3.715689534816021*^9}]
}, Open  ]],

Cell["\<\
Notice that if meiotic drive favors Y(W) haplotypes (leading to a sex ratio \
biased towards the heterogametic sex), freqYWhet increases, increasing mean \
fitness of the homogametic sex and decreasing the mean fitness of the \
heterogametic sex.\
\>", "Text",
 CellChangeTimes->{{3.6971629038970203`*^9, 3.697162967882358*^9}, {
  3.697163048493457*^9, 3.697163097753469*^9}, {3.698372139156642*^9, 
  3.698372174955905*^9}, {3.6984155224797173`*^9, 3.698415549736685*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Characteristic polynomial [takes a few minutes]", "Subsection",
 CellChangeTimes->{{3.6819047751955338`*^9, 3.681904779416266*^9}, {
  3.695220679880062*^9, 3.69522068369086*^9}}],

Cell["The Jacobian for the mutants is", "Text",
 CellChangeTimes->{{3.6758991929846497`*^9, 3.67589926406907*^9}, {
   3.67589934114139*^9, 3.6758993427645893`*^9}, {3.675900036907325*^9, 
   3.6759000483741083`*^9}, {3.676720403037026*^9, 3.676720404249701*^9}, {
   3.6767205532682467`*^9, 3.676720568189563*^9}, {3.676720627629078*^9, 
   3.676720646673503*^9}, 3.678764550116784*^9, {3.67876518531907*^9, 
   3.678765192344109*^9}, {3.6787654012127323`*^9, 3.6787654024110203`*^9}, {
   3.678765517503551*^9, 3.678765517693905*^9}, {3.681791115442161*^9, 
   3.681791118393203*^9}, {3.6952206534907007`*^9, 3.6952206771930447`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqsmut", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             SubscriptBox["fHapNext", 
              RowBox[{"x", ",", "y", ",", "m", ",", "sex"}]], ",", 
             RowBox[{"{", 
              RowBox[{"sex", ",", 
               RowBox[{"{", 
                RowBox[{"hom", ",", "het"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"{", 
                RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"{", 
                RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}]}], "]"}], "/.", 
           "sumsex"}], "/.", "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.",
        "pseg2"}], "/.", "pseg3"}], "/.", "pseg4"}], "//", "Flatten"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"matExtFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"eqsmut", ",", 
            SubscriptBox["fHap", 
             RowBox[{"x", ",", "y", ",", "m", ",", "sex"}]]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"sex", ",", 
            RowBox[{"{", 
             RowBox[{"hom", ",", "het"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"{", 
             RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"{", 
             RowBox[{"XZ", ",", "YW"}], "}"}]}], "}"}]}], "]"}], ",", "2"}], 
       "]"}], "]"}], "/.", "subequil"}], "//", "Factor"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.678764564891323*^9, 3.678764567242013*^9}, {
   3.678764626820463*^9, 3.6787646270965*^9}, {3.678764748875876*^9, 
   3.678764756289021*^9}, {3.678764981493416*^9, 3.678764996775971*^9}, {
   3.678765027830419*^9, 3.678765029600572*^9}, {3.678765158142272*^9, 
   3.678765175722975*^9}, 3.679940744341713*^9, {3.681790991236353*^9, 
   3.6817910929323387`*^9}, 3.6817911344850187`*^9, {3.681897697148897*^9, 
   3.6818976982011127`*^9}, {3.6820495781165867`*^9, 3.682049583553007*^9}, {
   3.6983721817234383`*^9, 3.698372193986491*^9}, {3.698415563060999*^9, 
   3.6984155695638514`*^9}}],

Cell["Giving characteristic polynomial", "Text",
 CellChangeTimes->{{3.6799407517772408`*^9, 3.679940767791992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyExt", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matExtFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "8", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6758993091981916`*^9, 3.6758993092948217`*^9}, {
  3.677427680774026*^9, 3.6774276809783897`*^9}, {3.678765570174028*^9, 
  3.678765571504396*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Coefficients", "Subsection",
 CellChangeTimes->{
  3.69507024131107*^9, {3.695076660260137*^9, 3.6950766632011557`*^9}}],

Cell[CellGroupData[{

Cell["Homologous transition", "Subsubsection",
 CellChangeTimes->{{3.681903449113834*^9, 3.681903450516502*^9}, {
  3.6819047924620533`*^9, 3.681904797745571*^9}, {3.6983756031517973`*^9, 
  3.698375619672917*^9}, {3.698416354178588*^9, 3.6984163583920927`*^9}}],

Cell["\<\
When the mutation makes the ancestrally heterogametic sex, the characteristic \
polynomial is\
\>", "Text",
 CellChangeTimes->{{3.681903454570097*^9, 3.681903472252966*^9}, 
   3.681903788811371*^9, {3.6983725009352427`*^9, 3.698372509678987*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"takes", " ", "a", " ", "couple", " ", "minutes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"charpolyk0", "=", 
    RowBox[{
     RowBox[{"charpolyExt", "/.", 
      RowBox[{"k", "\[Rule]", "0"}]}], "//", "Factor"}]}], ";"}]}]], "Input",
 CellChangeTimes->{{3.682069972428116*^9, 3.682069973772089*^9}, {
   3.682146362987977*^9, 3.682146374154097*^9}, 3.6821464495080338`*^9, 
   3.682146862048996*^9, {3.698416605235085*^9, 3.698416610737372*^9}}],

Cell["\<\
The coefficients of our characteristic polynomial are (using only the \
relevant factor of the characteristic polynomial)\
\>", "Text",
 CellChangeTimes->{{3.6782188723553667`*^9, 3.678218885483445*^9}, 
   3.678219356203349*^9, {3.698416569870881*^9, 3.698416572582293*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"charpoly\[Alpha]0", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"charpolyk0", "[", 
      RowBox[{"[", "5", "]"}], "]"}], ",", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"acoef0", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"charpoly\[Alpha]0", ",", 
     RowBox[{"\[Lambda]", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bcoef0", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"charpoly\[Alpha]0", ",", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ccoef0", "=", 
   RowBox[{"charpoly\[Alpha]0", "-", 
    RowBox[{"acoef0", " ", 
     RowBox[{"\[Lambda]", "^", "2"}]}], "-", 
    RowBox[{"bcoef0", " ", "\[Lambda]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.678210909322748*^9, 3.678210984920451*^9}, {
   3.678211065387308*^9, 3.6782111248508577`*^9}, {3.678216596004511*^9, 
   3.6782166154301167`*^9}, {3.678216661630507*^9, 3.6782166685831823`*^9}, {
   3.678543435404685*^9, 3.678543437050301*^9}, 3.6819018632616568`*^9, 
   3.6819019221224947`*^9, {3.681902293571035*^9, 3.6819022942054*^9}, {
   3.681903514398522*^9, 3.681903527518437*^9}, {3.6819039026101837`*^9, 
   3.681903904956162*^9}, {3.682920930456254*^9, 3.682920935451797*^9}, {
   3.6858819458333483`*^9, 3.685881946549279*^9}, {3.6868384287249537`*^9, 
   3.6868384290703278`*^9}}],

Cell["The a coefficient can be written", "Text",
 CellChangeTimes->{{3.6782222711717787`*^9, 3.678222291827236*^9}, {
  3.678222442624536*^9, 3.678222466366487*^9}, {3.678543405945023*^9, 
  3.678543417688088*^9}, {3.678543453554411*^9, 3.678543473051293*^9}, {
  3.6785437211897573`*^9, 3.678543723630198*^9}, {3.681901128257367*^9, 
  3.6819011288228273`*^9}, {3.681902959278455*^9, 3.681902959943367*^9}, {
  3.6950724407721357`*^9, 3.6950724441925488`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"acoef0", "/", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"hetMeanFit", "/", "meanHet"}], ")"}], "2"]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.678220958334203*^9, 3.678220959366744*^9}, {
   3.678222265836959*^9, 3.678222266627904*^9}, {3.6819007374163027`*^9, 
   3.681900782049633*^9}, 3.681900926695757*^9, {3.681901186789213*^9, 
   3.681901197102724*^9}, {3.681901311334466*^9, 3.6819013184746037`*^9}, {
   3.681901448459179*^9, 3.681901474059561*^9}, {3.681901555374631*^9, 
   3.6819015611958933`*^9}, {3.681901738004952*^9, 3.681901746660657*^9}, {
   3.681901926503386*^9, 3.681901935674559*^9}, 3.68190245993617*^9, 
   3.6819035305096617`*^9, {3.681903953576722*^9, 3.681903983485964*^9}, {
   3.698372520653778*^9, 3.698372526851285*^9}}],

Cell[BoxData[
 RowBox[{"4", " ", 
  SuperscriptBox["freqYWhet", "2"], " ", 
  SuperscriptBox["meanHet", "2"]}]], "Output",
 CellChangeTimes->{3.695072348772151*^9, 3.695141145246634*^9, 
  3.695143881932109*^9, 3.695148660541789*^9, 3.695149450862523*^9, 
  3.695152683234867*^9, 3.695153150092022*^9, 3.695157244287158*^9, 
  3.695220770803046*^9, 3.695222284966383*^9, 3.695308847128819*^9, 
  3.695315702602242*^9, 3.6953997771753263`*^9, 3.69716318587177*^9, 
  3.6983729083803377`*^9, 3.698416696297085*^9, 3.704155791008408*^9, 
  3.7156900336450777`*^9}]
}, Open  ]],

Cell["\<\
When there is no recombination between the novel sex determiner and the \
selected locus the eigenvalues are\
\>", "Text",
 CellChangeTimes->{{3.682072590495638*^9, 3.682072598058753*^9}, {
  3.682074822686273*^9, 3.682074840969604*^9}, {3.695072312397974*^9, 
  3.695072330141542*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"noreceigens0", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Lambda]", "/.", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"0", "==", 
           RowBox[{"charpolyk0", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "/.", 
          RowBox[{"recAMnotAX", "\[Rule]", "0"}]}], "/.", 
         RowBox[{"recAXandAM", "\[Rule]", "0"}]}], ",", "\[Lambda]"}], 
       "]"}]}], ")"}], "*", 
    RowBox[{"(", 
     RowBox[{"hetMeanFit", "/", "meanHet"}], ")"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.682072604849454*^9, 3.682072625018734*^9}, 
   3.682073600958725*^9, 3.6820737987746267`*^9, {3.6829209661252327`*^9, 
   3.682920966235426*^9}, {3.686839642158704*^9, 3.686839642356824*^9}, {
   3.686841508510477*^9, 3.6868415274256353`*^9}, 3.6950723067377853`*^9, {
   3.695144008515514*^9, 3.6951440117530737`*^9}, {3.695144245564939*^9, 
   3.6951443074567137`*^9}, 3.695144451486403*^9, {3.695144501561264*^9, 
   3.6951445063375483`*^9}, {3.695148673971549*^9, 3.695148705434224*^9}, {
   3.695149315484304*^9, 3.695149322325838*^9}, {3.695308713554781*^9, 
   3.695308722704131*^9}, {3.695308884904128*^9, 3.695308887375862*^9}, 
   3.6983725397471037`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "het"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pXZhom"}], ")"}], " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "hom"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "a", ",", "het"}]]}], "+", 
        RowBox[{"2", " ", "pXZhom", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["\[Alpha]", "het"]}], ")"}], " ", 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "hom"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"A", ",", "a", ",", "het"}]]}]}], ")"}]}], 
     RowBox[{"2", " ", "freqYWhet", " ", "meanHet"}]]}], ",", 
   FractionBox[
    RowBox[{
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "het"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pXZhom"}], ")"}], " ", 
        SubscriptBox["\[Alpha]", "het"], " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "hom"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "A", ",", "het"}]]}], "+", 
       RowBox[{"pXZhom", " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "hom"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "A", ",", "het"}]]}]}], ")"}]}], 
    RowBox[{"2", " ", "freqYWhet", " ", "meanHet"}]]}], "}"}]], "Output",
 CellChangeTimes->{{3.6950702594604692`*^9, 3.695070275175701*^9}, 
   3.695070397407928*^9, 3.695072308654439*^9, 3.695072354355142*^9, 
   3.6951412728098373`*^9, 3.695143879676778*^9, 3.695143972966861*^9, 
   3.695144034966776*^9, 3.695144249103421*^9, {3.695144299612781*^9, 
   3.695144309507638*^9}, {3.695144498014052*^9, 3.6951445083629293`*^9}, 
   3.695148670281245*^9, 3.695148707260144*^9, 3.695149452266214*^9, 
   3.695152686113306*^9, 3.695153151484206*^9, 3.6951572458151608`*^9, 
   3.6952207726354513`*^9, 3.6952222867289677`*^9, {3.69530887528223*^9, 
   3.695308889892858*^9}, 3.695315704397524*^9, 3.6953997805906563`*^9, 
   3.697163199976398*^9, 3.698372911574698*^9, 3.698416697657433*^9, 
   3.704155792685894*^9, 3.715690035031514*^9}]
}, Open  ]],

Cell["\<\
These eigenvalues describe the average growth of mA and ma haplotypes when \
there is no recombination. The rates of loss/gain of haplotypes due to \
recombination are\
\>", "Text",
 CellChangeTimes->{{3.695073075066889*^9, 3.6950731360432787`*^9}, {
  3.695076070899908*^9, 3.695076071873383*^9}, {3.715714225521778*^9, 
  3.715714232201618*^9}, {3.715714319189479*^9, 3.715714319861445*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"noreceigens0", "/.", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "het"}]], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "recAM"}], " ", ")"}], 
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "het"}]]}]}]}], "/.", 
   RowBox[{
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "het"}]], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "recAM"}], ")"}], "  ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "het"}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"recrates0", "=", 
  RowBox[{
   RowBox[{"-", "recAM"}], " ", 
   RowBox[{"Coefficient", "[", " ", 
    RowBox[{"%", ",", "recAM"}], "]"}]}]}]}], "Input",
 CellChangeTimes->{{3.6950731428473682`*^9, 3.695073153965623*^9}, {
   3.6951443506543837`*^9, 3.695144353239675*^9}, {3.69514872480786*^9, 
   3.695148749919224*^9}, {3.6951493177484818`*^9, 3.695149326785858*^9}, {
   3.695308936778039*^9, 3.6953089472779818`*^9}, {3.698372551337554*^9, 
   3.6983725596158333`*^9}, {3.715714242731134*^9, 3.7157143030464582`*^9}, {
   3.715714356688777*^9, 3.715714402604083*^9}, {3.715714756628631*^9, 
   3.715714759553439*^9}, 3.715714873694858*^9, 3.7157164628129997`*^9, {
   3.7157165478873796`*^9, 3.715716555998968*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"recAM", " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "het"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "pXZhom", " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "hom"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "a", ",", "het"}]]}], "-", 
       RowBox[{"2", " ", "pXZhom", " ", 
        SubscriptBox["\[Alpha]", "het"], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "hom"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "a", ",", "het"}]]}]}], ")"}]}], 
    RowBox[{"2", " ", "freqYWhet", " ", "meanHet"}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{"recAM", " ", 
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "het"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", "2"}], " ", 
         SubscriptBox["\[Alpha]", "het"], " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "hom"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "A", ",", "het"}]]}], "+", 
        RowBox[{"2", " ", "pXZhom", " ", 
         SubscriptBox["\[Alpha]", "het"], " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "hom"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "A", ",", "het"}]]}]}], ")"}]}], 
     RowBox[{"2", " ", "freqYWhet", " ", "meanHet"}]]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6951443122017193`*^9, 3.695144353841468*^9, 3.695144532807579*^9, {
   3.695148731647949*^9, 3.695148750424718*^9}, 3.695149452314231*^9, 
   3.69515268624691*^9, 3.6951531516042137`*^9, 3.695157245884687*^9, 
   3.695220772759243*^9, 3.6952222868541183`*^9, 3.695308896062682*^9, 
   3.695308948060775*^9, 3.6953157044970407`*^9, 3.695399782980154*^9, 
   3.697163203275837*^9, 3.6983729134664583`*^9, 3.698416697777718*^9, 
   3.704155792789847*^9, 3.7156900351162148`*^9, {3.715714268474827*^9, 
   3.7157143218591633`*^9}, 3.715714358998726*^9, 3.715714403402961*^9, 
   3.715714761651141*^9, 3.715714874685416*^9, 3.7157164632218037`*^9, {
   3.7157165495804777`*^9, 3.715716556428973*^9}}]
}, Open  ]],

Cell["Then the b coefficient is", "Text",
 CellChangeTimes->{{3.695072359786347*^9, 3.695072378022644*^9}, {
  3.6950724560667553`*^9, 3.6950724630252237`*^9}, {3.695073174252082*^9, 
  3.6950731890286703`*^9}, {3.695075714432279*^9, 3.695075716927907*^9}, {
  3.6971634146427183`*^9, 3.6971634279404507`*^9}, {3.715715815911368*^9, 
  3.715715822350133*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"bcoef0", "/", 
     RowBox[{"(", 
      RowBox[{"hetMeanFit", "/", "meanHet"}], ")"}]}], "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"noreceigens0", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "+", 
        RowBox[{"noreceigens0", "[", 
         RowBox[{"[", "2", "]"}], "]"}], "-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"recrates0", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"recrates0", "[", 
           RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"\[Lambda]mA", "+", "\[Lambda]ma"}], ")"}], "-", 
        RowBox[{"(", 
         RowBox[{"\[Chi]mA", "+", "\[Chi]ma"}], ")"}]}], ")"}]}], ")"}]}], "/.", 
   RowBox[{"recAM", "\[Rule]", 
    RowBox[{"recAMnotAX", "+", "recAXandAM"}]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.715714185889388*^9, 3.715714201499032*^9}, {
   3.715714362362219*^9, 3.715714370343524*^9}, {3.715714410963152*^9, 
   3.71571444619287*^9}, {3.715714878751705*^9, 3.7157148798074913`*^9}, 
   3.715716468749014*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", 
  SuperscriptBox["freqYWhet", "2"], " ", 
  SuperscriptBox["meanHet", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
   "\[Lambda]ma", "+", "\[Lambda]mA", "-", "\[Chi]ma", "-", "\[Chi]mA"}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.7157142031967363`*^9, 3.715714371439228*^9, {3.715714404885717*^9, 
   3.715714447156732*^9}, {3.715716467120591*^9, 3.715716469420719*^9}, {
   3.7157165516918983`*^9, 3.715716557910108*^9}}]
}, Open  ]],

Cell["And the c coefficient is", "Text",
 CellChangeTimes->{{3.6782189006435003`*^9, 3.6782189222277317`*^9}, 
   3.678543511708593*^9, 3.68190292412112*^9, {3.71571582625451*^9, 
   3.715715828022172*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"ccoef0", "/", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"noreceigens0", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", 
           RowBox[{"recrates0", "[", 
            RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"noreceigens0", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", 
           RowBox[{"recrates0", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "-", 
        RowBox[{
         RowBox[{"recrates0", "[", 
          RowBox[{"[", "1", "]"}], "]"}], 
         RowBox[{"recrates0", "[", 
          RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Lambda]mA", "-", "\[Chi]mA"}], ")"}], 
         RowBox[{"(", " ", 
          RowBox[{"\[Lambda]ma", "-", "\[Chi]ma"}], ")"}]}], "-", " ", 
        RowBox[{"\[Chi]mA", " ", "\[Chi]ma"}]}], ")"}]}], ")"}]}], "/.", 
   RowBox[{"recAM", "\[Rule]", 
    RowBox[{"recAMnotAX", "+", "recAXandAM"}]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6950746224614763`*^9, 3.6950746999628572`*^9}, {
   3.695075850001597*^9, 3.695075853062149*^9}, {3.695075883791338*^9, 
   3.6950758850938272`*^9}, {3.695144386162547*^9, 3.6951444076764517`*^9}, {
   3.695148757753119*^9, 3.6951487636534033`*^9}, {3.695149334703912*^9, 
   3.69514934036537*^9}, 3.695308965140897*^9, {3.697163233138411*^9, 
   3.697163234554199*^9}, {3.697163309775226*^9, 3.697163321534679*^9}, {
   3.697163481346808*^9, 3.697163536441967*^9}, {3.698372572958486*^9, 
   3.698372595317369*^9}, {3.698373073195002*^9, 3.698373076830518*^9}, {
   3.698416430838464*^9, 3.6984164568833513`*^9}, {3.7157144820089617`*^9, 
   3.715714623963455*^9}, {3.7157148822163057`*^9, 3.715714886473887*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", 
  SuperscriptBox["freqYWhet", "2"], " ", 
  SuperscriptBox["meanHet", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Lambda]mA", " ", "\[Chi]ma"}], "+", 
    RowBox[{"\[Lambda]ma", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[Lambda]mA"}], "+", "\[Chi]mA"}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{
  3.69514436414676*^9, 3.695144408303392*^9, 3.695144535676054*^9, 
   3.6951487645475187`*^9, 3.695149452423211*^9, 3.69515268871423*^9, 
   3.695153151704795*^9, 3.695157245968769*^9, 3.695220772845283*^9, 
   3.695222286953323*^9, {3.695308957396916*^9, 3.695308966049164*^9}, 
   3.69531570458337*^9, {3.6971632144286203`*^9, 3.697163235322523*^9}, {
   3.697163312495983*^9, 3.697163322302376*^9}, {3.697163484144363*^9, 
   3.697163536882473*^9}, 3.6983729582679663`*^9, {3.698373068733672*^9, 
   3.6983730773533*^9}, 3.698416698046316*^9, 3.7041557928729677`*^9, 
   3.7156900352064247`*^9, {3.715714560479294*^9, 3.7157146244550323`*^9}, 
   3.715714887614703*^9, 3.71571647213573*^9}]
}, Open  ]],

Cell[TextData[{
 "Note that because all coefficients are proportional to 4 ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["freqYWhet", "2"], " ", 
    SuperscriptBox["meanHet", "2"]}], TraditionalForm]]],
 " and we set the characteristic polynomial to zero then we can drop 4 ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    SuperscriptBox["freqYhet", "2"], 
    SuperscriptBox["meanHet", "2"]}], TraditionalForm]]],
 " from all, making the coefficients: a=1, b=-(\[Lambda]ma+\[Lambda]mA)+(\
\[Chi]ma+\[Chi]mA), c=(\[Lambda]ma-\[Chi]ma)( \[Lambda]mA-\[Chi]mA)- \[Chi]mA \
\[Chi]ma"
}], "Text",
 CellChangeTimes->{{3.695074757560048*^9, 3.695074861301744*^9}, {
  3.695074928468408*^9, 3.695074945379613*^9}, {3.695075727176167*^9, 
  3.695075727344241*^9}, {3.695075773073818*^9, 3.6950757732415*^9}, {
  3.6971635636420927`*^9, 3.6971635698012047`*^9}, {3.698416474640464*^9, 
  3.698416494216708*^9}, {3.715714662542884*^9, 3.715714716526595*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Non-homologous transition", "Subsubsection",
 CellChangeTimes->{{3.681903449113834*^9, 3.681903450516502*^9}, {
   3.6819047924620533`*^9, 3.681904797745571*^9}, 3.6950767092996893`*^9, {
   3.69515845765909*^9, 3.6951584676811*^9}, {3.6953030806166277`*^9, 
   3.695303085396778*^9}, 3.695400116897005*^9, {3.69837562354079*^9, 
   3.698375632596642*^9}, {3.698416361567925*^9, 3.698416367397274*^9}}],

Cell["\<\
When the mutation makes the ancestrally homogametic sex, the characteristic \
polynomial is\
\>", "Text",
 CellChangeTimes->{{3.681903454570097*^9, 3.681903472252966*^9}, 
   3.681903788811371*^9, {3.6983725009352427`*^9, 3.698372509678987*^9}, {
   3.698372636451694*^9, 3.698372636649289*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"takes", " ", "a", " ", "couple", " ", "minutes"}], "*)"}], 
  "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{"charpolyk1", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"charpolyExt", "/.", 
       RowBox[{"k", "\[Rule]", "1"}]}], "/.", "recGen"}], "//", "Factor"}]}], 
   ";"}]}]], "Input",
 CellChangeTimes->{{3.6953225693522463`*^9, 3.69532258914106*^9}, {
   3.695345268236247*^9, 3.6953453020931807`*^9}, {3.695392520916902*^9, 
   3.695392525623684*^9}, {3.697163589439348*^9, 3.697163597182727*^9}, {
   3.6971637208220997`*^9, 3.697163745647808*^9}, 3.697164449552635*^9, {
   3.698372612083707*^9, 3.698372620431135*^9}, {3.698416548471529*^9, 
   3.698416551237054*^9}, {3.698416615283317*^9, 3.698416619177478*^9}}],

Cell["\<\
The coefficients of our characteristic polynomial are (using only the \
relevant factor of the characteristic polynomial)\
\>", "Text",
 CellChangeTimes->{{3.6782188723553667`*^9, 3.678218885483445*^9}, 
   3.678219356203349*^9, {3.69539966921736*^9, 3.69539969669757*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"charpoly\[Alpha]1", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"charpolyk1", "[", 
      RowBox[{"[", "5", "]"}], "]"}], ",", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"acoef1", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"charpoly\[Alpha]1", ",", 
     RowBox[{"\[Lambda]", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bcoef1", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"charpoly\[Alpha]1", ",", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ccoef1", "=", 
   RowBox[{"charpoly\[Alpha]1", "-", 
    RowBox[{"acoef1", " ", 
     RowBox[{"\[Lambda]", "^", "2"}]}], "-", 
    RowBox[{"bcoef1", " ", "\[Lambda]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.678210909322748*^9, 3.678210984920451*^9}, {
   3.678211065387308*^9, 3.6782111248508577`*^9}, {3.678216596004511*^9, 
   3.6782166154301167`*^9}, {3.678216661630507*^9, 3.6782166685831823`*^9}, {
   3.678543435404685*^9, 3.678543437050301*^9}, 3.6819018632616568`*^9, 
   3.6819019221224947`*^9, {3.681902293571035*^9, 3.6819022942054*^9}, {
   3.681903514398522*^9, 3.681903527518437*^9}, {3.6819039026101837`*^9, 
   3.681903904956162*^9}, {3.682920930456254*^9, 3.682920935451797*^9}, {
   3.6858819458333483`*^9, 3.685881946549279*^9}, {3.6868384287249537`*^9, 
   3.6868384290703278`*^9}, {3.695076784105116*^9, 3.6950768229190083`*^9}, {
   3.69530303362877*^9, 3.695303045958336*^9}, {3.6953454219426727`*^9, 
   3.695345435977847*^9}, {3.695392978996325*^9, 3.69539297913235*^9}, 
   3.6953985652326508`*^9, 3.6971637865922537`*^9, {3.697164466415427*^9, 
   3.697164474237372*^9}}],

Cell["The a coefficient can be written", "Text",
 CellChangeTimes->{{3.6782222711717787`*^9, 3.678222291827236*^9}, {
  3.678222442624536*^9, 3.678222466366487*^9}, {3.678543405945023*^9, 
  3.678543417688088*^9}, {3.678543453554411*^9, 3.678543473051293*^9}, {
  3.6785437211897573`*^9, 3.678543723630198*^9}, {3.681901128257367*^9, 
  3.6819011288228273`*^9}, {3.681902959278455*^9, 3.681902959943367*^9}, {
  3.6950724407721357`*^9, 3.6950724441925488`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"acoef1", "/", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"homMeanFit", "/", "meanHom"}], ")"}], "2"]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.678220958334203*^9, 3.678220959366744*^9}, {
   3.678222265836959*^9, 3.678222266627904*^9}, {3.6819007374163027`*^9, 
   3.681900782049633*^9}, 3.681900926695757*^9, {3.681901186789213*^9, 
   3.681901197102724*^9}, {3.681901311334466*^9, 3.6819013184746037`*^9}, {
   3.681901448459179*^9, 3.681901474059561*^9}, {3.681901555374631*^9, 
   3.6819015611958933`*^9}, {3.681901738004952*^9, 3.681901746660657*^9}, {
   3.681901926503386*^9, 3.681901935674559*^9}, 3.68190245993617*^9, 
   3.6819035305096617`*^9, {3.681903953576722*^9, 3.681903983485964*^9}, {
   3.695076828151628*^9, 3.6950768324073668`*^9}, 3.698372655669896*^9}],

Cell[BoxData[
 RowBox[{"4", " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "freqYWhet"}], ")"}], "2"], " ", 
  SuperscriptBox["meanHom", "2"]}]], "Output",
 CellChangeTimes->{
  3.695072348772151*^9, 3.6950767866002417`*^9, {3.6950768255881853`*^9, 
   3.695076832867058*^9}, 3.695141326951125*^9, 3.695303146094379*^9, 
   3.695345440540641*^9, 3.695392752809986*^9, 3.6953929808167057`*^9, 
   3.695398333987789*^9, 3.6953985678851757`*^9, 3.6953991337780123`*^9, {
   3.6953992015783978`*^9, 3.6953992292213497`*^9}, 3.695399706777566*^9, 
   3.69539982646623*^9, 3.695400504643836*^9, {3.6971644704295464`*^9, 
   3.697164476371787*^9}, 3.698373194319263*^9, 3.6984167355704393`*^9, 
   3.704155839421152*^9, 3.7156900723869057`*^9, 3.7157148173668947`*^9}]
}, Open  ]],

Cell["\<\
When there is no recombination between the novel sex determiner and the \
selected locus the eigenvalues are\
\>", "Text",
 CellChangeTimes->{{3.682072590495638*^9, 3.682072598058753*^9}, {
  3.682074822686273*^9, 3.682074840969604*^9}, {3.695072312397974*^9, 
  3.695072330141542*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"noreceigens1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]", "/.", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "\[Equal]", 
           RowBox[{"charpolyk1", "[", 
            RowBox[{"[", "5", "]"}], "]"}]}], "/.", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"recAMnotAX", "+", "recAXandAM"}], "/.", "recGen"}], "//",
              "Simplify"}], ")"}], "\[Rule]", "0"}]}], ",", "\[Lambda]"}], 
        "]"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"homMeanFit", "/", "meanHom"}], ")"}]}], "/.", 
    RowBox[{"pXZhet", "\[Rule]", 
     FractionBox[
      RowBox[{"pAhet", "-", 
       RowBox[{"freqYWhet", " ", "pYWhet"}]}], 
      RowBox[{"(", 
       RowBox[{"1", "-", "freqYWhet"}], ")"}]]}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.682072604849454*^9, 3.682072625018734*^9}, 
   3.682073600958725*^9, 3.6820737987746267`*^9, {3.6829209661252327`*^9, 
   3.682920966235426*^9}, {3.686839642158704*^9, 3.686839642356824*^9}, {
   3.686841508510477*^9, 3.6868415274256353`*^9}, 3.6950723067377853`*^9, {
   3.695076836945448*^9, 3.695076880517518*^9}, {3.695076923358149*^9, 
   3.695076943983383*^9}, {3.695303166164534*^9, 3.695303174390761*^9}, {
   3.695345449555043*^9, 3.695345483754958*^9}, {3.695345523008333*^9, 
   3.695345527457345*^9}, {3.695392925346901*^9, 3.6953929348498096`*^9}, 
   3.695398575539406*^9, {3.695398706489358*^9, 3.695398736395883*^9}, {
   3.695400042920492*^9, 3.6954000665135317`*^9}, {3.697164482091494*^9, 
   3.6971644940624437`*^9}, 3.698372659897635*^9, {3.698416656270331*^9, 
   3.698416690355193*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "hom"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pAhet"}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "het"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "a", ",", "hom"}]]}], "+", 
       RowBox[{"2", " ", "pAhet", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          SubscriptBox["\[Alpha]", "hom"]}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "het"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "A", ",", "hom"}]]}]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "freqYWhet"}], ")"}], " ", "meanHom"}]], ",", 
   
   FractionBox[
    RowBox[{
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "hom"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pAhet"}], ")"}], " ", 
        SubscriptBox["\[Alpha]", "hom"], " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "het"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "a", ",", "hom"}]]}], "-", 
       RowBox[{"pAhet", " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "het"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "A", ",", "hom"}]]}]}], ")"}]}], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "freqYWhet"}], ")"}], " ", "meanHom"}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6950702594604692`*^9, 3.695070275175701*^9}, 
   3.695070397407928*^9, 3.695072308654439*^9, 3.695072354355142*^9, 
   3.695076884615603*^9, {3.695076931534037*^9, 3.695076947936284*^9}, 
   3.695141329802102*^9, 3.695303148789905*^9, 3.6953031788604918`*^9, {
   3.695345459347529*^9, 3.69534547407176*^9}, 3.695345532128199*^9, 
   3.695392757266202*^9, {3.69539292866525*^9, 3.6953929378029003`*^9}, 
   3.695398338849617*^9, {3.695398572405869*^9, 3.6953985785475187`*^9}, {
   3.695398735961882*^9, 3.695398739563991*^9}, 3.695399139108498*^9, {
   3.69539920705241*^9, 3.6953992343377447`*^9}, 3.695399713447668*^9, 
   3.69539992614307*^9, {3.6954000628825493`*^9, 3.695400070036118*^9}, 
   3.695400514822488*^9, {3.69716448406485*^9, 3.697164499796376*^9}, 
   3.69837320195469*^9, 3.6984167388106537`*^9, 3.704155843400715*^9, 
   3.7156900755093203`*^9, 3.715714821647489*^9}]
}, Open  ]],

Cell["\<\
where pAhet is the average frequency of A in gametes from the heterogametic \
sex.\
\>", "Text",
 CellChangeTimes->{{3.695076950154681*^9, 3.69507696237747*^9}, {
  3.698372665698492*^9, 3.698372673189452*^9}, {3.69841669583086*^9, 
  3.6984166980423517`*^9}}],

Cell["\<\
These eigenvalues describe the average growth of mA and ma haplotypes when \
there is no recombination. The rates of loss/gain of haplotypes due to \
recombination are\
\>", "Text",
 CellChangeTimes->{{3.695073075066889*^9, 3.6950731360432787`*^9}, {
   3.695076070899908*^9, 3.695076071873383*^9}, 3.71571478034027*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"noreceigens1", "/.", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "hom"}]], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "recAM"}], ")"}], " ", 
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "hom"}]]}]}]}], "/.", 
   RowBox[{
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "hom"}]], "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "recAM"}], ")"}], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "hom"}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"recrates1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"-", "recAM"}], " ", 
    RowBox[{"Coefficient", "[", " ", 
     RowBox[{"%", ",", "recAM"}], "]"}]}], "//", "Simplify"}]}]}], "Input",
 CellChangeTimes->{{3.6950731428473682`*^9, 3.695073153965623*^9}, {
   3.695076973614365*^9, 3.6950769847756023`*^9}, {3.695345544199114*^9, 
   3.695345551238126*^9}, {3.698372677975556*^9, 3.698372687155015*^9}, {
   3.715714782764382*^9, 3.7157147947799673`*^9}, 3.71571486848628*^9, {
   3.715714960956058*^9, 3.7157149669748793`*^9}, 3.715715127125073*^9, {
   3.715715497171764*^9, 3.71571551673094*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"pAhet", " ", "recAM", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       SubscriptBox["\[Alpha]", "hom"]}], ")"}], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "hom"}]], " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "het"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "hom"}]]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "freqYWhet"}], ")"}], " ", "meanHom"}]], ",", 
   
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pAhet"}], ")"}], " ", "recAM", " ", 
     SubscriptBox["\[Alpha]", "hom"], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "het"}]], " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "hom"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "hom"}]]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "freqYWhet"}], ")"}], " ", "meanHom"}]]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.695073143621293*^9, 3.695073155989633*^9}, 
   3.695076993514533*^9, 3.695141329930606*^9, 3.6953031834626837`*^9, 
   3.695345551999744*^9, 3.695392761651626*^9, 3.695398501436118*^9, 
   3.695399143749045*^9, {3.695399208564883*^9, 3.695399236742137*^9}, 
   3.6953997160996313`*^9, 3.695399926786989*^9, 3.6954000788319387`*^9, 
   3.695400516901978*^9, 3.697164509698595*^9, 3.698373206740086*^9, 
   3.698416738917027*^9, 3.704155843523785*^9, 3.7156900755942802`*^9, 
   3.715714823966282*^9, 3.7157149205723658`*^9, {3.715714962760388*^9, 
   3.71571496727422*^9}, {3.7157151275532703`*^9, 3.715715134018219*^9}, {
   3.715715497497617*^9, 3.715715517075363*^9}}]
}, Open  ]],

Cell["The the b coefficient is", "Text",
 CellChangeTimes->{{3.695072359786347*^9, 3.695072378022644*^9}, {
  3.6950724560667553`*^9, 3.6950724630252237`*^9}, {3.695073174252082*^9, 
  3.6950731890286703`*^9}, {3.695075714432279*^9, 3.695075716927907*^9}, {
  3.715715834414497*^9, 3.715715839422826*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"bcoef1", "/", 
       RowBox[{"(", 
        RowBox[{"homMeanFit", "/", "meanHom"}], ")"}]}], "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"noreceigens1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "+", 
          RowBox[{"noreceigens1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"recrates1", "[", 
             RowBox[{"[", "1", "]"}], "]"}], "+", 
            RowBox[{"recrates1", "[", 
             RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Lambda]mA", "+", "\[Lambda]ma"}], ")"}], "-", 
          RowBox[{"(", 
           RowBox[{"\[Chi]mA", "+", "\[Chi]ma"}], ")"}]}], ")"}]}], ")"}]}], "/.", 
     RowBox[{"pXZhet", "\[Rule]", 
      FractionBox[
       RowBox[{"pAhet", "-", 
        RowBox[{"freqYWhet", " ", "pYWhet"}]}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "freqYWhet"}], ")"}]]}]}], "/.", 
    RowBox[{"recAM", "\[Rule]", 
     RowBox[{"recAMnotAX", "+", "recAXandAM"}]}]}], "/.", "recGen"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.715715699154613*^9, 3.715715725631093*^9}, {
  3.715715762420759*^9, 3.715715794177362*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "freqYWhet"}], ")"}], "2"], " ", 
  SuperscriptBox["meanHom", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
   "\[Lambda]ma", "+", "\[Lambda]mA", "-", "\[Chi]ma", "-", "\[Chi]mA"}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.7157157157823687`*^9, 3.715715727140936*^9}, {
  3.7157157638039417`*^9, 3.715715795002684*^9}}]
}, Open  ]],

Cell["And the c coefficient is", "Text",
 CellChangeTimes->{{3.6782189006435003`*^9, 3.6782189222277317`*^9}, 
   3.678543511708593*^9, 3.68190292412112*^9, {3.715715845088314*^9, 
   3.715715846046938*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"ccoef1", "/", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"noreceigens1", "[", 
              RowBox[{"[", "1", "]"}], "]"}], "-", 
             RowBox[{"recrates1", "[", 
              RowBox[{"[", "1", "]"}], "]"}]}], ")"}], 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"noreceigens1", "[", 
              RowBox[{"[", "2", "]"}], "]"}], "-", 
             RowBox[{"recrates1", "[", 
              RowBox[{"[", "2", "]"}], "]"}]}], ")"}]}], "-", 
          RowBox[{
           RowBox[{"recrates1", "[", 
            RowBox[{"[", "1", "]"}], "]"}], 
           RowBox[{"recrates1", "[", 
            RowBox[{"[", "2", "]"}], "]"}]}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"\[Lambda]mA", "-", "\[Chi]mA"}], ")"}], 
           RowBox[{"(", " ", 
            RowBox[{"\[Lambda]ma", "-", "\[Chi]ma"}], ")"}]}], "-", " ", 
          RowBox[{"\[Chi]mA", " ", "\[Chi]ma"}]}], ")"}]}], ")"}]}], "/.", 
     RowBox[{"recAM", "\[Rule]", 
      RowBox[{"recAMnotAX", "+", "recAXandAM"}]}]}], "/.", "recGen"}], "/.", 
   RowBox[{"pXZhet", "\[Rule]", 
    FractionBox[
     RowBox[{"pAhet", "-", 
      RowBox[{"freqYWhet", " ", "pYWhet"}]}], 
     RowBox[{"(", 
      RowBox[{"1", "-", "freqYWhet"}], ")"}]]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.715715588511087*^9, 3.715715610819621*^9}, 
   3.71571564242677*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", 
  SuperscriptBox[
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "freqYWhet"}], ")"}], "2"], " ", 
  SuperscriptBox["meanHom", "2"], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"\[Lambda]mA", " ", "\[Chi]ma"}], "+", 
    RowBox[{"\[Lambda]ma", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "\[Lambda]mA"}], "+", "\[Chi]mA"}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.7157156042767344`*^9, 3.715715611519279*^9}, 
   3.715715643235442*^9}]
}, Open  ]],

Cell[TextData[{
 "Note that because all coefficients are proportional to 4",
 Cell[BoxData[
  RowBox[{" ", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "freqYWhet"}], ")"}], "2"], " "}]],
  CellChangeTimes->{{3.695074696706077*^9, 3.695074700281722*^9}, 
    3.695075853799673*^9, 3.6950758869080563`*^9, 3.695077136438732*^9, {
    3.695077172459277*^9, 3.695077189514326*^9}, 3.695077223531097*^9, 
    3.695141335222905*^9, 3.69530318963871*^9, {3.695345593495696*^9, 
    3.695345611334631*^9}, 3.695392765089889*^9, 3.695393033826198*^9, 
    3.695399147352895*^9, {3.6953992111483097`*^9, 3.695399239509533*^9}, 
    3.69539972214583*^9, 3.695400098557755*^9, 3.695400532056188*^9, {
    3.697164519410898*^9, 3.697164532525689*^9}}],
 Cell[BoxData[
  FormBox[
   SuperscriptBox["meanHom", "2"], TraditionalForm]]],
 " and we set the characteristic polynomial to zero then we can drop 4 ",
 Cell[BoxData[
  FormBox[
   RowBox[{" ", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "freqYWhet"}], ")"}], "2"], " ", 
     SuperscriptBox["meanHom", "2"]}]}], TraditionalForm]]],
 " from all, making the coefficients",
 ": a=1, b=-(\[Lambda]ma+\[Lambda]mA)+(\[Chi]ma+\[Chi]mA), c=(\[Lambda]ma-\
\[Chi]ma)( \[Lambda]mA-\[Chi]mA)- \[Chi]mA \[Chi]ma"
}], "Text",
 CellChangeTimes->{{3.695074757560048*^9, 3.695074861301744*^9}, {
   3.695074928468408*^9, 3.695074945379613*^9}, {3.695075727176167*^9, 
   3.695075727344241*^9}, {3.695075773073818*^9, 3.6950757732415*^9}, {
   3.695077241287839*^9, 3.695077243687409*^9}, {3.697164539559894*^9, 
   3.697164542058753*^9}, {3.698416781034137*^9, 3.6984168049802027`*^9}, 
   3.71571586861932*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Turnover criteria", "Subsection",
 CellChangeTimes->{{3.6788400973659563`*^9, 3.6788400977552834`*^9}, {
  3.678845422467141*^9, 3.6788454270150137`*^9}, {3.681904868180079*^9, 
  3.681904901055883*^9}, {3.682049495586666*^9, 3.68204951048149*^9}, {
  3.682049998377571*^9, 3.6820500001004353`*^9}, {3.682133805266603*^9, 
  3.682133806694442*^9}}],

Cell[TextData[{
 "Given characteristic polynomial ",
 Cell[BoxData[
  FormBox[
   RowBox[{
    RowBox[{"f", "(", "\[Lambda]", ")"}], "=", 
    RowBox[{
     SuperscriptBox["\[Lambda]", "2"], "+", 
     RowBox[{"b", " ", "\[Lambda]"}], " ", "+", "c"}]}], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " and Perron-Frobenius, we are guaranteed to have at least one \[Lambda]>1 \
when ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["f", "l"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "(1) = 2 + b < 0, or  - b > 2. This is because the Perron-Frobenius theorem \
gaurantees that the leading eigenvalue is positive and real and we know f(\
\[Lambda]) is concave up. Thus, if it has a negative slope at \[Lambda]=1 \
then it will cross zero at some \[Lambda]>1. If this is not true, then we \
will still have at least one \[Lambda]>1 when f(1) = 1 + b + c < 0. Again, \
the leading eigenvalue must be real and postitive and f(\[Lambda]) is concave \
up, so if it is negative at \[Lambda]=1 it must cross zero at some \
\[Lambda]>1."
}], "Text",
 CellChangeTimes->{{3.7157187626221848`*^9, 3.715719007333971*^9}, {
  3.7157191529753113`*^9, 3.715719153590147*^9}, {3.715719184967559*^9, 
  3.715719288555563*^9}, {3.715719352480856*^9, 3.71571938180089*^9}, {
  3.715720168785968*^9, 3.7157201698100853`*^9}, {3.715721417711936*^9, 
  3.715721418447949*^9}, {3.715723665626091*^9, 3.715723820751107*^9}, {
  3.715723862369293*^9, 3.7157238646815357`*^9}, {3.715723919387598*^9, 
  3.7157239739257936`*^9}, {3.715724011943788*^9, 3.715724019856412*^9}, {
  3.7157240985172663`*^9, 3.715724264090788*^9}}],

Cell[TextData[{
 "In both cases above we have -b =  (\[Lambda]mA - \[Chi]mA) + (\[Lambda]ma - \
\[Chi]ma). We therefore have at least one \[Lambda]>1 whenever ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]mA", " ", "-", " ", "\[Chi]mA"}], ")"}], " ", "+", 
     " ", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]ma", " ", "-", " ", "\[Chi]ma"}], ")"}]}], "2"], 
   TraditionalForm]],
  FormatType->"TraditionalForm"],
 " > 1. In words, the neo-SD is guaranteed to spread when the average mutant \
haplotype growth rate, when considering the fact that recombination breaks up \
mutant haplotypes (but not considering the fact that recombination also \
creates mutant haplotypes), is greater than 1.\n\nThe second condition, 1 + b \
+ c < 0, implies  (\[Lambda]mA - \[Chi]mA) + (\[Lambda]ma - \[Chi]ma)  - (\
\[Lambda]mA - \[Chi]mA) (\[Lambda]ma - \[Chi]ma) + \[Chi]mA \[Chi]ma > 1. And \
this can be rearranged to give \n\[Chi]ma (\[Lambda]mA - 1) + \[Chi]mA (\
\[Lambda]ma - 1) > (\[Lambda]mA - 1) (\[Lambda]ma - 1) "
}], "Text",
 CellChangeTimes->{{3.715719419731017*^9, 3.7157198192108097`*^9}, {
   3.715719864020382*^9, 3.715719944240241*^9}, 3.715719982801859*^9, {
   3.715720127264208*^9, 3.71572014229687*^9}, {3.715720242396806*^9, 
   3.715720243796688*^9}, {3.715720801047925*^9, 3.71572084023905*^9}, {
   3.715721011742366*^9, 3.715721019142379*^9}, {3.715721052897386*^9, 
   3.7157210530961533`*^9}, {3.7157214228322906`*^9, 
   3.7157214520728283`*^9}, {3.715724284317243*^9, 3.715724289523841*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Lambda]mA", " ", "-", " ", "\[Chi]mA"}], ")"}], " ", "+", " ", 
    RowBox[{"(", 
     RowBox[{"\[Lambda]ma", " ", "-", " ", "\[Chi]ma"}], ")"}], "  ", "-", 
    " ", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]mA", " ", "-", " ", "\[Chi]mA"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]ma", " ", "-", " ", "\[Chi]ma"}], ")"}]}], " ", "+", 
    " ", 
    RowBox[{"\[Chi]mA", " ", "\[Chi]ma"}], " ", "-", " ", "1"}], "==", 
   RowBox[{
    RowBox[{"\[Chi]ma", " ", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]mA", "-", "1"}], ")"}]}], "+", 
    RowBox[{"\[Chi]mA", " ", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]ma", "-", "1"}], ")"}]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]mA", "-", "1"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]ma", "-", "1"}], ")"}]}]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.715721027348421*^9, 3.715721048069556*^9}, {
  3.715721461634843*^9, 3.715721464474586*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.7157210484005632`*^9, 3.7157214650975437`*^9}]
}, Open  ]],

Cell[TextData[{
 "When both \[Lambda]mA and \[Lambda]ma are less than 1, the left hand side \
is negative while the right hand side is positive. Thus, the neo-SD never \
invades when neither haplotype can grow in the absence of recombination. If \
both \[Lambda]mA and \[Lambda]ma are greater than 1 we can rearrange the \
condition into ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{" ", "\[Chi]ma", " "}], 
    RowBox[{"\[Lambda]ma", "-", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " + ",
 Cell[BoxData[
  FormBox[
   FractionBox[
    RowBox[{"\[Chi]mA", " "}], 
    RowBox[{"\[Lambda]mA", "-", "1"}]], TraditionalForm]],
  FormatType->"TraditionalForm"],
 "  > 1"
}], "Text",
 CellChangeTimes->{{3.715721276545784*^9, 3.7157213181472893`*^9}, {
   3.715721472826126*^9, 3.715721531156227*^9}, {3.715721592127339*^9, 
   3.715721661260517*^9}, {3.7157216967084513`*^9, 3.7157217960389*^9}, {
   3.715724297532874*^9, 3.715724301532427*^9}, 3.715724333757893*^9}],

Cell[CellGroupData[{

Cell["Homologous transition", "Subsubsection",
 CellChangeTimes->{{3.6819049103666162`*^9, 3.681904911602844*^9}, 
   3.681919037006514*^9, {3.685883643980145*^9, 3.6858836509965467`*^9}, 
   3.685938513793317*^9, {3.698372804702978*^9, 3.698372807167781*^9}, 
   3.6983756388062963`*^9, {3.698416371106061*^9, 3.698416373602171*^9}}],

Cell["\<\
The growth rates of the haplotypes (where mA and ma haplotypes are lost due \
to recombination in double heterozygotes) can be used to reduce the 2a+b<0 \
condition to\
\>", "Text",
 CellChangeTimes->{{3.678846177746627*^9, 3.6788461948713303`*^9}, {
   3.678846297134678*^9, 3.678846304582315*^9}, 3.681904868184037*^9, {
   3.6819181257275543`*^9, 3.681918148392576*^9}, {3.681918434462582*^9, 
   3.681918438682802*^9}, 3.6820738884263678`*^9, {3.682074646596445*^9, 
   3.682074673628763*^9}, {3.6820748692592487`*^9, 3.6820748701295443`*^9}, {
   3.6820752534076853`*^9, 3.6820752572028427`*^9}, {3.682075337627179*^9, 
   3.682075379037554*^9}, {3.68213584629224*^9, 3.68213584968274*^9}, {
   3.682921122334539*^9, 3.682921150766326*^9}, {3.695158271442896*^9, 
   3.695158271601583*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gAsub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gA", "==", 
         RowBox[{
          RowBox[{"noreceigens0", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "/.", 
        RowBox[{
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "A", ",", "het"}]], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "recAM"}], ")"}], " ", 
          SubscriptBox["wDip", 
           RowBox[{"a", ",", "A", ",", "het"}]]}]}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"A", ",", "A", ",", "het"}]]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gasub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ga", "==", 
         RowBox[{
          RowBox[{"noreceigens0", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "/.", 
        RowBox[{
         SubscriptBox["wDip", 
          RowBox[{"A", ",", "a", ",", "het"}]], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "recAM"}], ")"}], " ", 
          SubscriptBox["wDip", 
           RowBox[{"A", ",", "a", ",", "het"}]]}]}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"a", ",", "a", ",", "het"}]]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"acoef0", "/", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"hetMeanFit", "/", "meanHet"}], ")"}], "2"]}]}], "+", 
        RowBox[{"bcoef0", "/", 
         RowBox[{"(", 
          RowBox[{"hetMeanFit", "/", "meanHet"}], ")"}]}]}], ")"}], "<", 
      "0"}], "/.", "gasub"}], "/.", "gAsub"}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"%", "/.", 
      RowBox[{"recAMnotAX", "\[Rule]", 
       RowBox[{"recAM", "-", "recAXandAM"}]}]}], "/.", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "het"}]], "\[Rule]", 
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "het"}]]}]}], ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"meanHet", ">", "0"}], ",", 
      RowBox[{"0", "<", "freqYWhet", "<", "1"}]}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"gA", "\[Rule]", 
    RowBox[{
     RowBox[{"2", "gmean"}], "-", "ga"}]}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6829210136923923`*^9, 3.682921043916086*^9}, {
  3.6868397821144247`*^9, 3.686839792584222*^9}, {3.686840084855525*^9, 
  3.686840085961582*^9}, {3.695158262837906*^9, 3.695158273373581*^9}, {
  3.695400181469186*^9, 3.6954002566273813`*^9}, {3.697164601948596*^9, 
  3.697164607193922*^9}, {3.698372787100185*^9, 3.698372796386629*^9}, {
  3.69837325083358*^9, 3.698373270072544*^9}, {3.698416837139573*^9, 
  3.6984168403786783`*^9}}],

Cell[BoxData[
 RowBox[{"gmean", ">", "0"}]], "Output",
 CellChangeTimes->{
  3.68292100540563*^9, 3.682921045569826*^9, 3.685529987606135*^9, 
   3.685716550175064*^9, 3.685937372753768*^9, 3.686839650349856*^9, {
   3.686839789429785*^9, 3.6868397929594297`*^9}, 3.686840086632612*^9, 
   3.6868415150236607`*^9, 3.6869077912137823`*^9, 3.686909858563302*^9, 
   3.695068340574161*^9, 3.695076684493311*^9, {3.695158258860722*^9, 
   3.695158274481619*^9}, {3.695400168829262*^9, 3.69540020454117*^9}, {
   3.695400244962219*^9, 3.695400257385276*^9}, 3.695400534191435*^9, 
   3.697164551619801*^9, 3.697164607782803*^9, {3.698373246870843*^9, 
   3.698373272968207*^9}, {3.698416830905774*^9, 3.698416840703951*^9}, 
   3.704155844248127*^9, 3.715690076209934*^9, 3.715715897658577*^9, 
   3.715716191965272*^9}]
}, Open  ]],

Cell["\<\
Note that gmean is less than the average haplotypic growth rate in the \
absence of recombination, precisely because it does not incorporate \
haplotypes created by recombination (only the rate of loss)\
\>", "Text",
 CellChangeTimes->{{3.715690960714571*^9, 3.715690962402583*^9}, {
  3.7156910609649563`*^9, 3.7156910944611473`*^9}, {3.715706821994297*^9, 
  3.7157068606429234`*^9}, {3.715706898854439*^9, 3.715706945022951*^9}, {
  3.715708939309197*^9, 3.715708940804932*^9}, {3.715715971469511*^9, 
  3.715715984533042*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gaR0term", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"noreceigens0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "/.", " ", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "het"}]], "\[Rule]", " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "het"}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gAR0term", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"noreceigens0", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], "/.", " ", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "het"}]], "\[Rule]", " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "het"}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gaterm", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"noreceigens0", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "/.", " ", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "het"}]], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "recAM"}], ")"}], " ", 
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "het"}]]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gAterm", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"noreceigens0", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], "/.", " ", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "het"}]], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "recAM"}], ")"}], " ", 
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "het"}]]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    FractionBox[
     RowBox[{"gaR0term", "+", "gAR0term"}], "2"], ")"}], "-", 
   FractionBox[
    RowBox[{"gaterm", "+", "gAterm"}], "2"]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.715690605859845*^9, 3.7156906298095903`*^9}, {
   3.7156911368786373`*^9, 3.715691239312644*^9}, {3.71569127403557*^9, 
   3.7156913419466667`*^9}, {3.715691419131422*^9, 3.715691426683298*^9}, {
   3.7156914702366333`*^9, 3.715691498839129*^9}, {3.715691547480071*^9, 
   3.71569156292826*^9}, 3.715692004833913*^9, {3.7156924527754183`*^9, 
   3.715692487968485*^9}, {3.7156957382388077`*^9, 3.7156957773358393`*^9}, {
   3.715695839215905*^9, 3.7156958417293158`*^9}, {3.715695880000136*^9, 
   3.715695882417403*^9}, {3.7156961465342617`*^9, 3.715696156550856*^9}, {
   3.715706886084248*^9, 3.7157068893596077`*^9}, {3.7157089459274483`*^9, 
   3.715708946095148*^9}, 3.715712267759655*^9, {3.715716136736985*^9, 
   3.7157161694566107`*^9}, {3.715716242043787*^9, 3.715716258627305*^9}, 
   3.7157163209273987`*^9, {3.7157163918181257`*^9, 3.715716391944502*^9}}],

Cell[BoxData[
 FractionBox[
  RowBox[{"recAM", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"pXZhom", " ", 
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "het"}]], " ", 
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "hom"}]]}], "-", 
     RowBox[{
      SubscriptBox["\[Alpha]", "het"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pXZhom"}], ")"}], " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "hom"}]], " ", 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "het"}]]}], "+", 
        RowBox[{"pXZhom", " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "het"}]], " ", 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "hom"}]]}]}], ")"}]}]}], ")"}], " ", 
   SubscriptBox["wDip", 
    RowBox[{"A", ",", "a", ",", "het"}]]}], 
  RowBox[{"2", " ", "freqYWhet", " ", "meanHet"}]]], "Output",
 CellChangeTimes->{{3.715690621209343*^9, 3.715690634671921*^9}, {
   3.715691227320858*^9, 3.7156912398523273`*^9}, {3.7156912836389723`*^9, 
   3.715691303616148*^9}, 3.715691342670641*^9, 3.715691427110923*^9, {
   3.715691492106741*^9, 3.715691499354039*^9}, {3.715691552954258*^9, 
   3.7156915633178463`*^9}, 3.715692005399893*^9, {3.715692472672084*^9, 
   3.7156924885500793`*^9}, {3.715695753205546*^9, 3.715695777580988*^9}, 
   3.7156958421119423`*^9, 3.7156958829992723`*^9, {3.715696150936417*^9, 
   3.715696156882655*^9}, 3.715706948919692*^9, {3.715708946719288*^9, 
   3.715708974927957*^9}, 3.715712268226808*^9, {3.715716179402636*^9, 
   3.7157161936980343`*^9}, {3.715716248950054*^9, 3.715716259181603*^9}, 
   3.715716321262163*^9, {3.7157163924583807`*^9, 3.71571640708806*^9}, 
   3.715716498373377*^9, 3.7157165805227118`*^9}]
}, Open  ]],

Cell["\<\
This difference is just the average rate of haplotype creation/loss by \
recombination\
\>", "Text",
 CellChangeTimes->{{3.715708953021309*^9, 3.715708997191442*^9}, {
  3.715715997712098*^9, 3.715716038567553*^9}, {3.7157165870233517`*^9, 
  3.715716587727373*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"%", "==", 
    FractionBox[
     RowBox[{
      RowBox[{"recrates0", "[", 
       RowBox[{"[", "1", "]"}], "]"}], "+", 
      RowBox[{"recrates0", "[", 
       RowBox[{"[", "2", "]"}], "]"}]}], "2"]}], "/.", 
   RowBox[{
    SubscriptBox["wDip", 
     RowBox[{"a", ",", "A", ",", "het"}]], "->", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "het"}]]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.715708792110608*^9, 3.7157089005258904`*^9}, {
   3.715708973327379*^9, 3.715708973720561*^9}, 3.71571640551584*^9, {
   3.715716480381444*^9, 3.715716496924876*^9}, {3.715716572440267*^9, 
   3.715716577976481*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.715708794079932*^9, 3.71570890133138*^9}, 
   3.7157089758278008`*^9, 3.715716204012631*^9, 3.7157162724322987`*^9, 
   3.7157163238945427`*^9, {3.715716399639803*^9, 3.7157164083381567`*^9}, {
   3.715716497184544*^9, 3.715716499562046*^9}, {3.7157165783689938`*^9, 
   3.715716581221705*^9}}]
}, Open  ]],

Cell[TextData[{
 "So the gmean>0 condition can also be written as ",
 Cell[BoxData[
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]mA", "-", "\[Chi]mA"}], ")"}], "+", 
     RowBox[{"(", 
      RowBox[{"\[Lambda]ma", "-", "\[Chi]ma"}], ")"}]}], "2"], ">", "1"}]],
  CellChangeTimes->{{3.7157122937183237`*^9, 3.715712508122881*^9}, {
    3.715712593579543*^9, 3.715712608988578*^9}, {3.715712641568038*^9, 
    3.715712641878623*^9}, {3.715712685151793*^9, 3.7157126875679483`*^9}, {
    3.715716059026249*^9, 3.7157160660342712`*^9}, {3.715716624442992*^9, 
    3.715716633121764*^9}, 3.715716664756736*^9}]
}], "Text",
 CellChangeTimes->{{3.7157122441410227`*^9, 3.7157122580678873`*^9}, {
  3.715716675845428*^9, 3.715716695107057*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Lambda]mA", "-", "\[Chi]mA"}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]ma", "-", "\[Chi]ma"}], ")"}]}], "2"], "-", "1", 
       "-", 
       FractionBox[
        RowBox[{"gaterm", "+", "gAterm"}], "2"]}], "/.", 
      RowBox[{"\[Lambda]mA", "\[Rule]", 
       RowBox[{"gAR0term", "+", "1"}]}]}], "/.", 
     RowBox[{"\[Lambda]ma", "\[Rule]", 
      RowBox[{"gaR0term", "+", "1"}]}]}], "/.", 
    RowBox[{"\[Chi]ma", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "recAM"}], " ", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"gaterm", ",", "recAM"}], "]"}]}]}]}], "/.", 
   RowBox[{"\[Chi]mA", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "recAM"}], " ", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"gAterm", ",", "recAM"}], "]"}]}]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7157122937183237`*^9, 3.715712508122881*^9}, {
   3.715712593579543*^9, 3.715712608988578*^9}, {3.715712641568038*^9, 
   3.715712641878623*^9}, {3.715712685151793*^9, 3.7157126875679483`*^9}, {
   3.715716059026249*^9, 3.7157160660342712`*^9}, {3.715716624442992*^9, 
   3.715716633121764*^9}, 3.715716664756736*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.715712489814581*^9, 3.7157125090584803`*^9}, 
   3.7157125969019136`*^9, 3.715712642336117*^9, 3.715712687973708*^9, {
   3.715716061951891*^9, 3.715716066450733*^9}, 3.715716413369102*^9, 
   3.7157165913514*^9, {3.7157166335578213`*^9, 3.715716665697274*^9}}]
}, Open  ]],

Cell["\<\
So we need b<2 (which of course makes sense given a=1!)\
\>", "Text",
 CellChangeTimes->{{3.715716766678954*^9, 3.715716796032207*^9}}],

Cell["\<\
Using the no recombination growth rates\
\>", "Text",
 CellChangeTimes->{{3.715691380194187*^9, 3.7156913870206957`*^9}, {
  3.715713035133795*^9, 3.7157130352858477`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gAssub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"gAs", "==", 
        RowBox[{
         RowBox[{"noreceigens0", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"A", ",", "A", ",", "het"}]]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gassub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"gas", "==", 
        RowBox[{
         RowBox[{"noreceigens0", "[", 
          RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"a", ",", "a", ",", "het"}]]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.682076240360557*^9, 3.682076268754534*^9}, {
  3.682076396486938*^9, 3.682076412028656*^9}, {3.682135860843622*^9, 
  3.68213590604279*^9}, {3.68213618568095*^9, 3.682136209993085*^9}, {
  3.682136596535293*^9, 3.68213659853424*^9}, {3.682141087988123*^9, 
  3.6821410982907047`*^9}, {3.682142560340249*^9, 3.682142636129263*^9}, {
  3.682921067132358*^9, 3.6829210988955727`*^9}, {3.6868400936644163`*^9, 
  3.686840097051105*^9}, {3.698372813871789*^9, 3.698372817525672*^9}}],

Cell["our final condition a+b+c<0 is", "Text",
 CellChangeTimes->{{3.678803649407956*^9, 3.678803654081893*^9}, {
   3.6788053785896177`*^9, 3.678805380997744*^9}, {3.678841377839574*^9, 
   3.678841379596589*^9}, {3.678846310941874*^9, 3.678846311165923*^9}, {
   3.678846365316596*^9, 3.678846371932901*^9}, 3.68190486818493*^9, {
   3.6820744248656063`*^9, 3.682074428658678*^9}, {3.682075474227734*^9, 
   3.682075478252342*^9}, {3.682076943070528*^9, 3.682076950907119*^9}, 
   3.715716729406467*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"acoef0", "/", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"hetMeanFit", "/", "meanHet"}], ")"}], "2"]}], "+", 
           RowBox[{"bcoef0", "/", 
            RowBox[{"(", 
             RowBox[{"hetMeanFit", "/", "meanHet"}], ")"}]}], "+", "ccoef0"}],
           ")"}], "<", "0"}], "/.", "gassub"}], "/.", "gAssub"}], "/.", 
      RowBox[{
       SubscriptBox["wDip", 
        RowBox[{"a", ",", "A", ",", "het"}]], "\[Rule]", 
       SubscriptBox["wDip", 
        RowBox[{"A", ",", "a", ",", "het"}]]}]}], "/.", 
     RowBox[{"recAMnotAX", "\[Rule]", 
      RowBox[{"recAM", "-", "recAXandAM"}]}]}], "//", "Simplify"}], ",", 
   RowBox[{"{", 
    RowBox[{"meanHet", ",", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "het"}]], ",", "recAM"}], "}"}], ",", 
   "Simplify"}], "]"}]], "Input",
 CellChangeTimes->{
  3.6819186061722803`*^9, {3.681918730408938*^9, 3.681918740649404*^9}, {
   3.6819187744500637`*^9, 3.681918810085658*^9}, {3.681918917500854*^9, 
   3.681918991367647*^9}, {3.68207270511596*^9, 3.6820727779319553`*^9}, {
   3.6820729165752974`*^9, 3.682072916751048*^9}, {3.682074413428846*^9, 
   3.682074415553273*^9}, {3.682075480755356*^9, 3.682075487160922*^9}, {
   3.682135890801907*^9, 3.682135892951301*^9}, {3.682141102704295*^9, 
   3.682141104099745*^9}, {3.695400262586536*^9, 3.6954002886629972`*^9}, {
   3.69837282246768*^9, 3.698372838889559*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox["freqYWhet", "2"], " ", "gas", " ", "gAs", " ", 
    SuperscriptBox["meanHet", "2"]}], "+", 
   RowBox[{"freqYWhet", " ", "meanHet", " ", "recAM", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "gAs"}], " ", "pXZhom", " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "het"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "hom"}]]}], "+", 
      RowBox[{
       SubscriptBox["\[Alpha]", "het"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"gas", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "pXZhom"}], ")"}], " ", 
          SubscriptBox["wHap", 
           RowBox[{"a", ",", "hom"}]], " ", 
          SubscriptBox["wHap", 
           RowBox[{"A", ",", "het"}]]}], "+", 
         RowBox[{"gAs", " ", "pXZhom", " ", 
          SubscriptBox["wHap", 
           RowBox[{"a", ",", "het"}]], " ", 
          SubscriptBox["wHap", 
           RowBox[{"A", ",", "hom"}]]}]}], ")"}]}]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "het"}]]}]}], "<", "0"}]], "Output",
 CellChangeTimes->{
  3.681918572925273*^9, 3.681918606886701*^9, {3.6819187308962708`*^9, 
   3.68191874093325*^9}, {3.6819187831120443`*^9, 3.6819188104237127`*^9}, 
   3.6819188875906143`*^9, 3.6819189191118*^9, {3.6819189505788927`*^9, 
   3.681918991796973*^9}, {3.682072742840137*^9, 3.6820727785851097`*^9}, 
   3.682072830321917*^9, 3.682072864375649*^9, 3.682072917215744*^9, 
   3.682073973360104*^9, 3.682074417019013*^9, 3.682075488294463*^9, 
   3.682075729852219*^9, {3.682076247959779*^9, 3.682076270770035*^9}, {
   3.6820764027849703`*^9, 3.682076426488117*^9}, 3.682076541792549*^9, {
   3.682076901018712*^9, 3.682076909234456*^9}, 3.682135617472797*^9, {
   3.682135896839862*^9, 3.682135908064682*^9}, {3.682136566301485*^9, 
   3.6821365787637997`*^9}, {3.682141100107986*^9, 3.682141110445961*^9}, {
   3.682142543362563*^9, 3.682142638724777*^9}, {3.682921077347794*^9, 
   3.682921100549272*^9}, 3.685529994390254*^9, 3.6857165504664383`*^9, 
   3.685937372990691*^9, 3.685938339611361*^9, 3.686839802462315*^9, 
   3.686840099405183*^9, 3.686841520024716*^9, 3.686907791453293*^9, 
   3.6869098588398333`*^9, 3.695068342670463*^9, 3.695076691575248*^9, 
   3.695158279458345*^9, 3.6954002094038677`*^9, {3.695400260552334*^9, 
   3.695400289209014*^9}, 3.697164614552477*^9, 3.698373277964242*^9, 
   3.698416854208444*^9, 3.704155844529498*^9, 3.715690076433667*^9, 
   3.715715907476632*^9}]
}, Open  ]],

Cell["which can be rearranged into", "Text",
 CellChangeTimes->{{3.682076957315551*^9, 3.682076963194953*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"recAM", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"gAs", " ", "pXZhom", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "het"]}], ")"}], 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "het"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "hom"}]]}], "+", " ", 
      RowBox[{"gas", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "pXZhom"}], ")"}], 
       SubscriptBox["\[Alpha]", "het"], " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "hom"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "het"}]]}]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "het"}]]}], ">", 
   RowBox[{"freqYWhet", " ", "meanHet", " ", "gas", " ", "gAs"}]}], " ", 
  ";"}]], "Input",
 CellChangeTimes->{{3.698416867327417*^9, 3.698416951128697*^9}, {
  3.6984170026444197`*^9, 3.6984170714416103`*^9}}],

Cell["\<\
If both ga>0 and gA>0 (implying that gas and gAs are both positive) then \
2a+b<0 and the neo-Y (W) invades. If both gas<0 and gAs<0 then a+b+c<0 is \
never true and the neo-Y(W) will not invade. So the interesting part is when \
one gs is positive and one negative. If we assume, without loss of \
generality, that gAs>0 and gas<0, the product gas gAs is negative. Dividing \
through and flipping the inequality:\
\>", "Text",
 CellChangeTimes->{{3.678845089552334*^9, 3.678845160444935*^9}, 
   3.678846328049347*^9, 3.681904868185585*^9, {3.682056686187016*^9, 
   3.682056729646557*^9}, {3.682056760907091*^9, 3.6820567859103727`*^9}, {
   3.6820568469095783`*^9, 3.682056944805656*^9}, {3.68205710368909*^9, 
   3.682057103898336*^9}, {3.682067950834725*^9, 3.6820679520530567`*^9}, {
   3.682077031261086*^9, 3.68207703751306*^9}, {3.6821359337426577`*^9, 
   3.682135980316546*^9}, {3.6821360167583*^9, 3.682136022613071*^9}, {
   3.6821407008899813`*^9, 3.682140701020369*^9}, {3.68214112726053*^9, 
   3.6821411586928167`*^9}, {3.682141684924884*^9, 3.682141710615905*^9}, {
   3.686840194509655*^9, 3.686840205697631*^9}, {3.698372868244814*^9, 
   3.6983728765448437`*^9}, {3.7157168335940447`*^9, 3.715716833905941*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"recAM", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"  ", 
        RowBox[{"pXZhom", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", 
           SubscriptBox["\[Alpha]", "het"]}], ")"}], 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "het"}]], " ", 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "hom"}]]}]}], "gas"], "+", " ", 
      FractionBox[
       RowBox[{" ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "pXZhom"}], ")"}], 
         SubscriptBox["\[Alpha]", "het"], " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "hom"}]], " ", 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "het"}]]}]}], "gAs"]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "het"}]]}], "<", 
   RowBox[{"freqYWhet", " ", "meanHet"}]}], " ", ";"}]], "Input",
 CellChangeTimes->{{3.698417099515519*^9, 3.698417130446162*^9}, {
  3.698419372543909*^9, 3.6984193751837597`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Non-homologous transition", "Subsubsection",
 CellChangeTimes->{{3.6819049103666162`*^9, 3.681904911602844*^9}, {
   3.695158473506575*^9, 3.695158473835054*^9}, 3.695400314379199*^9, 
   3.698375641425357*^9, 3.698416376938349*^9}],

Cell["\<\
The growth rates of the haplotypes (where mA and ma haplotypes are lost due \
to recombination R in double heterozygotes, but we ignore the gain due to \
recombination) can be used to reduce the 2a+b<0 condition to\
\>", "Text",
 CellChangeTimes->{{3.678846177746627*^9, 3.6788461948713303`*^9}, {
   3.678846297134678*^9, 3.678846304582315*^9}, 3.681904868184037*^9, {
   3.6819181257275543`*^9, 3.681918148392576*^9}, {3.681918434462582*^9, 
   3.681918438682802*^9}, 3.6820738884263678`*^9, {3.682074646596445*^9, 
   3.682074673628763*^9}, {3.6820748692592487`*^9, 3.6820748701295443`*^9}, {
   3.6820752534076853`*^9, 3.6820752572028427`*^9}, {3.682075337627179*^9, 
   3.682075379037554*^9}, {3.68213584629224*^9, 3.68213584968274*^9}, {
   3.682921122334539*^9, 3.682921150766326*^9}, {3.7156998104966784`*^9, 
   3.715699822616516*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gasub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ga", "==", 
         RowBox[{
          RowBox[{"noreceigens1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "/.", " ", 
        RowBox[{
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "A", ",", "hom"}]], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "recAM"}], ")"}], " ", 
          SubscriptBox["wDip", 
           RowBox[{"a", ",", "A", ",", "hom"}]]}]}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"a", ",", "a", ",", "hom"}]]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gAsub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gA", "==", 
         RowBox[{
          RowBox[{"noreceigens1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "/.", " ", 
        RowBox[{
         SubscriptBox["wDip", 
          RowBox[{"A", ",", "a", ",", "hom"}]], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "recAM"}], ")"}], " ", 
          SubscriptBox["wDip", 
           RowBox[{"A", ",", "a", ",", "hom"}]]}]}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"A", ",", "A", ",", "hom"}]]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"acoef1", "/", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"homMeanFit", "/", "meanHom"}], ")"}], "2"]}]}], "+", 
          RowBox[{"bcoef1", "/", 
           RowBox[{"(", 
            RowBox[{"homMeanFit", "/", "meanHom"}], ")"}]}]}], ")"}], "/", 
        SuperscriptBox["meanHom", "2"]}], "<", "0"}], "/.", 
      RowBox[{"pXZhet", "\[Rule]", 
       FractionBox[
        RowBox[{"pAhet", "-", 
         RowBox[{"freqYWhet", " ", "pYWhet"}]}], 
        RowBox[{"(", 
         RowBox[{"1", "-", "freqYWhet"}], ")"}]]}]}], "/.", "gAsub"}], "/.", 
    "gasub"}], "//", "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"FullSimplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"%", "/.", 
       RowBox[{
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "A", ",", "hom"}]], "\[Rule]", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "a", ",", "hom"}]]}]}], "/.", 
      RowBox[{"ga", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "gA"}], "+", 
        RowBox[{"2", "gmean"}]}]}]}], "/.", 
     RowBox[{"recAM", "\[Rule]", 
      RowBox[{"recAMnotAX", "+", "recAXandAM"}]}]}], "/.", "recGen"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"meanHom", ">", "0"}], ",", 
     RowBox[{"0", "<", "freqYWhet", "<", "1"}]}], "}"}]}], "]"}]}], "Input",
 CellChangeTimes->{{3.681918233431054*^9, 3.681918421388166*^9}, {
   3.681918469375478*^9, 3.6819184696386013`*^9}, {3.681918866852846*^9, 
   3.681918908154718*^9}, 3.682075570346508*^9, {3.682141251053735*^9, 
   3.682141253114156*^9}, {3.68214134600408*^9, 3.68214134740231*^9}, {
   3.6821414396941357`*^9, 3.682141452148271*^9}, 3.6868417428293753`*^9, {
   3.6954001291475973`*^9, 3.695400134680563*^9}, 3.695400328883573*^9, 
   3.695400451755189*^9, {3.695400541423141*^9, 3.695400576738228*^9}, {
   3.697164739757848*^9, 3.697164744301675*^9}, {3.698373291275455*^9, 
   3.698373331021504*^9}, {3.698419193299836*^9, 3.69841920676132*^9}, {
   3.715690843224533*^9, 3.715690891402875*^9}}],

Cell[BoxData[
 RowBox[{"gmean", ">", "0"}]], "Output",
 CellChangeTimes->{{3.68191839577896*^9, 3.681918419133647*^9}, 
   3.681918470286449*^9, {3.681918870254158*^9, 3.6819188780079813`*^9}, 
   3.681918908932249*^9, 3.6820678797229843`*^9, 3.6820755708955708`*^9, 
   3.682076174531219*^9, 3.682141454119433*^9, 3.685531274062457*^9, 
   3.6857165517508793`*^9, 3.685938604672781*^9, 3.686382283520097*^9, 
   3.6868416347655153`*^9, {3.686841722578966*^9, 3.686841745777586*^9}, 
   3.686909865986678*^9, 3.69506930147674*^9, 3.6950772877175207`*^9, 
   3.695400151829401*^9, 3.6954003177565327`*^9, 3.695400452161377*^9, {
   3.695400559553398*^9, 3.695400577186946*^9}, {3.697164734731451*^9, 
   3.697164744859188*^9}, 3.698373338201088*^9, {3.698419204637157*^9, 
   3.698419207959382*^9}, 3.704155851211467*^9, 3.7156903053126707`*^9, {
   3.715690850632762*^9, 3.715690856839553*^9}, 3.715690891803482*^9, 
   3.715715888569372*^9}]
}, Open  ]],

Cell["\<\
Note that gmean is less than the average haplotypic growth rate in the \
absence of recombination, precisely because it does not incorporate \
haplotypes created by recombination (only the rate of loss)\
\>", "Text",
 CellChangeTimes->{{3.715690960714571*^9, 3.715690962402583*^9}, {
  3.7156910609649563`*^9, 3.7156910944611473`*^9}, {3.715706821994297*^9, 
  3.7157068606429234`*^9}, {3.715706898854439*^9, 3.715706945022951*^9}, {
  3.715708939309197*^9, 3.715708940804932*^9}, {3.715715971469511*^9, 
  3.715715984533042*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gaR0term", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"noreceigens1", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "/.", " ", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "hom"}]], "\[Rule]", " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "hom"}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gAR0term", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"noreceigens1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], "/.", " ", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "hom"}]], "\[Rule]", " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "hom"}]]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gaterm", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"noreceigens1", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "/.", " ", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "hom"}]], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "recAM"}], ")"}], " ", 
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "hom"}]]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gAterm", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"noreceigens1", "[", 
      RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], "/.", " ", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "hom"}]], "\[Rule]", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "recAM"}], ")"}], " ", 
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "hom"}]]}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      FractionBox[
       RowBox[{"gaR0term", "+", "gAR0term"}], "2"], ")"}], "-", 
     FractionBox[
      RowBox[{"gaterm", "+", "gAterm"}], "2"]}], "/.", 
    RowBox[{"recAM", "\[Rule]", 
     RowBox[{"recAMnotAX", "+", "recAXandAM"}]}]}], "/.", "recGen"}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.715690605859845*^9, 3.7156906298095903`*^9}, {
   3.7156911368786373`*^9, 3.715691239312644*^9}, {3.71569127403557*^9, 
   3.7156913419466667`*^9}, {3.715691419131422*^9, 3.715691426683298*^9}, {
   3.7156914702366333`*^9, 3.715691498839129*^9}, {3.715691547480071*^9, 
   3.71569156292826*^9}, 3.715692004833913*^9, {3.7156924527754183`*^9, 
   3.715692487968485*^9}, {3.7156957382388077`*^9, 3.7156957773358393`*^9}, {
   3.715695839215905*^9, 3.7156958417293158`*^9}, {3.715695880000136*^9, 
   3.715695882417403*^9}, {3.7156961465342617`*^9, 3.715696156550856*^9}, {
   3.715706886084248*^9, 3.7157068893596077`*^9}, {3.7157089459274483`*^9, 
   3.715708946095148*^9}, 3.715712267759655*^9}],

Cell[BoxData[
 FractionBox[
  RowBox[{"R", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"pAhet", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        SubscriptBox["\[Alpha]", "hom"]}], ")"}], " ", 
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "hom"}]], " ", 
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "het"}]]}], "+", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pAhet"}], ")"}], " ", 
      SubscriptBox["\[Alpha]", "hom"], " ", 
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "het"}]], " ", 
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "hom"}]]}]}], ")"}], " ", 
   SubscriptBox["wDip", 
    RowBox[{"A", ",", "a", ",", "hom"}]]}], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "freqYWhet"}], ")"}], " ", 
   "meanHom"}]]], "Output",
 CellChangeTimes->{{3.715690621209343*^9, 3.715690634671921*^9}, {
   3.715691227320858*^9, 3.7156912398523273`*^9}, {3.7156912836389723`*^9, 
   3.715691303616148*^9}, 3.715691342670641*^9, 3.715691427110923*^9, {
   3.715691492106741*^9, 3.715691499354039*^9}, {3.715691552954258*^9, 
   3.7156915633178463`*^9}, 3.715692005399893*^9, {3.715692472672084*^9, 
   3.7156924885500793`*^9}, {3.715695753205546*^9, 3.715695777580988*^9}, 
   3.7156958421119423`*^9, 3.7156958829992723`*^9, {3.715696150936417*^9, 
   3.715696156882655*^9}, 3.715706948919692*^9, {3.715708946719288*^9, 
   3.715708974927957*^9}, 3.715712268226808*^9}]
}, Open  ]],

Cell["\<\
This difference is just the average rate of haplotype creation by \
recombination\
\>", "Text",
 CellChangeTimes->{{3.715708953021309*^9, 3.715708997191442*^9}, {
  3.715715997712098*^9, 3.715716038567553*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"%", "==", 
     FractionBox[
      RowBox[{
       RowBox[{
        RowBox[{"-", "recAM"}], " ", 
        RowBox[{"Coefficient", "[", 
         RowBox[{"gAterm", ",", "recAM"}], "]"}]}], "+", 
       RowBox[{
        RowBox[{"-", "recAM"}], " ", 
        RowBox[{"Coefficient", "[", 
         RowBox[{"gaterm", ",", "recAM"}], "]"}]}]}], "2"]}], "/.", 
    RowBox[{"recAM", "\[Rule]", 
     RowBox[{"recAMnotAX", "+", "recAXandAM"}]}]}], "/.", "recGen"}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.715708792110608*^9, 3.7157089005258904`*^9}, {
  3.715708973327379*^9, 3.715708973720561*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.715708794079932*^9, 3.71570890133138*^9}, 
   3.7157089758278008`*^9}]
}, Open  ]],

Cell["\<\
So the gmean>0 condition can also be written as \
\>", "Text",
 CellChangeTimes->{{3.7157122441410227`*^9, 3.7157122580678873`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Lambda]mA", "-", "\[Chi]mA"}], ")"}], "+", 
         RowBox[{"(", 
          RowBox[{"\[Lambda]ma", "-", "\[Chi]ma"}], ")"}]}], "2"], "-", "1", 
       "-", 
       FractionBox[
        RowBox[{"gaterm", "+", "gAterm"}], "2"]}], "/.", 
      RowBox[{"\[Lambda]mA", "\[Rule]", 
       RowBox[{"gAR0term", "+", "1"}]}]}], "/.", 
     RowBox[{"\[Lambda]ma", "\[Rule]", 
      RowBox[{"gaR0term", "+", "1"}]}]}], "/.", 
    RowBox[{"\[Chi]ma", "\[Rule]", 
     RowBox[{
      RowBox[{"-", "recAM"}], " ", 
      RowBox[{"Coefficient", "[", 
       RowBox[{"gaterm", ",", "recAM"}], "]"}]}]}]}], "/.", 
   RowBox[{"\[Chi]mA", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "recAM"}], " ", 
     RowBox[{"Coefficient", "[", 
      RowBox[{"gAterm", ",", "recAM"}], "]"}]}]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.7157122937183237`*^9, 3.715712508122881*^9}, {
  3.715712593579543*^9, 3.715712608988578*^9}, {3.715712641568038*^9, 
  3.715712641878623*^9}, {3.715712685151793*^9, 3.7157126875679483`*^9}, {
  3.715716059026249*^9, 3.7157160660342712`*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.715712489814581*^9, 3.7157125090584803`*^9}, 
   3.7157125969019136`*^9, 3.715712642336117*^9, 3.715712687973708*^9, {
   3.715716061951891*^9, 3.715716066450733*^9}}]
}, Open  ]],

Cell["\<\
Using the no recombination growth rates\
\>", "Text",
 CellChangeTimes->{{3.715691380194187*^9, 3.7156913870206957`*^9}, {
  3.715713035133795*^9, 3.7157130352858477`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gasubR0", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"noreceigens1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "\[Equal]", "gaR0"}], 
      ",", 
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "a", ",", "hom"}]]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"gAsubR0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"noreceigens1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], "\[Equal]", "gAR0"}], 
       ",", 
       SubscriptBox["wDip", 
        RowBox[{"A", ",", "A", ",", "hom"}]]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.682054657183845*^9, 3.6820546678559093`*^9}, {
  3.682141273721465*^9, 3.682141291396159*^9}, {3.682141355137361*^9, 
  3.682141360098618*^9}, {3.6983733421397743`*^9, 3.6983733437405977`*^9}}],

Cell["our final condition a+b+c<0 is", "Text",
 CellChangeTimes->{{3.678803649407956*^9, 3.678803654081893*^9}, {
   3.6788053785896177`*^9, 3.678805380997744*^9}, {3.678841377839574*^9, 
   3.678841379596589*^9}, {3.678846310941874*^9, 3.678846311165923*^9}, {
   3.678846365316596*^9, 3.678846371932901*^9}, 3.68190486818493*^9, {
   3.6820744248656063`*^9, 3.682074428658678*^9}, {3.682075474227734*^9, 
   3.682075478252342*^9}, {3.682076943070528*^9, 3.682076950907119*^9}, 
   3.7156913910493717`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"acoef1", "/", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"homMeanFit", "/", "meanHom"}], ")"}], "2"]}], "+", 
            RowBox[{"bcoef1", "/", 
             RowBox[{"(", 
              RowBox[{"homMeanFit", "/", "meanHom"}], ")"}]}], "+", 
            "ccoef1"}], ")"}], "/", "meanHom"}], "<", "0"}], "/.", 
        "gasubR0"}], "/.", "gAsubR0"}], "/.", 
      RowBox[{"pXZhet", "\[Rule]", 
       FractionBox[
        RowBox[{"pAhet", "-", 
         RowBox[{"freqYWhet", " ", "pYWhet"}]}], 
        RowBox[{"(", 
         RowBox[{"1", "-", "freqYWhet"}], ")"}]]}]}], "/.", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "hom"}]], "\[Rule]", 
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "hom"}]]}]}], "//", "Simplify"}], ",", 
   RowBox[{"{", 
    RowBox[{"meanHom", ",", "R", ",", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "hom"}]]}], "}"}], ",", "Simplify"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.686383550097385*^9, 3.686383553196336*^9}, {
   3.686383662702827*^9, 3.6863836649757557`*^9}, {3.698373354438839*^9, 
   3.6983733710247917`*^9}, 3.6984192134859943`*^9, {3.715707862994175*^9, 
   3.715707866786105*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "freqYWhet"}], ")"}], "2"], " ", "gaR0", " ", 
    "gAR0", " ", "meanHom"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "freqYWhet"}], ")"}], " ", "R", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "gAR0"}], " ", "pAhet", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "hom"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "het"}]]}], "-", 
      RowBox[{"gaR0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pAhet"}], ")"}], " ", 
       SubscriptBox["\[Alpha]", "hom"], " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "het"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "hom"}]]}]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "hom"}]]}]}], "<", "0"}]], "Output",
 CellChangeTimes->{
  3.6863835540506268`*^9, 3.6868418065292807`*^9, 3.6869098679830236`*^9, 
   3.695069304100629*^9, 3.695077291609749*^9, 3.6954005863149033`*^9, 
   3.697164751780011*^9, 3.698373375065303*^9, 3.6984192208467197`*^9, 
   3.7041558543285103`*^9, {3.715707863789278*^9, 3.71570786951013*^9}, 
   3.715716091077917*^9}]
}, Open  ]],

Cell["which can be rearranged into", "Text",
 CellChangeTimes->{{3.682076957315551*^9, 3.682076963194953*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"R", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"gAR0", " ", "pAhet", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "hom"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "het"}]]}], "+", 
      RowBox[{"gaR0", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "pAhet"}], ")"}], " ", 
       SubscriptBox["\[Alpha]", "hom"], " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "het"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "hom"}]]}]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "hom"}]]}], ">", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "freqYWhet"}], ")"}], " ", "gaR0", " ", "gAR0", " ", 
    "meanHom"}]}]}]], "Input",
 CellChangeTimes->{{3.686840132105234*^9, 3.686840155563774*^9}, {
  3.6868418373086777`*^9, 3.686841860162578*^9}, {3.6868418920191107`*^9, 
  3.686841962106307*^9}, {3.697164772516458*^9, 3.697164775143198*^9}, {
  3.6983733877505627`*^9, 3.698373402187714*^9}, {3.698419231246921*^9, 
  3.698419309240573*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"gAR0", " ", "pAhet", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        SubscriptBox["\[Alpha]", "hom"]}], ")"}], " ", 
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "hom"}]], " ", 
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "het"}]]}], "+", 
     RowBox[{"gaR0", " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", "pAhet"}], ")"}], " ", 
      SubscriptBox["\[Alpha]", "hom"], " ", 
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "het"}]], " ", 
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "hom"}]]}]}], ")"}], " ", 
   SubscriptBox["wDip", 
    RowBox[{"A", ",", "a", ",", "hom"}]]}], ">", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "freqYWhet"}], ")"}], " ", "gaR0", " ", "gAR0", " ", 
   "meanHom"}]}]], "Output",
 CellChangeTimes->{3.704155854438802*^9}]
}, Open  ]],

Cell["\<\
If both ga>0 and gA>0 (implying that gaR0 and gAR0 are both positive) then \
2a+b<0 and the neo-W(Y) invades. If both gaR0<0 and gAR0<0 then a+b+c<0 is \
never true and the neo-W(Y) will not invade. So the interesting part is when \
one gR0 is positive and one negative. If we assume, without loss of \
generality, that gAR0>0 and gaR0<0, the product gaR0 gAR0 is negative. \
Dividing through and flipping the inequality:\
\>", "Text",
 CellChangeTimes->{{3.678845089552334*^9, 3.678845160444935*^9}, 
   3.678846328049347*^9, 3.681904868185585*^9, {3.682056686187016*^9, 
   3.682056729646557*^9}, {3.682056760907091*^9, 3.6820567859103727`*^9}, {
   3.6820568469095783`*^9, 3.682056944805656*^9}, {3.68205710368909*^9, 
   3.682057103898336*^9}, {3.682067950834725*^9, 3.6820679520530567`*^9}, {
   3.682077031261086*^9, 3.68207703751306*^9}, {3.6821359337426577`*^9, 
   3.682135980316546*^9}, {3.6821360167583*^9, 3.682136022613071*^9}, {
   3.6821407008899813`*^9, 3.682140701020369*^9}, {3.68214112726053*^9, 
   3.6821411586928167`*^9}, {3.682141684924884*^9, 3.682141710615905*^9}, {
   3.686840194509655*^9, 3.686840205697631*^9}, {3.686841980552679*^9, 
   3.686842015107954*^9}, {3.698373417872115*^9, 3.6983734277145452`*^9}, {
   3.7157130998086557`*^9, 3.715713100160898*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{" ", 
  RowBox[{
   RowBox[{"R", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{"pAhet", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          SubscriptBox["\[Alpha]", "hom"]}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "hom"}]], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "het"}]]}], "gaR0"], "+", 
      FractionBox[
       RowBox[{" ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "pAhet"}], ")"}], " ", 
         SubscriptBox["\[Alpha]", "hom"], " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "het"}]], " ", 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "hom"}]]}]}], "gAR0"]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "hom"}]]}], "<", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "freqYWhet"}], ")"}], " ", "meanHom"}]}]}]], "Input",
 CellChangeTimes->{{3.6984193317797823`*^9, 3.6984193549324923`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"R", " ", 
   RowBox[{"(", 
    RowBox[{
     FractionBox[
      RowBox[{"pAhet", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         SubscriptBox["\[Alpha]", "hom"]}], ")"}], " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "hom"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "het"}]]}], "gaR0"], "+", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pAhet"}], ")"}], " ", 
       SubscriptBox["\[Alpha]", "hom"], " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "het"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "hom"}]]}], "gAR0"]}], ")"}], " ", 
   SubscriptBox["wDip", 
    RowBox[{"A", ",", "a", ",", "hom"}]]}], "<", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{"1", "-", "freqYWhet"}], ")"}], " ", "meanHom"}]}]], "Output",
 CellChangeTimes->{3.70415585449293*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Sex chromosome turnover (weak selection)", "Section",
 CellChangeTimes->{{3.675898184242074*^9, 3.675898192657653*^9}, {
   3.6766823621496687`*^9, 3.676682365402493*^9}, {3.676682824936212*^9, 
   3.676682839700041*^9}, 3.676721662499631*^9, {3.676726557160334*^9, 
   3.676726564889889*^9}, 3.677427015726658*^9, {3.677439500021902*^9, 
   3.67743950207469*^9}, {3.678543990089929*^9, 3.678543990274122*^9}, {
   3.678768500112903*^9, 3.678768500298716*^9}, 3.6787685305671663`*^9, {
   3.681890954195335*^9, 3.6818909696636047`*^9}, {3.682133713824585*^9, 
   3.682133715488268*^9}, {3.683818195408722*^9, 3.6838181989786863`*^9}, {
   3.683819151924642*^9, 3.68381915557476*^9}, 3.695077268955456*^9, {
   3.6951591983813667`*^9, 3.695159207108541*^9}, 3.695404736040962*^9, {
   3.697165865147608*^9, 3.697165872037506*^9}}],

Cell["\<\
Here we develop explicit expressions assuming weak selection.\
\>", "Text",
 CellChangeTimes->{{3.676720412976615*^9, 3.676720459024542*^9}, {
  3.676720582555089*^9, 3.676720586782763*^9}, {3.676721687580276*^9, 
  3.676721687767557*^9}, {3.6767265489351683`*^9, 3.676726549465045*^9}, {
  3.678764528946957*^9, 3.678764537543582*^9}, {3.68189097671701*^9, 
  3.681890993092064*^9}, {3.686842252317505*^9, 3.686842268775052*^9}, {
  3.695069392812245*^9, 3.695069398457806*^9}}],

Cell[CellGroupData[{

Cell["Eigenvalues", "Subsection",
 CellChangeTimes->{{3.686834010168002*^9, 3.6868340116853533`*^9}, {
   3.6950545251758823`*^9, 3.695054532581987*^9}, 3.695066321441153*^9}],

Cell["Solving for the eigenvalues with no selection or drive gives", "Text",
 CellChangeTimes->{{3.676720669392806*^9, 3.676720678062379*^9}, {
  3.678766034361598*^9, 3.6787660366765347`*^9}, {3.685448917726295*^9, 
  3.685448920361291*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"charpolyExt", "/.", "recGen"}], "/.", "weaksel"}], "/.", 
       RowBox[{"freqYWhet", "\[Rule]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "+", 
         RowBox[{"freqYWhet1", "*", "\[Epsilon]"}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.678765640643032*^9, 3.678765641722434*^9}, {
   3.685448224428005*^9, 3.685448231209566*^9}, 3.6854486554057302`*^9, {
   3.686310173398429*^9, 3.686310199037781*^9}, 3.6950610393317337`*^9, {
   3.695158485709271*^9, 3.695158487108471*^9}, {3.6954031416621037`*^9, 
   3.695403144419695*^9}, {3.6954032712071657`*^9, 3.695403297431012*^9}, 
   3.698373469243642*^9, {3.698419393191951*^9, 3.698419398412023*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{"1", "-", "R"}]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{"1", "-", "\[Chi]"}]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"2", "-", "r", "-", "R", "-", "\[Chi]"}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6983735623817043`*^9, 3.6984194721114197`*^9}]
}, Open  ]],

Cell["\<\
To zeroth order the leading eigenvalue is \[Lambda]=1.\
\>", "Text",
 CellChangeTimes->{{3.676722106551478*^9, 3.6767221217139177`*^9}, {
  3.698419872478808*^9, 3.698419873989415*^9}}],

Cell["On the first order the eiganvalue is", "Text",
 CellChangeTimes->{{3.676722149076614*^9, 3.676722183499652*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"charpolyExt", "/.", "recGen"}], "/.", "weaksel"}], "/.", 
          RowBox[{"\[Lambda]", "\[Rule]", 
           RowBox[{"1", "+", 
            RowBox[{"\[Delta]\[Lambda]", "*", "\[Epsilon]"}]}]}]}], "/.", 
         "frequenciessub"}], "/.", "sol0"}], "/.", 
       RowBox[{"pXZhom0", "\[Rule]", "pA"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"\[Delta]\[Lambda]", "/.", "%"}], "/.", 
   RowBox[{"realsol", "[", 
    RowBox[{"[", "3", "]"}], "]"}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.675900203768065*^9, 3.67590021603231*^9}, {
   3.675900300123855*^9, 3.675900338446018*^9}, 3.675900430018834*^9, {
   3.676722303506366*^9, 3.6767223232575293`*^9}, 3.676723478586155*^9, 
   3.676723712223565*^9, {3.677427876523703*^9, 3.677427886199647*^9}, 
   3.6774395304086657`*^9, {3.677964777073876*^9, 3.677964783312694*^9}, 
   3.67876574278687*^9, {3.678765813083859*^9, 3.6787658141807957`*^9}, {
   3.6857153479147987`*^9, 3.685715348100605*^9}, 3.685717380028427*^9, {
   3.6857174167886677`*^9, 3.685717446587056*^9}, {3.6857175701267548`*^9, 
   3.685717578409399*^9}, {3.685717738344397*^9, 3.685717738617187*^9}, 
   3.685717806213335*^9, 3.695061042666678*^9, {3.695158490091378*^9, 
   3.6951584920202417`*^9}, {3.695403288312294*^9, 3.695403290387779*^9}, 
   3.695403646036728*^9, 3.698373477824297*^9, {3.6984194097839203`*^9, 
   3.698419411707808*^9}, {3.6984196147188063`*^9, 3.698419617650518*^9}, {
   3.698419700357041*^9, 3.698419708163742*^9}}],

Cell[BoxData[
 RowBox[{"{", "0", "}"}]], "Output",
 CellChangeTimes->{3.698373683170321*^9, 3.698419566424415*^9, 
  3.698419684421872*^9, 3.698419774270884*^9}]
}, Open  ]],

Cell["On second order we have", "Text",
 CellChangeTimes->{{3.6858795664561443`*^9, 3.685879569528254*^9}, 
   3.686832645325192*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"charpolyExt", "/.", "recGen"}], "/.", "weaksel"}], "/.", 
             RowBox[{"\[Lambda]", "\[Rule]", 
              RowBox[{"1", "+", 
               RowBox[{"\[Delta]\[Lambda]2", "*", 
                RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
            "frequenciessub"}], "/.", 
           RowBox[{"freqYWhet1", "\[Rule]", "0"}]}], "/.", "sol0"}], "/.", 
         RowBox[{"pXZhom0", "\[Rule]", "pA"}]}], "/.", 
        RowBox[{"pXZhet1", "\[Rule]", 
         RowBox[{"dpAXZhetXZhom", "+", "pXZhom1"}]}]}], "/.", 
       RowBox[{"pYWhet1", "\[Rule]", 
        RowBox[{"dpAYWhetXZhom", "+", "pXZhom1"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"lambda2diffs", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"\[Delta]\[Lambda]2", "/.", "%"}], ",", 
    RowBox[{"{", 
     RowBox[{"dpAXZhetXZhom", ",", "dpAYWhetXZhom"}], "}"}], ",", 
    "Simplify"}], "]"}]}]}], "Input",
 CellChangeTimes->{
  3.685525922293927*^9, 3.6858795723827133`*^9, {3.6863793429214783`*^9, 
   3.686379346095378*^9}, 3.6950610525494432`*^9, {3.695158496300675*^9, 
   3.695158497565794*^9}, {3.69540365993071*^9, 3.6954036621208*^9}, 
   3.695404718217284*^9, 3.698373484185442*^9, {3.6984197229983892`*^9, 
   3.698419785062777*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", "dpAXZhetXZhom", " ", "k", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "pA"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
          SubscriptBox["h", "het"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "het"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "pA"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
          SubscriptBox["h", "hom"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "hom"]}], "+", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["sHap", "het"]}], "+", 
         SubscriptBox["sHap", "hom"]}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{"dpAYWhetXZhom", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "k"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "pA"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
          SubscriptBox["h", "het"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "het"]}], "+", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"pA", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
          SubscriptBox["h", "hom"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "hom"]}], "+", 
      RowBox[{
       FractionBox["1", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{"2", "-", 
             RowBox[{"4", " ", "k"}], "+", 
             SuperscriptBox["k", "2"]}], ")"}]}], " ", 
          SubscriptBox["sHap", "het"]}], "+", 
         RowBox[{
          SuperscriptBox["k", "2"], " ", 
          SubscriptBox["sHap", "hom"]}]}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{
    FractionBox["1", "R"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "2"}], " ", "freqYWhet2", " ", "R"}], "+", 
      RowBox[{"4", " ", "freqYWhet2", " ", "k", " ", "R"}], "-", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "k"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"pA", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
           SubscriptBox["h", "het"]}]}], ")"}], "2"], " ", 
       SubsuperscriptBox["sDip", "het", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"pA", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
           SubscriptBox["h", "hom"]}]}], ")"}], "2"], " ", 
       SubsuperscriptBox["sDip", "hom", "2"]}], "+", 
      RowBox[{"pA", " ", 
       SubsuperscriptBox["sHap", "het", "2"]}], "-", 
      RowBox[{"2", " ", "k", " ", "pA", " ", 
       SubsuperscriptBox["sHap", "het", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", "pA", " ", 
       SubsuperscriptBox["sHap", "het", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubsuperscriptBox["sHap", "het", "2"]}], "+", 
      RowBox[{"2", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubsuperscriptBox["sHap", "het", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubsuperscriptBox["sHap", "het", "2"]}], "-", 
      RowBox[{"pA", " ", "R", " ", 
       SubsuperscriptBox["sHap", "het", "2"]}], "+", 
      RowBox[{"3", " ", "k", " ", "pA", " ", "R", " ", 
       SubsuperscriptBox["sHap", "het", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", "R", " ", 
       SubsuperscriptBox["sHap", "het", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubsuperscriptBox["sHap", "het", "2"]}], "-", 
      RowBox[{"3", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubsuperscriptBox["sHap", "het", "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubsuperscriptBox["sHap", "het", "2"]}], "+", 
      RowBox[{"2", " ", "k", " ", "pA", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["sHap", "hom"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["sHap", "hom"]}], "-", 
      RowBox[{"2", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["sHap", "hom"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["sHap", "hom"]}], "+", 
      RowBox[{"pA", " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["sHap", "hom"]}], "-", 
      RowBox[{"4", " ", "k", " ", "pA", " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["sHap", "hom"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["sHap", "hom"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["sHap", "hom"]}], "+", 
      RowBox[{"4", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["sHap", "hom"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["sHap", "hom"]}], "+", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", "pA", " ", 
       SubsuperscriptBox["sHap", "hom", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubsuperscriptBox["sHap", "hom", "2"]}], "+", 
      RowBox[{"k", " ", "pA", " ", "R", " ", 
       SubsuperscriptBox["sHap", "hom", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", "R", " ", 
       SubsuperscriptBox["sHap", "hom", "2"]}], "-", 
      RowBox[{"k", " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubsuperscriptBox["sHap", "hom", "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubsuperscriptBox["sHap", "hom", "2"]}], "+", 
      RowBox[{"2", " ", "pA", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "-", 
      RowBox[{"4", " ", "k", " ", "pA", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "+", 
      RowBox[{"4", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "-", 
      RowBox[{"2", " ", "pA", " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "+", 
      RowBox[{"5", " ", "k", " ", "pA", " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "-", 
      RowBox[{"5", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "+", 
      RowBox[{"2", " ", "k", " ", "pA", " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "-", 
      RowBox[{"2", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "-", 
      RowBox[{"3", " ", "k", " ", "pA", " ", "R", " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", "R", " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "+", 
      RowBox[{"3", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "het"]}], "+", 
      RowBox[{"pA", " ", 
       SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "-", 
      RowBox[{"2", " ", "k", " ", "pA", " ", 
       SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "+", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", "pA", " ", 
       SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "+", 
      RowBox[{"2", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "-", 
      RowBox[{"2", " ", "pA", " ", "R", " ", 
       SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "+", 
      RowBox[{"4", " ", "k", " ", "pA", " ", "R", " ", 
       SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", "R", " ", 
       SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "-", 
      RowBox[{"4", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "+", 
      RowBox[{"2", " ", "k", " ", "pA", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "-", 
      RowBox[{"2", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "-", 
      RowBox[{"3", " ", "k", " ", "pA", " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "+", 
      RowBox[{"3", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["sHap", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "+", 
      RowBox[{"k", " ", "pA", " ", "R", " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", "R", " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "-", 
      RowBox[{"k", " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "+", 
      RowBox[{"3", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["sHap", "hom"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "+", 
      RowBox[{"2", " ", "k", " ", "pA", " ", 
       SubscriptBox["\[Alpha]1", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", 
       SubscriptBox["\[Alpha]1", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "-", 
      RowBox[{"2", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["\[Alpha]1", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["\[Alpha]1", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "-", 
      RowBox[{"4", " ", "k", " ", "pA", " ", "R", " ", 
       SubscriptBox["\[Alpha]1", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", "R", " ", 
       SubscriptBox["\[Alpha]1", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "+", 
      RowBox[{"4", " ", "k", " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["\[Alpha]1", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "-", 
      RowBox[{"4", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubscriptBox["\[Alpha]1", "het"], " ", 
       SubscriptBox["\[Alpha]1", "hom"]}], "+", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", "pA", " ", 
       SubsuperscriptBox["\[Alpha]1", "hom", "2"]}], "-", 
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubsuperscriptBox["\[Alpha]1", "hom", "2"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", "pA", " ", "R", " ", 
       SubsuperscriptBox["\[Alpha]1", "hom", "2"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["k", "2"], " ", 
       SuperscriptBox["pA", "2"], " ", "R", " ", 
       SubsuperscriptBox["\[Alpha]1", "hom", "2"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "pA"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
          SubscriptBox["h", "het"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "het"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "k", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "pA"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
             SubscriptBox["h", "hom"]}]}], ")"}], " ", 
          SubscriptBox["sDip", "hom"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", 
            RowBox[{"2", " ", "k"}], "+", "R", "-", 
            RowBox[{"3", " ", "k", " ", "R"}]}], ")"}], " ", 
          SubscriptBox["sHap", "het"]}], "-", 
         RowBox[{"2", " ", "k", " ", 
          SubscriptBox["sHap", "hom"]}], "-", 
         RowBox[{"R", " ", 
          SubscriptBox["sHap", "hom"]}], "+", 
         RowBox[{"3", " ", "k", " ", "R", " ", 
          SubscriptBox["sHap", "hom"]}], "-", 
         RowBox[{"2", " ", 
          SubscriptBox["\[Alpha]1", "het"]}], "+", 
         RowBox[{"2", " ", "k", " ", 
          SubscriptBox["\[Alpha]1", "het"]}], "+", 
         RowBox[{"2", " ", "R", " ", 
          SubscriptBox["\[Alpha]1", "het"]}], "-", 
         RowBox[{"2", " ", "k", " ", "R", " ", 
          SubscriptBox["\[Alpha]1", "het"]}], "-", 
         RowBox[{"2", " ", "k", " ", 
          SubscriptBox["\[Alpha]1", "hom"]}], "+", 
         RowBox[{"2", " ", "k", " ", "R", " ", 
          SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}], "+", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "pA"}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
          SubscriptBox["h", "hom"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "hom"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"2", "-", 
            RowBox[{"2", " ", "R"}], "+", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               RowBox[{"3", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
          SubscriptBox["sHap", "het"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"2", "-", 
               RowBox[{"3", " ", "R"}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "R"}]}], ")"}], " ", 
          SubscriptBox["sHap", "hom"]}], "+", 
         RowBox[{"2", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
             SubscriptBox["\[Alpha]1", "het"]}], "-", 
            RowBox[{"k", " ", 
             SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6983745693889837`*^9, 3.698420483072831*^9}]
}, Open  ]],

Cell["Then we can put in all the differences", "Text",
 CellChangeTimes->{{3.6779655133565893`*^9, 3.677965517876515*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tester", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"lambda2diffs", "/.", 
         RowBox[{"realsol", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "/.", "recGen"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"dpAXZhetXZhom", ",", "dpAYWhetXZhom", ",", "freqYWhet2"}], 
     "}"}], ",", "Simplify"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.677956048352296*^9, 3.6779561551216288`*^9}, {
   3.677957309721977*^9, 3.6779573101974573`*^9}, {3.677964924472028*^9, 
   3.677964939369676*^9}, {3.678766496517172*^9, 3.678766497073032*^9}, {
   3.678766536740871*^9, 3.678766624413505*^9}, {3.685527375517829*^9, 
   3.685527401633356*^9}, 3.685527433534169*^9, {3.686381077811311*^9, 
   3.686381080761208*^9}, 3.695061061731542*^9, {3.695158665547545*^9, 
   3.6951586674343576`*^9}, {3.695404753684774*^9, 3.6954047558234158`*^9}, 
   3.6954086407389174`*^9, 3.698373497572269*^9, {3.698419805219515*^9, 
   3.698419809792613*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"freqYWhet2", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "2"}], "+", 
      RowBox[{"4", " ", "k"}]}], ")"}]}], "-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["h", "het"], " ", 
         SubscriptBox["sDip", "het"]}], "+", 
        RowBox[{
         SubscriptBox["h", "hom"], " ", 
         SubscriptBox["sDip", "hom"]}], "+", 
        SubscriptBox["sHap", "het"], "+", 
        SubscriptBox["sHap", "hom"], "+", 
        SubscriptBox["\[Alpha]1", "het"], "+", 
        SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["k", "2"]}], " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "het"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "het"]}], "-", 
        RowBox[{"2", " ", "r", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "het"]}], "+", 
        RowBox[{"8", " ", "k", " ", "r", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "het"]}], "-", 
        RowBox[{"8", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "het"]}], "+", 
        RowBox[{"2", " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "het"]}], "-", 
        RowBox[{"4", " ", "k", " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "het"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["k", "2"], " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "het"]}], "-", 
        RowBox[{"8", " ", "k", " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "het"]}], "+", 
        RowBox[{"10", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "het"]}], "+", 
        RowBox[{"2", " ", "r", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "hom"]}], "-", 
        RowBox[{"8", " ", "k", " ", "r", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "hom"]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "hom"]}], "-", 
        RowBox[{"2", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "hom"]}], "+", 
        RowBox[{"4", " ", "k", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "hom"]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["k", "2"], " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "hom"]}], "+", 
        RowBox[{"8", " ", "k", " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "hom"]}], "-", 
        RowBox[{"10", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "hom"]}], "+", 
        RowBox[{
         SuperscriptBox["k", "2"], " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "hom"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "hom"]}], "-", 
        RowBox[{"2", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "+", 
        RowBox[{"4", " ", "k", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["k", "2"], " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "+", 
        RowBox[{"4", " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "-", 
        RowBox[{"8", " ", "k", " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "+", 
        RowBox[{"4", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "-", 
        RowBox[{"2", " ", "r", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "+", 
        RowBox[{"8", " ", "k", " ", "r", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "-", 
        RowBox[{"8", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["k", "2"], " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "+", 
        RowBox[{"4", " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "-", 
        RowBox[{"16", " ", "k", " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "+", 
        RowBox[{"12", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "+", 
        RowBox[{"2", " ", "r", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "-", 
        RowBox[{"8", " ", "k", " ", "r", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "-", 
        RowBox[{"2", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "+", 
        RowBox[{"4", " ", "k", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["k", "2"], " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "+", 
        RowBox[{"8", " ", "k", " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "-", 
        RowBox[{"12", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["k", "2"], " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "-", 
        RowBox[{"4", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["h", "hom"], " ", 
         SubscriptBox["sDip", "hom"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", 
                 RowBox[{"4", " ", "k", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["k", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "k"}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["k", "2"]}]}], ")"}], " ", "R"}]}], ")"}], 
            " ", 
            SubscriptBox["sDip", "het"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "-", 
                 RowBox[{"4", " ", "k"}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["k", "2"]}]}], ")"}], " ", "R"}], "+", 
              RowBox[{"2", " ", "r", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", 
                 RowBox[{"4", " ", "k", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["k", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "4"}], "+", 
                    RowBox[{"5", " ", "R"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
            " ", 
            SubscriptBox["sHap", "het"]}], "+", 
           RowBox[{
            SuperscriptBox["k", "2"], " ", "R", " ", 
            SubscriptBox["sHap", "hom"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
            SubscriptBox["sHap", "hom"]}], "-", 
           RowBox[{"2", " ", "r", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "+", 
           RowBox[{"8", " ", "k", " ", "r", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["k", "2"], " ", "r", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["k", "2"], " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "+", 
           RowBox[{"4", " ", "r", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "-", 
           RowBox[{"16", " ", "k", " ", "r", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "+", 
           RowBox[{"12", " ", 
            SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["k", "2"], " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["h", "het"], " ", 
         SubscriptBox["sDip", "het"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", 
                 RowBox[{"4", " ", "k", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["k", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "k"}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["k", "2"]}]}], ")"}], " ", "R"}]}], ")"}], 
            " ", 
            SubscriptBox["sDip", "hom"]}], "+", 
           RowBox[{
            SuperscriptBox["k", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "r"}]}], ")"}], " ", "R", " ", 
            SubscriptBox["sHap", "het"]}], "-", 
           RowBox[{"2", " ", "r", " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{"8", " ", "k", " ", "r", " ", 
            SubscriptBox["sHap", "hom"]}], "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["k", "2"], " ", "r", " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{"2", " ", "R", " ", 
            SubscriptBox["sHap", "hom"]}], "-", 
           RowBox[{"4", " ", "k", " ", "R", " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{"3", " ", 
            SuperscriptBox["k", "2"], " ", "R", " ", 
            SubscriptBox["sHap", "hom"]}], "-", 
           RowBox[{"8", " ", "k", " ", "r", " ", "R", " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{"10", " ", 
            SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
            SubscriptBox["sHap", "hom"]}], "+", 
           RowBox[{"2", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "-", 
           RowBox[{"4", " ", "k", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["k", "2"], " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "-", 
           RowBox[{"4", " ", "r", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "+", 
           RowBox[{"8", " ", "k", " ", "r", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "-", 
           RowBox[{"4", " ", 
            SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "het"]}], "-", 
           RowBox[{"2", " ", "r", " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"8", " ", "k", " ", "r", " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "-", 
           RowBox[{"8", " ", 
            SuperscriptBox["k", "2"], " ", "r", " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"2", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "-", 
           RowBox[{"4", " ", "k", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["k", "2"], " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "-", 
           RowBox[{"8", " ", "k", " ", "r", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "hom"]}], "+", 
           RowBox[{"12", " ", 
            SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
            SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SubscriptBox["sDip", "het"]}], " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "het"]}], "-", 
        RowBox[{
         SubsuperscriptBox["sDip", "hom", "2"], " ", 
         SubscriptBox["sHap", "het"]}], "-", 
        RowBox[{
         SubscriptBox["sDip", "hom"], " ", 
         SubsuperscriptBox["sHap", "het", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["sDip", "het", "2"], " ", 
         SubscriptBox["sHap", "hom"]}], "+", 
        RowBox[{
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "hom"]}], "+", 
        RowBox[{
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "het"], " ", 
         SubscriptBox["sHap", "hom"]}], "-", 
        RowBox[{
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "het"], " ", 
         SubscriptBox["sHap", "hom"]}], "+", 
        RowBox[{
         SubscriptBox["sDip", "het"], " ", 
         SubsuperscriptBox["sHap", "hom", "2"]}], "-", 
        RowBox[{
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "-", 
        RowBox[{
         SubsuperscriptBox["sDip", "hom", "2"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "het"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "+", 
        RowBox[{
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "-", 
        RowBox[{
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "het"]}], "-", 
        RowBox[{
         SubscriptBox["sDip", "hom"], " ", 
         SubsuperscriptBox["\[Alpha]1", "het", "2"]}], "-", 
        RowBox[{
         SubsuperscriptBox["h", "hom", "2"], " ", 
         SubsuperscriptBox["sDip", "hom", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["sDip", "het"], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sHap", "het"], "+", 
              SubscriptBox["\[Alpha]1", "het"]}], ")"}]}]}], ")"}]}], "+", 
        RowBox[{
         SubsuperscriptBox["sDip", "het", "2"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "+", 
        RowBox[{
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "+", 
        RowBox[{
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "het"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "-", 
        RowBox[{
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["sHap", "het"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["sHap", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "+", 
        RowBox[{
         SubscriptBox["sDip", "het"], " ", 
         SubscriptBox["\[Alpha]1", "het"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "-", 
        RowBox[{
         SubscriptBox["sDip", "hom"], " ", 
         SubscriptBox["\[Alpha]1", "het"], " ", 
         SubscriptBox["\[Alpha]1", "hom"]}], "+", 
        RowBox[{
         SubscriptBox["sDip", "het"], " ", 
         SubsuperscriptBox["\[Alpha]1", "hom", "2"]}], "+", 
        RowBox[{
         SubsuperscriptBox["h", "het", "2"], " ", 
         SubsuperscriptBox["sDip", "het", "2"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["sDip", "hom"], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sHap", "hom"], "+", 
              SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}]}], ")"}]}], "-", 
        RowBox[{
         SubscriptBox["h", "het"], " ", 
         SubscriptBox["sDip", "het"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               SubscriptBox["h", "hom"]}], ")"}]}], " ", 
            SubsuperscriptBox["sDip", "hom", "2"]}], "+", 
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sHap", "hom"], "+", 
              SubscriptBox["\[Alpha]1", "hom"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sHap", "het"], "+", 
              SubscriptBox["sHap", "hom"], "+", 
              SubscriptBox["\[Alpha]1", "het"], "+", 
              SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}], "+", 
           RowBox[{
            SubscriptBox["sDip", "het"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "+", 
                 SubscriptBox["h", "hom"]}], ")"}], " ", 
               SubscriptBox["sDip", "hom"]}], "+", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "hom"], "+", 
                 SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{
            SubscriptBox["sDip", "hom"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"2", " ", 
               SubscriptBox["h", "hom"], " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "het"], "-", 
                 SubscriptBox["sHap", "hom"], "+", 
                 SubscriptBox["\[Alpha]1", "het"], "-", 
                 SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}], "+", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "hom"], "+", 
                 SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}], "+", 
        RowBox[{
         SubscriptBox["h", "hom"], " ", 
         SubscriptBox["sDip", "hom"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubsuperscriptBox["sDip", "het", "2"], "+", 
           RowBox[{
            SubscriptBox["sDip", "het"], " ", 
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sDip", "hom"], "+", 
              RowBox[{"3", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "het"], "+", 
                 SubscriptBox["\[Alpha]1", "het"]}], ")"}]}]}], ")"}]}], "+", 
           
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              SubscriptBox["sHap", "het"], "+", 
              SubscriptBox["\[Alpha]1", "het"]}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"3", " ", 
               SubscriptBox["sDip", "hom"]}], "+", 
              RowBox[{"2", " ", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sHap", "het"], "+", 
                 SubscriptBox["sHap", "hom"], "+", 
                 SubscriptBox["\[Alpha]1", "het"], "+", 
                 SubscriptBox["\[Alpha]1", "hom"]}], ")"}]}]}], ")"}]}]}], 
          ")"}]}]}], ")"}]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", "r", " ", "R", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "het"]}]}], ")"}], " ", 
          SubscriptBox["sDip", "het"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "hom"]}]}], ")"}], " ", 
          SubscriptBox["sDip", "hom"]}]}], ")"}], "4"]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6983745892758617`*^9, 3.6984204994404097`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Selection terms", "Subsection",
 CellChangeTimes->{{3.695061546449482*^9, 3.6950615492080307`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"factor1", "=", 
   RowBox[{
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        SubscriptBox["h", "het"]}]}], ")"}], " ", 
     SubscriptBox["sDip", "het"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["sDip", "hom"], "+", 
       RowBox[{"2", " ", 
        SubscriptBox["sHap", "hom"]}], "+", 
       RowBox[{"2", 
        SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}], "-", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", 
        SubscriptBox["h", "hom"]}]}], ")"}], " ", 
     SubscriptBox["sDip", "hom"], " ", 
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["sDip", "het"], "+", 
       RowBox[{"2", " ", 
        SubscriptBox["sHap", "het"]}], "+", 
       RowBox[{"2", 
        SubscriptBox["\[Alpha]1", "het"]}]}], ")"}]}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"factor2", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", 
          SubscriptBox["h", "hom"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "hom"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", 
          SubscriptBox["h", "het"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "het"]}]}], ")"}]}]}], " ", 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"factor3", "=", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["sHap", "hom"], "-", 
     SubscriptBox["sHap", "het"], "+", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Alpha]1", "hom"]}], "-", 
     RowBox[{"2", " ", 
      SubscriptBox["\[Alpha]1", "het"]}]}], ")"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.695061573450182*^9, 3.69506157360289*^9}, {
  3.695404848712491*^9, 3.695404856033071*^9}, {3.698373531996315*^9, 
  3.698373576024253*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sterm", "=", 
   RowBox[{"factor1", "/", "factor2"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.695061581514864*^9, 3.695061597370501*^9}, {
   3.6950616375549717`*^9, 3.695061644577578*^9}, 3.698373531996513*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Homologous transition", "Subsection",
 CellChangeTimes->{{3.678767641048543*^9, 3.678767704745509*^9}, {
   3.678767741961824*^9, 3.67876775812893*^9}, {3.6818949736898727`*^9, 
   3.68189497636966*^9}, {3.682930093061714*^9, 3.6829301260152283`*^9}, {
   3.683815178147107*^9, 3.68381517833622*^9}, 3.68381942021813*^9, 
   3.68683540004027*^9, {3.686835549497253*^9, 3.686835550227577*^9}, {
   3.698374170228791*^9, 3.698374184082245*^9}, {3.698374302666073*^9, 
   3.698374326056849*^9}, {3.6983746260788383`*^9, 3.6983746304567623`*^9}, 
   3.698375648408196*^9, {3.698424474906591*^9, 3.698424481393056*^9}}],

Cell["\<\
Invasion of neo-Y/W into XY/ZW depends on the sign of\
\>", "Text",
 CellChangeTimes->{{3.686835287253334*^9, 3.686835318862034*^9}, {
   3.695065931621319*^9, 3.695065933036893*^9}, 3.6983741488459663`*^9, {
   3.698374492570853*^9, 3.6983745088428097`*^9}, {3.698374863492628*^9, 
   3.6983748668191013`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"selhomotrans", "=", 
   RowBox[{"Factor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"tester", "/", 
          RowBox[{"(", 
           RowBox[{"pA", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], "*", "VA"}], "/.", 
        RowBox[{"realsol", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "/.", "freqYWhet2sol"}], "/.", 
      RowBox[{"k", "\[Rule]", "0"}]}], "/.", "recGen"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.69798476917233*^9, 3.6979848437767*^9}, {
   3.697984877024968*^9, 3.697984881073284*^9}, {3.69798491445004*^9, 
   3.697984956884094*^9}, {3.697984994022355*^9, 3.697985044159466*^9}, {
   3.697985142331979*^9, 3.697985145092681*^9}, {3.697985178398473*^9, 
   3.697985226654257*^9}, 3.697985257283317*^9, 3.69798533710017*^9, {
   3.698004758299283*^9, 3.698004786130424*^9}, 3.698374148847518*^9, {
   3.698374498005818*^9, 3.698374527886219*^9}, {3.698374883103397*^9, 
   3.6983748833601294`*^9}, {3.698424329034019*^9, 3.698424331476297*^9}, {
   3.698425012288438*^9, 3.698425021708514*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"r", "-", "R"}], ")"}], " ", 
    SuperscriptBox["SA", "2"], " ", "VA"}], 
   RowBox[{"r", " ", "R"}]], "}"}]], "Output",
 GeneratedCell->False,
 CellAutoOverwrite->False,
 CellChangeTimes->{{3.6979851831159067`*^9, 3.697985227426856*^9}, 
   3.6979852587757998`*^9, 3.697985338329187*^9, {3.6980047594475822`*^9, 
   3.698004786821422*^9}, 3.698374148848093*^9}]
}, Open  ]],

Cell[TextData[{
 "An interesting consequence of the ",
 Cell[BoxData[
  FormBox[
   SuperscriptBox["SA", "2"], TraditionalForm]],
  FormatType->"TraditionalForm"],
 " term is that we can switch selection coefficients between the sexes \
without changing the conditions for invasion"
}], "Text",
 CellChangeTimes->{{3.698424551022331*^9, 3.6984245690707273`*^9}, {
  3.698424688296584*^9, 3.69842472343401*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{"pA", "/.", 
     RowBox[{"realsol", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "\[Equal]", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pA", "/.", 
        RowBox[{"het", "\[Rule]", "temp"}]}], "/.", 
       RowBox[{"hom", "\[Rule]", "het"}]}], "/.", 
      RowBox[{"temp", "\[Rule]", "hom"}]}], "/.", 
     RowBox[{"realsol", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], ")"}]}], "//", 
  "Simplify"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   SuperscriptBox["sterm", "2"], "\[Equal]", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"sterm", "/.", 
        RowBox[{"het", "\[Rule]", "temp"}]}], "/.", 
       RowBox[{"hom", "\[Rule]", "het"}]}], "/.", 
      RowBox[{"temp", "\[Rule]", "hom"}]}], ")"}], "2"]}], "//", 
  "Simplify"}]}], "Input",
 CellChangeTimes->{{3.698424606585165*^9, 3.698424646271676*^9}, {
  3.6984250685933332`*^9, 3.698425124326033*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6984246080668707`*^9, {3.698424642417321*^9, 3.698424646589705*^9}, {
   3.698425103082714*^9, 3.698425124824173*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6984246080668707`*^9, {3.698424642417321*^9, 3.698424646589705*^9}, {
   3.698425103082714*^9, 3.6984251248260927`*^9}}]
}, Open  ]],

Cell["\<\
For example, in terms of the potential for homologous transitions, meiotic \
drive in the ancestrally heterogametic sex -- which causes sex ratio bias -- \
is equivalent to meiotic drive in the ancestrally homogametic sex -- which \
cannot affect the sex ratio. (Remember that this assumes selection is weak \
relative to recombination.)\
\>", "Text",
 CellChangeTimes->{{3.698424726385564*^9, 3.698424753571444*^9}, {
  3.698424790712124*^9, 3.69842487999619*^9}, {3.698424915287932*^9, 
  3.6984249594927397`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Non-homologous transition", "Subsection",
 CellChangeTimes->{{3.682930508048012*^9, 3.6829305157439327`*^9}, {
   3.686464421741498*^9, 3.68646444577102*^9}, {3.686464503650766*^9, 
   3.6864646135040407`*^9}, {3.686464660070891*^9, 3.686464683910746*^9}, 
   3.686835013085911*^9, 3.686835079789611*^9, {3.686835542006263*^9, 
   3.686835542716774*^9}, 3.69837414884544*^9, {3.698374351576354*^9, 
   3.698374363506722*^9}, {3.6983746369346867`*^9, 3.6983746413075943`*^9}, 
   3.698375655105575*^9, {3.698424484378357*^9, 3.698424489108241*^9}}],

Cell["\<\
Invasion of neo-Y/W into XY/ZW depends on the sign of\
\>", "Text",
 CellChangeTimes->{{3.695061990363879*^9, 3.695062007692235*^9}, {
  3.6983741962728157`*^9, 3.6983742054573*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"selnonhomotrans", "=", 
   RowBox[{"Factor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"tester", "/", 
          RowBox[{"(", 
           RowBox[{"pA", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], "*", "VA"}], "/.", 
        RowBox[{"realsol", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], "/.", "freqYWhet2sol"}], "/.", 
      RowBox[{"k", "\[Rule]", "1"}]}], "/.", "recGen"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682930158017372*^9, 3.682930158325156*^9}, {
   3.6829303940858383`*^9, 3.6829303962767467`*^9}, {3.6829306542902822`*^9, 
   3.682930656894837*^9}, {3.6829347953080797`*^9, 3.682934798409984*^9}, {
   3.685527658756337*^9, 3.6855276754229183`*^9}, {3.685880685496688*^9, 
   3.6858806864537373`*^9}, 3.6863837200662527`*^9, {3.686384157378995*^9, 
   3.6863841847328377`*^9}, {3.686384282996667*^9, 3.6863842874184217`*^9}, {
   3.686464957484198*^9, 3.686465021717173*^9}, {3.686465259129113*^9, 
   3.686465259927699*^9}, {3.68646529024026*^9, 3.686465291951943*^9}, 
   3.686835430849298*^9, 3.692606563035924*^9, 3.695061943485759*^9, {
   3.695405012056513*^9, 3.695405013551338*^9}, {3.698374395479166*^9, 
   3.698374397157681*^9}, {3.6983749225089273`*^9, 3.6983749267785*^9}, 
   3.698424340459324*^9, {3.698425026535942*^9, 3.69842502747885*^9}}],

Cell["which can be written like", "Text",
 CellChangeTimes->{{3.697986351436022*^9, 3.697986357740181*^9}, {
   3.6979864244159822`*^9, 3.697986428414813*^9}, 3.698374148853529*^9, 
   3.698374455260501*^9, {3.698375532852934*^9, 3.6983755456818533`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Factor", "[", 
   RowBox[{"selnonhomotrans", "/.", 
    RowBox[{"SA", "\[Rule]", "sterm"}]}], "]"}], "==", 
  RowBox[{"Factor", "[", 
   RowBox[{"selhomotrans", "-", 
    RowBox[{"VA", " ", "sterm", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "r"}]}], ")"}], " "}], 
      RowBox[{"2", " ", "r", "  "}]], " ", "factor3"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.698374948056981*^9, 3.6983749588815517`*^9}, 
   3.698425033529263*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.698374610365183*^9, {3.6983749407526293`*^9, 3.698374963105212*^9}, 
   3.698424349667452*^9, 3.6984250373136187`*^9}]
}, Open  ]],

Cell["\<\
The additional term on the right hand side is\
\>", "Text",
 CellChangeTimes->{{3.698374765118705*^9, 3.69837479502922*^9}, {
  3.698375553170578*^9, 3.698375560332981*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"-", "VA"}], " ", "sterm", 
     FractionBox[
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "r"}]}], ")"}], " "}], 
      RowBox[{"2", " ", "r", "  "}]], " ", "factor3", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"dYXhet", "/", "dpAYWhetXZhet"}], ")"}], "/", 
      RowBox[{"(", 
       RowBox[{"VA", "/", 
        RowBox[{"(", 
         RowBox[{"pA", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], ")"}]}]}], "/.", 
    RowBox[{"realsol2", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "/.", "recGen"}], "]"}]], "Input",
 CellChangeTimes->{{3.698374746018568*^9, 3.69837475984591*^9}, {
  3.6983754472273006`*^9, 3.6983754562633343`*^9}, {3.698424365402323*^9, 
  3.698424370168391*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "2"], " ", "dYXhet", " ", 
  RowBox[{"(", 
   RowBox[{
    SubscriptBox["sHap", "het"], "-", 
    SubscriptBox["sHap", "hom"], "+", 
    RowBox[{"2", " ", 
     SubscriptBox["\[Alpha]1", "het"]}], "-", 
    RowBox[{"2", " ", 
     SubscriptBox["\[Alpha]1", "hom"]}]}], ")"}]}]], "Output",
 CellChangeTimes->{{3.698374754771882*^9, 3.698374760583776*^9}, 
   3.698374968332209*^9, {3.698375448359332*^9, 3.6983754576609364`*^9}, 
   3.698424371441078*^9, 3.698425039818921*^9}]
}, Open  ]],

Cell["\<\
where dYXhet is the difference in the frequency of A in gametes with the Y(W) \
and X(Z) from the ancestrally heterogametic sex. \
\>", "Text",
 CellChangeTimes->{{3.6983754316225653`*^9, 3.698375506422707*^9}, {
  3.698375585612771*^9, 3.6983755875696774`*^9}, {3.6984243885170193`*^9, 
  3.6984243969154*^9}}],

Cell["\<\
Recall that this frequency difference can be written like\
\>", "Text",
 CellChangeTimes->{{3.698427005957039*^9, 3.6984270211170893`*^9}, {
  3.698428216236616*^9, 3.698428218140606*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Factor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"dpAYWhetXZhet", "*", 
     RowBox[{"(", 
      RowBox[{"VA", "/", 
       RowBox[{"(", 
        RowBox[{"pA", 
         RowBox[{"(", 
          RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], ")"}], "*", 
     RowBox[{"(", 
      RowBox[{"SA", "/", "sterm"}], ")"}]}], "/.", 
    RowBox[{"realsol2", "[", 
     RowBox[{"[", "3", "]"}], "]"}]}], "/.", "recGen"}], "]"}]], "Input",
 CellChangeTimes->{{3.698427047529345*^9, 3.698427106157942*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "r"}]}], ")"}], " ", "SA", " ", "VA"}], 
   "r"]}]], "Output",
 CellChangeTimes->{{3.698427098936517*^9, 3.698427106589541*^9}}]
}, Open  ]],

Cell["\<\
thus if we switch selection coefficients between sexes this flips signs\
\>", "Text",
 CellChangeTimes->{{3.698428314212079*^9, 3.69842833306037*^9}, {
  3.698428438003323*^9, 3.698428441208338*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Factor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"dpAYWhetXZhet", "*", 
      RowBox[{"(", 
       RowBox[{"VA", "/", 
        RowBox[{"(", 
         RowBox[{"pA", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], ")"}], "*", 
      RowBox[{"(", 
       RowBox[{"SA", "/", "sterm"}], ")"}]}], "/.", 
     RowBox[{"realsol2", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "/.", "recGen"}], "]"}], "\[Equal]", 
  RowBox[{"-", 
   RowBox[{"Factor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"dpAYWhetXZhet", "/.", 
           RowBox[{"het", "\[Rule]", "temp"}]}], "/.", 
          RowBox[{"hom", "\[Rule]", "het"}]}], "/.", 
         RowBox[{"temp", "\[Rule]", "hom"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"VA", "/", 
            RowBox[{"(", 
             RowBox[{"pA", 
              RowBox[{"(", 
               RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], "/.", 
           RowBox[{"het", "\[Rule]", "temp"}]}], "/.", 
          RowBox[{"hom", "\[Rule]", "het"}]}], "/.", 
         RowBox[{"temp", "\[Rule]", "hom"}]}], ")"}], "*", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"SA", "/", "sterm"}], "/.", 
           RowBox[{"het", "\[Rule]", "temp"}]}], "/.", 
          RowBox[{"hom", "\[Rule]", "het"}]}], "/.", 
         RowBox[{"temp", "\[Rule]", "hom"}]}], ")"}]}], "/.", 
      RowBox[{"realsol2", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], "/.", "recGen"}], "]"}]}]}]], "Input",\

 CellChangeTimes->{{3.698428349958296*^9, 3.698428357961935*^9}, {
  3.69842839360357*^9, 3.6984284204763737`*^9}, {3.698428521366205*^9, 
  3.6984285236684*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.698428359083994*^9, {3.698428402405723*^9, 3.698428421200398*^9}, 
   3.698428524187827*^9}]
}, Open  ]],

Cell["But so does factor3", "Text",
 CellChangeTimes->{{3.69842847540711*^9, 3.698428493974972*^9}, 
   3.6984287058066807`*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Factor", "[", " ", "factor3", "]"}], "\[Equal]", 
  RowBox[{"-", 
   RowBox[{"Factor", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"factor3", "/.", 
       RowBox[{"het", "\[Rule]", "temp"}]}], "/.", 
      RowBox[{"hom", "\[Rule]", "het"}]}], "/.", 
     RowBox[{"temp", "\[Rule]", "hom"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.698428500777184*^9, 3.698428513338017*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.698428513762526*^9}]
}, Open  ]],

Cell["\<\
Therefore invasion fitness does not change when we flip selection \
coefficients between the sexes\
\>", "Text",
 CellChangeTimes->{{3.6984285290974913`*^9, 3.698428559427741*^9}, 
   3.698428711117749*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Factor", "[", "selnonhomotrans", "]"}], "\[Equal]", 
  RowBox[{"Factor", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"selnonhomotrans", "/.", 
      RowBox[{"het", "\[Rule]", "temp"}]}], "/.", 
     RowBox[{"hom", "\[Rule]", "het"}]}], "/.", 
    RowBox[{"temp", "\[Rule]", "hom"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.698428570126834*^9, 3.698428584959982*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{3.698428585692027*^9}]
}, Open  ]],

Cell["\<\
Again, as in the case of homologous transitions, this means that e.g., drive \
in the heterogametic sex -- which causes sex ratio bias -- has the same \
effect on nonhomologous transitions as drive in the homogametic sex -- which \
does not cause sex ratio bias.\
\>", "Text",
 CellChangeTimes->{{3.6984285934874697`*^9, 3.698428623655697*^9}, {
  3.698428680397188*^9, 3.698428731471134*^9}}]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1280, 980},
WindowMargins->{{1280, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 523, 9, 148, "Title"],
Cell[1105, 33, 233, 3, 51, "Subtitle"],
Cell[1341, 38, 1680, 27, 201, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[3058, 70, 649, 9, 92, "Title"],
Cell[CellGroupData[{
Cell[3732, 83, 223, 3, 80, "Section"],
Cell[CellGroupData[{
Cell[3980, 90, 207, 3, 44, "Subsection"],
Cell[4190, 95, 117, 1, 30, "Text"],
Cell[4310, 98, 698, 20, 36, "Input"],
Cell[5011, 120, 178, 2, 30, "Text"],
Cell[5192, 124, 1285, 32, 57, "Input"],
Cell[6480, 158, 325, 6, 30, "Text"],
Cell[6808, 166, 737, 17, 55, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[7582, 188, 152, 2, 36, "Subsection"],
Cell[7737, 192, 176, 2, 30, "Text"],
Cell[7916, 196, 720, 17, 34, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[8673, 218, 155, 2, 36, "Subsection"],
Cell[8831, 222, 124, 1, 30, "Text"],
Cell[8958, 225, 707, 18, 34, "Input"],
Cell[9668, 245, 254, 5, 30, "Text"],
Cell[9925, 252, 504, 12, 34, "Input"],
Cell[10432, 266, 355, 6, 30, "Text"],
Cell[10790, 274, 3821, 76, 140, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[14648, 355, 156, 2, 36, "Subsection"],
Cell[14807, 359, 123, 1, 30, "Text"],
Cell[14933, 362, 1107, 34, 36, "Input"],
Cell[16043, 398, 165, 2, 30, "Text"],
Cell[16211, 402, 1522, 44, 80, "Input"],
Cell[17736, 448, 651, 10, 68, "Text"],
Cell[18390, 460, 840, 24, 55, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[19267, 489, 146, 2, 36, "Subsection"],
Cell[19416, 493, 169, 2, 30, "Text"],
Cell[19588, 497, 1547, 44, 77, "Input"],
Cell[CellGroupData[{
Cell[21160, 545, 178, 2, 35, "Subsubsection"],
Cell[21341, 549, 28181, 698, 1609, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[49559, 1252, 262, 5, 29, "Subsubsection"],
Cell[49824, 1259, 412, 7, 50, "Text"],
Cell[50239, 1268, 114, 1, 30, "Text"],
Cell[50356, 1271, 831, 20, 178, "Input"],
Cell[51190, 1293, 213, 4, 31, "Text"],
Cell[51406, 1299, 819, 28, 63, "Input"]
}, Closed]]
}, Closed]]
}, Open  ]],
Cell[CellGroupData[{
Cell[52286, 1334, 545, 7, 80, "Section"],
Cell[52834, 1343, 464, 8, 49, "Text"],
Cell[53301, 1353, 2241, 54, 220, "Input"],
Cell[55545, 1409, 560, 9, 30, "Text"],
Cell[56108, 1420, 2266, 52, 139, "Input"],
Cell[58377, 1474, 481, 8, 30, "Text"],
Cell[58861, 1484, 2379, 60, 208, "Input"],
Cell[61243, 1546, 229, 3, 30, "Text"],
Cell[61475, 1551, 1447, 31, 114, "Input"],
Cell[62925, 1584, 365, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[63315, 1594, 599, 15, 28, "Input"],
Cell[63917, 1611, 3600, 65, 70, "Output"]
}, Open  ]],
Cell[67532, 1679, 159, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[67716, 1685, 982, 18, 28, "Input"],
Cell[68701, 1705, 3184, 48, 70, "Output"]
}, Open  ]],
Cell[71900, 1756, 617, 10, 30, "Text"],
Cell[72520, 1768, 486, 8, 30, "Text"],
Cell[CellGroupData[{
Cell[73031, 1780, 1353, 27, 28, "Input"],
Cell[74387, 1809, 8507, 192, 70, "Output"]
}, Open  ]],
Cell[82909, 2004, 257, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[83191, 2013, 854, 20, 46, "Input"],
Cell[84048, 2035, 13258, 306, 70, "Output"]
}, Open  ]],
Cell[97321, 2344, 399, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[97745, 2355, 659, 18, 28, "Input"],
Cell[98407, 2375, 9307, 234, 70, "Output"]
}, Open  ]],
Cell[107729, 2612, 120, 1, 30, "Text"],
Cell[107852, 2615, 1701, 38, 80, "Input"],
Cell[109556, 2655, 334, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[109915, 2665, 910, 17, 28, "Input"],
Cell[110828, 2684, 14834, 370, 70, "Output"]
}, Open  ]],
Cell[125677, 3057, 464, 10, 32, "Text"],
Cell[CellGroupData[{
Cell[126166, 3071, 796, 20, 46, "Input"],
Cell[126965, 3093, 955, 14, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[127969, 3113, 469, 6, 50, "Section"],
Cell[128441, 3121, 132, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[128598, 3126, 222, 3, 44, "Subsection"],
Cell[128823, 3131, 753, 12, 30, "Text"],
Cell[129579, 3145, 2095, 49, 110, "Input"],
Cell[131677, 3196, 205, 4, 30, "Text"],
Cell[131885, 3202, 2206, 50, 110, "Input"],
Cell[134094, 3254, 326, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[134445, 3264, 740, 18, 52, "Input"],
Cell[135188, 3284, 389, 6, 28, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[135614, 3295, 883, 19, 52, "Input"],
Cell[136500, 3316, 992, 14, 28, "Output"]
}, Open  ]],
Cell[137507, 3333, 484, 8, 49, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[138028, 3346, 185, 2, 36, "Subsection"],
Cell[138216, 3350, 636, 8, 30, "Text"],
Cell[138855, 3360, 2501, 65, 74, "Input"],
Cell[141359, 3427, 116, 1, 30, "Text"],
Cell[141478, 3430, 396, 10, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[141911, 3445, 126, 2, 36, "Subsection"],
Cell[CellGroupData[{
Cell[142062, 3451, 262, 3, 35, "Subsubsection"],
Cell[142327, 3456, 257, 5, 30, "Text"],
Cell[142587, 3463, 518, 12, 46, "Input"],
Cell[143108, 3477, 285, 5, 30, "Text"],
Cell[143396, 3484, 1417, 32, 80, "Input"],
Cell[144816, 3518, 461, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[145302, 3528, 810, 15, 34, "Input"],
Cell[146115, 3545, 561, 10, 32, "Output"]
}, Open  ]],
Cell[146691, 3558, 296, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[147012, 3568, 1276, 28, 28, "Input"],
Cell[148291, 3598, 2402, 60, 102, "Output"]
}, Open  ]],
Cell[150708, 3661, 403, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[151136, 3672, 1350, 33, 49, "Input"],
Cell[152489, 3707, 2178, 52, 102, "Output"]
}, Open  ]],
Cell[154682, 3762, 359, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[155066, 3771, 1206, 33, 46, "Input"],
Cell[156275, 3806, 476, 12, 32, "Output"]
}, Open  ]],
Cell[156766, 3821, 206, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[156997, 3828, 1957, 46, 46, "Input"],
Cell[158957, 3876, 1086, 23, 32, "Output"]
}, Open  ]],
Cell[160058, 3902, 958, 21, 53, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[161053, 3928, 408, 5, 29, "Subsubsection"],
Cell[161464, 3935, 305, 6, 30, "Text"],
Cell[161772, 3943, 779, 17, 46, "Input"],
Cell[162554, 3962, 283, 5, 30, "Text"],
Cell[162840, 3969, 1713, 36, 80, "Input"],
Cell[164556, 4007, 461, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[165042, 4017, 834, 15, 34, "Input"],
Cell[165879, 4034, 798, 15, 32, "Output"]
}, Open  ]],
Cell[166692, 4052, 296, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[167013, 4062, 1750, 40, 70, "Input"],
Cell[168766, 4104, 2637, 68, 102, "Output"]
}, Open  ]],
Cell[171418, 4175, 270, 6, 30, "Text"],
Cell[171691, 4183, 330, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[172046, 4193, 1229, 32, 49, "Input"],
Cell[173278, 4227, 1777, 46, 53, "Output"]
}, Open  ]],
Cell[175070, 4276, 305, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[175400, 4284, 1389, 39, 70, "Input"],
Cell[176792, 4325, 448, 13, 32, "Output"]
}, Open  ]],
Cell[177255, 4341, 207, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[177487, 4348, 1622, 46, 70, "Input"],
Cell[179112, 4396, 535, 17, 32, "Output"]
}, Open  ]],
Cell[179662, 4416, 1737, 38, 55, "Text"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[181448, 4460, 354, 5, 36, "Subsection"],
Cell[181805, 4467, 1617, 32, 89, "Text"],
Cell[183425, 4501, 1569, 29, 135, "Text"],
Cell[CellGroupData[{
Cell[185019, 4534, 1059, 30, 28, "Input"],
Cell[186081, 4566, 99, 1, 28, "Output"]
}, Open  ]],
Cell[186195, 4570, 994, 24, 58, "Text"],
Cell[CellGroupData[{
Cell[187214, 4598, 334, 4, 35, "Subsubsection"],
Cell[187551, 4604, 805, 13, 30, "Text"],
Cell[CellGroupData[{
Cell[188381, 4621, 3127, 90, 119, "Input"],
Cell[191511, 4713, 815, 13, 28, "Output"]
}, Open  ]],
Cell[192341, 4729, 540, 9, 49, "Text"],
Cell[CellGroupData[{
Cell[192906, 4742, 2766, 73, 129, "Input"],
Cell[195675, 4817, 1808, 41, 55, "Output"]
}, Open  ]],
Cell[197498, 4861, 276, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[197799, 4871, 685, 18, 48, "Input"],
Cell[198487, 4891, 348, 5, 28, "Output"]
}, Open  ]],
Cell[198850, 4899, 774, 17, 38, "Text"],
Cell[CellGroupData[{
Cell[199649, 4920, 1310, 35, 68, "Input"],
Cell[200962, 4957, 312, 4, 28, "Output"]
}, Open  ]],
Cell[201289, 4964, 145, 3, 30, "Text"],
Cell[201437, 4969, 182, 4, 30, "Text"],
Cell[201622, 4975, 1326, 33, 57, "Input"],
Cell[202951, 5010, 505, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[203481, 5021, 1625, 39, 57, "Input"],
Cell[205109, 5062, 2587, 54, 54, "Output"]
}, Open  ]],
Cell[207711, 5119, 110, 1, 30, "Text"],
Cell[207824, 5122, 965, 27, 35, "Input"],
Cell[208792, 5151, 1242, 18, 68, "Text"],
Cell[210037, 5171, 1045, 30, 55, "Input"]
}, Open  ]],
Cell[CellGroupData[{
Cell[211119, 5206, 238, 3, 35, "Subsubsection"],
Cell[211360, 5211, 854, 13, 49, "Text"],
Cell[CellGroupData[{
Cell[212239, 5228, 3688, 100, 121, "Input"],
Cell[215930, 5330, 942, 14, 28, "Output"]
}, Open  ]],
Cell[216887, 5347, 540, 9, 49, "Text"],
Cell[CellGroupData[{
Cell[217452, 5360, 2740, 76, 129, "Input"],
Cell[220195, 5438, 1512, 38, 55, "Output"]
}, Open  ]],
Cell[221722, 5479, 220, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[221967, 5488, 665, 19, 48, "Input"],
Cell[222635, 5509, 124, 2, 28, "Output"]
}, Open  ]],
Cell[222774, 5514, 142, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[222941, 5521, 1235, 34, 68, "Input"],
Cell[224179, 5557, 218, 3, 28, "Output"]
}, Open  ]],
Cell[224412, 5563, 182, 4, 30, "Text"],
Cell[224597, 5569, 1012, 30, 57, "Input"],
Cell[225612, 5601, 507, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[226144, 5612, 1456, 40, 81, "Input"],
Cell[227603, 5654, 1456, 41, 35, "Output"]
}, Open  ]],
Cell[229074, 5698, 110, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[229209, 5703, 1211, 32, 35, "Input"],
Cell[230423, 5737, 897, 27, 35, "Output"]
}, Open  ]],
Cell[231335, 5767, 1300, 19, 68, "Text"],
Cell[CellGroupData[{
Cell[232660, 5790, 1013, 30, 55, "Input"],
Cell[233676, 5822, 910, 28, 54, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[234659, 5858, 835, 11, 80, "Section"],
Cell[235497, 5871, 489, 8, 30, "Text"],
Cell[CellGroupData[{
Cell[236011, 5883, 175, 2, 44, "Subsection"],
Cell[236189, 5887, 242, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[236456, 5894, 1097, 26, 46, "Input"],
Cell[237556, 5922, 690, 18, 47, "Output"]
}, Open  ]],
Cell[238261, 5943, 195, 4, 30, "Text"],
Cell[238459, 5949, 118, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[238602, 5954, 1987, 43, 63, "Input"],
Cell[240592, 5999, 161, 3, 28, "Output"]
}, Open  ]],
Cell[240768, 6005, 133, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[240926, 6011, 1784, 46, 97, "Input"],
Cell[242713, 6059, 20672, 532, 393, "Output"]
}, Open  ]],
Cell[263400, 6594, 122, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[263547, 6599, 1165, 25, 28, "Input"],
Cell[264715, 6626, 22725, 558, 457, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[287489, 7190, 105, 1, 36, "Subsection"],
Cell[287597, 7193, 1954, 63, 86, "Input"],
Cell[289554, 7258, 247, 5, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[289838, 7268, 620, 8, 36, "Subsection"],
Cell[290461, 7278, 321, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[290807, 7288, 1158, 26, 28, "Input"],
Cell[291968, 7316, 450, 12, 49, "Output"]
}, Open  ]],
Cell[292433, 7331, 410, 10, 32, "Text"],
Cell[CellGroupData[{
Cell[292868, 7345, 1013, 31, 48, "Input"],
Cell[293884, 7378, 174, 3, 28, "Output"],
Cell[294061, 7383, 176, 3, 28, "Output"]
}, Open  ]],
Cell[294252, 7389, 526, 9, 49, "Text"]
}, Closed]],
Cell[CellGroupData[{
Cell[294815, 7403, 553, 7, 36, "Subsection"],
Cell[295371, 7412, 192, 4, 30, "Text"],
Cell[295566, 7418, 1420, 29, 28, "Input"],
Cell[296989, 7449, 255, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[297269, 7456, 537, 15, 48, "Input"],
Cell[297809, 7473, 174, 3, 28, "Output"]
}, Open  ]],
Cell[297998, 7479, 183, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[298206, 7487, 864, 25, 48, "Input"],
Cell[299073, 7514, 519, 13, 47, "Output"]
}, Open  ]],
Cell[299607, 7530, 321, 6, 30, "Text"],
Cell[299931, 7538, 198, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[300154, 7546, 516, 15, 28, "Input"],
Cell[300673, 7563, 272, 9, 47, "Output"]
}, Open  ]],
Cell[300960, 7575, 209, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[301194, 7583, 1827, 53, 80, "Input"],
Cell[303024, 7638, 148, 3, 28, "Output"]
}, Open  ]],
Cell[303187, 7644, 128, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[303340, 7650, 418, 11, 28, "Input"],
Cell[303761, 7663, 73, 1, 28, "Output"]
}, Open  ]],
Cell[303849, 7667, 216, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[304090, 7676, 404, 10, 28, "Input"],
Cell[304497, 7688, 73, 1, 28, "Output"]
}, Open  ]],
Cell[304585, 7692, 403, 7, 49, "Text"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
