(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    286175,       7677]
NotebookOptionsPosition[    273196,       7264]
NotebookOutlinePosition[    273603,       7282]
CellTagsIndexPosition[    273560,       7279]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Sperm/pollen competition drive sex chromosome turnover \
\>", "Title",
 CellChangeTimes->{{3.6756461584547977`*^9, 3.675646190672323*^9}, {
   3.675691343813216*^9, 3.675691344643425*^9}, {3.675718324413807*^9, 
   3.6757183349582043`*^9}, {3.675719587684537*^9, 3.675719616196001*^9}, 
   3.6759056672964783`*^9, 3.676676533093017*^9}],

Cell["Michael Scott & Matthew Osmond", "Subtitle",
 CellChangeTimes->{{3.6756909919076443`*^9, 3.675690999875959*^9}}],

Cell["\<\
This is much like van Doorn & Kirkpatrick 2007 (Nature 449:909), but with \
sperm/pollen competition as well (which we are hoping removes the need for \
sexually antagonistic selection to drive sex chromosome turnover).\t\
\>", "Text",
 CellChangeTimes->{{3.675719638233714*^9, 3.675719730889935*^9}}],

Cell[CellGroupData[{

Cell["Resident life-cycle", "Section",
 CellChangeTimes->{{3.6756910197792797`*^9, 3.675691024113359*^9}, {
  3.67569412935745*^9, 3.6756941314240303`*^9}, {3.675707349839982*^9, 
  3.675707351884247*^9}, {3.675709974013658*^9, 3.675709982915987*^9}}],

Cell["\<\
We start with haploid selection, which occurs in sperm/pollen only. Let XAm \
be the frequency of allele 1 at the diallelic autosomal locus A in \
gametes/pollen with an X allele at an original diallelic sex-determining \
locus. Let YA be the frequency of allele 1 at the diallelic autosomal locus A \
in gametes/pollen with a Y allele at the original diallelic sex-determining \
locus. Let XAf be the frequency of allele 1 at the diallelic autosomal locus \
A in eggs (which necessarily have an X allele at the original diallelic \
sex-determining locus). After selection on male gametes/pollen we then have \
frequencies of A (and a) in each type of gamete/pollen:\
\>", "Text",
 CellChangeTimes->{{3.675646210075425*^9, 3.6756462139879293`*^9}, {
  3.675692881948024*^9, 3.675692905462323*^9}, {3.675702634397826*^9, 
  3.6757026600570383`*^9}, {3.675710000498989*^9, 3.675710437600037*^9}, {
  3.6757106247367887`*^9, 3.675710626158669*^9}, {3.676676556954385*^9, 
  3.6766766218845263`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wbarHap", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"wA", " ", "XAm"}], "+", 
       RowBox[{"wa", " ", "Xam"}]}], ")"}]}], "+", 
    RowBox[{"\[Alpha]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"wA", " ", "YA"}], "+", 
       RowBox[{"wa", " ", "Ya"}]}], ")"}]}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAms", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Alpha]"}], ")"}], "wA", " ", 
    RowBox[{"XAm", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xams", "=", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{"1", "-", "\[Alpha]"}], ")"}], "wa", " ", 
    RowBox[{"Xam", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAs", "=", 
   RowBox[{"\[Alpha]", " ", "wA", "*", 
    RowBox[{"YA", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yas", "=", 
   RowBox[{"\[Alpha]", " ", "wa", "*", 
    RowBox[{"Ya", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAfs", "=", "XAf"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xafs", "=", "Xaf"}], ";"}]}], "Input",
 CellChangeTimes->{{3.675645810680058*^9, 3.6756459276391087`*^9}, {
   3.6756459611641893`*^9, 3.67564599552956*^9}, {3.6756463012573423`*^9, 
   3.6756463017774*^9}, 3.675646515472443*^9, {3.675646641547511*^9, 
   3.675646657805133*^9}, {3.675647674839451*^9, 3.6756477105194483`*^9}, {
   3.675691050900692*^9, 3.6756912374806137`*^9}, {3.675691327244226*^9, 
   3.675691327340498*^9}, {3.675702032463594*^9, 3.675702091069471*^9}, 
   3.675702137656342*^9, {3.675727270631213*^9, 3.67572733497223*^9}, {
   3.675727409214241*^9, 3.675727449474516*^9}}],

Cell["\<\
Check that frequencies A and a in each gamete/pollen type sum to one after \
selection:\
\>", "Text",
 CellChangeTimes->{{3.675691241028049*^9, 3.675691262904736*^9}, {
   3.675691499842326*^9, 3.675691508954028*^9}, {3.6757021446730413`*^9, 
   3.6757021466313477`*^9}, 3.67570266834774*^9, {3.675710454342794*^9, 
   3.675710458811872*^9}, {3.675711308941972*^9, 3.6757113347037287`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAms", "+", "Xams", "+", "YAs", "+", "Yas"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{"XAfs", "+", "Xafs"}]}], "/.", 
   RowBox[{"XAf", "\[Rule]", 
    RowBox[{"1", "-", "Xaf"}]}]}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.6757273549842978`*^9, 3.675727390607794*^9}, {
  3.6757276397063427`*^9, 3.6757276468903522`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, 
   3.675884020229591*^9, 3.6758943462692013`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, 
   3.675884020229591*^9, 3.675894346273225*^9}]
}, Open  ]],

Cell["\<\
After random mating, the frequencies of the diploid genotypes in each sex are\
\
\>", "Text",
 CellChangeTimes->{{3.675646094888542*^9, 3.675646099390658*^9}, {
  3.675646217785323*^9, 3.675646250704771*^9}, {3.67570268816877*^9, 
  3.6757027045136023`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAXA", "=", 
   RowBox[{"XAfs", " ", "XAms"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXa", "=", 
   RowBox[{
    RowBox[{"XAfs", " ", "Xams"}], "+", 
    RowBox[{"Xafs", " ", "XAms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaXa", "=", 
   RowBox[{"Xafs", " ", "Xams"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYA", "=", 
   RowBox[{"XAfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYa", "=", 
   RowBox[{"XAfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYA", "=", 
   RowBox[{"Xafs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYa", "=", 
   RowBox[{"Xafs", " ", "Yas"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646256909181*^9, 3.675646272815617*^9}, {
   3.675646370257011*^9, 3.67564637079287*^9}, {3.675646404699778*^9, 
   3.675646517567526*^9}, {3.675646573911735*^9, 3.675646591557143*^9}, {
   3.675646627619878*^9, 3.67564663177063*^9}, {3.675646667841331*^9, 
   3.675646747122738*^9}, {3.675691396390801*^9, 3.675691472391663*^9}, {
   3.675691536695323*^9, 3.675691538414453*^9}, {3.675691639085917*^9, 
   3.675691650195237*^9}, {3.675691682513646*^9, 3.675691696533524*^9}, {
   3.675691755294464*^9, 3.6756917629827957`*^9}, {3.675691824386702*^9, 
   3.675691852603437*^9}, {3.675692700413486*^9, 3.675692712195026*^9}, {
   3.67569296671769*^9, 3.675692967464675*^9}, {3.6756930389284983`*^9, 
   3.675693095368285*^9}, {3.675693137308187*^9, 3.675693184356132*^9}, {
   3.675693221908244*^9, 3.6756932234970217`*^9}, {3.675693268122773*^9, 
   3.675693270392726*^9}, {3.675693410576119*^9, 3.675693460007984*^9}, {
   3.675693492300033*^9, 3.675693533360964*^9}, 3.675693600152028*^9, {
   3.675702177145516*^9, 3.675702196152766*^9}, {3.6757023129704742`*^9, 
   3.675702317051364*^9}}],

Cell["Sex ratio after mating:", "Text",
 CellChangeTimes->{{3.675691479260996*^9, 3.675691518331197*^9}, {
   3.675702245714006*^9, 3.675702247314129*^9}, 3.675702712372058*^9, 
   3.6757852851401663`*^9, {3.676676519769081*^9, 3.6766765248607693`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"XAYA", "+", "XAYa", "+", "XaYA", "+", "XaYa"}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{
        "XAXA", "+", "XAXa", "+", "XaXa", "+", "XAYA", "+", "XAYa", "+", 
         "XaYA", "+", "XaYa"}], ")"}]}], "/.", 
      RowBox[{"wA", "\[Rule]", "1"}]}], "/.", 
     RowBox[{"wa", "\[Rule]", "1"}]}], "/.", 
    RowBox[{"Ya", "\[Rule]", 
     RowBox[{"1", "-", "YA"}]}]}], "/.", 
   RowBox[{"Xam", "\[Rule]", 
    RowBox[{"1", "-", "XAm"}]}]}], "//", "Factor"}]], "Input"],

Cell[BoxData["\[Alpha]"], "Output",
 CellChangeTimes->{{3.6757854032095118`*^9, 3.6757854082341347`*^9}, 
   3.675884022348506*^9, 3.675894346335474*^9}]
}, Open  ]],

Cell["\<\
After diploid selection (which can differ between males and females) the \
frequencies of the diploid genotypes in each sex are\
\>", "Text",
 CellChangeTimes->{{3.6756467552456417`*^9, 3.67564676342205*^9}, {
  3.675702725992881*^9, 3.67570275267984*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"wbarF", "=", 
   RowBox[{
    RowBox[{"FAA", " ", "XAXA"}], "+", 
    RowBox[{"FAa", " ", "XAXa"}], "+", 
    RowBox[{"Faa", " ", "XaXa"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"wbarM", "=", 
   RowBox[{
    RowBox[{"MAA", " ", "XAYA"}], "+", 
    RowBox[{"MAa", " ", "XAYa"}], "+", 
    RowBox[{"MAa", " ", "XaYA"}], "+", 
    RowBox[{"Maa", " ", "XaYa"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXAs", "=", 
   RowBox[{"FAA", " ", 
    RowBox[{"XAXA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXas", "=", 
   RowBox[{"FAa", " ", 
    RowBox[{"XAXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaXas", "=", 
   RowBox[{"Faa", " ", 
    RowBox[{"XaXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XaYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYas", "=", 
   RowBox[{"Maa", " ", 
    RowBox[{"XaYa", "/", "wbarM"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646788099258*^9, 3.675646827315172*^9}, {
  3.675646906255657*^9, 3.6756471746197577`*^9}, {3.6756477305962267`*^9, 
  3.675647791098443*^9}, {3.675693609968581*^9, 3.6756936401475143`*^9}, {
  3.675702773030509*^9, 3.675702825109133*^9}}],

Cell["\<\
Check that frequencies of diploid genotypes in each sex sum to one after \
diploid selection:\
\>", "Text",
 CellChangeTimes->{{3.67569367511821*^9, 3.6756936990142593`*^9}, {
  3.675702840764554*^9, 3.675702847452877*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAXAs", "+", "XAXas", "+", "XaXas"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAYAs", "+", "XAYas", "+", "XaYAs", "+", "XaYas"}]}], "//", 
  "Factor"}]}], "Input",
 CellChangeTimes->{{3.67569371292774*^9, 3.675693719435033*^9}, {
  3.675702830827154*^9, 3.675702835546769*^9}, {3.67570296812504*^9, 
  3.675702969573578*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9, 3.675727555437428*^9, 
   3.6757852556150913`*^9, 3.6757854222905197`*^9, 3.675884027160019*^9, 
   3.675894346403042*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9, 3.675727555437428*^9, 
   3.6757852556150913`*^9, 3.6757854222905197`*^9, 3.675884027160019*^9, 
   3.675894346405334*^9}]
}, Open  ]],

Cell["\<\
Finally, meiosis occurs, giving the haploid frequencies at the start of the \
next generation\
\>", "Text",
 CellChangeTimes->{{3.675647183205927*^9, 3.675647193439426*^9}, {
  3.675702857268779*^9, 3.6757029057817707`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAfprime", "=", 
   RowBox[{"XAXAs", "+", 
    RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xafprime", "=", 
   RowBox[{"XaXas", "+", 
    RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAmprime", "=", 
   RowBox[{"XAYAs", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}], "XAYas"}], "+", 
    RowBox[{"r", " ", "XaYAs"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Xamprime", "=", 
   RowBox[{"XaYas", "+", 
    RowBox[{"r", " ", "XAYas"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}], " ", "XaYAs"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAprime", "=", 
   RowBox[{"XAYAs", "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "r"}], ")"}], "XaYAs"}], "+", " ", 
    RowBox[{"r", " ", "XAYas"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Yaprime", "=", 
   RowBox[{"XaYas", "+", 
    RowBox[{"r", " ", "XaYAs"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", " ", "r"}], ")"}], " ", "XAYas"}]}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.6756472292114067`*^9, 3.6756473420504217`*^9}, {
  3.6756473952800293`*^9, 3.675647424390531*^9}, {3.675647484585294*^9, 
  3.675647589565673*^9}, {3.675648941522543*^9, 3.675649018308858*^9}, {
  3.675649385250359*^9, 3.675649410886257*^9}, {3.675693872816942*^9, 
  3.675693896989888*^9}, {3.675693964935532*^9, 3.6756940172718267`*^9}, {
  3.675694055414246*^9, 3.6756941117619743`*^9}, {3.675702930758318*^9, 
  3.675702948794842*^9}}],

Cell["\<\
Check that frequencies of haploid genotypes sum to one after meiosis\
\>", "Text",
 CellChangeTimes->{{3.67569367511821*^9, 3.6756936990142593`*^9}, {
  3.67569375263811*^9, 3.675693763639084*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAfprime", "+", "Xafprime"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAmprime", "+", "Xamprime"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"YAprime", "+", "Yaprime"}]}], "//", "Factor"}]}], "Input",
 CellChangeTimes->{{3.67569371292774*^9, 3.675693719435033*^9}, {
  3.675693774249498*^9, 3.675693826562112*^9}, {3.675702917688963*^9, 
  3.675702960491468*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675693788565115*^9, 3.675693826974794*^9, 
   3.675693898532673*^9, {3.675693974855103*^9, 3.675694020508545*^9}, 
   3.675694073054261*^9, 3.6756941134149103`*^9, {3.675702911869741*^9, 
   3.675702960821375*^9}, 3.675727577178288*^9, 3.67578542429417*^9, 
   3.6758943464859247`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675693788565115*^9, 3.675693826974794*^9, 
   3.675693898532673*^9, {3.675693974855103*^9, 3.675694020508545*^9}, 
   3.675694073054261*^9, 3.6756941134149103`*^9, {3.675702911869741*^9, 
   3.675702960821375*^9}, 3.675727577178288*^9, 3.67578542429417*^9, 
   3.675894346490135*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675693788565115*^9, 3.675693826974794*^9, 
   3.675693898532673*^9, {3.675693974855103*^9, 3.675694020508545*^9}, 
   3.675694073054261*^9, 3.6756941134149103`*^9, {3.675702911869741*^9, 
   3.675702960821375*^9}, 3.675727577178288*^9, 3.67578542429417*^9, 
   3.675894346492753*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Resident equilibrium", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9}],

Cell["\<\
We now solve for the equilibrium frequency of A in each of the haploid \
genotypes. Equilibrium is achieved when the following three equations are zero\
\>", "Text",
 CellChangeTimes->{{3.675694155902801*^9, 3.675694193760104*^9}, {
  3.6756944337868023`*^9, 3.6756944351881227`*^9}, {3.6757029847267847`*^9, 
  3.67570303405547*^9}, {3.675710696458521*^9, 3.675710706286772*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqs", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAfprime", "-", "XAf"}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAmprime", "-", "XAm"}], ",", "\[IndentingNewLine]", 
     RowBox[{"YAprime", "-", "YA"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675647987041369*^9, 3.67564802904979*^9}, {
   3.675650509895372*^9, 3.675650527299842*^9}, {3.6756941716513157`*^9, 
   3.6756941738671913`*^9}, {3.675694338488646*^9, 3.675694340978696*^9}, {
   3.675694394143187*^9, 3.6756944261522427`*^9}, 3.6756944751724463`*^9, 
   3.675702984727247*^9, {3.675703036868017*^9, 3.675703037688758*^9}, 
   3.67578824463701*^9}],

Cell["\<\
To simplify the analysis we assume weak selection in both haploids \
(sperm/pollen) and diploids\
\>", "Text",
 CellChangeTimes->{{3.675694205010009*^9, 3.675694211923259*^9}, 
   3.67570298472752*^9, {3.6757030454432507`*^9, 3.6757030568360033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weaksel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAm", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAm", " ", "sAm", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Maa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAf", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAf", " ", "sAf", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Faa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"wA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"t", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"wa", "\[Rule]", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67564806523287*^9, 3.675648221558539*^9}, {
   3.675694367971285*^9, 3.6756943845803022`*^9}, 3.6757029847280283`*^9}],

Cell["We can write the frequencies as Taylor series", "Text",
 CellChangeTimes->{{3.675707045047565*^9, 3.6757070543930063`*^9}, {
  3.675707367038864*^9, 3.675707370179316*^9}, {3.675711803871513*^9, 
  3.6757118112225847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frequenciessub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", 
      RowBox[{"XAf0", "+", 
       RowBox[{"XAf1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAm", "\[Rule]", 
      RowBox[{"XAm0", "+", 
       RowBox[{"XAm1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YA", "\[Rule]", 
      RowBox[{"YA0", "+", 
       RowBox[{"YA1", " ", "\[Epsilon]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675648297857716*^9, 3.6756483630660057`*^9}, 
   3.675648454638584*^9, 3.675702984736863*^9}],

Cell["\<\
Without selection the recursions for the change in frequency of A in each \
gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.6757032054455214`*^9, 3.6757032697493563`*^9}, {
  3.6757098202812138`*^9, 3.675709824765788*^9}, {3.6757117765596933`*^9, 
  3.6757117850524673`*^9}, {3.675711818872109*^9, 3.6757118199810133`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs0", "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
         RowBox[{"Xaf", "\[Rule]", 
          RowBox[{"1", "-", "XAf"}]}]}], "/.", 
        RowBox[{"Ya", "\[Rule]", 
         RowBox[{"1", "-", "YA"}]}]}], "/.", 
       RowBox[{"Xam", "\[Rule]", 
        RowBox[{"1", "-", "XAm"}]}]}], "/.", "frequenciessub"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.675703197099375*^9, 3.675703198353765*^9}, {
  3.675703326603519*^9, 3.675703332003808*^9}, {3.67570336997014*^9, 
  3.675703373531238*^9}, {3.675707060003501*^9, 3.675707071963544*^9}, {
  3.675707629815399*^9, 3.675707668691402*^9}, {3.6757098279293118`*^9, 
  3.6757098635569563`*^9}, {3.675785533464711*^9, 3.675785543888385*^9}, {
  3.675788240589053*^9, 3.675788247183043*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "XAf0"}], "+", "XAm0"}], ")"}]}], ",", 
   RowBox[{"XAf0", "-", 
    RowBox[{"r", " ", "XAf0"}], "-", "XAm0", "+", 
    RowBox[{"r", " ", "YA0"}]}], ",", 
   RowBox[{
    RowBox[{"r", " ", "XAf0"}], "-", 
    RowBox[{"r", " ", "YA0"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675703373832204*^9, 3.675707072550578*^9, 3.6757076390361347`*^9, 
   3.675707669538135*^9, {3.675709828918172*^9, 3.6757098643685303`*^9}, 
   3.675727585946179*^9, 3.675785428940669*^9, 3.675788254779942*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675709831409095*^9, 3.6757098343025913`*^9}, {
  3.675710744701475*^9, 3.675710745621426*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"recursions0", "\[Equal]", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"XAf0", ",", "XAm0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675709931730151*^9, 3.675709948227565*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"XAf0", "\[Rule]", "YA0"}], ",", 
    RowBox[{"XAm0", "\[Rule]", "YA0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6757098363525476`*^9, {3.6757099323567266`*^9, 3.675709948639193*^9}, 
   3.675727587389184*^9, 3.675785430130021*^9, 3.67578825590738*^9}]
}, Open  ]],

Cell["\<\
So, with no selection, the equilibrium frequency of A in each gamete/pollen \
type is equal (and we call this pA).\
\>", "Text",
 CellChangeTimes->{{3.675703427939505*^9, 3.6757035626138153`*^9}, {
   3.675706719194449*^9, 3.675706765062245*^9}, 3.67570996472328*^9, {
   3.6757107664993973`*^9, 3.675710849444377*^9}}],

Cell["\<\
Now, looking at only the first order selection terms, the recursions for the \
change in frequency of A in each gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.67570356712366*^9, 3.675703572187316*^9}, {
  3.67570609431063*^9, 3.675706097287983*^9}, {3.6757069069525433`*^9, 
  3.6757069072532797`*^9}, {3.67571091918222*^9, 3.6757109367564697`*^9}, {
  3.675711772412171*^9, 3.67571177325072*^9}, {3.675716463608975*^9, 
  3.67571647265489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs1", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"Normal", "[", 
      RowBox[{"Series", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
              RowBox[{"Xaf", "\[Rule]", 
               RowBox[{"1", "-", "XAf"}]}]}], "/.", 
             RowBox[{"Ya", "\[Rule]", 
              RowBox[{"1", "-", "YA"}]}]}], "/.", 
            RowBox[{"Xam", "\[Rule]", 
             RowBox[{"1", "-", "XAm"}]}]}], "/.", "frequenciessub"}], "/.", 
          "sol0"}], "/.", 
         RowBox[{"YA0", "\[Rule]", "pA"}]}], ",", 
        RowBox[{"{", 
         RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
     ",", "\[Epsilon]", ",", "Factor"}], "]"}], "//", "Flatten"}]}]], "Input",\

 CellChangeTimes->{{3.6757068495866413`*^9, 3.6757068907711554`*^9}, {
  3.6757069302403297`*^9, 3.675706982461239*^9}, {3.675707087605297*^9, 
  3.6757071228419533`*^9}, {3.67570718969317*^9, 3.675707319107386*^9}, {
  3.675707511314725*^9, 3.675707512612761*^9}, {3.675710885258552*^9, 
  3.675710885357044*^9}, {3.675711221036006*^9, 3.675711227798399*^9}, {
  3.675788237526182*^9, 3.6757882495037823`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}], "-", "XAf1", "+", "XAm1"}], 
     ")"}], " ", "\[Epsilon]"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "r", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}], "+", "XAf1", "-", 
      RowBox[{"r", " ", "XAf1"}], "-", "XAm1", "+", 
      RowBox[{"r", " ", "YA1"}]}], ")"}], " ", "\[Epsilon]"}], ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}], "-", 
      RowBox[{"pA", " ", "r", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}], "+", 
      RowBox[{"r", " ", "XAf1"}], "-", 
      RowBox[{"r", " ", "YA1"}]}], ")"}], " ", "\[Epsilon]"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675706852317442*^9, 3.675706918829287*^9}, {
   3.675706950931774*^9, 3.675706982932413*^9}, {3.6757070910767508`*^9, 
   3.675707123327277*^9}, {3.6757071925330353`*^9, 3.675707319486848*^9}, 
   3.675707513296742*^9, 3.67570768217498*^9, {3.675710857628578*^9, 
   3.675710885875184*^9}, {3.675711222477412*^9, 3.67571122814371*^9}, 
   3.67572758892033*^9, 3.675785431200643*^9, 3.6757882566822844`*^9}]
}, Open  ]],

Cell["\<\
Instead of solving for the first order genotype frequencies we will instead \
solve for the difference in the frequency of A in the different gamete/pollen \
types.\
\>", "Text",
 CellChangeTimes->{{3.6757135825548286`*^9, 3.675713633862471*^9}, 
   3.6757138892769423`*^9, {3.675716482887339*^9, 3.6757164842940083`*^9}}],

Cell["\<\
The difference in the frequency of A with X in females and X in males is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.6757138909855633`*^9, 3.675713959445539*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfXm", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"recursions1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"XAf1", "\[Rule]", 
       RowBox[{"dpAXfXm", "+", "XAm1"}]}]}], ",", "dpAXfXm"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.67571264493021*^9, 3.675712689537509*^9}, {
  3.675712721625124*^9, 3.675712730987232*^9}, {3.6757136496293707`*^9, 
  3.6757136649001226`*^9}, {3.675716490314892*^9, 3.675716491532194*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfXm", "\[Rule]", 
   RowBox[{
    RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
    RowBox[{"6", " ", "hAf", " ", 
     SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
    RowBox[{"4", " ", "hAf", " ", 
     SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
    RowBox[{"pA", " ", "t"}], "-", 
    RowBox[{
     SuperscriptBox["pA", "2"], " ", "t"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675712649738289*^9, 3.675712661484269*^9}, 
   3.675712732353135*^9, 3.6757136656167507`*^9, 3.675716491898244*^9, 
   3.6757275909002647`*^9, 3.675785432660453*^9, 3.675788258653908*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in males and Y is (at equilibrium \
to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713966791181*^9, 3.6757139830606413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXmY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"recursions1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
        RowBox[{"XAf1", "\[Rule]", 
         RowBox[{"dpAXfXm", "+", "XAm1"}]}]}], "/.", "eqdpAXfXm"}], "/.", 
      RowBox[{"XAm1", "\[Rule]", 
       RowBox[{"dpAXmY", "+", "YA1"}]}]}], ",", "dpAXmY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757127688027287`*^9, 3.675712794290226*^9}, {
  3.6757128674967947`*^9, 3.675712955948361*^9}, {3.675713232210559*^9, 
  3.675713326592478*^9}, {3.675713674096274*^9, 3.6757136876868258`*^9}, {
  3.6757164945548773`*^9, 3.675716495980947*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXmY", "\[Rule]", 
   RowBox[{
    FractionBox["1", "r"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "r", " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "-", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675713327517667*^9, {3.675713675336254*^9, 3.6757136899362087`*^9}, 
   3.675716496367241*^9, 3.67572759200576*^9, 3.675785433424408*^9, 
   3.675788259415702*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in females and Y is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713993050933*^9, 3.6757140012817707`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"recursions1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"XAf1", "\[Rule]", 
       RowBox[{"dpAXfY", "+", "YA1"}]}]}], ",", "dpAXfY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757133432729*^9, 3.6757133796267223`*^9}, {
  3.675713699819319*^9, 3.675713703005155*^9}, {3.67571649868948*^9, 
  3.675716499747883*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfY", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "hAm"}], " ", "pA", " ", "sAm"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{"3", " ", "hAm", " ", 
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"2", " ", "hAm", " ", 
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"pA", " ", "t"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "t"}], "+", 
     RowBox[{"pA", " ", "r", " ", "t"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], "r"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675713343667881*^9, 3.675713380152212*^9}, 
   3.675713703634624*^9, 3.675716500081162*^9, 3.675727593224564*^9, 
   3.67578543490516*^9, 3.675788260830711*^9}]
}, Open  ]],

Cell["\<\
So then, to first order, the equilibrium haploid genotype frequencies are(?)\
\>", "Text",
 CellChangeTimes->{{3.6757175107821083`*^9, 3.675717533841239*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqXAf", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"XAf0", "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXmY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"YA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXmY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675716895475359*^9, 3.675716900512623*^9}, {
  3.675717278127964*^9, 3.675717294591033*^9}, {3.675717351754582*^9, 
  3.675717366375647*^9}, {3.675717543006982*^9, 3.675717544667244*^9}, {
  3.6757178596731443`*^9, 3.675717863093356*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
         RowBox[{"hAm", " ", "sAm"}], "-", 
         RowBox[{"pA", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "sAf"}], "+", "sAm", "-", 
            RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]", "-", 
            RowBox[{"pA", " ", "\[Epsilon]"}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{3.6757169011353207`*^9, 3.6757173669613256`*^9, 
  3.6757175450525827`*^9, 3.675717864205447*^9, 3.675727594742791*^9, 
  3.675785436211323*^9, 3.675788261479598*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqXAm", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"XAm0", "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"YA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXfY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675716688271459*^9, 3.6757167143895473`*^9}, {
  3.675716769539331*^9, 3.6757167848745613`*^9}, {3.675716835976749*^9, 
  3.6757168663757353`*^9}, {3.675717219433107*^9, 3.675717236319748*^9}, {
  3.675717303688327*^9, 3.675717309958682*^9}, {3.675717548817417*^9, 
  3.675717549768239*^9}, {3.67571786788925*^9, 3.675717869340398*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pA"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.6757167147918577`*^9, {3.675716770743403*^9, 3.675716785278078*^9}, {
   3.675716840197975*^9, 3.6757168668171043`*^9}, 3.675717236886405*^9, 
   3.675717371726769*^9, 3.675717550116539*^9, 3.675717875403976*^9, 
   3.675727595426388*^9, 3.6757854369665747`*^9, 3.675788263530697*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqYA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"YA0", "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"YA0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfY"}], "/.", 
    "eqdpAXfXm"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675717392424321*^9, 3.675717393210609*^9}, {
  3.675717465498665*^9, 3.675717499551214*^9}, {3.67571755307234*^9, 
  3.675717554018692*^9}, {3.6757178713638563`*^9, 3.675717873545209*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{3.67571750048251*^9, 3.675717554350906*^9, 
  3.675717874008835*^9, 3.675727596078721*^9, 3.6757854378569937`*^9, 
  3.675788264699403*^9}]
}, Open  ]],

Cell["The change in the equilibrium frequency of A is", "Text",
 CellChangeTimes->{{3.67571806556964*^9, 3.675718103851286*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpA", "=", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"2", " ", "XAfprime"}], "+", "XAmprime", "+", 
                 "YAprime", "-", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", "XAf"}], "-", "XAm", "-", "YA"}], ")"}]}], "/.",
                 "weaksel"}], "/.", 
               RowBox[{"Xaf", "\[Rule]", 
                RowBox[{"1", "-", "XAf"}]}]}], "/.", 
              RowBox[{"Ya", "\[Rule]", 
               RowBox[{"1", "-", "YA"}]}]}], "/.", 
             RowBox[{"Xam", "\[Rule]", 
              RowBox[{"1", "-", "XAm"}]}]}], "/.", 
            RowBox[{"XAf", "\[Rule]", "eqXAf"}]}], "/.", 
           RowBox[{"XAm", "\[Rule]", "eqXAm"}]}], "/.", 
          RowBox[{"YA", "\[Rule]", "eqYA"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
      "/", "4"}], ",", "\[Epsilon]", ",", "Simplify"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675717647887065*^9, 3.675717697126732*^9}, {
   3.675717728154462*^9, 3.675717827465465*^9}, {3.675717886726254*^9, 
   3.6757179766881647`*^9}, {3.675718083857135*^9, 3.6757180905764112`*^9}, 
   3.67571817039502*^9, {3.675719298161072*^9, 3.675719300128034*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"pA", "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
      RowBox[{"hAm", " ", "sAm"}], "-", 
      RowBox[{"pA", " ", 
       RowBox[{"(", 
        RowBox[{"sAf", "+", "sAm", "-", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], ")"}], 
    " ", "\[Epsilon]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675717675625972*^9, 3.675717697744046*^9}, {
   3.675717736995945*^9, 3.675717827905334*^9}, {3.675717912013361*^9, 
   3.6757179770805798`*^9}, {3.675718122247941*^9, 3.675718137314794*^9}, 
   3.675718171232416*^9, {3.675719279665413*^9, 3.6757193043150883`*^9}, 
   3.675727597413587*^9, 3.675785439649287*^9, 3.67578826604628*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.6757181100991917`*^9, 3.675718119482112*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpA", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"dpA", "-", "pA"}], "\[Equal]", "0"}], ",", "pA"}], "]"}], "//",
    "FullSimplify"}]}]], "Input",
 CellChangeTimes->{{3.675717988879238*^9, 3.67571803095448*^9}, {
  3.6757181277583733`*^9, 3.6757181353000813`*^9}, {3.6757192734183817`*^9, 
  3.6757193075868177`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"hAf", " ", "sAf"}], "+", 
        RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
       RowBox[{"sAf", "-", 
        RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "sAm", "-", 
        RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675717995245247*^9, 3.675718031314158*^9}, {
   3.675718129676858*^9, 3.675718138913946*^9}, 3.67571817443064*^9, {
   3.675719281498005*^9, 3.675719308048888*^9}, 3.675727602150854*^9, 
   3.675785444054607*^9, 3.675788267688079*^9}]
}, Open  ]],

Cell["\<\
Notice that when t=0 we have equation \[OpenCurlyDoubleQuote]avgpASubs\
\[CloseCurlyDoubleQuote] in van Doorn & Kirkpatrick 2007 (SOM page 6). \
Sperm/pollen selection acts to increase the frequency of A (if selected for, \
t>0).\
\>", "Text",
 CellChangeTimes->{{3.675718177833785*^9, 3.6757182794849873`*^9}}],

Cell["\<\
Notice that, without sperm/pollen competition, the non-trivial equilibrium \
does not exist when there is no sexually antagonistic selection\
\>", "Text",
 CellChangeTimes->{{3.675721309214287*^9, 3.6757213820811357`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"0", "<", "pA"}], "/.", 
       RowBox[{"eqpA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", ">", "pA"}], "/.", 
       RowBox[{"eqpA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "&&", 
    RowBox[{"sAm", ">", "0"}], "&&", 
    RowBox[{"sAf", ">", "0"}], "&&", 
    RowBox[{"hAf", ">", "0"}], "&&", 
    RowBox[{"hAm", ">", "0"}], "&&", 
    RowBox[{"hAf", "<", "1"}], "&&", 
    RowBox[{"hAm", "<", "1"}]}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.675721205546542*^9, 3.6757213041340637`*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{{3.6757212132856903`*^9, 3.675721304688283*^9}, 
   3.6757276039667053`*^9, 3.675785445007743*^9, 3.675788269474324*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"0", "<", "pA"}], "/.", 
       RowBox[{"eqpA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"1", ">", "pA"}], "/.", 
       RowBox[{"eqpA", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{"t", "\[Rule]", "0"}]}], ")"}], "&&", 
    RowBox[{"sAm", "<", "0"}], "&&", 
    RowBox[{"sAf", "<", "0"}], "&&", 
    RowBox[{"hAf", ">", "0"}], "&&", 
    RowBox[{"hAm", ">", "0"}], "&&", 
    RowBox[{"hAf", "<", "1"}], "&&", 
    RowBox[{"hAm", "<", "1"}]}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.675721356822701*^9, 3.675721358972645*^9}}],

Cell[BoxData["False"], "Output",
 CellChangeTimes->{3.675721359354959*^9, 3.675727604482841*^9, 
  3.67578544579348*^9, 3.675788270629342*^9}]
}, Open  ]],

Cell["\<\
But with sperm/pollen competition it can exist, even without sexually \
antagonistic selection\
\>", "Text",
 CellChangeTimes->{{3.6757213615608473`*^9, 3.6757213940767937`*^9}, {
  3.675721438770338*^9, 3.675721440381878*^9}, {3.675721584413671*^9, 
  3.6757215921481323`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Reduce", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"0", "<", "pA"}], "/.", 
      RowBox[{"eqpA", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "&&", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"1", ">", "pA"}], "/.", 
      RowBox[{"eqpA", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ")"}], "&&", 
    RowBox[{"sAm", "<", "0"}], "&&", 
    RowBox[{"sAf", "<", "0"}], "&&", 
    RowBox[{"hAf", ">", "0"}], "&&", 
    RowBox[{"hAm", ">", "0"}], "&&", 
    RowBox[{"hAf", "<", "1"}], "&&", 
    RowBox[{"hAm", "<", "1"}], "&&", 
    RowBox[{"t", ">", "0"}]}], ",", "Reals"}], "]"}]], "Input",
 CellChangeTimes->{{3.675721404126423*^9, 3.6757214202988453`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sAm", "<", "0"}], "&&", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sAf", "\[LessEqual]", "sAm"}], "&&", 
      RowBox[{"0", "<", "hAm", "<", "1"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0", "<", "hAf", "<", 
           FractionBox[
            RowBox[{"sAf", "+", "sAm", "-", 
             RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
            RowBox[{"2", " ", "sAf"}]]}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
            RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
           RowBox[{
            RowBox[{"-", "sAf"}], "+", 
            RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
            RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"sAf", "+", "sAm", "-", 
             RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
            RowBox[{"2", " ", "sAf"}]], "<", "hAf", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "sAf"}], "+", 
            RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
            RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
            RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], ")"}], "||", 
    
    RowBox[{"(", 
     RowBox[{
      RowBox[{"sAm", "<", "sAf", "<", "0"}], "&&", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"0", "<", "hAm", "\[LessEqual]", 
           FractionBox[
            RowBox[{
             RowBox[{"-", "sAf"}], "+", "sAm"}], 
            RowBox[{"2", " ", "sAm"}]]}], "&&", 
          RowBox[{"0", "<", "hAf", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
            RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
           RowBox[{
            RowBox[{"-", "sAf"}], "+", 
            RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
            RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{
             RowBox[{"-", "sAf"}], "+", "sAm"}], 
            RowBox[{"2", " ", "sAm"}]], "<", "hAm", "<", 
           FractionBox[
            RowBox[{"sAf", "+", "sAm"}], 
            RowBox[{"2", " ", "sAm"}]]}], "&&", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"0", "<", "hAf", "<", 
               FractionBox[
                RowBox[{"sAf", "+", "sAm", "-", 
                 RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
                RowBox[{"2", " ", "sAf"}]]}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{
                 RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
                RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
               RowBox[{
                RowBox[{"-", "sAf"}], "+", 
                RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
                RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}], "||", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               FractionBox[
                RowBox[{"sAf", "+", "sAm", "-", 
                 RowBox[{"2", " ", "hAm", " ", "sAm"}]}], 
                RowBox[{"2", " ", "sAf"}]], "<", "hAf", "<", "1"}], "&&", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "sAf"}], "+", 
                RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
                RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
               RowBox[{
                RowBox[{
                 RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
                RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], ")"}], "||", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           FractionBox[
            RowBox[{"sAf", "+", "sAm"}], 
            RowBox[{"2", " ", "sAm"}]], "\[LessEqual]", "hAm", "<", "1"}], "&&", 
          RowBox[{"0", "<", "hAf", "<", "1"}], "&&", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "sAf"}], "+", 
            RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
            RowBox[{"hAm", " ", "sAm"}]}], "<", "t", "<", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "hAf"}], " ", "sAf"}], "-", 
            RowBox[{"hAm", " ", "sAm"}]}]}]}], ")"}]}], ")"}]}], ")"}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.675721408263239*^9, 3.675721421048749*^9}, 
   3.675727605660432*^9, 3.675785446857723*^9, 3.675788271626335*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Plot", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"pA", "/.", 
          RowBox[{"eqpA", "[", 
           RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
         RowBox[{"sAf", "\[Rule]", 
          RowBox[{"-", "s"}]}]}], "/.", 
        RowBox[{"sAm", "\[Rule]", 
         RowBox[{"-", "s"}]}]}], "/.", 
       RowBox[{"hAf", "\[Rule]", "h"}]}], "/.", 
      RowBox[{"hAm", "\[Rule]", "h"}]}], "/.", 
     RowBox[{"s", "\[Rule]", 
      RowBox[{"1", "/", "10"}]}]}], "/.", 
    RowBox[{"h", "\[Rule]", "1"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"t", ",", "0", ",", 
     RowBox[{"1", "/", "10"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.67572144834195*^9, 3.675721547741859*^9}}],

Cell[BoxData[
 GraphicsBox[{{}, {}, 
   {Hue[0.67, 0.6, 0.6], LineBox[CompressedData["
1:eJwV0HlYjAkAx/GRikh6NKZpipUnzDqSotJqfypCaJNOBqkYrN2KiJERagtT
ikRlUDqUjJnoeNmp7emwelJylA68HdMxNfNuzXZf2/7xfb7/f4x9A1yPqNFo
tN3T/f9UORH8LtL456qbEaNTUxROqC38K5dOA2dytm/RJIVBJk98k64LxUnB
29AJCpvScth8+hLMc7p9b2SUwvfucv8zdDM4q6dYqgYoSAQf1ILom/H+3J+n
OnoosL59qf2d7oK6wyp5VT2Fak0O8RvdB98tDjclPqdAb9ntHV0SiA0DV3iB
XhSCzJPbNGTnMPsfw/J5sygsDr6hqAkIg5IVVOJQoMRo0OGpnNJwMP20Q/N9
lBD9qMNMfheF4vbFrdR8JTzVPzoamEYj+2qI5tFCBZKj9Bl0aSyyXAXNwb4K
DPWYaZsU3cLS/cyDTgsUqPbxmBcqjwcZJhdyXvcizrwzrrkvASzS4tqGE70I
FJYGaVD3wA3YuDyT1YtKgxzOWf1kjBhGXHYv64GuaqqSYgmhqbY9qvJ0D2q/
Htoi2fEQXhp7doca9aBeHCFYVPAIUmtGWUWFHJuM4wo78lPwIN21o/6sHAeS
lsr3VqWibO3nimVL5BgoOX5ga81j+KuqXW1qurGz37KusTMNOz7pCG+EdMOU
ygp1G0uHvWxO4hnjbvyR9MHfdTwD+Wv5m5fXduG+82XXfxc8QeBdqww9XhfY
Etllln4W0qyPFbxhd8GepL6ZMLLRq+XOozd0woAZZvdx5VOcH44cE17pBHey
XKaxJgdhS8zZynWdOK2Iu9m85RmqjizVu9DYAe2smdy7niKsaap+/ii8Ayy9
VWF1ns+hdb1/SLC+Ayr7kzXNlmKwPTiTeV9liP8ovBRbKEbZfltxukCGUKdU
x3wrCU7HNeqZ2spQWn5cV1QiwdF26QZVRzu2MrXHuPa5qAtkzryU0I5lAUFd
qne5uM4iYrahHZuFkkE7lxconHhfXqdoQ6qkzFDt/QuM6aaLJoVt8KtMcojf
9xJX7Yrd/ba14dCrnYKuppeIeOryJGawFa9ExfU6x/JQZc4mBh+0gnNN0yaz
Lw8r5K8vDG1vxcaf2NIZp/Ix0VjRXTTcguA+bQfTiXwwu/UZpSktkPOruo0u
FUBkRiqiXVqQ2X8w8+JkAbye+If00VpQeuIlVxxViG22a4vjskmwXrVvT9ci
IJ4blDvsTWLiojpLNpeA/TppTawXCdLOpMdEh8AnDy0F25NExlu/6LQFBEZS
UlZ4u5GwaGitfWxIwM76w33CmcSuYXJf6hoCtf4WkTwHEhctv558uIdAv3Rg
//hqEj6j47bf9xIIb7M7H7+KxJYio/k/eBBgaMUkrF5JYo4jR/JgHwEbt+W1
nBUkEtybBoR+BK7KPRylxiREwQ38+2cI0PULzfgMEnHWI780hxDI2KTuzFhI
InicaWzEI2Dt6/KrSI+ETbhXaTKfAOdZV/o3XRJvbtfPSo4kkOZgYIi5JLI9
h740XiNgefyIdb0WiRhD/WyWgMDfMRL3gNkk3B577EqKJdDbsCP2oQYJK+7Z
RY23CPCn7jyzUp/2W5WgNLhDQHdZa2WN2rSfMq/Y+y6BVCfTLu6Mab/cz7GJ
iQTWB/I0aDQS/wFx+WwU
     "]]}},
  AspectRatio->NCache[GoldenRatio^(-1), 0.6180339887498948],
  Axes->True,
  AxesOrigin->{0, 0.5},
  PlotRange->NCache[{{0, 
      Rational[1, 10]}, {0.5000000102040816, 0.9999999897959184}}, {{
     0, 0.1}, {0.5000000102040816, 0.9999999897959184}}],
  PlotRangeClipping->True,
  PlotRangePadding->{
    Scaled[0.02], 
    Scaled[0.02]}]], "Output",
 CellChangeTimes->{{3.675721496083349*^9, 3.675721548166576*^9}, 
   3.675727607864105*^9, 3.6757882735873823`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Can calculate equilibrium without weak selection with PAS (Fij=Mij=Wij) and \
r=1/2 (XAf=XAm=YA)\
\>", "Section",
 CellChangeTimes->{{3.675787651568684*^9, 3.675787670529724*^9}, {
  3.6757879566860228`*^9, 3.675787958596723*^9}, {3.675788008891111*^9, 
  3.67578804797843*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subPAS", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"FAA", "\[Rule]", "WAA"}], ",", 
     RowBox[{"FAa", "\[Rule]", "WAa"}], ",", 
     RowBox[{"Faa", "\[Rule]", "Waa"}], ",", 
     RowBox[{"MAA", "\[Rule]", "WAA"}], ",", 
     RowBox[{"MAa", "\[Rule]", "WAa"}], ",", 
     RowBox[{"Maa", "\[Rule]", "Waa"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.67578767630304*^9, 3.675787702421009*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqsPAS", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"{", "\[IndentingNewLine]", 
      RowBox[{
       RowBox[{"XAfprime", "-", "XAf"}], ",", "\[IndentingNewLine]", 
       RowBox[{"XAmprime", "-", "XAm"}], ",", "\[IndentingNewLine]", 
       RowBox[{"YAprime", "-", "YA"}]}], "\[IndentingNewLine]", "}"}], "/.", 
     "subPAS"}], "/.", 
    RowBox[{"r", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675787718650551*^9, 3.675787723701189*^9}, {
  3.675787963351767*^9, 3.675787964383904*^9}, {3.67578822894055*^9, 
  3.675788231642598*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subRes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Xaf", "\[Rule]", 
      RowBox[{"1", "-", "XAf"}]}], ",", 
     RowBox[{"Xam", "\[Rule]", 
      RowBox[{"1", "-", "XAm"}]}], ",", 
     RowBox[{"Ya", "\[Rule]", 
      RowBox[{"1", "-", "YA"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675787741056987*^9, 3.675787766946458*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"differenceEqsPAS", "/.", "subRes"}], ")"}], "\[Equal]", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0"}], "}"}]}], ",", 
   RowBox[{"{", 
    RowBox[{"XAf", ",", "XAm", ",", "YA"}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6757879734470587`*^9, 3.6757879843428593`*^9}, 
   3.675788281517105*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", "0"}], ",", 
     RowBox[{"XAm", "\[Rule]", "0"}], ",", 
     RowBox[{"YA", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", "1"}], ",", 
     RowBox[{"XAm", "\[Rule]", "1"}], ",", 
     RowBox[{"YA", "\[Rule]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "wa", " ", "Waa"}], "-", 
        RowBox[{"wa", " ", "WAa"}], "-", 
        RowBox[{"wA", " ", "WAa"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wa", " ", "Waa"}], "-", 
          RowBox[{"wa", " ", "WAa"}], "-", 
          RowBox[{"wA", " ", "WAa"}], "+", 
          RowBox[{"wA", " ", "WAA"}]}], ")"}]}]]}], ",", 
     RowBox[{"XAm", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "wa", " ", "Waa"}], "-", 
        RowBox[{"wa", " ", "WAa"}], "-", 
        RowBox[{"wA", " ", "WAa"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wa", " ", "Waa"}], "-", 
          RowBox[{"wa", " ", "WAa"}], "-", 
          RowBox[{"wA", " ", "WAa"}], "+", 
          RowBox[{"wA", " ", "WAA"}]}], ")"}]}]]}], ",", 
     RowBox[{"YA", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"2", " ", "wa", " ", "Waa"}], "-", 
        RowBox[{"wa", " ", "WAa"}], "-", 
        RowBox[{"wA", " ", "WAa"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"wa", " ", "Waa"}], "-", 
          RowBox[{"wa", " ", "WAa"}], "-", 
          RowBox[{"wA", " ", "WAa"}], "+", 
          RowBox[{"wA", " ", "WAA"}]}], ")"}]}]]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675787986587545*^9, 3.675788283645953*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Check (internal) Stability of Equilibrium", "Section",
 CellChangeTimes->{{3.675728118153309*^9, 3.6757281301025343`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subRes", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Xaf", "\[Rule]", 
      RowBox[{"1", "-", "XAf"}]}], ",", 
     RowBox[{"Xam", "\[Rule]", 
      RowBox[{"1", "-", "XAm"}]}], ",", 
     RowBox[{"Ya", "\[Rule]", 
      RowBox[{"1", "-", "YA"}]}]}], "}"}]}], ";"}]], "Input"],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matIntFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "XAf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "Xaf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "XAm"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "Xam"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "YA"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "XAfprime", ",", "Xafprime", ",", "XAmprime", ",", "Xamprime", ",",
             "YAprime", ",", "Yaprime"}], "}"}], ",", "Ya"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], "/.", "subRes"}], "//", 
    "Factor"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.6757908602069187`*^9, 3.675790921689528*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "XAf"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Faa", " ", "FAa", " ", 
            SuperscriptBox["wa", "2"]}], "-", 
           RowBox[{"2", " ", "Faa", " ", "FAa", " ", 
            SuperscriptBox["wa", "2"], " ", "XAm"}], "+", 
           RowBox[{
           "2", " ", "Faa", " ", "FAA", " ", "wa", " ", "wA", " ", "XAm"}], 
           "+", 
           RowBox[{"Faa", " ", "FAa", " ", 
            SuperscriptBox["wa", "2"], " ", 
            SuperscriptBox["XAm", "2"]}], "-", 
           RowBox[{"2", " ", "Faa", " ", "FAA", " ", "wa", " ", "wA", " ", 
            SuperscriptBox["XAm", "2"]}], "+", 
           RowBox[{"FAa", " ", "FAA", " ", 
            SuperscriptBox["wA", "2"], " ", 
            SuperscriptBox["XAm", "2"]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Faa", " ", "wa"}], "-", 
            RowBox[{"Faa", " ", "wa", " ", "XAf"}], "+", 
            RowBox[{"FAa", " ", "wa", " ", "XAf"}], "-", 
            RowBox[{"Faa", " ", "wa", " ", "XAm"}], "+", 
            RowBox[{"FAa", " ", "wA", " ", "XAm"}], "+", 
            RowBox[{"Faa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
            RowBox[{"FAa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
            RowBox[{"FAa", " ", "wA", " ", "XAf", " ", "XAm"}], "+", 
            RowBox[{"FAA", " ", "wA", " ", "XAf", " ", "XAm"}]}], ")"}], 
          "2"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"XAf", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Faa", " ", "FAa", " ", 
            SuperscriptBox["wa", "2"]}], "-", 
           RowBox[{"2", " ", "Faa", " ", "FAa", " ", 
            SuperscriptBox["wa", "2"], " ", "XAm"}], "+", 
           RowBox[{
           "2", " ", "Faa", " ", "FAA", " ", "wa", " ", "wA", " ", "XAm"}], 
           "+", 
           RowBox[{"Faa", " ", "FAa", " ", 
            SuperscriptBox["wa", "2"], " ", 
            SuperscriptBox["XAm", "2"]}], "-", 
           RowBox[{"2", " ", "Faa", " ", "FAA", " ", "wa", " ", "wA", " ", 
            SuperscriptBox["XAm", "2"]}], "+", 
           RowBox[{"FAa", " ", "FAA", " ", 
            SuperscriptBox["wA", "2"], " ", 
            SuperscriptBox["XAm", "2"]}]}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Faa", " ", "wa"}], "-", 
            RowBox[{"Faa", " ", "wa", " ", "XAf"}], "+", 
            RowBox[{"FAa", " ", "wa", " ", "XAf"}], "-", 
            RowBox[{"Faa", " ", "wa", " ", "XAm"}], "+", 
            RowBox[{"FAa", " ", "wA", " ", "XAm"}], "+", 
            RowBox[{"Faa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
            RowBox[{"FAa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
            RowBox[{"FAa", " ", "wA", " ", "XAf", " ", "XAm"}], "+", 
            RowBox[{"FAA", " ", "wA", " ", "XAf", " ", "XAm"}]}], ")"}], 
          "2"]}]]}], 
      FractionBox[
       RowBox[{"wa", " ", "wA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Faa"}], " ", "FAa"}], "+", 
          RowBox[{"2", " ", "Faa", " ", "FAa", " ", "XAf"}], "-", 
          RowBox[{"2", " ", "Faa", " ", "FAA", " ", "XAf"}], "-", 
          RowBox[{"Faa", " ", "FAa", " ", 
           SuperscriptBox["XAf", "2"]}], "+", 
          RowBox[{"2", " ", "Faa", " ", "FAA", " ", 
           SuperscriptBox["XAf", "2"]}], "-", 
          RowBox[{"FAa", " ", "FAA", " ", 
           SuperscriptBox["XAf", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "XAm"}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Faa", " ", "wa"}], "-", 
           RowBox[{"Faa", " ", "wa", " ", "XAf"}], "+", 
           RowBox[{"FAa", " ", "wa", " ", "XAf"}], "-", 
           RowBox[{"Faa", " ", "wa", " ", "XAm"}], "+", 
           RowBox[{"FAa", " ", "wA", " ", "XAm"}], "+", 
           RowBox[{"Faa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
           RowBox[{"FAa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
           RowBox[{"FAa", " ", "wA", " ", "XAf", " ", "XAm"}], "+", 
           RowBox[{"FAA", " ", "wA", " ", "XAf", " ", "XAm"}]}], ")"}], 
         "2"]}]], 
      FractionBox[
       RowBox[{"wa", " ", "wA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Faa"}], " ", "FAa"}], "+", 
          RowBox[{"2", " ", "Faa", " ", "FAa", " ", "XAf"}], "-", 
          RowBox[{"2", " ", "Faa", " ", "FAA", " ", "XAf"}], "-", 
          RowBox[{"Faa", " ", "FAa", " ", 
           SuperscriptBox["XAf", "2"]}], "+", 
          RowBox[{"2", " ", "Faa", " ", "FAA", " ", 
           SuperscriptBox["XAf", "2"]}], "-", 
          RowBox[{"FAa", " ", "FAA", " ", 
           SuperscriptBox["XAf", "2"]}]}], ")"}], " ", "XAm"}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Faa", " ", "wa"}], "-", 
           RowBox[{"Faa", " ", "wa", " ", "XAf"}], "+", 
           RowBox[{"FAa", " ", "wa", " ", "XAf"}], "-", 
           RowBox[{"Faa", " ", "wa", " ", "XAm"}], "+", 
           RowBox[{"FAa", " ", "wA", " ", "XAm"}], "+", 
           RowBox[{"Faa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
           RowBox[{"FAa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
           RowBox[{"FAa", " ", "wA", " ", "XAf", " ", "XAm"}], "+", 
           RowBox[{"FAA", " ", "wA", " ", "XAf", " ", "XAm"}]}], ")"}], 
         "2"]}]], "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "XAf"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Faa", " ", "FAa", " ", 
           SuperscriptBox["wa", "2"]}], "-", 
          RowBox[{"2", " ", "Faa", " ", "FAa", " ", 
           SuperscriptBox["wa", "2"], " ", "XAm"}], "+", 
          RowBox[{
          "2", " ", "Faa", " ", "FAA", " ", "wa", " ", "wA", " ", "XAm"}], 
          "+", 
          RowBox[{"Faa", " ", "FAa", " ", 
           SuperscriptBox["wa", "2"], " ", 
           SuperscriptBox["XAm", "2"]}], "-", 
          RowBox[{"2", " ", "Faa", " ", "FAA", " ", "wa", " ", "wA", " ", 
           SuperscriptBox["XAm", "2"]}], "+", 
          RowBox[{"FAa", " ", "FAA", " ", 
           SuperscriptBox["wA", "2"], " ", 
           SuperscriptBox["XAm", "2"]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Faa", " ", "wa"}], "-", 
           RowBox[{"Faa", " ", "wa", " ", "XAf"}], "+", 
           RowBox[{"FAa", " ", "wa", " ", "XAf"}], "-", 
           RowBox[{"Faa", " ", "wa", " ", "XAm"}], "+", 
           RowBox[{"FAa", " ", "wA", " ", "XAm"}], "+", 
           RowBox[{"Faa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
           RowBox[{"FAa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
           RowBox[{"FAa", " ", "wA", " ", "XAf", " ", "XAm"}], "+", 
           RowBox[{"FAA", " ", "wA", " ", "XAf", " ", "XAm"}]}], ")"}], 
         "2"]}]], 
      FractionBox[
       RowBox[{"XAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Faa", " ", "FAa", " ", 
           SuperscriptBox["wa", "2"]}], "-", 
          RowBox[{"2", " ", "Faa", " ", "FAa", " ", 
           SuperscriptBox["wa", "2"], " ", "XAm"}], "+", 
          RowBox[{
          "2", " ", "Faa", " ", "FAA", " ", "wa", " ", "wA", " ", "XAm"}], 
          "+", 
          RowBox[{"Faa", " ", "FAa", " ", 
           SuperscriptBox["wa", "2"], " ", 
           SuperscriptBox["XAm", "2"]}], "-", 
          RowBox[{"2", " ", "Faa", " ", "FAA", " ", "wa", " ", "wA", " ", 
           SuperscriptBox["XAm", "2"]}], "+", 
          RowBox[{"FAa", " ", "FAA", " ", 
           SuperscriptBox["wA", "2"], " ", 
           SuperscriptBox["XAm", "2"]}]}], ")"}]}], 
       RowBox[{"2", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Faa", " ", "wa"}], "-", 
           RowBox[{"Faa", " ", "wa", " ", "XAf"}], "+", 
           RowBox[{"FAa", " ", "wa", " ", "XAf"}], "-", 
           RowBox[{"Faa", " ", "wa", " ", "XAm"}], "+", 
           RowBox[{"FAa", " ", "wA", " ", "XAm"}], "+", 
           RowBox[{"Faa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
           RowBox[{"FAa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
           RowBox[{"FAa", " ", "wA", " ", "XAf", " ", "XAm"}], "+", 
           RowBox[{"FAA", " ", "wA", " ", "XAf", " ", "XAm"}]}], ")"}], 
         "2"]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"wa", " ", "wA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Faa"}], " ", "FAa"}], "+", 
           RowBox[{"2", " ", "Faa", " ", "FAa", " ", "XAf"}], "-", 
           RowBox[{"2", " ", "Faa", " ", "FAA", " ", "XAf"}], "-", 
           RowBox[{"Faa", " ", "FAa", " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{"2", " ", "Faa", " ", "FAA", " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{"FAa", " ", "FAA", " ", 
            SuperscriptBox["XAf", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "XAm"}], ")"}]}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Faa", " ", "wa"}], "-", 
            RowBox[{"Faa", " ", "wa", " ", "XAf"}], "+", 
            RowBox[{"FAa", " ", "wa", " ", "XAf"}], "-", 
            RowBox[{"Faa", " ", "wa", " ", "XAm"}], "+", 
            RowBox[{"FAa", " ", "wA", " ", "XAm"}], "+", 
            RowBox[{"Faa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
            RowBox[{"FAa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
            RowBox[{"FAa", " ", "wA", " ", "XAf", " ", "XAm"}], "+", 
            RowBox[{"FAA", " ", "wA", " ", "XAf", " ", "XAm"}]}], ")"}], 
          "2"]}]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"wa", " ", "wA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Faa"}], " ", "FAa"}], "+", 
           RowBox[{"2", " ", "Faa", " ", "FAa", " ", "XAf"}], "-", 
           RowBox[{"2", " ", "Faa", " ", "FAA", " ", "XAf"}], "-", 
           RowBox[{"Faa", " ", "FAa", " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{"2", " ", "Faa", " ", "FAA", " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{"FAa", " ", "FAA", " ", 
            SuperscriptBox["XAf", "2"]}]}], ")"}], " ", "XAm"}], 
        RowBox[{"2", " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"Faa", " ", "wa"}], "-", 
            RowBox[{"Faa", " ", "wa", " ", "XAf"}], "+", 
            RowBox[{"FAa", " ", "wa", " ", "XAf"}], "-", 
            RowBox[{"Faa", " ", "wa", " ", "XAm"}], "+", 
            RowBox[{"FAa", " ", "wA", " ", "XAm"}], "+", 
            RowBox[{"Faa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
            RowBox[{"FAa", " ", "wa", " ", "XAf", " ", "XAm"}], "-", 
            RowBox[{"FAa", " ", "wA", " ", "XAf", " ", "XAm"}], "+", 
            RowBox[{"FAA", " ", "wA", " ", "XAf", " ", "XAm"}]}], ")"}], 
          "2"]}]]}], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "XAf"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "MAa", " ", 
            SuperscriptBox["wa", "2"]}], "-", 
           RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["wa", "2"]}], "-", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", 
            SuperscriptBox["wa", "2"], " ", "YA"}], "+", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["wa", "2"], " ", "YA"}], "+", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", "YA"}], 
           "+", 
           RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", "YA"}], "-", 
           
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
            "YA"}], "+", 
           RowBox[{"Maa", " ", "MAa", " ", 
            SuperscriptBox["wa", "2"], " ", 
            SuperscriptBox["YA", "2"]}], "-", 
           RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["wa", "2"], " ", 
            SuperscriptBox["YA", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", 
            SuperscriptBox["YA", "2"]}], "-", 
           RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", 
            SuperscriptBox["YA", "2"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
            SuperscriptBox["YA", "2"]}], "+", 
           RowBox[{"MAa", " ", "MAA", " ", 
            SuperscriptBox["wA", "2"], " ", 
            SuperscriptBox["YA", "2"]}], "-", 
           RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
            SuperscriptBox["wA", "2"], " ", 
            SuperscriptBox["YA", "2"]}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "wa", " ", "XAf"}], "-", 
           RowBox[{"MAa", " ", "wa", " ", "XAf"}], "+", 
           RowBox[{"Maa", " ", "wa", " ", "YA"}], "-", 
           RowBox[{"MAa", " ", "wA", " ", "YA"}], "-", 
           RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
           RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
           RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "-", 
           RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], 
         "2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"XAf", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "MAa", " ", 
            SuperscriptBox["wa", "2"]}], "-", 
           RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["wa", "2"]}], "-", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", 
            SuperscriptBox["wa", "2"], " ", "YA"}], "+", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["wa", "2"], " ", "YA"}], "+", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", "YA"}], 
           "+", 
           RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", "YA"}], "-", 
           
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
            "YA"}], "+", 
           RowBox[{"Maa", " ", "MAa", " ", 
            SuperscriptBox["wa", "2"], " ", 
            SuperscriptBox["YA", "2"]}], "-", 
           RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["wa", "2"], " ", 
            SuperscriptBox["YA", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", 
            SuperscriptBox["YA", "2"]}], "-", 
           RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", 
            SuperscriptBox["YA", "2"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
            SuperscriptBox["YA", "2"]}], "+", 
           RowBox[{"MAa", " ", "MAA", " ", 
            SuperscriptBox["wA", "2"], " ", 
            SuperscriptBox["YA", "2"]}], "-", 
           RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
            SuperscriptBox["wA", "2"], " ", 
            SuperscriptBox["YA", "2"]}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "wa", " ", "XAf"}], "-", 
           RowBox[{"MAa", " ", "wa", " ", "XAf"}], "+", 
           RowBox[{"Maa", " ", "wa", " ", "YA"}], "-", 
           RowBox[{"MAa", " ", "wA", " ", "YA"}], "-", 
           RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
           RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
           RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "-", 
           RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], 
         "2"]]}], "0", "0", 
      FractionBox[
       RowBox[{"wa", " ", "wA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "MAa", " ", "r"}], "+", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", "XAf"}], "-", 
          RowBox[{"Maa", " ", "MAA", " ", "XAf"}], "+", 
          RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", "XAf"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", "XAf"}], "-", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", 
           SuperscriptBox["XAf", "2"]}], "+", 
          RowBox[{"Maa", " ", "MAA", " ", 
           SuperscriptBox["XAf", "2"]}], "-", 
          RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["XAf", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", 
           SuperscriptBox["XAf", "2"]}], "-", 
          RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
           SuperscriptBox["XAf", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "YA"}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "wa", " ", "XAf"}], "-", 
          RowBox[{"MAa", " ", "wa", " ", "XAf"}], "+", 
          RowBox[{"Maa", " ", "wa", " ", "YA"}], "-", 
          RowBox[{"MAa", " ", "wA", " ", "YA"}], "-", 
          RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
          RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
          RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "-", 
          RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], "2"]], 
      FractionBox[
       RowBox[{"wa", " ", "wA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "MAa", " ", "r"}], "+", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", "XAf"}], "-", 
          RowBox[{"Maa", " ", "MAA", " ", "XAf"}], "+", 
          RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", "XAf"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", "XAf"}], "-", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", 
           SuperscriptBox["XAf", "2"]}], "+", 
          RowBox[{"Maa", " ", "MAA", " ", 
           SuperscriptBox["XAf", "2"]}], "-", 
          RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["XAf", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", 
           SuperscriptBox["XAf", "2"]}], "-", 
          RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
           SuperscriptBox["XAf", "2"]}]}], ")"}], " ", "YA"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "wa", " ", "XAf"}], "-", 
          RowBox[{"MAa", " ", "wa", " ", "XAf"}], "+", 
          RowBox[{"Maa", " ", "wa", " ", "YA"}], "-", 
          RowBox[{"MAa", " ", "wA", " ", "YA"}], "-", 
          RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
          RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
          RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "-", 
          RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], "2"]]},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "XAf"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "MAa", " ", 
            SuperscriptBox["wa", "2"]}], "+", 
           RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["wa", "2"]}], "+", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", 
            SuperscriptBox["wa", "2"], " ", "YA"}], "-", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["wa", "2"], " ", "YA"}], "-", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", "YA"}], 
           "-", 
           RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", "YA"}], "+", 
           
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
            "YA"}], "-", 
           RowBox[{"Maa", " ", "MAa", " ", 
            SuperscriptBox["wa", "2"], " ", 
            SuperscriptBox["YA", "2"]}], "+", 
           RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["wa", "2"], " ", 
            SuperscriptBox["YA", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", 
            SuperscriptBox["YA", "2"]}], "+", 
           RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", 
            SuperscriptBox["YA", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
            SuperscriptBox["YA", "2"]}], "-", 
           RowBox[{"MAa", " ", "MAA", " ", 
            SuperscriptBox["wA", "2"], " ", 
            SuperscriptBox["YA", "2"]}], "+", 
           RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
            SuperscriptBox["wA", "2"], " ", 
            SuperscriptBox["YA", "2"]}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "wa", " ", "XAf"}], "+", 
           RowBox[{"MAa", " ", "wa", " ", "XAf"}], "-", 
           RowBox[{"Maa", " ", "wa", " ", "YA"}], "+", 
           RowBox[{"MAa", " ", "wA", " ", "YA"}], "+", 
           RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
           RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
           RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "+", 
           RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], 
         "2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"XAf", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "MAa", " ", 
            SuperscriptBox["wa", "2"]}], "+", 
           RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["wa", "2"]}], "+", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", 
            SuperscriptBox["wa", "2"], " ", "YA"}], "-", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["wa", "2"], " ", "YA"}], "-", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", "YA"}], 
           "-", 
           RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", "YA"}], "+", 
           
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
            "YA"}], "-", 
           RowBox[{"Maa", " ", "MAa", " ", 
            SuperscriptBox["wa", "2"], " ", 
            SuperscriptBox["YA", "2"]}], "+", 
           RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["wa", "2"], " ", 
            SuperscriptBox["YA", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", 
            SuperscriptBox["YA", "2"]}], "+", 
           RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", 
            SuperscriptBox["YA", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
            SuperscriptBox["YA", "2"]}], "-", 
           RowBox[{"MAa", " ", "MAA", " ", 
            SuperscriptBox["wA", "2"], " ", 
            SuperscriptBox["YA", "2"]}], "+", 
           RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
            SuperscriptBox["wA", "2"], " ", 
            SuperscriptBox["YA", "2"]}]}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "wa", " ", "XAf"}], "+", 
           RowBox[{"MAa", " ", "wa", " ", "XAf"}], "-", 
           RowBox[{"Maa", " ", "wa", " ", "YA"}], "+", 
           RowBox[{"MAa", " ", "wA", " ", "YA"}], "+", 
           RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
           RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
           RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "+", 
           RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], 
         "2"]]}], "0", "0", 
      FractionBox[
       RowBox[{"wa", " ", "wA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "MAa", " ", "r"}], "-", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", "XAf"}], "+", 
          RowBox[{"Maa", " ", "MAA", " ", "XAf"}], "-", 
          RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", "XAf"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", "XAf"}], "+", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", 
           SuperscriptBox["XAf", "2"]}], "-", 
          RowBox[{"Maa", " ", "MAA", " ", 
           SuperscriptBox["XAf", "2"]}], "+", 
          RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["XAf", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", 
           SuperscriptBox["XAf", "2"]}], "+", 
          RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
           SuperscriptBox["XAf", "2"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "YA"}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "wa", " ", "XAf"}], "+", 
          RowBox[{"MAa", " ", "wa", " ", "XAf"}], "-", 
          RowBox[{"Maa", " ", "wa", " ", "YA"}], "+", 
          RowBox[{"MAa", " ", "wA", " ", "YA"}], "+", 
          RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
          RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
          RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "+", 
          RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], "2"]], 
      FractionBox[
       RowBox[{"wa", " ", "wA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "MAa", " ", "r"}], "-", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", "XAf"}], "+", 
          RowBox[{"Maa", " ", "MAA", " ", "XAf"}], "-", 
          RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", "XAf"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", "XAf"}], "+", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", 
           SuperscriptBox["XAf", "2"]}], "-", 
          RowBox[{"Maa", " ", "MAA", " ", 
           SuperscriptBox["XAf", "2"]}], "+", 
          RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["XAf", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", 
           SuperscriptBox["XAf", "2"]}], "+", 
          RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
           SuperscriptBox["XAf", "2"]}]}], ")"}], " ", "YA"}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "wa", " ", "XAf"}], "+", 
          RowBox[{"MAa", " ", "wa", " ", "XAf"}], "-", 
          RowBox[{"Maa", " ", "wa", " ", "YA"}], "+", 
          RowBox[{"MAa", " ", "wA", " ", "YA"}], "+", 
          RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
          RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
          RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "+", 
          RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], "2"]]},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "XAf"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "MAa", " ", "r", " ", 
           SuperscriptBox["wa", "2"]}], "+", 
          RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["wa", "2"], " ", "YA"}], "+", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", "YA"}], "-", 
          RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", "YA"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
           "YA"}], "-", 
          RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["wa", "2"], " ", 
           SuperscriptBox["YA", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", 
           SuperscriptBox["YA", "2"]}], "+", 
          RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", 
           SuperscriptBox["YA", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
           SuperscriptBox["YA", "2"]}], "-", 
          RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
           SuperscriptBox["wA", "2"], " ", 
           SuperscriptBox["YA", "2"]}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "wa", " ", "XAf"}], "-", 
          RowBox[{"MAa", " ", "wa", " ", "XAf"}], "+", 
          RowBox[{"Maa", " ", "wa", " ", "YA"}], "-", 
          RowBox[{"MAa", " ", "wA", " ", "YA"}], "-", 
          RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
          RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
          RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "-", 
          RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], "2"]], 
      FractionBox[
       RowBox[{"XAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "MAa", " ", "r", " ", 
           SuperscriptBox["wa", "2"]}], "+", 
          RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["wa", "2"], " ", "YA"}], "+", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", "YA"}], "-", 
          RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", "YA"}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
           "YA"}], "-", 
          RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["wa", "2"], " ", 
           SuperscriptBox["YA", "2"]}], "-", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", 
           SuperscriptBox["YA", "2"]}], "+", 
          RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", 
           SuperscriptBox["YA", "2"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
           SuperscriptBox["YA", "2"]}], "-", 
          RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
           SuperscriptBox["wA", "2"], " ", 
           SuperscriptBox["YA", "2"]}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "wa", " ", "XAf"}], "-", 
          RowBox[{"MAa", " ", "wa", " ", "XAf"}], "+", 
          RowBox[{"Maa", " ", "wa", " ", "YA"}], "-", 
          RowBox[{"MAa", " ", "wA", " ", "YA"}], "-", 
          RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
          RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
          RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "-", 
          RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], "2"]], 
      "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"wa", " ", "wA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "MAa"}], "-", 
           RowBox[{"Maa", " ", "MAa", " ", "r"}], "-", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", "XAf"}], "+", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", "XAf"}], "+", 
           RowBox[{"Maa", " ", "MAA", " ", "XAf"}], "+", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", "XAf"}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", "XAf"}], "+", 
           RowBox[{"Maa", " ", "MAa", " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{"Maa", " ", "MAA", " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{"MAa", " ", "MAA", " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
            SuperscriptBox["XAf", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "YA"}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "wa", " ", "XAf"}], "-", 
           RowBox[{"MAa", " ", "wa", " ", "XAf"}], "+", 
           RowBox[{"Maa", " ", "wa", " ", "YA"}], "-", 
           RowBox[{"MAa", " ", "wA", " ", "YA"}], "-", 
           RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
           RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
           RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "-", 
           RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], 
         "2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"wa", " ", "wA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "MAa"}], "-", 
           RowBox[{"Maa", " ", "MAa", " ", "r"}], "-", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", "XAf"}], "+", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", "XAf"}], "+", 
           RowBox[{"Maa", " ", "MAA", " ", "XAf"}], "+", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", "XAf"}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", "XAf"}], "+", 
           RowBox[{"Maa", " ", "MAa", " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{"Maa", " ", "MAA", " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{"MAa", " ", "MAA", " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
            SuperscriptBox["XAf", "2"]}]}], ")"}], " ", "YA"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "wa", " ", "XAf"}], "-", 
           RowBox[{"MAa", " ", "wa", " ", "XAf"}], "+", 
           RowBox[{"Maa", " ", "wa", " ", "YA"}], "-", 
           RowBox[{"MAa", " ", "wA", " ", "YA"}], "-", 
           RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
           RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "+", 
           RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "-", 
           RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], 
         "2"]]}]},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "XAf"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["wa", "2"]}], "-", 
          RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["wa", "2"], " ", "YA"}], "-", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", "YA"}], "+", 
          RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", "YA"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
           "YA"}], "+", 
          RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["wa", "2"], " ", 
           SuperscriptBox["YA", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", 
           SuperscriptBox["YA", "2"]}], "-", 
          RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", 
           SuperscriptBox["YA", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
           SuperscriptBox["YA", "2"]}], "+", 
          RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
           SuperscriptBox["wA", "2"], " ", 
           SuperscriptBox["YA", "2"]}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "wa", " ", "XAf"}], "+", 
          RowBox[{"MAa", " ", "wa", " ", "XAf"}], "-", 
          RowBox[{"Maa", " ", "wa", " ", "YA"}], "+", 
          RowBox[{"MAa", " ", "wA", " ", "YA"}], "+", 
          RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
          RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
          RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "+", 
          RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], "2"]], 
      FractionBox[
       RowBox[{"XAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["wa", "2"]}], "-", 
          RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["wa", "2"], " ", "YA"}], "-", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", "YA"}], "+", 
          RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", "YA"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
           "YA"}], "+", 
          RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
           SuperscriptBox["wa", "2"], " ", 
           SuperscriptBox["YA", "2"]}], "+", 
          RowBox[{
           SuperscriptBox["MAa", "2"], " ", "wa", " ", "wA", " ", 
           SuperscriptBox["YA", "2"]}], "-", 
          RowBox[{"Maa", " ", "MAA", " ", "wa", " ", "wA", " ", 
           SuperscriptBox["YA", "2"]}], "-", 
          RowBox[{"2", " ", 
           SuperscriptBox["MAa", "2"], " ", "r", " ", "wa", " ", "wA", " ", 
           SuperscriptBox["YA", "2"]}], "+", 
          RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
           SuperscriptBox["wA", "2"], " ", 
           SuperscriptBox["YA", "2"]}]}], ")"}]}], 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "wa", " ", "XAf"}], "+", 
          RowBox[{"MAa", " ", "wa", " ", "XAf"}], "-", 
          RowBox[{"Maa", " ", "wa", " ", "YA"}], "+", 
          RowBox[{"MAa", " ", "wA", " ", "YA"}], "+", 
          RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
          RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
          RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "+", 
          RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], "2"]], 
      "0", "0", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"wa", " ", "wA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "MAa"}], "+", 
           RowBox[{"Maa", " ", "MAa", " ", "r"}], "+", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", "XAf"}], "-", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", "XAf"}], "-", 
           RowBox[{"Maa", " ", "MAA", " ", "XAf"}], "-", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", "XAf"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", "XAf"}], "-", 
           RowBox[{"Maa", " ", "MAa", " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{"Maa", " ", "MAA", " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{"MAa", " ", "MAA", " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
            SuperscriptBox["XAf", "2"]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "YA"}], ")"}]}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "wa", " ", "XAf"}], "+", 
           RowBox[{"MAa", " ", "wa", " ", "XAf"}], "-", 
           RowBox[{"Maa", " ", "wa", " ", "YA"}], "+", 
           RowBox[{"MAa", " ", "wA", " ", "YA"}], "+", 
           RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
           RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
           RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "+", 
           RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], 
         "2"]]}], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"wa", " ", "wA", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "MAa"}], "+", 
           RowBox[{"Maa", " ", "MAa", " ", "r"}], "+", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", "XAf"}], "-", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", "XAf"}], "-", 
           RowBox[{"Maa", " ", "MAA", " ", "XAf"}], "-", 
           RowBox[{"2", " ", "Maa", " ", "MAa", " ", "r", " ", "XAf"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", "XAf"}], "-", 
           RowBox[{"Maa", " ", "MAa", " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{
            SuperscriptBox["MAa", "2"], " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{"Maa", " ", "MAA", " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{"MAa", " ", "MAA", " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{"Maa", " ", "MAa", " ", "r", " ", 
            SuperscriptBox["XAf", "2"]}], "-", 
           RowBox[{"2", " ", 
            SuperscriptBox["MAa", "2"], " ", "r", " ", 
            SuperscriptBox["XAf", "2"]}], "+", 
           RowBox[{"MAa", " ", "MAA", " ", "r", " ", 
            SuperscriptBox["XAf", "2"]}]}], ")"}], " ", "YA"}], 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "wa", " ", "XAf"}], "+", 
           RowBox[{"MAa", " ", "wa", " ", "XAf"}], "-", 
           RowBox[{"Maa", " ", "wa", " ", "YA"}], "+", 
           RowBox[{"MAa", " ", "wA", " ", "YA"}], "+", 
           RowBox[{"Maa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
           RowBox[{"MAa", " ", "wa", " ", "XAf", " ", "YA"}], "-", 
           RowBox[{"MAa", " ", "wA", " ", "XAf", " ", "YA"}], "+", 
           RowBox[{"MAA", " ", "wA", " ", "XAf", " ", "YA"}]}], ")"}], "2"]]}]}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.6757909327180843`*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyIntFull", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matIntFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "6", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675790963788534*^9, 3.6757909758461533`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyInt1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"charpolyIntFull", "/.", 
      RowBox[{"XAf", "\[Rule]", "1"}]}], "/.", 
     RowBox[{"XAm", "\[Rule]", "1"}]}], "/.", 
    RowBox[{"YA", "\[Rule]", "1"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675789475257841*^9, 3.675789495224863*^9}, {
   3.675790419784018*^9, 3.675790436109337*^9}, {3.675790707473653*^9, 
   3.6757907121912107`*^9}, 3.675790981141562*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyInt1", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.675790438158463*^9, 3.675790490819627*^9}, 
   3.6757907161064987`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "r"}], "-", 
        SqrtBox[
         RowBox[{"9", "-", 
          RowBox[{"20", " ", "r"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "r"}], "+", 
        SqrtBox[
         RowBox[{"9", "-", 
          RowBox[{"20", " ", "r"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675790470203415*^9, 3.67579049112579*^9}, 
   3.675790716637494*^9, 3.675790762410632*^9, 3.675790984892763*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"charpolyInt1", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Lambda]", "\[Rule]", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6757905419305773`*^9, 3.67579059667633*^9}, {
  3.6757909951816072`*^9, 3.6757909952509527`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "sAf"}], "+", 
       RowBox[{"hAf", " ", "sAf"}], "-", "sAm", "+", 
       RowBox[{"hAm", " ", "sAm"}], "-", "t"}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675790543416122*^9, 3.675790597173519*^9}, {
  3.675790990374691*^9, 3.675790995487912*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyInt0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"charpolyIntFull", "/.", 
      RowBox[{"XAf", "\[Rule]", "0"}]}], "/.", 
     RowBox[{"XAm", "\[Rule]", "0"}]}], "/.", 
    RowBox[{"YA", "\[Rule]", "0"}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675789475257841*^9, 3.675789495224863*^9}, {
   3.675790419784018*^9, 3.675790436109337*^9}, {3.675790707473653*^9, 
   3.6757907121912107`*^9}, 3.675790981141562*^9, {3.675791011580246*^9, 
   3.6757910160572977`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyInt0", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.675790438158463*^9, 3.675790490819627*^9}, 
   3.6757907161064987`*^9, {3.675791021778805*^9, 3.6757910218818493`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "r"}], "-", 
        SqrtBox[
         RowBox[{"9", "-", 
          RowBox[{"20", " ", "r"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "r"}], "+", 
        SqrtBox[
         RowBox[{"9", "-", 
          RowBox[{"20", " ", "r"}], "+", 
          RowBox[{"4", " ", 
           SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.675790470203415*^9, 3.67579049112579*^9}, 
   3.675790716637494*^9, 3.675790762410632*^9, 3.675790984892763*^9, {
   3.675791022931171*^9, 3.6757910250816393`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"charpolyInt0", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Lambda]", "\[Rule]", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.6757905419305773`*^9, 3.67579059667633*^9}, {
  3.6757909951816072`*^9, 3.6757909952509527`*^9}, {3.675791030843678*^9, 
  3.6757910309227667`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", 
    RowBox[{
     FractionBox["1", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hAf", " ", "sAf"}], "+", 
       RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{3.675799455916547*^9}]
}, Open  ]],

Cell["\<\
So protected polymorphism requires that 
(-sAf(1-hAf) -sAm(1-hAm) - t ) > 0 && (hAf sAf + hAm sAm + t ) > 0\
\>", "Text",
 CellChangeTimes->{{3.67579927992915*^9, 3.675799368289077*^9}}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["only need below?", "Title",
 CellChangeTimes->{{3.676676676698202*^9, 3.67667668055787*^9}}],

Cell[CellGroupData[{

Cell["Recursions", "Section",
 CellChangeTimes->{{3.6756910197792797`*^9, 3.675691024113359*^9}, {
   3.67569412935745*^9, 3.6756941314240303`*^9}, {3.675707349839982*^9, 
   3.675707351884247*^9}, {3.675709974013658*^9, 3.675709982915987*^9}, {
   3.6757923469668207`*^9, 3.675792350124728*^9}, 3.676676690696854*^9}],

Cell["\<\
We consider three loci: 1) a diallelic autosomal locus A, 2) an original \
diallelic sex-determining locus, and 3) a novel diallelic sex-determining \
locus. We assume that most gametes have the null/wild-type allele at the \
novel sex-determining locus, but a few have a new mutation y at this locus, \
which is masculinizing and is dominant over the original diallelic \
sex-determining locus (making that locus superfluous). 

Definitions:

Let XAf be the frequency of allele 1 at the diallelic autosomal locus A in \
eggs, which necessarily have an X allele at the original diallelic \
sex-determining locus and a null allele at the novel sex-determining locus \
(otherwise the diploid parent would have been male). 
Let XAm be the frequency of allele 1 at the diallelic autosomal locus A in \
gametes/pollen from males with an X allele at the original diallelic \
sex-determining locus and a null allele at the novel sex-determining locus. 
Let YA be the frequency of allele 1 at the diallelic autosomal locus A in \
gametes/pollen with a Y allele at the original diallelic sex-determining \
locus and a null allele at the novel sex-determining locus. 

Let XAyf be the frequency of allele 1 at the diallelic autosomal locus A in \
eggs with a y allele at the novel diallelic sex-determining locus (this can \
only happen if the mutation arises during the haploid stage, otherwise the y \
mutation would have made the diploid parent male).
Let XAym be the frequency of allele 1 at the diallelic autosomal locus A in \
gametes/pollen from males with a y allele at the novel diallelic \
sex-determining locus.\
\>", "Text",
 CellChangeTimes->{{3.675646210075425*^9, 3.6756462139879293`*^9}, {
   3.675692881948024*^9, 3.675692905462323*^9}, {3.675702634397826*^9, 
   3.6757026600570383`*^9}, {3.675710000498989*^9, 3.675710437600037*^9}, {
   3.6757106247367887`*^9, 3.675710626158669*^9}, {3.675792380024247*^9, 
   3.6757924424434967`*^9}, {3.6766767101519136`*^9, 3.676676821916243*^9}, {
   3.676676854671156*^9, 3.676676936090798*^9}, {3.676676969927855*^9, 
   3.6766771026976233`*^9}, {3.6766771405687523`*^9, 3.676677267000321*^9}, {
   3.6766773144445467`*^9, 3.676677512953319*^9}, {3.676677557552327*^9, 
   3.676677565011045*^9}, {3.676677607075321*^9, 3.676677629948578*^9}, {
   3.676677676927281*^9, 3.6766777279544153`*^9}, 3.6766803851556997`*^9}],

Cell[CellGroupData[{

Cell["Haploid selection", "Subsection",
 CellChangeTimes->{{3.676680390552682*^9, 3.676680393224043*^9}}],

Cell["\<\
We start with haploid selection, which occurs in sperm/pollen only. We assume \
male sperm/pollen compete for eggs, and that the autosomal locus A determines \
their competitive ability (with relative fitnesses wA and wa). After \
selection on male gametes/pollen we then have frequencies of allele 1 (and \
allele 2; denoted by little a, e.g., Xaf) in each type of gamete/pollen:\
\>", "Text",
 CellChangeTimes->{{3.675646210075425*^9, 3.6756462139879293`*^9}, {
  3.675692881948024*^9, 3.675692905462323*^9}, {3.675702634397826*^9, 
  3.6757026600570383`*^9}, {3.675710000498989*^9, 3.675710437600037*^9}, {
  3.6757106247367887`*^9, 3.675710626158669*^9}, {3.675792380024247*^9, 
  3.6757924424434967`*^9}, {3.6766767101519136`*^9, 3.676676821916243*^9}, {
  3.676676854671156*^9, 3.676676936090798*^9}, {3.676676969927855*^9, 
  3.6766771026976233`*^9}, {3.6766771405687523`*^9, 3.676677267000321*^9}, {
  3.6766773144445467`*^9, 3.676677512953319*^9}, {3.676677557552327*^9, 
  3.676677565011045*^9}, {3.676677607075321*^9, 3.676677629948578*^9}, {
  3.676677676927281*^9, 3.6766777279544153`*^9}, {3.6766803851556997`*^9, 
  3.676680387344873*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", 
   RowBox[{"non", "-", 
    RowBox[{"mutant", " ", "eggs"}]}], "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"XAfs", "=", "XAf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xafs", "=", "Xaf"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mutant", " ", "eggs"}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyfs", "=", "XAyf"}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xayfs", "=", "Xayf"}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mean", " ", "fitness", " ", "of", " ", "male", " ", "gametes"}], 
    "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"wbarHap", "=", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"wA", " ", "XAm"}], "+", 
        RowBox[{"wa", " ", "Xam"}], "+", 
        RowBox[{"wA", " ", "XAym"}], "+", 
        RowBox[{"wa", " ", "Xaym"}]}], ")"}], "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"wA", " ", "YA"}], "+", 
        RowBox[{"wa", " ", "Ya"}], "+", 
        RowBox[{"wA", " ", "YAy"}], "+", 
        RowBox[{"wa", " ", "Yay"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]",
    "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "male", " ", "gametes"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAms", "=", 
     RowBox[{"wA", " ", 
      RowBox[{"XAm", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xams", "=", 
     RowBox[{"wa", " ", 
      RowBox[{"Xam", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAs", "=", " ", 
     RowBox[{"wA", " ", 
      RowBox[{"YA", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yas", "=", " ", 
     RowBox[{"wa", " ", 
      RowBox[{"Ya", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"mutant", " ", "male", " ", "gametes"}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyms", "=", 
     RowBox[{"wA", " ", 
      RowBox[{"XAym", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xayms", "=", 
     RowBox[{"wa", " ", 
      RowBox[{"Xaym", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAys", "=", " ", 
     RowBox[{"wA", " ", 
      RowBox[{"YAy", "/", "wbarHap"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Yays", "=", " ", 
     RowBox[{"wa", " ", 
      RowBox[{"Yay", "/", "wbarHap"}]}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675887851245193*^9, 3.675887867834023*^9}, {
  3.676677282192428*^9, 3.6766773057008953`*^9}, {3.676677524747307*^9, 
  3.676677542756909*^9}, {3.676677580215856*^9, 3.676677603744999*^9}, {
  3.676677734415629*^9, 3.676677763178328*^9}, {3.6766778776357307`*^9, 
  3.676677877865404*^9}, {3.676682591464239*^9, 3.67668260166063*^9}}],

Cell["\<\
Where the frequency of allele 2 in each haploid type is 1 minus the frequency \
of allele 1 in that type:\
\>", "Text",
 CellChangeTimes->{{3.676678443433395*^9, 3.6766784465205517`*^9}, {
  3.676678496518735*^9, 3.6766785308908367`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"atoAsubs", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Xaf", "\[Rule]", 
      RowBox[{"1", "-", "XAf"}]}], ",", 
     RowBox[{"Xam", "\[Rule]", 
      RowBox[{"1", "-", "XAm"}]}], ",", 
     RowBox[{"Ya", "\[Rule]", 
      RowBox[{"1", "-", "YA"}]}], ",", 
     RowBox[{"Yay", "\[Rule]", 
      RowBox[{"1", "-", "YAy"}]}], ",", 
     RowBox[{"Xayf", "\[Rule]", 
      RowBox[{"1", "-", "XAyf"}]}], ",", 
     RowBox[{"Xaym", "\[Rule]", 
      RowBox[{"1", "-", "XAym"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676678449326799*^9, 3.676678489085788*^9}}],

Cell["\<\
Check that frequencies allele 1 and 2 in each gamete/pollen type sum to one \
after haploid selection:\
\>", "Text",
 CellChangeTimes->{{3.675691241028049*^9, 3.675691262904736*^9}, {
   3.675691499842326*^9, 3.675691508954028*^9}, {3.6757021446730413`*^9, 
   3.6757021466313477`*^9}, 3.67570266834774*^9, {3.675710454342794*^9, 
   3.675710458811872*^9}, {3.675711308941972*^9, 3.6757113347037287`*^9}, {
   3.676677885608522*^9, 3.6766778886629477`*^9}, {3.6766794933148947`*^9, 
   3.6766794941177*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{
    "XAms", "+", "Xams", "+", "YAs", "+", "Yas", "+", "XAyms", "+", "Xayms", 
     "+", "YAys", "+", "Yays"}]}], "//", "Factor"}], " ", 
  RowBox[{"(*", 
   RowBox[{"male", " ", "gametes"}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"1", "==", 
     RowBox[{"XAfs", "+", "Xafs"}]}], "/.", "atoAsubs"}], "//", "Factor"}], 
  " ", 
  RowBox[{"(*", 
   RowBox[{"non", "-", 
    RowBox[{"mutant", " ", "eggs"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"1", "==", 
    RowBox[{"XAyfs", "+", "Xayfs"}]}], "/.", "atoAsubs"}], "//", "Factor", 
  " ", 
  RowBox[{"(*", 
   RowBox[{"mutant", " ", "eggs"}], "*)"}]}]}], "Input",
 CellChangeTimes->{{3.6757273549842978`*^9, 3.675727390607794*^9}, {
  3.6757276397063427`*^9, 3.6757276468903522`*^9}, {3.675792572534343*^9, 
  3.675792597101988*^9}, {3.676677804145811*^9, 3.676677826030532*^9}, {
  3.676677900791519*^9, 3.67667797831069*^9}, {3.676678537684183*^9, 
  3.676678542015664*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, {
   3.675792579770925*^9, 3.675792597332528*^9}, 3.6758682510725803`*^9, 
   3.675884051627248*^9, 3.67588787251865*^9, 3.675894802110652*^9, 
   3.676652893924481*^9, {3.6766777919311743`*^9, 3.676677818579338*^9}, {
   3.6766779043654737`*^9, 3.676677939916746*^9}, 3.676678542469659*^9, 
   3.676732712247427*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, {
   3.675792579770925*^9, 3.675792597332528*^9}, 3.6758682510725803`*^9, 
   3.675884051627248*^9, 3.67588787251865*^9, 3.675894802110652*^9, 
   3.676652893924481*^9, {3.6766777919311743`*^9, 3.676677818579338*^9}, {
   3.6766779043654737`*^9, 3.676677939916746*^9}, 3.676678542469659*^9, 
   3.6767327122494097`*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{{3.675727347436596*^9, 3.675727390939782*^9}, {
   3.67572744294584*^9, 3.675727451121879*^9}, {3.6757276407275457`*^9, 
   3.675727647216401*^9}, 3.6757851712882767`*^9, 3.675785213984146*^9, {
   3.675792579770925*^9, 3.675792597332528*^9}, 3.6758682510725803`*^9, 
   3.675884051627248*^9, 3.67588787251865*^9, 3.675894802110652*^9, 
   3.676652893924481*^9, {3.6766777919311743`*^9, 3.676677818579338*^9}, {
   3.6766779043654737`*^9, 3.676677939916746*^9}, 3.676678542469659*^9, 
   3.676732712250576*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Random mating", "Subsection",
 CellChangeTimes->{{3.676680401113572*^9, 3.676680402700843*^9}, {
  3.676680492557345*^9, 3.676680499967092*^9}}],

Cell["\<\
After random mating, the frequencies of the diploid genotypes are\
\>", "Text",
 CellChangeTimes->{{3.675646094888542*^9, 3.675646099390658*^9}, {
  3.675646217785323*^9, 3.675646250704771*^9}, {3.67570268816877*^9, 
  3.6757027045136023`*^9}, {3.676678026615859*^9, 3.676678026799192*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "females", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"XAXA", "=", 
     RowBox[{"XAfs", " ", "XAms"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAXa", "=", 
     RowBox[{
      RowBox[{"XAfs", " ", "Xams"}], "+", 
      RowBox[{"Xafs", " ", "XAms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaXa", "=", 
     RowBox[{"Xafs", " ", "Xams"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYA", "=", 
     RowBox[{"XAfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYa", "=", 
     RowBox[{"XAfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYA", "=", 
     RowBox[{"Xafs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYa", "=", 
     RowBox[{"Xafs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"X", "-", 
     RowBox[{"Xy", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyXA", "=", 
     RowBox[{
      RowBox[{"XAyfs", " ", "XAms"}], "+", 
      RowBox[{"XAfs", " ", "XAyms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyXa", "=", 
     RowBox[{
      RowBox[{"XAyfs", " ", "Xams"}], "+", 
      RowBox[{"Xafs", " ", "XAyms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAXay", "=", 
     RowBox[{
      RowBox[{"XAfs", " ", "Xayms"}], "+", 
      RowBox[{"Xayfs", " ", "XAms"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XayXa", "=", 
     RowBox[{
      RowBox[{"Xayfs", " ", "Xams"}], "+", 
      RowBox[{"Xafs", " ", "Xayms"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"X", "-", 
     RowBox[{"Yy", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyYA", "=", 
     RowBox[{"XAyfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyYa", "=", 
     RowBox[{"XAyfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XayYA", "=", 
     RowBox[{"Xayfs", " ", "YAs"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XayYa", "=", 
     RowBox[{"Xayfs", " ", "Yas"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xy", "-", 
     RowBox[{"Y", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYAy", "=", 
     RowBox[{"XAfs", " ", "YAys"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAYay", "=", 
     RowBox[{"XAfs", " ", "Yays"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYAy", "=", 
     RowBox[{"Xafs", " ", "YAys"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XaYay", "=", 
     RowBox[{"Xafs", " ", "Yays"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xy", "-", 
     RowBox[{"Xy", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyXAy", "=", 
     RowBox[{"XAyfs", " ", "XAyms"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyXay", "=", 
     RowBox[{
      RowBox[{"XAyfs", " ", "Xayms"}], "+", 
      RowBox[{"Xayfs", " ", "XAyms"}]}]}], " ", ";"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XayXay", "=", 
     RowBox[{"Xayfs", " ", "Xayms"}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xy", "-", 
     RowBox[{"Yy", " ", "males"}]}], "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyYAy", "=", 
     RowBox[{"XAyfs", " ", "YAys"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAyYay", "=", 
     RowBox[{"XAyfs", " ", "Yays"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XayYAy", "=", 
     RowBox[{"Xayfs", " ", "YAys"}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XayYay", "=", 
     RowBox[{"Xayfs", " ", "Yays"}]}], ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675646256909181*^9, 3.675646272815617*^9}, {
   3.675646370257011*^9, 3.67564637079287*^9}, {3.675646404699778*^9, 
   3.675646517567526*^9}, {3.675646573911735*^9, 3.675646591557143*^9}, {
   3.675646627619878*^9, 3.67564663177063*^9}, {3.675646667841331*^9, 
   3.675646747122738*^9}, {3.675691396390801*^9, 3.675691472391663*^9}, {
   3.675691536695323*^9, 3.675691538414453*^9}, {3.675691639085917*^9, 
   3.675691650195237*^9}, {3.675691682513646*^9, 3.675691696533524*^9}, {
   3.675691755294464*^9, 3.6756917629827957`*^9}, {3.675691824386702*^9, 
   3.675691852603437*^9}, {3.675692700413486*^9, 3.675692712195026*^9}, {
   3.67569296671769*^9, 3.675692967464675*^9}, {3.6756930389284983`*^9, 
   3.675693095368285*^9}, {3.675693137308187*^9, 3.675693184356132*^9}, {
   3.675693221908244*^9, 3.6756932234970217`*^9}, {3.675693268122773*^9, 
   3.675693270392726*^9}, {3.675693410576119*^9, 3.675693460007984*^9}, {
   3.675693492300033*^9, 3.675693533360964*^9}, 3.675693600152028*^9, {
   3.675702177145516*^9, 3.675702196152766*^9}, {3.6757023129704742`*^9, 
   3.675702317051364*^9}, {3.675792623150811*^9, 3.675792640133086*^9}, {
   3.675792682078307*^9, 3.675792755658676*^9}, {3.676678000228277*^9, 
   3.676678010863949*^9}, {3.6766780462191133`*^9, 3.676678234810701*^9}, 
   3.676678754031591*^9, {3.6766789631458273`*^9, 3.6766789866065598`*^9}}],

Cell[TextData[StyleBox["WHAT ARE THESE FREQUENCIES??",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.676680352935326*^9, 3.6766803596453133`*^9}}],

Cell["Now the total frequency is 2", "Text",
 CellChangeTimes->{{3.6766799013673363`*^9, 3.676679909235434*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "XAXA", "+", "XAXa", "+", "XaXa", "+", "XAYA", "+", "XAyXA", "+", "XAyXa", 
    "+", "XAXay", "+", "XayXa", "+", "XAyYA", "+", "XAyYa", "+", "XayYA", "+",
     "XayYa", "+", "XAYAy", "+", "XAYay", "+", "XaYAy", "+", "XaYay", "+", 
    "XAYa", "+", "XaYA", "+", "XaYa", "+", "XAyYAy", "+", "XAyYay", "+", 
    "XayYAy", "+", "XayYay", "+", "XAyXAy", "+", "XAyXay", "+", "XayXay"}], "/.",
    "atoAsubs"}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.676679556131309*^9, 3.676679588784375*^9}, {
  3.676679723115108*^9, 3.676679727031032*^9}}],

Cell[BoxData["2"], "Output",
 CellChangeTimes->{{3.676679551603032*^9, 3.676679589135474*^9}, 
   3.676679727855962*^9, 3.67673271234814*^9}]
}, Open  ]],

Cell["\<\
And the frequencies in single mutants sum to one\
\>", "Text",
 CellChangeTimes->{{3.67667991396815*^9, 3.676679923745125*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "XAyXA", "+", "XAyXa", "+", "XAXay", "+", "XayXa", "+", "XAyYA", "+", 
    "XAyYa", "+", "XayYA", "+", "XayYa", "+", "XAYAy", "+", "XAYay", "+", 
    "XaYAy", "+", "XaYay"}], "/.", "atoAsubs"}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.676678648103326*^9, 3.6766786642667637`*^9}, {
  3.6766792048469667`*^9, 3.676679224638439*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.67667866502864*^9, {3.6766792056765013`*^9, 3.676679225259267*^9}, 
   3.6767327123802357`*^9}]
}, Open  ]],

Cell["\<\
And so do the frequencies in non-mutants and double mutants combined\
\>", "Text",
 CellChangeTimes->{{3.6766799278489943`*^9, 3.6766799424787273`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "XAXA", "+", "XAXa", "+", "XaXa", "+", "XAYA", "+", "XAYa", "+", "XaYA", 
    "+", "XaYa", "+", "XAyYAy", "+", "XAyYay", "+", "XayYAy", "+", "XayYay", 
    "+", "XAyXAy", "+", "XAyXay", "+", "XayXay"}], "/.", "atoAsubs"}], "//", 
  "Factor"}]], "Input",
 CellChangeTimes->{{3.676679325902725*^9, 3.6766793396358843`*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{{3.676679326629445*^9, 3.6766793401126623`*^9}, 
   3.6767327124236727`*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Diploid selection", "Subsection",
 CellChangeTimes->{{3.676680414738653*^9, 3.676680417091516*^9}}],

Cell["\<\
We next model selection in diploids, which can differ among the sexes. Let \
FAA, FAa, and Faa be the relative fitnesses of females homozygous for allele \
1, heterozygous, or homozygous for allele 2 at the autosomal A locus. \
Similarly we use MAA, MAa, and Maa in males. Then after diploid selection the \
frequencies of the diploid genotypes in each sex are\
\>", "Text",
 CellChangeTimes->{{3.6756467552456417`*^9, 3.67564676342205*^9}, {
  3.675702725992881*^9, 3.67570275267984*^9}, {3.6766799909212923`*^9, 
  3.676680143326602*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"wbarF", "=", 
    RowBox[{
     RowBox[{"FAA", " ", "XAXA"}], "+", 
     RowBox[{"FAa", " ", "XAXa"}], "+", 
     RowBox[{"Faa", " ", "XaXa"}]}]}], ";"}], " ", 
  RowBox[{"(*", 
   RowBox[{"mean", " ", "female", " ", "fitness"}], "*)"}], 
  "\[IndentingNewLine]", "\[IndentingNewLine]", 
  RowBox[{"(*", "females", "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXAs", "=", 
   RowBox[{"FAA", " ", 
    RowBox[{"XAXA", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXas", "=", 
   RowBox[{"FAa", " ", 
    RowBox[{"XAXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaXas", "=", 
    RowBox[{"Faa", " ", 
     RowBox[{"XaXa", "/", "wbarF"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"mean", " ", "male", " ", "fitness"}], 
   "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"wbarM", "=", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MAA", " ", "XAyXA"}], "+", 
     RowBox[{"MAa", 
      RowBox[{"(", 
       RowBox[{"XAyXa", "+", "XAXay"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XayXa"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAyXAy"}], "+", 
     RowBox[{"MAa", " ", "XAyXay"}], "+", 
     RowBox[{"Maa", " ", "XayXay"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAYA"}], "+", 
     RowBox[{"MAa", " ", 
      RowBox[{"(", 
       RowBox[{"XAYa", "+", "XaYA"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XaYa"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAyYA"}], "+", 
     RowBox[{"MAa", 
      RowBox[{"(", 
       RowBox[{"XAyYa", "+", "XayYA"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XayYa"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAYAy"}], "+", 
     RowBox[{"MAa", 
      RowBox[{"(", 
       RowBox[{"XAYay", "+", "XaYAy"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XaYay"}], "+", "\[IndentingNewLine]", 
     RowBox[{"MAA", " ", "XAyYAy"}], "+", 
     RowBox[{"MAa", 
      RowBox[{"(", 
       RowBox[{"XAyYay", "+", "XayYAy"}], ")"}]}], "+", 
     RowBox[{"Maa", " ", "XayYay"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"non", "-", 
    RowBox[{"mutant", " ", "males"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XaYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaYas", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XaYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"X", "-", 
    RowBox[{"Xy", " ", "males"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyXA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAyXa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAXays", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAXay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XayXas", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XayXa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"X", "-", 
    RowBox[{"Yy", " ", "males"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYAys", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAYAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAYays", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAYay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XaYAys", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XaYAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XaYays", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XaYay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Xy", "-", 
    RowBox[{"Y", " ", "males"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYAs", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYas", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAyYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayYAs", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XayYA", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XayYas", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XayYa", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Xy", "-", 
    RowBox[{"Xy", " ", "males"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXAys", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyXAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyXays", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAyXay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"XayXays", "=", 
    RowBox[{"Maa", " ", 
     RowBox[{"XayXay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
  "\[IndentingNewLine]", 
  RowBox[{"(*", 
   RowBox[{"Xy", "-", 
    RowBox[{"Yy", " ", "males"}]}], "*)"}]}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYAys", "=", 
   RowBox[{"MAA", " ", 
    RowBox[{"XAyYAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAyYays", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XAyYay", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayYAys", "=", 
   RowBox[{"MAa", " ", 
    RowBox[{"XayYAy", "/", "wbarM"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XayYays", "=", 
   RowBox[{"Maa", " ", 
    RowBox[{"XayYay", "/", "wbarM"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.675646788099258*^9, 3.675646827315172*^9}, {
   3.675646906255657*^9, 3.6756471746197577`*^9}, {3.6756477305962267`*^9, 
   3.675647791098443*^9}, {3.675693609968581*^9, 3.6756936401475143`*^9}, {
   3.675702773030509*^9, 3.675702825109133*^9}, {3.6757958668524837`*^9, 
   3.675796079670739*^9}, {3.675796179417987*^9, 3.675796260462306*^9}, {
   3.675796480404418*^9, 3.675796481420582*^9}, {3.675796553441423*^9, 
   3.67579667834494*^9}, {3.6757967212634993`*^9, 3.67579673565335*^9}, {
   3.675796766370957*^9, 3.675796913595641*^9}, {3.675796952452533*^9, 
   3.675796955994008*^9}, {3.6757970625420837`*^9, 3.675797062966584*^9}, {
   3.675797156973634*^9, 3.675797157898295*^9}, {3.675797509731503*^9, 
   3.6757975122266283`*^9}, 3.6757987828785143`*^9, {3.675798997687969*^9, 
   3.675798999203364*^9}, {3.67668015749852*^9, 3.676680334093931*^9}}],

Cell["\<\
Check that frequencies of diploid genotypes in each sex sum to one after \
diploid selection:\
\>", "Text",
 CellChangeTimes->{{3.67569367511821*^9, 3.6756936990142593`*^9}, {
  3.675702840764554*^9, 3.675702847452877*^9}, {3.676680426109908*^9, 
  3.6766804300707493`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "females", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "==", 
     RowBox[{"XAXAs", "+", "XAXas", "+", "XaXas"}]}], "//", "Factor"}], 
   "\[IndentingNewLine]", 
   RowBox[{"(*", "males", "*)"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"1", "\[Equal]", 
     RowBox[{"(", 
      RowBox[{
      "XAyXAs", "+", "XAyXas", "+", "XAXays", "+", "XayXas", "+", 
       "\[IndentingNewLine]", "XAyXAys", "+", "XAyXays", "+", "XayXays", "+", 
       "\[IndentingNewLine]", "XAYAs", "+", "XAYas", "+", "XaYAs", "+", 
       "XaYas", "+", "\[IndentingNewLine]", "XAyYAs", "+", "XAyYas", "+", 
       "XayYAs", "+", "XayYas", "+", "\[IndentingNewLine]", "XAYAys", "+", 
       "XAYays", "+", "XaYAys", "+", "XaYays", "+", "\[IndentingNewLine]", 
       "XAyYAys", "+", "XAyYays", "+", "XayYAys", "+", "XayYays"}], ")"}]}], "//",
     "Factor"}]}]}]], "Input",
 CellChangeTimes->{{3.67569371292774*^9, 3.675693719435033*^9}, {
  3.675702830827154*^9, 3.675702835546769*^9}, {3.67570296812504*^9, 
  3.675702969573578*^9}, {3.675797014550261*^9, 3.675797032376533*^9}, {
  3.6757970695377398`*^9, 3.675797081268633*^9}, {3.6757973986437397`*^9, 
  3.6757974173271914`*^9}, {3.676680438445856*^9, 3.676680452334581*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9, 3.675727555437428*^9, 
   3.6757852556150913`*^9, 3.6757854222905197`*^9, 3.675797082754839*^9, 
   3.6757971609091988`*^9, {3.675797400992137*^9, 3.675797417649136*^9}, 
   3.675799061857813*^9, 3.675868267413929*^9, 3.675884064066042*^9, 
   3.6758879080912523`*^9, 3.675894820235918*^9, 3.6766528942324266`*^9, {
   3.6766804342274303`*^9, 3.676680453309816*^9}, 3.676732712480825*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6756937198298388`*^9, 3.675702757920513*^9, {3.67570282854655*^9, 
   3.675702835863617*^9}, 3.675702969871677*^9, 3.675727555437428*^9, 
   3.6757852556150913`*^9, 3.6757854222905197`*^9, 3.675797082754839*^9, 
   3.6757971609091988`*^9, {3.675797400992137*^9, 3.675797417649136*^9}, 
   3.675799061857813*^9, 3.675868267413929*^9, 3.675884064066042*^9, 
   3.6758879080912523`*^9, 3.675894820235918*^9, 3.6766528942324266`*^9, {
   3.6766804342274303`*^9, 3.676680453309816*^9}, 3.6767327125217037`*^9}]
}, Open  ]],

Cell[TextData[StyleBox["NOTICE THAT, the frequency of all males after diploid \
selection sums to 1. There are both XX (with y) and XY males. For this reason \
I\[CloseCurlyQuote]m not sure we can make the frequencies of X and Y \
pollen/sperm both sum to 1. Rather, I changed the pollen/sperm production so \
that the total of X and Y pollen/sperm sum to 1. ",
 FontColor->RGBColor[1, 0, 0]]], "Text",
 CellChangeTimes->{{3.675897937055571*^9, 3.675898112308852*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["Meiosis", "Subsection",
 CellChangeTimes->{{3.676680482410777*^9, 3.676680483790394*^9}}],

Cell["\<\
Finally, meiosis occurs. We have three recombination rates to consider (we \
assume no interference):

r: the recombination rate between A and Y
R: the recombination rate between y and A
\[Chi]: the recombination rate between y and Y

We also assume that males produce \[Alpha]% of their gametes with Y \
chromosomes (sex chromosome drive if \[Alpha]\[NotEqual]1/2).
The frequencies of allele 1 and 2 in each gamete type at the start of the \
next generation are then\
\>", "Text",
 CellChangeTimes->{{3.675647183205927*^9, 3.675647193439426*^9}, {
  3.675702857268779*^9, 3.6757029057817707`*^9}, {3.6766805501436253`*^9, 
  3.676680733528471*^9}, {3.676681004266163*^9, 3.67668101976959*^9}, {
  3.676681152971641*^9, 3.6766811584306507`*^9}, {3.676681458381565*^9, 
  3.676681458835539*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(*", "eggs", "*)"}], "\[IndentingNewLine]", 
  RowBox[{
   RowBox[{
    RowBox[{"XAfprime", "=", 
     RowBox[{"XAXAs", "+", 
      RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"Xafprime", "=", 
     RowBox[{"XaXas", "+", 
      RowBox[{"XAXas", "/", "2"}]}]}], ";"}], "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "X", " ", "from", " ", "males"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"XAmprime", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"XAYAs", "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYas", 
            RowBox[{"(", 
             RowBox[{"1", "-", "r"}], ")"}]}], "+", 
           RowBox[{"XaYAs", " ", 
            RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYAys", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
           RowBox[{"XAyYAs", " ", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYays", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
           
           RowBox[{"XayYAs", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XaYAys", 
            RowBox[{"(", "\[Chi]", ")"}]}], "+", 
           RowBox[{"XAyYas", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAyXAs", "/", "2"}], "+", 
        RowBox[{"XAyXas", " ", 
         RowBox[{"R", "/", "2"}]}], "+", 
        RowBox[{"XAXays", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ")"}]}]}], ";"}], 
   "\n", 
   RowBox[{
    RowBox[{"Xamprime", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"XaYas", "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYas", 
            RowBox[{"(", "r", ")"}]}], "+", 
           RowBox[{"XaYAs", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XaYays", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
           RowBox[{"XayYas", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYays", 
            RowBox[{"(", "\[Chi]", ")"}]}], "+", 
           RowBox[{"XayYAs", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XaYAys", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
           
           RowBox[{"XAyYas", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XayXas", "/", "2"}], " ", "+", 
        RowBox[{"XAyXas", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
        RowBox[{"XAXays", " ", 
         RowBox[{
          RowBox[{"(", "R", ")"}], "/", "2"}]}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"non", "-", 
     RowBox[{"mutant", " ", "Y", " ", "from", " ", "males"}]}], "*)"}], 
   "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{"YAprime", " ", "=", 
     RowBox[{"\[Alpha]", 
      RowBox[{"(", 
       RowBox[{"XAYAs", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYas", 
           RowBox[{"(", "r", ")"}]}], "+", 
          RowBox[{"XaYAs", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYAys", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}], "+", 
          RowBox[{"XAyYAs", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYays", " ", 
           RowBox[{"(", 
            RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XayYAs", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
          RowBox[{"XaYAys", 
           RowBox[{"(", 
            RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XAyYas", 
           RowBox[{"(", "\[Chi]", ")"}]}]}], ")"}]}], ")"}]}]}], ";"}], "\n", 
   
   RowBox[{
    RowBox[{"Yaprime", "=", 
     RowBox[{"\[Alpha]", 
      RowBox[{"(", 
       RowBox[{"XaYas", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYas", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}], "+", 
          RowBox[{"XaYAs", " ", 
           RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XaYays", " ", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}], "+", 
          RowBox[{"XayYas", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYays", 
           RowBox[{"(", 
            RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XayYAs", 
           RowBox[{"(", "\[Chi]", ")"}]}], "+", 
          RowBox[{"XaYAys", 
           RowBox[{"(", 
            RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XAyYas", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}]}], 
         ")"}]}], ")"}]}]}], ";"}], "\[IndentingNewLine]", 
   "\[IndentingNewLine]", 
   RowBox[{"(*", 
    RowBox[{"Xy", " ", "from", " ", "males"}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"XAymprime", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"XAyYAys", "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAyYays", 
            RowBox[{"(", 
             RowBox[{"1", "-", "r"}], ")"}]}], "+", 
           RowBox[{"XayYAys", 
            RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYAys", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}], "+", 
           RowBox[{"XAyYAs", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYays", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XayYAs", 
            RowBox[{"(", "\[Chi]", ")"}]}], "+", 
           RowBox[{"XaYAys", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XAyYas", " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}]}], 
          ")"}]}], ")"}]}], "+", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAyXAs", "/", "2"}], "+", 
        RowBox[{"XAyXas", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
        RowBox[{"XAXays", " ", 
         RowBox[{
          RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", "XAyXAys", "+", 
        RowBox[{"XAyXays", "/", "2"}]}], ")"}]}]}], ";"}], "\n", 
   RowBox[{
    RowBox[{"Xaymprime", " ", "=", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"XayYays", "+", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAyYays", 
            RowBox[{"(", "r", ")"}]}], "+", 
           RowBox[{"XayYAys", 
            RowBox[{"(", 
             RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XaYays", " ", 
            RowBox[{"(", 
             RowBox[{"r", "+", "R", "-", 
              RowBox[{"2", "\[Chi]"}]}], ")"}]}], "+", 
           RowBox[{"XayYas", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", 
                RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}]}], ")"}], "+", 
         "\[IndentingNewLine]", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"XAYays", 
            RowBox[{"(", 
             RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XayYAs", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"(", 
               RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
           
           RowBox[{"XaYAys", 
            RowBox[{"(", 
             RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
           RowBox[{"XAyYas", " ", 
            RowBox[{"(", "\[Chi]", ")"}]}]}], ")"}]}], ")"}]}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XayXas", "/", "2"}], " ", "+", 
        RowBox[{"XAyXas", " ", 
         RowBox[{
          RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", 
        RowBox[{"XAXays", " ", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", "XayXays", "+", 
        
        RowBox[{"XAyXays", "/", "2"}]}], ")"}]}]}], ";"}], 
   "\[IndentingNewLine]", "\n", 
   RowBox[{"(*", 
    RowBox[{"Yy", " ", "from", " ", "males"}], "*)"}], "\[IndentingNewLine]", 
   
   RowBox[{
    RowBox[{"YAyprime", " ", "=", 
     RowBox[{"\[Alpha]", 
      RowBox[{"(", 
       RowBox[{"XAyYAys", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAyYays", 
           RowBox[{"(", "r", ")"}]}], "+", 
          RowBox[{"XayYAys", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYAys", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
          RowBox[{"XAyYAs", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYays", " ", 
           RowBox[{"(", "\[Chi]", ")"}]}], "+", 
          RowBox[{"XayYAs", 
           RowBox[{"(", 
            RowBox[{"R", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XaYAys", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
          RowBox[{"XAyYas", " ", 
           RowBox[{"(", 
            RowBox[{"r", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}]}], 
    ";"}], "\n", 
   RowBox[{
    RowBox[{"Yayprime", " ", "=", 
     RowBox[{"\[Alpha]", 
      RowBox[{"(", 
       RowBox[{"XayYays", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAyYays", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}], "+", 
          RowBox[{"XayYAys", 
           RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XaYays", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", 
               RowBox[{"2", "\[Chi]"}]}], ")"}]}], ")"}]}], "+", 
          RowBox[{"XayYas", 
           RowBox[{"(", 
            RowBox[{"r", "+", "R", "-", 
             RowBox[{"2", "\[Chi]"}]}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYays", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"(", 
              RowBox[{"r", "+", "R", "-", "\[Chi]"}], ")"}]}], ")"}]}], "+", 
          RowBox[{"XayYAs", 
           RowBox[{"(", 
            RowBox[{"r", "-", "\[Chi]"}], ")"}]}], "+", 
          RowBox[{"XaYAys", 
           RowBox[{"(", "\[Chi]", ")"}]}], "+", 
          RowBox[{"XAyYas", 
           RowBox[{"(", 
            RowBox[{"R", "-", "\[Chi]"}], ")"}]}]}], ")"}]}], ")"}]}]}], 
    ";"}]}]}]], "Input",
 CellChangeTimes->{{3.675799680833715*^9, 3.6757996941412067`*^9}, {
  3.676680531228826*^9, 3.676680535586874*^9}, {3.676680749579172*^9, 
  3.676680842544508*^9}}],

Cell["Check", "Text",
 CellChangeTimes->{{3.67668087010927*^9, 3.676680870535335*^9}, {
  3.676682191599547*^9, 3.676682193563279*^9}, {3.676682633503108*^9, 
  3.676682739077134*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{"XAfprime", "+", "Xafprime"}]}], "//", 
  "Factor"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"1", "==", 
   RowBox[{
   "XAmprime", "+", "Xamprime", "+", "XAymprime", "+", "Xaymprime", "+", 
    "YAprime", "+", "Yaprime", "+", "YAyprime", "+", "Yayprime"}]}], "//", 
  "Factor"}]}], "Input",
 CellChangeTimes->{{3.676680865590528*^9, 3.6766808676400948`*^9}}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6757998422199907`*^9, 3.6758682703443737`*^9, 3.675884066601346*^9, 
   3.67588414320271*^9, 3.675887913157668*^9, 3.6758948233446608`*^9, 
   3.676652894392449*^9, 3.676680539830617*^9, {3.6766808544919558`*^9, 
   3.676680867990182*^9}, 3.676732712597272*^9}],

Cell[BoxData["True"], "Output",
 CellChangeTimes->{
  3.6757998422199907`*^9, 3.6758682703443737`*^9, 3.675884066601346*^9, 
   3.67588414320271*^9, 3.675887913157668*^9, 3.6758948233446608`*^9, 
   3.676652894392449*^9, 3.676680539830617*^9, {3.6766808544919558`*^9, 
   3.676680867990182*^9}, 3.676732712980933*^9}]
}, Open  ]],

Cell[TextData[{
 " ",
 StyleBox["This makes no sense as at the beginning of the life-cycle XAm was \
the frequency of allele 1 with X\[CloseCurlyQuote]s from males, and now XAm\
\[CloseCurlyQuote] is the frequency of A1X\[CloseCurlyQuote]s from males, so \
we cannot compare the two, e.g., XAm\[CloseCurlyQuote] - XAm.",
  FontColor->RGBColor[1, 0, 0]]
}], "Text",
 CellChangeTimes->{{3.67668274362754*^9, 3.676682787204338*^9}}],

Cell["\<\
There is another, perhaps simpler, way to derive the frequencies of allele 1 \
and 2 in male gametes. We use the following terms
* RX is the chance of a double recombinant 
* RA is the chance of either one or two recombination events in a triple \
heterozygote
* RO is the chance of exactly one recombination event separating y and Y
* R1 is the chance of only a recombination event between y and A
* R2 is the chance of only a recombination event between A and the Y
which will then allow us to choose different gene orders and different \
degrees of cross-over interference.\
\>", "Text",
 CellChangeTimes->{{3.6758973809630632`*^9, 3.6758973915682487`*^9}, {
  3.676681522317402*^9, 3.676681561038911*^9}, {3.6766816731819696`*^9, 
  3.676681734852829*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subR", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"RX", "\[Rule]", "\[Chi]"}], ",", 
     RowBox[{"RA", "\[Rule]", 
      RowBox[{"r", "+", "Rm", "-", "\[Chi]"}]}], ",", 
     RowBox[{"R0", "\[Rule]", 
      RowBox[{"r", "+", "Rm", "-", 
       RowBox[{"2", "\[Chi]"}]}]}], ",", 
     RowBox[{"R1", "\[Rule]", 
      RowBox[{"Rm", "-", "\[Chi]"}]}], ",", 
     RowBox[{"R2", "\[Rule]", 
      RowBox[{"r", "-", "\[Chi]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676681979056713*^9, 3.676681982661722*^9}, {
  3.6766820375487967`*^9, 3.6766820983127604`*^9}, {3.6766821315283937`*^9, 
  3.676682141554142*^9}}],

Cell["\<\
The haploid frequencies are then\
\>", "Text",
 CellChangeTimes->{{3.6766815843823433`*^9, 3.676681593503799*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"XAmprime", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"XAYAs", "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYas", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}], "+", 
         RowBox[{"XaYAs", " ", 
          RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYAys", 
          RowBox[{"(", 
           RowBox[{"1", "-", "R0"}], ")"}]}], "+", 
         RowBox[{"XAyYAs", " ", 
          RowBox[{"(", "R0", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYays", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "RA"}], ")"}]}], "+", 
         RowBox[{"XayYAs", 
          RowBox[{"(", "R2", ")"}]}], "+", 
         RowBox[{"XaYAys", 
          RowBox[{"(", "RX", ")"}]}], "+", 
         RowBox[{"XAyYas", 
          RowBox[{"(", "R1", ")"}]}]}], ")"}]}], ")"}]}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"XAyXAs", "/", "2"}], "+", 
      RowBox[{"XAyXas", " ", 
       RowBox[{"R", "/", "2"}]}], "+", 
      RowBox[{"XAXays", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ")"}]}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Xamprime", " ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"XaYas", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYas", 
           RowBox[{"(", "r", ")"}]}], "+", 
          RowBox[{"XaYAs", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XaYays", " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "R0"}], ")"}]}], "+", 
          RowBox[{"XayYas", 
           RowBox[{"(", "R0", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYays", 
           RowBox[{"(", "RX", ")"}]}], "+", 
          RowBox[{"XayYAs", 
           RowBox[{"(", "R1", ")"}]}], "+", 
          RowBox[{"XaYAys", 
           RowBox[{"(", 
            RowBox[{"1", "-", "RA"}], ")"}]}], "+", 
          RowBox[{"XAyYas", 
           RowBox[{"(", "R2", ")"}]}]}], ")"}]}], ")"}]}], "+", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"XayXas", "/", "2"}], " ", "+", 
       RowBox[{"XAyXas", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
       RowBox[{"XAXays", " ", 
        RowBox[{
         RowBox[{"(", "R", ")"}], "/", "2"}]}]}], ")"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"XAymprime", " ", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
     RowBox[{"(", 
      RowBox[{"XAyYAys", "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAyYays", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}], "+", 
         RowBox[{"XayYAys", 
          RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYAys", 
          RowBox[{"(", "R0", ")"}]}], "+", 
         RowBox[{"XAyYAs", 
          RowBox[{"(", 
           RowBox[{"1", "-", "R0"}], ")"}]}]}], ")"}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYays", 
          RowBox[{"(", "R1", ")"}]}], "+", 
         RowBox[{"XayYAs", 
          RowBox[{"(", "RX", ")"}]}], "+", 
         RowBox[{"XaYAys", 
          RowBox[{"(", "R2", ")"}]}], "+", 
         RowBox[{"XAyYas", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "RA"}], ")"}]}]}], ")"}]}], ")"}]}], "+", 
    "\[IndentingNewLine]", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"XAyXAs", "/", "2"}], "+", 
      RowBox[{"XAyXas", " ", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", 
      RowBox[{"XAXays", " ", 
       RowBox[{
        RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", "XAyXAys", "+", 
      RowBox[{"XAyXays", "/", "2"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Xaymprime", " ", "=", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
      RowBox[{"(", 
       RowBox[{"XayYays", "+", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAyYays", 
           RowBox[{"(", "r", ")"}]}], "+", 
          RowBox[{"XayYAys", 
           RowBox[{"(", 
            RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XaYays", " ", 
           RowBox[{"(", "R0", ")"}]}], "+", 
          RowBox[{"XayYas", 
           RowBox[{"(", 
            RowBox[{"1", "-", "R0"}], ")"}]}]}], ")"}], "+", 
        "\[IndentingNewLine]", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"XAYays", 
           RowBox[{"(", "R2", ")"}]}], "+", 
          RowBox[{"XayYAs", 
           RowBox[{"(", 
            RowBox[{"1", "-", "RA"}], ")"}]}], "+", 
          RowBox[{"XaYAys", 
           RowBox[{"(", "R1", ")"}]}], "+", 
          RowBox[{"XAyYas", " ", 
           RowBox[{"(", "RX", ")"}]}]}], ")"}]}], ")"}]}], "+", 
     "\[IndentingNewLine]", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"XayXas", "/", "2"}], " ", "+", 
       RowBox[{"XAyXas", " ", 
        RowBox[{
         RowBox[{"(", "R", ")"}], "/", "2"}]}], "+", 
       RowBox[{"XAXays", " ", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], "+", "XayXays", "+", 
       RowBox[{"XAyXays", "/", "2"}]}], ")"}]}]}], ";"}], 
  "\[IndentingNewLine]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAprime", " ", "=", 
   RowBox[{"\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"XAYAs", "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYas", 
         RowBox[{"(", "r", ")"}]}], "+", 
        RowBox[{"XaYAs", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYAys", 
         RowBox[{"(", "R0", ")"}]}], "+", 
        RowBox[{"XAyYAs", " ", 
         RowBox[{"(", 
          RowBox[{"1", "-", "R0"}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYays", " ", 
         RowBox[{"(", "R2", ")"}]}], "+", 
        RowBox[{"XayYAs", 
         RowBox[{"(", 
          RowBox[{"1", "-", "RA"}], ")"}]}], "+", 
        RowBox[{"XaYAys", 
         RowBox[{"(", "R1", ")"}]}], "+", 
        RowBox[{"XAyYas", 
         RowBox[{"(", "RX", ")"}]}]}], ")"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{
   RowBox[{"Yaprime", "=", 
    RowBox[{"\[Alpha]", 
     RowBox[{"(", 
      RowBox[{"XaYas", "+", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYas", 
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}]}], "+", 
         RowBox[{"XaYAs", " ", 
          RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XaYays", " ", 
          RowBox[{"(", "R0", ")"}]}], "+", 
         RowBox[{"XayYas", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "R0"}], ")"}]}]}], ")"}], "+", 
       "\[IndentingNewLine]", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"XAYays", 
          RowBox[{"(", "R1", ")"}]}], "+", 
         RowBox[{"XayYAs", 
          RowBox[{"(", "RX", ")"}]}], "+", 
         RowBox[{"XaYAys", 
          RowBox[{"(", "R2", ")"}]}], "+", 
         RowBox[{"XAyYas", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", "RA"}], ")"}]}]}], ")"}]}], ")"}]}]}], ";"}], 
  "\n"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"YAyprime", " ", "=", 
   RowBox[{"\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"XAyYAys", "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAyYays", 
         RowBox[{"(", "r", ")"}]}], "+", 
        RowBox[{"XayYAys", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}]}], ")"}], "+", 
      "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYAys", 
         RowBox[{"(", 
          RowBox[{"1", "-", "R0"}], ")"}]}], "+", 
        RowBox[{"XAyYAs", 
         RowBox[{"(", "R0", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYays", " ", 
         RowBox[{"(", "RX", ")"}]}], "+", 
        RowBox[{"XayYAs", 
         RowBox[{"(", "R1", ")"}]}], "+", 
        RowBox[{"XaYAys", 
         RowBox[{"(", 
          RowBox[{"1", "-", "RA"}], ")"}]}], "+", 
        RowBox[{"XAyYas", " ", 
         RowBox[{"(", "R2", ")"}]}]}], ")"}]}], ")"}]}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"Yayprime", " ", "=", 
   RowBox[{"\[Alpha]", 
    RowBox[{"(", 
     RowBox[{"XayYays", "+", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAyYays", 
         RowBox[{"(", 
          RowBox[{"1", "-", "r"}], ")"}]}], "+", 
        RowBox[{"XayYAys", 
         RowBox[{"(", "r", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XaYays", 
         RowBox[{"(", 
          RowBox[{"1", "-", "R0"}], ")"}]}], "+", 
        RowBox[{"XayYas", 
         RowBox[{"(", "R0", ")"}]}]}], ")"}], "+", "\[IndentingNewLine]", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"XAYays", 
         RowBox[{"(", 
          RowBox[{"1", "-", "RA"}], ")"}]}], "+", 
        RowBox[{"XayYAs", 
         RowBox[{"(", "R2", ")"}]}], "+", 
        RowBox[{"XaYAys", 
         RowBox[{"(", "RX", ")"}]}], "+", 
        RowBox[{"XAyYas", 
         RowBox[{"(", "R1", ")"}]}]}], ")"}]}], ")"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.676681596443686*^9, 3.676681598785956*^9}}],

Cell["Check", "Text",
 CellChangeTimes->{{3.676682156948613*^9, 3.676682157407065*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
   "XAmprime", "+", "Xamprime", "+", "XAymprime", "+", "Xaymprime", "+", 
    "YAprime", "+", "Yaprime", "+", "YAyprime", "+", "Yayprime"}], "/.", 
   "subR"}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.676681750584566*^9, 3.676681759058566*^9}, {
  3.6766818633740473`*^9, 3.676681864296159*^9}, {3.676682101362825*^9, 
  3.676682101927052*^9}}],

Cell[BoxData["1"], "Output",
 CellChangeTimes->{
  3.676681759920952*^9, 3.676681865342371*^9, {3.676682045788446*^9, 
   3.6766821029055862`*^9}, {3.676682136423133*^9, 3.676682145006394*^9}, 
   3.6767327134762087`*^9}]
}, Open  ]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["Resident equilibrium", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9, {3.675889497088314*^9, 3.675889497307007*^9}, {
   3.675897573374775*^9, 3.675897575830624*^9}, {3.675897716718397*^9, 
   3.6758977222283363`*^9}, 3.676682250170936*^9}],

Cell["We will assume that the neoY is absent ", "Text",
 CellChangeTimes->{{3.675897612080282*^9, 3.675897623453624*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subequil", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"XAf", "\[Rule]", "pXf"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xaf", "\[Rule]", 
      RowBox[{"(", 
       RowBox[{"1", "-", "pXf"}], ")"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAm", "\[Rule]", 
      RowBox[{"pXm", 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xam", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pXm"}], ")"}], 
       RowBox[{"(", 
        RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"YA", "\[Rule]", 
      RowBox[{"pY", "*", "\[Alpha]"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"Ya", "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pY"}], ")"}], "*", "\[Alpha]"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"XAyf", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xayf", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"XAym", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Xaym", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"YAy", "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{"Yay", "\[Rule]", "0"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.675897631284259*^9, 3.675897659212982*^9}}],

Cell["\<\
We now solve for the equilibrium frequency of A in each of the haploid \
genotypes. Equilibrium is achieved when the following three equations are zero\
\>", "Text",
 CellChangeTimes->{{3.675694155902801*^9, 3.675694193760104*^9}, {
   3.6756944337868023`*^9, 3.6756944351881227`*^9}, {3.6757029847267847`*^9, 
   3.67570303405547*^9}, {3.675710696458521*^9, 3.675710706286772*^9}, 
   3.6758975924118633`*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqs", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{"XAfprime", "-", "XAf"}], ",", "\[IndentingNewLine]", 
      RowBox[{"XAmprime", "-", "XAm"}], ",", "\[IndentingNewLine]", 
      RowBox[{"YAprime", "-", "YA"}]}], "\[IndentingNewLine]", "}"}], "/.", 
    "subequil"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675647987041369*^9, 3.67564802904979*^9}, {
   3.675650509895372*^9, 3.675650527299842*^9}, {3.6756941716513157`*^9, 
   3.6756941738671913`*^9}, {3.675694338488646*^9, 3.675694340978696*^9}, {
   3.675694394143187*^9, 3.6756944261522427`*^9}, 3.6756944751724463`*^9, 
   3.675702984727247*^9, {3.675703036868017*^9, 3.675703037688758*^9}, 
   3.67578824463701*^9, 3.675897781726954*^9}],

Cell["\<\
To simplify the analysis we assume weak selection in both haploids \
(sperm/pollen) and diploids\
\>", "Text",
 CellChangeTimes->{{3.675694205010009*^9, 3.675694211923259*^9}, 
   3.67570298472752*^9, {3.6757030454432507`*^9, 3.6757030568360033`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weaksel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"MAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAm", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"MAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAm", " ", "sAm", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Maa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"sAf", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"FAa", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"hAf", " ", "sAf", " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{"Faa", "\[Rule]", "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{"wA", "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{"t", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"wa", "\[Rule]", "1"}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.67564806523287*^9, 3.675648221558539*^9}, {
   3.675694367971285*^9, 3.6756943845803022`*^9}, 3.6757029847280283`*^9}],

Cell["We can write the frequencies as Taylor series", "Text",
 CellChangeTimes->{{3.675707045047565*^9, 3.6757070543930063`*^9}, {
  3.675707367038864*^9, 3.675707370179316*^9}, {3.675711803871513*^9, 
  3.6757118112225847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frequenciessub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pXf", "\[Rule]", 
      RowBox[{"pXf0", "+", 
       RowBox[{"pXf1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pXm", "\[Rule]", 
      RowBox[{"pXm0", "+", 
       RowBox[{"pXm1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pY", "\[Rule]", 
      RowBox[{"pY0", "+", 
       RowBox[{"pY1", " ", "\[Epsilon]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675648297857716*^9, 3.6756483630660057`*^9}, 
   3.675648454638584*^9, 3.675702984736863*^9, {3.67589080409908*^9, 
   3.675890831274033*^9}}],

Cell["\<\
Without selection the recursions for the change in frequency of A in each \
gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.6757032054455214`*^9, 3.6757032697493563`*^9}, {
  3.6757098202812138`*^9, 3.675709824765788*^9}, {3.6757117765596933`*^9, 
  3.6757117850524673`*^9}, {3.675711818872109*^9, 3.6757118199810133`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs0", "=", 
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", "frequenciessub"}], 
     ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.675703197099375*^9, 3.675703198353765*^9}, {
   3.675703326603519*^9, 3.675703332003808*^9}, {3.67570336997014*^9, 
   3.675703373531238*^9}, {3.675707060003501*^9, 3.675707071963544*^9}, {
   3.675707629815399*^9, 3.675707668691402*^9}, {3.6757098279293118`*^9, 
   3.6757098635569563`*^9}, {3.675785533464711*^9, 3.675785543888385*^9}, {
   3.675788240589053*^9, 3.675788247183043*^9}, {3.67588972373911*^9, 
   3.675889783320355*^9}, {3.675890096427137*^9, 3.675890101281641*^9}, {
   3.6758901865547256`*^9, 3.6758902265295887`*^9}, {3.675890260937232*^9, 
   3.675890325465114*^9}, {3.6758908417717113`*^9, 3.675890848577783*^9}, 
   3.675897777999179*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf0"}], "+", "pXm0"}], ")"}]}], ",", 
   RowBox[{
    RowBox[{"-", "pXm0"}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"pXf0", "-", 
       RowBox[{"pXf0", " ", "r"}], "+", 
       RowBox[{"pY0", " ", "r"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}]}], "+", 
    RowBox[{"pXm0", " ", "\[Alpha]"}]}], ",", 
   RowBox[{
    RowBox[{"pXf0", " ", "r", " ", "\[Alpha]"}], "-", 
    RowBox[{"pY0", " ", "r", " ", "\[Alpha]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.675890101919662*^9, 3.675890196227337*^9, 3.675890226890559*^9, 
   3.67589032606896*^9, {3.675890843995223*^9, 3.675890848999341*^9}, 
   3.675897682731414*^9, 3.675897786473518*^9, 3.676652896277562*^9, 
   3.676732736738125*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675709831409095*^9, 3.6757098343025913`*^9}, {
  3.675710744701475*^9, 3.675710745621426*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"differenceEqs0", "\[Equal]", "0"}], ",", 
    RowBox[{"{", 
     RowBox[{"pXf0", ",", "pXm0"}], "}"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.675709931730151*^9, 3.675709948227565*^9}, 
   3.675889715650866*^9, {3.6758903329476337`*^9, 3.675890333531021*^9}, {
   3.675890856683935*^9, 3.6758908599323187`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"pXf0", "\[Rule]", "pY0"}], ",", 
    RowBox[{"pXm0", "\[Rule]", "pY0"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{
  3.6757098363525476`*^9, {3.6757099323567266`*^9, 3.675709948639193*^9}, 
   3.675727587389184*^9, 3.675785430130021*^9, 3.67578825590738*^9, 
   3.675889716378837*^9, 3.6758897866812677`*^9, {3.67589020611733*^9, 
   3.675890228462432*^9}, 3.675890334827342*^9, {3.675890851304111*^9, 
   3.675890860292238*^9}, 3.675897787493493*^9, 3.676652896317733*^9, 
   3.676732736760745*^9}]
}, Open  ]],

Cell["\<\
So, with no selection, the equilibrium frequency of A in each gamete/pollen \
type is equal (and we call this pA).\
\>", "Text",
 CellChangeTimes->{{3.675703427939505*^9, 3.6757035626138153`*^9}, {
   3.675706719194449*^9, 3.675706765062245*^9}, 3.67570996472328*^9, {
   3.6757107664993973`*^9, 3.675710849444377*^9}}],

Cell["\<\
Now, looking at only the first order selection terms, the recursions for the \
change in frequency of A in each gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.67570356712366*^9, 3.675703572187316*^9}, {
  3.67570609431063*^9, 3.675706097287983*^9}, {3.6757069069525433`*^9, 
  3.6757069072532797`*^9}, {3.67571091918222*^9, 3.6757109367564697`*^9}, {
  3.675711772412171*^9, 3.67571177325072*^9}, {3.675716463608975*^9, 
  3.67571647265489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
      ",", "\[Epsilon]", ",", "Factor"}], "]"}], "/.", 
    RowBox[{"pY0", "\[Rule]", "pA"}]}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757068495866413`*^9, 3.6757068907711554`*^9}, {
   3.6757069302403297`*^9, 3.675706982461239*^9}, {3.675707087605297*^9, 
   3.6757071228419533`*^9}, {3.67570718969317*^9, 3.675707319107386*^9}, {
   3.675707511314725*^9, 3.675707512612761*^9}, {3.675710885258552*^9, 
   3.675710885357044*^9}, {3.675711221036006*^9, 3.675711227798399*^9}, {
   3.675788237526182*^9, 3.6757882495037823`*^9}, {3.67588983758741*^9, 
   3.675889846791771*^9}, {3.675890066524867*^9, 3.67589008440499*^9}, {
   3.675890872602395*^9, 3.6758908784129057`*^9}, 3.675891388889962*^9, 
   3.675897774490415*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf1"}], "+", "pXm1", "+", 
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}]}], ")"}], " ", "\[Epsilon]"}], 
   ",", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf1"}], "+", "pXm1", "+", 
      RowBox[{"pXf1", " ", "r"}], "-", 
      RowBox[{"pY1", " ", "r"}], "-", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
      RowBox[{"pA", " ", "r", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", "\[Epsilon]"}], ",", 
   
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pXf1", " ", "r"}], "-", 
      RowBox[{"pY1", " ", "r"}], "+", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}], "-", 
      RowBox[{"pA", " ", "r", " ", "t"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], ")"}], " ", 
    "\[Alpha]", " ", "\[Epsilon]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675706852317442*^9, 3.675706918829287*^9}, {
   3.675706950931774*^9, 3.675706982932413*^9}, {3.6757070910767508`*^9, 
   3.675707123327277*^9}, {3.6757071925330353`*^9, 3.675707319486848*^9}, 
   3.675707513296742*^9, 3.67570768217498*^9, {3.675710857628578*^9, 
   3.675710885875184*^9}, {3.675711222477412*^9, 3.67571122814371*^9}, 
   3.67572758892033*^9, 3.675785431200643*^9, 3.6757882566822844`*^9, {
   3.6758898385316772`*^9, 3.675889853071372*^9}, 3.67589008578434*^9, 
   3.675890878782188*^9, 3.6758913896085997`*^9, 3.675897788776071*^9, 
   3.676652896382719*^9, 3.676732736800375*^9}]
}, Open  ]],

Cell["\<\
Instead of solving for the first order genotype frequencies we will instead \
solve for the difference in the frequency of A in the different gamete/pollen \
types.\
\>", "Text",
 CellChangeTimes->{{3.6757135825548286`*^9, 3.675713633862471*^9}, 
   3.6757138892769423`*^9, {3.675716482887339*^9, 3.6757164842940083`*^9}}],

Cell["\<\
The difference in the frequency of A with X in females and X in males is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.6757138909855633`*^9, 3.675713959445539*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfXm", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "[", 
        RowBox[{"[", "1", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"pXf1", "\[Rule]", 
       RowBox[{"dpAXfXm", "+", "pXm1"}]}]}], ",", "dpAXfXm"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.67571264493021*^9, 3.675712689537509*^9}, {
   3.675712721625124*^9, 3.675712730987232*^9}, {3.6757136496293707`*^9, 
   3.6757136649001226`*^9}, {3.675716490314892*^9, 3.675716491532194*^9}, 
   3.675889959407155*^9, {3.6758909343383083`*^9, 3.675890951849391*^9}, {
   3.675891012447013*^9, 3.675891012934494*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfXm", "\[Rule]", 
   RowBox[{
    RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
    RowBox[{"2", " ", 
     SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
    RowBox[{"6", " ", "hAf", " ", 
     SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
    RowBox[{"2", " ", 
     SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
    RowBox[{"4", " ", "hAf", " ", 
     SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
    RowBox[{"pA", " ", "t"}], "-", 
    RowBox[{
     SuperscriptBox["pA", "2"], " ", "t"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675712649738289*^9, 3.675712661484269*^9}, 
   3.675712732353135*^9, 3.6757136656167507`*^9, 3.675716491898244*^9, 
   3.6757275909002647`*^9, 3.675785432660453*^9, 3.675788258653908*^9, {
   3.675889953796268*^9, 3.6758899597968283`*^9}, 3.675890959353971*^9, 
   3.6758910146488943`*^9, 3.6758913912775593`*^9, 3.676652896517932*^9, 
   3.676732736829219*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in males and Y is (at equilibrium \
to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713966791181*^9, 3.6757139830606413`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXmY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"differenceEqs1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
        RowBox[{"pXf1", "\[Rule]", 
         RowBox[{"dpAXfXm", "+", "pXm1"}]}]}], "/.", "eqdpAXfXm"}], "/.", 
      RowBox[{"pXm1", "\[Rule]", 
       RowBox[{"dpAXmY", "+", "pY1"}]}]}], ",", "dpAXmY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.67589099313556*^9, 3.675891022927155*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXmY", "\[Rule]", 
   RowBox[{
    FractionBox["1", "r"], 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "+", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "sAf"}], "-", 
      RowBox[{"2", " ", "hAf", " ", "pA", " ", "r", " ", "sAf"}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"6", " ", "hAf", " ", 
       SuperscriptBox["pA", "2"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "-", 
      RowBox[{"4", " ", "hAf", " ", 
       SuperscriptBox["pA", "3"], " ", "r", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "pA", " ", "sAm"}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{"3", " ", "hAm", " ", 
       SuperscriptBox["pA", "2"], " ", "sAm"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"2", " ", "hAm", " ", 
       SuperscriptBox["pA", "3"], " ", "sAm"}], "+", 
      RowBox[{"pA", " ", "t"}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "t"}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6758910240913486`*^9, 3.6758913925003138`*^9, 
  3.676652896673917*^9, 3.6767327368603153`*^9}]
}, Open  ]],

Cell["\<\
The difference in the frequency of A with X in females and Y is (at \
equilibrium to first order in selection)\
\>", "Text",
 CellChangeTimes->{{3.675713993050933*^9, 3.6757140012817707`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqdpAXfY", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "[", 
        RowBox[{"[", "3", "]"}], "]"}], "\[Equal]", "0"}], "/.", 
      RowBox[{"pXf1", "\[Rule]", 
       RowBox[{"dpAXfY", "+", "pY1"}]}]}], ",", "dpAXfY"}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675891330267333*^9, 3.6758913402113733`*^9}, {
  3.675891370233397*^9, 3.675891383976934*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"dpAXfY", "\[Rule]", 
   FractionBox[
    RowBox[{
     RowBox[{
      RowBox[{"-", "hAm"}], " ", "pA", " ", "sAm"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{"3", " ", "hAm", " ", 
      SuperscriptBox["pA", "2"], " ", "sAm"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"2", " ", "hAm", " ", 
      SuperscriptBox["pA", "3"], " ", "sAm"}], "-", 
     RowBox[{"pA", " ", "t"}], "+", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "t"}], "+", 
     RowBox[{"pA", " ", "r", " ", "t"}], "-", 
     RowBox[{
      SuperscriptBox["pA", "2"], " ", "r", " ", "t"}]}], "r"]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6758913358696117`*^9, 3.6758913405764227`*^9}, {
   3.675891373164547*^9, 3.675891393552059*^9}, 3.676652896714778*^9, 
   3.6767327368935966`*^9}]
}, Open  ]],

Cell["\<\
So then, to first order, the equilibrium haploid genotype frequencies are(?)\
\>", "Text",
 CellChangeTimes->{{3.6757175107821083`*^9, 3.675717533841239*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpXf", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pXf0", "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXmY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXmY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675716895475359*^9, 3.675716900512623*^9}, {
  3.675717278127964*^9, 3.675717294591033*^9}, {3.675717351754582*^9, 
  3.675717366375647*^9}, {3.675717543006982*^9, 3.675717544667244*^9}, {
  3.6757178596731443`*^9, 3.675717863093356*^9}, {3.675891412682151*^9, 
  3.6758914137821283`*^9}, {3.675891837469037*^9, 3.6758918377885427`*^9}, {
  3.6758919471830606`*^9, 3.67589194867479*^9}, {3.675892368331646*^9, 
  3.675892370571282*^9}, {3.6759005334571*^9, 3.675900555296269*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
         RowBox[{"hAm", " ", "sAm"}], "-", 
         RowBox[{"pA", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "sAf"}], "+", "sAm", "-", 
            RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"t", " ", 
          RowBox[{"(", 
           RowBox[{"\[Epsilon]", "-", 
            RowBox[{"pA", " ", "\[Epsilon]"}]}], ")"}]}]}], ")"}]}]}], 
     ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.6757169011353207`*^9, 3.6757173669613256`*^9, 3.6757175450525827`*^9, 
   3.675717864205447*^9, 3.675727594742791*^9, 3.675785436211323*^9, 
   3.675788261479598*^9, 3.675891416424108*^9, 3.6758918774492893`*^9, 
   3.675891958442032*^9, 3.675892370898428*^9, 3.6758935648073273`*^9, {
   3.6759005418256493`*^9, 3.675900555878397*^9}, 3.6766528968029757`*^9, 
   3.67673273696065*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpXm", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pXm0", "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfXm"}], "/.", 
    "eqdpAXfY"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675891861515366*^9, 3.675891862891082*^9}, 
   3.675891954716195*^9, {3.675900536393208*^9, 3.6759005575923357`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pA"}], ")"}]}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.675891430280157*^9, 3.675891875421072*^9, 3.6758919608167343`*^9, 
   3.675892371780211*^9, 3.675893565662033*^9, {3.675900542474494*^9, 
   3.6759005587820673`*^9}, 3.67665289685354*^9, 3.676732737027499*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"eqpY", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"pY0", "+", 
        RowBox[{"\[Epsilon]", " ", "dpAXfXm"}], "-", 
        RowBox[{"\[Epsilon]", " ", "dpAXfY"}]}], "/.", "sol0"}], "/.", 
      RowBox[{"pY0", "\[Rule]", "pA"}]}], "/.", "eqdpAXfY"}], "/.", 
    "eqdpAXfXm"}], "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.675717392424321*^9, 3.675717393210609*^9}, {
   3.675717465498665*^9, 3.675717499551214*^9}, {3.67571755307234*^9, 
   3.675717554018692*^9}, {3.6757178713638563`*^9, 3.675717873545209*^9}, {
   3.6758918717163763`*^9, 3.6758918726910467`*^9}, 3.675891956101635*^9, {
   3.675893391454796*^9, 3.675893392916779*^9}, {3.675900539553142*^9, 
   3.675900562666452*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
         RowBox[{"hAm", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], 
        ")"}], " ", "\[Epsilon]"}], "+", 
      RowBox[{"r", " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", 
         RowBox[{"2", " ", "pA", " ", "sAf", " ", "\[Epsilon]"}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["pA", "2"], " ", "sAf", " ", "\[Epsilon]"}], "+", 
         RowBox[{"2", " ", "hAf", " ", 
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"3", " ", "pA"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["pA", "2"]}]}], ")"}], " ", "sAf", " ", 
          "\[Epsilon]"}]}], ")"}]}]}], ")"}]}], "r"], "}"}]], "Output",
 CellChangeTimes->{
  3.67571750048251*^9, 3.675717554350906*^9, 3.675717874008835*^9, 
   3.675727596078721*^9, 3.6757854378569937`*^9, 3.675788264699403*^9, 
   3.675891496222584*^9, 3.675891873049327*^9, 3.6758919565695257`*^9, 
   3.6758923723983088`*^9, 3.675893566346439*^9, {3.675900543007511*^9, 
   3.675900562976172*^9}, 3.6766528969178534`*^9, 3.676732737101431*^9}]
}, Open  ]],

Cell["The recursion for pA is given by", "Text",
 CellChangeTimes->{{3.675894756303364*^9, 3.675894761327495*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"dpA", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"Normal", "[", 
        RowBox[{"Series", "[", " ", 
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{
             RowBox[{
              RowBox[{
               RowBox[{
                RowBox[{"2", "XAfprime"}], "+", 
                RowBox[{"XAmprime", "/", 
                 RowBox[{"(", 
                  RowBox[{"1", "-", "\[Alpha]"}], ")"}]}], "+", 
                RowBox[{"YAprime", "/", "\[Alpha]"}], "-", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", "XAf"}], "-", 
                  RowBox[{"XAm", "/", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", "\[Alpha]"}], ")"}]}], "-", 
                  RowBox[{"YA", "/", "\[Alpha]"}]}], ")"}]}], "/.", 
               "weaksel"}], "/.", "subequil"}], "/.", 
             RowBox[{"pXf", "\[Rule]", "eqpXf"}]}], "/.", 
            RowBox[{"pXm", "\[Rule]", "eqpXm"}]}], "/.", 
           RowBox[{"pY", "\[Rule]", "eqpY"}]}], ",", 
          RowBox[{"{", 
           RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
       "/", "4"}], ",", "\[Epsilon]", ",", "Simplify"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675894617378331*^9, 3.675894690920476*^9}, {
  3.6758947376813*^9, 3.675894737903183*^9}, {3.675900548267981*^9, 
  3.6759005719630737`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"pA", "+", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"hAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "-", 
      RowBox[{"hAm", " ", "sAm"}], "-", 
      RowBox[{"pA", " ", 
       RowBox[{"(", 
        RowBox[{"sAf", "+", "sAm", "-", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], 
     ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675894643419367*^9, 3.675894691650373*^9}, 
   3.675894738536499*^9, 3.67590057252487*^9, 3.676652897084424*^9, 
   3.6767327372305403`*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675894741095875*^9, 3.6758947449904137`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"dpA", "-", "pA"}], "\[Equal]", "0"}], ",", "pA"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.6758947492346077`*^9, 3.675894750434639*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"pA", "\[Rule]", 
     FractionBox[
      RowBox[{
       RowBox[{"hAf", " ", "sAf"}], "+", 
       RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
      RowBox[{
       RowBox[{"-", "sAf"}], "+", 
       RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
       RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6758947512753477`*^9, 3.676652897209752*^9, 
  3.676732737261003*^9}]
}, Open  ]],

Cell["\<\
Notice that when t=0 we have equation \[OpenCurlyDoubleQuote]avgpASubs\
\[CloseCurlyDoubleQuote] in van Doorn & Kirkpatrick 2007 (SOM page 6). \
Sperm/pollen selection acts to increase the frequency of A (if selected for, \
t>0).\
\>", "Text",
 CellChangeTimes->{{3.675718177833785*^9, 3.6757182794849873`*^9}}]
}, Open  ]],

Cell["Internal stability", "Section",
 CellChangeTimes->{{3.675728118153309*^9, 3.6757281301025343`*^9}, {
  3.675898152172256*^9, 3.675898162531384*^9}, {3.676682354127939*^9, 
  3.676682359443681*^9}}],

Cell[CellGroupData[{

Cell["\<\
External stability - weak linkage\
\>", "Section",
 CellChangeTimes->{{3.675898184242074*^9, 3.675898192657653*^9}, {
  3.6766823621496687`*^9, 3.676682365402493*^9}, {3.676682824936212*^9, 
  3.676682839700041*^9}}],

Cell[CellGroupData[{

Cell[BoxData["subequil"], "Input",
 CellChangeTimes->{{3.675898272755611*^9, 3.675898273603898*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"XAf", "\[Rule]", "pXf"}], ",", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "pXf"}]}], ",", 
   RowBox[{"XAm", "\[Rule]", 
    RowBox[{"pXm", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", 
   RowBox[{"Xam", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXm"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", 
   RowBox[{"YA", "\[Rule]", 
    RowBox[{"pY", " ", "\[Alpha]"}]}], ",", 
   RowBox[{"Ya", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pY"}], ")"}], " ", "\[Alpha]"}]}], ",", 
   RowBox[{"XAyf", "\[Rule]", "0"}], ",", 
   RowBox[{"Xayf", "\[Rule]", "0"}], ",", 
   RowBox[{"XAym", "\[Rule]", "0"}], ",", 
   RowBox[{"Xaym", "\[Rule]", "0"}], ",", 
   RowBox[{"YAy", "\[Rule]", "0"}], ",", 
   RowBox[{"Yay", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.675898274076612*^9, 3.675899009180147*^9, 
  3.676732750884433*^9}]
}, Open  ]],

Cell["\<\
Notice that we don\[CloseCurlyQuote]t have recursions for XAyf or Xayf \
because y is a dominant male determining gene. However, we allowed these \
genotypes to create zygotes so we can include them in the stability matrix.\
\>", "Text",
 CellChangeTimes->{{3.6758991929846497`*^9, 3.67589926406907*^9}, {
  3.67589934114139*^9, 3.6758993427645893`*^9}, {3.675900036907325*^9, 
  3.6759000483741083`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matExtFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "XAyf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Xayf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "XAym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Xaym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "YAym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Yaym"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], "/.", "subequil"}], "//", 
    "Factor"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.675899271627995*^9, 3.675899299216916*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAa", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXm", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "R", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXm", " ", "R", " ", "wa"}], "+", 
          RowBox[{"MAA", " ", "pXm", " ", "wA"}], "+", 
          RowBox[{"2", " ", "MAa", " ", "wa", " ", "\[Alpha]"}], "-", 
          RowBox[{"2", " ", "MAa", " ", "pY", " ", "wa", " ", "\[Alpha]"}], 
          "-", 
          RowBox[{"2", " ", "MAa", " ", "RA", " ", "wa", " ", "\[Alpha]"}], 
          "+", 
          RowBox[{
          "2", " ", "MAa", " ", "pY", " ", "RA", " ", "wa", " ", "\[Alpha]"}],
           "+", 
          RowBox[{"2", " ", "MAA", " ", "pY", " ", "wA", " ", "\[Alpha]"}], 
          "-", 
          RowBox[{
          "2", " ", "MAA", " ", "pY", " ", "R0", " ", "wA", " ", 
           "\[Alpha]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      FractionBox[
       RowBox[{"MAa", " ", "wA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pXm", " ", "R"}], "+", 
          RowBox[{"2", " ", "pY", " ", "RX", " ", "\[Alpha]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"MAa", "-", 
          RowBox[{"MAa", " ", "pXf"}], "+", 
          RowBox[{"MAA", " ", "pXf"}], "-", 
          RowBox[{"MAa", " ", "R"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "R"}]}], ")"}], " ", "wA"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"MAa", " ", "pXf", " ", "R", " ", "wa"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
           RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
         "\[Alpha]"}]]}], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"MAa", " ", "wa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "R"}], "+", 
           RowBox[{"pXm", " ", "R"}], "-", 
           RowBox[{"2", " ", "RX", " ", "\[Alpha]"}], "+", 
           RowBox[{"2", " ", "pY", " ", "RX", " ", "\[Alpha]"}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
           RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
         "\[Alpha]"}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXm", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXm", " ", "wA"}], "+", 
          RowBox[{"MAa", " ", "pXm", " ", "R", " ", "wA"}], "-", 
          RowBox[{"2", " ", "Maa", " ", "wa", " ", "\[Alpha]"}], "+", 
          RowBox[{"2", " ", "Maa", " ", "pY", " ", "wa", " ", "\[Alpha]"}], 
          "+", 
          RowBox[{"2", " ", "Maa", " ", "R0", " ", "wa", " ", "\[Alpha]"}], 
          "-", 
          RowBox[{
          "2", " ", "Maa", " ", "pY", " ", "R0", " ", "wa", " ", "\[Alpha]"}],
           "-", 
          RowBox[{"2", " ", "MAa", " ", "pY", " ", "wA", " ", "\[Alpha]"}], 
          "+", 
          RowBox[{
          "2", " ", "MAa", " ", "pY", " ", "RA", " ", "wA", " ", 
           "\[Alpha]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      FractionBox[
       RowBox[{"MAa", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", "R", " ", "wA"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Maa"}], "+", 
           RowBox[{"Maa", " ", "pXf"}], "-", 
           RowBox[{"MAa", " ", "pXf"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "R"}]}], ")"}], " ", "wa"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "pXf", " ", "wa"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "pY", " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
           RowBox[{"MAa", " ", "pY", " ", "wA"}], "-", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "+", 
           RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
         "\[Alpha]"}]]}], "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "MAa"}], " ", "R2", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pY", " ", "R2", " ", "wa"}], "-", 
          RowBox[{"MAA", " ", "pY", " ", "R0", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
        RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
        RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
        RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
        RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
        RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
        RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
        RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
        RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"MAa", " ", "pY", " ", "R1", " ", "wA", " ", "\[Alpha]"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
         RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
         RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
         RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
         RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
         RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
         RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
         RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
         RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}]]}], "0", "0", 
      "0", "0"},
     {
      FractionBox[
       RowBox[{"MAa", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pY"}], ")"}], " ", "R1", " ", "wa", " ", 
        "\[Alpha]"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
        RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
        RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
        RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
        RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
        RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
        RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
        RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
        RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "R0", " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pY", " ", "R0", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pY", " ", "R2", " ", "wA"}]}], ")"}], " ", 
         "\[Alpha]"}], 
        RowBox[{
         RowBox[{"Maa", " ", "wa"}], "-", 
         RowBox[{"Maa", " ", "pXf", " ", "wa"}], "+", 
         RowBox[{"MAa", " ", "pXf", " ", "wa"}], "-", 
         RowBox[{"Maa", " ", "pY", " ", "wa"}], "+", 
         RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
         RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
         RowBox[{"MAa", " ", "pY", " ", "wA"}], "-", 
         RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "+", 
         RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}]]}], "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.675899300027032*^9, 3.676652899615107*^9, 
  3.67665450095354*^9, 3.676654616864539*^9, 3.676732751358371*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyExt", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matExtFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "6", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6758993091981916`*^9, 3.6758993092948217`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyExt", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}]}], "Input",
 CellChangeTimes->{3.676654631019518*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     FractionBox["1", 
      RowBox[{"2", " ", "\[Alpha]"}]]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     FractionBox[
      RowBox[{"1", "-", "R"}], 
      RowBox[{"2", " ", "\[Alpha]"}]]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.675899316283032*^9, 3.675899557775223*^9, 
  3.676652904283071*^9, 3.676654502189295*^9, 3.676654631667169*^9, 
  3.6767327516966753`*^9}]
}, Open  ]],

Cell["\<\
It seems that Yy-bearing males have no effect on the invasion (would have \
been males anyway). The inclusion of Xiyf is also irrelevant as mutations \
arising in females are males in the next generation. \
\>", "Text",
 CellChangeTimes->{{3.6759000512139807`*^9, 3.6759001148215*^9}}],

Cell["\<\
The first order effect is on sex ratio. If the initial population has a sex \
ratio bias (e.g., produces an excess of X-bearing pollen/sperm, \
\[Alpha]<1/2), then a male determiner will invade. I think an initial sex \
ratio bias selecting for neo sex determiners was discussed by Jim Bull ???

Here, we will assume that any deviations from \[Alpha]=1/2 are on the order \
of \[Epsilon]\
\>", "Text",
 CellChangeTimes->{{3.675900116372485*^9, 3.675900177340706*^9}, {
  3.6759014924820547`*^9, 3.675901555528656*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
       RowBox[{"\[Alpha]", "\[Rule]", 
        RowBox[{
         RowBox[{"1", "/", "2"}], "+", 
         RowBox[{"\[Delta]\[Alpha]", "*", "\[Epsilon]"}]}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}]}], "Input",
 CellChangeTimes->{{3.675900185889442*^9, 3.6759001924647408`*^9}, 
   3.676654723178556*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{"1", "-", "R"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.6759001928050547`*^9, 3.676652906122548*^9, 
  3.676654504790288*^9, 3.676654723729147*^9, 3.676732751819036*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", 
            RowBox[{"\[Delta]\[Alpha]", "*", "\[Epsilon]"}]}]}]}], "/.", 
         RowBox[{"\[Lambda]", "\[Rule]", 
          RowBox[{"1", "+", 
           RowBox[{"\[Delta]\[Lambda]", "*", "\[Epsilon]"}]}]}]}], "/.", 
        "frequenciessub"}], "/.", "sol0"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.675900203768065*^9, 3.67590021603231*^9}, {
   3.675900300123855*^9, 3.675900338446018*^9}, 3.675900430018834*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "2"}], " ", "\[Delta]\[Alpha]"}]}], "}"}], "}"}]], "Output",\

 CellChangeTimes->{
  3.6759002164032507`*^9, {3.67590030988757*^9, 3.6759003389772167`*^9}, 
   3.67590043032834*^9, 3.676652908009078*^9, 3.676654509365768*^9, 
   3.676654726722083*^9, 3.6767327518512287`*^9}]
}, Open  ]],

Cell["\<\
Going to the next order in \[Epsilon] (and assuming that \[Delta]\[Alpha] is \
of order \[Epsilon]^2)\
\>", "Text",
 CellChangeTimes->{{3.6759003604720993`*^9, 3.675900376671677*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", 
            RowBox[{"\[Delta]\[Alpha]", "*", 
             RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
         RowBox[{"\[Lambda]", "\[Rule]", 
          RowBox[{"1", "+", 
           RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], "/.", 
        "frequenciessub"}], "/.", "sol0"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.675900392103478*^9, 3.6759004267641687`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", "0"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.675900397670813*^9, 3.6759004270810823`*^9}, 
   3.6766529096964083`*^9, 3.676654511199524*^9, 3.676654730259613*^9, 
   3.676732751894907*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           RowBox[{
            RowBox[{"1", "/", "2"}], "+", 
            RowBox[{"\[Delta]\[Alpha]", "*", 
             RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
         RowBox[{"\[Lambda]", "\[Rule]", 
          RowBox[{"1", "+", 
           RowBox[{"\[Delta]\[Lambda]2", "*", 
            RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
        "frequenciessub"}], "/.", "sol0"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]2"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.675900404967301*^9, 3.6759004329872217`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]2", "\[Rule]", 
    RowBox[{
     FractionBox["1", "R"], 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"hAm", " ", "pXf1", " ", "R", " ", "sAm"}], "+", 
       RowBox[{"pXf1", " ", "pY0", " ", "R", " ", "sAm"}], "-", 
       RowBox[{
       "2", " ", "hAm", " ", "pXf1", " ", "pY0", " ", "R", " ", "sAm"}], "-", 
       
       RowBox[{"hAm", " ", "pY1", " ", "R", " ", "sAm"}], "-", 
       RowBox[{"pY0", " ", "pY1", " ", "R", " ", "sAm"}], "+", 
       RowBox[{
       "2", " ", "hAm", " ", "pY0", " ", "pY1", " ", "R", " ", "sAm"}], "+", 
       RowBox[{
        SuperscriptBox["hAm", "2"], " ", "pY0", " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{"2", " ", "hAm", " ", 
        SuperscriptBox["pY0", "2"], " ", 
        SuperscriptBox["sAm", "2"]}], "-", 
       RowBox[{"5", " ", 
        SuperscriptBox["hAm", "2"], " ", 
        SuperscriptBox["pY0", "2"], " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["pY0", "3"], " ", 
        SuperscriptBox["sAm", "2"]}], "-", 
       RowBox[{"6", " ", "hAm", " ", 
        SuperscriptBox["pY0", "3"], " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{"8", " ", 
        SuperscriptBox["hAm", "2"], " ", 
        SuperscriptBox["pY0", "3"], " ", 
        SuperscriptBox["sAm", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["pY0", "4"], " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{"4", " ", "hAm", " ", 
        SuperscriptBox["pY0", "4"], " ", 
        SuperscriptBox["sAm", "2"]}], "-", 
       RowBox[{"4", " ", 
        SuperscriptBox["hAm", "2"], " ", 
        SuperscriptBox["pY0", "4"], " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{"pXf1", " ", "R", " ", "t"}], "-", 
       RowBox[{"pY1", " ", "R", " ", "t"}], "+", 
       RowBox[{"2", " ", "hAm", " ", "pY0", " ", "sAm", " ", "t"}], "+", 
       RowBox[{"2", " ", 
        SuperscriptBox["pY0", "2"], " ", "sAm", " ", "t"}], "-", 
       RowBox[{"6", " ", "hAm", " ", 
        SuperscriptBox["pY0", "2"], " ", "sAm", " ", "t"}], "-", 
       RowBox[{"2", " ", 
        SuperscriptBox["pY0", "3"], " ", "sAm", " ", "t"}], "+", 
       RowBox[{"4", " ", "hAm", " ", 
        SuperscriptBox["pY0", "3"], " ", "sAm", " ", "t"}], "-", 
       RowBox[{"hAm", " ", "pY0", " ", "R", " ", "sAm", " ", "t"}], "-", 
       RowBox[{
        SuperscriptBox["pY0", "2"], " ", "R", " ", "sAm", " ", "t"}], "+", 
       RowBox[{"3", " ", "hAm", " ", 
        SuperscriptBox["pY0", "2"], " ", "R", " ", "sAm", " ", "t"}], "+", 
       RowBox[{
        SuperscriptBox["pY0", "3"], " ", "R", " ", "sAm", " ", "t"}], "-", 
       RowBox[{"2", " ", "hAm", " ", 
        SuperscriptBox["pY0", "3"], " ", "R", " ", "sAm", " ", "t"}], "+", 
       RowBox[{"pY0", " ", 
        SuperscriptBox["t", "2"]}], "-", 
       RowBox[{
        SuperscriptBox["pY0", "2"], " ", 
        SuperscriptBox["t", "2"]}], "-", 
       RowBox[{"pY0", " ", "R", " ", 
        SuperscriptBox["t", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["pY0", "2"], " ", "R", " ", 
        SuperscriptBox["t", "2"]}], "-", 
       RowBox[{"2", " ", "R", " ", "\[Delta]\[Alpha]"}]}], ")"}]}]}], "}"}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.6759004188756123`*^9, 3.6759004427625017`*^9}, 
   3.6766529106446733`*^9, 3.6766545120184917`*^9, 3.676654731520351*^9, 
   3.676732751950139*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData["frequenciessub"], "Input",
 CellChangeTimes->{{3.675900511903131*^9, 3.675900513854611*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"pXf", "\[Rule]", 
    RowBox[{"pXf0", "+", 
     RowBox[{"pXf1", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"pXm", "\[Rule]", 
    RowBox[{"pXm0", "+", 
     RowBox[{"pXm1", " ", "\[Epsilon]"}]}]}], ",", 
   RowBox[{"pY", "\[Rule]", 
    RowBox[{"pY0", "+", 
     RowBox[{"pY1", " ", "\[Epsilon]"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.675900514264566*^9, 3.676652912399356*^9, 
  3.676654733906745*^9, 3.6767327520508823`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
           RowBox[{"\[Alpha]", "\[Rule]", 
            RowBox[{
             RowBox[{"1", "/", "2"}], "+", 
             RowBox[{"\[Delta]\[Alpha]", "*", 
              RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
          RowBox[{"\[Lambda]", "\[Rule]", 
           RowBox[{"1", "+", 
            RowBox[{"\[Delta]\[Lambda]2", "*", 
             RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
         RowBox[{"pXf", "\[Rule]", "eqpXf"}]}], "/.", 
        RowBox[{"pXm", "\[Rule]", "eqpXm"}]}], "/.", 
       RowBox[{"pY", "\[Rule]", "eqpY"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol\[Delta]\[Lambda]2", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"\[Delta]\[Lambda]2", "/.", "%"}], ",", "\[Delta]\[Alpha]", ",", 
    "Simplify"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.675900504046673*^9, 3.675900521010648*^9}, {
  3.675900579608243*^9, 3.675900620024974*^9}, {3.676654747977996*^9, 
  3.676654773110881*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", 
     RowBox[{"r", " ", "R"}]], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
       RowBox[{"hAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], ")"}], 
     " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", "hAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "R", " ", "sAf"}], "+", 
       
       RowBox[{"pA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "R", " ", "sAf"}], 
          "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", " ", "hAm"}]}], ")"}], " ", "r", " ", "sAm"}]}], 
         ")"}]}], "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], ")"}]}]}], "-", 
   
   RowBox[{"2", " ", "\[Delta]\[Alpha]"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675900588523295*^9, 3.675900640895134*^9}, {
   3.675900689026965*^9, 3.675900693756687*^9}, 3.676652913437158*^9, {
   3.676652969713451*^9, 3.6766529941475887`*^9}, 3.676653076839588*^9, 
   3.6766547362772408`*^9, 3.676654773535143*^9, 3.676732752329501*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol\[Delta]\[Lambda]2AonOld", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sol\[Delta]\[Lambda]2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"R", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}]}], "/.", 
    RowBox[{"\[Delta]\[Alpha]", "\[Rule]", "0"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.676654782258457*^9, 3.676654880438425*^9}}],

Cell[BoxData[
 RowBox[{
  FractionBox["1", "r"], 
  RowBox[{"2", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{
      RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
     RowBox[{"hAm", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], ")"}], 
   " ", 
   RowBox[{"(", 
    RowBox[{
     RowBox[{"hAf", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", 
        RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", "sAf"}], "+", 
     RowBox[{"pA", " ", 
      RowBox[{"(", 
       RowBox[{"sAf", "-", 
        RowBox[{"r", " ", "sAf"}], "+", 
        RowBox[{"r", " ", "sAm"}], "-", 
        RowBox[{"2", " ", "hAm", " ", "r", " ", "sAm"}]}], ")"}]}], "+", 
     RowBox[{"r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"hAm", " ", "sAm"}], "+", "t"}], ")"}]}]}], 
    ")"}]}]}]], "Output",
 CellChangeTimes->{{3.676654828655718*^9, 3.676654850680685*^9}, 
   3.6766548809083223`*^9, 3.676732752371958*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol\[Delta]\[Lambda]2AonNew", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"sol\[Delta]\[Lambda]2", "[", 
      RowBox[{"[", "1", "]"}], "]"}], "/.", 
     RowBox[{"r", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}]}], "/.", 
    RowBox[{"\[Delta]\[Alpha]", "\[Rule]", "0"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.6766548654946547`*^9, 3.676654876086323*^9}}],

Cell[BoxData[
 RowBox[{"-", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "pA"}], " ", "sAm"}], "+", 
      RowBox[{"hAm", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAm"}], "-", "t"}], ")"}], 
    " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", "hAf", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", 
         RowBox[{"2", " ", "pA"}]}], ")"}], " ", "R", " ", "sAf"}], "-", 
      RowBox[{"hAm", " ", "sAm"}], "-", 
      RowBox[{"pA", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", " ", "R", " ", "sAf"}], "+", "sAm", "-", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}], ")"}]}], "-", "t"}], 
     ")"}]}], "R"]}]], "Output",
 CellChangeTimes->{{3.676654868777504*^9, 3.676654876523601*^9}, 
   3.676732752418583*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{"Clear", "[", 
  RowBox[{"\[Sigma]Am", ",", "\[Sigma]Af"}], "]"}]], "Input",
 CellChangeTimes->{{3.676655031710874*^9, 3.6766550361700687`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"sol\[Delta]\[Lambda]2AonOld", "-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", " ", "2"}], "LA", " ", "VA", " ", "SA"}], ")"}]}], "/.", 
        RowBox[{"LA", "->", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "r"}]}], ")"}], "/", "r"}]}]}], "/.", 
       RowBox[{"VA", "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "pA"}], ")"}], "pA"}]}]}], "/.", 
      RowBox[{"SA", "->", 
       RowBox[{"\[Sigma]Am", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Sigma]Am", "-", "\[Sigma]Af"}], ")"}], "/", "2"}]}]}]}], 
     "/.", 
     RowBox[{"\[Sigma]Am", "->", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pA", "+", 
          RowBox[{"hAm", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAm"}], "-", 
       RowBox[{"pA", " ", "hAm", " ", "sAm"}], "+", "t"}]}]}], "/.", 
    RowBox[{"\[Sigma]Af", "->", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pA", "+", 
         RowBox[{"hAf", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAf"}], "-", 
      RowBox[{"pA", " ", "hAf", " ", "sAf"}]}]}]}], "/.", 
   RowBox[{"pA", "->", 
    FractionBox[
     RowBox[{
      RowBox[{"hAf", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
     RowBox[{
      RowBox[{"-", "sAf"}], "+", 
      RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
      RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.676654952422246*^9, 3.676655132574526*^9}}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.676655037350493*^9, 3.6766550772344112`*^9}, {
   3.676655115558099*^9, 3.6766551332815866`*^9}, 3.676732752501082*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"sol\[Delta]\[Lambda]2AonNew", "-", 
         RowBox[{"(", " ", 
          RowBox[{"LA", " ", "VA", " ", "SA"}], ")"}]}], "/.", 
        RowBox[{"LA", "->", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", "R"}]}], ")"}], "/", "R"}]}]}], "/.", 
       RowBox[{"VA", "\[Rule]", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"1", "-", "pA"}], ")"}], "pA"}]}]}], "/.", 
      RowBox[{"SA", "->", 
       RowBox[{"\[Sigma]Am", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Sigma]Am", "-", "\[Sigma]Af"}], ")"}], "/", "2"}]}]}]}], 
     "/.", 
     RowBox[{"\[Sigma]Am", "->", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pA", "+", 
          RowBox[{"hAm", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAm"}], "-", 
       RowBox[{"pA", " ", "hAm", " ", "sAm"}], "+", "t"}]}]}], "/.", 
    RowBox[{"\[Sigma]Af", "->", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"pA", "+", 
         RowBox[{"hAf", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAf"}], "-", 
      RowBox[{"pA", " ", "hAf", " ", "sAf"}]}]}]}], "/.", 
   RowBox[{"pA", "->", 
    FractionBox[
     RowBox[{
      RowBox[{"hAf", " ", "sAf"}], "+", 
      RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
     RowBox[{
      RowBox[{"-", "sAf"}], "+", 
      RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
      RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.6766551610819893`*^9, 3.6766551697246304`*^9}, 
   3.676655218882216*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.676655164158601*^9, 3.676655170247074*^9}, {
   3.676655215615883*^9, 3.676655219221342*^9}, 3.67673275254561*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"\[Sigma]Am", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"\[Sigma]Am", "-", "\[Sigma]Af"}], ")"}], "/", "2"}]}], "/.", 
        RowBox[{"\[Sigma]Am", "->", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"pA", "+", 
             RowBox[{"hAm", 
              RowBox[{"(", 
               RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAm"}], "-", 
          RowBox[{"pA", " ", "hAm", " ", "sAm"}], "+", "t"}]}]}], "/.", 
       RowBox[{"\[Sigma]Af", "->", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pA", "+", 
            RowBox[{"hAf", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAf"}], "-", 
         RowBox[{"pA", " ", "hAf", " ", "sAf"}]}]}]}], "/.", 
      RowBox[{"pA", "->", 
       FractionBox[
        RowBox[{
         RowBox[{"hAf", " ", "sAf"}], "+", 
         RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
        RowBox[{
         RowBox[{"-", "sAf"}], "+", 
         RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
         RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], "/.", 
     RowBox[{"sAf", "\[Rule]", "sAm"}]}], "/.", 
    RowBox[{"hAf", "\[Rule]", "hAm"}]}], "/.", 
   RowBox[{"t", "\[Rule]", "0"}]}], "//", "Factor"}]], "Input",
 CellChangeTimes->{{3.676655462875929*^9, 3.6766555035936117`*^9}, 
   3.676655545335622*^9}],

Cell[BoxData["0"], "Output",
 CellChangeTimes->{{3.676655477508546*^9, 3.6766555039734993`*^9}, 
   3.676655546009858*^9, 3.67673275262916*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"\[Sigma]Am", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{"\[Sigma]Am", "-", "\[Sigma]Af"}], ")"}], "/", "2"}]}], "/.", 
       RowBox[{"\[Sigma]Am", "->", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"pA", "+", 
            RowBox[{"hAm", 
             RowBox[{"(", 
              RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAm"}], "-", 
         RowBox[{"pA", " ", "hAm", " ", "sAm"}], "+", "t"}]}]}], "/.", 
      RowBox[{"\[Sigma]Af", "->", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{"pA", "+", 
           RowBox[{"hAf", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pA"}], ")"}]}]}], ")"}], "sAf"}], "-", 
        RowBox[{"pA", " ", "hAf", " ", "sAf"}]}]}]}], "/.", 
     RowBox[{"pA", "->", 
      FractionBox[
       RowBox[{
        RowBox[{"hAf", " ", "sAf"}], "+", 
        RowBox[{"hAm", " ", "sAm"}], "+", "t"}], 
       RowBox[{
        RowBox[{"-", "sAf"}], "+", 
        RowBox[{"2", " ", "hAf", " ", "sAf"}], "-", "sAm", "+", 
        RowBox[{"2", " ", "hAm", " ", "sAm"}]}]]}]}], "/.", 
    RowBox[{"sAf", "\[Rule]", "sAm"}]}], "/.", 
   RowBox[{"hAf", "\[Rule]", "hAm"}]}], "//", "Factor"}]], "Input",
 CellChangeTimes->{3.676655557866431*^9}],

Cell[BoxData[
 FractionBox[
  SuperscriptBox["t", "2"], "4"]], "Output",
 CellChangeTimes->{3.676655558220895*^9, 3.6767327527128067`*^9}]
}, Open  ]],

Cell["\<\
I believe that the a locus model should essential be where we assume the \
r=1/2 instead of R=1/2. Thus everything is equivalent except for the \
labelling (R versus r and sai for sAi). 

In their other analyses I think they assume that r is of a similar order to \
the selection terms. \
\>", "Text",
 CellChangeTimes->{{3.675901655447938*^9, 3.6759017803955297`*^9}}],

Cell["\<\
Other thoughts:
With our method we can also include an \[Alpha] of the new y. This is not so \
interesting though as non-mendelian inheritance is not thought to be that \
important. 
We should adjust the haploid fitnesses so that they are wXA, wXa, wYA, wYa \
etc. to allow general forms of selection on the haploids (e.g., if the Y has \
low fitness due to degeneration). 
We could also consider transitions to ZW systems by adjusting the recursion \
equations - I think this is where the action will be. 
With our method, we could also consider incomplete neoY systems - that is, \
they make males, but not all of the time (like an partial loss of female \
function mutation, rather than complete sterility). This would invovle the \
full invasion matrix, i.e., there would be Xiyf haploids to track. \
\>", "Text",
 CellChangeTimes->{{3.675905047874118*^9, 3.675905091997881*^9}, {
  3.675905130297331*^9, 3.6759053697324553`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
External stability - tight linkage\
\>", "Section",
 CellChangeTimes->{{3.675898184242074*^9, 3.675898192657653*^9}, {
  3.676655795483941*^9, 3.6766557996731577`*^9}, {3.6766828335672827`*^9, 
  3.6766828444289703`*^9}}],

Cell[CellGroupData[{

Cell[BoxData["subequil"], "Input",
 CellChangeTimes->{{3.675898272755611*^9, 3.675898273603898*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"XAf", "\[Rule]", "pXf"}], ",", 
   RowBox[{"Xaf", "\[Rule]", 
    RowBox[{"1", "-", "pXf"}]}], ",", 
   RowBox[{"XAm", "\[Rule]", 
    RowBox[{"pXm", " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", 
   RowBox[{"Xam", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXm"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "\[Alpha]"}], ")"}]}]}], ",", 
   RowBox[{"YA", "\[Rule]", 
    RowBox[{"pY", " ", "\[Alpha]"}]}], ",", 
   RowBox[{"Ya", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pY"}], ")"}], " ", "\[Alpha]"}]}], ",", 
   RowBox[{"XAyf", "\[Rule]", "0"}], ",", 
   RowBox[{"Xayf", "\[Rule]", "0"}], ",", 
   RowBox[{"XAym", "\[Rule]", "0"}], ",", 
   RowBox[{"Xaym", "\[Rule]", "0"}], ",", 
   RowBox[{"YAy", "\[Rule]", "0"}], ",", 
   RowBox[{"Yay", "\[Rule]", "0"}]}], "}"}]], "Output",
 CellChangeTimes->{3.675898274076612*^9, 3.675899009180147*^9, 
  3.676732902363318*^9}]
}, Open  ]],

Cell["\<\
Notice that we don\[CloseCurlyQuote]t have recursions for XAyf or Xayf \
because y is a dominant male determining gene. However, we allowed these \
genotypes to create zygotes so we can include them in the stability matrix.\
\>", "Text",
 CellChangeTimes->{{3.6758991929846497`*^9, 3.67589926406907*^9}, {
  3.67589934114139*^9, 3.6758993427645893`*^9}, {3.675900036907325*^9, 
  3.6759000483741083`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"matExtFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "XAyf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Xayf"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "XAym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Xaym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "YAym"}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{
          RowBox[{"{", 
           RowBox[{
           "0", ",", "0", ",", "XAymprime", ",", "Xaymprime", ",", "YAyprime",
             ",", "Yayprime"}], "}"}], ",", "Yaym"}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], "/.", "subequil"}], "//", 
    "Factor"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"MatrixForm", "[", "%", "]"}]}], "Input",
 CellChangeTimes->{{3.675899271627995*^9, 3.675899299216916*^9}}],

Cell[BoxData[
 TagBox[
  RowBox[{"(", "\[NoBreak]", GridBox[{
     {"0", "0", "0", "0", "0", "0"},
     {"0", "0", "0", "0", "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"MAa", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXm", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "R", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXm", " ", "R", " ", "wa"}], "+", 
          RowBox[{"MAA", " ", "pXm", " ", "wA"}], "+", 
          RowBox[{"2", " ", "MAa", " ", "wa", " ", "\[Alpha]"}], "-", 
          RowBox[{"2", " ", "MAa", " ", "pY", " ", "wa", " ", "\[Alpha]"}], 
          "-", 
          RowBox[{"2", " ", "MAa", " ", "RA", " ", "wa", " ", "\[Alpha]"}], 
          "+", 
          RowBox[{
          "2", " ", "MAa", " ", "pY", " ", "RA", " ", "wa", " ", "\[Alpha]"}],
           "+", 
          RowBox[{"2", " ", "MAA", " ", "pY", " ", "wA", " ", "\[Alpha]"}], 
          "-", 
          RowBox[{
          "2", " ", "MAA", " ", "pY", " ", "R0", " ", "wA", " ", 
           "\[Alpha]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      FractionBox[
       RowBox[{"MAa", " ", "wA", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"pXm", " ", "R"}], "+", 
          RowBox[{"2", " ", "pY", " ", "RX", " ", "\[Alpha]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"MAa", "-", 
          RowBox[{"MAa", " ", "pXf"}], "+", 
          RowBox[{"MAA", " ", "pXf"}], "-", 
          RowBox[{"MAa", " ", "R"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "R"}]}], ")"}], " ", "wA"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"MAa", " ", "pXf", " ", "R", " ", "wa"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
           RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
         "\[Alpha]"}]]}], "0", "0"},
     {
      RowBox[{"-", 
       FractionBox[
        RowBox[{"MAa", " ", "wa", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "R"}], "+", 
           RowBox[{"pXm", " ", "R"}], "-", 
           RowBox[{"2", " ", "RX", " ", "\[Alpha]"}], "+", 
           RowBox[{"2", " ", "pY", " ", "RX", " ", "\[Alpha]"}]}], ")"}]}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
           RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
         "\[Alpha]"}]]}], 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "\[Alpha]"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXm", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXm", " ", "wA"}], "+", 
          RowBox[{"MAa", " ", "pXm", " ", "R", " ", "wA"}], "-", 
          RowBox[{"2", " ", "Maa", " ", "wa", " ", "\[Alpha]"}], "+", 
          RowBox[{"2", " ", "Maa", " ", "pY", " ", "wa", " ", "\[Alpha]"}], 
          "+", 
          RowBox[{"2", " ", "Maa", " ", "R0", " ", "wa", " ", "\[Alpha]"}], 
          "-", 
          RowBox[{
          "2", " ", "Maa", " ", "pY", " ", "R0", " ", "wa", " ", "\[Alpha]"}],
           "-", 
          RowBox[{"2", " ", "MAa", " ", "pY", " ", "wA", " ", "\[Alpha]"}], 
          "+", 
          RowBox[{
          "2", " ", "MAa", " ", "pY", " ", "RA", " ", "wA", " ", 
           "\[Alpha]"}]}], ")"}]}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"Maa", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      FractionBox[
       RowBox[{"MAa", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", "R", " ", "wA"}], 
       RowBox[{"2", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
          RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
          RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
          RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
          RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "Maa"}], "+", 
           RowBox[{"Maa", " ", "pXf"}], "-", 
           RowBox[{"MAa", " ", "pXf"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "R"}]}], ")"}], " ", "wa"}], 
        RowBox[{"2", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"Maa", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "pXf", " ", "wa"}], "+", 
           RowBox[{"MAa", " ", "pXf", " ", "wa"}], "-", 
           RowBox[{"Maa", " ", "pY", " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
           RowBox[{"MAa", " ", "pY", " ", "wA"}], "-", 
           RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "+", 
           RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}], ")"}], " ", 
         "\[Alpha]"}]]}], "0", "0"},
     {
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "MAa"}], " ", "R2", " ", "wa"}], "+", 
          RowBox[{"MAa", " ", "pY", " ", "R2", " ", "wa"}], "-", 
          RowBox[{"MAA", " ", "pY", " ", "R0", " ", "wA"}]}], ")"}], " ", 
        "\[Alpha]"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
        RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
        RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
        RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
        RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
        RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
        RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
        RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
        RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"MAa", " ", "pY", " ", "R1", " ", "wA", " ", "\[Alpha]"}], 
        RowBox[{
         RowBox[{
          RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
         RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
         RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
         RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
         RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
         RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
         RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
         RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
         RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}]]}], "0", "0", 
      "0", "0"},
     {
      FractionBox[
       RowBox[{"MAa", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pY"}], ")"}], " ", "R1", " ", "wa", " ", 
        "\[Alpha]"}], 
       RowBox[{
        RowBox[{
         RowBox[{"-", "Maa"}], " ", "wa"}], "+", 
        RowBox[{"Maa", " ", "pXf", " ", "wa"}], "-", 
        RowBox[{"MAa", " ", "pXf", " ", "wa"}], "+", 
        RowBox[{"Maa", " ", "pY", " ", "wa"}], "-", 
        RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
        RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
        RowBox[{"MAa", " ", "pY", " ", "wA"}], "+", 
        RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "-", 
        RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}]], 
      RowBox[{"-", 
       FractionBox[
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"-", "Maa"}], " ", "R0", " ", "wa"}], "+", 
           RowBox[{"Maa", " ", "pY", " ", "R0", " ", "wa"}], "-", 
           RowBox[{"MAa", " ", "pY", " ", "R2", " ", "wA"}]}], ")"}], " ", 
         "\[Alpha]"}], 
        RowBox[{
         RowBox[{"Maa", " ", "wa"}], "-", 
         RowBox[{"Maa", " ", "pXf", " ", "wa"}], "+", 
         RowBox[{"MAa", " ", "pXf", " ", "wa"}], "-", 
         RowBox[{"Maa", " ", "pY", " ", "wa"}], "+", 
         RowBox[{"Maa", " ", "pXf", " ", "pY", " ", "wa"}], "-", 
         RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wa"}], "+", 
         RowBox[{"MAa", " ", "pY", " ", "wA"}], "-", 
         RowBox[{"MAa", " ", "pXf", " ", "pY", " ", "wA"}], "+", 
         RowBox[{"MAA", " ", "pXf", " ", "pY", " ", "wA"}]}]]}], "0", "0", 
      "0", "0"}
    },
    GridBoxAlignment->{
     "Columns" -> {{Center}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
      "RowsIndexed" -> {}},
    GridBoxSpacings->{"Columns" -> {
        Offset[0.27999999999999997`], {
         Offset[0.7]}, 
        Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
        Offset[0.2], {
         Offset[0.4]}, 
        Offset[0.2]}, "RowsIndexed" -> {}}], "\[NoBreak]", ")"}],
  Function[BoxForm`e$, 
   MatrixForm[BoxForm`e$]]]], "Output",
 CellChangeTimes->{3.675899300027032*^9, 3.676652899615107*^9, 
  3.67665450095354*^9, 3.676654616864539*^9, 3.676655805741241*^9, 
  3.676732902757187*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyExt", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matExtFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "6", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6758993091981916`*^9, 3.6758993092948217`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weakr", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"r", "\[Rule]", 
      RowBox[{"r", "*", "\[Epsilon]"}]}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.676655820602331*^9, 3.676655834067677*^9}, {
  3.6766559445224953`*^9, 3.67665595131931*^9}, {3.6766562068088427`*^9, 
  3.676656217972356*^9}, {3.676656925523919*^9, 3.676656927427537*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Normal", "[", 
   RowBox[{"Series", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
          RowBox[{"\[Alpha]", "\[Rule]", 
           RowBox[{"1", "/", "2"}]}]}], "/.", 
         RowBox[{"pXf", "\[Rule]", "eqpXf"}]}], "/.", 
        RowBox[{"pXm", "\[Rule]", "eqpXm"}]}], "/.", 
       RowBox[{"pY", "\[Rule]", "eqpY"}]}], "/.", "weakr"}], ",", 
     RowBox[{"{", 
      RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
   "Factor"}]], "Input",
 CellChangeTimes->{{3.676657118357278*^9, 3.676657132033539*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "\[Lambda]"}], ")"}], " ", 
    SuperscriptBox["\[Lambda]", "4"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "\[Lambda]"}]}], ")"}]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.676657119428014*^9, 3.6766571324305964`*^9}, 
   3.6767329037892113`*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
            RowBox[{"\[Alpha]", "\[Rule]", 
             RowBox[{"1", "/", "2"}]}]}], "/.", 
           RowBox[{"\[Lambda]", "\[Rule]", 
            RowBox[{"1", "+", 
             RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], "/.", 
          RowBox[{"pXf", "\[Rule]", "eqpXf"}]}], "/.", 
         RowBox[{"pXm", "\[Rule]", "eqpXm"}]}], "/.", 
        RowBox[{"pY", "\[Rule]", "eqpY"}]}], "/.", "weakr"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"sol\[Delta]\[Lambda]2AonOldr", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"\[Delta]\[Lambda]1", "/.", "%"}], ",", "\[Delta]\[Alpha]", ",", 
    "Simplify"}], "]"}]}]}], "Input",
 CellChangeTimes->{{3.675900504046673*^9, 3.675900521010648*^9}, {
   3.675900579608243*^9, 3.675900620024974*^9}, {3.676654747977996*^9, 
   3.676654773110881*^9}, 3.6766558815147877`*^9, {3.676656074117153*^9, 
   3.676656075197091*^9}, {3.676656224744651*^9, 3.6766562291345377`*^9}, {
   3.676656291417729*^9, 3.6766563341107264`*^9}, {3.6766568491883793`*^9, 
   3.676656850100011*^9}, {3.676656884167885*^9, 3.6766568912793837`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", 
   RowBox[{
    FractionBox["1", 
     SuperscriptBox["r", "2"]], 
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "pA"}], "+", 
       RowBox[{"hAf", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "pA"}]}], ")"}]}]}], ")"}], " ", "sAf", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"2", " ", 
        SuperscriptBox["hAm", "2"], " ", "pA", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"3", " ", "pA"}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["pA", "2"]}]}], ")"}], " ", 
        SuperscriptBox["sAm", "2"]}], "+", 
       RowBox[{
        SuperscriptBox["pA", "3"], " ", "sAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "-", 
             RowBox[{"4", " ", "hAf"}]}], ")"}], " ", "sAf"}], "+", "sAm"}], 
         ")"}]}], "-", 
       RowBox[{"hAm", " ", "sAm", " ", 
        RowBox[{"(", 
         RowBox[{"r", "-", 
          RowBox[{"2", " ", "pA", " ", "r"}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"4", " ", "hAf", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"2", " ", "pA"}]}], ")"}], " ", "sAf"}], "+", "sAm", 
             "-", 
             RowBox[{"4", " ", "pA", " ", 
              RowBox[{"(", 
               RowBox[{"sAf", "+", "sAm"}], ")"}]}], "-", 
             RowBox[{"2", " ", "t"}]}], ")"}]}]}], ")"}]}], "-", 
       RowBox[{"r", " ", "t"}], "-", 
       RowBox[{"pA", " ", "sAm", " ", 
        RowBox[{"(", 
         RowBox[{"r", "+", 
          RowBox[{"2", " ", "hAf", " ", "sAf"}], "+", "t"}], ")"}]}], "+", 
       RowBox[{
        SuperscriptBox["pA", "2"], " ", "sAm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             RowBox[{"6", " ", "hAf"}]}], ")"}], " ", "sAf"}], "-", "sAm", 
          "+", "t"}], ")"}]}]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675900588523295*^9, 3.675900640895134*^9}, {
   3.675900689026965*^9, 3.675900693756687*^9}, 3.676652913437158*^9, {
   3.676652969713451*^9, 3.6766529941475887`*^9}, 3.676653076839588*^9, 
   3.6766547362772408`*^9, 3.676654773535143*^9, 3.676655882446677*^9, 
   3.676655916095611*^9, 3.6766559648073874`*^9, 3.676656075637342*^9, {
   3.676656210653673*^9, 3.676656229431301*^9}, {3.676656303911191*^9, 
   3.6766563345433283`*^9}, 3.6766568509704447`*^9, 3.676656893351907*^9, 
   3.6767329042431393`*^9}]
}, Open  ]],

Cell["This should also be able to be written SVL as in vD and K. ", "Text",
 CellChangeTimes->{{3.676656527136691*^9, 3.676656531519864*^9}, {
  3.676656584646875*^9, 3.676656598102418*^9}}]
}, Open  ]]
}, Open  ]]
},
Evaluator->"Local2",
WindowSize->{1280, 752},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
Magnification:>1.25 Inherited,
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 346, 6, 183, "Title"],
Cell[928, 30, 118, 1, 62, "Subtitle"],
Cell[1049, 33, 311, 5, 61, "Text"],
Cell[CellGroupData[{
Cell[1385, 42, 251, 3, 100, "Section"],
Cell[1639, 47, 1006, 15, 165, "Text"],
Cell[2648, 64, 1810, 47, 202, "Input"],
Cell[4461, 113, 400, 7, 46, "Text"],
Cell[CellGroupData[{
Cell[4886, 124, 454, 12, 71, "Input"],
Cell[5343, 138, 294, 4, 43, "Output"],
Cell[5640, 144, 292, 4, 43, "Output"]
}, Open  ]],
Cell[5947, 151, 268, 6, 46, "Text"],
Cell[6218, 159, 1884, 39, 202, "Input"],
Cell[8105, 200, 253, 3, 46, "Text"],
Cell[CellGroupData[{
Cell[8383, 207, 605, 18, 71, "Input"],
Cell[8991, 227, 153, 2, 43, "Output"]
}, Open  ]],
Cell[9159, 232, 266, 5, 46, "Text"],
Cell[9428, 239, 1608, 45, 255, "Input"],
Cell[11039, 286, 233, 5, 46, "Text"],
Cell[CellGroupData[{
Cell[11297, 295, 435, 11, 71, "Input"],
Cell[11735, 308, 293, 5, 43, "Output"],
Cell[12031, 315, 293, 5, 43, "Output"]
}, Open  ]],
Cell[12339, 323, 234, 5, 46, "Text"],
Cell[12576, 330, 1627, 45, 176, "Input"],
Cell[14206, 377, 207, 4, 46, "Text"],
Cell[CellGroupData[{
Cell[14438, 385, 522, 14, 97, "Input"],
Cell[14963, 401, 365, 6, 43, "Output"],
Cell[15331, 409, 363, 6, 43, "Output"],
Cell[15697, 417, 363, 6, 43, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[16109, 429, 135, 2, 62, "Section"],
Cell[16247, 433, 390, 6, 46, "Text"],
Cell[16640, 441, 724, 14, 150, "Input"],
Cell[17367, 457, 261, 5, 46, "Text"],
Cell[17631, 464, 1167, 27, 281, "Input"],
Cell[18801, 493, 229, 3, 46, "Text"],
Cell[19033, 498, 661, 16, 150, "Input"],
Cell[19697, 516, 344, 6, 46, "Text"],
Cell[CellGroupData[{
Cell[20066, 526, 1017, 24, 43, "Input"],
Cell[21086, 552, 628, 17, 68, "Output"]
}, Open  ]],
Cell[21729, 572, 159, 2, 46, "Text"],
Cell[CellGroupData[{
Cell[21913, 578, 273, 7, 43, "Input"],
Cell[22189, 587, 333, 8, 43, "Output"]
}, Open  ]],
Cell[22537, 598, 329, 6, 46, "Text"],
Cell[22869, 606, 467, 8, 46, "Text"],
Cell[CellGroupData[{
Cell[23361, 618, 1325, 32, 97, "Input"],
Cell[24689, 652, 2562, 63, 150, "Output"]
}, Open  ]],
Cell[27266, 718, 332, 6, 46, "Text"],
Cell[27601, 726, 211, 4, 46, "Text"],
Cell[CellGroupData[{
Cell[27837, 734, 574, 14, 43, "Input"],
Cell[28414, 750, 782, 18, 52, "Output"]
}, Open  ]],
Cell[29211, 771, 200, 4, 46, "Text"],
Cell[CellGroupData[{
Cell[29436, 779, 772, 19, 43, "Input"],
Cell[30211, 800, 1676, 40, 115, "Output"]
}, Open  ]],
Cell[31902, 843, 202, 4, 46, "Text"],
Cell[CellGroupData[{
Cell[32129, 851, 520, 14, 43, "Input"],
Cell[32652, 867, 906, 24, 72, "Output"]
}, Open  ]],
Cell[33573, 894, 168, 3, 46, "Text"],
Cell[CellGroupData[{
Cell[33766, 901, 638, 15, 45, "Input"],
Cell[34407, 918, 1184, 34, 68, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[35628, 957, 736, 16, 45, "Input"],
Cell[36367, 975, 1435, 38, 75, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[37839, 1018, 586, 14, 45, "Input"],
Cell[38428, 1034, 1259, 35, 75, "Output"]
}, Open  ]],
Cell[39702, 1072, 128, 1, 46, "Text"],
Cell[CellGroupData[{
Cell[39855, 1077, 1567, 39, 150, "Input"],
Cell[41425, 1118, 996, 25, 68, "Output"]
}, Open  ]],
Cell[42436, 1146, 110, 1, 46, "Text"],
Cell[CellGroupData[{
Cell[42571, 1151, 384, 10, 45, "Input"],
Cell[42958, 1163, 799, 21, 70, "Output"]
}, Open  ]],
Cell[43772, 1187, 321, 6, 76, "Text"],
Cell[44096, 1195, 232, 4, 46, "Text"],
Cell[CellGroupData[{
Cell[44353, 1203, 821, 24, 71, "Input"],
Cell[45177, 1229, 172, 2, 43, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[45386, 1236, 819, 24, 71, "Input"],
Cell[46208, 1262, 142, 2, 43, "Output"]
}, Open  ]],
Cell[46365, 1267, 288, 6, 46, "Text"],
Cell[CellGroupData[{
Cell[46678, 1277, 729, 21, 71, "Input"],
Cell[47410, 1300, 4782, 128, 352, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[52229, 1433, 787, 24, 43, "Input"],
Cell[53019, 1459, 2236, 43, 376, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[55304, 1508, 288, 6, 107, "Section"],
Cell[55595, 1516, 442, 11, 63, "Input"],
Cell[56040, 1529, 628, 15, 213, "Input"],
Cell[56671, 1546, 384, 11, 63, "Input"],
Cell[CellGroupData[{
Cell[57080, 1561, 405, 11, 63, "Input"],
Cell[57488, 1574, 1866, 55, 172, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[59403, 1635, 128, 1, 62, "Section"],
Cell[59534, 1638, 318, 10, 35, "Input"],
Cell[CellGroupData[{
Cell[59877, 1652, 2003, 52, 183, "Input"],
Cell[61883, 1706, 45249, 1011, 296, "Output"]
}, Open  ]],
Cell[107147, 2720, 298, 8, 36, "Input"],
Cell[107448, 2730, 461, 11, 36, "Input"],
Cell[CellGroupData[{
Cell[107934, 2745, 508, 14, 57, "Input"],
Cell[108445, 2761, 1227, 37, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[109709, 2803, 776, 21, 57, "Input"],
Cell[110488, 2826, 461, 13, 56, "Output"]
}, Open  ]],
Cell[110964, 2842, 513, 12, 36, "Input"],
Cell[CellGroupData[{
Cell[111502, 2858, 556, 14, 57, "Input"],
Cell[112061, 2874, 1279, 38, 58, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[113377, 2917, 827, 22, 57, "Input"],
Cell[114207, 2941, 341, 11, 56, "Output"]
}, Open  ]],
Cell[114563, 2955, 196, 4, 61, "Text"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[114808, 2965, 98, 1, 114, "Title"],
Cell[CellGroupData[{
Cell[114931, 2970, 318, 4, 100, "Section"],
Cell[115252, 2976, 2378, 38, 417, "Text"],
Cell[CellGroupData[{
Cell[117655, 3018, 105, 1, 54, "Subsection"],
Cell[117763, 3021, 1164, 17, 85, "Text"],
Cell[118930, 3040, 3001, 81, 477, "Input"],
Cell[121934, 3123, 248, 5, 37, "Text"],
Cell[122185, 3130, 609, 17, 36, "Input"],
Cell[122797, 3149, 517, 9, 37, "Text"],
Cell[CellGroupData[{
Cell[123339, 3162, 1067, 29, 78, "Input"],
Cell[124409, 3193, 561, 8, 35, "Output"],
Cell[124973, 3203, 563, 8, 35, "Output"],
Cell[125539, 3213, 561, 8, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[126149, 3227, 150, 2, 54, "Subsection"],
Cell[126302, 3231, 300, 5, 37, "Text"],
Cell[126605, 3238, 5505, 137, 834, "Input"],
Cell[132113, 3377, 163, 2, 37, "Text"],
Cell[132279, 3381, 112, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[132416, 3386, 597, 11, 57, "Input"],
Cell[133016, 3399, 141, 2, 35, "Output"]
}, Open  ]],
Cell[133172, 3404, 137, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[133334, 3411, 391, 8, 36, "Input"],
Cell[133728, 3421, 148, 3, 35, "Output"]
}, Open  ]],
Cell[133891, 3427, 162, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[134078, 3434, 371, 8, 57, "Input"],
Cell[134452, 3444, 124, 2, 35, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[134625, 3452, 105, 1, 54, "Subsection"],
Cell[134733, 3455, 550, 9, 85, "Text"],
Cell[135286, 3466, 6990, 193, 1065, "Input"],
Cell[142279, 3661, 284, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[142588, 3671, 1281, 25, 204, "Input"],
Cell[143872, 3698, 559, 8, 35, "Output"],
Cell[144434, 3708, 561, 8, 35, "Output"]
}, Open  ]],
Cell[145010, 3719, 468, 6, 85, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[145515, 3730, 95, 1, 54, "Subsection"],
Cell[145613, 3733, 804, 17, 204, "Text"],
Cell[146420, 3752, 14432, 421, 834, "Input"],
Cell[160855, 4175, 184, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[161064, 4182, 422, 11, 57, "Input"],
Cell[161489, 4195, 317, 5, 35, "Output"],
Cell[161809, 4202, 317, 5, 35, "Output"]
}, Open  ]],
Cell[162141, 4210, 429, 8, 61, "Text"],
Cell[162573, 4220, 770, 14, 180, "Text"],
Cell[163346, 4236, 663, 17, 35, "Input"],
Cell[164012, 4255, 124, 3, 37, "Text"],
Cell[164139, 4260, 10052, 313, 666, "Input"],
Cell[174194, 4575, 87, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[174306, 4580, 401, 9, 36, "Input"],
Cell[174710, 4591, 221, 4, 35, "Output"]
}, Open  ]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[174992, 4602, 305, 4, 100, "Section"],
Cell[175300, 4608, 121, 1, 37, "Text"],
Cell[175424, 4611, 1426, 33, 309, "Input"],
Cell[176853, 4646, 420, 7, 61, "Text"],
Cell[177276, 4655, 785, 15, 120, "Input"],
Cell[178064, 4672, 261, 5, 37, "Text"],
Cell[178328, 4679, 1167, 27, 225, "Input"],
Cell[179498, 4708, 229, 3, 37, "Text"],
Cell[179730, 4713, 710, 17, 120, "Input"],
Cell[180443, 4732, 344, 6, 37, "Text"],
Cell[CellGroupData[{
Cell[180812, 4742, 1006, 20, 35, "Input"],
Cell[181821, 4764, 882, 25, 56, "Output"]
}, Open  ]],
Cell[182718, 4792, 159, 2, 37, "Text"],
Cell[CellGroupData[{
Cell[182902, 4798, 402, 9, 35, "Input"],
Cell[183307, 4809, 574, 12, 36, "Output"]
}, Open  ]],
Cell[183896, 4824, 329, 6, 37, "Text"],
Cell[184228, 4832, 467, 8, 37, "Text"],
Cell[CellGroupData[{
Cell[184720, 4844, 1181, 25, 57, "Input"],
Cell[185904, 4871, 2910, 72, 120, "Output"]
}, Open  ]],
Cell[188829, 4946, 332, 6, 61, "Text"],
Cell[189164, 4954, 211, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[189400, 4962, 703, 16, 35, "Input"],
Cell[190106, 4980, 956, 21, 42, "Output"]
}, Open  ]],
Cell[191077, 5004, 200, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[191302, 5012, 573, 16, 35, "Input"],
Cell[191878, 5030, 1605, 38, 92, "Output"]
}, Open  ]],
Cell[193498, 5071, 202, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[193725, 5079, 477, 13, 35, "Input"],
Cell[194205, 5094, 893, 24, 59, "Output"]
}, Open  ]],
Cell[195113, 5121, 168, 3, 37, "Text"],
Cell[CellGroupData[{
Cell[195306, 5128, 880, 18, 36, "Input"],
Cell[196189, 5148, 1408, 38, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[197634, 5191, 517, 13, 36, "Input"],
Cell[198154, 5206, 1360, 37, 61, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[199551, 5248, 764, 17, 36, "Input"],
Cell[200318, 5267, 1478, 38, 61, "Output"]
}, Open  ]],
Cell[201811, 5308, 114, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[201950, 5313, 1529, 38, 120, "Input"],
Cell[203482, 5353, 784, 23, 56, "Output"]
}, Open  ]],
Cell[204281, 5379, 110, 1, 37, "Text"],
Cell[CellGroupData[{
Cell[204416, 5384, 212, 6, 35, "Input"],
Cell[204631, 5392, 625, 18, 57, "Output"]
}, Open  ]],
Cell[205271, 5413, 321, 6, 61, "Text"]
}, Open  ]],
Cell[205607, 5422, 203, 3, 100, "Section"],
Cell[CellGroupData[{
Cell[205835, 5429, 226, 5, 62, "Section"],
Cell[CellGroupData[{
Cell[206086, 5438, 100, 1, 35, "Input"],
Cell[206189, 5441, 1023, 29, 57, "Output"]
}, Open  ]],
Cell[207227, 5473, 415, 7, 61, "Text"],
Cell[CellGroupData[{
Cell[207667, 5484, 1951, 52, 183, "Input"],
Cell[209621, 5538, 12973, 301, 216, "Output"]
}, Open  ]],
Cell[222609, 5842, 296, 8, 36, "Input"],
Cell[CellGroupData[{
Cell[222930, 5854, 455, 13, 57, "Input"],
Cell[223388, 5869, 794, 22, 57, "Output"]
}, Open  ]],
Cell[224197, 5894, 295, 5, 61, "Text"],
Cell[224495, 5901, 528, 10, 109, "Text"],
Cell[CellGroupData[{
Cell[225048, 5915, 690, 19, 57, "Input"],
Cell[225741, 5936, 652, 17, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[226430, 5958, 1006, 27, 57, "Input"],
Cell[227439, 5987, 395, 10, 35, "Output"]
}, Open  ]],
Cell[227849, 6000, 193, 4, 37, "Text"],
Cell[CellGroupData[{
Cell[228067, 6008, 973, 27, 57, "Input"],
Cell[229043, 6037, 286, 6, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[229366, 6048, 1006, 28, 78, "Input"],
Cell[230375, 6078, 3453, 81, 141, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[233865, 6164, 106, 1, 35, "Input"],
Cell[233974, 6167, 487, 13, 36, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[234498, 6185, 1468, 39, 99, "Input"],
Cell[235969, 6226, 1768, 54, 92, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[237774, 6285, 410, 11, 36, "Input"],
Cell[238187, 6298, 1205, 39, 78, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[239429, 6342, 412, 11, 36, "Input"],
Cell[239844, 6355, 1015, 32, 56, "Output"]
}, Open  ]],
Cell[240874, 6390, 167, 3, 35, "Input"],
Cell[CellGroupData[{
Cell[241066, 6397, 1772, 55, 103, "Input"],
Cell[242841, 6454, 170, 2, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[243048, 6461, 1770, 55, 103, "Input"],
Cell[244821, 6518, 165, 2, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[245023, 6525, 1506, 43, 82, "Input"],
Cell[246532, 6570, 143, 2, 35, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[246712, 6577, 1362, 40, 82, "Input"],
Cell[248077, 6619, 138, 3, 59, "Output"]
}, Open  ]],
Cell[248230, 6625, 379, 8, 109, "Text"],
Cell[248612, 6635, 944, 16, 204, "Text"]
}, Open  ]],
Cell[CellGroupData[{
Cell[249593, 6656, 231, 5, 100, "Section"],
Cell[CellGroupData[{
Cell[249849, 6665, 100, 1, 35, "Input"],
Cell[249952, 6668, 1023, 29, 57, "Output"]
}, Open  ]],
Cell[250990, 6700, 415, 7, 61, "Text"],
Cell[CellGroupData[{
Cell[251430, 6711, 1951, 52, 183, "Input"],
Cell[253384, 6765, 12998, 302, 216, "Output"]
}, Open  ]],
Cell[266397, 7070, 296, 8, 36, "Input"],
Cell[266696, 7080, 483, 11, 57, "Input"],
Cell[CellGroupData[{
Cell[267204, 7095, 682, 19, 57, "Input"],
Cell[267889, 7116, 459, 14, 56, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[268385, 7135, 1636, 39, 99, "Input"],
Cell[270024, 7176, 2939, 79, 118, "Output"]
}, Open  ]],
Cell[272978, 7258, 190, 2, 37, "Text"]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
