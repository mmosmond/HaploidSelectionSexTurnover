(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 9.0' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       157,          7]
NotebookDataLength[    598803,      15412]
NotebookOptionsPosition[    580371,      14855]
NotebookOutlinePosition[    580726,      14871]
CellTagsIndexPosition[    580683,      14868]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell["\<\
Gametic Selection, Sex Ratio Bias, and Transitions Between Sex Determination \
Systems\
\>", "Title",
 CellChangeTimes->{{3.6756461584547977`*^9, 3.675646190672323*^9}, {
   3.675691343813216*^9, 3.675691344643425*^9}, {3.675718324413807*^9, 
   3.6757183349582043`*^9}, {3.675719587684537*^9, 3.675719616196001*^9}, 
   3.6759056672964783`*^9, 3.676676533093017*^9, 3.678542642367774*^9, {
   3.678560549515456*^9, 3.678560568313982*^9}, 3.6820500476906357`*^9}],

Cell["Michael Scott, Matthew Osmond, Sarah Otto", "Subtitle",
 CellChangeTimes->{{3.6756909919076443`*^9, 3.675690999875959*^9}, {
  3.679939506599341*^9, 3.679939536485776*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
A. Offspring control (neo-Y, neo-W, or ESD invade XY)\
\>", "Title",
 CellChangeTimes->{{3.681790744740692*^9, 3.681790746984047*^9}, 
   3.681790967276816*^9, {3.6818915562823353`*^9, 3.6818915646829967`*^9}, {
   3.681891823954941*^9, 3.681891828318096*^9}, {3.681894422770378*^9, 
   3.681894423198917*^9}, {3.6820500588075733`*^9, 3.6820500635285788`*^9}}],

Cell[CellGroupData[{

Cell["Life-cycle", "Section",
 CellChangeTimes->{{3.681743786104041*^9, 3.6817437925740137`*^9}, {
   3.681744758252803*^9, 3.6817447640802717`*^9}, {3.6817907535849123`*^9, 
   3.681790755198732*^9}, 3.681790964811371*^9}],

Cell["Haploid selection", "Text",
 CellChangeTimes->{{3.681790761563039*^9, 3.681790767400532*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["wbarHap", "sex_"], ":=", 
   RowBox[{
    SubscriptBox["wbarHap", "sex"], "=", 
    RowBox[{"ParallelSum", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["wHap", 
        RowBox[{"y", ",", "sex"}]], 
       SubscriptBox["fHap", 
        RowBox[{"x", ",", "y", ",", "z", ",", "sex"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["fHapSel", 
   RowBox[{"x_", ",", "y_", ",", "z_", ",", "sex_"}]], ":=", 
  RowBox[{
   SubscriptBox["wHap", 
    RowBox[{"y", ",", "sex"}]], 
   RowBox[{
    SubscriptBox["fHap", 
     RowBox[{"x", ",", "y", ",", "z", ",", "sex"}]], "/", 
    SubscriptBox["wbarHap", "sex"]}]}]}]}], "Input",
 CellChangeTimes->{{3.68174069177772*^9, 3.681740709745438*^9}, {
  3.6817407470528183`*^9, 3.681740792567976*^9}, {3.681743989430183*^9, 
  3.681743993228486*^9}, {3.681744694112637*^9, 3.681744695061598*^9}, {
  3.681744770055842*^9, 3.681744781694951*^9}}],

Cell["Random mating", "Text",
 CellChangeTimes->{{3.6817907708613567`*^9, 3.681790772239373*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fDip", 
   RowBox[{
   "xM_", ",", "yM_", ",", "zM_", ",", "xP_", ",", "yP_", ",", "zP_"}]], ":=", 
  RowBox[{
   SubscriptBox["fDip", 
    RowBox[{"xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP"}]], 
   "=", 
   RowBox[{
    SubscriptBox["fHapSel", 
     RowBox[{"xM", ",", "yM", ",", "zM", ",", "female"}]], 
    SubscriptBox["fHapSel", 
     RowBox[{"xP", ",", "yP", ",", "zP", ",", "male"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.681740852705102*^9, 3.681740881236745*^9}, {
   3.681741102397697*^9, 3.681741112150375*^9}, 3.6817438071282473`*^9, 
   3.68174469800976*^9, {3.681744788822844*^9, 3.681744812868677*^9}}],

Cell["Sex determination", "Text",
 CellChangeTimes->{{3.68179077585012*^9, 3.681790778311782*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fDipSex", 
   RowBox[{
   "xM_", ",", "yM_", ",", "zM_", ",", "xP_", ",", "yP_", ",", "zP_", ",", 
    "sex_"}]], ":=", 
  RowBox[{
   SubscriptBox["fDipSex", 
    RowBox[{
    "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
     "sex"}]], "=", 
   RowBox[{
    SubscriptBox["fDip", 
     RowBox[{"xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP"}]], 
    SubscriptBox["psex", 
     RowBox[{"zM", ",", "xP", ",", "zP", ",", "sex"}]]}]}]}]], "Input",
 CellChangeTimes->{{3.681740916059374*^9, 3.681740941165064*^9}, {
   3.6817411271569843`*^9, 3.68174113488159*^9}, 3.681744699086836*^9, {
   3.681744820695732*^9, 3.681744847841905*^9}}],

Cell["where a diploid must become male or female", "Text",
 CellChangeTimes->{{3.681790782072919*^9, 3.681790792647656*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumsex", "=", 
   RowBox[{
    SubscriptBox["psex", 
     RowBox[{"zM_", ",", "xP_", ",", "zP_", ",", "male"}]], "\[Rule]", 
    RowBox[{"1", "-", 
     SubscriptBox["psex", 
      RowBox[{"zM", ",", "xP", ",", "zP", ",", "female"}]]}]}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.681740963151202*^9, 3.681741006588331*^9}, {
  3.6817448642217417`*^9, 3.681744883117257*^9}}],

Cell["\<\
We assume the invasion of a dominant modifier into an XY system\
\>", "Text",
 CellChangeTimes->{{3.681790803628374*^9, 3.681790842176858*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"invXY", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"M", ",", "Y", ",", "M", ",", "female"}]], "\[Rule]", "0"}], 
     ",", 
     RowBox[{"(*", 
      RowBox[{
      "always", " ", "male", " ", "if", " ", "ESD", " ", "wildtype", " ", 
       "and", " ", "have", " ", "Y"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"M", ",", "X", ",", "M", ",", "female"}]], "\[Rule]", "1"}], 
     ",", 
     RowBox[{"(*", 
      RowBox[{
      "always", " ", "female", " ", "ESD", " ", "wildtype", " ", "and", " ", 
       "have", " ", "X", " ", "from", " ", "father"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"m", ",", "xP_", ",", "zP_", ",", "female"}]], "\[Rule]", 
      "k"}], ",", 
     RowBox[{"(*", 
      RowBox[{
      "female", " ", "with", " ", "probability", " ", "k", " ", "if", " ", 
       "mutation", " ", "at", " ", "the", " ", "ESD"}], "*)"}], 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"zM_", ",", "xP_", ",", "m", ",", "female"}]], "\[Rule]", 
      "k"}]}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678749250078711*^9, 3.678749257734652*^9}, {
   3.678749341105864*^9, 3.678749495395021*^9}, {3.679945123194168*^9, 
   3.679945148394607*^9}, {3.6799451869399347`*^9, 3.679945240579802*^9}, {
   3.679945289781743*^9, 3.679945339491596*^9}, {3.6799453844002123`*^9, 
   3.679945402746641*^9}, {3.6799454634914007`*^9, 3.6799455567240467`*^9}, {
   3.6799484238045397`*^9, 3.679948455123131*^9}, {3.67994848956713*^9, 
   3.679948517654551*^9}, {3.679948569319213*^9, 3.679948570835786*^9}, {
   3.679951538898012*^9, 3.679951549755542*^9}, {3.68037305678191*^9, 
   3.680373067198072*^9}, {3.6803822046986856`*^9, 3.680382207715699*^9}, {
   3.680382278235017*^9, 3.68038254183022*^9}, {3.6803826726056223`*^9, 
   3.6803827011867247`*^9}, {3.681481533121539*^9, 3.681481811404159*^9}, {
   3.681482143533368*^9, 3.681482144703322*^9}, {3.681736556313373*^9, 
   3.681736594419837*^9}, {3.681736645992744*^9, 3.6817366988928537`*^9}, {
   3.681736750338529*^9, 3.681736811785675*^9}, {3.681736847176927*^9, 
   3.681736957382381*^9}, {3.6817438697025414`*^9, 3.681743921107368*^9}, 
   3.6817443638221292`*^9, {3.681744903243745*^9, 3.681744975780779*^9}, {
   3.681745009880579*^9, 3.681745061658045*^9}, {3.681790822233528*^9, 
   3.6817908224326878`*^9}}],

Cell["Diploid selection", "Text",
 CellChangeTimes->{{3.6817908523566217`*^9, 3.681790854930419*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["wbarDip", "sex_"], ":=", 
   RowBox[{
    SubscriptBox["wbarDip", "sex"], "=", 
    RowBox[{"ParallelSum", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["wDip", 
        RowBox[{"yM", ",", "yP", ",", "sex"}]], 
       SubscriptBox["fDipSex", 
        RowBox[{
        "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
         "sex"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"xM", ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"yM", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zM", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xP", ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"yP", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zP", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["fDipSel", 
   RowBox[{
   "xM_", ",", "yM_", ",", "zM_", ",", "xP_", ",", "yP_", ",", "zP_", ",", 
    "sex_"}]], ":=", 
  RowBox[{
   SubscriptBox["fDipSel", 
    RowBox[{
    "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
     "sex"}]], "=", 
   RowBox[{
    SubscriptBox["wDip", 
     RowBox[{"yM", ",", "yP", ",", "sex"}]], 
    RowBox[{
     SubscriptBox["fDipSex", 
      RowBox[{
      "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
       "sex"}]], "/", 
     SubscriptBox["wbarDip", "sex"]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.6814776843785267`*^9, 3.681477897180252*^9}, {
   3.6814779428772593`*^9, 3.6814780164069233`*^9}, {3.681478227321601*^9, 
   3.681478243595066*^9}, {3.681481833880354*^9, 3.6814818456087008`*^9}, {
   3.6817392306929207`*^9, 3.681739316847645*^9}, {3.6817439550643167`*^9, 
   3.681743978122819*^9}, {3.681744013982086*^9, 3.681744051569847*^9}, 
   3.6817447019132853`*^9}],

Cell["Meiosis", "Text",
 CellChangeTimes->{{3.6817908603315487`*^9, 3.681790862035611*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fHapNext", 
   RowBox[{"x_", ",", "y_", ",", "z_", ",", "sex_"}]], ":=", 
  RowBox[{
   SubscriptBox["fHapNext", 
    RowBox[{"x", ",", "y", ",", "z", ",", "sex"}]], "=", 
   RowBox[{"ParallelSum", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["fDipSel", 
       RowBox[{
       "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
        "sex"}]], 
      SubscriptBox["pseg", 
       RowBox[{
       "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
        "sex", ",", "x", ",", "y", ",", "z"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"xM", ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yM", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zM", ",", 
       RowBox[{"{", 
        RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xP", ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yP", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zP", ",", 
       RowBox[{"{", 
        RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6817440705483007`*^9, 3.6817440908841143`*^9}, {
  3.681744703057055*^9, 3.6817447059212723`*^9}, {3.681745089264248*^9, 
  3.681745102327985*^9}}],

Cell["Segregation rules", "Text",
 CellChangeTimes->{{3.681790868073222*^9, 3.681790870347493*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pseg0", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"triple", " ", "homozygote"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     SubscriptBox["pseg", 
      RowBox[{
      "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y1_", ",", "z1_", ",", 
       "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", "1"}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"single", " ", "heterozygotes"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z1_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y2_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y2_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y2_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg2", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"double", " ", "heterozygotes"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z1_", ",",
         "sex_", ",", "x2_", ",", "y2_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z1_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"r", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y2_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"r", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y2_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y2_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"R", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{"R", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}]}], "+", 
         RowBox[{"r", " ", "R"}]}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}]}], "+", 
         RowBox[{"r", " ", "R"}]}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", 
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}], "R"}]}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", 
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}], "R"}]}], ")"}], "/", "2"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg3", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"triple", " ", "heterozygote"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y2_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"r", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y2_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{"r", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y2_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{"r", " ", 
       RowBox[{"R", "/", "2"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{"r", " ", 
       RowBox[{"R", "/", "2"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z2_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], 
       RowBox[{"R", "/", "2"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y2_", ",", "z1_"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], 
       RowBox[{"R", "/", "2"}]}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg4", "=", 
   RowBox[{
    SubscriptBox["pseg", 
     RowBox[{
     "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
      "sex_", ",", "x_", ",", "y_", ",", "z_"}]], "\[Rule]", "0"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.678743407603024*^9, 3.678743407992798*^9}, {
   3.678743451388444*^9, 3.67874370896734*^9}, {3.678743739187004*^9, 
   3.6787437964386272`*^9}, {3.678743835224123*^9, 3.678744092201377*^9}, {
   3.678744261724123*^9, 3.678744264472003*^9}, {3.678745612751544*^9, 
   3.678745641984303*^9}, {3.67874649434549*^9, 3.678746541426771*^9}, {
   3.678746588409*^9, 3.678746681937327*^9}, {3.678746723757894*^9, 
   3.678746726465787*^9}, {3.678747087955186*^9, 3.678747088849813*^9}, 
   3.6787471567075977`*^9, {3.678747281988718*^9, 3.678747345020574*^9}, {
   3.678747431984068*^9, 3.67874755142631*^9}, {3.678747706661974*^9, 
   3.678747816389114*^9}, {3.678747910520447*^9, 3.67874808520201*^9}, {
   3.678748117158371*^9, 3.678748124005247*^9}, 3.6787481598608437`*^9, {
   3.6787483065670223`*^9, 3.6787483117635727`*^9}, {3.67874836658313*^9, 
   3.678748403085204*^9}, {3.6787513544793262`*^9, 3.678751396800355*^9}, {
   3.67994277150476*^9, 3.679942799274077*^9}, {3.679942831090846*^9, 
   3.679942912055253*^9}, {3.679949107745778*^9, 3.679949120757681*^9}, {
   3.679949262229959*^9, 3.679949268375124*^9}, {3.679949476794919*^9, 
   3.679949523563891*^9}, {3.680374604093164*^9, 3.680374627372505*^9}, {
   3.681497799779855*^9, 3.6814978041546593`*^9}, {3.681497949200699*^9, 
   3.681497969730068*^9}, {3.6814980083479347`*^9, 3.68149802692618*^9}, 
   3.681498690728004*^9, {3.681503295313662*^9, 3.681503299933617*^9}, {
   3.681503352635356*^9, 3.681503380988648*^9}, {3.681503421408928*^9, 
   3.681503592682515*^9}, {3.681739639029612*^9, 3.681739667227919*^9}, {
   3.681739710186636*^9, 3.6817397505186863`*^9}, {3.68173979007161*^9, 
   3.6817400224068947`*^9}, {3.6817402086731462`*^9, 3.681740553815752*^9}, 
   3.6817441247473288`*^9, {3.681745118289254*^9, 3.681745246566457*^9}, 
   3.681790293719043*^9, {3.681790495616611*^9, 3.68179055084875*^9}, {
   3.681790594196591*^9, 3.681790651669318*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ParallelSum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox["fHapNext", 
             RowBox[{"x", ",", "y", ",", "z", ",", "sex"}]], "/.", "sumsex"}],
            "/.", "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.", 
        "pseg2"}], "/.", "pseg3"}], "/.", "pseg4"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"{", 
        RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"sex", ",", 
       RowBox[{"{", 
        RowBox[{"male", ",", "female"}], "}"}]}], "}"}]}], "]"}], "//", 
   "Factor"}], "*)"}]], "Input",
 CellChangeTimes->{{3.67874845755774*^9, 3.678748462275442*^9}, {
   3.678751411807235*^9, 3.6787514131899548`*^9}, 3.678763342644992*^9, {
   3.681478850779172*^9, 3.681478905428947*^9}, 3.681480922347474*^9, {
   3.6814819018647537`*^9, 3.681481902798575*^9}, {3.681740581820306*^9, 
   3.68174061902907*^9}, {3.681744323454342*^9, 3.6817443251285563`*^9}, {
   3.681744645533119*^9, 3.681744653118101*^9}, {3.681745272073327*^9, 
   3.681745276899906*^9}, 3.681789777994355*^9, {3.681790881077402*^9, 
   3.6817908819265223`*^9}, {3.681891792334906*^9, 3.681891793067932*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Resident equilibrium (weak selection)", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9, {3.675889497088314*^9, 3.675889497307007*^9}, {
   3.675897573374775*^9, 3.675897575830624*^9}, {3.675897716718397*^9, 
   3.6758977222283363`*^9}, 3.676682250170936*^9, 3.676682959070333*^9, {
   3.6767193867939043`*^9, 3.676719388460558*^9}, {3.6785484984643793`*^9, 
   3.678548500198676*^9}, {3.67875273051103*^9, 3.678752732829526*^9}, {
   3.678768538688073*^9, 3.6787685439131317`*^9}}],

Cell["We begin with no mutations at the modifer locus", "Text",
 CellChangeTimes->{{3.681790894519829*^9, 3.6817909035331917`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subequil", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"X", ",", "A", ",", "M", ",", "female"}]], "\[Rule]", "pXf"}],
       ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"X", ",", "a", ",", "M", ",", "female"}]], "\[Rule]", 
       RowBox[{"1", "-", "pXf"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"X", ",", "A", ",", "M", ",", "male"}]], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]"}], ")"}], "pXm"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"X", ",", "a", ",", "M", ",", "male"}]], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", "pXm"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"Y", ",", "A", ",", "M", ",", "male"}]], "\[Rule]", 
       RowBox[{"\[Alpha]", " ", "pYm"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"Y", ",", "a", ",", "M", ",", "male"}]], "\[Rule]", 
       RowBox[{"\[Alpha]", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pYm"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"x_", ",", "y_", ",", "m", ",", "sex_"}]], "\[Rule]", "0"}], 
      ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"Y", ",", "y_", ",", "M", ",", "female"}]], "\[Rule]", 
       "0"}]}], "\[IndentingNewLine]", "}"}], "/.", 
    RowBox[{"\[Alpha]", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681744168796749*^9, 3.681744285955284*^9}, {
  3.681744456703849*^9, 3.68174446046725*^9}, {3.681744512032195*^9, 
  3.681744517689509*^9}, {3.681745250079322*^9, 3.681745268071438*^9}, {
  3.681790148659374*^9, 3.681790165932436*^9}}],

Cell["\<\
We now wish to solve for the equilibrium frequencies of the haploid genotypes \
in gametes of each sex. Equilibrium is achieved when the following three \
equations are zero (this takes a minute)\
\>", "Text",
 CellChangeTimes->{{3.675694155902801*^9, 3.675694193760104*^9}, {
   3.6756944337868023`*^9, 3.6756944351881227`*^9}, {3.6757029847267847`*^9, 
   3.67570303405547*^9}, {3.675710696458521*^9, 3.675710706286772*^9}, 
   3.6758975924118633`*^9, {3.676719416278571*^9, 3.676719460360141*^9}, {
   3.678763369210025*^9, 3.678763372346648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["fHapNext", 
               RowBox[{"X", ",", "A", ",", "M", ",", "female"}]], "-", 
              SubscriptBox["fHap", 
               RowBox[{"X", ",", "A", ",", "M", ",", "female"}]]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["fHapNext", 
               RowBox[{"X", ",", "A", ",", "M", ",", "male"}]], "-", 
              SubscriptBox["fHap", 
               RowBox[{"X", ",", "A", ",", "M", ",", "male"}]]}], ",", 
             "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["fHapNext", 
               RowBox[{"Y", ",", "A", ",", "M", ",", "male"}]], "-", 
              SubscriptBox["fHap", 
               RowBox[{"Y", ",", "A", ",", "M", ",", "male"}]]}]}], 
            "\[IndentingNewLine]", "}"}], "/.", "subequil"}], "/.", 
          "sumsex"}], "/.", "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.",
       "pseg2"}], "/.", "pseg3"}], "/.", "pseg4"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678750179056045*^9, 3.678750265971582*^9}, 
   3.6787516566515017`*^9, {3.681789829427744*^9, 3.68178992075916*^9}, 
   3.681891166870421*^9}],

Cell["\<\
To simplify the analysis we assume weak selection in both haploids and \
diploids. In addition, we assume selection acts on the VS locus only\
\>", "Text",
 CellChangeTimes->{{3.675694205010009*^9, 3.675694211923259*^9}, 
   3.67570298472752*^9, {3.6757030454432507`*^9, 3.6757030568360033`*^9}, {
   3.678750297640636*^9, 3.678750297774932*^9}, {3.678750454508356*^9, 
   3.6787504833762913`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weaksel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "sex_"}]], "\[Rule]", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "sex_"}]], "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["sHap", "sex"], " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "A", ",", "sex_"}]], "\[Rule]", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "sex_"}]], "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["h", "sex"], " ", 
        SubscriptBox["sDip", "sex"], " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "sex_"}]], "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["h", "sex"], " ", 
        SubscriptBox["sDip", "sex"], " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "a", ",", "sex_"}]], "\[Rule]", 
      RowBox[{"1", "+", " ", 
       RowBox[{
        SubscriptBox["sDip", "sex"], " ", "\[Epsilon]"}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.67564806523287*^9, 3.675648221558539*^9}, {
   3.675694367971285*^9, 3.6756943845803022`*^9}, 3.6757029847280283`*^9, {
   3.678750304645768*^9, 3.67875045056485*^9}, {3.678750489500865*^9, 
   3.6787505048047533`*^9}, {3.6787505350519323`*^9, 3.678750613437016*^9}, {
   3.678750650976028*^9, 3.678750663356496*^9}, {3.6787515109746723`*^9, 
   3.678751549594288*^9}, {3.681789961959874*^9, 3.6817900838735647`*^9}}],

Cell["We can write the frequencies as Taylor series", "Text",
 CellChangeTimes->{{3.675707045047565*^9, 3.6757070543930063`*^9}, {
  3.675707367038864*^9, 3.675707370179316*^9}, {3.675711803871513*^9, 
  3.6757118112225847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frequenciessub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pXf", "\[Rule]", 
      RowBox[{"pXf0", "+", 
       RowBox[{"pXf1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pXm", "\[Rule]", 
      RowBox[{"pXm0", "+", 
       RowBox[{"pXm1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pYm", "\[Rule]", 
      RowBox[{"pYm0", "+", 
       RowBox[{"pYm1", " ", "\[Epsilon]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675648297857716*^9, 3.6756483630660057`*^9}, 
   3.675648454638584*^9, 3.675702984736863*^9, {3.67589080409908*^9, 
   3.675890831274033*^9}, {3.67742655090767*^9, 3.677426553274468*^9}}],

Cell["\<\
Without selection the recursions for the change in the frequencies are\
\>", "Text",
 CellChangeTimes->{{3.6757032054455214`*^9, 3.6757032697493563`*^9}, {
  3.6757098202812138`*^9, 3.675709824765788*^9}, {3.6757117765596933`*^9, 
  3.6757117850524673`*^9}, {3.675711818872109*^9, 3.6757118199810133`*^9}, {
  3.676719491260041*^9, 3.676719499308044*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs0", "=", 
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", "frequenciessub"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}]}]], "Input",
 CellChangeTimes->{{3.678751736367395*^9, 3.678751737467704*^9}, {
   3.678752209413887*^9, 3.678752212219976*^9}, 3.678752262803892*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf0"}], "+", "pXm0"}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"pXf0", "-", "pXm0", "-", 
      RowBox[{"pXf0", " ", "r"}], "+", 
      RowBox[{"pYm0", " ", "r"}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"pXf0", "-", "pYm0"}], ")"}], " ", "r"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.67875164051635*^9, {3.678751716032783*^9, 3.6787517378070927`*^9}, 
   3.6787520627432127`*^9, 3.678752212888122*^9, 3.6787523426840563`*^9, 
   3.6787534142533073`*^9, 3.678763399028235*^9, 3.6787637498048763`*^9, 
   3.6787649279812727`*^9, 3.678769190501109*^9, 3.67993779987945*^9, 
   3.681790093930011*^9, 3.681790177016839*^9, 3.6817903134721537`*^9, 
   3.681790666763077*^9, 3.6818910310375347`*^9, 3.681891176521256*^9, 
   3.681897653546867*^9, 3.682049536847906*^9, 3.682133260044132*^9, 
   3.682144710656866*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675709831409095*^9, 3.6757098343025913`*^9}, {
  3.675710744701475*^9, 3.675710745621426*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"differenceEqs0", "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"pYm0", ",", "pXm0"}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675709931730151*^9, 3.675709948227565*^9}, 
   3.675889715650866*^9, {3.6758903329476337`*^9, 3.675890333531021*^9}, {
   3.675890856683935*^9, 3.6758908599323187`*^9}, {3.678751782137336*^9, 
   3.678751811045862*^9}, 3.678753423267188*^9, {3.6817902045515413`*^9, 
   3.6817902078071213`*^9}, 3.681790677257793*^9, {3.681790714315344*^9, 
   3.6817907157750397`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"pYm0", "\[Rule]", "pXf0"}], ",", 
   RowBox[{"pXm0", "\[Rule]", "pXf0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6757098363525476`*^9, {3.6757099323567266`*^9, 3.675709948639193*^9}, 
   3.675727587389184*^9, 3.675785430130021*^9, 3.67578825590738*^9, 
   3.675889716378837*^9, 3.6758897866812677`*^9, {3.67589020611733*^9, 
   3.675890228462432*^9}, 3.675890334827342*^9, {3.675890851304111*^9, 
   3.675890860292238*^9}, 3.675897787493493*^9, 3.676652896317733*^9, 
   3.676719506219842*^9, 3.676730785030355*^9, 3.676747313194071*^9, 
   3.677426559438837*^9, 3.677594780023625*^9, 3.677957827657529*^9, 
   3.6782088645287457`*^9, 3.678542901403359*^9, 3.678546799300796*^9, {
   3.678751779484501*^9, 3.678751811553813*^9}, 3.67875206282722*^9, 
   3.67875221532375*^9, 3.6787523427641783`*^9, {3.678753416169854*^9, 
   3.678753423756329*^9}, 3.6787633990548487`*^9, 3.678763749842856*^9, 
   3.678764928017548*^9, 3.6787691905324583`*^9, 3.679937799964304*^9, {
   3.6817901817371817`*^9, 3.681790208510619*^9}, 3.681790313605155*^9, {
   3.681790666911725*^9, 3.681790677661216*^9}, 3.681790716129882*^9, 
   3.681891031269878*^9, 3.6818911789722967`*^9, 3.681897653588698*^9, 
   3.68204953688428*^9, 3.682133260085647*^9, 3.682144710692371*^9}]
}, Open  ]],

Cell["\<\
So, with no selection, the equilibrium frequency of A in each gamete/pollen \
type is equal (and we call this pA).\
\>", "Text",
 CellChangeTimes->{{3.675703427939505*^9, 3.6757035626138153`*^9}, {
   3.675706719194449*^9, 3.675706765062245*^9}, 3.67570996472328*^9, {
   3.6757107664993973`*^9, 3.675710849444377*^9}}],

Cell["\<\
Now, looking at only the first order selection terms, the recursions for the \
change in frequency of A in each gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.67570356712366*^9, 3.675703572187316*^9}, {
  3.67570609431063*^9, 3.675706097287983*^9}, {3.6757069069525433`*^9, 
  3.6757069072532797`*^9}, {3.67571091918222*^9, 3.6757109367564697`*^9}, {
  3.675711772412171*^9, 3.67571177325072*^9}, {3.675716463608975*^9, 
  3.67571647265489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
      ",", "\[Epsilon]", ",", "Factor"}], "]"}], "/.", 
    RowBox[{"pXf0", "\[Rule]", "pA"}]}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757068495866413`*^9, 3.6757068907711554`*^9}, {
   3.6757069302403297`*^9, 3.675706982461239*^9}, {3.675707087605297*^9, 
   3.6757071228419533`*^9}, {3.67570718969317*^9, 3.675707319107386*^9}, {
   3.675707511314725*^9, 3.675707512612761*^9}, {3.675710885258552*^9, 
   3.675710885357044*^9}, {3.675711221036006*^9, 3.675711227798399*^9}, {
   3.675788237526182*^9, 3.6757882495037823`*^9}, {3.67588983758741*^9, 
   3.675889846791771*^9}, {3.675890066524867*^9, 3.67589008440499*^9}, {
   3.675890872602395*^9, 3.6758908784129057`*^9}, 3.675891388889962*^9, 
   3.675897774490415*^9, 3.6774265727397633`*^9, {3.678752346006524*^9, 
   3.678752347228713*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf1"}], "+", "pXm1", "-", 
      RowBox[{"2", " ", "pA", " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{"2", " ", "pA", " ", 
       SubscriptBox["h", "female"], " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["h", "female"], " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["h", "female"], " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      RowBox[{"pA", " ", 
       SubscriptBox["sHap", "female"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "female"]}], "-", 
      RowBox[{"pA", " ", 
       SubscriptBox["sHap", "male"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "male"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{"pXf1", "-", "pXm1", "-", 
      RowBox[{"pXf1", " ", "r"}], "+", 
      RowBox[{"pYm1", " ", "r"}], "-", 
      RowBox[{"pA", " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"pA", " ", 
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      RowBox[{"pA", " ", 
       SubscriptBox["sHap", "female"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "female"]}], "+", 
      RowBox[{"pA", " ", "r", " ", 
       SubscriptBox["sHap", "female"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", 
       SubscriptBox["sHap", "female"]}], "-", 
      RowBox[{"pA", " ", "r", " ", 
       SubscriptBox["sHap", "male"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", 
       SubscriptBox["sHap", "male"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pXf1", " ", "r"}], "-", 
      RowBox[{"pYm1", " ", "r"}], "-", 
      RowBox[{"pA", " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"pA", " ", 
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      RowBox[{"pA", " ", "r", " ", 
       SubscriptBox["sHap", "female"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", 
       SubscriptBox["sHap", "female"]}], "-", 
      RowBox[{"pA", " ", 
       SubscriptBox["sHap", "male"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "male"]}], "+", 
      RowBox[{"pA", " ", "r", " ", 
       SubscriptBox["sHap", "male"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", 
       SubscriptBox["sHap", "male"]}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675706852317442*^9, 3.675706918829287*^9}, {
   3.675706950931774*^9, 3.675706982932413*^9}, {3.6757070910767508`*^9, 
   3.675707123327277*^9}, {3.6757071925330353`*^9, 3.675707319486848*^9}, 
   3.675707513296742*^9, 3.67570768217498*^9, {3.675710857628578*^9, 
   3.675710885875184*^9}, {3.675711222477412*^9, 3.67571122814371*^9}, 
   3.67572758892033*^9, 3.675785431200643*^9, 3.6757882566822844`*^9, {
   3.6758898385316772`*^9, 3.675889853071372*^9}, 3.67589008578434*^9, 
   3.675890878782188*^9, 3.6758913896085997`*^9, 3.675897788776071*^9, 
   3.676652896382719*^9, 3.676719670536849*^9, 3.676730785076564*^9, 
   3.676747313246613*^9, {3.677426569551004*^9, 3.677426573382222*^9}, 
   3.677426845387473*^9, 3.677594780245098*^9, 3.6779578277133617`*^9, 
   3.678208864583046*^9, 3.678542901470283*^9, 3.678546799332457*^9, 
   3.67875235287332*^9, 3.67875342792347*^9, 3.678763399188438*^9, 
   3.678763749972834*^9, 3.678764928153727*^9, 3.678769190664701*^9, 
   3.679937800139977*^9, 3.6817903137542667`*^9, 3.681790666984543*^9, 
   3.681790718133628*^9, 3.6818910339655*^9, 3.681891180964037*^9, 
   3.6818976536741257`*^9, 3.682049536979245*^9, 3.682133260162579*^9, 
   3.6821447107713137`*^9}]
}, Open  ]],

Cell["\<\
And we can solve for the two of the first order differences and the mean \
frequency of A\
\>", "Text",
 CellChangeTimes->{{3.678752531664937*^9, 3.678752562395914*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"realsol", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "\[Equal]", "0"}], "/.", 
       RowBox[{"pXm1", "\[Rule]", 
        RowBox[{"dpAXmXf", "+", "pXf1"}]}]}], "/.", 
      RowBox[{"pYm1", "\[Rule]", 
       RowBox[{"dpAYmXf", "+", "pXf1"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"dpAXmXf", ",", "dpAYmXf", ",", "pA"}], "}"}]}], "]"}], "//", 
   "Factor"}]}]], "Input",
 CellChangeTimes->{{3.678752380284935*^9, 3.678752415079105*^9}, {
  3.678752448870285*^9, 3.6787525243231792`*^9}, {3.678766520981015*^9, 
  3.678766522387198*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpAXmXf", "\[Rule]", "0"}], ",", 
     RowBox[{"dpAYmXf", "\[Rule]", "0"}], ",", 
     RowBox[{"pA", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpAXmXf", "\[Rule]", "0"}], ",", 
     RowBox[{"dpAYmXf", "\[Rule]", "0"}], ",", 
     RowBox[{"pA", "\[Rule]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpAXmXf", "\[Rule]", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["sDip", "female"]}], "+", 
            RowBox[{
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"]}], "-", 
            SubscriptBox["sDip", "male"], "+", 
            RowBox[{
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"]}], "-", 
            SubscriptBox["sHap", "female"], "-", 
            SubscriptBox["sHap", "male"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"]}], "+", 
            RowBox[{
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"]}], "+", 
            SubscriptBox["sHap", "female"], "+", 
            SubscriptBox["sHap", "male"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sDip", "male"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sDip", "male"]}], "-", 
            RowBox[{
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "female"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "female"]}], "+", 
            RowBox[{
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "female"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "female"]}], "-", 
            RowBox[{
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "male"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "male"]}], "+", 
            RowBox[{
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "male"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "male"]}]}], ")"}]}], ")"}], "/", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["sDip", "female"]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "female"], " ", 
            SubscriptBox["sDip", "female"]}], "-", 
           SubscriptBox["sDip", "male"], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "male"], " ", 
            SubscriptBox["sDip", "male"]}]}], ")"}], "3"]}]}]}], ",", 
     RowBox[{"dpAYmXf", "\[Rule]", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["sDip", "female"]}], "+", 
            RowBox[{
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"]}], "-", 
            SubscriptBox["sDip", "male"], "+", 
            RowBox[{
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"]}], "-", 
            SubscriptBox["sHap", "female"], "-", 
            SubscriptBox["sHap", "male"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"]}], "+", 
            RowBox[{
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"]}], "+", 
            SubscriptBox["sHap", "female"], "+", 
            SubscriptBox["sHap", "male"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sDip", "male"]}], "-", 
            RowBox[{
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sDip", "male"]}], "-", 
            RowBox[{"r", " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "female"]}], "+", 
            RowBox[{"2", " ", "r", " ", 
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "female"]}], "+", 
            RowBox[{
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "female"]}], "-", 
            RowBox[{"r", " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "female"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "female"]}], "+", 
            RowBox[{"2", " ", "r", " ", 
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "female"]}], "-", 
            RowBox[{
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "male"]}], "+", 
            RowBox[{"r", " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "male"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "male"]}], "-", 
            RowBox[{"2", " ", "r", " ", 
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "male"]}], "+", 
            RowBox[{"r", " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "male"]}], "-", 
            RowBox[{"2", " ", "r", " ", 
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "male"]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"r", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SubscriptBox["sDip", "female"]}], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["h", "female"], " ", 
              SubscriptBox["sDip", "female"]}], "-", 
             SubscriptBox["sDip", "male"], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["h", "male"], " ", 
              SubscriptBox["sDip", "male"]}]}], ")"}], "3"]}], ")"}]}]}]}], 
     ",", 
     RowBox[{"pA", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["sDip", "female"]}], "+", 
        RowBox[{
         SubscriptBox["h", "female"], " ", 
         SubscriptBox["sDip", "female"]}], "-", 
        SubscriptBox["sDip", "male"], "+", 
        RowBox[{
         SubscriptBox["h", "male"], " ", 
         SubscriptBox["sDip", "male"]}], "-", 
        SubscriptBox["sHap", "female"], "-", 
        SubscriptBox["sHap", "male"]}], 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["sDip", "female"]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["h", "female"], " ", 
         SubscriptBox["sDip", "female"]}], "-", 
        SubscriptBox["sDip", "male"], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["h", "male"], " ", 
         SubscriptBox["sDip", "male"]}]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.678752482888706*^9, 3.678752493868231*^9}, 
   3.6787525257014627`*^9, 3.678753430914579*^9, 3.678763399415782*^9, 
   3.6787637502158213`*^9, 3.678764928395048*^9, 3.678766524870788*^9, 
   3.6787691909696217`*^9, 3.679937800442492*^9, 3.6817903138543177`*^9, {
   3.681790667017806*^9, 3.6817907228467083`*^9}, 3.68189115135784*^9, 
   3.68189118399726*^9, 3.681897653939054*^9, 3.682049537294879*^9, 
   3.68213326045788*^9, 3.682144711078505*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Resident stability (weak selection) [slow, do not need to re-run]\
\>", "Section",
 CellChangeTimes->{{3.675728118153309*^9, 3.6757281301025343`*^9}, {
   3.675898152172256*^9, 3.675898162531384*^9}, {3.676682354127939*^9, 
   3.676682359443681*^9}, {3.677430416430501*^9, 3.677430416814169*^9}, 
   3.677430777539423*^9, 3.678768528895612*^9, {3.68189093685081*^9, 
   3.681890938134719*^9}, {3.682133717615588*^9, 3.6821337193774347`*^9}, {
   3.682144709802514*^9, 3.682144713501424*^9}, {3.6821478918842087`*^9, 
   3.6821478925808697`*^9}}],

Cell["\<\
Here we use linear stability analysis to examine when the resident \
equilibrium (i.e., no mutants) derived above is stable.\
\>", "Text",
 CellChangeTimes->{{3.676720746264163*^9, 3.676720791609645*^9}}],

Cell["\<\
The Jacobian for the residents is (this takes a couple minutes)\
\>", "Text",
 CellChangeTimes->{{3.676720780698885*^9, 3.676720799664399*^9}, {
  3.678764310691422*^9, 3.6787643161574373`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              SubscriptBox["fHapNext", 
               RowBox[{"X", ",", "y", ",", "M", ",", "female"}]], ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"{", 
                 RowBox[{"A", ",", "a"}], "}"}]}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               SubscriptBox["fHapNext", 
                RowBox[{"x", ",", "y", ",", "M", ",", "male"}]], ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"{", 
                  RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", 
                 RowBox[{"{", 
                  RowBox[{"A", ",", "a"}], "}"}]}], "}"}]}], "]"}], "//", 
             "Flatten"}]}], "]"}], "/.", "sumsex"}], "/.", "invXY"}], "/.", 
        "pseg0"}], "/.", "pseg1"}], "/.", "pseg2"}], "/.", "pseg3"}], "/.", 
    "pseg4"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"matIntFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"eqs", ",", 
          SubscriptBox["fHap", 
           RowBox[{"X", ",", "A", ",", "M", ",", "female"}]]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqs", ",", 
          SubscriptBox["fHap", 
           RowBox[{"X", ",", "a", ",", "M", ",", "female"}]]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqs", ",", 
          SubscriptBox["fHap", 
           RowBox[{"X", ",", "A", ",", "M", ",", "male"}]]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqs", ",", 
          SubscriptBox["fHap", 
           RowBox[{"X", ",", "a", ",", "M", ",", "male"}]]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqs", ",", 
          SubscriptBox["fHap", 
           RowBox[{"Y", ",", "A", ",", "M", ",", "male"}]]}], "]"}], ",", 
        "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqs", ",", 
          SubscriptBox["fHap", 
           RowBox[{"Y", ",", "a", ",", "M", ",", "male"}]]}], "]"}]}], 
       "\[IndentingNewLine]", "}"}], "]"}], "/.", "subequil"}], "//", 
    "Factor"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.681891260839473*^9, 3.68189141173361*^9}}],

Cell["From this we can derive the characteristic polynomial", "Text",
 CellChangeTimes->{{3.67672101846877*^9, 3.676721031016712*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyIntFull", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matIntFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "6", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675790963788534*^9, 3.6757909758461533`*^9}, {
  3.678763074902429*^9, 3.678763075065971*^9}, {3.6787641836824837`*^9, 
  3.678764184155055*^9}}],

Cell["\<\
Instead of examining when the non-trivial equilibrium (A not fixed or lost) \
is stable we will look for when the trivial equilibria (loss or fixation of \
A) are unstable.\
\>", "Text",
 CellChangeTimes->{{3.676721042012188*^9, 3.676721126032257*^9}}],

Cell["\<\
When A is fixed the characteristic polynomial with no selection gives \
eigenvalues\
\>", "Text",
 CellChangeTimes->{{3.676721132511098*^9, 3.6767211423017263`*^9}, {
  3.676721178371427*^9, 3.676721218756505*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"charpolyInt1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"charpolyIntFull", "/.", 
      RowBox[{"pXm", "\[Rule]", "1"}]}], "/.", 
     RowBox[{"pXf", "\[Rule]", "1"}]}], "/.", 
    RowBox[{"pYm", "\[Rule]", "1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyInt1", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
   "Factor"}], "//", "Flatten"}]}], "Input",
 CellChangeTimes->{{3.676721152602626*^9, 3.6767211696108313`*^9}, {
   3.676721653986638*^9, 3.676721654917102*^9}, 3.678763104967507*^9, {
   3.678763145950407*^9, 3.678763146936859*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}], "-", 
       SqrtBox[
        RowBox[{"9", "-", 
         RowBox[{"20", " ", "r"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}], "+", 
       SqrtBox[
        RowBox[{"9", "-", 
         RowBox[{"20", " ", "r"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.676721170257844*^9, 3.676721655215622*^9, 3.676730789272407*^9, 
   3.677430333671691*^9, 3.677608209896048*^9, 3.677609085129491*^9, 
   3.677954754976882*^9, 3.6780283302178164`*^9, 3.678542695068201*^9, 
   3.678544350475233*^9, 3.6785534771527643`*^9, {3.678763086474922*^9, 
   3.678763105806613*^9}, 3.678763147295204*^9, 3.678764294518174*^9, 
   3.679938038784348*^9, 3.6818914653253813`*^9, 3.68204958152876*^9}]
}, Open  ]],

Cell["\<\
and \[Lambda]=1 is the leading eigenvalue.\
\>", "Text",
 CellChangeTimes->{{3.676721226033328*^9, 3.676721241288987*^9}}],

Cell["With weak selection first order term in the eigenvalues is", "Text",
 CellChangeTimes->{{3.676721201810499*^9, 3.6767212071148663`*^9}, {
  3.676721245455948*^9, 3.6767212760370197`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"charpolyInt1", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Lambda]", "\[Rule]", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Delta]\[Lambda]1fix", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}], "//",
    "Flatten"}]}]}], "Input",
 CellChangeTimes->{{3.6757905419305773`*^9, 3.67579059667633*^9}, {
  3.6757909951816072`*^9, 3.6757909952509527`*^9}, {3.676721441707623*^9, 
  3.6767214458346786`*^9}, {3.676721535301393*^9, 3.676721554454569*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["h", "female"], " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      SubscriptBox["sHap", "female"], "+", 
      SubscriptBox["sHap", "male"]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.676721554821319*^9, 3.676730789299614*^9, 
  3.6774303337063103`*^9, 3.677608209939247*^9, 3.6776090851739197`*^9, 
  3.677954755005115*^9, 3.67802833026289*^9, 3.678542695110661*^9, 
  3.678544350508951*^9, 3.6785534771809893`*^9, 3.678764340415372*^9, 
  3.679938038827969*^9, 3.681891469022283*^9, 3.6820495815687017`*^9}]
}, Open  ]],

Cell["\<\
And so the fixation of A is unstable when this expression is positive.\
\>", "Text",
 CellChangeTimes->{{3.676721308204175*^9, 3.676721335598743*^9}}],

Cell["\<\
When A is lost the characteristic polynomial with no selection gives \
eigenvalues\
\>", "Text",
 CellChangeTimes->{{3.6767213474719133`*^9, 3.676721350576425*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"charpolyInt0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"charpolyIntFull", "/.", 
      RowBox[{"pXm", "\[Rule]", "0"}]}], "/.", 
     RowBox[{"pXf", "\[Rule]", "0"}]}], "/.", 
    RowBox[{"pYm", "\[Rule]", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyInt0", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.675789475257841*^9, 3.675789495224863*^9}, {
   3.675790419784018*^9, 3.675790436109337*^9}, {3.675790707473653*^9, 
   3.6757907121912107`*^9}, 3.675790981141562*^9, {3.675791011580246*^9, 
   3.6757910160572977`*^9}, {3.676721363672165*^9, 3.676721374617257*^9}, {
   3.676721452992544*^9, 3.676721455943983*^9}, {3.676721499845089*^9, 
   3.676721500929879*^9}, 3.676721543612586*^9, 3.678764370215426*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}], "-", 
       SqrtBox[
        RowBox[{"9", "-", 
         RowBox[{"20", " ", "r"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}], "+", 
       SqrtBox[
        RowBox[{"9", "-", 
         RowBox[{"20", " ", "r"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6767213765070133`*^9, 3.676721456161497*^9, 
  3.676721501263238*^9, 3.676721544164434*^9, 3.676730789335022*^9, 
  3.677430333743013*^9, 3.677608209980873*^9, 3.677609085209072*^9, 
  3.677954755059959*^9, 3.678028330301626*^9, 3.678542695160199*^9, 
  3.678544350541535*^9, 3.678553477213879*^9, 3.6787643713788443`*^9, 
  3.679938038868807*^9, 3.681891477103898*^9, 3.682049581624468*^9}]
}, Open  ]],

Cell["With weak selection first order term in the eigenvalues is", "Text",
 CellChangeTimes->{3.676721390427958*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"charpolyInt0", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Lambda]", "\[Rule]", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Delta]\[Lambda]1loss", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}], "//",
    "Flatten"}]}]}], "Input",
 CellChangeTimes->{{3.6757905419305773`*^9, 3.67579059667633*^9}, {
   3.6757909951816072`*^9, 3.6757909952509527`*^9}, {3.675791030843678*^9, 
   3.6757910309227667`*^9}, {3.67672149489704*^9, 3.676721496462256*^9}, 
   3.676721546110467*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{
       SubscriptBox["h", "female"], " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      SubscriptBox["sDip", "male"], "+", 
      RowBox[{
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      SubscriptBox["sHap", "female"], "-", 
      SubscriptBox["sHap", "male"]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.675799455916547*^9, 3.6767214970605583`*^9, 
  3.6767215468807373`*^9, 3.67673078936864*^9, 3.677430333766693*^9, 
  3.677608210022337*^9, 3.677609085253159*^9, 3.677954755089143*^9, 
  3.6780283303292913`*^9, 3.678542695210258*^9, 3.678544350574987*^9, 
  3.678553477245347*^9, 3.678764374849228*^9, 3.6799380389071827`*^9, 
  3.681891479187998*^9, 3.68204958168464*^9}]
}, Open  ]],

Cell["\<\
And so the loss of A is unstable when this expression is positive.\
\>", "Text",
 CellChangeTimes->{{3.6767213979123573`*^9, 3.6767214015330763`*^9}}],

Cell["\<\
Combining the two results, the protected polymorphism (non-trivial \
equilibrium) requires that \
\>", "Text",
 CellChangeTimes->{{3.67579927992915*^9, 3.675799368289077*^9}, {
  3.676721410316127*^9, 3.676721427192442*^9}, {3.676721618600268*^9, 
  3.6767216187542257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stabconds", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]\[Lambda]1", "/.", "\[Delta]\[Lambda]1fix"}], ")"}], 
      "<", "0"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]\[Lambda]1", "/.", "\[Delta]\[Lambda]1loss"}], ")"}], 
      "<", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678037516961389*^9, 3.678037532291551*^9}, {
  3.678764404869893*^9, 3.678764446859511*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["\<\
Sex chromosome turnover (weak selection) [slow]\
\>", "Section",
 CellChangeTimes->{{3.675898184242074*^9, 3.675898192657653*^9}, {
   3.6766823621496687`*^9, 3.676682365402493*^9}, {3.676682824936212*^9, 
   3.676682839700041*^9}, 3.676721662499631*^9, {3.676726557160334*^9, 
   3.676726564889889*^9}, 3.677427015726658*^9, {3.677439500021902*^9, 
   3.67743950207469*^9}, {3.678543990089929*^9, 3.678543990274122*^9}, {
   3.678768500112903*^9, 3.678768500298716*^9}, 3.6787685305671663`*^9, {
   3.681890954195335*^9, 3.6818909696636047`*^9}, {3.682133713824585*^9, 
   3.682133715488268*^9}}],

Cell["\<\
Here we are interested in the ability of a rare mutation at the modifier \
locus to invade the non-mutant resident population at equilibrium.\
\>", "Text",
 CellChangeTimes->{{3.676720412976615*^9, 3.676720459024542*^9}, {
  3.676720582555089*^9, 3.676720586782763*^9}, {3.676721687580276*^9, 
  3.676721687767557*^9}, {3.6767265489351683`*^9, 3.676726549465045*^9}, {
  3.678764528946957*^9, 3.678764537543582*^9}, {3.68189097671701*^9, 
  3.681890993092064*^9}}],

Cell["The Jacobian for the mutants is", "Text",
 CellChangeTimes->{{3.6758991929846497`*^9, 3.67589926406907*^9}, {
   3.67589934114139*^9, 3.6758993427645893`*^9}, {3.675900036907325*^9, 
   3.6759000483741083`*^9}, {3.676720403037026*^9, 3.676720404249701*^9}, {
   3.6767205532682467`*^9, 3.676720568189563*^9}, {3.676720627629078*^9, 
   3.676720646673503*^9}, 3.678764550116784*^9, {3.67876518531907*^9, 
   3.678765192344109*^9}, {3.6787654012127323`*^9, 3.6787654024110203`*^9}, {
   3.678765517503551*^9, 3.678765517693905*^9}, {3.681791115442161*^9, 
   3.681791118393203*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqsmut", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"ParallelTable", "[", 
            RowBox[{
             SubscriptBox["fHapNext", 
              RowBox[{"x", ",", "y", ",", "m", ",", "sex"}]], ",", 
             RowBox[{"{", 
              RowBox[{"sex", ",", 
               RowBox[{"{", 
                RowBox[{"male", ",", "female"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"{", 
                RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"{", 
                RowBox[{"X", ",", "Y"}], "}"}]}], "}"}]}], "]"}], "/.", 
           "sumsex"}], "/.", "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.",
        "pseg2"}], "/.", "pseg3"}], "/.", "pseg4"}], "//", "Flatten"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"matExtFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"Flatten", "[", 
       RowBox[{
        RowBox[{"ParallelTable", "[", 
         RowBox[{
          RowBox[{"D", "[", 
           RowBox[{"eqsmut", ",", 
            SubscriptBox["fHap", 
             RowBox[{"x", ",", "y", ",", "m", ",", "sex"}]]}], "]"}], ",", 
          RowBox[{"{", 
           RowBox[{"sex", ",", 
            RowBox[{"{", 
             RowBox[{"male", ",", "female"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"y", ",", 
            RowBox[{"{", 
             RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
          RowBox[{"{", 
           RowBox[{"x", ",", 
            RowBox[{"{", 
             RowBox[{"X", ",", "Y"}], "}"}]}], "}"}]}], "]"}], ",", "2"}], 
       "]"}], "]"}], "/.", "subequil"}], "//", "Factor"}]}], ";"}]}], "Input",\

 CellChangeTimes->{{3.678764564891323*^9, 3.678764567242013*^9}, {
   3.678764626820463*^9, 3.6787646270965*^9}, {3.678764748875876*^9, 
   3.678764756289021*^9}, {3.678764981493416*^9, 3.678764996775971*^9}, {
   3.678765027830419*^9, 3.678765029600572*^9}, {3.678765158142272*^9, 
   3.678765175722975*^9}, 3.679940744341713*^9, {3.681790991236353*^9, 
   3.6817910929323387`*^9}, 3.6817911344850187`*^9, {3.681897697148897*^9, 
   3.6818976982011127`*^9}, {3.6820495781165867`*^9, 3.682049583553007*^9}}],

Cell["Giving characteristic polynomial", "Text",
 CellChangeTimes->{{3.6799407517772408`*^9, 3.679940767791992*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyExt", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matExtFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "8", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6758993091981916`*^9, 3.6758993092948217`*^9}, {
  3.677427680774026*^9, 3.6774276809783897`*^9}, {3.678765570174028*^9, 
  3.678765571504396*^9}}],

Cell["Solving for the eigenvalues with no selection gives", "Text",
 CellChangeTimes->{{3.676720669392806*^9, 3.676720678062379*^9}, {
  3.678766034361598*^9, 3.6787660366765347`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyExt", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.678765640643032*^9, 3.678765641722434*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{"1", "-", "R"}]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "R"}], ")"}]}]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{"1", "-", "r", "-", "R", "+", 
     RowBox[{"2", " ", "r", " ", "R"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.679940268408307*^9, 3.681791125175996*^9, 
  3.6817912904181232`*^9, 3.681897678037388*^9, 3.6818978610140123`*^9, 
  3.6820497316138678`*^9, 3.682133520244061*^9, 3.682144967179885*^9}]
}, Open  ]],

Cell["\<\
On this order the leading eigenvalue is \[Lambda]=1.\
\>", "Text",
 CellChangeTimes->{{3.676722106551478*^9, 3.6767221217139177`*^9}}],

Cell["On the first order the eiganvalue is", "Text",
 CellChangeTimes->{{3.676722149076614*^9, 3.676722183499652*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
          RowBox[{"\[Lambda]", "\[Rule]", 
           RowBox[{"1", "+", 
            RowBox[{"\[Delta]\[Lambda]", "*", "\[Epsilon]"}]}]}]}], "/.", 
         "frequenciessub"}], "/.", "sol0"}], "/.", 
       RowBox[{"pXf0", "\[Rule]", "pA"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{{3.675900203768065*^9, 3.67590021603231*^9}, {
   3.675900300123855*^9, 3.675900338446018*^9}, 3.675900430018834*^9, {
   3.676722303506366*^9, 3.6767223232575293`*^9}, 3.676723478586155*^9, 
   3.676723712223565*^9, {3.677427876523703*^9, 3.677427886199647*^9}, 
   3.6774395304086657`*^9, {3.677964777073876*^9, 3.677964783312694*^9}, 
   3.67876574278687*^9, {3.678765813083859*^9, 3.6787658141807957`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]", "\[Rule]", "0"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.679940325616682*^9, 3.681791452846795*^9, 
  3.6818976780691843`*^9, 3.681897955622849*^9, 3.682133618737681*^9, 
  3.6821450651729116`*^9}]
}, Open  ]],

Cell["And on the 2nd order (this takes a few minutes)", "Text",
 CellChangeTimes->{{3.677430204742441*^9, 3.677430225667992*^9}, {
  3.677965495156917*^9, 3.677965496819395*^9}, {3.678765896404023*^9, 
  3.678765902475174*^9}, {3.678766043948579*^9, 3.678766044008556*^9}, {
  3.678769767354095*^9, 3.678769771966827*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
            RowBox[{"\[Lambda]", "\[Rule]", 
             RowBox[{"1", "+", 
              RowBox[{"\[Delta]\[Lambda]2", "*", 
               RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], "/.", 
         RowBox[{"pXf0", "\[Rule]", "pA"}]}], "/.", 
        RowBox[{"pXm1", "\[Rule]", 
         RowBox[{"dpAXmXf", "+", "pXf1"}]}]}], "/.", 
       RowBox[{"pYm1", "\[Rule]", 
        RowBox[{"dpAYmXf", "+", "pXf1"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"lambda2diffs", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"\[Delta]\[Lambda]2", "/.", "%"}], ",", 
    RowBox[{"{", 
     RowBox[{"dpAXmXf", ",", "dpAYmXf"}], "}"}], ",", "Simplify"}], 
   "]"}]}]}], "Input",
 CellChangeTimes->{{3.677439732826703*^9, 3.677439769906844*^9}, {
  3.677872519052596*^9, 3.6778725192298527`*^9}, {3.677949340104127*^9, 
  3.6779493407177973`*^9}, {3.6779558471459913`*^9, 3.677955905730049*^9}, {
  3.677955946486411*^9, 3.677955957804606*^9}, {3.677956005037593*^9, 
  3.67795604222084*^9}, {3.677964817435317*^9, 3.6779648948629827`*^9}, {
  3.678765906240861*^9, 3.6787659176812677`*^9}, {3.678765975309867*^9, 
  3.678766019296446*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", "dpAXmXf", " ", "k", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "pA", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
          SubscriptBox["h", "female"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      RowBox[{"2", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "pA", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
          SubscriptBox["h", "male"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"k", " ", 
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["sHap", "female"], "-", 
         SubscriptBox["sHap", "male"]}], ")"}]}]}], ")"}]}], "+", 
   RowBox[{"dpAYmXf", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SuperscriptBox["k", "2"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pA", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
          SubscriptBox["h", "female"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "k"}], ")"}], "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "-", "pA", "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
          SubscriptBox["h", "male"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      FractionBox[
       RowBox[{
        SuperscriptBox["k", "2"], " ", 
        SubscriptBox["sHap", "female"]}], "2"], "+", 
      SubscriptBox["sHap", "male"], "-", 
      RowBox[{"2", " ", "k", " ", 
       SubscriptBox["sHap", "male"]}], "+", 
      FractionBox[
       RowBox[{
        SuperscriptBox["k", "2"], " ", 
        SubscriptBox["sHap", "male"]}], "2"]}], ")"}]}], "-", 
   RowBox[{
    FractionBox["1", "R"], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pA"}], ")"}], " ", "pA", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        SuperscriptBox["k", "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{"1", "-", "pA", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
            SubscriptBox["h", "female"]}]}], ")"}], "2"], " ", 
        SubsuperscriptBox["sDip", "female", "2"]}], "+", 
       RowBox[{
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "k"}], ")"}], "2"], " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pA", "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
            SubscriptBox["h", "male"]}]}], ")"}], "2"], " ", 
        SubsuperscriptBox["sDip", "male", "2"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pA", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
           SubscriptBox["h", "male"]}]}], ")"}], " ", 
        SubscriptBox["sDip", "male"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "R"}], "+", 
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "2"}], "+", 
                RowBox[{"3", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
           SubscriptBox["sHap", "female"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{"2", "-", 
                RowBox[{"3", " ", "R"}]}], ")"}]}], "+", "R"}], ")"}], " ", 
           SubscriptBox["sHap", "male"]}]}], ")"}]}], "-", 
       RowBox[{"k", " ", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pA", "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
           SubscriptBox["h", "female"]}]}], ")"}], " ", 
        SubscriptBox["sDip", "female"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{"1", "-", "pA", "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"2", " ", "pA"}]}], ")"}], " ", 
              SubscriptBox["h", "male"]}]}], ")"}], " ", 
           SubscriptBox["sDip", "male"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "k"}], "-", 
             RowBox[{"2", " ", "R"}], "+", 
             RowBox[{"3", " ", "k", " ", "R"}]}], ")"}], " ", 
           SubscriptBox["sHap", "female"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", 
             RowBox[{"2", " ", "k"}], "+", 
             RowBox[{"2", " ", "R"}], "-", 
             RowBox[{"3", " ", "k", " ", "R"}]}], ")"}], " ", 
           SubscriptBox["sHap", "male"]}]}], ")"}]}], "-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"k", " ", 
           SubscriptBox["sHap", "female"]}], "-", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
           SubscriptBox["sHap", "male"]}]}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "R"}], "+", 
             RowBox[{"k", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", 
                RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
           SubscriptBox["sHap", "female"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "k", "+", "R", "-", 
             RowBox[{"2", " ", "k", " ", "R"}]}], ")"}], " ", 
           SubscriptBox["sHap", "male"]}]}], ")"}]}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.6799407009622927`*^9, 3.681792161961009*^9, 
  3.6818976781093407`*^9, 3.6818986328085127`*^9, 3.6821343219473467`*^9, 
  3.6821457532837343`*^9}]
}, Open  ]],

Cell["Then we can put in all the differences", "Text",
 CellChangeTimes->{{3.6779655133565893`*^9, 3.677965517876515*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"tester", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"lambda2diffs", "/.", "weaksel"}], "/.", 
        RowBox[{"realsol", "[", 
         RowBox[{"[", "3", "]"}], "]"}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], 
    ",", 
    RowBox[{"{", 
     RowBox[{"dpAXmXf", ",", "dpAYmXf"}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.677956048352296*^9, 3.6779561551216288`*^9}, {
  3.677957309721977*^9, 3.6779573101974573`*^9}, {3.677964924472028*^9, 
  3.677964939369676*^9}, {3.678766496517172*^9, 3.678766497073032*^9}, {
  3.678766536740871*^9, 3.678766624413505*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["h", "female"]}], ")"}], " ", 
         SubscriptBox["sDip", "female"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           SubscriptBox["h", "male"]}], ")"}], " ", 
         SubscriptBox["sDip", "male"]}], "-", 
        SubscriptBox["sHap", "female"], "-", 
        SubscriptBox["sHap", "male"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["h", "female"], " ", 
         SubscriptBox["sDip", "female"]}], "+", 
        RowBox[{
         SubscriptBox["h", "male"], " ", 
         SubscriptBox["sDip", "male"]}], "+", 
        SubscriptBox["sHap", "female"], "+", 
        SubscriptBox["sHap", "male"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         SubscriptBox["sDip", "male"], " ", 
         SubscriptBox["sHap", "female"]}], "-", 
        RowBox[{
         SubscriptBox["h", "male"], " ", 
         SubscriptBox["sDip", "male"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["sDip", "female"], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["sHap", "female"]}]}], ")"}]}], "-", 
        RowBox[{
         SubscriptBox["sDip", "female"], " ", 
         SubscriptBox["sHap", "male"]}], "+", 
        RowBox[{
         SubscriptBox["h", "female"], " ", 
         SubscriptBox["sDip", "female"], " ", 
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["sDip", "male"], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["sHap", "male"]}]}], ")"}]}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"-", 
          SuperscriptBox["k", "2"]}], " ", "R", " ", 
         SubscriptBox["sDip", "female"], " ", 
         SubscriptBox["sHap", "female"]}], "+", 
        RowBox[{"2", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "female"], " ", 
         SubscriptBox["sHap", "female"]}], "-", 
        RowBox[{"2", " ", "r", " ", 
         SubscriptBox["sDip", "male"], " ", 
         SubscriptBox["sHap", "female"]}], "+", 
        RowBox[{"8", " ", "k", " ", "r", " ", 
         SubscriptBox["sDip", "male"], " ", 
         SubscriptBox["sHap", "female"]}], "-", 
        RowBox[{"8", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", 
         SubscriptBox["sDip", "male"], " ", 
         SubscriptBox["sHap", "female"]}], "+", 
        RowBox[{"2", " ", "R", " ", 
         SubscriptBox["sDip", "male"], " ", 
         SubscriptBox["sHap", "female"]}], "-", 
        RowBox[{"4", " ", "k", " ", "R", " ", 
         SubscriptBox["sDip", "male"], " ", 
         SubscriptBox["sHap", "female"]}], "+", 
        RowBox[{"3", " ", 
         SuperscriptBox["k", "2"], " ", "R", " ", 
         SubscriptBox["sDip", "male"], " ", 
         SubscriptBox["sHap", "female"]}], "-", 
        RowBox[{"8", " ", "k", " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "male"], " ", 
         SubscriptBox["sHap", "female"]}], "+", 
        RowBox[{"10", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "male"], " ", 
         SubscriptBox["sHap", "female"]}], "+", 
        RowBox[{"2", " ", "r", " ", 
         SubscriptBox["sDip", "female"], " ", 
         SubscriptBox["sHap", "male"]}], "-", 
        RowBox[{"8", " ", "k", " ", "r", " ", 
         SubscriptBox["sDip", "female"], " ", 
         SubscriptBox["sHap", "male"]}], "+", 
        RowBox[{"8", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", 
         SubscriptBox["sDip", "female"], " ", 
         SubscriptBox["sHap", "male"]}], "-", 
        RowBox[{"2", " ", "R", " ", 
         SubscriptBox["sDip", "female"], " ", 
         SubscriptBox["sHap", "male"]}], "+", 
        RowBox[{"4", " ", "k", " ", "R", " ", 
         SubscriptBox["sDip", "female"], " ", 
         SubscriptBox["sHap", "male"]}], "-", 
        RowBox[{"3", " ", 
         SuperscriptBox["k", "2"], " ", "R", " ", 
         SubscriptBox["sDip", "female"], " ", 
         SubscriptBox["sHap", "male"]}], "+", 
        RowBox[{"8", " ", "k", " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "female"], " ", 
         SubscriptBox["sHap", "male"]}], "-", 
        RowBox[{"10", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "female"], " ", 
         SubscriptBox["sHap", "male"]}], "+", 
        RowBox[{
         SuperscriptBox["k", "2"], " ", "R", " ", 
         SubscriptBox["sDip", "male"], " ", 
         SubscriptBox["sHap", "male"]}], "-", 
        RowBox[{"2", " ", 
         SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
         SubscriptBox["sDip", "male"], " ", 
         SubscriptBox["sHap", "male"]}], "-", 
        RowBox[{"2", " ", 
         SubscriptBox["h", "male"], " ", 
         SubscriptBox["sDip", "male"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", 
                 RowBox[{"4", " ", "k", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["k", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "k"}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["k", "2"]}]}], ")"}], " ", "R"}]}], ")"}], 
            " ", 
            SubscriptBox["sDip", "female"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "-", 
                 RowBox[{"4", " ", "k"}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["k", "2"]}]}], ")"}], " ", "R"}], "+", 
              RowBox[{"2", " ", "r", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", 
                 RowBox[{"4", " ", "k", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["k", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "4"}], "+", 
                    RowBox[{"5", " ", "R"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
            " ", 
            SubscriptBox["sHap", "female"]}], "+", 
           RowBox[{
            SuperscriptBox["k", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "r"}]}], ")"}], " ", "R", " ", 
            SubscriptBox["sHap", "male"]}]}], ")"}]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["h", "female"], " ", 
         SubscriptBox["sDip", "female"], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"r", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", 
                 RowBox[{"4", " ", "k", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", 
                 RowBox[{"4", " ", 
                  SuperscriptBox["k", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}]}], ")"}]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", "k"}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["k", "2"]}]}], ")"}], " ", "R"}]}], ")"}], 
            " ", 
            SubscriptBox["sDip", "male"]}], "+", 
           RowBox[{
            SuperscriptBox["k", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "-", 
              RowBox[{"2", " ", "r"}]}], ")"}], " ", "R", " ", 
            SubscriptBox["sHap", "female"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", "-", 
                 RowBox[{"4", " ", "k"}], "+", 
                 RowBox[{"3", " ", 
                  SuperscriptBox["k", "2"]}]}], ")"}], " ", "R"}], "+", 
              RowBox[{"2", " ", "r", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "-", 
                 RowBox[{"4", " ", "k", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", 
                 RowBox[{
                  SuperscriptBox["k", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "4"}], "+", 
                    RowBox[{"5", " ", "R"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
            " ", 
            SubscriptBox["sHap", "male"]}]}], ")"}]}]}], ")"}]}], ")"}], "/", 
    
    RowBox[{"(", 
     RowBox[{"2", " ", "r", " ", "R", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "female"]}]}], ")"}], " ", 
          SubscriptBox["sDip", "female"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "male"]}]}], ")"}], " ", 
          SubscriptBox["sDip", "male"]}]}], ")"}], "4"]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.679940701704034*^9, 3.6817921627895327`*^9, 
  3.681897678154975*^9, 3.681898633649233*^9, 3.682134322779213*^9, 
  3.682145754055648*^9}]
}, Open  ]],

Cell["\<\
Under some situations this reduces to (dividing by van Doorn and Kirkpatricks \
VA>0 and LA>0 when appropriate):\
\>", "Text",
 CellChangeTimes->{{3.6782235183632917`*^9, 3.678223526047543*^9}, {
   3.678767237224989*^9, 3.6787672562530613`*^9}, 3.6787676329422626`*^9, {
   3.6818908762272997`*^9, 3.681890879023048*^9}}],

Cell["\<\
a) dominant feminizer (neo-W) with no competition among eggs and free \
recombination with VS locus (and equal dominance coefficients)\
\>", "Text",
 CellChangeTimes->{{3.678767641048543*^9, 3.678767704745509*^9}, {
  3.678767741961824*^9, 3.67876775812893*^9}, {3.6818949736898727`*^9, 
  3.68189497636966*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"selFeminizer", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"tester", "/", 
          RowBox[{"(", 
           RowBox[{"pA", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], "/.", 
         RowBox[{"realsol", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
        RowBox[{
         SubscriptBox["h", "sex_"], "\[Rule]", "h"}]}], "/.", 
       RowBox[{"k", "\[Rule]", "1"}]}], "/.", 
      RowBox[{
       SubscriptBox["sHap", "female"], "\[Rule]", "0"}]}], "//", "Simplify"}],
     ",", 
    RowBox[{"{", 
     SubscriptBox["sHap", "male"], "}"}], ",", "FullSimplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6817915624851503`*^9, 3.681791592765374*^9}, 
   3.68179220101486*^9, 3.681792240309289*^9, {3.681792366135296*^9, 
   3.6817923670575867`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SubscriptBox["sDip", "female"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", "R"}], ")"}], " ", 
        
        SubscriptBox["sDip", "female"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "r"}]}], ")"}], " ", "R", " ", 
        SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
     SubsuperscriptBox["sHap", "male", "2"]}], 
    RowBox[{"2", " ", "r", " ", "R", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["sDip", "female"], "+", 
        SubscriptBox["sDip", "male"]}], ")"}], "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.681792162918845*^9, 3.681792205395542*^9, 
  3.681792240918569*^9, 3.681792393041031*^9, 3.681897678222867*^9, 
  3.68189863377087*^9, 3.682134322970417*^9, 3.682145754257168*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"2", " ", "r", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", "R"}], ")"}], " ", 
   SubscriptBox["sDip", "female"]}], "+", 
  RowBox[{
   RowBox[{"(", 
    RowBox[{
     RowBox[{"-", "1"}], "+", 
     RowBox[{"2", " ", "r"}]}], ")"}], " ", "R", " ", 
   SubscriptBox["sDip", "male"]}]}]], "Input"],

Cell["\<\
with free recombination between the VS and modifier locus this reduces to\
\>", "Text",
 CellChangeTimes->{{3.681792247857963*^9, 3.681792262556829*^9}, {
  3.681890842717184*^9, 3.6818908430696983`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"tester", "/", 
            RowBox[{"(", 
             RowBox[{"pA", 
              RowBox[{"(", 
               RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", "r"}]}], ")"}]}], "*", "r"}], "/.", 
         RowBox[{"realsol", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
        RowBox[{
         SubscriptBox["h", "sex_"], "\[Rule]", "h"}]}], "/.", 
       RowBox[{"k", "\[Rule]", "1"}]}], "/.", 
      RowBox[{
       SubscriptBox["sHap", "female"], "\[Rule]", "0"}]}], "/.", 
     RowBox[{"R", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}]}], "//", "Simplify"}], ",", 
   RowBox[{"{", 
    SubscriptBox["sHap", "male"], "}"}], ",", "FullSimplify"}], 
  "]"}]], "Input",
 CellChangeTimes->{{3.678767388729043*^9, 3.678767424977489*^9}, {
   3.678767455833724*^9, 3.678767476693883*^9}, {3.6787676344444513`*^9, 
   3.678767638280821*^9}, {3.681791586382462*^9, 3.681791601535267*^9}, 
   3.681792203264268*^9}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    SubscriptBox["sDip", "female"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["sDip", "female"]}], "+", 
      SubscriptBox["sDip", "male"]}], ")"}], " ", 
    SubsuperscriptBox["sHap", "male", "2"]}], 
   RowBox[{"2", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["sDip", "female"], "+", 
       SubscriptBox["sDip", "male"]}], ")"}], "2"]}]], "}"}]], "Output",
 CellChangeTimes->{{3.6787673973707323`*^9, 3.678767425483873*^9}, {
   3.678767458131782*^9, 3.678767484059939*^9}, 3.67877014514113*^9, 
   3.679938822587039*^9, 3.679940701764435*^9, 3.681792163018848*^9, 
   3.6817922072858458`*^9, 3.681897678278667*^9, 3.681898633819373*^9, 
   3.6821343230691547`*^9, 3.682145754281124*^9}]
}, Open  ]],

Cell["\<\
b) dominant masculinizer (neo-Y) with no competition among eggs  (and equal \
dominance coefficients)\
\>", "Text",
 CellChangeTimes->{{3.678767714495613*^9, 3.6787677285724154`*^9}, 
   3.6787677906306543`*^9, {3.681894979749877*^9, 3.681894981881654*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"selMasculinizer", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"tester", "/", 
          RowBox[{"(", 
           RowBox[{"pA", 
            RowBox[{"(", 
             RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], "/.", 
         RowBox[{"realsol", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
        RowBox[{
         SubscriptBox["h", "sex_"], "\[Rule]", "h"}]}], "/.", 
       RowBox[{"k", "\[Rule]", "0"}]}], "/.", 
      RowBox[{
       SubscriptBox["sHap", "female"], "\[Rule]", "0"}]}], "//", "Simplify"}],
     ",", 
    RowBox[{"{", 
     RowBox[{"sHap", "[", "male", "]"}], "}"}], ",", "FullSimplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.678767557893334*^9, 3.6787676242980013`*^9}, {
   3.681791610359789*^9, 3.68179162291819*^9}, {3.681792209906988*^9, 
   3.681792211186517*^9}, 3.681792268648437*^9, {3.6817923742826757`*^9, 
   3.68179237547541*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{"r", "-", "R"}], ")"}], " ", 
    SubsuperscriptBox["sDip", "female", "2"], " ", 
    SubsuperscriptBox["sHap", "male", "2"]}], 
   RowBox[{"r", " ", "R", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["sDip", "female"], "+", 
       SubscriptBox["sDip", "male"]}], ")"}], "2"]}]], "}"}]], "Output",
 CellChangeTimes->{{3.678767563398781*^9, 3.678767624652616*^9}, 
   3.678770145190362*^9, 3.679938822624619*^9, 3.679940701830553*^9, 
   3.681792163118713*^9, 3.681792212132229*^9, 3.681792269070814*^9, 
   3.68179239539209*^9, 3.681897678714822*^9, 3.681898633916692*^9, 
   3.682134323099468*^9, 3.6821457543111343`*^9}]
}, Open  ]],

Cell["\<\
c) perfect ESD (half females, half males) with no competition among eggs (and \
equal dominance coefficients)\
\>", "Text",
 CellChangeTimes->{{3.678767485915291*^9, 3.678767501230596*^9}, {
  3.678767765444089*^9, 3.6787677924628277`*^9}, {3.681894998680505*^9, 
  3.6818950085081387`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"selESDsimp", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"tester", "/", 
            RowBox[{"(", 
             RowBox[{"pA", 
              RowBox[{"(", 
               RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], "/", 
           RowBox[{"(", 
            RowBox[{"1", "-", 
             RowBox[{"2", "r"}]}], ")"}]}], "*", "r"}], "/.", 
         RowBox[{"realsol", "[", 
          RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
        RowBox[{
         SubscriptBox["h", "sex_"], "\[Rule]", "h"}]}], "/.", 
       RowBox[{"k", "\[Rule]", 
        RowBox[{"1", "/", "2"}]}]}], "/.", 
      RowBox[{
       SubscriptBox["sHap", "female"], "\[Rule]", "0"}]}], "//", "Simplify"}],
     ",", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"sHap", "[", "female", "]"}], ",", 
      RowBox[{"sHap", "[", "male", "]"}]}], "}"}], ",", "Simplify"}], 
   "]"}]}]], "Input",
 CellChangeTimes->{{3.6817916125830803`*^9, 3.6817916278170033`*^9}, {
   3.681791661517055*^9, 3.681791662337051*^9}, 3.6817922150199947`*^9, {
   3.681792405757209*^9, 3.68179240661555*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SubscriptBox["sDip", "female"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"3", " ", 
        SubscriptBox["sDip", "female"]}], "-", 
       SubscriptBox["sDip", "male"]}], ")"}], " ", 
     SubsuperscriptBox["sHap", "male", "2"]}], 
    RowBox[{"8", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["sDip", "female"], "+", 
        SubscriptBox["sDip", "male"]}], ")"}], "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.678767539397587*^9, 3.678770145319853*^9, 
  3.679938822671948*^9, 3.679940701897401*^9, 3.6817921632187757`*^9, 
  3.681792215571678*^9, 3.6817922745889893`*^9, 3.681792407177326*^9, 
  3.6818976787598143`*^9, 3.681898633956902*^9, 3.682134323129363*^9, 
  3.682145754380763*^9}]
}, Open  ]],

Cell["\<\
This is an average of masculinizers and feminizers (with an extra 1/2 because \
the ESD only produces a different sex than the ancestral SDR would have 1/2 \
the time) with free recombination between the VS and modifier locus\
\>", "Text",
 CellChangeTimes->{{3.681792540682475*^9, 3.681792541604417*^9}, {
  3.6817925859813223`*^9, 3.681792612735476*^9}, {3.68214853292664*^9, 
  3.682148567035874*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{"Factor", "[", 
  RowBox[{
   RowBox[{
    RowBox[{"1", "/", "2"}], "*", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"selFeminizer", "+", "selMasculinizer"}], ")"}], "/", "2"}]}], "/.", 
   RowBox[{"R", "\[Rule]", 
    RowBox[{"1", "/", "2"}]}]}], "]"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"0", "==", 
   RowBox[{"%", "-", 
    RowBox[{"selESDsimp", "*", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", "r"}]}], ")"}], "/", "r"}]}]}]}], "//", 
  "Factor"}]}], "Input",
 CellChangeTimes->{{3.678844514479877*^9, 3.6788445688209267`*^9}, {
  3.681792422364336*^9, 3.681792423971106*^9}, {3.681792482271418*^9, 
  3.6817925101834507`*^9}, {3.682049601699399*^9, 3.68204963397768*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", 
      RowBox[{"2", " ", "r"}]}], ")"}], " ", 
    SubscriptBox["sDip", "female"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"3", " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      SubscriptBox["sDip", "male"]}], ")"}], " ", 
    SubsuperscriptBox["sHap", "male", "2"]}], 
   RowBox[{"8", " ", "r", " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["sDip", "female"], "+", 
       SubscriptBox["sDip", "male"]}], ")"}], "2"]}]], "}"}]], "Output",
 CellChangeTimes->{{3.678844536699091*^9, 3.678844569511002*^9}, 
   3.6799388228166437`*^9, {3.6817924095595284`*^9, 3.681792424694335*^9}, {
   3.681792487145247*^9, 3.681792511128744*^9}, 3.681897678809434*^9, 
   3.681898634012019*^9, 3.682134323162809*^9, 3.682145754426463*^9}],

Cell[BoxData[
 RowBox[{"0", "\[Equal]", 
  RowBox[{"{", "0", "}"}]}]], "Output",
 CellChangeTimes->{{3.678844536699091*^9, 3.678844569511002*^9}, 
   3.6799388228166437`*^9, {3.6817924095595284`*^9, 3.681792424694335*^9}, {
   3.681792487145247*^9, 3.681792511128744*^9}, 3.681897678809434*^9, 
   3.681898634012019*^9, 3.682134323162809*^9, 3.682145754427782*^9}]
}, Open  ]],

Cell["\<\
Note that R is involved if the ESD is not perfect (k \[NotEqual] 1/2)\
\>", "Text",
 CellChangeTimes->{{3.678767485915291*^9, 3.678767501230596*^9}, {
  3.678767765444089*^9, 3.6787677924628277`*^9}, {3.678844623873992*^9, 
  3.678844626159936*^9}, {3.6788449648037577`*^9, 3.678844995984447*^9}, {
  3.681792641368907*^9, 3.6817926537341433`*^9}, {3.6818950176296787`*^9, 
  3.681895024308425*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"tester", "/", 
        RowBox[{"(", 
         RowBox[{"pA", 
          RowBox[{"(", 
           RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], "/.", 
       RowBox[{"realsol", "[", 
        RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
      RowBox[{
       SubscriptBox["h", "sex_"], "\[Rule]", "h"}]}], "/.", 
     RowBox[{
      SubscriptBox["sHap", "female"], "\[Rule]", "0"}]}], "//", "Simplify"}], 
   ",", 
   RowBox[{"{", 
    SubscriptBox["sHap", "male"], "}"}], ",", "Simplify"}], "]"}]], "Input",
 CellChangeTimes->{
  3.6788447547878647`*^9, {3.678844814211166*^9, 3.678844815350346*^9}, 
   3.6788449921754913`*^9, {3.681792658887372*^9, 3.681792684333521*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"-", 
   FractionBox[
    RowBox[{
     SubscriptBox["sDip", "female"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{"2", "-", 
             RowBox[{"4", " ", "k"}], "+", 
             RowBox[{"3", " ", 
              SuperscriptBox["k", "2"]}]}], ")"}], " ", "R"}], "+", 
          RowBox[{"2", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "-", 
             RowBox[{"4", " ", "k", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", 
             RowBox[{
              SuperscriptBox["k", "2"], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "4"}], "+", 
                RowBox[{"5", " ", "R"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        SubscriptBox["sDip", "female"]}], "+", 
       RowBox[{
        SuperscriptBox["k", "2"], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "r"}]}], ")"}], " ", "R", " ", 
        SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
     SubsuperscriptBox["sHap", "male", "2"]}], 
    RowBox[{"2", " ", "r", " ", "R", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["sDip", "female"], "+", 
        SubscriptBox["sDip", "male"]}], ")"}], "2"]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.678767539397587*^9, 3.678770145319853*^9, 3.6788447560867357`*^9, {
   3.678844807892462*^9, 3.678844815643482*^9}, 3.6788449926094522`*^9, 
   3.679938822900567*^9, 3.681792684811819*^9, 3.681897678859838*^9, 
   3.6818986341040173`*^9, 3.68213432321026*^9, 3.6821457544674587`*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Sex chromosome turnover (selection not assumed to be weak)", "Section",
 CellChangeTimes->{{3.678209119281839*^9, 3.678209120120673*^9}, {
   3.678543062217785*^9, 3.678543087289337*^9}, {3.678845327129443*^9, 
   3.678845334473263*^9}, {3.6788457352447*^9, 3.67884576834332*^9}, {
   3.681897609323646*^9, 3.681897629368148*^9}, {3.681898183456883*^9, 
   3.681898230696837*^9}, 3.681900462399898*^9, {3.682133711700137*^9, 
   3.682133712477377*^9}}],

Cell[CellGroupData[{

Cell["Characteristic polynomial", "Subsection",
 CellChangeTimes->{{3.6819047751955338`*^9, 3.681904779416266*^9}}],

Cell["\<\
In this section we do not assume weak selection.\
\>", "Text",
 CellChangeTimes->{{3.6782188377314177`*^9, 3.678218867987314*^9}, {
   3.67821933410826*^9, 3.678219340858965*^9}, {3.67854312666928*^9, 
   3.678543134899115*^9}, 3.681899964611581*^9, 3.681900675421296*^9, {
   3.6820507984030733`*^9, 3.682050805301716*^9}}],

Cell["\<\
We first define the mean fitness of non-mutant females over the entire \
life-cycle\
\>", "Text",
 CellChangeTimes->{{3.67820958015338*^9, 3.678209581848392*^9}, {
   3.678218773865472*^9, 3.678218792610045*^9}, 3.678543107091495*^9, {
   3.6818986054990177`*^9, 3.681898605788726*^9}, {3.681901258150548*^9, 
   3.681901259053981*^9}, {3.681901437344181*^9, 3.681901445383747*^9}, {
   3.68190187236559*^9, 3.681901897193009*^9}, {3.681902775116111*^9, 
   3.6819027794321127`*^9}, {3.681903847565377*^9, 3.681903849245577*^9}, {
   3.682050811782687*^9, 3.682050812665957*^9}, {3.682065544510603*^9, 
   3.682065569016514*^9}, {3.682065669647312*^9, 3.6820656945659733`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"femaleMeanFit", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXf"}], ")"}], 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pXm"}], ")"}], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "male"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "a", ",", "female"}]]}], "+", "\[IndentingNewLine]", 
    RowBox[{"pXf", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pXm"}], ")"}], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "male"}]], 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "female"}]]}], "+", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXf"}], ")"}], 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "female"}]], " ", "pXm", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "male"}]], 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "female"}]]}], " ", "+", 
    "\[IndentingNewLine]", 
    RowBox[{"pXf", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "female"}]], " ", "pXm", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "male"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "A", ",", "female"}]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681898268466964*^9, 3.6818983708017797`*^9}, {
   3.6818984949585733`*^9, 3.681898533386279*^9}, {3.68190108087703*^9, 
   3.681901084934218*^9}, {3.681901144685513*^9, 3.681901154780171*^9}, {
   3.681901385648533*^9, 3.681901386601219*^9}, {3.6819016152621*^9, 
   3.681901637595449*^9}, 3.681901842920384*^9, 3.6819027638144817`*^9, {
   3.681903858647367*^9, 3.681903859300173*^9}}],

Cell["\<\
and the mean fitness of non-mutant males over the entire life-cycle\
\>", "Text",
 CellChangeTimes->{{3.682065572600375*^9, 3.68206561683589*^9}, {
  3.682065679170457*^9, 3.682065706203755*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"maleMeanFit", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXf"}], ")"}], 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pYm"}], ")"}], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "male"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "a", ",", "male"}]]}], "+", "\[IndentingNewLine]", 
    RowBox[{"pXf", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pYm"}], ")"}], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "male"}]], 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "male"}]]}], "+", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXf"}], ")"}], 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "female"}]], " ", "pYm", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "male"}]], 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "male"}]]}], " ", "+", 
    "\[IndentingNewLine]", 
    RowBox[{"pXf", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "female"}]], " ", "pYm", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "male"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "A", ",", "male"}]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681901249067821*^9, 3.6819012978398542`*^9}, {
  3.681901363538598*^9, 3.681901384083459*^9}, {3.681901546264427*^9, 
  3.681901547139256*^9}, {3.6819016461771812`*^9, 3.6819016541406918`*^9}, {
  3.681901830998515*^9, 3.681901845963574*^9}, {3.6819027552099323`*^9, 
  3.681902760712364*^9}, {3.682072412323092*^9, 3.68207244637437*^9}, {
  3.682072508629033*^9, 3.682072509244377*^9}}],

Cell[CellGroupData[{

Cell["neo-Y", "Subsubsection",
 CellChangeTimes->{{3.681903449113834*^9, 3.681903450516502*^9}, {
  3.6819047924620533`*^9, 3.681904797745571*^9}}],

Cell["\<\
When the mutation masculinizes, the characteristic polynomial is\
\>", "Text",
 CellChangeTimes->{{3.681903454570097*^9, 3.681903472252966*^9}, 
   3.681903788811371*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyk0", "=", 
   RowBox[{
    RowBox[{"charpolyExt", "/.", 
     RowBox[{"k", "\[Rule]", "0"}]}], "//", "Factor"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682069972428116*^9, 3.682069973772089*^9}, {
   3.682146362987977*^9, 3.682146374154097*^9}, 3.6821464495080338`*^9, 
   3.682146862048996*^9}],

Cell["The coefficients of our characteristic polynomial are", "Text",
 CellChangeTimes->{{3.6782188723553667`*^9, 3.678218885483445*^9}, 
   3.678219356203349*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"charpoly\[Alpha]0", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"charpolyk0", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"acoef0", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"charpoly\[Alpha]0", ",", 
     RowBox[{"\[Lambda]", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bcoef0", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"charpoly\[Alpha]0", ",", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ccoef0", "=", 
   RowBox[{"charpoly\[Alpha]0", "-", 
    RowBox[{"acoef0", " ", 
     RowBox[{"\[Lambda]", "^", "2"}]}], "-", 
    RowBox[{"bcoef0", " ", "\[Lambda]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.678210909322748*^9, 3.678210984920451*^9}, {
   3.678211065387308*^9, 3.6782111248508577`*^9}, {3.678216596004511*^9, 
   3.6782166154301167`*^9}, {3.678216661630507*^9, 3.6782166685831823`*^9}, {
   3.678543435404685*^9, 3.678543437050301*^9}, 3.6819018632616568`*^9, 
   3.6819019221224947`*^9, {3.681902293571035*^9, 3.6819022942054*^9}, {
   3.681903514398522*^9, 3.681903527518437*^9}, {3.6819039026101837`*^9, 
   3.681903904956162*^9}}],

Cell["The a coefficient is", "Text",
 CellChangeTimes->{{3.6782222711717787`*^9, 3.678222291827236*^9}, {
  3.678222442624536*^9, 3.678222466366487*^9}, {3.678543405945023*^9, 
  3.678543417688088*^9}, {3.678543453554411*^9, 3.678543473051293*^9}, {
  3.6785437211897573`*^9, 3.678543723630198*^9}, {3.681901128257367*^9, 
  3.6819011288228273`*^9}, {3.681902959278455*^9, 3.681902959943367*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"acoef0", "/", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"maleMeanFit", "/", "meanM"}], ")"}], "2"]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.678220958334203*^9, 3.678220959366744*^9}, {
   3.678222265836959*^9, 3.678222266627904*^9}, {3.6819007374163027`*^9, 
   3.681900782049633*^9}, 3.681900926695757*^9, {3.681901186789213*^9, 
   3.681901197102724*^9}, {3.681901311334466*^9, 3.6819013184746037`*^9}, {
   3.681901448459179*^9, 3.681901474059561*^9}, {3.681901555374631*^9, 
   3.6819015611958933`*^9}, {3.681901738004952*^9, 3.681901746660657*^9}, {
   3.681901926503386*^9, 3.681901935674559*^9}, 3.68190245993617*^9, 
   3.6819035305096617`*^9, {3.681903953576722*^9, 3.681903983485964*^9}}],

Cell[BoxData[
 SuperscriptBox["meanM", "2"]], "Output",
 CellChangeTimes->{
  3.6782209597852077`*^9, 3.678222266944385*^9, 3.678543400626965*^9, 
   3.678654026002152*^9, 3.678793286205207*^9, 3.6788400697835083`*^9, 
   3.6819005575412703`*^9, {3.681900748481739*^9, 3.681900782402131*^9}, 
   3.681900987661545*^9, 3.681901156386044*^9, {3.681901193888179*^9, 
   3.681901197489253*^9}, {3.681901315619341*^9, 3.681901318912204*^9}, {
   3.6819014435516567`*^9, 3.681901474369437*^9}, {3.681901551223834*^9, 
   3.681901562007998*^9}, 3.681901688097102*^9, {3.681901741651701*^9, 
   3.681901747081936*^9}, {3.681901924560219*^9, 3.681901936059821*^9}, {
   3.681902457853252*^9, 3.681902460302452*^9}, 3.681902853590461*^9, {
   3.681903940911755*^9, 3.681903983930966*^9}, 3.68206995384863*^9, 
   3.682070046092381*^9, 3.682072425383737*^9, 3.6820724627438173`*^9, 
   3.682072512278058*^9, 3.682075712311488*^9, 3.682135615311754*^9}]
}, Open  ]],

Cell["The b coefficient is", "Text",
 CellChangeTimes->{{3.678220686538608*^9, 3.678220691729186*^9}, 
   3.6785434209202127`*^9, {3.678543490956483*^9, 3.678543493747674*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"bcoef0", "/", 
   RowBox[{"(", 
    RowBox[{"maleMeanFit", "/", "meanM"}], ")"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.681902115693481*^9, 3.681902200954804*^9}, {
   3.681902468166185*^9, 3.681902521301772*^9}, {3.6819027976049557`*^9, 
   3.681902799293558*^9}, {3.6819028676340637`*^9, 3.681902878506536*^9}, 
   3.681903531804942*^9, {3.681903990557269*^9, 3.68190400450228*^9}, {
   3.682070160288609*^9, 3.682070189838722*^9}}],

Cell[BoxData[
 RowBox[{"meanM", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R", "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "a", ",", "male"}]]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "A", ",", "male"}]]}]}], ")"}]}], "+", 
    RowBox[{"pXf", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r", "+", "R", "-", 
          RowBox[{"r", " ", "R"}]}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "a", ",", "male"}]]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r", "+", "R", "-", 
          RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "A", ",", "male"}]]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.681902094206499*^9, 3.6819021614317102`*^9}, {
   3.681902191673566*^9, 3.681902201585752*^9}, {3.681902468585396*^9, 
   3.6819025217737637`*^9}, {3.681902847721582*^9, 3.681902878859128*^9}, {
   3.681903991028337*^9, 3.681904005074952*^9}, 3.682069953896315*^9, 
   3.6820700462040453`*^9, {3.6820701628009157`*^9, 3.6820701901485033`*^9}, 
   3.682072427850009*^9, 3.6820724646921577`*^9, 3.682072515013473*^9, 
   3.6820757148563128`*^9, 3.6821356154205933`*^9}]
}, Open  ]],

Cell["The c coefficient is", "Text",
 CellChangeTimes->{{3.6782189006435003`*^9, 3.6782189222277317`*^9}, 
   3.678543511708593*^9, 3.68190292412112*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ccoef0", "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.681902543700716*^9, 3.681902730901002*^9}, {
   3.681902820153164*^9, 3.681902830585311*^9}, {3.681902885226429*^9, 
   3.6819028958642607`*^9}, {3.681903003995617*^9, 3.681903021235251*^9}, {
   3.681903079684938*^9, 3.681903108859482*^9}, 3.681903536219841*^9, {
   3.6819040114739523`*^9, 3.681904017593088*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{"1", "-", "R", "+", 
    RowBox[{"r", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
  SubscriptBox["wHap", 
   RowBox[{"a", ",", "male"}]], " ", 
  SubscriptBox["wHap", 
   RowBox[{"A", ",", "male"}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pXf"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
     SubsuperscriptBox["wHap", 
      RowBox[{"a", ",", "female"}], "2"], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "a", ",", "male"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "male"}]]}], "+", 
    RowBox[{
     SuperscriptBox["pXf", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "r"}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
     SubsuperscriptBox["wHap", 
      RowBox[{"A", ",", "female"}], "2"], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "male"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "A", ",", "male"}]]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", "pXf", " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "female"}]], " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r", "+", "R"}], ")"}], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "A", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "a", ",", "male"}]]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "r", "+", "R", "-", 
          RowBox[{"2", " ", "r", " ", "R"}]}], ")"}], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "a", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "A", ",", "male"}]]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.6819025655478687`*^9, 3.681902731233783*^9}, {
   3.68190288238518*^9, 3.681902896193205*^9}, {3.681903016919009*^9, 
   3.6819030461006117`*^9}, {3.681903090378714*^9, 3.681903109252812*^9}, {
   3.681904012826597*^9, 3.681904017883568*^9}, 3.6820699539500103`*^9, 
   3.682070046309187*^9, 3.682072429864416*^9, 3.68207246656255*^9, 
   3.682072518396834*^9, 3.68207571717325*^9, 3.682135615512971*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["neo-W", "Subsubsection",
 CellChangeTimes->{{3.681903481396954*^9, 3.681903482562479*^9}, {
  3.681904802154821*^9, 3.681904805356543*^9}}],

Cell["When the mutation feminizes the characteristic polynomial is", "Text",
 CellChangeTimes->{{3.681903454570097*^9, 3.681903496200884*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyk1", "=", 
   RowBox[{
    RowBox[{"charpolyExt", "/.", 
     RowBox[{"k", "\[Rule]", "1"}]}], "//", "Factor"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681903497829351*^9, 3.681903501705464*^9}, {
  3.682050820492804*^9, 3.6820508216681767`*^9}}],

Cell["and the coefficients are", "Text",
 CellChangeTimes->{{3.6782188723553667`*^9, 3.678218885483445*^9}, 
   3.678219356203349*^9, {3.68205083783855*^9, 3.682050844141939*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"charpoly\[Alpha]1", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"charpolyk1", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"acoef1", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"charpoly\[Alpha]1", ",", 
     RowBox[{"\[Lambda]", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bcoef1", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"charpoly\[Alpha]1", ",", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ccoef1", "=", 
   RowBox[{"charpoly\[Alpha]1", "-", 
    RowBox[{"acoef1", " ", 
     RowBox[{"\[Lambda]", "^", "2"}]}], "-", 
    RowBox[{"bcoef1", " ", "\[Lambda]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.678210909322748*^9, 3.678210984920451*^9}, {
   3.678211065387308*^9, 3.6782111248508577`*^9}, {3.678216596004511*^9, 
   3.6782166154301167`*^9}, {3.678216661630507*^9, 3.6782166685831823`*^9}, {
   3.678543435404685*^9, 3.678543437050301*^9}, 3.6819018632616568`*^9, 
   3.6819019221224947`*^9, {3.681902293571035*^9, 3.6819022942054*^9}, {
   3.681903505397892*^9, 3.681903508119597*^9}, {3.681903545066331*^9, 
   3.6819035461047077`*^9}, {3.6819041845038767`*^9, 3.681904186019739*^9}}],

Cell["The a coefficient is", "Text",
 CellChangeTimes->{{3.6782222711717787`*^9, 3.678222291827236*^9}, {
  3.678222442624536*^9, 3.678222466366487*^9}, {3.678543405945023*^9, 
  3.678543417688088*^9}, {3.678543453554411*^9, 3.678543473051293*^9}, {
  3.6785437211897573`*^9, 3.678543723630198*^9}, {3.681901128257367*^9, 
  3.6819011288228273`*^9}, {3.681902959278455*^9, 3.681902959943367*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"acoef1", "/", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}], "2"]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.678220958334203*^9, 3.678220959366744*^9}, {
   3.678222265836959*^9, 3.678222266627904*^9}, {3.6819007374163027`*^9, 
   3.681900782049633*^9}, 3.681900926695757*^9, {3.681901186789213*^9, 
   3.681901197102724*^9}, {3.681901311334466*^9, 3.6819013184746037`*^9}, {
   3.681901448459179*^9, 3.681901474059561*^9}, {3.681901555374631*^9, 
   3.6819015611958933`*^9}, {3.681901738004952*^9, 3.681901746660657*^9}, {
   3.681901926503386*^9, 3.681901935674559*^9}, 3.68190245993617*^9, 
   3.681903548604609*^9, {3.681903719170225*^9, 3.681903730827586*^9}}],

Cell[BoxData[
 RowBox[{"4", " ", 
  SuperscriptBox["meanF", "2"]}]], "Output",
 CellChangeTimes->{
  3.6782209597852077`*^9, 3.678222266944385*^9, 3.678543400626965*^9, 
   3.678654026002152*^9, 3.678793286205207*^9, 3.6788400697835083`*^9, 
   3.6819005575412703`*^9, {3.681900748481739*^9, 3.681900782402131*^9}, 
   3.681900987661545*^9, 3.681901156386044*^9, {3.681901193888179*^9, 
   3.681901197489253*^9}, {3.681901315619341*^9, 3.681901318912204*^9}, {
   3.6819014435516567`*^9, 3.681901474369437*^9}, {3.681901551223834*^9, 
   3.681901562007998*^9}, 3.681901688097102*^9, {3.681901741651701*^9, 
   3.681901747081936*^9}, {3.681901924560219*^9, 3.681901936059821*^9}, {
   3.681902457853252*^9, 3.681902460302452*^9}, 3.681902853590461*^9, 
   3.681903688647355*^9, 3.681903731276161*^9, 3.68190424567815*^9, 
   3.68205090085511*^9, 3.682067861612368*^9, 3.68214132999995*^9}]
}, Open  ]],

Cell["the b coefficient is", "Text",
 CellChangeTimes->{{3.678220686538608*^9, 3.678220691729186*^9}, 
   3.6785434209202127`*^9, {3.678543490956483*^9, 3.678543493747674*^9}, {
   3.682050863761986*^9, 3.6820508638638773`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"bcoef1", "/", 
    RowBox[{"(", 
     RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}]}], "/.", 
   RowBox[{"pXm", "\[Rule]", 
    RowBox[{
     RowBox[{"2", "pAveM"}], "-", "pYm"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.681902115693481*^9, 3.681902200954804*^9}, {
   3.681902468166185*^9, 3.681902521301772*^9}, {3.6819027976049557`*^9, 
   3.681902799293558*^9}, {3.6819028676340637`*^9, 3.681902878506536*^9}, 
   3.681903550385972*^9, 3.68190419579093*^9, {3.681904284363233*^9, 
   3.681904301589705*^9}}],

Cell[BoxData[
 RowBox[{"4", " ", "meanF", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "a", ",", "female"}]]}], "+", 
       RowBox[{"pAveM", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "A", ",", "female"}]]}]}], ")"}]}], "-", 
    RowBox[{
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "a", ",", "female"}]]}], "+", 
       RowBox[{"pAveM", " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "A", ",", "female"}]]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.681902094206499*^9, 3.6819021614317102`*^9}, {
   3.681902191673566*^9, 3.681902201585752*^9}, {3.681902468585396*^9, 
   3.6819025217737637`*^9}, {3.681902847721582*^9, 3.681902878859128*^9}, 
   3.681904245827611*^9, 3.681904302410067*^9, 3.6820509010117617`*^9, 
   3.6820678630338707`*^9, 3.6821413300795107`*^9}]
}, Open  ]],

Cell["\<\
where pAveM is the mean frequency of A in gametes from males,\
\>", "Text",
 CellChangeTimes->{{3.681904342795517*^9, 3.681904382529579*^9}, {
  3.6820508567878227`*^9, 3.682050859139917*^9}}],

Cell["and the c coefficient is", "Text",
 CellChangeTimes->{{3.6782189006435003`*^9, 3.6782189222277317`*^9}, 
   3.678543511708593*^9, 3.68190292412112*^9, {3.682050860746811*^9, 
   3.6820508621260977`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"ccoef1", "/.", 
   RowBox[{"pXm", "\[Rule]", 
    RowBox[{
     RowBox[{"2", "pAveM"}], "-", "pYm"}]}]}], "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.681902543700716*^9, 3.681902730901002*^9}, {
   3.681902820153164*^9, 3.681902830585311*^9}, {3.681902885226429*^9, 
   3.6819028958642607`*^9}, {3.681903003995617*^9, 3.681903021235251*^9}, {
   3.681903079684938*^9, 3.681903108859482*^9}, 3.681903552271728*^9, 
   3.6819041925823793`*^9, 3.6819043093409*^9, {3.6820509718568287`*^9, 
   3.6820509750975637`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", "4"}], " ", 
  SubscriptBox["wHap", 
   RowBox[{"a", ",", "female"}]], " ", 
  SubscriptBox["wHap", 
   RowBox[{"A", ",", "female"}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
     SubsuperscriptBox["wHap", 
      RowBox[{"a", ",", "male"}], "2"], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "a", ",", "female"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "female"}]]}], "+", 
    RowBox[{
     SuperscriptBox["pAveM", "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
     SubsuperscriptBox["wHap", 
      RowBox[{"A", ",", "male"}], "2"], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "female"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "A", ",", "female"}]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", "pAveM", " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "male"}]], " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "male"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "R"}]}], ")"}], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "A", ",", "female"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "a", ",", "female"}]]}], "-", 
       RowBox[{
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "a", ",", "female"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "A", ",", "female"}]]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.6819025655478687`*^9, 3.681902731233783*^9}, {
   3.68190288238518*^9, 3.681902896193205*^9}, {3.681903016919009*^9, 
   3.6819030461006117`*^9}, {3.681903090378714*^9, 3.681903109252812*^9}, 
   3.681904245942725*^9, 3.6819043098248053`*^9, {3.682050973149679*^9, 
   3.68205097568729*^9}, 3.682067865314228*^9, 3.682141330127816*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["ESD [unfinished][DELETE?]", "Subsubsection",
 CellChangeTimes->{{3.682133369592121*^9, 3.6821333833112087`*^9}, {
  3.682147220121665*^9, 3.682147221779377*^9}, {3.6821478690650597`*^9, 
  3.682147873628645*^9}}],

Cell["\<\
When the mutation is a perfect ESD the characteristic polynomial is\
\>", "Text",
 CellChangeTimes->{{3.681903454570097*^9, 3.681903496200884*^9}, {
  3.68213376383524*^9, 3.682133766595909*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"charpolyk12", "=", 
  RowBox[{"charpolyExt", "/.", 
   RowBox[{"k", "\[Rule]", 
    RowBox[{"1", "/", "2"}]}]}]}]], "Input",
 CellChangeTimes->{{3.681903497829351*^9, 3.681903501705464*^9}, {
   3.682050820492804*^9, 3.6820508216681767`*^9}, {3.68213375786001*^9, 
   3.6821337696230497`*^9}, {3.682144693509652*^9, 3.682144694197575*^9}, 
   3.682147031629504*^9}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{278., {2., 8.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "pXf"}], " ", "R", " ", 
             SubscriptBox["wHap", 
              RowBox[{"a", ",", "male"}]], " ", 
             SubscriptBox["wHap", 
              RowBox[{"A", ",", "female"}]], " ", 
             SubscriptBox["wDip", 
              RowBox[{"A", ",", "a", ",", "female"}]], " ", 
             RowBox[{"(", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}]}], 
            "-", 
            FractionBox[
             RowBox[{
              SubscriptBox["wHap", 
               RowBox[{"a", ",", "male"}]], " ", 
              RowBox[{"\[LeftSkeleton]", "2", "\[RightSkeleton]"}], " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}], 
               ")"}]}], 
             RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]], "-", 
            RowBox[{"pXf", " ", "R", " ", 
             SubscriptBox[
              RowBox[{"\[LeftSkeleton]", "4", "\[RightSkeleton]"}], 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]], " ", 
             RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], " ", 
             SubscriptBox["wDip", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]], " ", 
             RowBox[{"(", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}]}], 
            "+", 
            RowBox[{"2", " ", 
             RowBox[{"(", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}], 
             " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "\[Lambda]"}], "-", 
               FractionBox[
                RowBox[{
                 SubscriptBox["wHap", 
                  RowBox[{"a", ",", "male"}]], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"-", 
                    SubscriptBox["wHap", 
                    RowBox[{"a", ",", "female"}]]}], " ", 
                    SubscriptBox["wDip", 
                    RowBox[{"a", ",", "a", ",", "male"}]]}], "+", 
                   RowBox[{"pXf", " ", 
                    SubscriptBox[
                    RowBox[{"\[LeftSkeleton]", "4", "\[RightSkeleton]"}], 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]], 
                    " ", 
                    SubscriptBox["wDip", 
                    RowBox[{"a", ",", 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
                    "male"}]]}], "-", 
                   RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
                   
                   RowBox[{"pXf", " ", "R", " ", 
                    SubscriptBox["wHap", 
                    RowBox[{"A", ",", "female"}]], " ", 
                    SubscriptBox["wDip", 
                    RowBox[{"A", ",", "a", ",", "male"}]]}]}], ")"}]}], 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"\[LeftSkeleton]", "12", "\[RightSkeleton]"}], "+", 
                   RowBox[{"pXf", " ", "pYm", " ", 
                    SubscriptBox["wHap", 
                    RowBox[{"A", ",", "female"}]], " ", 
                    SubscriptBox["wHap", 
                    RowBox[{"A", ",", "male"}]], " ", 
                    SubscriptBox["wDip", 
                    RowBox[{"A", ",", "A", ",", "male"}]]}]}], ")"}]}]]}], 
              ")"}], " ", 
             RowBox[{"(", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}]}]}],
            ")"}], "/", 
          RowBox[{"(", 
           RowBox[{"256", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}], 
             "4"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 SubscriptBox["wHap", 
                  RowBox[{"a", ",", "female"}]]}], " ", 
                SubscriptBox["wHap", 
                 RowBox[{"a", ",", "male"}]], " ", 
                SubscriptBox["wDip", 
                 RowBox[{"a", ",", "a", ",", "male"}]]}], "+", 
               RowBox[{"pXf", " ", 
                SubscriptBox["wHap", 
                 RowBox[{"a", ",", "female"}]], " ", 
                SubscriptBox["wHap", 
                 RowBox[{"a", ",", "male"}]], " ", 
                SubscriptBox["wDip", 
                 RowBox[{"a", ",", "a", ",", "male"}]]}], "+", 
               RowBox[{"\[LeftSkeleton]", "8", "\[RightSkeleton]"}], "+", 
               RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "-", 
               RowBox[{"pXf", " ", "pYm", " ", 
                SubscriptBox["wHap", 
                 RowBox[{"A", ",", "female"}]], " ", 
                SubscriptBox["wHap", 
                 RowBox[{"A", ",", "male"}]], " ", 
                SubscriptBox["wDip", 
                 RowBox[{"A", ",", "A", ",", "male"}]]}]}], ")"}], "4"]}], 
           ")"}]}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{49., {1., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 74, 29489796356167989726, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{52., {1., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 74, 29489796356167989726, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{82., {2., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 74, 29489796356167989726, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{74., {1., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[74]]], "Output",
 CellChangeTimes->{3.682145762215184*^9, 3.682147039835189*^9}]
}, Open  ]],

Cell["and the coefficients are", "Text",
 CellChangeTimes->{{3.6782188723553667`*^9, 3.678218885483445*^9}, 
   3.678219356203349*^9, {3.68205083783855*^9, 3.682050844141939*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpoly\[Alpha]12", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{"charpolyk12", ",", "\[Lambda]"}], "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6821465759677896`*^9, 3.682146579241149*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"charpoly\[Alpha]12", "/.", 
    RowBox[{"r", "\[Rule]", "0"}]}], "/.", 
   RowBox[{"R", "\[Rule]", "0"}]}], "/.", 
  RowBox[{
   SubscriptBox["wHap", 
    RowBox[{"y_", ",", "female"}]], "\[Rule]", "1"}]}]], "Input",
 CellChangeTimes->{{3.682146764456389*^9, 3.682146808353959*^9}, {
  3.682146943884429*^9, 3.682146993017418*^9}, {3.682147135164772*^9, 
  3.682147141713822*^9}}],

Cell[BoxData[
 InterpretationBox[
  TagBox[
   PanelBox[GridBox[{
      {
       StyleBox[
        StyleBox[
         DynamicBox[ToBoxes[
           FEPrivate`FrontEndResource["FEStrings", "sizeExplanation"], 
           StandardForm],
          ImageSizeCache->{278., {2., 8.}}],
         StripOnInput->False,
         DynamicUpdating->True], "Panel",
        StripOnInput->False,
        Background->None]},
      {
       ItemBox[
        TagBox[
         RowBox[{
          SuperscriptBox["\[Lambda]", "8"], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[Lambda]", "7"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "128.`"}], " ", 
               SubscriptBox["wHap", 
                RowBox[{"A", ",", "male"}]], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}], 
                "4"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", 
                  SubscriptBox["wDip", 
                   RowBox[{"a", ",", "A", ",", "male"}]]}], "+", 
                 RowBox[{"pXf", " ", 
                  SubscriptBox["wDip", 
                   RowBox[{"a", ",", "A", ",", "male"}]]}], "-", 
                 RowBox[{"pXf", " ", 
                  SubscriptBox["wDip", 
                   RowBox[{"A", ",", "A", ",", "male"}]]}]}], ")"}], " ", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SubscriptBox["wHap", 
                    RowBox[{"a", ",", "male"}]]}], " ", 
                   SubscriptBox["wDip", 
                    RowBox[{"a", ",", "a", ",", "male"}]]}], "+", 
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
                  RowBox[{"\[LeftSkeleton]", "8", "\[RightSkeleton]"}], "+", 
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "-", 
                  RowBox[{"pXf", " ", "pYm", " ", 
                   SubscriptBox["wHap", 
                    RowBox[{"A", ",", "male"}]], " ", 
                   SubscriptBox["wDip", 
                    RowBox[{"A", ",", "A", ",", "male"}]]}]}], ")"}], "3"]}], 
              "+", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "+", 
              FractionBox[
               RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
               RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]]}], 
             ")"}]}], 
           RowBox[{"256", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 SubscriptBox["wHap", 
                  RowBox[{"a", ",", "male"}]]}], " ", 
                SubscriptBox["wDip", 
                 RowBox[{"a", ",", "a", ",", "female"}]]}], "+", 
               RowBox[{"\[LeftSkeleton]", "12", "\[RightSkeleton]"}]}], ")"}],
              "4"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 SubscriptBox["wHap", 
                  RowBox[{"a", ",", "male"}]]}], " ", 
                SubscriptBox["wDip", 
                 RowBox[{"a", ",", "a", ",", "male"}]]}], "+", 
               RowBox[{"\[LeftSkeleton]", "12", "\[RightSkeleton]"}]}], ")"}],
              "4"]}]], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[Lambda]", "6"], " ", 
            RowBox[{"(", 
             RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}]}], 
           RowBox[{"256", " ", 
            SuperscriptBox[
             RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "4"], " ", 
            
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}], 
             "4"]}]], "+", 
          RowBox[{"\[LeftSkeleton]", "3", "\[RightSkeleton]"}], "+", 
          FractionBox[
           RowBox[{
            SuperscriptBox["\[Lambda]", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}]}], 
           RowBox[{"256", " ", 
            RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
            RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], 
            RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}]], "+", 
          FractionBox[
           RowBox[{"\[Lambda]", " ", 
            RowBox[{"(", 
             RowBox[{"0.`", "\[VeryThinSpace]", "-", 
              FractionBox[
               RowBox[{"0.5`", " ", 
                RowBox[{"\[LeftSkeleton]", "9", "\[RightSkeleton]"}]}], 
               RowBox[{
                SuperscriptBox[
                 RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "2"], 
                " ", 
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}]], "+", 
              
              RowBox[{"\[LeftSkeleton]", "57", "\[RightSkeleton]"}]}], 
             ")"}]}], 
           RowBox[{"256", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}], 
             "4"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 SubscriptBox[
                  RowBox[{"\[LeftSkeleton]", "4", "\[RightSkeleton]"}], 
                  RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]]}], 
                " ", 
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}]}], "+", 
               RowBox[{"\[LeftSkeleton]", "12", "\[RightSkeleton]"}]}], ")"}],
              "4"]}]], "+", 
          FractionBox[
           RowBox[{"0.`", "\[VeryThinSpace]", "-", 
            FractionBox[
             RowBox[{"0.0625`", " ", 
              SubsuperscriptBox["wHap", 
               RowBox[{"a", ",", "male"}], "2"], " ", 
              SubsuperscriptBox[
               RowBox[{"\[LeftSkeleton]", "4", "\[RightSkeleton]"}], 
               RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], "2"], 
              " ", 
              RowBox[{"\[LeftSkeleton]", "5", "\[RightSkeleton]"}], " ", 
              RowBox[{"(", 
               RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}], 
              " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}], 
               "2"]}], 
             RowBox[{
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}], 
               "2"], " ", 
              SuperscriptBox[
               RowBox[{"(", 
                RowBox[{"\[LeftSkeleton]", "1", "\[RightSkeleton]"}], ")"}], 
               "2"]}]], "+", 
            RowBox[{"\[LeftSkeleton]", "18", "\[RightSkeleton]"}]}], 
           RowBox[{"256", " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 SubscriptBox["wHap", 
                  RowBox[{"a", ",", "male"}]]}], " ", 
                SubscriptBox["wDip", 
                 RowBox[{"a", ",", "a", ",", "female"}]]}], "+", 
               RowBox[{"\[LeftSkeleton]", "12", "\[RightSkeleton]"}]}], ")"}],
              "4"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", 
                 SubscriptBox["wHap", 
                  RowBox[{"a", ",", "male"}]]}], " ", 
                SubscriptBox["wDip", 
                 RowBox[{"a", ",", "a", ",", "male"}]]}], "+", 
               RowBox[{"pXf", " ", 
                SubscriptBox["wHap", 
                 RowBox[{"a", ",", "male"}]], " ", 
                SubscriptBox["wDip", 
                 RowBox[{"a", ",", "a", ",", "male"}]]}], "+", 
               RowBox[{"\[LeftSkeleton]", "8", "\[RightSkeleton]"}], "+", 
               RowBox[{"pXf", " ", "pYm", " ", 
                SubscriptBox["wHap", 
                 RowBox[{"a", ",", "male"}]], " ", 
                SubscriptBox["wDip", 
                 RowBox[{"A", ",", "a", ",", "male"}]]}], "-", 
               RowBox[{"pXf", " ", "pYm", " ", 
                SubscriptBox["wHap", 
                 RowBox[{"A", ",", "male"}]], " ", 
                SubscriptBox["wDip", 
                 RowBox[{"A", ",", "A", ",", "male"}]]}]}], ")"}], "4"]}]]}],
         Short[#, 5]& ],
        Background->GrayLevel[1],
        BaseStyle->{Deployed -> False},
        Frame->True,
        FrameStyle->GrayLevel[0, 0.2],
        StripOnInput->False]},
      {
       RowBox[{
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowLess"], 
             StandardForm],
            ImageSizeCache->{49., {1., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 76, 29489796356167989726, 5/2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowMore"], 
             StandardForm],
            ImageSizeCache->{52., {1., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 76, 29489796356167989726, 5 2],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeShowAll"], 
             StandardForm],
            ImageSizeCache->{82., {2., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>OutputSizeLimit`ButtonFunction[
          Identity, 76, 29489796356167989726, Infinity],
         Enabled->True,
         Evaluator->Automatic,
         Method->"Queued"], "\[ThinSpace]", 
        ButtonBox[
         StyleBox[
          StyleBox[
           DynamicBox[ToBoxes[
             FEPrivate`FrontEndResource["FEStrings", "sizeChangeLimit"], 
             StandardForm],
            ImageSizeCache->{74., {1., 8.}}],
           StripOnInput->False,
           DynamicUpdating->True], "Panel",
          StripOnInput->False,
          Background->None],
         Appearance->Automatic,
         ButtonFunction:>FrontEndExecute[{
            FrontEnd`SetOptions[
            FrontEnd`$FrontEnd, 
             FrontEnd`PreferencesSettings -> {"Page" -> "Evaluation"}], 
            FrontEnd`FrontEndToken["PreferencesDialog"]}],
         Evaluator->None,
         Method->"Preemptive"]}]}
     },
     DefaultBaseStyle->"Column",
     GridBoxAlignment->{
      "Columns" -> {{Left}}, "ColumnsIndexed" -> {}, "Rows" -> {{Baseline}}, 
       "RowsIndexed" -> {}},
     GridBoxDividers->{
      "Columns" -> {{False}}, "ColumnsIndexed" -> {}, "Rows" -> {{False}}, 
       "RowsIndexed" -> {}},
     GridBoxItemSize->{
      "Columns" -> {{Automatic}}, "ColumnsIndexed" -> {}, "Rows" -> {{1.}}, 
       "RowsIndexed" -> {}},
     GridBoxSpacings->{"Columns" -> {
         Offset[0.27999999999999997`], {
          Offset[0.5599999999999999]}, 
         Offset[0.27999999999999997`]}, "ColumnsIndexed" -> {}, "Rows" -> {
         Offset[0.2], {
          Offset[1.2]}, 
         Offset[0.2]}, "RowsIndexed" -> {}}],
    DefaultBaseStyle->{},
    FrameMargins->5],
   Deploy,
   DefaultBaseStyle->"Deploy"],
  Out[76]]], "Output",
 CellChangeTimes->{{3.682146747781002*^9, 3.682146802091319*^9}, 
   3.682146841024167*^9, 3.6821469611841707`*^9, 3.682147011797225*^9, 
   3.682147070120517*^9, 3.682147152152095*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"0", "==", 
      RowBox[{"charpoly\[Alpha]12", "[", 
       RowBox[{"[", "8", "]"}], "]"}]}], "/.", 
     RowBox[{"R", "\[Rule]", "0"}]}], "/.", 
    RowBox[{"r", "\[Rule]", "0"}]}], ",", "\[Lambda]"}], "]"}]], "Input",
 CellChangeTimes->{{3.6821465997761106`*^9, 3.682146717470539*^9}, {
  3.682146937069366*^9, 3.682146938701647*^9}}],

Cell[BoxData["$Aborted"], "Output",
 CellChangeTimes->{{3.682146604437483*^9, 3.682146649269245*^9}, {
   3.68214669970155*^9, 3.6821467121019573`*^9}, 3.682146744520771*^9}]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"charpoly\[Alpha]12", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"charpolyk12", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"acoef12", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"charpoly\[Alpha]12", ",", 
     RowBox[{"\[Lambda]", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bcoef12", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"charpoly\[Alpha]12", ",", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ccoef12", "=", 
   RowBox[{"charpoly\[Alpha]12", "-", 
    RowBox[{"acoef12", " ", 
     RowBox[{"\[Lambda]", "^", "2"}]}], "-", 
    RowBox[{"bcoef12", " ", "\[Lambda]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.678210909322748*^9, 3.678210984920451*^9}, {
   3.678211065387308*^9, 3.6782111248508577`*^9}, {3.678216596004511*^9, 
   3.6782166154301167`*^9}, {3.678216661630507*^9, 3.6782166685831823`*^9}, {
   3.678543435404685*^9, 3.678543437050301*^9}, 3.6819018632616568`*^9, 
   3.6819019221224947`*^9, {3.681902293571035*^9, 3.6819022942054*^9}, {
   3.681903505397892*^9, 3.681903508119597*^9}, {3.681903545066331*^9, 
   3.6819035461047077`*^9}, {3.6819041845038767`*^9, 3.681904186019739*^9}, {
   3.6821337733255444`*^9, 3.6821337842913523`*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Turnover criteria", "Subsection",
 CellChangeTimes->{{3.6788400973659563`*^9, 3.6788400977552834`*^9}, {
  3.678845422467141*^9, 3.6788454270150137`*^9}, {3.681904868180079*^9, 
  3.681904901055883*^9}, {3.682049495586666*^9, 3.68204951048149*^9}, {
  3.682049998377571*^9, 3.6820500001004353`*^9}, {3.682133805266603*^9, 
  3.682133806694442*^9}}],

Cell[CellGroupData[{

Cell["neo-Y", "Subsubsection",
 CellChangeTimes->{{3.6819049103666162`*^9, 3.681904911602844*^9}, 
   3.681919037006514*^9}],

Cell["\<\
When there is no recombination at all the eigenvalues are\
\>", "Text",
 CellChangeTimes->{{3.682072590495638*^9, 3.682072598058753*^9}, {
  3.682074822686273*^9, 3.682074840969604*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"noreceigens0", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"\[Lambda]", "/.", 
      RowBox[{"Solve", "[", 
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"0", "==", 
           RowBox[{"charpolyk0", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "/.", 
          RowBox[{"r", "\[Rule]", "0"}]}], "/.", 
         RowBox[{"R", "\[Rule]", "0"}]}], ",", "\[Lambda]"}], "]"}]}], ")"}], 
    "*", 
    RowBox[{"(", 
     RowBox[{"maleMeanFit", "/", "meanM"}], ")"}]}], "//", 
   "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.682072604849454*^9, 3.682072625018734*^9}, 
   3.682073600958725*^9, 3.6820737987746267`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "male"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "female"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "A", ",", "male"}]]}], "-", 
        RowBox[{"pXf", " ", 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "female"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"A", ",", "A", ",", "male"}]]}]}], ")"}]}], "meanM"]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "male"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "female"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "a", ",", "male"}]]}], "-", 
        RowBox[{"pXf", " ", 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "female"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"A", ",", "a", ",", "male"}]]}]}], ")"}]}], "meanM"]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.68207260895572*^9, 3.682072626981361*^9}, 
   3.682073800386057*^9, 3.682075726053172*^9, 3.682135616835877*^9}]
}, Open  ]],

Cell["\<\
The growth rates of the haplotypes (where double and triple heterozygotes are \
lost through recombination at rates (1-r)(1-R)+r R and (1-r)(1-R) \
respectively) can be used to reduce the 2a+b<0 condition to\
\>", "Text",
 CellChangeTimes->{{3.678846177746627*^9, 3.6788461948713303`*^9}, {
   3.678846297134678*^9, 3.678846304582315*^9}, 3.681904868184037*^9, {
   3.6819181257275543`*^9, 3.681918148392576*^9}, {3.681918434462582*^9, 
   3.681918438682802*^9}, 3.6820738884263678`*^9, {3.682074646596445*^9, 
   3.682074673628763*^9}, {3.6820748692592487`*^9, 3.6820748701295443`*^9}, {
   3.6820752534076853`*^9, 3.6820752572028427`*^9}, {3.682075337627179*^9, 
   3.682075379037554*^9}, {3.68213584629224*^9, 3.68213584968274*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gAsub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"gA", "==", 
          RowBox[{
           RowBox[{"noreceigens0", "[", 
            RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "/.", 
         RowBox[{
          SubscriptBox["wDip", 
           RowBox[{"A", ",", "A", ",", "male"}]], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "r"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "R"}], ")"}]}], "+", 
             RowBox[{"r", " ", "R"}]}], ")"}], 
           SubscriptBox["wDip", 
            RowBox[{"A", ",", "A", ",", "male"}]]}]}]}], "/.", 
        RowBox[{
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "A", ",", "male"}]], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], " ", 
          SubscriptBox["wDip", 
           RowBox[{"a", ",", "A", ",", "male"}]]}]}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"A", ",", "A", ",", "male"}]]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gasub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"ga", "==", 
          RowBox[{
           RowBox[{"noreceigens0", "[", 
            RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "/.", 
         RowBox[{
          SubscriptBox["wDip", 
           RowBox[{"a", ",", "a", ",", "male"}]], "\[Rule]", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"(", 
               RowBox[{"1", "-", "r"}], ")"}], 
              RowBox[{"(", 
               RowBox[{"1", "-", "R"}], ")"}]}], "+", 
             RowBox[{"r", " ", "R"}]}], ")"}], 
           SubscriptBox["wDip", 
            RowBox[{"a", ",", "a", ",", "male"}]]}]}]}], "/.", 
        RowBox[{
         SubscriptBox["wDip", 
          RowBox[{"A", ",", "a", ",", "male"}]], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], " ", 
          SubscriptBox["wDip", 
           RowBox[{"A", ",", "a", ",", "male"}]]}]}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"a", ",", "a", ",", "male"}]]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", 
         RowBox[{"acoef0", "/", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{"maleMeanFit", "/", "meanM"}], ")"}], "2"]}]}], "+", 
        RowBox[{"bcoef0", "/", 
         RowBox[{"(", 
          RowBox[{"maleMeanFit", "/", "meanM"}], ")"}]}]}], ")"}], "<", "0"}],
      "/.", "gasub"}], "/.", "gAsub"}], "//", "Simplify"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Simplify", "[", 
   RowBox[{
    RowBox[{"%", "/.", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "male"}]], "\[Rule]", 
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "male"}]]}]}], ",", 
    RowBox[{"{", 
     RowBox[{"meanM", ">", "0"}], "}"}]}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"%", "/.", 
   RowBox[{"gA", "\[Rule]", 
    RowBox[{
     RowBox[{"2", "gmean"}], "-", "ga"}]}]}], "//", "Simplify"}]}], "Input",
 CellChangeTimes->{{3.6820751842003*^9, 3.682075232619042*^9}, {
   3.682075275691279*^9, 3.682075327449933*^9}, {3.68207539183604*^9, 
   3.68207544611241*^9}, 3.682075556347659*^9, {3.6821358013638077`*^9, 
   3.682135842330811*^9}}],

Cell[BoxData[
 RowBox[{"gmean", ">", "0"}]], "Output",
 CellChangeTimes->{{3.6820751728682623`*^9, 3.682075233004073*^9}, 
   3.682075328239903*^9, {3.682075398643929*^9, 3.682075446542357*^9}, 
   3.682075556762436*^9, 3.682075727850223*^9, 3.682076424953463*^9, 
   3.6821356171818333`*^9, {3.682135806625413*^9, 3.6821358426583557`*^9}}]
}, Open  ]],

Cell["\<\
And when we only care about keeping together double heterozygotes (ie only \
carrying about whether the neo-Y stays with the ancestral X or Y) then the \
growth rates are\
\>", "Text",
 CellChangeTimes->{{3.682076327577132*^9, 3.682076343293111*^9}, {
  3.682076584897274*^9, 3.682076602373353*^9}, {3.682076771774206*^9, 
  3.682076793032584*^9}, {3.682076926748664*^9, 3.682076932006803*^9}, {
  3.682135875261716*^9, 3.682135879275443*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gAssub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"gAs", "==", 
        RowBox[{
         RowBox[{
          RowBox[{"noreceigens0", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "r"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", "R"}], ")"}]}], "+", 
            RowBox[{"r", " ", "R"}]}], ")"}]}], "-", "1"}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"A", ",", "A", ",", "male"}]]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gassub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"gas", "==", 
        RowBox[{
         RowBox[{
          RowBox[{"noreceigens0", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "*", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{"1", "-", "r"}], ")"}], 
             RowBox[{"(", 
              RowBox[{"1", "-", "R"}], ")"}]}], "+", 
            RowBox[{"r", " ", "R"}]}], ")"}]}], "-", "1"}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"a", ",", "a", ",", "male"}]]}], "]"}], "//", "Simplify"}], "//",
     "Flatten"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.682076240360557*^9, 3.682076268754534*^9}, {
  3.682076396486938*^9, 3.682076412028656*^9}, {3.682135860843622*^9, 
  3.68213590604279*^9}, {3.68213618568095*^9, 3.682136209993085*^9}, {
  3.682136596535293*^9, 3.68213659853424*^9}, {3.682141087988123*^9, 
  3.6821410982907047`*^9}, {3.682142560340249*^9, 3.682142636129263*^9}}],

Cell["and our final condition a+b+c<0 is", "Text",
 CellChangeTimes->{{3.678803649407956*^9, 3.678803654081893*^9}, {
   3.6788053785896177`*^9, 3.678805380997744*^9}, {3.678841377839574*^9, 
   3.678841379596589*^9}, {3.678846310941874*^9, 3.678846311165923*^9}, {
   3.678846365316596*^9, 3.678846371932901*^9}, 3.68190486818493*^9, {
   3.6820744248656063`*^9, 3.682074428658678*^9}, {3.682075474227734*^9, 
   3.682075478252342*^9}, {3.682076943070528*^9, 3.682076950907119*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"acoef0", "/", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"maleMeanFit", "/", "meanM"}], ")"}], "2"]}], "+", 
          RowBox[{"bcoef0", "/", 
           RowBox[{"(", 
            RowBox[{"maleMeanFit", "/", "meanM"}], ")"}]}], "+", "ccoef0"}], 
         ")"}], "<", "0"}], "/.", "gassub"}], "/.", "gAssub"}], "/.", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "male"}]], "\[Rule]", 
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "male"}]]}]}], "//", "Simplify"}], ",", 
   RowBox[{"{", 
    RowBox[{"meanM", ",", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "male"}]]}], "}"}], ",", "Simplify"}], 
  "]"}]], "Input",
 CellChangeTimes->{
  3.6819186061722803`*^9, {3.681918730408938*^9, 3.681918740649404*^9}, {
   3.6819187744500637`*^9, 3.681918810085658*^9}, {3.681918917500854*^9, 
   3.681918991367647*^9}, {3.68207270511596*^9, 3.6820727779319553`*^9}, {
   3.6820729165752974`*^9, 3.682072916751048*^9}, {3.682074413428846*^9, 
   3.682074415553273*^9}, {3.682075480755356*^9, 3.682075487160922*^9}, {
   3.682135890801907*^9, 3.682135892951301*^9}, {3.682141102704295*^9, 
   3.682141104099745*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gas", " ", "gAs", " ", 
    SuperscriptBox["meanM", "2"]}], "+", 
   RowBox[{"meanM", " ", "r", " ", "R", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"-", "gAs"}], " ", "pXf", " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "male"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "female"}]]}], "+", 
      RowBox[{"gas", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pXf"}], ")"}], " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "female"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "male"}]]}]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "male"}]]}]}], "<", "0"}]], "Output",
 CellChangeTimes->{
  3.681918572925273*^9, 3.681918606886701*^9, {3.6819187308962708`*^9, 
   3.68191874093325*^9}, {3.6819187831120443`*^9, 3.6819188104237127`*^9}, 
   3.6819188875906143`*^9, 3.6819189191118*^9, {3.6819189505788927`*^9, 
   3.681918991796973*^9}, {3.682072742840137*^9, 3.6820727785851097`*^9}, 
   3.682072830321917*^9, 3.682072864375649*^9, 3.682072917215744*^9, 
   3.682073973360104*^9, 3.682074417019013*^9, 3.682075488294463*^9, 
   3.682075729852219*^9, {3.682076247959779*^9, 3.682076270770035*^9}, {
   3.6820764027849703`*^9, 3.682076426488117*^9}, 3.682076541792549*^9, {
   3.682076901018712*^9, 3.682076909234456*^9}, 3.682135617472797*^9, {
   3.682135896839862*^9, 3.682135908064682*^9}, {3.682136566301485*^9, 
   3.6821365787637997`*^9}, {3.682141100107986*^9, 3.682141110445961*^9}, {
   3.682142543362563*^9, 3.682142638724777*^9}}]
}, Open  ]],

Cell["which can be rearranged into", "Text",
 CellChangeTimes->{{3.682076957315551*^9, 3.682076963194953*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"r", " ", "R", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pXf", " ", "gAs", " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "male"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "female"}]]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pXf"}], ")"}], " ", "gas", " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "female"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "male"}]]}]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "male"}]]}], ">", 
   RowBox[{"meanM", " ", "gas", " ", "gAs"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6820769733724403`*^9, 3.68207701100252*^9}, {
  3.682135914861047*^9, 3.682135930529286*^9}, {3.6821411128030663`*^9, 
  3.6821411204546537`*^9}}],

Cell["\<\
If both ga>0 and gA>0 then 2a+b>0 and the neo-Y invades. If both gas<0 and \
gAs<0 then a+b+c<0 is never true and the neo-Y will not invade. So the \
interesting part is when one gs is positive and one negative. If we assume, \
without loss of generality, that gAs>0 and gas<0, the product gas gAs is \
negative. Dividing through and flipping the inequality:\
\>", "Text",
 CellChangeTimes->{{3.678845089552334*^9, 3.678845160444935*^9}, 
   3.678846328049347*^9, 3.681904868185585*^9, {3.682056686187016*^9, 
   3.682056729646557*^9}, {3.682056760907091*^9, 3.6820567859103727`*^9}, {
   3.6820568469095783`*^9, 3.682056944805656*^9}, {3.68205710368909*^9, 
   3.682057103898336*^9}, {3.682067950834725*^9, 3.6820679520530567`*^9}, {
   3.682077031261086*^9, 3.68207703751306*^9}, {3.6821359337426577`*^9, 
   3.682135980316546*^9}, {3.6821360167583*^9, 3.682136022613071*^9}, {
   3.6821407008899813`*^9, 3.682140701020369*^9}, {3.68214112726053*^9, 
   3.6821411586928167`*^9}, {3.682141684924884*^9, 3.682141710615905*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"r", " ", "R", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pXf"}], ")"}], "  ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "female"}]], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "male"}]]}], "gAs"], "+", 
      FractionBox[
       RowBox[{"pXf", " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "female"}]], " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "male"}]]}], "gas"]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "male"}]]}], "<", " ", "meanM"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.678845120164757*^9, 3.6788451205308228`*^9}, {
   3.678845164017808*^9, 3.678845206833847*^9}, {3.678846328050565*^9, 
   3.678846331194606*^9}, 3.681904868185891*^9, {3.6820566735977182`*^9, 
   3.682056680097406*^9}, {3.6820569521544743`*^9, 3.682056966932479*^9}, {
   3.682057001450542*^9, 3.68205701341922*^9}, {3.682057109642288*^9, 
   3.682057196629991*^9}, {3.682057281250379*^9, 3.682057304119631*^9}, 
   3.68205747025915*^9, {3.682057634053491*^9, 3.682057666531451*^9}, 
   3.682067941675747*^9, {3.682067996958975*^9, 3.682068001789633*^9}, {
   3.682077061137084*^9, 3.682077111175147*^9}, {3.682135985297687*^9, 
   3.682135987552332*^9}, {3.682141123172954*^9, 3.6821411245639353`*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["neo-W", "Subsubsection",
 CellChangeTimes->{{3.6819049103666162`*^9, 3.681904911602844*^9}}],

Cell["\<\
When there is no recombination between the VS and modifier locus we have a \
perfect square and eigenvalues\
\>", "Text",
 CellChangeTimes->{{3.678218925956046*^9, 3.67821895338835*^9}, {
  3.678543518836514*^9, 3.6785435239328136`*^9}, {3.68190322106429*^9, 
  3.681903247281014*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"noreceigens1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]", "/.", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "==", 
           RowBox[{"charpolyk1", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "/.", 
          RowBox[{"R", "\[Rule]", "0"}]}], ",", "\[Lambda]"}], "]"}]}], ")"}],
      "*", 
     RowBox[{"(", 
      RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}]}], "/.", 
    RowBox[{"pXm", "\[Rule]", 
     RowBox[{
      RowBox[{"2", "pAveM"}], "-", "pYm"}]}]}], "//", "Simplify"}]}]], "Input",\

 CellChangeTimes->{{3.681903139431856*^9, 3.681903212216094*^9}, {
   3.681903252924161*^9, 3.681903283508576*^9}, {3.6819033172498617`*^9, 
   3.681903349193973*^9}, {3.681903554716239*^9, 3.6819035548718653`*^9}, {
   3.681904256383094*^9, 3.681904256853209*^9}, 3.681904319687405*^9, {
   3.6819049631732073`*^9, 3.681904970534773*^9}, {3.681918052071443*^9, 
   3.681918070023802*^9}, {3.68191816498897*^9, 3.681918193927002*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "female"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "male"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "a", ",", "female"}]]}], "-", 
        RowBox[{"pAveM", " ", 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "male"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "A", ",", "female"}]]}]}], ")"}]}], "meanF"]}], 
   ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "female"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "male"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"A", ",", "a", ",", "female"}]]}], "-", 
        RowBox[{"pAveM", " ", 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "male"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"A", ",", "A", ",", "female"}]]}]}], ")"}]}], "meanF"]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.681903214475835*^9, {3.6819032538349667`*^9, 3.68190328407938*^9}, {
   3.681903319968005*^9, 3.681903350224607*^9}, {3.6819042463472967`*^9, 
   3.681904257578438*^9}, 3.681904320533412*^9, 3.681904973448106*^9, {
   3.681918104779442*^9, 3.681918113935005*^9}, {3.681918177268292*^9, 
   3.681918195251687*^9}, 3.6820509796532917`*^9, 3.682067867288456*^9, 
   3.6821413305913*^9}]
}, Open  ]],

Cell["\<\
The first describes the invasion fitness of w-a haplotypes and the second the \
growth rate of w-A haplotypes (these haplotypes are never broken up because \
R=0, and they always appear in the homorphic sex and so r has no affect).\
\>", "Text",
 CellChangeTimes->{{3.682050888144253*^9, 3.68205096110308*^9}, {
  3.682072209739615*^9, 3.682072253420534*^9}}],

Cell["\<\
The growth rate of the haplotypes without recombination can be used to \
simplify our expressions. To make use of them we will first solve for unique \
elements in each and then use these substitutions later.\
\>", "Text",
 CellChangeTimes->{{3.678803208834538*^9, 3.678803234204862*^9}, {
   3.678803619761446*^9, 3.6788036219774733`*^9}, 3.681904868180386*^9, {
   3.681904920400379*^9, 3.681904938522684*^9}, {3.6820546076102657`*^9, 
   3.682054648556566*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gasubR0", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"noreceigens1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "\[Equal]", "gaR0"}], 
      ",", 
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "a", ",", "female"}]]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"gAsubR0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"noreceigens1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], "\[Equal]", "gAR0"}], 
       ",", 
       SubscriptBox["wDip", 
        RowBox[{"A", ",", "A", ",", "female"}]]}], "]"}], "//", "Simplify"}], 
    "//", "Flatten"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.682054657183845*^9, 3.6820546678559093`*^9}, {
  3.682141273721465*^9, 3.682141291396159*^9}, {3.682141355137361*^9, 
  3.682141360098618*^9}}],

Cell["Our 2a+b<0 condition is then", "Text",
 CellChangeTimes->{{3.67880416570479*^9, 3.678804180447051*^9}, {
   3.678805104382928*^9, 3.678805104765669*^9}, 3.681904868183251*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"acoef1", "/", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}], "2"]}]}], "+", 
         RowBox[{"bcoef1", "/", 
          RowBox[{"(", 
           RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}]}]}], ")"}], "<", 
       "0"}], "/.", 
      RowBox[{"pXm", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "pYm"}], "+", 
        RowBox[{"2", "pAveM"}]}]}]}], "/.", "gAsubR0"}], "/.", "gasubR0"}], 
   ",", 
   RowBox[{"meanF", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.681905326309329*^9, 3.681905422528089*^9}, {
   3.681916867922887*^9, 3.681916951609811*^9}, 3.681916985669846*^9, {
   3.681917017942401*^9, 3.681917041861507*^9}, {3.681917194779866*^9, 
   3.6819171955258417`*^9}, {3.6821412961216707`*^9, 3.682141315975049*^9}, {
   3.6821413631549597`*^9, 3.682141364636923*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"gaR0", "+", "gAR0"}], ")"}], " ", "meanF"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", "R", " ", 
    SubscriptBox["wHap", 
     RowBox[{"a", ",", "male"}]], " ", 
    SubscriptBox["wHap", 
     RowBox[{"A", ",", "female"}]], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "female"}]]}]}], ">", 
  RowBox[{"pAveM", " ", "R", " ", 
   SubscriptBox["wHap", 
    RowBox[{"a", ",", "female"}]], " ", 
   SubscriptBox["wHap", 
    RowBox[{"A", ",", "male"}]], " ", 
   SubscriptBox["wDip", 
    RowBox[{"a", ",", "A", ",", "female"}]]}]}]], "Output",
 CellChangeTimes->{
  3.681905290331477*^9, {3.681905342821418*^9, 3.681905423057828*^9}, {
   3.681916871377392*^9, 3.681916916476166*^9}, 3.68191695230989*^9, 
   3.6819169862835627`*^9, {3.6819170194611177`*^9, 3.6819170422821217`*^9}, 
   3.6819171630559587`*^9, 3.681917195922757*^9, 3.682054686536769*^9, 
   3.682067871437381*^9, 3.682141331031554*^9, 3.682141365134034*^9}]
}, Open  ]],

Cell["\<\
and when the fitness of diploids does not depend from which parent the A and \
a alleles come from, and there is no competition among eggs, we have\
\>", "Text",
 CellChangeTimes->{{3.681917273911067*^9, 3.681917335175859*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "female"}]], "\[Rule]", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "female"}]]}]}], "/.", 
   RowBox[{
    SubscriptBox["wHap", 
     RowBox[{"y_", ",", "female"}]], "\[Rule]", "1"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.681917113113645*^9, 3.681917160579852*^9}, {
  3.681917197803162*^9, 3.681917198595109*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"gaR0", "+", "gAR0"}], ")"}], " ", "meanF"}], "+", 
   RowBox[{"R", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "male"}]]}], "-", 
      RowBox[{"pAveM", " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "male"}]]}]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "female"}]]}]}], ">", "0"}]], "Output",
 CellChangeTimes->{3.681917128502346*^9, 3.6819171650046377`*^9, 
  3.681917199198641*^9, 3.682067878138625*^9, 3.6821413311467733`*^9, 
  3.682141370122883*^9}]
}, Open  ]],

Cell["\<\
n.b., if you instead look at the growth rates of the haplotypes with \
recombination (where double heterozygotes are sometimes lost through \
recombination; we don\[CloseCurlyQuote]t have many triple heterozygotes in \
females when the neo-W is rare because all are XX) this condition becomes \
\>", "Text",
 CellChangeTimes->{{3.678846177746627*^9, 3.6788461948713303`*^9}, {
   3.678846297134678*^9, 3.678846304582315*^9}, 3.681904868184037*^9, {
   3.6819181257275543`*^9, 3.681918148392576*^9}, {3.681918434462582*^9, 
   3.681918438682802*^9}, {3.68214137505406*^9, 3.682141429598567*^9}, 
   3.6821632294677267`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gasub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ga", "==", 
         RowBox[{
          RowBox[{"noreceigens1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "/.", " ", 
        RowBox[{
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "A", ",", "female"}]], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], " ", 
          SubscriptBox["wDip", 
           RowBox[{"a", ",", "A", ",", "female"}]]}]}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"a", ",", "a", ",", "female"}]]}], "]"}], "//", "Simplify"}], 
    "//", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gAsub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gA", "==", 
         RowBox[{
          RowBox[{"noreceigens1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "/.", " ", 
        RowBox[{
         SubscriptBox["wDip", 
          RowBox[{"A", ",", "a", ",", "female"}]], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], " ", 
          SubscriptBox["wDip", 
           RowBox[{"A", ",", "a", ",", "female"}]]}]}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"A", ",", "A", ",", "female"}]]}], "]"}], "//", "Simplify"}], 
    "//", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"acoef1", "/", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}], "2"]}]}], "+", 
          RowBox[{"bcoef1", "/", 
           RowBox[{"(", 
            RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}]}]}], ")"}], "/", 
        SuperscriptBox["meanF", "2"]}], "<", "0"}], "/.", 
      RowBox[{"pXm", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "pYm"}], "+", 
        RowBox[{"2", "pAveM"}]}]}]}], "/.", "gAsub"}], "/.", "gasub"}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "female"}]], "\[Rule]", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "female"}]]}]}], "/.", 
   RowBox[{"ga", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "gA"}], "+", 
     RowBox[{"2", "gmean"}]}]}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.681918233431054*^9, 3.681918421388166*^9}, {
   3.681918469375478*^9, 3.6819184696386013`*^9}, {3.681918866852846*^9, 
   3.681918908154718*^9}, 3.682075570346508*^9, {3.682141251053735*^9, 
   3.682141253114156*^9}, {3.68214134600408*^9, 3.68214134740231*^9}, {
   3.6821414396941357`*^9, 3.682141452148271*^9}}],

Cell[BoxData[
 RowBox[{"gmean", ">", "0"}]], "Output",
 CellChangeTimes->{{3.68191839577896*^9, 3.681918419133647*^9}, 
   3.681918470286449*^9, {3.681918870254158*^9, 3.6819188780079813`*^9}, 
   3.681918908932249*^9, 3.6820678797229843`*^9, 3.6820755708955708`*^9, 
   3.682076174531219*^9, 3.682141454119433*^9}]
}, Open  ]],

Cell["\<\
which only requires that the mean haplotype growth rate is greater than 0.\
\>", "Text",
 CellChangeTimes->{{3.681918458602993*^9, 3.681918483788617*^9}, {
  3.682142906295642*^9, 3.682142907171076*^9}}],

Cell["\<\
Using the no recombination growth rate definitions, our final condition is\
\>", "Text",
 CellChangeTimes->{{3.678803649407956*^9, 3.678803654081893*^9}, {
   3.6788053785896177`*^9, 3.678805380997744*^9}, {3.678841377839574*^9, 
   3.678841379596589*^9}, {3.678846310941874*^9, 3.678846311165923*^9}, {
   3.678846365316596*^9, 3.678846371932901*^9}, 3.68190486818493*^9, {
   3.682141584054723*^9, 3.6821415917267*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"acoef1", "/", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}], "2"]}], "+", 
            RowBox[{"bcoef1", "/", 
             RowBox[{"(", 
              RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}]}], "+", 
            "ccoef1"}], ")"}], "/", "meanF"}], "<", "0"}], "/.", 
        RowBox[{"pXm", "\[Rule]", 
         RowBox[{
          RowBox[{"-", "pYm"}], "+", 
          RowBox[{"2", "pAveM"}]}]}]}], "/.", "gasubR0"}], "/.", "gAsubR0"}], 
     "/.", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "female"}]], "\[Rule]", 
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "female"}]]}]}], "//", "Simplify"}], ",", 
   RowBox[{"{", 
    RowBox[{"meanF", ",", "R", ",", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "female"}]]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.6819186061722803`*^9, {3.681918730408938*^9, 3.681918740649404*^9}, {
   3.6819187744500637`*^9, 3.681918810085658*^9}, {3.681918917500854*^9, 
   3.681918991367647*^9}, {3.6820761250881567`*^9, 3.682076145812059*^9}, {
   3.6820761774085407`*^9, 3.6820762023645697`*^9}, {3.682141534967753*^9, 
   3.682141570805162*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gaR0", " ", "gAR0", " ", "meanF"}], "+", 
   RowBox[{"R", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"gaR0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "male"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "female"}]]}], "-", 
      RowBox[{"gAR0", " ", "pAveM", " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "female"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "male"}]]}]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "female"}]]}]}], "<", "0"}]], "Output",
 CellChangeTimes->{
  3.681918572925273*^9, 3.681918606886701*^9, {3.6819187308962708`*^9, 
   3.68191874093325*^9}, {3.6819187831120443`*^9, 3.6819188104237127`*^9}, 
   3.6819188875906143`*^9, 3.6819189191118*^9, {3.6819189505788927`*^9, 
   3.681918991796973*^9}, 3.682067849014511*^9, 3.6820678823357773`*^9, {
   3.6820761277323503`*^9, 3.6820761470841093`*^9}, {3.682076180147532*^9, 
   3.682076203757696*^9}, 3.682141540351841*^9, 3.6821415716569557`*^9}]
}, Open  ]],

Cell["We can rearrange this into", "Text",
 CellChangeTimes->{{3.682057081828285*^9, 3.682057090379334*^9}, {
  3.682057506051239*^9, 3.682057506085292*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"R", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pAveM"}], ")"}], " ", "gaR0", " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "male"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "female"}]]}], "+", 
      RowBox[{"pAveM", " ", "gAR0", " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "female"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "male"}]]}]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "female"}]]}], ">", 
   RowBox[{"meanF", " ", "gaR0", " ", "gAR0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682056624210589*^9, 3.6820566593421173`*^9}, {
  3.682057027961835*^9, 3.682057078300086*^9}, {3.682057521316187*^9, 
  3.6820576037588177`*^9}, {3.682067921253766*^9, 3.6820679447029257`*^9}, {
  3.682142961069292*^9, 3.682142979895771*^9}}],

Cell["\<\
If both gA>0 and gA>0 then 2a+b>0 and the modifier invades. If both gAR0<0 \
and gaR0<0 then a+b+c<0 is never true and the modifier will not invade. So \
the interesting part is when one gR0 is positive and one negative. If we \
assume, without loss of generality, that gAR0>0 and gaR0<0, the product gAR0 \
gaR0 is negative. Dividing through and flipping the inequality:\
\>", "Text",
 CellChangeTimes->{{3.678845089552334*^9, 3.678845160444935*^9}, 
   3.678846328049347*^9, 3.681904868185585*^9, {3.682056686187016*^9, 
   3.682056729646557*^9}, {3.682056760907091*^9, 3.6820567859103727`*^9}, {
   3.6820568469095783`*^9, 3.682056944805656*^9}, {3.68205710368909*^9, 
   3.682057103898336*^9}, {3.682067950834725*^9, 3.6820679520530567`*^9}, {
   3.682163120154984*^9, 3.682163203206229*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"R", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pAveM"}], ")"}], "  ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "male"}]], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "female"}]]}], "gAR0"], "+", 
      FractionBox[
       RowBox[{"pAveM", " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "female"}]], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "male"}]]}], "gaR0"]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "female"}]]}], "<", " ", "meanF"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.678845120164757*^9, 3.6788451205308228`*^9}, {
   3.678845164017808*^9, 3.678845206833847*^9}, {3.678846328050565*^9, 
   3.678846331194606*^9}, 3.681904868185891*^9, {3.6820566735977182`*^9, 
   3.682056680097406*^9}, {3.6820569521544743`*^9, 3.682056966932479*^9}, {
   3.682057001450542*^9, 3.68205701341922*^9}, {3.682057109642288*^9, 
   3.682057196629991*^9}, {3.682057281250379*^9, 3.682057304119631*^9}, 
   3.68205747025915*^9, {3.682057634053491*^9, 3.682057666531451*^9}, 
   3.682067941675747*^9, {3.682067996958975*^9, 3.682068001789633*^9}, {
   3.682142982762663*^9, 3.682142985906283*^9}}]
}, Closed]]
}, Closed]],

Cell[CellGroupData[{

Cell["Check Comparison to Kozielska et al 2010", "Subsection",
 CellChangeTimes->{{3.678843744202237*^9, 3.678843749002348*^9}, {
   3.678843835296521*^9, 3.6788438440723333`*^9}, {3.6819046254135923`*^9, 
   3.681904625598483*^9}, {3.681904835586547*^9, 3.681904838271055*^9}, {
   3.682050001837984*^9, 3.6820500040553913`*^9}, 3.6821478499653053`*^9}],

Cell["\<\
This study finds that feminizing mutations invade, apparently to equalize the \
sex ratio\
\>", "Text",
 CellChangeTimes->{{3.678843856632169*^9, 3.67884388666402*^9}}],

Cell["\<\
We also see the same result as Kozielska et al 2010 (Heredity 104:100), \
where, without diploid selection, the W invades if the Y is \
\[OpenCurlyQuote]driving\[CloseCurlyQuote]\
\>", "Text",
 CellChangeTimes->{{3.678547246454558*^9, 3.6785473231291*^9}, {
  3.67884385326229*^9, 3.678843853832396*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tryKozi", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"pXf", "\[Rule]", "1"}], ",", 
     RowBox[{"pXm", "\[Rule]", "1"}], ",", 
     RowBox[{"pYm", "\[Rule]", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678546860181889*^9, 3.678546878743849*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            RowBox[{"charpoly\[Alpha]1", "/.", "weaksel"}], "/.", "tryKozi"}],
            "/.", 
           RowBox[{"\[Lambda]", "\[Rule]", 
            RowBox[{"1", "+", 
             RowBox[{"\[Delta]\[Lambda]", "*", "\[Epsilon]"}]}]}]}], ")"}], 
         ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
      "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]"}], "]"}], "/.", 
   RowBox[{
    SubscriptBox["sDip", "female"], "\[Rule]", "0"}]}], "/.", 
  RowBox[{
   SubscriptBox["sHap", "female"], "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.6821474153847427`*^9, 3.6821475033873453`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]", "\[Rule]", 
    FractionBox[
     SubscriptBox["sHap", "male"], "2"]}], "}"}], "}"}]], "Output",
 CellChangeTimes->{{3.6821474024879293`*^9, 3.682147425072431*^9}, 
   3.682147463069479*^9, {3.6821474933592033`*^9, 3.6821475038093767`*^9}}]
}, Open  ]],

Cell["\<\
but this is not a stable resident equilibrium. It can only happen if r=0 and \
A mutates to a on the Y (or a mutates to A on the X) and no more mutations \
occur.\
\>", "Text",
 CellChangeTimes->{{3.67854735250668*^9, 3.6785474199657097`*^9}}],

Cell["We can also do this without assuming weak selection", "Text",
 CellChangeTimes->{{3.678548000504784*^9, 3.678548009157091*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"0", "==", "charpoly\[Alpha]1"}], "/.", "tryKozi"}], ",", 
       "\[Lambda]"}], "]"}], "/.", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"yM_", ",", "yP_", ",", "female"}]], "\[Rule]", "1"}]}], "/.", 
    
    RowBox[{
     SubscriptBox["wHap", 
      RowBox[{"y_", ",", "female"}]], "\[Rule]", "1"}]}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"R", ">", "0"}], ",", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "male"}]], ">", "0"}], ",", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "male"}]], ">", "0"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.6821475678259163`*^9, 3.682147766019215*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{
      FractionBox["1", "2"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        FractionBox[
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "male"}]], 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "male"}]]]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"\[Lambda]", "\[Rule]", 
     RowBox[{"-", 
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["wHap", 
           RowBox[{"a", ",", "male"}]], "+", 
          SubscriptBox["wHap", 
           RowBox[{"A", ",", "male"}]]}], ")"}]}], 
       RowBox[{"2", " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "male"}]]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.682147609979455*^9, 3.682147634214789*^9}, {
   3.682147674849794*^9, 3.682147713203792*^9}, 3.682147766770252*^9}]
}, Open  ]],

Cell[TextData[{
 "So, invasion occurs if the Y is \[OpenCurlyQuote]driving\[CloseCurlyQuote] \
(",
 Cell[BoxData[
  RowBox[{
   SubscriptBox["wHap", 
    RowBox[{"a", ",", "male"}]], ">", 
   SubscriptBox["wHap", 
    RowBox[{"A", ",", "male"}]]}]],
  CellChangeTimes->{{3.682147609979455*^9, 3.682147634214789*^9}, {
    3.682147674849794*^9, 3.682147713203792*^9}, 3.682147766770252*^9}],
 ")."
}], "Text",
 CellChangeTimes->{{3.6788438284022417`*^9, 3.678843832008451*^9}, {
  3.678843891799221*^9, 3.678843943006238*^9}, {3.682147803000388*^9, 
  3.682147810070758*^9}}]
}, Closed]]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
B. Maternal control (ESD invades XY)\
\>", "Title",
 CellChangeTimes->{{3.6773584010554647`*^9, 3.677358404404995*^9}, {
  3.6785428640021276`*^9, 3.678542882864291*^9}, {3.6786475963911467`*^9, 
  3.678647596861117*^9}, {3.678752668970196*^9, 3.67875267710258*^9}, {
  3.678768551946721*^9, 3.678768554241973*^9}, {3.679938431879974*^9, 
  3.679938461056119*^9}, {3.680382895155089*^9, 3.68038289825213*^9}, {
  3.681737201594561*^9, 3.681737205530183*^9}, {3.681891541155162*^9, 
  3.6818915467384233`*^9}, {3.681891595994844*^9, 3.6818916006477222`*^9}, {
  3.681891831095961*^9, 3.6818918329400253`*^9}, {3.682050066454397*^9, 
  3.682050066807276*^9}}],

Cell[CellGroupData[{

Cell["Life-cycle", "Section",
 CellChangeTimes->{{3.681743786104041*^9, 3.6817437925740137`*^9}, {
  3.681891628103559*^9, 3.681891629445764*^9}, {3.6818919388791723`*^9, 
  3.6818919406495113`*^9}}],

Cell["Haploid selection", "Text",
 CellChangeTimes->{{3.681891686589344*^9, 3.681891691112186*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["wbarHap", "sex_"], ":=", 
   RowBox[{
    SubscriptBox["wbarHap", "sex"], "=", 
    RowBox[{"ParallelSum", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["wHap", 
        RowBox[{"y", ",", "sex"}]], 
       SubscriptBox["fHap", 
        RowBox[{"x", ",", "y", ",", "z", ",", "sex", ",", "zzPar"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"x", ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"y", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"z", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zzPar", ",", 
        RowBox[{"{", 
         RowBox[{"MM", ",", "Mm", ",", "mm"}], "}"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["fHapSel", 
   RowBox[{"x_", ",", "y_", ",", "z_", ",", "sex_", ",", "zzPar_"}]], ":=", 
  RowBox[{
   SubscriptBox["wHap", 
    RowBox[{"y", ",", "sex"}]], 
   RowBox[{
    SubscriptBox["fHap", 
     RowBox[{"x", ",", "y", ",", "z", ",", "sex", ",", "zzPar"}]], "/", 
    SubscriptBox["wbarHap", "sex"]}]}]}]}], "Input",
 CellChangeTimes->{{3.68174069177772*^9, 3.681740709745438*^9}, {
  3.6817407470528183`*^9, 3.681740792567976*^9}, {3.681743989430183*^9, 
  3.681743993228486*^9}, {3.681744694112637*^9, 3.681744695061598*^9}}],

Cell["Random mating", "Text",
 CellChangeTimes->{{3.681891694673705*^9, 3.681891695994638*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fDip", 
   RowBox[{
   "xM_", ",", "yM_", ",", "zM_", ",", "xP_", ",", "yP_", ",", "zP_", ",", 
    "zzM_"}]], ":=", 
  RowBox[{
   SubscriptBox["fDip", 
    RowBox[{
    "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
     "zzM"}]], "=", 
   RowBox[{"ParallelSum", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["fHapSel", 
       RowBox[{"xM", ",", "yM", ",", "zM", ",", "female", ",", "zzM"}]], 
      SubscriptBox["fHapSel", 
       RowBox[{"xP", ",", "yP", ",", "zP", ",", "male", ",", "zzP"}]]}], ",", 
     
     RowBox[{"{", 
      RowBox[{"zzP", ",", 
       RowBox[{"{", 
        RowBox[{"MM", ",", "Mm", ",", "mm"}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.681740852705102*^9, 3.681740881236745*^9}, {
   3.681741102397697*^9, 3.681741112150375*^9}, 3.6817438071282473`*^9, 
   3.68174469800976*^9}],

Cell["Sex determination", "Text",
 CellChangeTimes->{{3.681891698112686*^9, 3.681891700445334*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fDipSex", 
   RowBox[{
   "xM_", ",", "yM_", ",", "zM_", ",", "xP_", ",", "yP_", ",", "zP_", ",", 
    "sex_"}]], ":=", 
  RowBox[{
   SubscriptBox["fDipSex", 
    RowBox[{
    "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
     "sex"}]], "=", 
   RowBox[{"ParallelSum", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["fDip", 
       RowBox[{
       "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
        "zzM"}]], 
      SubscriptBox["psex", 
       RowBox[{"xP", ",", "zzM", ",", "sex"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"zzM", ",", 
       RowBox[{"{", 
        RowBox[{"MM", ",", "Mm", ",", "mm"}], "}"}]}], "}"}]}], 
    "]"}]}]}]], "Input",
 CellChangeTimes->{{3.681740916059374*^9, 3.681740941165064*^9}, {
   3.6817411271569843`*^9, 3.68174113488159*^9}, 3.681744699086836*^9}],

Cell["where a diploid must become male or female", "Text",
 CellChangeTimes->{3.681891721281485*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"sumsex", "=", 
   RowBox[{
    SubscriptBox["psex", 
     RowBox[{"xP_", ",", "zzM_", ",", "male"}]], "\[Rule]", 
    RowBox[{"1", "-", 
     SubscriptBox["psex", 
      RowBox[{"xP", ",", "zzM", ",", "female"}]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681740963151202*^9, 3.681741006588331*^9}}],

Cell["\<\
We assume the invasion of a dominant modifier into an XY system\
\>", "Text",
 CellChangeTimes->{3.681891739570177*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"invXY", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"Y", ",", "MM", ",", "female"}]], "\[Rule]", "0"}], ",", 
     RowBox[{"(*", 
      RowBox[{
      "always", " ", "male", " ", "if", " ", "mother", " ", "wildtype", " ", 
       "at", " ", "ESD", " ", "and", " ", "get", " ", "Y", " ", "from", " ", 
       "father"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"X", ",", "MM", ",", "female"}]], "\[Rule]", "1"}], ",", 
     RowBox[{"(*", 
      RowBox[{
      "always", " ", "female", " ", "if", " ", "mother", " ", "wildtype", " ",
        "at", " ", "ESD", " ", "and", " ", "get", " ", "X", " ", "from", " ", 
       "father"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["fHap", 
       RowBox[{"Y", ",", "y_", ",", "z_", ",", "female", ",", "MM"}]], 
      "\[Rule]", "0"}], ",", 
     RowBox[{"(*", 
      RowBox[{
      "no", " ", "Y", " ", "chromosome", " ", "in", " ", "eggs", " ", "if", 
       " ", "mother", " ", "was", " ", "homozygous", " ", "wildtype", " ", 
       "at", " ", "ESD"}], "*)"}], "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"xP_", ",", "Mm", ",", "female"}]], "\[Rule]", "k"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["psex", 
       RowBox[{"xP_", ",", "mm", ",", "female"}]], "\[Rule]", "k"}]}], 
    RowBox[{"(*", 
     RowBox[{
     "female", " ", "with", " ", "probability", " ", "k", " ", "if", " ", 
      "mother", " ", "had", " ", "mutation", " ", "at", " ", "the", " ", 
      "ESD"}], "*)"}], "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678749250078711*^9, 3.678749257734652*^9}, {
   3.678749341105864*^9, 3.678749495395021*^9}, {3.679945123194168*^9, 
   3.679945148394607*^9}, {3.6799451869399347`*^9, 3.679945240579802*^9}, {
   3.679945289781743*^9, 3.679945339491596*^9}, {3.6799453844002123`*^9, 
   3.679945402746641*^9}, {3.6799454634914007`*^9, 3.6799455567240467`*^9}, {
   3.6799484238045397`*^9, 3.679948455123131*^9}, {3.67994848956713*^9, 
   3.679948517654551*^9}, {3.679948569319213*^9, 3.679948570835786*^9}, {
   3.679951538898012*^9, 3.679951549755542*^9}, {3.68037305678191*^9, 
   3.680373067198072*^9}, {3.6803822046986856`*^9, 3.680382207715699*^9}, {
   3.680382278235017*^9, 3.68038254183022*^9}, {3.6803826726056223`*^9, 
   3.6803827011867247`*^9}, {3.681481533121539*^9, 3.681481811404159*^9}, {
   3.681482143533368*^9, 3.681482144703322*^9}, {3.681736556313373*^9, 
   3.681736594419837*^9}, {3.681736645992744*^9, 3.6817366988928537`*^9}, {
   3.681736750338529*^9, 3.681736811785675*^9}, {3.681736847176927*^9, 
   3.681736957382381*^9}, {3.6817438697025414`*^9, 3.681743921107368*^9}, 
   3.6817443638221292`*^9, {3.68189172589712*^9, 3.681891726048924*^9}}],

Cell["Diploid selection", "Text",
 CellChangeTimes->{{3.6818917438809023`*^9, 3.6818917494489202`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   SubscriptBox["wbarDip", "sex_"], ":=", 
   RowBox[{
    SubscriptBox["wbarDip", "sex"], "=", 
    RowBox[{"ParallelSum", "[", 
     RowBox[{
      RowBox[{
       SubscriptBox["wDip", 
        RowBox[{"yM", ",", "yP", ",", "sex"}]], 
       SubscriptBox["fDipSex", 
        RowBox[{
        "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
         "sex"}]]}], ",", 
      RowBox[{"{", 
       RowBox[{"xM", ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"yM", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zM", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"xP", ",", 
        RowBox[{"{", 
         RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"yP", ",", 
        RowBox[{"{", 
         RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"zP", ",", 
        RowBox[{"{", 
         RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  SubscriptBox["fDipSel", 
   RowBox[{
   "xM_", ",", "yM_", ",", "zM_", ",", "xP_", ",", "yP_", ",", "zP_", ",", 
    "sex_"}]], ":=", 
  RowBox[{
   SubscriptBox["fDipSel", 
    RowBox[{
    "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
     "sex"}]], "=", 
   RowBox[{
    SubscriptBox["wDip", 
     RowBox[{"yM", ",", "yP", ",", "sex"}]], 
    RowBox[{
     SubscriptBox["fDipSex", 
      RowBox[{
      "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
       "sex"}]], "/", 
     SubscriptBox["wbarDip", "sex"]}]}]}]}]}], "Input",
 CellChangeTimes->{{3.6814776843785267`*^9, 3.681477897180252*^9}, {
   3.6814779428772593`*^9, 3.6814780164069233`*^9}, {3.681478227321601*^9, 
   3.681478243595066*^9}, {3.681481833880354*^9, 3.6814818456087008`*^9}, {
   3.6817392306929207`*^9, 3.681739316847645*^9}, {3.6817439550643167`*^9, 
   3.681743978122819*^9}, {3.681744013982086*^9, 3.681744051569847*^9}, 
   3.6817447019132853`*^9}],

Cell["Meiosis", "Text",
 CellChangeTimes->{{3.681891756567326*^9, 3.681891758132327*^9}}],

Cell[BoxData[
 RowBox[{
  SubscriptBox["fHapNext", 
   RowBox[{"x_", ",", "y_", ",", "z_", ",", "sex_", ",", "zzPar_"}]], ":=", 
  RowBox[{
   SubscriptBox["fHapNext", 
    RowBox[{"x", ",", "y", ",", "z", ",", "sex", ",", "zzPar"}]], "=", 
   RowBox[{"ParallelSum", "[", 
    RowBox[{
     RowBox[{
      SubscriptBox["fDipSel", 
       RowBox[{
       "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
        "sex"}]], 
      SubscriptBox["pseg", 
       RowBox[{
       "xM", ",", "yM", ",", "zM", ",", "xP", ",", "yP", ",", "zP", ",", 
        "sex", ",", "x", ",", "y", ",", "z", ",", "zzPar"}]]}], ",", 
     RowBox[{"{", 
      RowBox[{"xM", ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yM", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zM", ",", 
       RowBox[{"{", 
        RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"xP", ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"yP", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zP", ",", 
       RowBox[{"{", 
        RowBox[{"M", ",", "m"}], "}"}]}], "}"}]}], "]"}]}]}]], "Input",
 CellChangeTimes->{{3.6817440705483007`*^9, 3.6817440908841143`*^9}, {
  3.681744703057055*^9, 3.6817447059212723`*^9}}],

Cell["Segregation rules", "Text",
 CellChangeTimes->{{3.6818917606553392`*^9, 3.681891764115509*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"pseg0", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"triple", " ", "homozygote"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "M", ",", "x1_", ",", "y1_", ",", "M", ",", 
        "sex_", ",", "x1_", ",", "y1_", ",", "M", ",", "MM"}]], "\[Rule]", 
      "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "m", ",", "x1_", ",", "y1_", ",", "m", ",", 
        "sex_", ",", "x1_", ",", "y1_", ",", "m", ",", "mm"}]], "\[Rule]", 
      "1"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y1_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      "0"}]}], "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg1", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"single", " ", "heterozygotes"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "M", ",", "x2_", ",", "y1_", ",", "M", ",", 
        "sex_", ",", "x1_", ",", "y1_", ",", "M", ",", "MM"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "M", ",", "x2_", ",", "y1_", ",", "M", ",", 
        "sex_", ",", "x2_", ",", "y1_", ",", "M", ",", "MM"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "M", ",", "x1_", ",", "y2_", ",", "M", ",", 
        "sex_", ",", "x1_", ",", "y1_", ",", "M", ",", "MM"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "M", ",", "x1_", ",", "y2_", ",", "M", ",", 
        "sex_", ",", "x1_", ",", "y2_", ",", "M", ",", "MM"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "m", ",", "x2_", ",", "y1_", ",", "m", ",", 
        "sex_", ",", "x1_", ",", "y1_", ",", "M", ",", "mm"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "m", ",", "x2_", ",", "y1_", ",", "m", ",", 
        "sex_", ",", "x2_", ",", "y1_", ",", "M", ",", "mm"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "m", ",", "x1_", ",", "y2_", ",", "m", ",", 
        "sex_", ",", "x1_", ",", "y1_", ",", "M", ",", "mm"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "m", ",", "x1_", ",", "y2_", ",", "m", ",", 
        "sex_", ",", "x1_", ",", "y2_", ",", "M", ",", "mm"}]], "\[Rule]", 
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z1_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y2_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y2_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y2_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{"1", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z2_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{"1", "/", "2"}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg2", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"double", " ", "heterozygotes"}], "*)"}], "\[IndentingNewLine]", 
    
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "M", ",", "x2_", ",", "y2_", ",", "M", ",", 
        "sex_", ",", "x1_", ",", "y1_", ",", "M", ",", "MM"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "M", ",", "x2_", ",", "y2_", ",", "M", ",", 
        "sex_", ",", "x2_", ",", "y2_", ",", "M", ",", "MM"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "M", ",", "x2_", ",", "y2_", ",", "M", ",", 
        "sex_", ",", "x2_", ",", "y1_", ",", "M", ",", "MM"}]], "\[Rule]", 
      RowBox[{"r", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "M", ",", "x2_", ",", "y2_", ",", "M", ",", 
        "sex_", ",", "x1_", ",", "y2_", ",", "M", ",", "MM"}]], "\[Rule]", 
      RowBox[{"r", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "m", ",", "x2_", ",", "y2_", ",", "m", ",", 
        "sex_", ",", "x1_", ",", "y1_", ",", "m", ",", "mm"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "m", ",", "x2_", ",", "y2_", ",", "m", ",", 
        "sex_", ",", "x2_", ",", "y2_", ",", "m", ",", "mm"}]], "\[Rule]", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "m", ",", "x2_", ",", "y2_", ",", "m", ",", 
        "sex_", ",", "x2_", ",", "y1_", ",", "m", ",", "mm"}]], "\[Rule]", 
      RowBox[{"r", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "m", ",", "x2_", ",", "y2_", ",", "m", ",", 
        "sex_", ",", "x1_", ",", "y2_", ",", "m", ",", "mm"}]], "\[Rule]", 
      RowBox[{"r", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z1_", ",",
         "sex_", ",", "x2_", ",", "y2_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z1_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z1_", ",",
         "sex_", ",", "x1_", ",", "y2_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      "0"}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y2_", ",", "z2_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y2_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{"R", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x1_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z2_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{"R", "/", "2"}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}]}], "+", 
         RowBox[{"r", " ", "R"}]}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z2_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}], 
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}]}], "+", 
         RowBox[{"r", " ", "R"}]}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", 
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}], "R"}]}], ")"}], "/", "2"}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y1_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z2_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"r", 
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "r"}], ")"}], "R"}]}], ")"}], "/", "2"}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg3", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{"(*", 
     RowBox[{"triple", " ", "heterozygote"}], "*)"}], "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y2_", ",", "z2_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{"r", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y2_", ",", "z2_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{"r", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "R"}], ")"}], "/", "2"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y2_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{"r", " ", 
       RowBox[{"R", "/", "2"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y1_", ",", "z2_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{"r", " ", 
       RowBox[{"R", "/", "2"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x1_", ",", "y1_", ",", "z2_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], 
       RowBox[{"R", "/", "2"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["pseg", 
       RowBox[{
       "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",",
         "sex_", ",", "x2_", ",", "y2_", ",", "z1_", ",", "Mm"}]], "\[Rule]", 
      
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "r"}], ")"}], 
       RowBox[{"R", "/", "2"}]}]}]}], "\[IndentingNewLine]", "}"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"pseg4", "=", 
   RowBox[{
    SubscriptBox["pseg", 
     RowBox[{
     "x1_", ",", "y1_", ",", "z1_", ",", "x2_", ",", "y2_", ",", "z2_", ",", 
      "sex_", ",", "x_", ",", "y_", ",", "z_", ",", "zzM_"}]], "\[Rule]", 
    "0"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.678743407603024*^9, 3.678743407992798*^9}, {
   3.678743451388444*^9, 3.67874370896734*^9}, {3.678743739187004*^9, 
   3.6787437964386272`*^9}, {3.678743835224123*^9, 3.678744092201377*^9}, {
   3.678744261724123*^9, 3.678744264472003*^9}, {3.678745612751544*^9, 
   3.678745641984303*^9}, {3.67874649434549*^9, 3.678746541426771*^9}, {
   3.678746588409*^9, 3.678746681937327*^9}, {3.678746723757894*^9, 
   3.678746726465787*^9}, {3.678747087955186*^9, 3.678747088849813*^9}, 
   3.6787471567075977`*^9, {3.678747281988718*^9, 3.678747345020574*^9}, {
   3.678747431984068*^9, 3.67874755142631*^9}, {3.678747706661974*^9, 
   3.678747816389114*^9}, {3.678747910520447*^9, 3.67874808520201*^9}, {
   3.678748117158371*^9, 3.678748124005247*^9}, 3.6787481598608437`*^9, {
   3.6787483065670223`*^9, 3.6787483117635727`*^9}, {3.67874836658313*^9, 
   3.678748403085204*^9}, {3.6787513544793262`*^9, 3.678751396800355*^9}, {
   3.67994277150476*^9, 3.679942799274077*^9}, {3.679942831090846*^9, 
   3.679942912055253*^9}, {3.679949107745778*^9, 3.679949120757681*^9}, {
   3.679949262229959*^9, 3.679949268375124*^9}, {3.679949476794919*^9, 
   3.679949523563891*^9}, {3.680374604093164*^9, 3.680374627372505*^9}, {
   3.681497799779855*^9, 3.6814978041546593`*^9}, {3.681497949200699*^9, 
   3.681497969730068*^9}, {3.6814980083479347`*^9, 3.68149802692618*^9}, 
   3.681498690728004*^9, {3.681503295313662*^9, 3.681503299933617*^9}, {
   3.681503352635356*^9, 3.681503380988648*^9}, {3.681503421408928*^9, 
   3.681503592682515*^9}, {3.681739639029612*^9, 3.681739667227919*^9}, {
   3.681739710186636*^9, 3.6817397505186863`*^9}, {3.68173979007161*^9, 
   3.6817400224068947`*^9}, {3.6817402086731462`*^9, 3.681740553815752*^9}, 
   3.6817441247473288`*^9, {3.681892497647702*^9, 3.681892547503085*^9}, {
   3.68189315212591*^9, 3.681893154104789*^9}, {3.6818937362624683`*^9, 
   3.681893748754583*^9}}],

Cell[BoxData[
 RowBox[{"(*", 
  RowBox[{
   RowBox[{"ParallelSum", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            SubscriptBox["fHapNext", 
             RowBox[{"x", ",", "y", ",", "z", ",", "sex", ",", "zzM"}]], "/.",
             "sumsex"}], "/.", "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.",
         "pseg2"}], "/.", "pseg3"}], "/.", "pseg4"}], ",", 
     RowBox[{"{", 
      RowBox[{"x", ",", 
       RowBox[{"{", 
        RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"y", ",", 
       RowBox[{"{", 
        RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"z", ",", 
       RowBox[{"{", 
        RowBox[{"M", ",", "m"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"sex", ",", 
       RowBox[{"{", 
        RowBox[{"male", ",", "female"}], "}"}]}], "}"}], ",", 
     RowBox[{"{", 
      RowBox[{"zzM", ",", 
       RowBox[{"{", 
        RowBox[{"MM", ",", "Mm", ",", "mm"}], "}"}]}], "}"}]}], "]"}], "//", 
   "Factor"}], "*)"}]], "Input",
 CellChangeTimes->{{3.67874845755774*^9, 3.678748462275442*^9}, {
   3.678751411807235*^9, 3.6787514131899548`*^9}, 3.678763342644992*^9, {
   3.681478850779172*^9, 3.681478905428947*^9}, 3.681480922347474*^9, {
   3.6814819018647537`*^9, 3.681481902798575*^9}, {3.681740581820306*^9, 
   3.68174061902907*^9}, {3.681744323454342*^9, 3.6817443251285563`*^9}, {
   3.681744645533119*^9, 3.681744653118101*^9}, {3.6818917781212177`*^9, 
   3.681891783121718*^9}, 3.681892565105891*^9}]
}, Closed]],

Cell[CellGroupData[{

Cell["Resident equilibrium (weak selection)", "Section",
 CellChangeTimes->{{3.675694139646326*^9, 3.6756941429682417`*^9}, 
   3.6757029847263803`*^9, {3.675889497088314*^9, 3.675889497307007*^9}, {
   3.675897573374775*^9, 3.675897575830624*^9}, {3.675897716718397*^9, 
   3.6758977222283363`*^9}, 3.676682250170936*^9, 3.676682959070333*^9, {
   3.6767193867939043`*^9, 3.676719388460558*^9}, {3.6785484984643793`*^9, 
   3.678548500198676*^9}, {3.67875273051103*^9, 3.678752732829526*^9}, {
   3.678768538688073*^9, 3.6787685439131317`*^9}}],

Cell["\<\
We begin with no mutations at the modifer locus in haploids or mothers\
\>", "Text",
 CellChangeTimes->{{3.681790894519829*^9, 3.6817909035331917`*^9}, {
  3.6818921035055103`*^9, 3.681892108626658*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"subequil", "=", 
   RowBox[{
    RowBox[{"{", "\[IndentingNewLine]", 
     RowBox[{
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"X", ",", "A", ",", "M", ",", "female", ",", "MM"}]], 
       "\[Rule]", "pXf"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"X", ",", "a", ",", "M", ",", "female", ",", "MM"}]], 
       "\[Rule]", 
       RowBox[{"1", "-", "pXf"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"X", ",", "A", ",", "M", ",", "male", ",", "MM"}]], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]"}], ")"}], " ", "pXm"}]}], ",", 
      "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"X", ",", "a", ",", "M", ",", "male", ",", "MM"}]], "\[Rule]", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "\[Alpha]"}], ")"}], 
        RowBox[{"(", 
         RowBox[{"1", "-", "pXm"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"Y", ",", "A", ",", "M", ",", "male", ",", "MM"}]], "\[Rule]", 
       RowBox[{"\[Alpha]", " ", "pYm"}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"Y", ",", "a", ",", "M", ",", "male", ",", "MM"}]], "\[Rule]", 
       RowBox[{"\[Alpha]", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pYm"}], ")"}]}]}], ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"x_", ",", "y_", ",", "m", ",", "sex_", ",", "zzM_"}]], 
       "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"x_", ",", "y_", ",", "z_", ",", "sex_", ",", "Mm"}]], 
       "\[Rule]", "0"}], ",", "\[IndentingNewLine]", 
      RowBox[{
       SubscriptBox["fHap", 
        RowBox[{"x_", ",", "y_", ",", "z_", ",", "sex_", ",", "mm"}]], 
       "\[Rule]", "0"}]}], "\[IndentingNewLine]", "}"}], "/.", 
    RowBox[{"\[Alpha]", "\[Rule]", 
     RowBox[{"1", "/", "2"}]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.681891966829137*^9, 3.681892091065096*^9}, {
  3.681892384936985*^9, 3.681892388032681*^9}, {3.681892894850363*^9, 
  3.681892897072155*^9}, {3.681893580791315*^9, 3.681893582720182*^9}}],

Cell["\<\
We now wish to solve for the equilibrium frequencies of the haploid genotypes \
in gametes of each sex. Equilibrium is achieved when the following three \
equations are zero (this takes a minute)\
\>", "Text",
 CellChangeTimes->{{3.675694155902801*^9, 3.675694193760104*^9}, {
   3.6756944337868023`*^9, 3.6756944351881227`*^9}, {3.6757029847267847`*^9, 
   3.67570303405547*^9}, {3.675710696458521*^9, 3.675710706286772*^9}, 
   3.6758975924118633`*^9, {3.676719416278571*^9, 3.676719460360141*^9}, {
   3.678763369210025*^9, 3.678763372346648*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"differenceEqs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"{", "\[IndentingNewLine]", 
            RowBox[{
             RowBox[{
              SubscriptBox["fHapNext", 
               RowBox[{"X", ",", "A", ",", "M", ",", "female", ",", "MM"}]], 
              "-", 
              SubscriptBox["fHap", 
               RowBox[{"X", ",", "A", ",", "M", ",", "female", ",", "MM"}]]}],
              ",", "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["fHapNext", 
               RowBox[{"X", ",", "A", ",", "M", ",", "male", ",", "MM"}]], 
              "-", 
              SubscriptBox["fHap", 
               RowBox[{"X", ",", "A", ",", "M", ",", "male", ",", "MM"}]]}], 
             ",", "\[IndentingNewLine]", 
             RowBox[{
              SubscriptBox["fHapNext", 
               RowBox[{"Y", ",", "A", ",", "M", ",", "male", ",", "MM"}]], 
              "-", 
              SubscriptBox["fHap", 
               RowBox[{"Y", ",", "A", ",", "M", ",", "male", ",", "MM"}]]}]}],
             "\[IndentingNewLine]", "}"}], "/.", "subequil"}], "/.", 
          "sumsex"}], "/.", "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.",
       "pseg2"}], "/.", "pseg3"}], "/.", "pseg4"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678750179056045*^9, 3.678750265971582*^9}, 
   3.6787516566515017`*^9, {3.681789829427744*^9, 3.68178992075916*^9}, 
   3.681891166870421*^9, {3.681892134810053*^9, 3.6818921494584208`*^9}}],

Cell["\<\
To simplify the analysis we assume weak selection in both haploids and \
diploids. In addition, we assume selection acts on the VS locus only\
\>", "Text",
 CellChangeTimes->{{3.675694205010009*^9, 3.675694211923259*^9}, 
   3.67570298472752*^9, {3.6757030454432507`*^9, 3.6757030568360033`*^9}, {
   3.678750297640636*^9, 3.678750297774932*^9}, {3.678750454508356*^9, 
   3.6787504833762913`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"weaksel", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "sex_"}]], "\[Rule]", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "sex_"}]], "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["sHap", "sex"], " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "A", ",", "sex_"}]], "\[Rule]", "1"}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "sex_"}]], "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["h", "sex"], " ", 
        SubscriptBox["sDip", "sex"], " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "sex_"}]], "\[Rule]", 
      RowBox[{"1", "+", 
       RowBox[{
        SubscriptBox["h", "sex"], " ", 
        SubscriptBox["sDip", "sex"], " ", "\[Epsilon]"}]}]}], ",", 
     "\[IndentingNewLine]", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "a", ",", "sex_"}]], "\[Rule]", 
      RowBox[{"1", "+", " ", 
       RowBox[{
        SubscriptBox["sDip", "sex"], " ", "\[Epsilon]"}]}]}]}], 
    "\[IndentingNewLine]", "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.67564806523287*^9, 3.675648221558539*^9}, {
   3.675694367971285*^9, 3.6756943845803022`*^9}, 3.6757029847280283`*^9, {
   3.678750304645768*^9, 3.67875045056485*^9}, {3.678750489500865*^9, 
   3.6787505048047533`*^9}, {3.6787505350519323`*^9, 3.678750613437016*^9}, {
   3.678750650976028*^9, 3.678750663356496*^9}, {3.6787515109746723`*^9, 
   3.678751549594288*^9}, {3.681789961959874*^9, 3.6817900838735647`*^9}, {
   3.6818927896623*^9, 3.681892822433525*^9}}],

Cell["We can write the frequencies as Taylor series", "Text",
 CellChangeTimes->{{3.675707045047565*^9, 3.6757070543930063`*^9}, {
  3.675707367038864*^9, 3.675707370179316*^9}, {3.675711803871513*^9, 
  3.6757118112225847`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"frequenciessub", "=", 
   RowBox[{"{", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"pXf", "\[Rule]", 
      RowBox[{"pXf0", "+", 
       RowBox[{"pXf1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pXm", "\[Rule]", 
      RowBox[{"pXm0", "+", 
       RowBox[{"pXm1", " ", "\[Epsilon]"}]}]}], ",", "\[IndentingNewLine]", 
     RowBox[{"pYm", "\[Rule]", 
      RowBox[{"pYm0", "+", 
       RowBox[{"pYm1", " ", "\[Epsilon]"}]}]}]}], "\[IndentingNewLine]", 
    "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675648297857716*^9, 3.6756483630660057`*^9}, 
   3.675648454638584*^9, 3.675702984736863*^9, {3.67589080409908*^9, 
   3.675890831274033*^9}, {3.67742655090767*^9, 3.677426553274468*^9}}],

Cell["\<\
Without selection the recursions for the change in the frequencies are\
\>", "Text",
 CellChangeTimes->{{3.6757032054455214`*^9, 3.6757032697493563`*^9}, {
  3.6757098202812138`*^9, 3.675709824765788*^9}, {3.6757117765596933`*^9, 
  3.6757117850524673`*^9}, {3.675711818872109*^9, 3.6757118199810133`*^9}, {
  3.676719491260041*^9, 3.676719499308044*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs0", "=", 
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", "frequenciessub"}], 
      ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}]}]], "Input",
 CellChangeTimes->{{3.678751736367395*^9, 3.678751737467704*^9}, {
   3.678752209413887*^9, 3.678752212219976*^9}, 3.678752262803892*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf0"}], "+", "pXm0"}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"pXf0", "-", "pXm0", "-", 
      RowBox[{"pXf0", " ", "r"}], "+", 
      RowBox[{"pYm0", " ", "r"}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{"pXf0", "-", "pYm0"}], ")"}], " ", "r"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.67875164051635*^9, {3.678751716032783*^9, 3.6787517378070927`*^9}, 
   3.6787520627432127`*^9, 3.678752212888122*^9, 3.6787523426840563`*^9, 
   3.6787534142533073`*^9, 3.678763399028235*^9, 3.6787637498048763`*^9, 
   3.6787649279812727`*^9, 3.678769190501109*^9, 3.67993779987945*^9, 
   3.681790093930011*^9, 3.681790177016839*^9, 3.6817903134721537`*^9, 
   3.681790666763077*^9, 3.6818910310375347`*^9, 3.681891176521256*^9, 
   3.681892200686782*^9, 3.681892370834182*^9, 3.6818924152983513`*^9, 
   3.6818925983296022`*^9, 3.681892932161289*^9, 3.681893186741912*^9, 
   3.681893778822241*^9, 3.6821505794880953`*^9, 3.6821508884091*^9, 
   3.682150954320681*^9, 3.68215106899339*^9}]
}, Open  ]],

Cell["And at equilibrium we have", "Text",
 CellChangeTimes->{{3.675709831409095*^9, 3.6757098343025913`*^9}, {
  3.675710744701475*^9, 3.675710745621426*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"sol0", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"differenceEqs0", "\[Equal]", "0"}], ",", 
     RowBox[{"{", 
      RowBox[{"pYm0", ",", "pXm0"}], "}"}]}], "]"}], "//", 
   "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.675709931730151*^9, 3.675709948227565*^9}, 
   3.675889715650866*^9, {3.6758903329476337`*^9, 3.675890333531021*^9}, {
   3.675890856683935*^9, 3.6758908599323187`*^9}, {3.678751782137336*^9, 
   3.678751811045862*^9}, 3.678753423267188*^9, {3.6817902045515413`*^9, 
   3.6817902078071213`*^9}, 3.681790677257793*^9, {3.681790714315344*^9, 
   3.6817907157750397`*^9}, {3.681892420689383*^9, 3.6818924337879343`*^9}, 
   3.681892768821603*^9, {3.681893768856921*^9, 3.681893771880123*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"pYm0", "\[Rule]", "pXf0"}], ",", 
   RowBox[{"pXm0", "\[Rule]", "pXf0"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.6757098363525476`*^9, {3.6757099323567266`*^9, 3.675709948639193*^9}, 
   3.675727587389184*^9, 3.675785430130021*^9, 3.67578825590738*^9, 
   3.675889716378837*^9, 3.6758897866812677`*^9, {3.67589020611733*^9, 
   3.675890228462432*^9}, 3.675890334827342*^9, {3.675890851304111*^9, 
   3.675890860292238*^9}, 3.675897787493493*^9, 3.676652896317733*^9, 
   3.676719506219842*^9, 3.676730785030355*^9, 3.676747313194071*^9, 
   3.677426559438837*^9, 3.677594780023625*^9, 3.677957827657529*^9, 
   3.6782088645287457`*^9, 3.678542901403359*^9, 3.678546799300796*^9, {
   3.678751779484501*^9, 3.678751811553813*^9}, 3.67875206282722*^9, 
   3.67875221532375*^9, 3.6787523427641783`*^9, {3.678753416169854*^9, 
   3.678753423756329*^9}, 3.6787633990548487`*^9, 3.678763749842856*^9, 
   3.678764928017548*^9, 3.6787691905324583`*^9, 3.679937799964304*^9, {
   3.6817901817371817`*^9, 3.681790208510619*^9}, 3.681790313605155*^9, {
   3.681790666911725*^9, 3.681790677661216*^9}, 3.681790716129882*^9, 
   3.681891031269878*^9, 3.6818911789722967`*^9, {3.681892417802333*^9, 
   3.681892434238351*^9}, 3.681892600945408*^9, 3.681892769154315*^9, 
   3.681892936912286*^9, 3.6818931926598663`*^9, {3.6818937790093193`*^9, 
   3.68189377907126*^9}, 3.682150587949869*^9, 3.6821509599241943`*^9}]
}, Open  ]],

Cell["\<\
So, with no selection, the equilibrium frequency of A in each gamete/pollen \
type is equal (and we call this pA).\
\>", "Text",
 CellChangeTimes->{{3.675703427939505*^9, 3.6757035626138153`*^9}, {
   3.675706719194449*^9, 3.675706765062245*^9}, 3.67570996472328*^9, {
   3.6757107664993973`*^9, 3.675710849444377*^9}}],

Cell["\<\
Now, looking at only the first order selection terms, the recursions for the \
change in frequency of A in each gamete/pollen type are\
\>", "Text",
 CellChangeTimes->{{3.67570356712366*^9, 3.675703572187316*^9}, {
  3.67570609431063*^9, 3.675706097287983*^9}, {3.6757069069525433`*^9, 
  3.6757069072532797`*^9}, {3.67571091918222*^9, 3.6757109367564697`*^9}, {
  3.675711772412171*^9, 3.67571177325072*^9}, {3.675716463608975*^9, 
  3.67571647265489*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"differenceEqs1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"Collect", "[", 
     RowBox[{
      RowBox[{"Normal", "[", 
       RowBox[{"Series", "[", 
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"differenceEqs", "/.", "weaksel"}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], ",", 
         RowBox[{"{", 
          RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], 
      ",", "\[Epsilon]", ",", "Factor"}], "]"}], "/.", 
    RowBox[{"pXf0", "\[Rule]", "pA"}]}], "//", "Flatten"}]}]], "Input",
 CellChangeTimes->{{3.6757068495866413`*^9, 3.6757068907711554`*^9}, {
   3.6757069302403297`*^9, 3.675706982461239*^9}, {3.675707087605297*^9, 
   3.6757071228419533`*^9}, {3.67570718969317*^9, 3.675707319107386*^9}, {
   3.675707511314725*^9, 3.675707512612761*^9}, {3.675710885258552*^9, 
   3.675710885357044*^9}, {3.675711221036006*^9, 3.675711227798399*^9}, {
   3.675788237526182*^9, 3.6757882495037823`*^9}, {3.67588983758741*^9, 
   3.675889846791771*^9}, {3.675890066524867*^9, 3.67589008440499*^9}, {
   3.675890872602395*^9, 3.6758908784129057`*^9}, 3.675891388889962*^9, 
   3.675897774490415*^9, 3.6774265727397633`*^9, {3.678752346006524*^9, 
   3.678752347228713*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    FractionBox["1", "2"], " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "pXf1"}], "+", "pXm1", "-", 
      RowBox[{"2", " ", "pA", " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{"2", " ", "pA", " ", 
       SubscriptBox["h", "female"], " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      RowBox[{"6", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["h", "female"], " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{"4", " ", 
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["h", "female"], " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      RowBox[{"pA", " ", 
       SubscriptBox["sHap", "female"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "female"]}], "-", 
      RowBox[{"pA", " ", 
       SubscriptBox["sHap", "male"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "male"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{"pXf1", "-", "pXm1", "-", 
      RowBox[{"pXf1", " ", "r"}], "+", 
      RowBox[{"pYm1", " ", "r"}], "-", 
      RowBox[{"pA", " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"pA", " ", 
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      RowBox[{"pA", " ", 
       SubscriptBox["sHap", "female"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "female"]}], "+", 
      RowBox[{"pA", " ", "r", " ", 
       SubscriptBox["sHap", "female"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", 
       SubscriptBox["sHap", "female"]}], "-", 
      RowBox[{"pA", " ", "r", " ", 
       SubscriptBox["sHap", "male"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", 
       SubscriptBox["sHap", "male"]}]}], ")"}]}], ",", 
   RowBox[{
    FractionBox["1", "2"], " ", "\[Epsilon]", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"pXf1", " ", "r"}], "-", 
      RowBox[{"pYm1", " ", "r"}], "-", 
      RowBox[{"pA", " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"pA", " ", 
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      RowBox[{"3", " ", 
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      RowBox[{"2", " ", 
       SuperscriptBox["pA", "3"], " ", 
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      RowBox[{"pA", " ", "r", " ", 
       SubscriptBox["sHap", "female"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", 
       SubscriptBox["sHap", "female"]}], "-", 
      RowBox[{"pA", " ", 
       SubscriptBox["sHap", "male"]}], "+", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", 
       SubscriptBox["sHap", "male"]}], "+", 
      RowBox[{"pA", " ", "r", " ", 
       SubscriptBox["sHap", "male"]}], "-", 
      RowBox[{
       SuperscriptBox["pA", "2"], " ", "r", " ", 
       SubscriptBox["sHap", "male"]}]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.675706852317442*^9, 3.675706918829287*^9}, {
   3.675706950931774*^9, 3.675706982932413*^9}, {3.6757070910767508`*^9, 
   3.675707123327277*^9}, {3.6757071925330353`*^9, 3.675707319486848*^9}, 
   3.675707513296742*^9, 3.67570768217498*^9, {3.675710857628578*^9, 
   3.675710885875184*^9}, {3.675711222477412*^9, 3.67571122814371*^9}, 
   3.67572758892033*^9, 3.675785431200643*^9, 3.6757882566822844`*^9, {
   3.6758898385316772`*^9, 3.675889853071372*^9}, 3.67589008578434*^9, 
   3.675890878782188*^9, 3.6758913896085997`*^9, 3.675897788776071*^9, 
   3.676652896382719*^9, 3.676719670536849*^9, 3.676730785076564*^9, 
   3.676747313246613*^9, {3.677426569551004*^9, 3.677426573382222*^9}, 
   3.677426845387473*^9, 3.677594780245098*^9, 3.6779578277133617`*^9, 
   3.678208864583046*^9, 3.678542901470283*^9, 3.678546799332457*^9, 
   3.67875235287332*^9, 3.67875342792347*^9, 3.678763399188438*^9, 
   3.678763749972834*^9, 3.678764928153727*^9, 3.678769190664701*^9, 
   3.679937800139977*^9, 3.6817903137542667`*^9, 3.681790666984543*^9, 
   3.681790718133628*^9, 3.6818910339655*^9, 3.681891180964037*^9, {
   3.6818927555541267`*^9, 3.681892771638543*^9}, 3.681893784161662*^9, 
   3.682150776356732*^9, 3.682150962682743*^9}]
}, Open  ]],

Cell["\<\
And we can solve for the two of the first order differences and the mean \
frequency of A\
\>", "Text",
 CellChangeTimes->{{3.678752531664937*^9, 3.678752562395914*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"realsol", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"differenceEqs1", "\[Equal]", "0"}], "/.", 
       RowBox[{"pXm1", "\[Rule]", 
        RowBox[{"dpAXmXf", "+", "pXf1"}]}]}], "/.", 
      RowBox[{"pYm1", "\[Rule]", 
       RowBox[{"dpAYmXf", "+", "pXf1"}]}]}], ",", 
     RowBox[{"{", 
      RowBox[{"dpAXmXf", ",", "dpAYmXf", ",", "pA"}], "}"}]}], "]"}], "//", 
   "Factor"}]}]], "Input",
 CellChangeTimes->{{3.678752380284935*^9, 3.678752415079105*^9}, {
  3.678752448870285*^9, 3.6787525243231792`*^9}, {3.678766520981015*^9, 
  3.678766522387198*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpAXmXf", "\[Rule]", "0"}], ",", 
     RowBox[{"dpAYmXf", "\[Rule]", "0"}], ",", 
     RowBox[{"pA", "\[Rule]", "0"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpAXmXf", "\[Rule]", "0"}], ",", 
     RowBox[{"dpAYmXf", "\[Rule]", "0"}], ",", 
     RowBox[{"pA", "\[Rule]", "1"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"dpAXmXf", "\[Rule]", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["sDip", "female"]}], "+", 
            RowBox[{
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"]}], "-", 
            SubscriptBox["sDip", "male"], "+", 
            RowBox[{
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"]}], "-", 
            SubscriptBox["sHap", "female"], "-", 
            SubscriptBox["sHap", "male"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"]}], "+", 
            RowBox[{
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"]}], "+", 
            SubscriptBox["sHap", "female"], "+", 
            SubscriptBox["sHap", "male"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sDip", "male"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sDip", "male"]}], "-", 
            RowBox[{
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "female"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "female"]}], "+", 
            RowBox[{
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "female"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "female"]}], "-", 
            RowBox[{
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "male"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "male"]}], "+", 
            RowBox[{
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "male"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "male"]}]}], ")"}]}], ")"}], "/", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", 
            SubscriptBox["sDip", "female"]}], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "female"], " ", 
            SubscriptBox["sDip", "female"]}], "-", 
           SubscriptBox["sDip", "male"], "+", 
           RowBox[{"2", " ", 
            SubscriptBox["h", "male"], " ", 
            SubscriptBox["sDip", "male"]}]}], ")"}], "3"]}]}]}], ",", 
     RowBox[{"dpAYmXf", "\[Rule]", 
      RowBox[{"-", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", 
             SubscriptBox["sDip", "female"]}], "+", 
            RowBox[{
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"]}], "-", 
            SubscriptBox["sDip", "male"], "+", 
            RowBox[{
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"]}], "-", 
            SubscriptBox["sHap", "female"], "-", 
            SubscriptBox["sHap", "male"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"]}], "+", 
            RowBox[{
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"]}], "+", 
            SubscriptBox["sHap", "female"], "+", 
            SubscriptBox["sHap", "male"]}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sDip", "male"]}], "-", 
            RowBox[{
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sDip", "male"]}], "-", 
            RowBox[{"r", " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "female"]}], "+", 
            RowBox[{"2", " ", "r", " ", 
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "female"]}], "+", 
            RowBox[{
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "female"]}], "-", 
            RowBox[{"r", " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "female"]}], "-", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "female"]}], "+", 
            RowBox[{"2", " ", "r", " ", 
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "female"]}], "-", 
            RowBox[{
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "male"]}], "+", 
            RowBox[{"r", " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "male"]}], "+", 
            RowBox[{"2", " ", 
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "male"]}], "-", 
            RowBox[{"2", " ", "r", " ", 
             SubscriptBox["h", "female"], " ", 
             SubscriptBox["sDip", "female"], " ", 
             SubscriptBox["sHap", "male"]}], "+", 
            RowBox[{"r", " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "male"]}], "-", 
            RowBox[{"2", " ", "r", " ", 
             SubscriptBox["h", "male"], " ", 
             SubscriptBox["sDip", "male"], " ", 
             SubscriptBox["sHap", "male"]}]}], ")"}]}], ")"}], "/", 
        RowBox[{"(", 
         RowBox[{"r", " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", 
              SubscriptBox["sDip", "female"]}], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["h", "female"], " ", 
              SubscriptBox["sDip", "female"]}], "-", 
             SubscriptBox["sDip", "male"], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["h", "male"], " ", 
              SubscriptBox["sDip", "male"]}]}], ")"}], "3"]}], ")"}]}]}]}], 
     ",", 
     RowBox[{"pA", "\[Rule]", 
      FractionBox[
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["sDip", "female"]}], "+", 
        RowBox[{
         SubscriptBox["h", "female"], " ", 
         SubscriptBox["sDip", "female"]}], "-", 
        SubscriptBox["sDip", "male"], "+", 
        RowBox[{
         SubscriptBox["h", "male"], " ", 
         SubscriptBox["sDip", "male"]}], "-", 
        SubscriptBox["sHap", "female"], "-", 
        SubscriptBox["sHap", "male"]}], 
       RowBox[{
        RowBox[{"-", 
         SubscriptBox["sDip", "female"]}], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["h", "female"], " ", 
         SubscriptBox["sDip", "female"]}], "-", 
        SubscriptBox["sDip", "male"], "+", 
        RowBox[{"2", " ", 
         SubscriptBox["h", "male"], " ", 
         SubscriptBox["sDip", "male"]}]}]]}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.678752482888706*^9, 3.678752493868231*^9}, 
   3.6787525257014627`*^9, 3.678753430914579*^9, 3.678763399415782*^9, 
   3.6787637502158213`*^9, 3.678764928395048*^9, 3.678766524870788*^9, 
   3.6787691909696217`*^9, 3.679937800442492*^9, 3.6817903138543177`*^9, {
   3.681790667017806*^9, 3.6817907228467083`*^9}, 3.68189115135784*^9, 
   3.68189118399726*^9, 3.6818937876560183`*^9, 3.682150964596622*^9}]
}, Open  ]]
}, Closed]],

Cell[CellGroupData[{

Cell["Resident stability (weak selection)", "Section",
 CellChangeTimes->{{3.675728118153309*^9, 3.6757281301025343`*^9}, {
   3.675898152172256*^9, 3.675898162531384*^9}, {3.676682354127939*^9, 
   3.676682359443681*^9}, {3.677430416430501*^9, 3.677430416814169*^9}, 
   3.677430777539423*^9, 3.678768528895612*^9, {3.68189093685081*^9, 
   3.681890938134719*^9}}],

Cell["\<\
Here we use linear stability analysis to examine when the resident \
equilibrium (i.e., no mutants) derived above is stable.\
\>", "Text",
 CellChangeTimes->{{3.676720746264163*^9, 3.676720791609645*^9}}],

Cell["\<\
The Jacobian for the residents is (this takes a couple minutes)\
\>", "Text",
 CellChangeTimes->{{3.676720780698885*^9, 3.676720799664399*^9}, {
  3.678764310691422*^9, 3.6787643161574373`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"eqs", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"Join", "[", 
           RowBox[{
            RowBox[{"Table", "[", 
             RowBox[{
              SubscriptBox["fHapNext", 
               RowBox[{"X", ",", "y", ",", "M", ",", "female", ",", "MM"}]], 
              ",", 
              RowBox[{"{", 
               RowBox[{"y", ",", 
                RowBox[{"{", 
                 RowBox[{"A", ",", "a"}], "}"}]}], "}"}]}], "]"}], ",", 
            RowBox[{
             RowBox[{"Table", "[", 
              RowBox[{
               SubscriptBox["fHapNext", 
                RowBox[{"x", ",", "y", ",", "M", ",", "male", ",", "MM"}]], 
               ",", 
               RowBox[{"{", 
                RowBox[{"x", ",", 
                 RowBox[{"{", 
                  RowBox[{"X", ",", "Y"}], "}"}]}], "}"}], ",", 
               RowBox[{"{", 
                RowBox[{"y", ",", 
                 RowBox[{"{", 
                  RowBox[{"A", ",", "a"}], "}"}]}], "}"}]}], "]"}], "//", 
             "Flatten"}]}], "]"}], "/.", "sumsex"}], "/.", "invXY"}], "/.", 
        "pseg0"}], "/.", "pseg1"}], "/.", "pseg2"}], "/.", "pseg3"}], "/.", 
    "pseg4"}]}], ";"}], "\n", 
 RowBox[{
  RowBox[{"matIntFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"eqs", ",", 
          SubscriptBox["fHap", 
           RowBox[{"X", ",", "A", ",", "M", ",", "female", ",", "MM"}]]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqs", ",", 
          SubscriptBox["fHap", 
           RowBox[{"X", ",", "a", ",", "M", ",", "female", ",", "MM"}]]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqs", ",", 
          SubscriptBox["fHap", 
           RowBox[{"X", ",", "A", ",", "M", ",", "male", ",", "MM"}]]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqs", ",", 
          SubscriptBox["fHap", 
           RowBox[{"X", ",", "a", ",", "M", ",", "male", ",", "MM"}]]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqs", ",", 
          SubscriptBox["fHap", 
           RowBox[{"Y", ",", "A", ",", "M", ",", "male", ",", "MM"}]]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqs", ",", 
          SubscriptBox["fHap", 
           RowBox[{"Y", ",", "a", ",", "M", ",", "male", ",", "MM"}]]}], 
         "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], "/.", "subequil"}], "//",
     "Factor"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.681891260839473*^9, 3.68189141173361*^9}, {
  3.6818938494644833`*^9, 3.681893875320655*^9}}],

Cell["From this we can derive the characteristic polynomial", "Text",
 CellChangeTimes->{{3.67672101846877*^9, 3.676721031016712*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyIntFull", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matIntFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "6", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675790963788534*^9, 3.6757909758461533`*^9}, {
  3.678763074902429*^9, 3.678763075065971*^9}, {3.6787641836824837`*^9, 
  3.678764184155055*^9}}],

Cell["\<\
Instead of examining when the non-trivial equilibrium (A not fixed or lost) \
is stable we will look for when the trivial equilibria (loss or fixation of \
A) are unstable.\
\>", "Text",
 CellChangeTimes->{{3.676721042012188*^9, 3.676721126032257*^9}}],

Cell["\<\
When A is fixed the characteristic polynomial with no selection gives \
eigenvalues\
\>", "Text",
 CellChangeTimes->{{3.676721132511098*^9, 3.6767211423017263`*^9}, {
  3.676721178371427*^9, 3.676721218756505*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"charpolyInt1", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"charpolyIntFull", "/.", 
      RowBox[{"pXm", "\[Rule]", "1"}]}], "/.", 
     RowBox[{"pXf", "\[Rule]", "1"}]}], "/.", 
    RowBox[{"pYm", "\[Rule]", "1"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyInt1", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
   "Factor"}], "//", "Flatten"}]}], "Input",
 CellChangeTimes->{{3.676721152602626*^9, 3.6767211696108313`*^9}, {
   3.676721653986638*^9, 3.676721654917102*^9}, 3.678763104967507*^9, {
   3.678763145950407*^9, 3.678763146936859*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}], "-", 
       SqrtBox[
        RowBox[{"9", "-", 
         RowBox[{"20", " ", "r"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}], "+", 
       SqrtBox[
        RowBox[{"9", "-", 
         RowBox[{"20", " ", "r"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.676721170257844*^9, 3.676721655215622*^9, 3.676730789272407*^9, 
   3.677430333671691*^9, 3.677608209896048*^9, 3.677609085129491*^9, 
   3.677954754976882*^9, 3.6780283302178164`*^9, 3.678542695068201*^9, 
   3.678544350475233*^9, 3.6785534771527643`*^9, {3.678763086474922*^9, 
   3.678763105806613*^9}, 3.678763147295204*^9, 3.678764294518174*^9, 
   3.679938038784348*^9, 3.6818914653253813`*^9, 3.681894283473131*^9, 
   3.682159501194277*^9}]
}, Open  ]],

Cell["\<\
and \[Lambda]=1 is the leading eigenvalue.\
\>", "Text",
 CellChangeTimes->{{3.676721226033328*^9, 3.676721241288987*^9}}],

Cell["With weak selection first order term in the eigenvalues is", "Text",
 CellChangeTimes->{{3.676721201810499*^9, 3.6767212071148663`*^9}, {
  3.676721245455948*^9, 3.6767212760370197`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"charpolyInt1", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Lambda]", "\[Rule]", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Delta]\[Lambda]1fix", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}], "//",
    "Flatten"}]}]}], "Input",
 CellChangeTimes->{{3.6757905419305773`*^9, 3.67579059667633*^9}, {
  3.6757909951816072`*^9, 3.6757909952509527`*^9}, {3.676721441707623*^9, 
  3.6767214458346786`*^9}, {3.676721535301393*^9, 3.676721554454569*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       SubscriptBox["h", "female"], " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      SubscriptBox["sHap", "female"], "+", 
      SubscriptBox["sHap", "male"]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.676721554821319*^9, 3.676730789299614*^9, 
  3.6774303337063103`*^9, 3.677608209939247*^9, 3.6776090851739197`*^9, 
  3.677954755005115*^9, 3.67802833026289*^9, 3.678542695110661*^9, 
  3.678544350508951*^9, 3.6785534771809893`*^9, 3.678764340415372*^9, 
  3.679938038827969*^9, 3.681891469022283*^9, 3.681894287482644*^9, 
  3.682159501317706*^9}]
}, Open  ]],

Cell["\<\
And so the fixation of A is unstable when this expression is positive.\
\>", "Text",
 CellChangeTimes->{{3.676721308204175*^9, 3.676721335598743*^9}}],

Cell["\<\
When A is lost the characteristic polynomial with no selection gives \
eigenvalues\
\>", "Text",
 CellChangeTimes->{{3.6767213474719133`*^9, 3.676721350576425*^9}}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"charpolyInt0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"charpolyIntFull", "/.", 
      RowBox[{"pXm", "\[Rule]", "0"}]}], "/.", 
     RowBox[{"pXf", "\[Rule]", "0"}]}], "/.", 
    RowBox[{"pYm", "\[Rule]", "0"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{"charpolyInt0", "/.", "weaksel"}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
  "Flatten"}]}], "Input",
 CellChangeTimes->{{3.675789475257841*^9, 3.675789495224863*^9}, {
   3.675790419784018*^9, 3.675790436109337*^9}, {3.675790707473653*^9, 
   3.6757907121912107`*^9}, 3.675790981141562*^9, {3.675791011580246*^9, 
   3.6757910160572977`*^9}, {3.676721363672165*^9, 3.676721374617257*^9}, {
   3.676721452992544*^9, 3.676721455943983*^9}, {3.676721499845089*^9, 
   3.676721500929879*^9}, 3.676721543612586*^9, 3.678764370215426*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "0"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", "1"}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}], "-", 
       SqrtBox[
        RowBox[{"9", "-", 
         RowBox[{"20", " ", "r"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}], ",", 
   RowBox[{"\[Lambda]", "\[Rule]", 
    RowBox[{
     FractionBox["1", "4"], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}], "+", 
       SqrtBox[
        RowBox[{"9", "-", 
         RowBox[{"20", " ", "r"}], "+", 
         RowBox[{"4", " ", 
          SuperscriptBox["r", "2"]}]}]]}], ")"}]}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.6767213765070133`*^9, 3.676721456161497*^9, 
  3.676721501263238*^9, 3.676721544164434*^9, 3.676730789335022*^9, 
  3.677430333743013*^9, 3.677608209980873*^9, 3.677609085209072*^9, 
  3.677954755059959*^9, 3.678028330301626*^9, 3.678542695160199*^9, 
  3.678544350541535*^9, 3.678553477213879*^9, 3.6787643713788443`*^9, 
  3.679938038868807*^9, 3.681891477103898*^9, 3.681894289752437*^9, 
  3.682159501449657*^9}]
}, Open  ]],

Cell["With weak selection first order term in the eigenvalues is", "Text",
 CellChangeTimes->{3.676721390427958*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"charpolyInt0", "/.", "weaksel"}], "/.", 
        RowBox[{"\[Lambda]", "\[Rule]", 
         RowBox[{"1", "+", 
          RowBox[{"\[Delta]\[Lambda]1", "*", "\[Epsilon]"}]}]}]}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "/.", 
    RowBox[{"\[Epsilon]", "\[Rule]", "1"}]}], "//", "Factor"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{"\[Delta]\[Lambda]1loss", "=", 
  RowBox[{
   RowBox[{"Solve", "[", 
    RowBox[{
     RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]1"}], "]"}], "//",
    "Flatten"}]}]}], "Input",
 CellChangeTimes->{{3.6757905419305773`*^9, 3.67579059667633*^9}, {
   3.6757909951816072`*^9, 3.6757909952509527`*^9}, {3.675791030843678*^9, 
   3.6757910309227667`*^9}, {3.67672149489704*^9, 3.676721496462256*^9}, 
   3.676721546110467*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"\[Delta]\[Lambda]1", "\[Rule]", 
   RowBox[{
    FractionBox["1", "2"], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{
       SubscriptBox["h", "female"], " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      SubscriptBox["sDip", "male"], "+", 
      RowBox[{
       SubscriptBox["h", "male"], " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      SubscriptBox["sHap", "female"], "-", 
      SubscriptBox["sHap", "male"]}], ")"}]}]}], "}"}]], "Output",
 CellChangeTimes->{3.675799455916547*^9, 3.6767214970605583`*^9, 
  3.6767215468807373`*^9, 3.67673078936864*^9, 3.677430333766693*^9, 
  3.677608210022337*^9, 3.677609085253159*^9, 3.677954755089143*^9, 
  3.6780283303292913`*^9, 3.678542695210258*^9, 3.678544350574987*^9, 
  3.678553477245347*^9, 3.678764374849228*^9, 3.6799380389071827`*^9, 
  3.681891479187998*^9, 3.681894291531432*^9, 3.682159501568185*^9}]
}, Open  ]],

Cell["\<\
And so the loss of A is unstable when this expression is positive.\
\>", "Text",
 CellChangeTimes->{{3.6767213979123573`*^9, 3.6767214015330763`*^9}}],

Cell["\<\
Combining the two results, the protected polymorphism (non-trivial \
equilibrium) requires that \
\>", "Text",
 CellChangeTimes->{{3.67579927992915*^9, 3.675799368289077*^9}, {
  3.676721410316127*^9, 3.676721427192442*^9}, {3.676721618600268*^9, 
  3.6767216187542257`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"stabconds", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]\[Lambda]1", "/.", "\[Delta]\[Lambda]1fix"}], ")"}], 
      "<", "0"}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{"\[Delta]\[Lambda]1", "/.", "\[Delta]\[Lambda]1loss"}], ")"}], 
      "<", "0"}]}], "}"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.678037516961389*^9, 3.678037532291551*^9}, {
  3.678764404869893*^9, 3.678764446859511*^9}}]
}, Closed]],

Cell[CellGroupData[{

Cell["Sex chromosome turnover (weak selection)", "Section",
 CellChangeTimes->{{3.675898184242074*^9, 3.675898192657653*^9}, {
   3.6766823621496687`*^9, 3.676682365402493*^9}, {3.676682824936212*^9, 
   3.676682839700041*^9}, 3.676721662499631*^9, {3.676726557160334*^9, 
   3.676726564889889*^9}, 3.677427015726658*^9, {3.677439500021902*^9, 
   3.67743950207469*^9}, {3.678543990089929*^9, 3.678543990274122*^9}, {
   3.678768500112903*^9, 3.678768500298716*^9}, 3.6787685305671663`*^9, 
   3.68149869075344*^9, {3.681894409409809*^9, 3.681894413433563*^9}}],

Cell["\<\
Here we are interested in the ability of a rare mutant at the ESD locus to \
invade the non-mutant resident population at equilibrium.\
\>", "Text",
 CellChangeTimes->{{3.676720412976615*^9, 3.676720459024542*^9}, {
   3.676720582555089*^9, 3.676720586782763*^9}, {3.676721687580276*^9, 
   3.676721687767557*^9}, {3.6767265489351683`*^9, 3.676726549465045*^9}, {
   3.678764528946957*^9, 3.678764537543582*^9}, 3.681498690753603*^9}],

Cell["\<\
The Jacobian for the mutants is (this takes a minute or two, or ten)\
\>", "Text",
 CellChangeTimes->{{3.6758991929846497`*^9, 3.67589926406907*^9}, {
   3.67589934114139*^9, 3.6758993427645893`*^9}, {3.675900036907325*^9, 
   3.6759000483741083`*^9}, {3.676720403037026*^9, 3.676720404249701*^9}, {
   3.6767205532682467`*^9, 3.676720568189563*^9}, {3.676720627629078*^9, 
   3.676720646673503*^9}, 3.678764550116784*^9, {3.67876518531907*^9, 
   3.678765192344109*^9}, {3.6787654012127323`*^9, 3.6787654024110203`*^9}, {
   3.678765517503551*^9, 3.678765517693905*^9}, 3.681498690753746*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"eqsmut", "=", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{"Table", "[", 
            RowBox[{
             SubscriptBox["fHapNext", 
              RowBox[{"x", ",", "y", ",", "m", ",", "sex", ",", "Mm"}]], ",", 
             
             RowBox[{"{", 
              RowBox[{"sex", ",", 
               RowBox[{"{", 
                RowBox[{"female", ",", "male"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"y", ",", 
               RowBox[{"{", 
                RowBox[{"A", ",", "a"}], "}"}]}], "}"}], ",", 
             RowBox[{"{", 
              RowBox[{"x", ",", 
               RowBox[{"{", 
                RowBox[{"X", ",", "Y"}], "}"}]}], "}"}]}], "]"}], "/.", 
           "sumsex"}], "/.", "invXY"}], "/.", "pseg0"}], "/.", "pseg1"}], "/.",
        "pseg2"}], "/.", "pseg3"}], "/.", "pseg4"}], "//", "Flatten"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.681498867960778*^9, 3.681498868279395*^9}, {
  3.681502455906188*^9, 3.681502457425939*^9}, {3.681502668604136*^9, 
  3.681502672491222*^9}, {3.681503975828821*^9, 3.6815040176225433`*^9}, {
  3.681505767362689*^9, 3.681505784587554*^9}, {3.6818945120454483`*^9, 
  3.681894610099656*^9}, {3.6818947117187634`*^9, 3.681894740235599*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"matExtFull", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Transpose", "[", 
      RowBox[{"{", "\[IndentingNewLine]", 
       RowBox[{
        RowBox[{"D", "[", 
         RowBox[{"eqsmut", ",", 
          SubscriptBox["fHap", 
           RowBox[{"X", ",", "A", ",", "m", ",", "female", ",", "Mm"}]]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqsmut", ",", 
          SubscriptBox["fHap", 
           RowBox[{"Y", ",", "A", ",", "m", ",", "female", ",", "Mm"}]]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqsmut", ",", 
          SubscriptBox["fHap", 
           RowBox[{"X", ",", "a", ",", "m", ",", "female", ",", "Mm"}]]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqsmut", ",", 
          SubscriptBox["fHap", 
           RowBox[{"Y", ",", "a", ",", "m", ",", "female", ",", "Mm"}]]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqsmut", ",", 
          SubscriptBox["fHap", 
           RowBox[{"X", ",", "A", ",", "m", ",", "male", ",", "Mm"}]]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqsmut", ",", 
          SubscriptBox["fHap", 
           RowBox[{"Y", ",", "A", ",", "m", ",", "male", ",", "Mm"}]]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqsmut", ",", 
          SubscriptBox["fHap", 
           RowBox[{"X", ",", "a", ",", "m", ",", "male", ",", "Mm"}]]}], 
         "]"}], ",", "\[IndentingNewLine]", 
        RowBox[{"D", "[", 
         RowBox[{"eqsmut", ",", 
          SubscriptBox["fHap", 
           RowBox[{"Y", ",", "a", ",", "m", ",", "male", ",", "Mm"}]]}], 
         "]"}]}], "\[IndentingNewLine]", "}"}], "]"}], "/.", "subequil"}], "//",
     "Factor"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.675899271627995*^9, 3.675899299216916*^9}, 
   3.676720301639617*^9, {3.676726501276018*^9, 3.676726501481125*^9}, {
   3.677427048508334*^9, 3.677427075879243*^9}, {3.677427326330523*^9, 
   3.6774273760898743`*^9}, {3.67742743689052*^9, 3.677427592461371*^9}, {
   3.678765041920876*^9, 3.678765137583117*^9}, {3.678765352065774*^9, 
   3.678765371889979*^9}, {3.680376081497802*^9, 3.680376122649544*^9}, {
   3.680376336322661*^9, 3.680376339618507*^9}, 3.6814986907553663`*^9, {
   3.681505799371335*^9, 3.681505809789117*^9}, 3.681894575423699*^9, {
   3.6818946436805897`*^9, 3.681894703232473*^9}, {3.681894745184857*^9, 
   3.6818947875030746`*^9}}],

Cell["And the characteristic polynomial", "Text",
 CellChangeTimes->{{3.680376389280652*^9, 3.680376397183989*^9}, 
   3.681498690756482*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyExt", "=", 
   RowBox[{"Det", "[", 
    RowBox[{"matExtFull", "-", 
     RowBox[{
      RowBox[{"IdentityMatrix", "[", "8", "]"}], "*", "\[Lambda]"}]}], 
    "]"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6758993091981916`*^9, 3.6758993092948217`*^9}, {
   3.677427680774026*^9, 3.6774276809783897`*^9}, {3.678765570174028*^9, 
   3.678765571504396*^9}, 3.681498690756659*^9, {3.681505821275982*^9, 
   3.6815058216272078`*^9}, {3.681894823855321*^9, 3.681894824536747*^9}}],

Cell["Solving for the eigenvalues with no selection gives", "Text",
 CellChangeTimes->{{3.676720669392806*^9, 3.676720678062379*^9}, {
   3.678766034361598*^9, 3.6787660366765347`*^9}, 3.681498690757751*^9}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"charploy0", "=", 
   RowBox[{
    RowBox[{"Normal", "[", 
     RowBox[{"Series", "[", 
      RowBox[{
       RowBox[{"charpolyExt", "/.", "weaksel"}], ",", 
       RowBox[{"{", 
        RowBox[{"\[Epsilon]", ",", "0", ",", "0"}], "}"}]}], "]"}], "]"}], "//",
     "Factor"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"charploy0sol", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{"%", "\[Equal]", "0"}], ",", "\[Lambda]"}], "]"}], "//", 
     "Flatten"}], "//", "Simplify"}]}], ";"}]}], "Input",
 CellChangeTimes->{3.681502397168035*^9}],

Cell[BoxData[
 RowBox[{"Table", "[", 
  RowBox[{
   RowBox[{"Show", "[", 
    RowBox[{
     RowBox[{"Table", "[", 
      RowBox[{
       RowBox[{"Plot", "[", 
        RowBox[{
         RowBox[{"\[Lambda]", "/.", 
          RowBox[{"charploy0sol", "[", 
           RowBox[{"[", "i", "]"}], "]"}]}], ",", 
         RowBox[{"{", 
          RowBox[{"k", ",", "0", ",", "1"}], "}"}]}], "]"}], ",", 
       RowBox[{"{", 
        RowBox[{"i", ",", "1", ",", 
         RowBox[{"Length", "[", "charploy0sol", "]"}]}], "}"}]}], "]"}], ",", 
     
     RowBox[{"PlotRange", "\[Rule]", "All"}]}], "]"}], ",", 
   RowBox[{"{", 
    RowBox[{"r", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.5"}], "}"}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"R", ",", 
     RowBox[{"{", 
      RowBox[{"0", ",", "0.5"}], "}"}]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.682151127568894*^9, 3.682151159704933*^9}}],

Cell["\<\
And so it looks like on this order the leading eigenvalue is \[Lambda]=1.\
\>", "Text",
 CellChangeTimes->{{3.676722106551478*^9, 3.6767221217139177`*^9}, 
   3.681498690789302*^9, {3.6818958141870213`*^9, 3.68189581877769*^9}}],

Cell["On the first order the eiganvalue is", "Text",
 CellChangeTimes->{{3.676722149076614*^9, 3.676722183499652*^9}, 
   3.6814986907894573`*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
          RowBox[{"\[Lambda]", "\[Rule]", 
           RowBox[{"1", "+", 
            RowBox[{"\[Delta]\[Lambda]", "*", "\[Epsilon]"}]}]}]}], "/.", 
         "frequenciessub"}], "/.", "sol0"}], "/.", 
       RowBox[{"pXf0", "\[Rule]", "pA"}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "1"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{"Solve", "[", 
  RowBox[{
   RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]"}], 
  "]"}]}], "Input",
 CellChangeTimes->{3.681486427197596*^9, 3.6814888814143467`*^9, 
  3.681498690789733*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{"{", 
   RowBox[{"\[Delta]\[Lambda]", "\[Rule]", "0"}], "}"}], "}"}]], "Output",
 CellChangeTimes->{3.6815056058795958`*^9, 3.6818958391749153`*^9}]
}, Open  ]],

Cell["And on the 2nd order (this takes a few minutes)", "Text",
 CellChangeTimes->{{3.677430204742441*^9, 3.677430225667992*^9}, {
  3.677965495156917*^9, 3.677965496819395*^9}, {3.678765896404023*^9, 
  3.678765902475174*^9}, {3.678766043948579*^9, 3.678766044008556*^9}, {
  3.678769767354095*^9, 3.678769771966827*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{
   RowBox[{"Normal", "[", 
    RowBox[{"Series", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{
           RowBox[{
            RowBox[{"charpolyExt", "/.", "weaksel"}], "/.", 
            RowBox[{"\[Lambda]", "\[Rule]", 
             RowBox[{"1", "+", 
              RowBox[{"\[Delta]\[Lambda]2", "*", 
               RowBox[{"\[Epsilon]", "^", "2"}]}]}]}]}], "/.", 
           "frequenciessub"}], "/.", "sol0"}], "/.", 
         RowBox[{"pXf0", "\[Rule]", "pA"}]}], "/.", 
        RowBox[{"pXm1", "\[Rule]", 
         RowBox[{"dpAXmXf", "+", "pXf1"}]}]}], "/.", 
       RowBox[{"pYm1", "\[Rule]", 
        RowBox[{"dpAYmXf", "+", "pXf1"}]}]}], ",", 
      RowBox[{"{", 
       RowBox[{"\[Epsilon]", ",", "0", ",", "2"}], "}"}]}], "]"}], "]"}], "//",
    "Factor"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"Solve", "[", 
   RowBox[{
    RowBox[{"%", "\[Equal]", "0"}], ",", "\[Delta]\[Lambda]2"}], "]"}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"lambda2diffs", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"\[Delta]\[Lambda]2", "/.", "%"}], ",", 
     RowBox[{"{", 
      RowBox[{"dpAXmXf", ",", "dpAYmXf"}], "}"}], ",", "Simplify"}], "]"}]}], 
  ";"}]}], "Input",
 CellChangeTimes->{{3.677439732826703*^9, 3.677439769906844*^9}, {
   3.677872519052596*^9, 3.6778725192298527`*^9}, {3.677949340104127*^9, 
   3.6779493407177973`*^9}, {3.6779558471459913`*^9, 3.677955905730049*^9}, {
   3.677955946486411*^9, 3.677955957804606*^9}, {3.677956005037593*^9, 
   3.67795604222084*^9}, {3.677964817435317*^9, 3.6779648948629827`*^9}, {
   3.678765906240861*^9, 3.6787659176812677`*^9}, {3.678765975309867*^9, 
   3.678766019296446*^9}, {3.680377817344696*^9, 3.680377832640732*^9}, 
   3.6803780998966637`*^9, 3.680378884576241*^9, {3.6803803997464952`*^9, 
   3.6803804058495502`*^9}, 3.681486569444024*^9, 3.6821514359666348`*^9}],

Cell["Then we can put in all the differences", "Text",
 CellChangeTimes->{{3.6779655133565893`*^9, 3.677965517876515*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tester", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"lambda2diffs", "/.", 
      RowBox[{"realsol", "[", 
       RowBox[{"[", "3", "]"}], "]"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"dpAXmXf", ",", "dpAYmXf"}], "}"}], ",", "Simplify"}], "]"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.677956048352296*^9, 3.6779561551216288`*^9}, {
   3.677957309721977*^9, 3.6779573101974573`*^9}, {3.677964924472028*^9, 
   3.677964939369676*^9}, {3.678766496517172*^9, 3.678766497073032*^9}, {
   3.678766536740871*^9, 3.678766624413505*^9}, {3.6818967557781687`*^9, 
   3.6818967860650454`*^9}, 3.682151442334035*^9}],

Cell[BoxData[
 RowBox[{
  RowBox[{"tester", "=", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["h", "female"]}], ")"}], " ", 
          SubscriptBox["sDip", "female"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            SubscriptBox["h", "male"]}], ")"}], " ", 
          SubscriptBox["sDip", "male"]}], "-", 
         SubscriptBox["sHap", "female"], "-", 
         SubscriptBox["sHap", "male"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SubscriptBox["h", "female"], " ", 
          SubscriptBox["sDip", "female"]}], "+", 
         RowBox[{
          SubscriptBox["h", "male"], " ", 
          SubscriptBox["sDip", "male"]}], "+", 
         SubscriptBox["sHap", "female"], "+", 
         SubscriptBox["sHap", "male"]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"-", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", 
               RowBox[{"(", 
                RowBox[{
                 SubscriptBox["sDip", "female"], "-", 
                 SubscriptBox["sDip", "male"]}], ")"}]}], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["sHap", "female"], "+", 
                SubscriptBox["sHap", "male"]}], ")"}]}], "-", 
             RowBox[{"2", " ", 
              SubscriptBox["h", "male"], " ", 
              SubscriptBox["sDip", "male"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["sDip", "female"], "+", 
                SubscriptBox["sHap", "female"], "+", 
                SubscriptBox["sHap", "male"]}], ")"}]}], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["h", "female"], " ", 
              SubscriptBox["sDip", "female"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["sDip", "male"], "+", 
                SubscriptBox["sHap", "female"], "+", 
                SubscriptBox["sHap", "male"]}], ")"}]}]}], ")"}]}], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"-", "2"}], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{"1", "+", 
                   RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}]}], ")"}], "2"], 
                " ", "R", " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "R"}]}], 
                 ")"}]}], "+", 
               RowBox[{"2", " ", 
                SuperscriptBox["k", "2"], " ", 
                SuperscriptBox["r", "3"], " ", 
                SuperscriptBox[
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{"1", "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "R"}]}], 
                 ")"}]}], "-", 
               RowBox[{"k", " ", 
                SuperscriptBox["r", "2"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "4"}], "+", 
                  RowBox[{"11", " ", "R"}], "-", 
                  RowBox[{"8", " ", 
                   SuperscriptBox["R", "2"]}], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["k", "2"], " ", "R", " ", 
                   RowBox[{"(", 
                    RowBox[{"2", "-", 
                    RowBox[{"6", " ", "R"}], "+", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "-", 
                    RowBox[{"21", " ", "R"}], "+", 
                    RowBox[{"30", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"10", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", "2"}], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"]}], "+", 
                  RowBox[{"2", " ", 
                   SuperscriptBox["k", "3"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", "R"}]}], ")"}], "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "R"}], "+", 
                  RowBox[{"k", " ", 
                   RowBox[{"(", 
                    RowBox[{"4", "-", 
                    RowBox[{"18", " ", "R"}], "+", 
                    RowBox[{"25", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"11", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
                  RowBox[{
                   SuperscriptBox["k", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"16", " ", "R"}], "-", 
                    RowBox[{"39", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"35", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"8", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}]}]}], ")"}],
              " ", 
             RowBox[{"(", 
              RowBox[{
               SubscriptBox["sHap", "female"], "-", 
               SubscriptBox["sHap", "male"]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}]}], ")"}], "2"], 
                  " ", "R", " ", 
                  RowBox[{"(", 
                   RowBox[{"3", "-", 
                    RowBox[{"2", " ", "R"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["k", "2"], " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"3", "-", 
                    RowBox[{"2", " ", "R"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"r", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "8"}], "+", 
                    RowBox[{"14", " ", "R"}], "-", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], "3"]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"17", "-", 
                    RowBox[{"59", " ", "R"}], "+", 
                    RowBox[{"65", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"22", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "11"}], "+", 
                    RowBox[{"58", " ", "R"}], "-", 
                    RowBox[{"107", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"78", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"16", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"k", " ", 
                  SuperscriptBox["r", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "14"}], "+", 
                    RowBox[{"45", " ", "R"}], "-", 
                    RowBox[{"46", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"16", " ", 
                    SuperscriptBox["R", "3"]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", 
                    RowBox[{"24", " ", "R"}], "-", 
                    RowBox[{"54", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"54", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"20", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"17", "-", 
                    RowBox[{"79", " ", "R"}], "+", 
                    RowBox[{"132", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"90", " ", 
                    SuperscriptBox["R", "3"]}], "+", 
                    RowBox[{"20", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}]}]}], ")"}],
                " ", 
               SubscriptBox["sDip", "male"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  SubscriptBox["h", "female"], " ", 
                  SubscriptBox["sDip", "female"]}], "+", 
                 SubscriptBox["sHap", "female"], "+", 
                 SubscriptBox["sHap", "male"], "-", 
                 RowBox[{
                  SubscriptBox["h", "male"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["sDip", "female"], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sHap", "female"], "+", 
                    SubscriptBox["sHap", "male"]}], ")"}]}]}], ")"}]}]}], 
                ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", 
                   SubscriptBox["h", "female"]}]}], ")"}], " ", 
                SubscriptBox["sDip", "female"]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", 
                   SubscriptBox["h", "male"]}]}], ")"}], " ", 
                SubscriptBox["sDip", "male"]}]}], ")"}]}], "-", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", "2"}], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}]}], ")"}], "2"], 
                  " ", "R", " ", 
                  RowBox[{"(", 
                   RowBox[{"3", "-", 
                    RowBox[{"2", " ", "R"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"2", " ", 
                  SuperscriptBox["k", "2"], " ", 
                  SuperscriptBox["r", "3"], " ", 
                  SuperscriptBox[
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                  RowBox[{"(", 
                   RowBox[{"3", "-", 
                    RowBox[{"2", " ", "R"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"r", " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "8"}], "+", 
                    RowBox[{"14", " ", "R"}], "-", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], "3"]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"17", "-", 
                    RowBox[{"59", " ", "R"}], "+", 
                    RowBox[{"65", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"22", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "11"}], "+", 
                    RowBox[{"58", " ", "R"}], "-", 
                    RowBox[{"107", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"78", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"16", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
                 RowBox[{"k", " ", 
                  SuperscriptBox["r", "2"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "14"}], "+", 
                    RowBox[{"45", " ", "R"}], "-", 
                    RowBox[{"46", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"16", " ", 
                    SuperscriptBox["R", "3"]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", 
                    RowBox[{"24", " ", "R"}], "-", 
                    RowBox[{"54", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"54", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"20", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"17", "-", 
                    RowBox[{"79", " ", "R"}], "+", 
                    RowBox[{"132", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"90", " ", 
                    SuperscriptBox["R", "3"]}], "+", 
                    RowBox[{"20", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}]}]}], ")"}],
                " ", 
               SubscriptBox["sDip", "female"], " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"-", 
                   SubscriptBox["h", "male"]}], " ", 
                  SubscriptBox["sDip", "male"]}], "-", 
                 SubscriptBox["sHap", "female"], "-", 
                 SubscriptBox["sHap", "male"], "+", 
                 RowBox[{
                  SubscriptBox["h", "female"], " ", 
                  RowBox[{"(", 
                   RowBox[{
                    SubscriptBox["sDip", "male"], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sHap", "female"], "+", 
                    SubscriptBox["sHap", "male"]}], ")"}]}]}], ")"}]}]}], 
                ")"}]}], ")"}], "/", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", 
                   SubscriptBox["h", "female"]}]}], ")"}], " ", 
                SubscriptBox["sDip", "female"]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", 
                   SubscriptBox["h", "male"]}]}], ")"}], " ", 
                SubscriptBox["sDip", "male"]}]}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{
          RowBox[{"1", "/", "r"}], 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "r"}], " ", 
              SubscriptBox["sDip", "female"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{
              SubscriptBox["sDip", "male"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"r", " ", 
              SubscriptBox["sDip", "male"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{
              SubscriptBox["sDip", "female"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"r", " ", 
              SubscriptBox["sDip", "female"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"r", " ", 
              SubscriptBox["sDip", "male"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{
              SubscriptBox["h", "male"], " ", 
              SubscriptBox["sDip", "male"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["sDip", "female"], "+", 
                RowBox[{"2", " ", 
                 SubscriptBox["sHap", "female"]}], "-", 
                RowBox[{"2", " ", "r", " ", 
                 SubscriptBox["sHap", "female"]}], "+", 
                RowBox[{"2", " ", "r", " ", 
                 SubscriptBox["sHap", "male"]}]}], ")"}]}], "+", 
             RowBox[{
              SubscriptBox["h", "female"], " ", 
              SubscriptBox["sDip", "female"], " ", 
              RowBox[{"(", 
               RowBox[{
                SubscriptBox["sDip", "male"], "+", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"r", " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   SubscriptBox["sHap", "male"], "-", 
                   RowBox[{"r", " ", 
                    SubscriptBox["sHap", "male"]}]}], ")"}]}]}], ")"}]}]}], 
            ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{
              RowBox[{"-", "2"}], " ", "r", " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"4", " ", "k", " ", "r", " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["k", "2"], " ", "r", " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"4", " ", "k", " ", 
              SuperscriptBox["r", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"2", " ", "r", " ", "R", " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"12", " ", "k", " ", "r", " ", "R", " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"12", " ", 
              SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["k", "3"], " ", "r", " ", "R", " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"13", " ", "k", " ", 
              SuperscriptBox["r", "2"], " ", "R", " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"23", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "2"], " ", "R", " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "2"], " ", "R", " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"10", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "3"], " ", "R", " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "3"], " ", "R", " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"4", " ", "k", " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"6", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"13", " ", "k", " ", "r", " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"29", " ", 
              SuperscriptBox["k", "2"], " ", "r", " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"10", " ", 
              SuperscriptBox["k", "3"], " ", "r", " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"13", " ", "k", " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"45", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"16", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"18", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"2", " ", "k", " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"5", " ", "k", " ", "r", " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"29", " ", 
              SuperscriptBox["k", "2"], " ", "r", " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"16", " ", 
              SuperscriptBox["k", "3"], " ", "r", " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"4", " ", "k", " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"36", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"22", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"14", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"10", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["k", "2"], " ", "r", " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["k", "3"], " ", "r", " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"10", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"10", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "female"]}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "female"]}], "+", 
             RowBox[{"7", " ", "r", " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"26", " ", "k", " ", "r", " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"35", " ", 
              SuperscriptBox["k", "2"], " ", "r", " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"20", " ", 
              SuperscriptBox["k", "3"], " ", "r", " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["k", "4"], " ", "r", " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"8", " ", "k", " ", 
              SuperscriptBox["r", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"28", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"28", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"2", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"8", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"4", " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"18", " ", "k", " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"28", " ", 
              SuperscriptBox["k", "2"], " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"18", " ", 
              SuperscriptBox["k", "3"], " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["k", "4"], " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"10", " ", "r", " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"56", " ", "k", " ", "r", " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"114", " ", 
              SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"92", " ", 
              SuperscriptBox["k", "3"], " ", "r", " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"24", " ", 
              SuperscriptBox["k", "4"], " ", "r", " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"23", " ", "k", " ", 
              SuperscriptBox["r", "2"], " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"95", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "2"], " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"118", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "2"], " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"40", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["r", "2"], " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"10", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "3"], " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"38", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "3"], " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"20", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["r", "3"], " ", "R", " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"18", " ", "k", " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"46", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"42", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"12", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"3", " ", "r", " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"39", " ", "k", " ", "r", " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"132", " ", 
              SuperscriptBox["k", "2"], " ", "r", " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"154", " ", 
              SuperscriptBox["k", "3"], " ", "r", " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"52", " ", 
              SuperscriptBox["k", "4"], " ", "r", " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"21", " ", "k", " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"113", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"184", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"76", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"18", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"64", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"36", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "2"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"4", " ", "k", " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"20", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"30", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"12", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"9", " ", "k", " ", "r", " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"59", " ", 
              SuperscriptBox["k", "2"], " ", "r", " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"106", " ", 
              SuperscriptBox["k", "3"], " ", "r", " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"48", " ", 
              SuperscriptBox["k", "4"], " ", "r", " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"6", " ", "k", " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"56", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"124", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"64", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"14", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"46", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"28", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "3"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"2", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"6", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"4", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["k", "2"], " ", "r", " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"24", " ", 
              SuperscriptBox["k", "3"], " ", "r", " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"16", " ", 
              SuperscriptBox["k", "4"], " ", "r", " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"10", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"30", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"20", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["r", "2"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"4", " ", 
              SuperscriptBox["k", "2"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{"12", " ", 
              SuperscriptBox["k", "3"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "male"]}], "+", 
             RowBox[{"8", " ", 
              SuperscriptBox["k", "4"], " ", 
              SuperscriptBox["r", "3"], " ", 
              SuperscriptBox["R", "4"], " ", 
              SubscriptBox["sHap", "male"]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                   SuperscriptBox["k", "2"], " ", 
                   SuperscriptBox["r", "3"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}], "-", 
                  RowBox[{"2", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "R", " ", 
                   RowBox[{"(", 
                    RowBox[{"2", "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"]}], "-", "R", 
                    "-", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"3", "-", 
                    RowBox[{"4", " ", "R"}], "+", 
                    SuperscriptBox["R", "2"]}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{"7", "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", "R"}]}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "-", 
                    RowBox[{"8", " ", "R"}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "-", 
                    RowBox[{"32", " ", "R"}], "+", 
                    RowBox[{"37", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"12", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "14"}], "+", 
                    RowBox[{"31", " ", "R"}], "-", 
                    RowBox[{"22", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   SuperscriptBox["r", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{"8", "-", 
                    RowBox[{"19", " ", "R"}], "+", 
                    RowBox[{"12", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"8", " ", "R"}], "-", 
                    RowBox[{"11", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "11"}], "+", 
                    RowBox[{"35", " ", "R"}], "-", 
                    RowBox[{"36", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"12", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}]}], ")"}]}]}], ")"}],
                 " ", 
                SubscriptBox["sDip", "male"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   SubscriptBox["h", "female"], " ", 
                   SubscriptBox["sDip", "female"]}], "+", 
                  SubscriptBox["sHap", "female"], "+", 
                  SubscriptBox["sHap", "male"], "-", 
                  RowBox[{
                   SubscriptBox["h", "male"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sDip", "female"], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sHap", "female"], "+", 
                    SubscriptBox["sHap", "male"]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"2", " ", 
                    SubscriptBox["h", "female"]}]}], ")"}], " ", 
                 SubscriptBox["sDip", "female"]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"2", " ", 
                    SubscriptBox["h", "male"]}]}], ")"}], " ", 
                 SubscriptBox["sDip", "male"]}]}], ")"}]}], "-", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"2", " ", 
                   SuperscriptBox["k", "2"], " ", 
                   SuperscriptBox["r", "3"], " ", 
                   SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", "k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"2", " ", "k", " ", "R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", "R", "-", 
                    RowBox[{
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"5", "-", 
                    RowBox[{"9", " ", "R"}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"6", " ", "R"}], "-", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    SuperscriptBox["R", "3"]}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], "3"]}], "-", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"5", " ", "R"}], "+", 
                    SuperscriptBox["R", "2"]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"10", "-", 
                    RowBox[{"39", " ", "R"}], "+", 
                    RowBox[{"44", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"14", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "9"}], "+", 
                    RowBox[{"48", " ", "R"}], "-", 
                    RowBox[{"91", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"70", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"16", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
                  RowBox[{"k", " ", 
                   SuperscriptBox["r", "2"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", 
                    RowBox[{"9", " ", "R"}], "-", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "5"}], "+", 
                    RowBox[{"18", " ", "R"}], "-", 
                    RowBox[{"20", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", 
                    RowBox[{"24", " ", "R"}], "-", 
                    RowBox[{"54", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"54", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"20", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"13", "-", 
                    RowBox[{"63", " ", "R"}], "+", 
                    RowBox[{"110", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"80", " ", 
                    SuperscriptBox["R", "3"]}], "+", 
                    RowBox[{"20", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}]}]}], ")"}],
                 " ", 
                SubscriptBox["sDip", "female"], " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"-", 
                    SubscriptBox["h", "male"]}], " ", 
                   SubscriptBox["sDip", "male"]}], "-", 
                  SubscriptBox["sHap", "female"], "-", 
                  SubscriptBox["sHap", "male"], "+", 
                  RowBox[{
                   SubscriptBox["h", "female"], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sDip", "male"], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sHap", "female"], "+", 
                    SubscriptBox["sHap", "male"]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}], ")"}], "/", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"2", " ", 
                    SubscriptBox["h", "female"]}]}], ")"}], " ", 
                 SubscriptBox["sDip", "female"]}], "+", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", 
                   RowBox[{"2", " ", 
                    SubscriptBox["h", "male"]}]}], ")"}], " ", 
                 SubscriptBox["sDip", "male"]}]}], ")"}]}]}], ")"}]}]}], "+", 
         
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", 
                   SubscriptBox["h", "female"]}]}], ")"}], " ", 
                SubscriptBox["sDip", "female"]}], "+", 
               RowBox[{
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "1"}], "+", 
                  RowBox[{"2", " ", 
                   SubscriptBox["h", "male"]}]}], ")"}], " ", 
                SubscriptBox["sDip", "male"]}]}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"-", "4"}], " ", "r", " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"8", " ", "k", " ", "r", " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"8", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"4", " ", "R", " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"8", " ", "k", " ", "R", " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "2"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"8", " ", "r", " ", "R", " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"30", " ", "k", " ", "r", " ", "R", " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"22", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"26", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"38", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"20", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"2", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"10", " ", "k", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"6", " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"40", " ", "k", " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"50", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"32", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"84", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"40", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"10", " ", "k", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"2", " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"24", " ", "k", " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"70", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"20", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"22", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"106", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"32", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"44", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"4", " ", "k", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"10", " ", "k", " ", "r", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"58", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"32", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"8", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"72", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"44", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"28", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"20", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"20", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"20", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "female", "2"]}], "-", 
              RowBox[{"12", " ", "r", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"32", " ", "k", " ", "r", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"28", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"20", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"36", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"8", " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"24", " ", "k", " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"24", " ", 
               SuperscriptBox["k", "2"], " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "3"], " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"11", " ", "r", " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"64", " ", "k", " ", "r", " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"85", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"28", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "4"], " ", "r", " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"52", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"112", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"52", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "2"], " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"32", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"32", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "3"], " ", "R", " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"16", " ", "k", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"26", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"6", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"8", " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"18", " ", "k", " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"56", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"6", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"24", " ", 
               SuperscriptBox["k", "4"], " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"22", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"72", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"22", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"40", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"32", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"28", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"20", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"6", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"22", " ", "k", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"28", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"24", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"12", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"7", " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"44", " ", "k", " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"85", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"88", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"52", " ", 
               SuperscriptBox["k", "4"], " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"32", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"92", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"104", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"76", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"32", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"36", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"12", " ", "k", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"38", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"34", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"12", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"30", " ", "k", " ", "r", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"120", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"122", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"48", " ", 
               SuperscriptBox["k", "4"], " ", "r", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"22", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"128", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"150", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"64", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"40", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"60", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"28", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"12", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"32", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SuperscriptBox["R", "5"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"48", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SuperscriptBox["R", "5"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "4"], " ", "r", " ", 
               SuperscriptBox["R", "5"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"40", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"60", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"20", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "+", 
              RowBox[{"24", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubscriptBox["sHap", "female"], " ", 
               SubscriptBox["sHap", "male"]}], "-", 
              RowBox[{"9", " ", "r", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"30", " ", "k", " ", "r", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"37", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"20", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "4"], " ", "r", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"12", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"32", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"28", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"8", " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"26", " ", "k", " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"32", " ", 
               SuperscriptBox["k", "2"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"18", " ", 
               SuperscriptBox["k", "3"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "4"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"21", " ", "r", " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"98", " ", "k", " ", "r", " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"159", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"110", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"28", " ", 
               SuperscriptBox["k", "4"], " ", "r", " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"44", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"138", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"142", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"48", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "2"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"20", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"44", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"24", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "3"], " ", "R", " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"44", " ", "k", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"78", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"58", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"17", " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"120", " ", "k", " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"265", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"238", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"76", " ", 
               SuperscriptBox["k", "4"], " ", "r", " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"62", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"236", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"290", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"116", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"40", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"96", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"56", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "2"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"30", " ", "k", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"72", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"70", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"24", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"5", " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"68", " ", "k", " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"217", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"254", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"100", " ", 
               SuperscriptBox["k", "4"], " ", "r", " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"44", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"206", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"302", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"140", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"44", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"108", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"64", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "3"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"8", " ", "k", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"30", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"38", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"20", " ", "k", " ", "r", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"94", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"138", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"64", " ", 
               SuperscriptBox["k", "4"], " ", "r", " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"14", " ", "k", " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"96", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"166", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"84", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"28", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"64", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"36", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "4"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"4", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "2"], " ", "r", " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"32", " ", 
               SuperscriptBox["k", "3"], " ", "r", " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "4"], " ", "r", " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"20", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"40", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"20", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "2"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "2"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "-", 
              RowBox[{"16", " ", 
               SuperscriptBox["k", "3"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["k", "4"], " ", 
               SuperscriptBox["r", "3"], " ", 
               SuperscriptBox["R", "5"], " ", 
               SubsuperscriptBox["sHap", "male", "2"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                 SubscriptBox["sDip", "male"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"2", " ", "R"}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    SuperscriptBox["R", "2"]}]}], ")"}]}], "-", 
                    RowBox[{"2", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"10", "-", 
                    RowBox[{"24", " ", "R"}], "+", 
                    RowBox[{"19", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"7", " ", 
                    SuperscriptBox["R", "3"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "-", 
                    RowBox[{"6", " ", "R"}], "+", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "8"}], "+", 
                    RowBox[{"31", " ", "R"}], "-", 
                    RowBox[{"51", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"39", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"10", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "-", 
                    RowBox[{"3", " ", "R"}], "+", 
                    SuperscriptBox["R", "2"], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "8"}], "+", 
                    RowBox[{"15", " ", "R"}], "-", 
                    RowBox[{"12", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "-", 
                    RowBox[{"11", " ", "R"}], "+", 
                    RowBox[{"16", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"11", " ", 
                    SuperscriptBox["R", "3"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{"12", "-", 
                    RowBox[{"19", " ", "R"}], "+", 
                    RowBox[{"12", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", "R"}]}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["R", "3"]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "20"}], "+", 
                    RowBox[{"71", " ", "R"}], "-", 
                    RowBox[{"108", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"71", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"18", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", 
                    RowBox[{"23", " ", "R"}], "-", 
                    RowBox[{"55", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"67", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"41", " ", 
                    SuperscriptBox["R", "4"]}], "+", 
                    RowBox[{"8", " ", 
                    SuperscriptBox["R", "5"]}]}], ")"}]}]}], ")"}]}]}], ")"}],
                     " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"-", "4"}], " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "-", 
                    SuperscriptBox["R", "2"], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"2", " ", "R"}], "+", 
                    SuperscriptBox["R", "2"]}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{"8", "-", 
                    RowBox[{"3", " ", "R"}], "-", 
                    SuperscriptBox["R", "2"], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "18"}], "+", 
                    RowBox[{"22", " ", "R"}], "+", 
                    SuperscriptBox["R", "2"], "-", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"14", "-", 
                    RowBox[{"29", " ", "R"}], "+", 
                    RowBox[{"10", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"7", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"6", " ", "R"}], "-", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    SuperscriptBox["R", "4"]}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "12"}], "+", 
                    RowBox[{"22", " ", "R"}], "-", 
                    SuperscriptBox["R", "2"], "-", 
                    RowBox[{"7", " ", 
                    SuperscriptBox["R", "3"]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"20", "-", 
                    RowBox[{"55", " ", "R"}], "+", 
                    RowBox[{"31", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"19", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"10", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", 
                    RowBox[{"16", " ", "R"}], "-", 
                    RowBox[{"20", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["R", "3"]}], "+", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{"18", "-", 
                    RowBox[{"29", " ", "R"}], "+", 
                    RowBox[{"6", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", "R"}]}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "-", 
                    RowBox[{"4", " ", "R"}], "+", 
                    SuperscriptBox["R", "2"], "+", 
                    SuperscriptBox["R", "3"]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "42"}], "+", 
                    RowBox[{"119", " ", "R"}], "-", 
                    RowBox[{"86", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"13", " ", 
                    SuperscriptBox["R", "3"]}], "+", 
                    RowBox[{"18", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"16", "-", 
                    RowBox[{"67", " ", "R"}], "+", 
                    RowBox[{"89", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"23", " ", 
                    SuperscriptBox["R", "3"]}], "-", 
                    RowBox[{"25", " ", 
                    SuperscriptBox["R", "4"]}], "+", 
                    RowBox[{"8", " ", 
                    SuperscriptBox["R", "5"]}]}], ")"}]}]}], ")"}]}]}], ")"}],
                     " ", 
                    SubscriptBox["sHap", "male"]}]}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["h", "female"], " ", 
                    SubscriptBox["sDip", "female"]}], "+", 
                   SubscriptBox["sHap", "female"], "+", 
                   SubscriptBox["sHap", "male"], "-", 
                   RowBox[{
                    SubscriptBox["h", "male"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sDip", "female"], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sHap", "female"], "+", 
                    SubscriptBox["sHap", "male"]}], ")"}]}]}], ")"}]}]}], 
                  ")"}]}], ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SubscriptBox["h", "female"]}]}], ")"}], " ", 
                  SubscriptBox["sDip", "female"]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SubscriptBox["h", "male"]}]}], ")"}], " ", 
                  SubscriptBox["sDip", "male"]}]}], ")"}]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "3"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}], "-", 
                   RowBox[{"2", " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "3"]}], "-", 
                    RowBox[{"3", " ", "R"}], "-", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "7"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "9"}], "+", 
                    RowBox[{"14", " ", "R"}], "-", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"]}]}], ")"}]}]}], ")"}]}], "-", 
                   RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "6"}], "+", 
                    RowBox[{"9", " ", "R"}], "+", 
                    RowBox[{"2", " ", "k", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "-", 
                    RowBox[{"6", " ", "R"}], "+", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"9", "+", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", "R"}]}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "-", 
                    RowBox[{"9", " ", "R"}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "21"}], "+", 
                    RowBox[{"45", " ", "R"}], "-", 
                    RowBox[{"26", " ", 
                    SuperscriptBox["R", "2"]}]}], ")"}]}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "8"}], "+", 
                    RowBox[{"27", " ", "R"}], "-", 
                    RowBox[{"29", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"8", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}]}], ")"}]}]}], ")"}],
                  " ", 
                 SubsuperscriptBox["sDip", "male", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["h", "female"], " ", 
                    SubscriptBox["sDip", "female"]}], "+", 
                    SubscriptBox["sHap", "female"], "+", 
                    SubscriptBox["sHap", "male"], "-", 
                    RowBox[{
                    SubscriptBox["h", "male"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sDip", "female"], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sHap", "female"], "+", 
                    SubscriptBox["sHap", "male"]}], ")"}]}]}], ")"}]}]}], 
                   ")"}], "2"]}], ")"}], "/", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SubscriptBox["h", "female"]}]}], ")"}], " ", 
                   SubscriptBox["sDip", "female"]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SubscriptBox["h", "male"]}]}], ")"}], " ", 
                   SubscriptBox["sDip", "male"]}]}], ")"}], "2"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"2", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", "R"}]}], 
                    ")"}]}], "-", 
                   RowBox[{"2", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"5", " ", "R"}], "-", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "-", 
                    RowBox[{"6", " ", "R"}], "+", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "-", 
                    RowBox[{"10", " ", "R"}], "+", 
                    RowBox[{"14", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", "R"}], 
                    "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "-", 
                    RowBox[{"9", " ", "R"}], "+", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
                    RowBox[{
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"9", " ", "R"}], "-", 
                    RowBox[{"9", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
                   RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "2"}], "+", 
                    RowBox[{"5", " ", "R"}], "+", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", "R"}]}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", "R"}], "-", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["R", "2"]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"4", "-", 
                    RowBox[{"19", " ", "R"}], "+", 
                    RowBox[{"23", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"8", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}], "-", 
                    RowBox[{"2", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"8", " ", "R"}], "+", 
                    RowBox[{"18", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"16", " ", 
                    SuperscriptBox["R", "3"]}], "+", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}]}]}], ")"}],
                  " ", 
                 SubsuperscriptBox["sDip", "female", "2"], " ", 
                 SuperscriptBox[
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{
                    SubscriptBox["h", "male"], " ", 
                    SubscriptBox["sDip", "male"]}], "+", 
                    SubscriptBox["sHap", "female"], "+", 
                    SubscriptBox["sHap", "male"], "-", 
                    RowBox[{
                    SubscriptBox["h", "female"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sDip", "male"], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sHap", "female"], "+", 
                    SubscriptBox["sHap", "male"]}], ")"}]}]}], ")"}]}]}], 
                   ")"}], "2"]}], ")"}], "/", 
               SuperscriptBox[
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SubscriptBox["h", "female"]}]}], ")"}], " ", 
                   SubscriptBox["sDip", "female"]}], "+", 
                  RowBox[{
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SubscriptBox["h", "male"]}]}], ")"}], " ", 
                   SubscriptBox["sDip", "male"]}]}], ")"}], "2"]}], "-", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"2", " ", 
                 SubscriptBox["sDip", "female"], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{
                    SubscriptBox["h", "male"], " ", 
                    SubscriptBox["sDip", "male"]}], "+", 
                   SubscriptBox["sHap", "female"], "+", 
                   SubscriptBox["sHap", "male"], "-", 
                   RowBox[{
                    SubscriptBox["h", "female"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sDip", "male"], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sHap", "female"], "+", 
                    SubscriptBox["sHap", "male"]}], ")"}]}]}], ")"}]}]}], 
                  ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"4", " ", "r", " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"8", " ", "k", " ", "r", " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "2"], " ", "r", " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"8", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"8", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"4", " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"8", " ", "k", " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "2"], " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"4", " ", "r", " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"17", " ", "k", " ", "r", " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"6", " ", 
                    SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"9", " ", 
                    SuperscriptBox["k", "3"], " ", "r", " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["k", "4"], " ", "r", " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"18", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"21", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "2"], " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"13", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "2"], " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "2"], " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"16", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "3"], " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "3"], " ", "R", " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"5", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"8", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"4", " ", "r", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"11", " ", "k", " ", "r", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"31", " ", 
                    SuperscriptBox["k", "2"], " ", "r", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"50", " ", 
                    SuperscriptBox["k", "3"], " ", "r", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"14", " ", 
                    SuperscriptBox["k", "4"], " ", "r", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"5", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"67", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"24", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"18", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"22", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"12", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"14", " ", "k", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"26", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"26", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"8", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"3", " ", "r", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"35", " ", "k", " ", "r", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"75", " ", 
                    SuperscriptBox["k", "2"], " ", "r", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"101", " ", 
                    SuperscriptBox["k", "3"], " ", "r", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"36", " ", 
                    SuperscriptBox["k", "4"], " ", "r", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"20", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"56", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"126", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"54", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"44", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"26", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"5", " ", "k", " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"17", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"24", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"10", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"14", " ", "k", " ", "r", " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"52", " ", 
                    SuperscriptBox["k", "2"], " ", "r", " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"86", " ", 
                    SuperscriptBox["k", "3"], " ", "r", " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"40", " ", 
                    SuperscriptBox["k", "4"], " ", "r", " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"10", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"48", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"102", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"54", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"10", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"38", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"24", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"6", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"8", " ", 
                    SuperscriptBox["k", "2"], " ", "r", " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"24", " ", 
                    SuperscriptBox["k", "3"], " ", "r", " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"16", " ", 
                    SuperscriptBox["k", "4"], " ", "r", " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"10", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"30", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"20", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "female"]}], "-", 
                   RowBox[{"12", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"8", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "female"]}], "+", 
                   RowBox[{"6", " ", "r", " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"16", " ", "k", " ", "r", " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"14", " ", 
                    SuperscriptBox["k", "2"], " ", "r", " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "3"], " ", "r", " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"10", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"18", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"8", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"4", " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"12", " ", "k", " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"12", " ", 
                    SuperscriptBox["k", "2"], " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "3"], " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"12", " ", "r", " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"56", " ", "k", " ", "r", " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"75", " ", 
                    SuperscriptBox["k", "2"], " ", "r", " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"33", " ", 
                    SuperscriptBox["k", "3"], " ", "r", " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["k", "4"], " ", "r", " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"36", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"85", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "2"], " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"53", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "2"], " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "2"], " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"20", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"24", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "3"], " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "3"], " ", "R", " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"27", " ", "k", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"40", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"20", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"10", " ", "r", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"83", " ", "k", " ", "r", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"161", " ", 
                    SuperscriptBox["k", "2"], " ", "r", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"102", " ", 
                    SuperscriptBox["k", "3"], " ", "r", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"14", " ", 
                    SuperscriptBox["k", "4"], " ", "r", " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"50", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"163", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"143", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"24", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"38", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"58", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"12", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "2"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"21", " ", "k", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"49", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"38", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"8", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"3", " ", "r", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"54", " ", "k", " ", "r", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"158", " ", 
                    SuperscriptBox["k", "2"], " ", "r", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"149", " ", 
                    SuperscriptBox["k", "3"], " ", "r", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"36", " ", 
                    SuperscriptBox["k", "4"], " ", "r", " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"34", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"154", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"190", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"54", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"36", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"72", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"26", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "3"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"5", " ", "k", " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"21", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"28", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"10", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"14", " ", "k", " ", "r", " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"68", " ", 
                    SuperscriptBox["k", "2"], " ", "r", " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"102", " ", 
                    SuperscriptBox["k", "3"], " ", "r", " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"40", " ", 
                    SuperscriptBox["k", "4"], " ", "r", " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"10", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"68", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"122", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"54", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"18", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"46", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"24", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "4"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"2", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"6", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"8", " ", 
                    SuperscriptBox["k", "2"], " ", "r", " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"24", " ", 
                    SuperscriptBox["k", "3"], " ", "r", " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"16", " ", 
                    SuperscriptBox["k", "4"], " ", "r", " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"10", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"30", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"20", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "2"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"4", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{"12", " ", 
                    SuperscriptBox["k", "3"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "male"]}], "-", 
                   RowBox[{"8", " ", 
                    SuperscriptBox["k", "4"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox["R", "5"], " ", 
                    SubscriptBox["sHap", "male"]}], "+", 
                   RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "k"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"4", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox["r", "3"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", "R"}]}], ")"}]}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "-", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"8", "-", 
                    RowBox[{"9", " ", "R"}], "+", 
                    SuperscriptBox["R", "2"]}], ")"}]}]}], ")"}]}], "-", 
                    RowBox[{"2", " ", "k", " ", 
                    SuperscriptBox["r", "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "5"}], "+", 
                    RowBox[{"8", " ", "R"}], "-", 
                    SuperscriptBox["R", "2"], "+", 
                    RowBox[{"2", " ", "k", " ", 
                    RowBox[{"(", 
                    RowBox[{"2", "-", 
                    RowBox[{"6", " ", "R"}], "+", 
                    RowBox[{"5", " ", 
                    SuperscriptBox["R", "2"]}]}], ")"}]}]}], ")"}]}], "+", 
                    RowBox[{"r", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"6", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", 
                    RowBox[{"4", " ", 
                    SuperscriptBox["k", "2"], " ", 
                    SuperscriptBox[
                    RowBox[{"(", 
                    RowBox[{"1", "-", 
                    RowBox[{"2", " ", "R"}]}], ")"}], "2"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", 
                    RowBox[{"k", " ", 
                    RowBox[{"(", 
                    RowBox[{"10", "-", 
                    RowBox[{"29", " ", "R"}], "+", 
                    RowBox[{"26", " ", 
                    SuperscriptBox["R", "2"]}], "-", 
                    RowBox[{"3", " ", 
                    SuperscriptBox["R", "3"]}]}], ")"}]}]}], ")"}]}]}], ")"}],
                     " ", 
                    SubscriptBox["sDip", "male"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    SubscriptBox["h", "female"], " ", 
                    SubscriptBox["sDip", "female"]}], "+", 
                    SubscriptBox["sHap", "female"], "+", 
                    SubscriptBox["sHap", "male"], "-", 
                    RowBox[{
                    SubscriptBox["h", "male"], " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sDip", "female"], "+", 
                    RowBox[{"2", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    SubscriptBox["sHap", "female"], "+", 
                    SubscriptBox["sHap", "male"]}], ")"}]}]}], ")"}]}]}], 
                    ")"}]}], ")"}], "/", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SubscriptBox["h", "female"]}]}], ")"}], " ", 
                    SubscriptBox["sDip", "female"]}], "+", 
                    RowBox[{
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SubscriptBox["h", "male"]}]}], ")"}], " ", 
                    SubscriptBox["sDip", "male"]}]}], ")"}]}]}], ")"}]}], 
                ")"}], "/", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SubscriptBox["h", "female"]}]}], ")"}], " ", 
                  SubscriptBox["sDip", "female"]}], "+", 
                 RowBox[{
                  RowBox[{"(", 
                   RowBox[{
                    RowBox[{"-", "1"}], "+", 
                    RowBox[{"2", " ", 
                    SubscriptBox["h", "male"]}]}], ")"}], " ", 
                  SubscriptBox["sDip", "male"]}]}], ")"}]}]}], ")"}]}], ")"}],
           "/", 
          RowBox[{"(", 
           RowBox[{"R", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", 
                  SubscriptBox["h", "female"]}]}], ")"}], " ", 
               SubscriptBox["sDip", "female"]}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"1", "-", 
                 RowBox[{"2", " ", 
                  SubscriptBox["h", "male"]}]}], ")"}], " ", 
               SubscriptBox["sDip", "male"]}]}], ")"}]}], ")"}]}]}], ")"}]}], 
      ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"4", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "2"}], "+", "k"}], ")"}], " ", 
          SuperscriptBox["k", "2"], " ", 
          SuperscriptBox["r", "3"], " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "-", "R"}], ")"}], 
          " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "R"}]}], ")"}]}], "-", 
         RowBox[{"2", " ", "R", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"5", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", "R"}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["k", "4"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "R"}], ")"}], "3"]}], "-", 
            RowBox[{
             SuperscriptBox["k", "3"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "13"}], "+", 
               RowBox[{"6", " ", "R"}]}], ")"}]}], "+", 
            RowBox[{"k", " ", 
             RowBox[{"(", 
              RowBox[{"29", "-", 
               RowBox[{"35", " ", "R"}], "+", 
               RowBox[{"9", " ", 
                SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["k", "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "30"}], "+", 
               RowBox[{"56", " ", "R"}], "-", 
               RowBox[{"30", " ", 
                SuperscriptBox["R", "2"]}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["R", "3"]}]}], ")"}]}]}], ")"}]}], "-", 
         RowBox[{"2", " ", "k", " ", 
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
          RowBox[{"(", 
           RowBox[{"20", "-", 
            RowBox[{"41", " ", "R"}], "+", 
            RowBox[{"17", " ", 
             SuperscriptBox["R", "2"]}], "+", 
            RowBox[{
             SuperscriptBox["k", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"22", "-", 
               RowBox[{"75", " ", "R"}], "+", 
               RowBox[{"85", " ", 
                SuperscriptBox["R", "2"]}], "-", 
               RowBox[{"30", " ", 
                SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["k", "3"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "2"}], "+", 
               RowBox[{"8", " ", "R"}], "-", 
               RowBox[{"11", " ", 
                SuperscriptBox["R", "2"]}], "+", 
               RowBox[{"5", " ", 
                SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "19"}], "+", 
               RowBox[{"53", " ", "R"}], "-", 
               RowBox[{"45", " ", 
                SuperscriptBox["R", "2"]}], "+", 
               RowBox[{"10", " ", 
                SuperscriptBox["R", "3"]}]}], ")"}]}]}], ")"}]}], "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"4", " ", 
             SuperscriptBox["k", "4"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"1", "-", 
                RowBox[{"3", " ", "R"}], "+", 
                RowBox[{"2", " ", 
                 SuperscriptBox["R", "2"]}]}], ")"}], "2"]}], "+", 
            RowBox[{"5", " ", 
             RowBox[{"(", 
              RowBox[{"5", "-", 
               RowBox[{"8", " ", "R"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
            RowBox[{"2", " ", "k", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "35"}], "+", 
               RowBox[{"96", " ", "R"}], "-", 
               RowBox[{"89", " ", 
                SuperscriptBox["R", "2"]}], "+", 
               RowBox[{"24", " ", 
                SuperscriptBox["R", "3"]}]}], ")"}]}], "-", 
            RowBox[{"2", " ", 
             SuperscriptBox["k", "3"], " ", 
             RowBox[{"(", 
              RowBox[{"14", "-", 
               RowBox[{"69", " ", "R"}], "+", 
               RowBox[{"124", " ", 
                SuperscriptBox["R", "2"]}], "-", 
               RowBox[{"93", " ", 
                SuperscriptBox["R", "3"]}], "+", 
               RowBox[{"24", " ", 
                SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["k", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"69", "-", 
               RowBox[{"266", " ", "R"}], "+", 
               RowBox[{"371", " ", 
                SuperscriptBox["R", "2"]}], "-", 
               RowBox[{"202", " ", 
                SuperscriptBox["R", "3"]}], "+", 
               RowBox[{"32", " ", 
                SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}]}]}], ")"}], 
       " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["h", "female"]}]}], ")"}], " ", 
           SubscriptBox["sDip", "female"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", 
              SubscriptBox["h", "male"]}]}], ")"}], " ", 
           SubscriptBox["sDip", "male"]}]}], ")"}], "3"]}], ")"}]}], "}"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.6821491983393717`*^9, 3.682149206167157*^9}}],

Cell["This reduces in some special cases", "Text",
 CellChangeTimes->{{3.681896653280909*^9, 3.681896658240189*^9}}],

Cell["1) masculinizer", "Text",
 CellChangeTimes->{{3.682164861653626*^9, 3.682164868730034*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"k0", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tester", "/.", 
       RowBox[{
        SubscriptBox["h", "sex_"], "\[Rule]", "h"}]}], "/.", 
      RowBox[{
       SubscriptBox["sHap", "female"], "\[Rule]", "0"}]}], "/.", 
     RowBox[{"k", "\[Rule]", "0"}]}], ",", 
    SubscriptBox["sHap", "male"], ",", "FullSimplify"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.681896470805915*^9, 3.6818965520570307`*^9}, {
  3.681896586564926*^9, 3.681896594016717*^9}, {3.681897413698255*^9, 
  3.6818974278748827`*^9}, {3.682149230059679*^9, 3.682149234037798*^9}, {
  3.682150331469249*^9, 3.682150340700798*^9}, {3.6821518270118217`*^9, 
  3.682151846036276*^9}, {3.682163637233365*^9, 3.68216364833718*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "h"}], ")"}], " ", "h", " ", 
     SubscriptBox["sDip", "female"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", 
           SuperscriptBox["R", "2"]}], "+", 
          RowBox[{"r", " ", "R", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"16", "-", 
                RowBox[{"7", " ", "R"}]}], ")"}], " ", "R"}]}], ")"}]}], "+", 
          
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"R", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "9"}], "+", 
                RowBox[{"8", " ", "R"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        SubscriptBox["sDip", "female"]}], "-", 
       RowBox[{"2", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "-", 
          RowBox[{"3", " ", "R"}]}], ")"}], " ", "R", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "R"}]}], ")"}], " ", 
        SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
     SubsuperscriptBox["sHap", "male", "2"]}], 
    RowBox[{"5", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "h"}]}], ")"}], "2"], " ", "r", " ", "R", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", "R"}], "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"3", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["sDip", "female"], "+", 
        SubscriptBox["sDip", "male"]}], ")"}], "2"]}]], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["sDip", "female"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", 
            SuperscriptBox["R", "2"]}], "+", 
           RowBox[{"r", " ", "R", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "5"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"16", "-", 
                 RowBox[{"7", " ", "R"}]}], ")"}], " ", "R"}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["r", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"R", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "9"}], "+", 
                 RowBox[{"8", " ", "R"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        " ", 
        SubscriptBox["sDip", "female"]}], "+", 
       RowBox[{"2", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "-", 
          RowBox[{"3", " ", "R"}]}], ")"}], " ", "R", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "R"}]}], ")"}], " ", 
        SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
     SubsuperscriptBox["sHap", "male", "3"]}], 
    RowBox[{"5", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "h"}]}], ")"}], "2"], " ", "r", " ", "R", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", "R"}], "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"3", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["sDip", "female"], "+", 
        SubscriptBox["sDip", "male"]}], ")"}], "3"]}]], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["sDip", "female"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", 
            SuperscriptBox["R", "2"]}], "+", 
           RowBox[{"r", " ", "R", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "5"}], "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{"16", "-", 
                 RowBox[{"7", " ", "R"}]}], ")"}], " ", "R"}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["r", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"R", " ", 
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "9"}], "+", 
                 RowBox[{"8", " ", "R"}]}], ")"}]}]}], ")"}]}]}], ")"}]}], 
        " ", 
        SubscriptBox["sDip", "female"]}], "+", 
       RowBox[{"2", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "-", 
          RowBox[{"3", " ", "R"}]}], ")"}], " ", "R", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "R"}]}], ")"}], " ", 
        SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
     SubsuperscriptBox["sHap", "male", "4"]}], 
    RowBox[{"5", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "h"}]}], ")"}], "2"], " ", "r", " ", "R", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", "R"}], "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"3", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["sDip", "female"], "+", 
        SubscriptBox["sDip", "male"]}], ")"}], "4"]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.681896496442911*^9, {3.68189654581968*^9, 3.681896553393869*^9}, {
   3.68189658708325*^9, 3.681896594475048*^9}, 3.6818969013792458`*^9, {
   3.681896960662054*^9, 3.68189697487287*^9}, {3.681897415659011*^9, 
   3.681897428333036*^9}, {3.6821492099693623`*^9, 3.6821492393226213`*^9}, {
   3.682150332123473*^9, 3.6821503438633204`*^9}, 3.682151847201303*^9, 
   3.682151880745062*^9, 3.6821605290500927`*^9, {3.682163638361672*^9, 
   3.682163649564539*^9}, 3.682164753484777*^9}]
}, Open  ]],

Cell["\<\
Now notice that after we factor out a big term we will call D0\
\>", "Text",
 CellChangeTimes->{{3.682164794640182*^9, 3.682164833133148*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"D0term", "=", 
   FractionBox[
    RowBox[{
     SubscriptBox["sDip", "female"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", 
           SuperscriptBox["R", "2"]}], "+", 
          RowBox[{"r", " ", "R", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"16", "-", 
                RowBox[{"7", " ", "R"}]}], ")"}], " ", "R"}]}], ")"}]}], "+", 
          
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"R", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "9"}], "+", 
                RowBox[{"8", " ", "R"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        SubscriptBox["sDip", "female"]}], "-", 
       RowBox[{"2", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "-", 
          RowBox[{"3", " ", "R"}]}], ")"}], " ", "R", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "R"}]}], ")"}], " ", 
        SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
     SubsuperscriptBox["sHap", "male", "2"]}], 
    RowBox[{"5", "  ", "r", " ", "R", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", "R"}], "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"3", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["sDip", "female"], "+", 
        SubscriptBox["sDip", "male"]}], ")"}], "2"]}]]}], ";"}]], "Input",
 CellChangeTimes->{{3.6821648775422153`*^9, 3.682164886991789*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"k0", "/", 
     RowBox[{"(", 
      RowBox[{"D0term", "/", "D0"}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"D0", ",", 
      SubscriptBox["sHap", "male"]}], "}"}], ",", "FullSimplify"}], "]"}], "//",
   "Factor"}]], "Input",
 CellChangeTimes->{{3.682164773402639*^9, 3.682164812113072*^9}, 
   3.682164893460759*^9}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"D0", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{"h", " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      SubscriptBox["sDip", "male"], "+", 
      RowBox[{"h", " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      SubscriptBox["sHap", "male"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"h", " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{"h", " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      SubscriptBox["sHap", "male"]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "h"}]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["sDip", "female"], "+", 
       SubscriptBox["sDip", "male"]}], ")"}], "2"]}]], "}"}]], "Output",
 CellChangeTimes->{
  3.682160352411379*^9, 3.682160530468231*^9, {3.682164755270235*^9, 
   3.682164812787928*^9}, 3.682164894375113*^9}]
}, Open  ]],

Cell["\<\
we are just left with the standing variance in A\
\>", "Text",
 CellChangeTimes->{{3.6821648354363422`*^9, 3.682164851483976*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"%", "/", 
      RowBox[{"(", 
       RowBox[{"pA", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], "/.", 
     RowBox[{"realsol", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
    RowBox[{
     SubscriptBox["h", "sex_"], "\[Rule]", "h"}]}], "/.", 
   RowBox[{
    SubscriptBox["sHap", "female"], "\[Rule]", "0"}]}], "//", 
  "FullSimplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", "D0", "}"}]], "Output",
 CellChangeTimes->{3.6821648190553513`*^9, 3.682164904956305*^9}]
}, Open  ]],

Cell["2) feminizer", "Text",
 CellChangeTimes->{{3.68216490827249*^9, 3.682164913435667*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"k1", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tester", "/.", 
       RowBox[{
        SubscriptBox["h", "sex_"], "\[Rule]", "h"}]}], "/.", 
      RowBox[{
       SubscriptBox["sHap", "female"], "\[Rule]", "0"}]}], "/.", 
     RowBox[{"k", "\[Rule]", "1"}]}], ",", 
    SubscriptBox["sHap", "male"], ",", "FullSimplify"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.6818966030617743`*^9, 3.681896603183154*^9}, {
  3.681897290275208*^9, 3.6818973150213842`*^9}, {3.681897388188265*^9, 
  3.681897407015929*^9}, {3.682149236184808*^9, 3.682149236533203*^9}, {
  3.682149357347699*^9, 3.682149358332753*^9}, {3.6821516162931547`*^9, 
  3.682151617045917*^9}, {3.682163660431718*^9, 3.682163683905622*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "1"}], "+", "h"}], ")"}], " ", "h", " ", 
      SubscriptBox["sDip", "female"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "r", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", "R"}], ")"}], " ", 
         SubscriptBox["sDip", "female"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "r"}]}], ")"}], " ", "R", " ", 
         SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
      SubsuperscriptBox["sHap", "male", "2"]}], 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "h"}]}], ")"}], "2"], " ", "r", " ", "R", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["sDip", "female"], "+", 
         SubscriptBox["sDip", "male"]}], ")"}], "2"]}]]}], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["sDip", "female"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", "R"}], ")"}], " ", 
        
        SubscriptBox["sDip", "female"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "r"}]}], ")"}], " ", "R", " ", 
        SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
     SubsuperscriptBox["sHap", "male", "3"]}], 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "h"}]}], ")"}], "2"], " ", "r", " ", "R", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["sDip", "female"], "+", 
        SubscriptBox["sDip", "male"]}], ")"}], "3"]}]], "+", 
   FractionBox[
    RowBox[{
     SubscriptBox["sDip", "female"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", "R"}], ")"}], " ", 
        
        SubscriptBox["sDip", "female"]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "r"}]}], ")"}], " ", "R", " ", 
        SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
     SubsuperscriptBox["sHap", "male", "4"]}], 
    RowBox[{"2", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"2", " ", "h"}]}], ")"}], "2"], " ", "r", " ", "R", " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["sDip", "female"], "+", 
        SubscriptBox["sDip", "male"]}], ")"}], "4"]}]]}], "}"}]], "Output",
 CellChangeTimes->{
  3.681896603786203*^9, {3.681897303652831*^9, 3.681897315683557*^9}, {
   3.6818973685824127`*^9, 3.681897407539693*^9}, {3.682149216964981*^9, 
   3.682149240178846*^9}, 3.6821516148096647`*^9, 3.6821603568497334`*^9, 
   3.6821605338145027`*^9, {3.682163660902459*^9, 3.682163685050239*^9}}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"D1term", "=", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{" ", 
      RowBox[{
       SubscriptBox["sDip", "female"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", "r", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", "R"}], ")"}], 
          " ", 
          SubscriptBox["sDip", "female"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", 
            RowBox[{"2", " ", "r"}]}], ")"}], " ", "R", " ", 
          SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
       SubsuperscriptBox["sHap", "male", "2"]}]}], 
     RowBox[{"2", "  ", "r", " ", "R", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["sDip", "female"], "+", 
         SubscriptBox["sDip", "male"]}], ")"}], "2"]}]]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682164931222704*^9, 3.6821649592124643`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{"k1", "/", 
     RowBox[{"(", 
      RowBox[{"D1term", "/", "D1"}], ")"}]}], ",", 
    RowBox[{"{", 
     RowBox[{"D1", ",", 
      SubscriptBox["sHap", "male"]}], "}"}], ",", "FullSimplify"}], "]"}], "//",
   "Factor"}]], "Input",
 CellChangeTimes->{{3.682151786549779*^9, 3.682151813890107*^9}, {
  3.682151918651389*^9, 3.6821519214673243`*^9}, {3.682160366570582*^9, 
  3.682160389774397*^9}, {3.6821649270541897`*^9, 3.682164946108848*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"D1", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{"h", " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      SubscriptBox["sDip", "male"], "+", 
      RowBox[{"h", " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      SubscriptBox["sHap", "male"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"h", " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{"h", " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      SubscriptBox["sHap", "male"]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "h"}]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["sDip", "female"], "+", 
       SubscriptBox["sDip", "male"]}], ")"}], "2"]}]], "}"}]], "Output",
 CellChangeTimes->{
  3.682151818652521*^9, 3.682151922389164*^9, {3.682160374595155*^9, 
   3.682160390529648*^9}, 3.682160534919342*^9, {3.682164942193033*^9, 
   3.682164960627572*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"%", "/", 
      RowBox[{"(", 
       RowBox[{"pA", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], "/.", 
     RowBox[{"realsol", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
    RowBox[{
     SubscriptBox["h", "sex_"], "\[Rule]", "h"}]}], "/.", 
   RowBox[{
    SubscriptBox["sHap", "female"], "\[Rule]", "0"}]}], "//", 
  "FullSimplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", "D1", "}"}]], "Output",
 CellChangeTimes->{{3.682164953942791*^9, 3.68216496172521*^9}}]
}, Open  ]],

Cell["3) 1/2 females and 1/2 males", "Text",
 CellChangeTimes->{{3.6821649747692947`*^9, 3.682164985410657*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"k12", "=", 
  RowBox[{"Collect", "[", 
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{"tester", "/.", 
       RowBox[{
        SubscriptBox["h", "sex_"], "\[Rule]", "h"}]}], "/.", 
      RowBox[{
       SubscriptBox["sHap", "female"], "\[Rule]", "0"}]}], "/.", 
     RowBox[{"k", "\[Rule]", 
      RowBox[{"1", "/", "2"}]}]}], ",", 
    SubscriptBox["sHap", "male"], ",", "Simplify"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.681896608124333*^9, 3.681896608411121*^9}, {
  3.681897444819927*^9, 3.6818974545083714`*^9}, {3.682149244547423*^9, 
  3.682149245073629*^9}, {3.682150355325428*^9, 3.682150356121624*^9}, {
  3.682163654616029*^9, 3.682163655970454*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "h"}], ")"}], " ", "h", " ", 
       SubscriptBox["sDip", "female"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"2", " ", 
             SuperscriptBox["r", "4"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["R", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"3", "+", 
               RowBox[{"8", " ", "R"}], "+", 
               RowBox[{"3", " ", 
                SuperscriptBox["R", "2"]}], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", "R", " ", 
             RowBox[{"(", 
              RowBox[{"5", "-", 
               RowBox[{"59", " ", "R"}], "+", 
               RowBox[{"29", " ", 
                SuperscriptBox["R", "2"]}], "+", 
               RowBox[{"41", " ", 
                SuperscriptBox["R", "3"]}], "-", 
               RowBox[{"10", " ", 
                SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["r", "3"], " ", "R", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "23"}], "+", 
               RowBox[{"42", " ", "R"}], "+", 
               RowBox[{"13", " ", 
                SuperscriptBox["R", "2"]}], "-", 
               RowBox[{"32", " ", 
                SuperscriptBox["R", "3"]}], "+", 
               RowBox[{"4", " ", 
                SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
            RowBox[{"r", " ", "R", " ", 
             RowBox[{"(", 
              RowBox[{"4", "+", 
               RowBox[{"9", " ", "R"}], "-", 
               RowBox[{"27", " ", 
                SuperscriptBox["R", "2"]}], "-", 
               RowBox[{"22", " ", 
                SuperscriptBox["R", "3"]}], "+", 
               RowBox[{"8", " ", 
                SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}], " ", 
          SubscriptBox["sDip", "female"]}], "+", 
         RowBox[{"R", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"R", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "-", 
               RowBox[{"2", " ", "R"}], "+", 
               SuperscriptBox["R", "2"]}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["r", "4"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"5", "-", 
               RowBox[{"14", " ", "R"}], "+", 
               RowBox[{"8", " ", 
                SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["r", "3"], " ", 
             RowBox[{"(", 
              RowBox[{"15", "-", 
               RowBox[{"22", " ", "R"}], "-", 
               RowBox[{"45", " ", 
                SuperscriptBox["R", "2"]}], "+", 
               RowBox[{"88", " ", 
                SuperscriptBox["R", "3"]}], "-", 
               RowBox[{"40", " ", 
                SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
            RowBox[{"r", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "4"}], "+", 
               RowBox[{"3", " ", "R"}], "+", 
               RowBox[{"15", " ", 
                SuperscriptBox["R", "2"]}], "-", 
               RowBox[{"2", " ", 
                SuperscriptBox["R", "3"]}], "-", 
               RowBox[{"8", " ", 
                SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"25", " ", "R"}], "-", 
               RowBox[{"21", " ", 
                SuperscriptBox["R", "2"]}], "-", 
               RowBox[{"35", " ", 
                SuperscriptBox["R", "3"]}], "+", 
               RowBox[{"32", " ", 
                SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}], " ", 
          SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
       SubsuperscriptBox["sHap", "male", "2"]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{"1", "-", 
          RowBox[{"2", " ", "h"}]}], ")"}], "2"], " ", "r", " ", "R", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          SuperscriptBox["r", "3"], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
          RowBox[{"(", 
           RowBox[{"3", "-", 
            RowBox[{"7", " ", "R"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
         RowBox[{"R", " ", 
          RowBox[{"(", 
           RowBox[{"12", "+", 
            RowBox[{"17", " ", "R"}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["R", "2"]}], "-", 
            RowBox[{"3", " ", 
             SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{"24", "-", 
            RowBox[{"43", " ", "R"}], "-", 
            RowBox[{"19", " ", 
             SuperscriptBox["R", "2"]}], "+", 
            RowBox[{"53", " ", 
             SuperscriptBox["R", "3"]}], "-", 
            RowBox[{"15", " ", 
             SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{"16", "+", 
            RowBox[{"21", " ", "R"}], "-", 
            RowBox[{"36", " ", 
             SuperscriptBox["R", "2"]}], "-", 
            RowBox[{"25", " ", 
             SuperscriptBox["R", "3"]}], "+", 
            RowBox[{"12", " ", 
             SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["sDip", "female"], "+", 
          SubscriptBox["sDip", "male"]}], ")"}], "2"]}], ")"}]}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["sDip", "female"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["r", "4"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["R", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"3", "+", 
              RowBox[{"8", " ", "R"}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["R", "2"]}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["r", "2"], " ", "R", " ", 
            RowBox[{"(", 
             RowBox[{"5", "-", 
              RowBox[{"59", " ", "R"}], "+", 
              RowBox[{"29", " ", 
               SuperscriptBox["R", "2"]}], "+", 
              RowBox[{"41", " ", 
               SuperscriptBox["R", "3"]}], "-", 
              RowBox[{"10", " ", 
               SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["r", "3"], " ", "R", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "23"}], "+", 
              RowBox[{"42", " ", "R"}], "+", 
              RowBox[{"13", " ", 
               SuperscriptBox["R", "2"]}], "-", 
              RowBox[{"32", " ", 
               SuperscriptBox["R", "3"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
           RowBox[{"r", " ", "R", " ", 
            RowBox[{"(", 
             RowBox[{"4", "+", 
              RowBox[{"9", " ", "R"}], "-", 
              RowBox[{"27", " ", 
               SuperscriptBox["R", "2"]}], "-", 
              RowBox[{"22", " ", 
               SuperscriptBox["R", "3"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}], " ", 
         SubscriptBox["sDip", "female"]}], "+", 
        RowBox[{"R", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"R", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "-", 
              RowBox[{"2", " ", "R"}], "+", 
              SuperscriptBox["R", "2"]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["r", "4"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{"5", "-", 
              RowBox[{"14", " ", "R"}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["r", "3"], " ", 
            RowBox[{"(", 
             RowBox[{"15", "-", 
              RowBox[{"22", " ", "R"}], "-", 
              RowBox[{"45", " ", 
               SuperscriptBox["R", "2"]}], "+", 
              RowBox[{"88", " ", 
               SuperscriptBox["R", "3"]}], "-", 
              RowBox[{"40", " ", 
               SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
           RowBox[{"r", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"3", " ", "R"}], "+", 
              RowBox[{"15", " ", 
               SuperscriptBox["R", "2"]}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["R", "3"]}], "-", 
              RowBox[{"8", " ", 
               SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["r", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"25", " ", "R"}], "-", 
              RowBox[{"21", " ", 
               SuperscriptBox["R", "2"]}], "-", 
              RowBox[{"35", " ", 
               SuperscriptBox["R", "3"]}], "+", 
              RowBox[{"32", " ", 
               SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}], " ", 
         SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
      SubsuperscriptBox["sHap", "male", "3"]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "h"}]}], ")"}], "2"], " ", "r", " ", "R", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", 
         SuperscriptBox["r", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"7", " ", "R"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
        RowBox[{"R", " ", 
         RowBox[{"(", 
          RowBox[{"12", "+", 
           RowBox[{"17", " ", "R"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["R", "2"]}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"24", "-", 
           RowBox[{"43", " ", "R"}], "-", 
           RowBox[{"19", " ", 
            SuperscriptBox["R", "2"]}], "+", 
           RowBox[{"53", " ", 
            SuperscriptBox["R", "3"]}], "-", 
           RowBox[{"15", " ", 
            SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
        RowBox[{"r", " ", 
         RowBox[{"(", 
          RowBox[{"16", "+", 
           RowBox[{"21", " ", "R"}], "-", 
           RowBox[{"36", " ", 
            SuperscriptBox["R", "2"]}], "-", 
           RowBox[{"25", " ", 
            SuperscriptBox["R", "3"]}], "+", 
           RowBox[{"12", " ", 
            SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["sDip", "female"], "+", 
         SubscriptBox["sDip", "male"]}], ")"}], "3"]}], ")"}]}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["sDip", "female"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", 
            SuperscriptBox["r", "4"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["R", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"3", "+", 
              RowBox[{"8", " ", "R"}], "+", 
              RowBox[{"3", " ", 
               SuperscriptBox["R", "2"]}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["r", "2"], " ", "R", " ", 
            RowBox[{"(", 
             RowBox[{"5", "-", 
              RowBox[{"59", " ", "R"}], "+", 
              RowBox[{"29", " ", 
               SuperscriptBox["R", "2"]}], "+", 
              RowBox[{"41", " ", 
               SuperscriptBox["R", "3"]}], "-", 
              RowBox[{"10", " ", 
               SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["r", "3"], " ", "R", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "23"}], "+", 
              RowBox[{"42", " ", "R"}], "+", 
              RowBox[{"13", " ", 
               SuperscriptBox["R", "2"]}], "-", 
              RowBox[{"32", " ", 
               SuperscriptBox["R", "3"]}], "+", 
              RowBox[{"4", " ", 
               SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
           RowBox[{"r", " ", "R", " ", 
            RowBox[{"(", 
             RowBox[{"4", "+", 
              RowBox[{"9", " ", "R"}], "-", 
              RowBox[{"27", " ", 
               SuperscriptBox["R", "2"]}], "-", 
              RowBox[{"22", " ", 
               SuperscriptBox["R", "3"]}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}], " ", 
         SubscriptBox["sDip", "female"]}], "+", 
        RowBox[{"R", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"R", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "-", 
              RowBox[{"2", " ", "R"}], "+", 
              SuperscriptBox["R", "2"]}], ")"}]}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["r", "4"], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
            RowBox[{"(", 
             RowBox[{"5", "-", 
              RowBox[{"14", " ", "R"}], "+", 
              RowBox[{"8", " ", 
               SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["r", "3"], " ", 
            RowBox[{"(", 
             RowBox[{"15", "-", 
              RowBox[{"22", " ", "R"}], "-", 
              RowBox[{"45", " ", 
               SuperscriptBox["R", "2"]}], "+", 
              RowBox[{"88", " ", 
               SuperscriptBox["R", "3"]}], "-", 
              RowBox[{"40", " ", 
               SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
           RowBox[{"r", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "4"}], "+", 
              RowBox[{"3", " ", "R"}], "+", 
              RowBox[{"15", " ", 
               SuperscriptBox["R", "2"]}], "-", 
              RowBox[{"2", " ", 
               SuperscriptBox["R", "3"]}], "-", 
              RowBox[{"8", " ", 
               SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
           RowBox[{
            SuperscriptBox["r", "2"], " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", 
              RowBox[{"25", " ", "R"}], "-", 
              RowBox[{"21", " ", 
               SuperscriptBox["R", "2"]}], "-", 
              RowBox[{"35", " ", 
               SuperscriptBox["R", "3"]}], "+", 
              RowBox[{"32", " ", 
               SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}], " ", 
         SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
      SubsuperscriptBox["sHap", "male", "4"]}], ")"}], "/", 
    RowBox[{"(", 
     RowBox[{"2", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{"1", "-", 
         RowBox[{"2", " ", "h"}]}], ")"}], "2"], " ", "r", " ", "R", " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"3", " ", 
         SuperscriptBox["r", "3"], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
         RowBox[{"(", 
          RowBox[{"3", "-", 
           RowBox[{"7", " ", "R"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["R", "2"]}]}], ")"}]}], "+", 
        RowBox[{"R", " ", 
         RowBox[{"(", 
          RowBox[{"12", "+", 
           RowBox[{"17", " ", "R"}], "+", 
           RowBox[{"2", " ", 
            SuperscriptBox["R", "2"]}], "-", 
           RowBox[{"3", " ", 
            SuperscriptBox["R", "3"]}]}], ")"}]}], "+", 
        RowBox[{
         SuperscriptBox["r", "2"], " ", 
         RowBox[{"(", 
          RowBox[{"24", "-", 
           RowBox[{"43", " ", "R"}], "-", 
           RowBox[{"19", " ", 
            SuperscriptBox["R", "2"]}], "+", 
           RowBox[{"53", " ", 
            SuperscriptBox["R", "3"]}], "-", 
           RowBox[{"15", " ", 
            SuperscriptBox["R", "4"]}]}], ")"}]}], "+", 
        RowBox[{"r", " ", 
         RowBox[{"(", 
          RowBox[{"16", "+", 
           RowBox[{"21", " ", "R"}], "-", 
           RowBox[{"36", " ", 
            SuperscriptBox["R", "2"]}], "-", 
           RowBox[{"25", " ", 
            SuperscriptBox["R", "3"]}], "+", 
           RowBox[{"12", " ", 
            SuperscriptBox["R", "4"]}]}], ")"}]}]}], ")"}], " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["sDip", "female"], "+", 
         SubscriptBox["sDip", "male"]}], ")"}], "4"]}], ")"}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.681896612965579*^9, {3.681897452281852*^9, 3.681897458842802*^9}, {
   3.682149223382924*^9, 3.682149249850553*^9}, 3.682150357341021*^9, 
   3.682151950897567*^9, 3.6821603953081083`*^9, 3.682160540122958*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"D12term", "=", 
   RowBox[{"-", 
    RowBox[{"(", 
     RowBox[{
      SubscriptBox["sDip", "female"], " ", 
      SubsuperscriptBox["sHap", "male", "2"], 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["r", "4"]}], "+", 
            RowBox[{"r", " ", 
             RowBox[{"(", 
              RowBox[{"4", "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{"5", "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "23"}], "+", 
                    RowBox[{"4", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
             " ", "R"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{"9", "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "59"}], "+", 
                    RowBox[{"6", " ", "r", " ", 
                    RowBox[{"(", 
                    RowBox[{"7", "+", "r"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
              ")"}], " ", 
             SuperscriptBox["R", "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"8", "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "27"}], "-", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "r"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "29"}], "+", 
                    RowBox[{"16", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
             " ", 
             SuperscriptBox["R", "3"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "22"}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{"41", "+", 
                    RowBox[{"8", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", "r"}], ")"}], " ", "r"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}], " ", 
             SuperscriptBox["R", "4"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "r"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "r"}]}], ")"}], " ", 
             SuperscriptBox["R", "5"]}]}], ")"}], " ", 
          SubscriptBox["sDip", "female"]}], "+", 
         RowBox[{"R", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", "R", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "R"}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["r", "4"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"5", "+", 
               RowBox[{"2", " ", "R", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "7"}], "+", 
                  RowBox[{"4", " ", "R"}]}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{"r", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "4"}], "+", 
               RowBox[{"R", " ", 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{"15", "-", 
                    RowBox[{"2", " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "R"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["r", "3"], " ", 
             RowBox[{"(", 
              RowBox[{"15", "-", 
               RowBox[{"R", " ", 
                RowBox[{"(", 
                 RowBox[{"22", "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{"45", "+", 
                    RowBox[{"8", " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "11"}], "+", 
                    RowBox[{"5", " ", "R"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"R", " ", 
                RowBox[{"(", 
                 RowBox[{"25", "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "21"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "35"}], "+", 
                    RowBox[{"32", " ", "R"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}], " ", 
          SubscriptBox["sDip", "male"]}]}], ")"}], "/", 
       RowBox[{"(", 
        RowBox[{"2", "  ", "r", " ", "R", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "4"}], "-", 
           RowBox[{"3", " ", "R"}], "+", 
           RowBox[{"r", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", 
              RowBox[{"6", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{
            SuperscriptBox["r", "2"], " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"]}], "+", 
           RowBox[{
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", "R", " ", 
            RowBox[{"(", 
             RowBox[{"1", "+", "R"}], ")"}]}], "-", 
           RowBox[{"2", " ", "r", " ", 
            RowBox[{"(", 
             RowBox[{"2", "+", 
              RowBox[{
               RowBox[{"(", 
                RowBox[{
                 RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", 
               SuperscriptBox["R", "2"]}]}], ")"}]}]}], ")"}], " ", 
         SuperscriptBox[
          RowBox[{"(", 
           RowBox[{
            SubscriptBox["sDip", "female"], "+", 
            SubscriptBox["sDip", "male"]}], ")"}], "2"]}], ")"}]}]}], 
     ")"}]}]}], ";", 
  RowBox[{
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"k12", "/", 
      RowBox[{"(", 
       RowBox[{"D12term", "/", "D12"}], ")"}]}], ",", 
     RowBox[{"{", 
      RowBox[{"D12", ",", 
       SubscriptBox["sHap", "male"]}], "}"}], ",", "FullSimplify"}], "]"}], "//",
    "Factor"}]}]], "Input",
 CellChangeTimes->{{3.68214932883502*^9, 3.6821493847507477`*^9}, {
   3.6821494160889597`*^9, 3.682149465928753*^9}, {3.682149944102669*^9, 
   3.682149968412656*^9}, 3.682149998415751*^9, {3.6821500348479013`*^9, 
   3.682150038303693*^9}, {3.6821500742708273`*^9, 3.682150074672614*^9}, {
   3.682150116927743*^9, 3.6821501287365227`*^9}, {3.682150163345175*^9, 
   3.6821501652275352`*^9}, {3.682151930186022*^9, 3.682151970101542*^9}, {
   3.682160400076407*^9, 3.682160411664277*^9}, {3.682164993030183*^9, 
   3.6821650248204613`*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  FractionBox[
   RowBox[{"D12", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{"h", " ", 
       SubscriptBox["sDip", "female"]}], "-", 
      SubscriptBox["sDip", "male"], "+", 
      RowBox[{"h", " ", 
       SubscriptBox["sDip", "male"]}], "-", 
      SubscriptBox["sHap", "male"]}], ")"}], " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"h", " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{"h", " ", 
       SubscriptBox["sDip", "male"]}], "+", 
      SubscriptBox["sHap", "male"]}], ")"}]}], 
   RowBox[{
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", 
       RowBox[{"2", " ", "h"}]}], ")"}], "2"], " ", 
    SuperscriptBox[
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["sDip", "female"], "+", 
       SubscriptBox["sDip", "male"]}], ")"}], "2"]}]], "}"}]], "Output",
 CellChangeTimes->{{3.682149329519835*^9, 3.6821493850249147`*^9}, {
   3.682149429374214*^9, 3.6821494664092093`*^9}, 3.682149739469295*^9, {
   3.6821499477567053`*^9, 3.682149974994133*^9}, 3.6821500060648413`*^9, {
   3.682150050733369*^9, 3.682150075668618*^9}, {3.6821501221838417`*^9, 
   3.682150129577229*^9}, 3.682150166131616*^9, {3.6821519467773943`*^9, 
   3.682151971673435*^9}, {3.682160405495327*^9, 3.682160411995614*^9}, 
   3.6821605412507963`*^9, {3.682164993394133*^9, 3.6821650255446453`*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"%", "/", 
      RowBox[{"(", 
       RowBox[{"pA", 
        RowBox[{"(", 
         RowBox[{"1", "-", "pA"}], ")"}]}], ")"}]}], "/.", 
     RowBox[{"realsol", "[", 
      RowBox[{"[", "3", "]"}], "]"}]}], "/.", 
    RowBox[{
     SubscriptBox["h", "sex_"], "\[Rule]", "h"}]}], "/.", 
   RowBox[{
    SubscriptBox["sHap", "female"], "\[Rule]", "0"}]}], "//", 
  "FullSimplify"}]], "Input"],

Cell[BoxData[
 RowBox[{"{", "D12", "}"}]], "Output",
 CellChangeTimes->{3.6821650328271008`*^9}]
}, Open  ]],

Cell["Check sign", "Text",
 CellChangeTimes->{{3.6821604363267107`*^9, 3.682160438295333*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dterms", "=", 
  RowBox[{"{", 
   RowBox[{"D0term", ",", "D1term", ",", "D12term"}], "}"}]}]], "Input",
 CellChangeTimes->{{3.6821521300434227`*^9, 3.682152172901102*^9}, {
   3.68215222426152*^9, 3.682152243131865*^9}, 3.6821522733222*^9, {
   3.6821604604186773`*^9, 3.682160485740032*^9}, {3.682165048036442*^9, 
   3.682165060004945*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{
     SubscriptBox["sDip", "female"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", 
           SuperscriptBox["R", "2"]}], "+", 
          RowBox[{"r", " ", "R", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"16", "-", 
                RowBox[{"7", " ", "R"}]}], ")"}], " ", "R"}]}], ")"}]}], "+", 
          
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"R", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "9"}], "+", 
                RowBox[{"8", " ", "R"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        SubscriptBox["sDip", "female"]}], "-", 
       RowBox[{"2", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "-", 
          RowBox[{"3", " ", "R"}]}], ")"}], " ", "R", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "R"}]}], ")"}], " ", 
        SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
     SubsuperscriptBox["sHap", "male", "2"]}], 
    RowBox[{"5", " ", "r", " ", "R", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", "R"}], "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"3", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        SubscriptBox["sDip", "female"], "+", 
        SubscriptBox["sDip", "male"]}], ")"}], "2"]}]], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["sDip", "female"], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"2", " ", "r", " ", 
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", "R"}], ")"}], " ", 
         SubscriptBox["sDip", "female"]}], "+", 
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", 
           RowBox[{"2", " ", "r"}]}], ")"}], " ", "R", " ", 
         SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
      SubsuperscriptBox["sHap", "male", "2"]}], 
     RowBox[{"2", " ", "r", " ", "R", " ", 
      SuperscriptBox[
       RowBox[{"(", 
        RowBox[{
         SubscriptBox["sDip", "female"], "+", 
         SubscriptBox["sDip", "male"]}], ")"}], "2"]}]]}], ",", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SubscriptBox["sDip", "female"], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"-", "2"}], " ", 
             SuperscriptBox["r", "4"]}], "+", 
            RowBox[{"r", " ", 
             RowBox[{"(", 
              RowBox[{"4", "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{"5", "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "23"}], "+", 
                    RowBox[{"4", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
             " ", "R"}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{"9", "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "59"}], "+", 
                    RowBox[{"6", " ", "r", " ", 
                    RowBox[{"(", 
                    RowBox[{"7", "+", "r"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
              ")"}], " ", 
             SuperscriptBox["R", "2"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"8", "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "27"}], "-", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{"1", "+", "r"}], ")"}], " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "29"}], "+", 
                    RowBox[{"16", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
             " ", 
             SuperscriptBox["R", "3"]}], "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{"3", "+", 
               RowBox[{"r", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "22"}], "+", 
                  RowBox[{"r", " ", 
                   RowBox[{"(", 
                    RowBox[{"41", "+", 
                    RowBox[{"8", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", "r"}], ")"}], " ", "r"}]}], 
                    ")"}]}]}], ")"}]}]}], ")"}], " ", 
             SuperscriptBox["R", "4"]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "r"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "1"}], "+", 
               RowBox[{"2", " ", "r"}]}], ")"}], " ", 
             SuperscriptBox["R", "5"]}]}], ")"}], " ", 
          SubscriptBox["sDip", "female"]}], "+", 
         RowBox[{"R", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", "R", " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", "R"}], ")"}]}], "+", 
            RowBox[{"2", " ", 
             SuperscriptBox["r", "4"], " ", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
             RowBox[{"(", 
              RowBox[{"5", "+", 
               RowBox[{"2", " ", "R", " ", 
                RowBox[{"(", 
                 RowBox[{
                  RowBox[{"-", "7"}], "+", 
                  RowBox[{"4", " ", "R"}]}], ")"}]}]}], ")"}]}], "+", 
            RowBox[{"r", " ", 
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "4"}], "+", 
               RowBox[{"R", " ", 
                RowBox[{"(", 
                 RowBox[{"3", "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{"15", "-", 
                    RowBox[{"2", " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "R"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["r", "3"], " ", 
             RowBox[{"(", 
              RowBox[{"15", "-", 
               RowBox[{"R", " ", 
                RowBox[{"(", 
                 RowBox[{"22", "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{"45", "+", 
                    RowBox[{"8", " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "11"}], "+", 
                    RowBox[{"5", " ", "R"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}], "+", 
            RowBox[{
             SuperscriptBox["r", "2"], " ", 
             RowBox[{"(", 
              RowBox[{"1", "+", 
               RowBox[{"R", " ", 
                RowBox[{"(", 
                 RowBox[{"25", "+", 
                  RowBox[{"R", " ", 
                   RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "21"}], "+", 
                    RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "35"}], "+", 
                    RowBox[{"32", " ", "R"}]}], ")"}]}]}], ")"}]}]}], 
                 ")"}]}]}], ")"}]}]}], ")"}], " ", 
          SubscriptBox["sDip", "male"]}]}], ")"}], " ", 
       SubsuperscriptBox["sHap", "male", "2"]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{"2", " ", "r", " ", "R", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "4"}], "-", 
         RowBox[{"3", " ", "R"}], "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{"6", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", "R", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "R"}], ")"}]}], "-", 
         RowBox[{"2", " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", 
             SuperscriptBox["R", "2"]}]}], ")"}]}]}], ")"}], " ", 
       SuperscriptBox[
        RowBox[{"(", 
         RowBox[{
          SubscriptBox["sDip", "female"], "+", 
          SubscriptBox["sDip", "male"]}], ")"}], "2"]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{3.682165060303096*^9}]
}, Open  ]],

Cell[BoxData[
 RowBox[{
  RowBox[{"Cterm", "=", 
   RowBox[{"(", 
    RowBox[{
     SubscriptBox["sDip", "female"], "  ", 
     RowBox[{
      SubsuperscriptBox["sHap", "male", "2"], "/", 
      RowBox[{"(", 
       RowBox[{"2", "  ", "r", " ", "R", " ", 
        SuperscriptBox[
         RowBox[{"(", 
          RowBox[{
           SubscriptBox["sDip", "female"], "+", 
           SubscriptBox["sDip", "male"]}], ")"}], "2"]}], ")"}]}]}], ")"}]}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.682165105150345*^9, 3.682165110912519*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dterms", "=", 
  RowBox[{
   RowBox[{
    RowBox[{"{", 
     RowBox[{"D0term", ",", "D1term", ",", "D12term"}], "}"}], "/", "Cterm"}],
    "//", "Simplify"}]}]], "Input",
 CellChangeTimes->{{3.682165067268648*^9, 3.68216511697958*^9}, {
  3.682165567027172*^9, 3.682165581062051*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", 
           SuperscriptBox["R", "2"]}], "+", 
          RowBox[{"r", " ", "R", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "5"}], "+", 
             RowBox[{
              RowBox[{"(", 
               RowBox[{"16", "-", 
                RowBox[{"7", " ", "R"}]}], ")"}], " ", "R"}]}], ")"}]}], "+", 
          
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"R", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "9"}], "+", 
                RowBox[{"8", " ", "R"}]}], ")"}]}]}], ")"}]}]}], ")"}], " ", 
        SubscriptBox["sDip", "female"]}], "-", 
       RowBox[{"2", " ", "r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"4", " ", "r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "-", 
          RowBox[{"3", " ", "R"}]}], ")"}], " ", "R", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "R"}]}], ")"}], " ", 
        SubscriptBox["sDip", "male"]}]}], ")"}]}], 
    RowBox[{"5", " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "2"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "R"}], ")"}], " ", "R"}], "+", 
       RowBox[{"r", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "5"}], "+", 
          RowBox[{"3", " ", "R"}]}], ")"}]}]}], ")"}]}]], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"2", " ", "r", " ", 
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "R"}], ")"}]}], "+", "R"}], ")"}]}], " ", 
     
     SubscriptBox["sDip", "female"]}], "+", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", 
       RowBox[{"2", " ", "r"}]}], ")"}], " ", "R", " ", 
     SubscriptBox["sDip", "male"]}]}], ",", 
   RowBox[{"-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"-", "2"}], " ", 
           SuperscriptBox["r", "4"]}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{"4", "+", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{"5", "+", 
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "23"}], "+", 
                   RowBox[{"4", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
           " ", "R"}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{"9", "+", 
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "59"}], "+", 
                   RowBox[{"6", " ", "r", " ", 
                    RowBox[{"(", 
                    RowBox[{"7", "+", "r"}], ")"}]}]}], ")"}]}]}], ")"}]}]}], 
            ")"}], " ", 
           SuperscriptBox["R", "2"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"8", "+", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "27"}], "-", 
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{"1", "+", "r"}], ")"}], " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "29"}], "+", 
                   RowBox[{"16", " ", "r"}]}], ")"}]}]}], ")"}]}]}], ")"}], 
           " ", 
           SuperscriptBox["R", "3"]}], "+", 
          RowBox[{
           RowBox[{"(", 
            RowBox[{"3", "+", 
             RowBox[{"r", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "22"}], "+", 
                RowBox[{"r", " ", 
                 RowBox[{"(", 
                  RowBox[{"41", "+", 
                   RowBox[{"8", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "4"}], "+", "r"}], ")"}], " ", "r"}]}], 
                  ")"}]}]}], ")"}]}]}], ")"}], " ", 
           SuperscriptBox["R", "4"]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "r"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", 
             RowBox[{"2", " ", "r"}]}], ")"}], " ", 
           SuperscriptBox["R", "5"]}]}], ")"}], " ", 
        SubscriptBox["sDip", "female"]}], "+", 
       RowBox[{"R", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", "R", " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", "R"}], ")"}]}], "+", 
          RowBox[{"2", " ", 
           SuperscriptBox["r", "4"], " ", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{
              RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"], " ", 
           RowBox[{"(", 
            RowBox[{"5", "+", 
             RowBox[{"2", " ", "R", " ", 
              RowBox[{"(", 
               RowBox[{
                RowBox[{"-", "7"}], "+", 
                RowBox[{"4", " ", "R"}]}], ")"}]}]}], ")"}]}], "+", 
          RowBox[{"r", " ", 
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "4"}], "+", 
             RowBox[{"R", " ", 
              RowBox[{"(", 
               RowBox[{"3", "+", 
                RowBox[{"R", " ", 
                 RowBox[{"(", 
                  RowBox[{"15", "-", 
                   RowBox[{"2", " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{"1", "+", 
                    RowBox[{"4", " ", "R"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["r", "3"], " ", 
           RowBox[{"(", 
            RowBox[{"15", "-", 
             RowBox[{"R", " ", 
              RowBox[{"(", 
               RowBox[{"22", "+", 
                RowBox[{"R", " ", 
                 RowBox[{"(", 
                  RowBox[{"45", "+", 
                   RowBox[{"8", " ", "R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "11"}], "+", 
                    RowBox[{"5", " ", "R"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}], "+", 
          RowBox[{
           SuperscriptBox["r", "2"], " ", 
           RowBox[{"(", 
            RowBox[{"1", "+", 
             RowBox[{"R", " ", 
              RowBox[{"(", 
               RowBox[{"25", "+", 
                RowBox[{"R", " ", 
                 RowBox[{"(", 
                  RowBox[{
                   RowBox[{"-", "21"}], "+", 
                   RowBox[{"R", " ", 
                    RowBox[{"(", 
                    RowBox[{
                    RowBox[{"-", "35"}], "+", 
                    RowBox[{"32", " ", "R"}]}], ")"}]}]}], ")"}]}]}], 
               ")"}]}]}], ")"}]}]}], ")"}], " ", 
        SubscriptBox["sDip", "male"]}]}], ")"}], "/", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "4"}], "-", 
         RowBox[{"3", " ", "R"}], "+", 
         RowBox[{"r", " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", 
            RowBox[{"6", " ", "R"}]}], ")"}]}]}], ")"}], " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{
          SuperscriptBox["r", "2"], " ", 
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", 
          SuperscriptBox[
           RowBox[{"(", 
            RowBox[{
             RowBox[{"-", "1"}], "+", "R"}], ")"}], "2"]}], "+", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", "R", " ", 
          RowBox[{"(", 
           RowBox[{"1", "+", "R"}], ")"}]}], "-", 
         RowBox[{"2", " ", "r", " ", 
          RowBox[{"(", 
           RowBox[{"2", "+", 
            RowBox[{
             RowBox[{"(", 
              RowBox[{
               RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", 
             SuperscriptBox["R", "2"]}]}], ")"}]}]}], ")"}]}], ")"}]}]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.682165070836542*^9, 3.682165076968988*^9}, 
   3.682165117935193*^9, 3.6821654187325573`*^9, {3.6821655700427*^9, 
   3.682165581743106*^9}}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dterms", "/.", 
  RowBox[{"r", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{{3.682165385142643*^9, 3.682165456165148*^9}, {
  3.682165495745532*^9, 3.6821654959091587`*^9}, {3.6821655488004007`*^9, 
  3.682165561641715*^9}, {3.6821655976432867`*^9, 3.682165598578507*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{"2", " ", "R", " ", 
      SubscriptBox["sDip", "female"]}], "5"]}], ",", 
   RowBox[{
    RowBox[{
     RowBox[{"-", "R"}], " ", 
     SubscriptBox["sDip", "female"]}], "+", 
    RowBox[{"R", " ", 
     SubscriptBox["sDip", "male"]}]}], ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"3", " ", 
          SuperscriptBox["R", "2"]}], "+", 
         RowBox[{"8", " ", 
          SuperscriptBox["R", "3"]}], "+", 
         RowBox[{"3", " ", 
          SuperscriptBox["R", "4"]}], "-", 
         RowBox[{"2", " ", 
          SuperscriptBox["R", "5"]}]}], ")"}], " ", 
       SubscriptBox["sDip", "female"]}], "+", 
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", 
       SuperscriptBox["R", "2"], " ", 
       RowBox[{"(", 
        RowBox[{"1", "+", "R"}], ")"}], " ", 
       SubscriptBox["sDip", "male"]}]}], 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "4"}], "-", 
        RowBox[{"3", " ", "R"}]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "3"}], "+", "R"}], ")"}], " ", "R", " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", "R"}], ")"}]}]]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.682165386606023*^9, 3.682165456592935*^9}, 
   3.6821654961446657`*^9, {3.682165550146494*^9, 3.682165562002043*^9}, 
   3.682165598931973*^9}]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Dterms", "/.", 
  RowBox[{"R", "\[Rule]", "0"}]}]], "Input",
 CellChangeTimes->{3.6821656057632093`*^9}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   FractionBox[
    RowBox[{"2", " ", "r", " ", 
     SubscriptBox["sDip", "female"]}], "25"], ",", 
   RowBox[{"2", " ", "r", " ", 
    SubscriptBox["sDip", "female"]}], ",", 
   FractionBox[
    RowBox[{"2", " ", 
     SuperscriptBox["r", "4"], " ", 
     SubscriptBox["sDip", "female"]}], 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "4"}], "-", 
       RowBox[{"3", " ", "r"}]}], ")"}], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"-", "4"}], " ", "r"}], "-", 
       RowBox[{"3", " ", 
        SuperscriptBox["r", "2"]}]}], ")"}]}]]}], "}"}]], "Output",
 CellChangeTimes->{3.68216560636409*^9}]
}, Open  ]]
}, Open  ]],

Cell[CellGroupData[{

Cell["\<\
Sex chromosome turnover (selection not assumed to be weak)\
\>", "Section",
 CellChangeTimes->{{3.682160901178039*^9, 3.6821609017597523`*^9}, {
  3.6821629819198933`*^9, 3.682162988413978*^9}}],

Cell[CellGroupData[{

Cell["neo-W", "Subsection",
 CellChangeTimes->{{3.6821624563082542`*^9, 3.682162458363648*^9}}],

Cell["\<\
When the maternal ESD is a feminizer the result is the same as in the \
offspring controlled k=1 case (neo-W).\
\>", "Text",
 CellChangeTimes->{{3.6821629385218887`*^9, 3.682163001849638*^9}}],

Cell["Characteristic polynomial", "Text",
 CellChangeTimes->{{3.682163008378957*^9, 3.6821630142426023`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"charpolyk1", "=", 
   RowBox[{
    RowBox[{"charpolyExt", "/.", 
     RowBox[{"k", "\[Rule]", "1"}]}], "//", "Factor"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.6821620659520073`*^9, 3.682162071697071*^9}, {
  3.6821622030379333`*^9, 3.682162215686831*^9}}],

Cell["\<\
where one solution has coefficients\
\>", "Text",
 CellChangeTimes->{{3.682163016592078*^9, 3.6821630323047867`*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"charpoly\[Alpha]1", "=", 
   RowBox[{"Collect", "[", 
    RowBox[{
     RowBox[{"charpolyk1", "[", 
      RowBox[{"[", "4", "]"}], "]"}], ",", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"acoef1", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"charpoly\[Alpha]1", ",", 
     RowBox[{"\[Lambda]", "^", "2"}]}], "]"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"bcoef1", "=", 
   RowBox[{"Coefficient", "[", 
    RowBox[{"charpoly\[Alpha]1", ",", "\[Lambda]"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ccoef1", "=", 
   RowBox[{"charpoly\[Alpha]1", "-", 
    RowBox[{"acoef1", " ", 
     RowBox[{"\[Lambda]", "^", "2"}]}], "-", 
    RowBox[{"bcoef1", " ", "\[Lambda]"}]}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.6821622187286386`*^9, 3.682162230854783*^9}}],

Cell["Mean resident female fitness", "Text",
 CellChangeTimes->{{3.682163036727543*^9, 3.6821630419679203`*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"femaleMeanFit", "=", "\[IndentingNewLine]", 
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXf"}], ")"}], 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pXm"}], ")"}], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "male"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "a", ",", "female"}]]}], "+", "\[IndentingNewLine]", 
    RowBox[{"pXf", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{"1", "-", "pXm"}], ")"}], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "male"}]], 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "female"}]]}], "+", "\[IndentingNewLine]", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{"1", "-", "pXf"}], ")"}], 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "female"}]], " ", "pXm", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "male"}]], 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "female"}]]}], " ", "+", 
    "\[IndentingNewLine]", 
    RowBox[{"pXf", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "female"}]], " ", "pXm", " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "male"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "A", ",", "female"}]]}]}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682162313623106*^9, 3.682162327394395*^9}}],

Cell["Coefficient a", "Text",
 CellChangeTimes->{{3.682163049003201*^9, 3.682163056238812*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"acoef1", "/", 
   SuperscriptBox[
    RowBox[{"(", 
     RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}], "2"]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{{3.682162093516286*^9, 3.682162094882443*^9}, {
  3.682162232746429*^9, 3.682162261706773*^9}, {3.682162332445537*^9, 
  3.6821623402644663`*^9}}],

Cell[BoxData[
 RowBox[{"4", " ", 
  SuperscriptBox["meanF", "2"]}]], "Output",
 CellChangeTimes->{
  3.6821620954895487`*^9, {3.682162234328147*^9, 3.68216226209066*^9}, {
   3.682162336860463*^9, 3.6821623405924397`*^9}}]
}, Open  ]],

Cell["Coefficient b", "Text",
 CellChangeTimes->{{3.68216306206063*^9, 3.6821630633904037`*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"bcoef1", "/", 
   RowBox[{"(", 
    RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}]}], "//", 
  "Simplify"}]], "Input",
 CellChangeTimes->{
  3.682162267722344*^9, {3.68216234615552*^9, 3.682162347749711*^9}}],

Cell[BoxData[
 RowBox[{"2", " ", "meanF", " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "pXm", "+", "pYm"}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "a", ",", "female"}]]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pXm", "+", "pYm"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "A", ",", "female"}]]}]}], ")"}]}], "-", 
    RowBox[{
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "female"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "pXm", "+", "pYm"}], ")"}], " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "a", ",", "female"}]]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{"pXm", "+", "pYm"}], ")"}], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "male"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "A", ",", "female"}]]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{3.682162275528998*^9, 3.682162348185268*^9}]
}, Open  ]],

Cell["Coefficient c", "Text",
 CellChangeTimes->{{3.682163068464511*^9, 3.682163070014222*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"ccoef1", "//", "Simplify"}]], "Input",
 CellChangeTimes->{{3.6821622702172537`*^9, 3.682162273206356*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{"-", 
   SubscriptBox["wHap", 
    RowBox[{"a", ",", "female"}]]}], " ", 
  SubscriptBox["wHap", 
   RowBox[{"A", ",", "female"}]], " ", 
  RowBox[{"(", 
   RowBox[{
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "2"}], "+", "pXm", "+", "pYm"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
     SubsuperscriptBox["wHap", 
      RowBox[{"a", ",", "male"}], "2"], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "a", ",", "female"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "female"}]]}], "+", 
    RowBox[{
     SuperscriptBox[
      RowBox[{"(", 
       RowBox[{"pXm", "+", "pYm"}], ")"}], "2"], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{"-", "1"}], "+", "R"}], ")"}], " ", 
     SubsuperscriptBox["wHap", 
      RowBox[{"A", ",", "male"}], "2"], " ", 
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "female"}]], " ", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "A", ",", "female"}]]}], "-", 
    RowBox[{
     RowBox[{"(", 
      RowBox[{
       SuperscriptBox["pXm", "2"], "+", 
       RowBox[{"2", " ", "pXm", " ", 
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", "pYm"}], ")"}]}], "+", 
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "2"}], "+", "pYm"}], ")"}], " ", "pYm"}]}], ")"}], " ", 
     SubscriptBox["wHap", 
      RowBox[{"a", ",", "male"}]], " ", 
     SubscriptBox["wHap", 
      RowBox[{"A", ",", "male"}]], " ", 
     RowBox[{"(", 
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"-", "1"}], "+", 
          RowBox[{"2", " ", "R"}]}], ")"}], " ", 
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "A", ",", "female"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "a", ",", "female"}]]}], "-", 
       RowBox[{
        SubscriptBox["wDip", 
         RowBox[{"a", ",", "a", ",", "female"}]], " ", 
        SubscriptBox["wDip", 
         RowBox[{"A", ",", "A", ",", "female"}]]}]}], ")"}]}]}], 
   ")"}]}]], "Output",
 CellChangeTimes->{{3.6821622705229177`*^9, 3.682162273452445*^9}}]
}, Open  ]],

Cell["\<\
When there is no recombination between the VS and modifier locus we have a \
perfect square and eigenvalues\
\>", "Text",
 CellChangeTimes->{{3.678218925956046*^9, 3.67821895338835*^9}, {
  3.678543518836514*^9, 3.6785435239328136`*^9}, {3.68190322106429*^9, 
  3.681903247281014*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"noreceigens1", "=", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{"(", 
      RowBox[{"\[Lambda]", "/.", 
       RowBox[{"Solve", "[", 
        RowBox[{
         RowBox[{
          RowBox[{"0", "==", 
           RowBox[{"charpolyk1", "[", 
            RowBox[{"[", "4", "]"}], "]"}]}], "/.", 
          RowBox[{"R", "\[Rule]", "0"}]}], ",", "\[Lambda]"}], "]"}]}], ")"}],
      "*", 
     RowBox[{"(", 
      RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}]}], "/.", 
    RowBox[{"pXm", "\[Rule]", 
     RowBox[{
      RowBox[{"2", "pAveM"}], "-", "pYm"}]}]}], "//", "Simplify"}]}]], "Input",\

 CellChangeTimes->{{3.681903139431856*^9, 3.681903212216094*^9}, {
   3.681903252924161*^9, 3.681903283508576*^9}, {3.6819033172498617`*^9, 
   3.681903349193973*^9}, {3.681903554716239*^9, 3.6819035548718653`*^9}, {
   3.681904256383094*^9, 3.681904256853209*^9}, 3.681904319687405*^9, {
   3.6819049631732073`*^9, 3.681904970534773*^9}, {3.681918052071443*^9, 
   3.681918070023802*^9}, {3.68191816498897*^9, 3.681918193927002*^9}}],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"a", ",", "female"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "male"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "a", ",", "female"}]]}], "-", 
        RowBox[{"pAveM", " ", 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "male"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "A", ",", "female"}]]}]}], ")"}]}], "meanF"]}], 
   ",", 
   RowBox[{"-", 
    FractionBox[
     RowBox[{
      SubscriptBox["wHap", 
       RowBox[{"A", ",", "female"}]], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{
         RowBox[{"(", 
          RowBox[{
           RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", 
         SubscriptBox["wHap", 
          RowBox[{"a", ",", "male"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"A", ",", "a", ",", "female"}]]}], "-", 
        RowBox[{"pAveM", " ", 
         SubscriptBox["wHap", 
          RowBox[{"A", ",", "male"}]], " ", 
         SubscriptBox["wDip", 
          RowBox[{"A", ",", "A", ",", "female"}]]}]}], ")"}]}], "meanF"]}]}], 
  "}"}]], "Output",
 CellChangeTimes->{
  3.681903214475835*^9, {3.6819032538349667`*^9, 3.68190328407938*^9}, {
   3.681903319968005*^9, 3.681903350224607*^9}, {3.6819042463472967`*^9, 
   3.681904257578438*^9}, 3.681904320533412*^9, 3.681904973448106*^9, {
   3.681918104779442*^9, 3.681918113935005*^9}, {3.681918177268292*^9, 
   3.681918195251687*^9}, 3.6820509796532917`*^9, 3.682067867288456*^9, 
   3.6821413305913*^9, 3.682162434001899*^9}]
}, Open  ]],

Cell["\<\
The growth rate of the haplotypes without recombination can be used to \
simplify our expressions. To make use of them we will first solve for unique \
elements in each and then use these substitutions later.\
\>", "Text",
 CellChangeTimes->{{3.678803208834538*^9, 3.678803234204862*^9}, {
   3.678803619761446*^9, 3.6788036219774733`*^9}, 3.681904868180386*^9, {
   3.681904920400379*^9, 3.681904938522684*^9}, {3.6820546076102657`*^9, 
   3.682054648556566*^9}}],

Cell[BoxData[{
 RowBox[{
  RowBox[{"gasubR0", "=", 
   RowBox[{
    RowBox[{"Solve", "[", 
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"noreceigens1", "[", 
         RowBox[{"[", "1", "]"}], "]"}], "-", "1"}], "\[Equal]", "gaR0"}], 
      ",", 
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "a", ",", "female"}]]}], "]"}], "//", "Flatten"}]}], 
  ";"}], "\n", 
 RowBox[{
  RowBox[{"gAsubR0", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{"noreceigens1", "[", 
          RowBox[{"[", "2", "]"}], "]"}], "-", "1"}], "\[Equal]", "gAR0"}], 
       ",", 
       SubscriptBox["wDip", 
        RowBox[{"A", ",", "A", ",", "female"}]]}], "]"}], "//", "Simplify"}], 
    "//", "Flatten"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.682054657183845*^9, 3.6820546678559093`*^9}, {
  3.682141273721465*^9, 3.682141291396159*^9}, {3.682141355137361*^9, 
  3.682141360098618*^9}}],

Cell["Our 2a+b<0 condition is then", "Text",
 CellChangeTimes->{{3.67880416570479*^9, 3.678804180447051*^9}, {
   3.678805104382928*^9, 3.678805104765669*^9}, 3.681904868183251*^9}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Simplify", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"2", 
          RowBox[{"acoef1", "/", 
           SuperscriptBox[
            RowBox[{"(", 
             RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}], "2"]}]}], "+", 
         RowBox[{"bcoef1", "/", 
          RowBox[{"(", 
           RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}]}]}], ")"}], "<", 
       "0"}], "/.", 
      RowBox[{"pXm", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "pYm"}], "+", 
        RowBox[{"2", "pAveM"}]}]}]}], "/.", "gAsubR0"}], "/.", "gasubR0"}], 
   ",", 
   RowBox[{"meanF", ">", "0"}]}], "]"}]], "Input",
 CellChangeTimes->{{3.681905326309329*^9, 3.681905422528089*^9}, {
   3.681916867922887*^9, 3.681916951609811*^9}, 3.681916985669846*^9, {
   3.681917017942401*^9, 3.681917041861507*^9}, {3.681917194779866*^9, 
   3.6819171955258417`*^9}, {3.6821412961216707`*^9, 3.682141315975049*^9}, {
   3.6821413631549597`*^9, 3.682141364636923*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"gaR0", "+", "gAR0"}], ")"}], " ", "meanF"}], "+", 
   RowBox[{
    RowBox[{"(", 
     RowBox[{
      RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", "R", " ", 
    SubscriptBox["wHap", 
     RowBox[{"a", ",", "male"}]], " ", 
    SubscriptBox["wHap", 
     RowBox[{"A", ",", "female"}]], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "female"}]]}]}], ">", 
  RowBox[{"pAveM", " ", "R", " ", 
   SubscriptBox["wHap", 
    RowBox[{"a", ",", "female"}]], " ", 
   SubscriptBox["wHap", 
    RowBox[{"A", ",", "male"}]], " ", 
   SubscriptBox["wDip", 
    RowBox[{"a", ",", "A", ",", "female"}]]}]}]], "Output",
 CellChangeTimes->{
  3.681905290331477*^9, {3.681905342821418*^9, 3.681905423057828*^9}, {
   3.681916871377392*^9, 3.681916916476166*^9}, 3.68191695230989*^9, 
   3.6819169862835627`*^9, {3.6819170194611177`*^9, 3.6819170422821217`*^9}, 
   3.6819171630559587`*^9, 3.681917195922757*^9, 3.682054686536769*^9, 
   3.682067871437381*^9, 3.682141331031554*^9, 3.682141365134034*^9, 
   3.682162438585197*^9}]
}, Open  ]],

Cell["\<\
and when the fitness of diploids does not depend from which parent the A and \
a alleles come from, and there is no competition among eggs, we have\
\>", "Text",
 CellChangeTimes->{{3.681917273911067*^9, 3.681917335175859*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "female"}]], "\[Rule]", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "female"}]]}]}], "/.", 
   RowBox[{
    SubscriptBox["wHap", 
     RowBox[{"y_", ",", "female"}]], "\[Rule]", "1"}]}], "//", 
  "FullSimplify"}]], "Input",
 CellChangeTimes->{{3.681917113113645*^9, 3.681917160579852*^9}, {
  3.681917197803162*^9, 3.681917198595109*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{"(", 
     RowBox[{"gaR0", "+", "gAR0"}], ")"}], " ", "meanF"}], "+", 
   RowBox[{"R", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "male"}]]}], "-", 
      RowBox[{"pAveM", " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "male"}]]}]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "female"}]]}]}], ">", "0"}]], "Output",
 CellChangeTimes->{3.681917128502346*^9, 3.6819171650046377`*^9, 
  3.681917199198641*^9, 3.682067878138625*^9, 3.6821413311467733`*^9, 
  3.682141370122883*^9, 3.682162439920609*^9}]
}, Open  ]],

Cell["\<\
n.b., if you instead look at the growth rates of the haplotypes with \
recombination (where double heterozygotes are sometimes lost through \
recombination; we don\[CloseCurlyQuote]t have many triple heterozygotes in \
females when the neo-W is rare because all are XX) this condition becomes \
\>", "Text",
 CellChangeTimes->{{3.678846177746627*^9, 3.6788461948713303`*^9}, {
   3.678846297134678*^9, 3.678846304582315*^9}, 3.681904868184037*^9, {
   3.6819181257275543`*^9, 3.681918148392576*^9}, {3.681918434462582*^9, 
   3.681918438682802*^9}, {3.68214137505406*^9, 3.682141429598567*^9}, 
   3.682163100111294*^9}],

Cell[CellGroupData[{

Cell[BoxData[{
 RowBox[{
  RowBox[{"gasub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"ga", "==", 
         RowBox[{
          RowBox[{"noreceigens1", "[", 
           RowBox[{"[", "1", "]"}], "]"}], "-", "1"}]}], "/.", " ", 
        RowBox[{
         SubscriptBox["wDip", 
          RowBox[{"a", ",", "A", ",", "female"}]], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], " ", 
          SubscriptBox["wDip", 
           RowBox[{"a", ",", "A", ",", "female"}]]}]}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"a", ",", "a", ",", "female"}]]}], "]"}], "//", "Simplify"}], 
    "//", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"gAsub", "=", 
   RowBox[{
    RowBox[{
     RowBox[{"Solve", "[", 
      RowBox[{
       RowBox[{
        RowBox[{"gA", "==", 
         RowBox[{
          RowBox[{"noreceigens1", "[", 
           RowBox[{"[", "2", "]"}], "]"}], "-", "1"}]}], "/.", " ", 
        RowBox[{
         SubscriptBox["wDip", 
          RowBox[{"A", ",", "a", ",", "female"}]], "\[Rule]", 
         RowBox[{
          RowBox[{"(", 
           RowBox[{"1", "-", "R"}], ")"}], " ", 
          SubscriptBox["wDip", 
           RowBox[{"A", ",", "a", ",", "female"}]]}]}]}], ",", 
       SubscriptBox["wDip", 
        RowBox[{"A", ",", "A", ",", "female"}]]}], "]"}], "//", "Simplify"}], 
    "//", "Flatten"}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{"(", 
         RowBox[{
          RowBox[{"2", 
           RowBox[{"acoef1", "/", 
            SuperscriptBox[
             RowBox[{"(", 
              RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}], "2"]}]}], "+", 
          RowBox[{"bcoef1", "/", 
           RowBox[{"(", 
            RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}]}]}], ")"}], "/", 
        SuperscriptBox["meanF", "2"]}], "<", "0"}], "/.", 
      RowBox[{"pXm", "\[Rule]", 
       RowBox[{
        RowBox[{"-", "pYm"}], "+", 
        RowBox[{"2", "pAveM"}]}]}]}], "/.", "gAsub"}], "/.", "gasub"}], "//", 
   "Simplify"}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{
   RowBox[{"%", "/.", 
    RowBox[{
     SubscriptBox["wDip", 
      RowBox[{"a", ",", "A", ",", "female"}]], "\[Rule]", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "female"}]]}]}], "/.", 
   RowBox[{"ga", "\[Rule]", 
    RowBox[{
     RowBox[{"-", "gA"}], "+", 
     RowBox[{"2", "gmean"}]}]}]}], "//", "FullSimplify"}]}], "Input",
 CellChangeTimes->{{3.681918233431054*^9, 3.681918421388166*^9}, {
   3.681918469375478*^9, 3.6819184696386013`*^9}, {3.681918866852846*^9, 
   3.681918908154718*^9}, 3.682075570346508*^9, {3.682141251053735*^9, 
   3.682141253114156*^9}, {3.68214134600408*^9, 3.68214134740231*^9}, {
   3.6821414396941357`*^9, 3.682141452148271*^9}}],

Cell[BoxData[
 RowBox[{"gmean", ">", "0"}]], "Output",
 CellChangeTimes->{{3.68191839577896*^9, 3.681918419133647*^9}, 
   3.681918470286449*^9, {3.681918870254158*^9, 3.6819188780079813`*^9}, 
   3.681918908932249*^9, 3.6820678797229843`*^9, 3.6820755708955708`*^9, 
   3.682076174531219*^9, 3.682141454119433*^9, 3.6821624424317007`*^9}]
}, Open  ]],

Cell["\<\
which only requires that the mean haplotype growth rate is greater than 0.\
\>", "Text",
 CellChangeTimes->{{3.681918458602993*^9, 3.681918483788617*^9}, {
  3.682142906295642*^9, 3.682142907171076*^9}}],

Cell["\<\
Using the no recombination growth rate definitions, our final condition is\
\>", "Text",
 CellChangeTimes->{{3.678803649407956*^9, 3.678803654081893*^9}, {
   3.6788053785896177`*^9, 3.678805380997744*^9}, {3.678841377839574*^9, 
   3.678841379596589*^9}, {3.678846310941874*^9, 3.678846311165923*^9}, {
   3.678846365316596*^9, 3.678846371932901*^9}, 3.68190486818493*^9, {
   3.682141584054723*^9, 3.6821415917267*^9}}],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"Collect", "[", 
  RowBox[{
   RowBox[{
    RowBox[{
     RowBox[{
      RowBox[{
       RowBox[{
        RowBox[{
         RowBox[{
          RowBox[{"(", 
           RowBox[{
            RowBox[{"acoef1", "/", 
             SuperscriptBox[
              RowBox[{"(", 
               RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}], "2"]}], "+", 
            RowBox[{"bcoef1", "/", 
             RowBox[{"(", 
              RowBox[{"femaleMeanFit", "/", "meanF"}], ")"}]}], "+", 
            "ccoef1"}], ")"}], "/", "meanF"}], "<", "0"}], "/.", 
        RowBox[{"pXm", "\[Rule]", 
         RowBox[{
          RowBox[{"-", "pYm"}], "+", 
          RowBox[{"2", "pAveM"}]}]}]}], "/.", "gasubR0"}], "/.", "gAsubR0"}], 
     "/.", 
     RowBox[{
      SubscriptBox["wDip", 
       RowBox[{"a", ",", "A", ",", "female"}]], "\[Rule]", 
      SubscriptBox["wDip", 
       RowBox[{"A", ",", "a", ",", "female"}]]}]}], "//", "Simplify"}], ",", 
   RowBox[{"{", 
    RowBox[{"meanF", ",", "R", ",", 
     SubscriptBox["wDip", 
      RowBox[{"A", ",", "a", ",", "female"}]]}], "}"}]}], "]"}]], "Input",
 CellChangeTimes->{
  3.6819186061722803`*^9, {3.681918730408938*^9, 3.681918740649404*^9}, {
   3.6819187744500637`*^9, 3.681918810085658*^9}, {3.681918917500854*^9, 
   3.681918991367647*^9}, {3.6820761250881567`*^9, 3.682076145812059*^9}, {
   3.6820761774085407`*^9, 3.6820762023645697`*^9}, {3.682141534967753*^9, 
   3.682141570805162*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"gaR0", " ", "gAR0", " ", "meanF"}], "+", 
   RowBox[{"R", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{"gaR0", " ", 
       RowBox[{"(", 
        RowBox[{
         RowBox[{"-", "1"}], "+", "pAveM"}], ")"}], " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "male"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "female"}]]}], "-", 
      RowBox[{"gAR0", " ", "pAveM", " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "female"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "male"}]]}]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "female"}]]}]}], "<", "0"}]], "Output",
 CellChangeTimes->{
  3.681918572925273*^9, 3.681918606886701*^9, {3.6819187308962708`*^9, 
   3.68191874093325*^9}, {3.6819187831120443`*^9, 3.6819188104237127`*^9}, 
   3.6819188875906143`*^9, 3.6819189191118*^9, {3.6819189505788927`*^9, 
   3.681918991796973*^9}, 3.682067849014511*^9, 3.6820678823357773`*^9, {
   3.6820761277323503`*^9, 3.6820761470841093`*^9}, {3.682076180147532*^9, 
   3.682076203757696*^9}, 3.682141540351841*^9, 3.6821415716569557`*^9, 
   3.682162443796255*^9}]
}, Open  ]],

Cell["We can rearrange this into", "Text",
 CellChangeTimes->{{3.682057081828285*^9, 3.682057090379334*^9}, {
  3.682057506051239*^9, 3.682057506085292*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"R", " ", 
    RowBox[{"(", 
     RowBox[{
      RowBox[{
       RowBox[{"(", 
        RowBox[{"1", "-", "pAveM"}], ")"}], " ", "gaR0", " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "male"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "female"}]]}], "+", 
      RowBox[{"pAveM", " ", "gAR0", " ", 
       SubscriptBox["wHap", 
        RowBox[{"a", ",", "female"}]], " ", 
       SubscriptBox["wHap", 
        RowBox[{"A", ",", "male"}]]}]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "female"}]]}], ">", 
   RowBox[{"meanF", " ", "gaR0", " ", "gAR0"}]}], ";"}]], "Input",
 CellChangeTimes->{{3.682056624210589*^9, 3.6820566593421173`*^9}, {
  3.682057027961835*^9, 3.682057078300086*^9}, {3.682057521316187*^9, 
  3.6820576037588177`*^9}, {3.682067921253766*^9, 3.6820679447029257`*^9}, {
  3.682142961069292*^9, 3.682142979895771*^9}}],

Cell["\<\
If both gA>0 and gA>0 then 2a+b>0 and the modifier invades. If both gAR0<0 \
and gaR0<0 then a+b+c<0 is never true and the modifier will not invade. So \
the interesting part is when one gR0 is positive and one negative. If we \
assume, without loss of generality, that gAR0>0 and gaR0<0, the product gAR0 \
gaR0 is negative. Dividing through and flipping the inequality:\
\>", "Text",
 CellChangeTimes->{{3.678845089552334*^9, 3.678845160444935*^9}, 
   3.678846328049347*^9, 3.681904868185585*^9, {3.682056686187016*^9, 
   3.682056729646557*^9}, {3.682056760907091*^9, 3.6820567859103727`*^9}, {
   3.6820568469095783`*^9, 3.682056944805656*^9}, {3.68205710368909*^9, 
   3.682057103898336*^9}, {3.682067950834725*^9, 3.6820679520530567`*^9}, {
   3.682163120154984*^9, 3.682163203206229*^9}}],

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"R", " ", 
    RowBox[{"(", 
     RowBox[{
      FractionBox[
       RowBox[{
        RowBox[{"(", 
         RowBox[{"1", "-", "pAveM"}], ")"}], "  ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "male"}]], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "female"}]]}], "gAR0"], "+", 
      FractionBox[
       RowBox[{"pAveM", " ", 
        SubscriptBox["wHap", 
         RowBox[{"a", ",", "female"}]], " ", 
        SubscriptBox["wHap", 
         RowBox[{"A", ",", "male"}]]}], "gaR0"]}], ")"}], " ", 
    SubscriptBox["wDip", 
     RowBox[{"A", ",", "a", ",", "female"}]]}], "<", " ", "meanF"}], 
  ";"}]], "Input",
 CellChangeTimes->{{3.678845120164757*^9, 3.6788451205308228`*^9}, {
   3.678845164017808*^9, 3.678845206833847*^9}, {3.678846328050565*^9, 
   3.678846331194606*^9}, 3.681904868185891*^9, {3.6820566735977182`*^9, 
   3.682056680097406*^9}, {3.6820569521544743`*^9, 3.682056966932479*^9}, {
   3.682057001450542*^9, 3.68205701341922*^9}, {3.682057109642288*^9, 
   3.682057196629991*^9}, {3.682057281250379*^9, 3.682057304119631*^9}, 
   3.68205747025915*^9, {3.682057634053491*^9, 3.682057666531451*^9}, 
   3.682067941675747*^9, {3.682067996958975*^9, 3.682068001789633*^9}, {
   3.682142982762663*^9, 3.682142985906283*^9}}]
}, Closed]]
}, Open  ]]
}, Open  ]]
},
WindowSize->{1366, 719},
WindowMargins->{{0, Automatic}, {Automatic, 0}},
FrontEndVersion->"9.0 for Mac OS X x86 (32-bit, 64-bit Kernel) (January 25, \
2013)",
StyleDefinitions->"Default.nb"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[579, 22, 473, 8, 148, "Title"],
Cell[1055, 32, 178, 2, 51, "Subtitle"]
}, Open  ]],
Cell[CellGroupData[{
Cell[1270, 39, 370, 6, 92, "Title"],
Cell[CellGroupData[{
Cell[1665, 49, 223, 3, 80, "Section"],
Cell[1891, 54, 99, 1, 30, "Text"],
Cell[1993, 57, 1344, 39, 60, "Input"],
Cell[3340, 98, 97, 1, 30, "Text"],
Cell[3440, 101, 675, 16, 34, "Input"],
Cell[4118, 119, 98, 1, 30, "Text"],
Cell[4219, 122, 707, 18, 34, "Input"],
Cell[4929, 142, 124, 1, 30, "Text"],
Cell[5056, 145, 412, 11, 34, "Input"],
Cell[5471, 158, 153, 3, 30, "Text"],
Cell[5627, 163, 2549, 52, 140, "Input"],
Cell[8179, 217, 101, 1, 30, "Text"],
Cell[8283, 220, 2197, 64, 60, "Input"],
Cell[10483, 286, 91, 1, 30, "Text"],
Cell[10577, 289, 1497, 44, 56, "Input"],
Cell[12077, 335, 99, 1, 30, "Text"],
Cell[12179, 338, 12184, 300, 861, "Input"],
Cell[24366, 640, 1563, 40, 53, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[25966, 685, 545, 7, 50, "Section"],
Cell[26514, 694, 131, 1, 30, "Text"],
Cell[26648, 697, 2098, 52, 220, "Input"],
Cell[28749, 751, 560, 9, 30, "Text"],
Cell[29312, 762, 1428, 35, 117, "Input"],
Cell[30743, 799, 408, 7, 30, "Text"],
Cell[31154, 808, 1863, 48, 188, "Input"],
Cell[33020, 858, 229, 3, 30, "Text"],
Cell[33252, 863, 758, 17, 97, "Input"],
Cell[34013, 882, 365, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[34403, 892, 497, 13, 28, "Input"],
Cell[34903, 907, 1058, 26, 70, "Output"]
}, Open  ]],
Cell[35976, 936, 159, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[36160, 942, 641, 14, 28, "Input"],
Cell[36804, 958, 1311, 21, 70, "Output"]
}, Open  ]],
Cell[38130, 982, 329, 6, 30, "Text"],
Cell[38462, 990, 467, 8, 30, "Text"],
Cell[CellGroupData[{
Cell[38954, 1002, 1256, 26, 28, "Input"],
Cell[40213, 1030, 5432, 134, 70, "Output"]
}, Open  ]],
Cell[45660, 1167, 179, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[45864, 1175, 639, 17, 28, "Input"],
Cell[46506, 1194, 8772, 218, 70, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[55327, 1418, 555, 9, 50, "Section"],
Cell[55885, 1429, 214, 4, 30, "Text"],
Cell[56102, 1435, 204, 4, 30, "Text"],
Cell[56309, 1441, 2718, 74, 227, "Input"],
Cell[59030, 1517, 134, 1, 30, "Text"],
Cell[59167, 1520, 398, 10, 28, "Input"],
Cell[59568, 1532, 262, 5, 30, "Text"],
Cell[59833, 1539, 224, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[60082, 1548, 945, 26, 63, "Input"],
Cell[61030, 1576, 1365, 35, 48, "Output"]
}, Open  ]],
Cell[62410, 1614, 132, 3, 30, "Text"],
Cell[62545, 1619, 193, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[62763, 1625, 952, 24, 46, "Input"],
Cell[63718, 1651, 811, 19, 47, "Output"]
}, Open  ]],
Cell[64544, 1673, 160, 3, 30, "Text"],
Cell[64707, 1678, 174, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[64906, 1686, 1154, 28, 63, "Input"],
Cell[66063, 1716, 1332, 34, 48, "Output"]
}, Open  ]],
Cell[67410, 1753, 116, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[67551, 1758, 980, 25, 46, "Input"],
Cell[68534, 1785, 966, 23, 47, "Output"]
}, Open  ]],
Cell[69515, 1811, 160, 3, 30, "Text"],
Cell[69678, 1816, 285, 6, 30, "Text"],
Cell[69966, 1824, 492, 14, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[70495, 1843, 607, 10, 50, "Section"],
Cell[71105, 1855, 474, 8, 30, "Text"],
Cell[71582, 1865, 586, 8, 30, "Text"],
Cell[72171, 1875, 2401, 63, 57, "Input"],
Cell[74575, 1940, 116, 1, 30, "Text"],
Cell[74694, 1943, 396, 10, 28, "Input"],
Cell[75093, 1955, 184, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[75302, 1961, 514, 15, 46, "Input"],
Cell[75819, 1978, 928, 23, 28, "Output"]
}, Open  ]],
Cell[76762, 2004, 144, 3, 30, "Text"],
Cell[76909, 2009, 118, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[77052, 2014, 1175, 28, 46, "Input"],
Cell[78230, 2044, 281, 6, 28, "Output"]
}, Open  ]],
Cell[78526, 2053, 322, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[78873, 2061, 1739, 44, 63, "Input"],
Cell[80615, 2107, 7369, 219, 194, "Output"]
}, Open  ]],
Cell[87999, 2329, 122, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[88146, 2334, 784, 20, 28, "Input"],
Cell[88933, 2356, 10317, 270, 202, "Output"]
}, Open  ]],
Cell[99265, 2629, 332, 6, 30, "Text"],
Cell[99600, 2637, 322, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[99947, 2647, 921, 27, 35, "Input"],
Cell[100871, 2676, 1105, 32, 55, "Output"]
}, Open  ]],
Cell[101991, 2711, 425, 15, 31, "Input"],
Cell[102419, 2728, 214, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[102658, 2736, 1200, 34, 35, "Input"],
Cell[103861, 2772, 819, 21, 55, "Output"]
}, Open  ]],
Cell[104695, 2796, 267, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[104987, 2805, 1003, 28, 35, "Input"],
Cell[105993, 2835, 744, 18, 55, "Output"]
}, Open  ]],
Cell[106752, 2856, 301, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[107078, 2866, 1208, 35, 35, "Input"],
Cell[108289, 2903, 828, 22, 55, "Output"]
}, Open  ]],
Cell[109132, 2928, 414, 7, 49, "Text"],
Cell[CellGroupData[{
Cell[109571, 2939, 751, 21, 46, "Input"],
Cell[110325, 2962, 897, 24, 55, "Output"],
Cell[111225, 2988, 364, 6, 28, "Output"]
}, Open  ]],
Cell[111604, 2997, 409, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[112038, 3008, 787, 23, 35, "Input"],
Cell[112828, 3033, 1820, 50, 56, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[114697, 3089, 458, 6, 50, "Section"],
Cell[CellGroupData[{
Cell[115180, 3099, 115, 1, 44, "Subsection"],
Cell[115298, 3102, 334, 6, 30, "Text"],
Cell[115635, 3110, 687, 11, 30, "Text"],
Cell[116325, 3123, 1814, 46, 110, "Input"],
Cell[118142, 3171, 205, 4, 30, "Text"],
Cell[118350, 3177, 1805, 46, 110, "Input"],
Cell[CellGroupData[{
Cell[120180, 3227, 147, 2, 35, "Subsubsection"],
Cell[120330, 3231, 180, 4, 30, "Text"],
Cell[120513, 3237, 340, 8, 28, "Input"],
Cell[120856, 3247, 163, 2, 30, "Text"],
Cell[121022, 3251, 1265, 30, 80, "Input"],
Cell[122290, 3283, 396, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[122711, 3292, 759, 14, 34, "Input"],
Cell[123473, 3308, 941, 14, 32, "Output"]
}, Open  ]],
Cell[124429, 3325, 176, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[124630, 3331, 488, 10, 28, "Input"],
Cell[125121, 3343, 2365, 65, 57, "Output"]
}, Open  ]],
Cell[127501, 3411, 153, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[127679, 3417, 400, 6, 28, "Input"],
Cell[128082, 3425, 2752, 79, 57, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[130883, 3510, 145, 2, 29, "Subsubsection"],
Cell[131031, 3514, 142, 1, 30, "Text"],
Cell[131176, 3517, 291, 7, 28, "Input"],
Cell[131470, 3526, 179, 2, 30, "Text"],
Cell[131652, 3530, 1313, 30, 80, "Input"],
Cell[132968, 3562, 396, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[133389, 3571, 759, 14, 34, "Input"],
Cell[134151, 3587, 888, 14, 32, "Output"]
}, Open  ]],
Cell[135054, 3604, 228, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[135307, 3611, 574, 13, 28, "Input"],
Cell[135884, 3626, 1819, 51, 57, "Output"]
}, Open  ]],
Cell[137718, 3680, 202, 4, 30, "Text"],
Cell[137923, 3686, 209, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[138157, 3693, 558, 11, 28, "Input"],
Cell[138718, 3706, 2228, 63, 58, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[140995, 3775, 218, 3, 29, "Subsubsection"],
Cell[141216, 3780, 205, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[141446, 3788, 389, 8, 28, "Input"],
Cell[141838, 3798, 9506, 240, 189, "Output"]
}, Open  ]],
Cell[151359, 4041, 179, 2, 30, "Text"],
Cell[151541, 4045, 230, 5, 28, "Input"],
Cell[CellGroupData[{
Cell[151796, 4054, 427, 11, 34, "Input"],
Cell[152226, 4067, 12601, 315, 243, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[164864, 4387, 424, 11, 28, "Input"],
Cell[165291, 4400, 174, 2, 28, "Output"]
}, Open  ]],
Cell[165480, 4405, 1377, 31, 80, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[166906, 4442, 354, 5, 36, "Subsection"],
Cell[CellGroupData[{
Cell[167285, 4451, 124, 2, 35, "Subsubsection"],
Cell[167412, 4455, 196, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[167633, 4463, 682, 20, 28, "Input"],
Cell[168318, 4485, 1501, 45, 53, "Output"]
}, Open  ]],
Cell[169834, 4533, 745, 11, 49, "Text"],
Cell[CellGroupData[{
Cell[170604, 4548, 3901, 116, 119, "Input"],
Cell[174508, 4666, 340, 5, 28, "Output"]
}, Open  ]],
Cell[174863, 4674, 453, 8, 30, "Text"],
Cell[175319, 4684, 1768, 49, 57, "Input"],
Cell[177090, 4735, 483, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[177598, 4745, 1386, 35, 57, "Input"],
Cell[178987, 4782, 1647, 36, 69, "Output"]
}, Open  ]],
Cell[180649, 4821, 110, 1, 30, "Text"],
Cell[180762, 4824, 850, 23, 35, "Input"],
Cell[181615, 4849, 1037, 15, 49, "Text"],
Cell[182655, 4866, 1420, 32, 55, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[184112, 4903, 98, 1, 29, "Subsubsection"],
Cell[184213, 4906, 295, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[184533, 4916, 1055, 26, 28, "Input"],
Cell[185591, 4944, 1790, 51, 53, "Output"]
}, Open  ]],
Cell[187396, 4998, 369, 6, 49, "Text"],
Cell[187768, 5006, 474, 8, 49, "Text"],
Cell[188245, 5016, 968, 30, 57, "Input"],
Cell[189216, 5048, 181, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[189422, 5054, 1046, 28, 35, "Input"],
Cell[190471, 5084, 1086, 28, 33, "Output"]
}, Open  ]],
Cell[191572, 5115, 237, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[191834, 5123, 488, 14, 34, "Input"],
Cell[192325, 5139, 741, 22, 35, "Output"]
}, Open  ]],
Cell[193081, 5164, 632, 10, 49, "Text"],
Cell[CellGroupData[{
Cell[193738, 5178, 2926, 84, 100, "Input"],
Cell[196667, 5264, 315, 5, 28, "Output"]
}, Open  ]],
Cell[196997, 5272, 213, 4, 30, "Text"],
Cell[197213, 5278, 431, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[197669, 5289, 1461, 39, 56, "Input"],
Cell[199133, 5330, 1176, 28, 35, "Output"]
}, Open  ]],
Cell[200324, 5361, 157, 2, 30, "Text"],
Cell[200484, 5365, 946, 24, 35, "Input"],
Cell[201433, 5391, 806, 12, 49, "Text"],
Cell[202242, 5405, 1320, 31, 55, "Input"]
}, Closed]]
}, Closed]],
Cell[CellGroupData[{
Cell[203611, 5442, 354, 4, 36, "Subsection"],
Cell[203968, 5448, 178, 4, 30, "Text"],
Cell[204149, 5454, 314, 6, 30, "Text"],
Cell[204466, 5462, 300, 8, 28, "Input"],
Cell[CellGroupData[{
Cell[204791, 5474, 881, 25, 31, "Input"],
Cell[205675, 5501, 317, 7, 47, "Output"]
}, Open  ]],
Cell[206007, 5511, 253, 5, 30, "Text"],
Cell[206263, 5518, 133, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[206421, 5523, 824, 26, 36, "Input"],
Cell[207248, 5551, 1048, 32, 58, "Output"]
}, Open  ]],
Cell[208311, 5586, 574, 15, 35, "Text"]
}, Closed]]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[208946, 5608, 667, 11, 92, "Title"],
Cell[CellGroupData[{
Cell[209638, 5623, 199, 3, 80, "Section"],
Cell[209840, 5628, 99, 1, 30, "Text"],
Cell[209942, 5631, 1479, 42, 60, "Input"],
Cell[211424, 5675, 95, 1, 30, "Text"],
Cell[211522, 5678, 900, 26, 36, "Input"],
Cell[212425, 5706, 99, 1, 30, "Text"],
Cell[212527, 5709, 880, 26, 36, "Input"],
Cell[213410, 5737, 100, 1, 30, "Text"],
Cell[213513, 5740, 337, 9, 34, "Input"],
Cell[213853, 5751, 129, 3, 30, "Text"],
Cell[213985, 5756, 2900, 57, 162, "Input"],
Cell[216888, 5815, 103, 1, 30, "Text"],
Cell[216994, 5818, 2197, 64, 60, "Input"],
Cell[219194, 5884, 89, 1, 30, "Text"],
Cell[219286, 5887, 1491, 43, 77, "Input"],
Cell[220780, 5932, 101, 1, 30, "Text"],
Cell[220884, 5935, 17446, 433, 1257, "Input"],
Cell[238333, 6370, 1615, 43, 53, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[239985, 6418, 545, 7, 50, "Section"],
Cell[240533, 6427, 213, 4, 30, "Text"],
Cell[240749, 6433, 2325, 56, 242, "Input"],
Cell[243077, 6491, 560, 9, 30, "Text"],
Cell[243640, 6502, 1587, 38, 117, "Input"],
Cell[245230, 6542, 408, 7, 30, "Text"],
Cell[245641, 6551, 1911, 49, 188, "Input"],
Cell[247555, 6602, 229, 3, 30, "Text"],
Cell[247787, 6607, 758, 17, 97, "Input"],
Cell[248548, 6626, 365, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[248938, 6636, 497, 13, 28, "Input"],
Cell[249438, 6651, 1223, 28, 47, "Output"]
}, Open  ]],
Cell[250676, 6682, 159, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[250860, 6688, 761, 15, 28, "Input"],
Cell[251624, 6705, 1461, 23, 28, "Output"]
}, Open  ]],
Cell[253100, 6731, 329, 6, 30, "Text"],
Cell[253432, 6739, 467, 8, 30, "Text"],
Cell[CellGroupData[{
Cell[253924, 6751, 1256, 26, 28, "Input"],
Cell[255183, 6779, 5454, 134, 193, "Output"]
}, Open  ]],
Cell[260652, 6916, 179, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[260856, 6924, 639, 17, 28, "Input"],
Cell[261498, 6943, 8727, 217, 205, "Output"]
}, Open  ]]
}, Closed]],
Cell[CellGroupData[{
Cell[270274, 7166, 365, 5, 50, "Section"],
Cell[270642, 7173, 214, 4, 30, "Text"],
Cell[270859, 7179, 204, 4, 30, "Text"],
Cell[271066, 7185, 2895, 77, 227, "Input"],
Cell[273964, 7264, 134, 1, 30, "Text"],
Cell[274101, 7267, 398, 10, 28, "Input"],
Cell[274502, 7279, 262, 5, 30, "Text"],
Cell[274767, 7286, 224, 5, 30, "Text"],
Cell[CellGroupData[{
Cell[275016, 7295, 945, 26, 63, "Input"],
Cell[275964, 7323, 1392, 36, 48, "Output"]
}, Open  ]],
Cell[277371, 7362, 132, 3, 30, "Text"],
Cell[277506, 7367, 193, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[277724, 7373, 952, 24, 46, "Input"],
Cell[278679, 7399, 834, 20, 47, "Output"]
}, Open  ]],
Cell[279528, 7422, 160, 3, 30, "Text"],
Cell[279691, 7427, 174, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[279890, 7435, 1154, 28, 63, "Input"],
Cell[281047, 7465, 1357, 35, 48, "Output"]
}, Open  ]],
Cell[282419, 7503, 116, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[282560, 7508, 980, 25, 46, "Input"],
Cell[283543, 7535, 989, 23, 47, "Output"]
}, Open  ]],
Cell[284547, 7561, 160, 3, 30, "Text"],
Cell[284710, 7566, 285, 6, 30, "Text"],
Cell[284998, 7574, 492, 14, 28, "Input"]
}, Closed]],
Cell[CellGroupData[{
Cell[285527, 7593, 561, 7, 50, "Section"],
Cell[286091, 7602, 444, 7, 30, "Text"],
Cell[286538, 7611, 603, 9, 30, "Text"],
Cell[287144, 7622, 1370, 35, 35, "Input"],
Cell[288517, 7659, 2618, 58, 232, "Input"],
Cell[291138, 7719, 141, 2, 30, "Text"],
Cell[291282, 7723, 518, 11, 28, "Input"],
Cell[291803, 7736, 207, 2, 30, "Text"],
Cell[292013, 7740, 627, 19, 46, "Input"],
Cell[292643, 7761, 904, 27, 28, "Input"],
Cell[293550, 7790, 238, 4, 30, "Text"],
Cell[293791, 7796, 146, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[293962, 7802, 836, 24, 46, "Input"],
Cell[294801, 7828, 187, 4, 28, "Output"]
}, Open  ]],
Cell[295003, 7835, 322, 4, 30, "Text"],
Cell[295328, 7841, 1963, 47, 63, "Input"],
Cell[297294, 7890, 122, 1, 30, "Text"],
Cell[297419, 7893, 663, 15, 28, "Input"],
Cell[298085, 7910, 178765, 3902, 2580, InheritFromParent],
Cell[476853, 11814, 116, 1, 30, "Text"],
Cell[476972, 11817, 97, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[477094, 11822, 769, 17, 35, "Input"],
Cell[477866, 11841, 8047, 240, 154, "Output"]
}, Open  ]],
Cell[485928, 12084, 152, 3, 30, "Text"],
Cell[486083, 12089, 2440, 74, 57, "Input"],
Cell[CellGroupData[{
Cell[488548, 12167, 398, 12, 31, "Input"],
Cell[488949, 12181, 1085, 34, 53, "Output"]
}, Open  ]],
Cell[490049, 12218, 140, 3, 30, "Text"],
Cell[CellGroupData[{
Cell[490214, 12225, 461, 16, 33, "Input"],
Cell[490678, 12243, 117, 2, 28, "Output"]
}, Open  ]],
Cell[490810, 12248, 93, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[490928, 12253, 770, 17, 35, "Input"],
Cell[491701, 12272, 3408, 103, 102, "Output"]
}, Open  ]],
Cell[495124, 12378, 1064, 32, 55, "Input"],
Cell[CellGroupData[{
Cell[496213, 12414, 520, 13, 31, "Input"],
Cell[496736, 12429, 1135, 35, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[497908, 12469, 461, 16, 33, "Input"],
Cell[498372, 12487, 116, 2, 28, "Output"]
}, Open  ]],
Cell[498503, 12492, 112, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[498640, 12497, 695, 17, 35, "Input"],
Cell[499338, 12516, 19291, 524, 299, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[518666, 13045, 8042, 217, 180, "Input"],
Cell[526711, 13264, 1463, 38, 53, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[528211, 13307, 461, 16, 33, "Input"],
Cell[528675, 13325, 96, 2, 28, "Output"]
}, Open  ]],
Cell[528786, 13330, 94, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[528905, 13335, 366, 7, 28, "Input"],
Cell[529274, 13344, 10345, 298, 199, "Output"]
}, Open  ]],
Cell[539634, 13645, 534, 16, 35, "Input"],
Cell[CellGroupData[{
Cell[540193, 13665, 308, 8, 28, "Input"],
Cell[540504, 13675, 9169, 273, 149, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[549710, 13953, 300, 5, 28, "Input"],
Cell[550013, 13960, 1511, 48, 54, "Output"]
}, Open  ]],
Cell[CellGroupData[{
Cell[551561, 14013, 128, 3, 28, "Input"],
Cell[551692, 14018, 690, 23, 90, "Output"]
}, Open  ]]
}, Open  ]],
Cell[CellGroupData[{
Cell[552431, 14047, 204, 4, 80, "Section"],
Cell[CellGroupData[{
Cell[552660, 14055, 95, 1, 44, "Subsection"],
Cell[552758, 14058, 202, 4, 30, "Text"],
Cell[552963, 14064, 109, 1, 30, "Text"],
Cell[553075, 14067, 293, 7, 28, "Input"],
Cell[553371, 14076, 127, 3, 30, "Text"],
Cell[553501, 14081, 867, 24, 80, "Input"],
Cell[554371, 14107, 112, 1, 30, "Text"],
Cell[554486, 14110, 1471, 41, 110, "Input"],
Cell[555960, 14153, 95, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[556080, 14158, 346, 9, 34, "Input"],
Cell[556429, 14169, 222, 5, 32, "Output"]
}, Open  ]],
Cell[556666, 14177, 96, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[556787, 14182, 243, 7, 28, "Input"],
Cell[557033, 14191, 1681, 51, 57, "Output"]
}, Open  ]],
Cell[558729, 14245, 95, 1, 30, "Text"],
Cell[CellGroupData[{
Cell[558849, 14250, 130, 2, 28, "Input"],
Cell[558982, 14254, 2239, 69, 58, "Output"]
}, Open  ]],
Cell[561236, 14326, 295, 6, 30, "Text"],
Cell[CellGroupData[{
Cell[561556, 14336, 1055, 26, 28, "Input"],
Cell[562614, 14364, 1812, 51, 53, "Output"]
}, Open  ]],
Cell[564441, 14418, 474, 8, 49, "Text"],
Cell[564918, 14428, 968, 30, 57, "Input"],
Cell[565889, 14460, 181, 2, 30, "Text"],
Cell[CellGroupData[{
Cell[566095, 14466, 1046, 28, 35, "Input"],
Cell[567144, 14496, 1112, 29, 33, "Output"]
}, Open  ]],
Cell[568271, 14528, 237, 4, 30, "Text"],
Cell[CellGroupData[{
Cell[568533, 14536, 488, 14, 34, "Input"],
Cell[569024, 14552, 763, 22, 35, "Output"]
}, Open  ]],
Cell[569802, 14577, 630, 10, 49, "Text"],
Cell[CellGroupData[{
Cell[570457, 14591, 2926, 84, 100, "Input"],
Cell[573386, 14677, 339, 5, 28, "Output"]
}, Open  ]],
Cell[573740, 14685, 213, 4, 30, "Text"],
Cell[573956, 14691, 431, 7, 30, "Text"],
Cell[CellGroupData[{
Cell[574412, 14702, 1461, 39, 56, "Input"],
Cell[575876, 14743, 1202, 29, 35, "Output"]
}, Open  ]],
Cell[577093, 14775, 157, 2, 30, "Text"],
Cell[577253, 14779, 946, 24, 35, "Input"],
Cell[578202, 14805, 806, 12, 49, "Text"],
Cell[579011, 14819, 1320, 31, 55, "Input"]
}, Closed]]
}, Open  ]]
}, Open  ]]
}
]
*)

(* End of internal cache information *)
